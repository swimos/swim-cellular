{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","../../../swim-core-js/@swim/util/src/main/runtime/Random.ts","../../../swim-core-js/@swim/util/src/main/runtime/ByteOrder.ts","../../../swim-core-js/@swim/util/src/main/runtime/Murmur3.ts","../../../swim-core-js/@swim/util/src/main/runtime/Lazy.ts","../../../swim-core-js/@swim/util/src/main/values/Identity.ts","../../../swim-core-js/@swim/util/src/main/values/Booleans.ts","../../../swim-core-js/@swim/util/src/main/compare/Equivalent.ts","../../../swim-core-js/@swim/util/src/main/values/Numbers.ts","../../../swim-core-js/@swim/util/src/main/values/Strings.ts","../../../swim-core-js/@swim/util/src/main/values/Identifiers.ts","../../../swim-core-js/@swim/util/src/main/values/Functions.ts","../../../swim-core-js/@swim/util/src/main/values/Constructors.ts","../../../swim-core-js/@swim/util/src/main/compare/Equals.ts","../../../swim-core-js/@swim/util/src/main/compare/HashCode.ts","../../../swim-core-js/@swim/util/src/main/compare/Compare.ts","../../../swim-core-js/@swim/util/src/main/values/Objects.ts","../../../swim-core-js/@swim/util/src/main/values/Values.ts","../../../swim-core-js/@swim/util/src/main/values/Arrays.ts","../../../swim-core-js/@swim/util/src/main/convert/FromAny.ts","../../../swim-core-js/@swim/util/src/main/convert/ToAny.ts","../../../swim-core-js/@swim/util/src/main/mapping/Mapping.ts","../../../swim-core-js/@swim/util/src/main/mapping/Domain.ts","../../../swim-core-js/@swim/util/src/main/mapping/Range.ts","../../../swim-core-js/@swim/util/src/main/interpolate/Interpolate.ts","../../../swim-core-js/@swim/util/src/main/interpolate/Interpolator.ts","../../../swim-core-js/@swim/util/src/main/interpolate/InterpolatorMap.ts","../../../swim-core-js/@swim/util/src/main/interpolate/IdentityInterpolator.ts","../../../swim-core-js/@swim/util/src/main/interpolate/StepInterpolator.ts","../../../swim-core-js/@swim/util/src/main/interpolate/NumberInterpolator.ts","../../../swim-core-js/@swim/util/src/main/interpolate/ArrayInterpolator.ts","../../../swim-core-js/@swim/util/src/main/interpolate/InterpolatorInterpolator.ts","../../../swim-core-js/@swim/util/src/main/transition/Timing.ts","../../../swim-core-js/@swim/util/src/main/transition/Easing.ts","../../../swim-core-js/@swim/util/src/main/transition/Tweening.ts","../../../swim-core-js/@swim/util/src/main/scale/LinearDomain.ts","../../../swim-core-js/@swim/util/src/main/scale/LinearDomainInterpolator.ts","../../../swim-core-js/@swim/util/src/main/scale/LinearRange.ts","../../../swim-core-js/@swim/util/src/main/scale/LinearRangeInterpolator.ts","../../../swim-core-js/@swim/util/src/main/scale/Scale.ts","../../../swim-core-js/@swim/util/src/main/scale/ContinuousScale.ts","../../../swim-core-js/@swim/util/src/main/scale/LinearScale.ts","../../../swim-core-js/@swim/util/src/main/scale/LinearScaleInterpolator.ts","../../../swim-core-js/@swim/util/src/main/creatable/Creatable.ts","../../../swim-core-js/@swim/util/src/main/initable/Initable.ts","../../../swim-core-js/@swim/util/src/main/observable/Observable.ts","../../../swim-core-js/@swim/util/src/main/consumable/Consumable.ts","../../../swim-core-js/@swim/util/src/main/service/Service.ts","../../../swim-core-js/@swim/util/src/main/collections/Cursor.ts","../../../swim-core-js/@swim/util/src/main/collections/CursorEmpty.ts","../../../swim-core-js/@swim/util/src/main/collections/CursorUnary.ts","../../../swim-core-js/@swim/util/src/main/collections/CursorArray.ts","../../../swim-core-js/@swim/util/src/main/cache/HashGenCacheMap.ts","../../../swim-core-js/@swim/util/src/main/cache/HashGenCacheSet.ts","../../../swim-core-js/@swim/util/src/main/assert/AssertException.ts","../../../swim-core-js/@swim/util/src/main/assert/Assert.ts","../../../swim-core-js/@swim/util/src/main/assert/Severity.ts","../../../swim-core-js/@swim/codec/src/main/source/Tag.ts","../../../swim-core-js/@swim/codec/src/main/source/Mark.ts","../../../swim-core-js/@swim/codec/src/main/source/Span.ts","../../../swim-core-js/@swim/codec/src/main/format/OutputStyle.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputSettings.ts","../../../swim-core-js/@swim/codec/src/main/input/InputException.ts","../../../swim-core-js/@swim/codec/src/main/input/InputSettings.ts","../../../swim-core-js/@swim/codec/src/main/input/Input.ts","../../../swim-core-js/@swim/codec/src/main/input/InputError.ts","../../../swim-core-js/@swim/codec/src/main/unicode/StringInput.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputException.ts","../../../swim-core-js/@swim/codec/src/main/output/Output.ts","../../../swim-core-js/@swim/codec/src/main/unicode/StringOutput.ts","../../../swim-core-js/@swim/codec/src/main/writer/WriterException.ts","../../../swim-core-js/@swim/codec/src/main/writer/Writer.ts","../../../swim-core-js/@swim/codec/src/main/unicode/StringWriter.ts","../../../swim-core-js/@swim/codec/src/main/unicode/Unicode.ts","../../../swim-core-js/@swim/codec/src/main/format/Format.ts","../../../swim-core-js/@swim/codec/src/main/number/Base10.ts","../../../swim-core-js/@swim/codec/src/main/source/Diagnostic.ts","../../../swim-core-js/@swim/codec/src/main/input/InputEmpty.ts","../../../swim-core-js/@swim/codec/src/main/input/InputDone.ts","../../../swim-core-js/@swim/codec/src/main/input/InputBuffer.ts","../../../swim-core-js/@swim/codec/src/main/input/InputBufferEmpty.ts","../../../swim-core-js/@swim/codec/src/main/input/InputBufferDone.ts","../../../swim-core-js/@swim/codec/src/main/input/InputBufferError.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputFull.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputDone.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputError.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputBuffer.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputBufferFull.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputBufferDone.ts","../../../swim-core-js/@swim/codec/src/main/output/OutputBufferError.ts","../../../swim-core-js/@swim/codec/src/main/parser/ParserException.ts","../../../swim-core-js/@swim/codec/src/main/parser/Parser.ts","../../../swim-core-js/@swim/codec/src/main/parser/ParserDone.ts","../../../swim-core-js/@swim/codec/src/main/parser/ParserError.ts","../../../swim-core-js/@swim/codec/src/main/writer/WriterEnd.ts","../../../swim-core-js/@swim/codec/src/main/writer/WriterDone.ts","../../../swim-core-js/@swim/codec/src/main/writer/WriterError.ts","../../../swim-core-js/@swim/codec/src/main/writer/WriterSequence.ts","../../../swim-core-js/@swim/codec/src/main/binary/ByteOutput.ts","../../../swim-core-js/@swim/codec/src/main/binary/ByteOutputUint8Array.ts","../../../swim-core-js/@swim/codec/src/main/binary/ByteOutputBuffer.ts","../../../swim-core-js/@swim/codec/src/main/binary/Binary.ts","../../../swim-core-js/@swim/codec/src/main/unicode/UtfErrorMode.ts","../../../swim-core-js/@swim/codec/src/main/unicode/UtfErrorModeFatal.ts","../../../swim-core-js/@swim/codec/src/main/unicode/UtfErrorModeReplacement.ts","../../../swim-core-js/@swim/codec/src/main/number/Base16.ts","../../../swim-core-js/@swim/codec/src/main/unicode/Utf8DecodedOutput.ts","../../../swim-core-js/@swim/codec/src/main/unicode/Utf8EncodedOutput.ts","../../../swim-core-js/@swim/codec/src/main/unicode/Utf8.ts","../../../swim-core-js/@swim/codec/src/main/number/Base10NumberParser.ts","../../../swim-core-js/@swim/codec/src/main/number/Base10IntegerWriter.ts","../../../swim-core-js/@swim/codec/src/main/number/Base16Parser.ts","../../../swim-core-js/@swim/codec/src/main/number/Base16Writer.ts","../../../swim-core-js/@swim/codec/src/main/number/Base16IntegerWriter.ts","../../../swim-core-js/@swim/codec/src/main/number/Base64.ts","../../../swim-core-js/@swim/codec/src/main/number/Base64Parser.ts","../../../swim-core-js/@swim/codec/src/main/number/Base64Writer.ts","../../../swim-core-js/@swim/fastener/src/main/fastener/Affinity.ts","../../../swim-core-js/@swim/fastener/src/main/fastener/FastenerContext.ts","../../../swim-core-js/@swim/fastener/src/main/fastener/Fastener.ts","../../../swim-core-js/@swim/fastener/src/main/property/Property.ts","../../../swim-core-js/@swim/fastener/src/main/property/StringProperty.ts","../../../swim-core-js/@swim/fastener/src/main/property/NumberProperty.ts","../../../swim-core-js/@swim/fastener/src/main/property/BooleanProperty.ts","../../../swim-core-js/@swim/fastener/src/main/animator/Animator.ts","../../../swim-core-js/@swim/fastener/src/main/animator/StringAnimator.ts","../../../swim-core-js/@swim/fastener/src/main/animator/NumberAnimator.ts","../../../swim-core-js/@swim/fastener/src/main/animator/BooleanAnimator.ts","../../../swim-core-js/@swim/fastener/src/main/provider/Provider.ts","../../../swim-core-js/@swim/fastener/src/main/hierarchy/Hierarchy.ts","../../../swim-core-js/@swim/collections/src/main/KeysCursor.ts","../../../swim-core-js/@swim/collections/src/main/ValuesCursor.ts","../../../swim-core-js/@swim/collections/src/main/NodeCursor.ts","../../../swim-core-js/@swim/collections/src/main/BTreeContext.ts","../../../swim-core-js/@swim/collections/src/main/BTree.ts","../../../swim-core-js/@swim/collections/src/main/BTreePage.ts","../../../swim-core-js/@swim/collections/src/main/BTreeLeaf.ts","../../../swim-core-js/@swim/collections/src/main/BTreeNode.ts","../../../swim-core-js/@swim/collections/src/main/BTreeNodeCursor.ts","../../../swim-core-js/@swim/collections/src/main/STreeContext.ts","../../../swim-core-js/@swim/collections/src/main/STree.ts","../../../swim-core-js/@swim/collections/src/main/STreePage.ts","../../../swim-core-js/@swim/collections/src/main/STreeLeaf.ts","../../../swim-core-js/@swim/collections/src/main/STreeNode.ts","../../../swim-core-js/@swim/collections/src/main/STreeNodeCursor.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintId.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintMap.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintSymbol.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintExpression.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintSum.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintTerm.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintProduct.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintConstant.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintProperty.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintAnimator.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintStrength.ts","../../../swim-core-js/@swim/constraint/src/main/Constraint.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintScope.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintRow.ts","../../../swim-core-js/@swim/structure/src/main/Item.ts","../../../swim-core-js/@swim/structure/src/main/ItemInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/Field.ts","../../../swim-core-js/@swim/structure/src/main/Slot.ts","../../../swim-core-js/@swim/structure/src/main/FieldInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/Attr.ts","../../../swim-core-js/@swim/structure/src/main/AttrInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/SlotInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/Value.ts","../../../swim-core-js/@swim/structure/src/main/Record.ts","../../../swim-core-js/@swim/structure/src/main/ValueBuilder.ts","../../../swim-core-js/@swim/structure/src/main/RecordInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/RecordCursor.ts","../../../swim-core-js/@swim/structure/src/main/RecordMap.ts","../../../swim-core-js/@swim/structure/src/main/RecordMapView.ts","../../../swim-core-js/@swim/structure/src/main/Data.ts","../../../swim-core-js/@swim/structure/src/main/DataOutput.ts","../../../swim-core-js/@swim/structure/src/main/Text.ts","../../../swim-core-js/@swim/structure/src/main/TextOutput.ts","../../../swim-core-js/@swim/structure/src/main/Num.ts","../../../swim-core-js/@swim/structure/src/main/NumInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/Bool.ts","../../../swim-core-js/@swim/structure/src/main/Extant.ts","../../../swim-core-js/@swim/structure/src/main/Absent.ts","../../../swim-core-js/@swim/structure/src/main/Expression.ts","../../../swim-core-js/@swim/structure/src/main/operator/Operator.ts","../../../swim-core-js/@swim/structure/src/main/operator/BinaryOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/BinaryOperatorInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/operator/UnaryOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/UnaryOperatorInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/operator/ConditionalOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/ConditionalOperatorInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/interpreter/InterpreterException.ts","../../../swim-core-js/@swim/structure/src/main/interpreter/InterpreterSettings.ts","../../../swim-core-js/@swim/structure/src/main/interpreter/Interpreter.ts","../../../swim-core-js/@swim/structure/src/main/operator/OrOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/AndOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/BitwiseOrOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/BitwiseXorOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/BitwiseAndOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/LtOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/LeOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/EqOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/NeOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/GeOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/GtOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/PlusOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/MinusOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/TimesOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/DivideOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/ModuloOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/NotOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/BitwiseNotOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/NegativeOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/PositiveOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/InvokeOperator.ts","../../../swim-core-js/@swim/structure/src/main/operator/InvokeOperatorInterpolator.ts","../../../swim-core-js/@swim/structure/src/main/selector/Selector.ts","../../../swim-core-js/@swim/structure/src/main/selector/IdentitySelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/GetSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/GetAttrSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/GetItemSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/KeysSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/ValuesSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/ChildrenSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/DescendantsSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/FilterSelector.ts","../../../swim-core-js/@swim/structure/src/main/selector/LiteralSelector.ts","../../../swim-core-js/@swim/structure/src/main/func/Func.ts","../../../swim-core-js/@swim/structure/src/main/func/LambdaFunc.ts","../../../swim-core-js/@swim/structure/src/main/func/BridgeFunc.ts","../../../swim-core-js/@swim/structure/src/main/func/MathModule.ts","../../../swim-core-js/@swim/structure/src/main/form/FormException.ts","../../../swim-core-js/@swim/structure/src/main/form/Form.ts","../../../swim-core-js/@swim/structure/src/main/form/TagForm.ts","../../../swim-core-js/@swim/structure/src/main/form/UnitForm.ts","../../../swim-core-js/@swim/structure/src/main/form/StringForm.ts","../../../swim-core-js/@swim/structure/src/main/form/NumberForm.ts","../../../swim-core-js/@swim/structure/src/main/form/BooleanForm.ts","../../../swim-core-js/@swim/structure/src/main/form/AnyForm.ts","../../../swim-core-js/@swim/structure/src/main/form/ItemForm.ts","../../../swim-core-js/@swim/structure/src/main/form/ValueForm.ts","../../../swim-core-js/@swim/structure/src/main/collections/ValueCursor.ts","../../../swim-core-js/@swim/structure/src/main/collections/ValueEntryCursor.ts","../../../swim-core-js/@swim/streamlet/src/main/Inlet.ts","../../../swim-core-js/@swim/streamlet/src/main/Outlet.ts","../../../swim-core-js/@swim/streamlet/src/main/OutletCombinators.ts","../../../swim-core-js/@swim/streamlet/src/main/KeyEffect.ts","../../../swim-core-js/@swim/streamlet/src/main/MapInlet.ts","../../../swim-core-js/@swim/streamlet/src/main/MapOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/MapOutletCombinators.ts","../../../swim-core-js/@swim/streamlet/src/main/StreamletException.ts","../../../swim-core-js/@swim/streamlet/src/main/StreamletScope.ts","../../../swim-core-js/@swim/streamlet/src/main/Streamlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractInlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractInoutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/KeyOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractMapInlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractMapOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractMapInoutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractMapInletOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractMapInletMapOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/OutletInlet.ts","../../../swim-core-js/@swim/streamlet/src/main/OutletMapInlet.ts","../../../swim-core-js/@swim/streamlet/src/main/ValueInput.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/MemoizeValueCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/MemoizeMapCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/FilterFieldsOperator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/FilterFieldsCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/MapValueOperator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/MapValueCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/MapFieldValuesOperator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/MapFieldValuesCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/ReduceFieldsOperator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/ReduceFieldsCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/WatchValueOperator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/WatchValueCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/WatchFieldsOperator.ts","../../../swim-core-js/@swim/streamlet/src/main/combinator/WatchFieldsCombinator.ts","../../../swim-core-js/@swim/streamlet/src/main/StreamletInlet.ts","../../../swim-core-js/@swim/streamlet/src/main/StreamletOutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/StreamletInoutlet.ts","../../../swim-core-js/@swim/streamlet/src/main/AbstractStreamlet.ts","../../../swim-core-js/@swim/streamlet/src/main/Out.ts","../../../swim-core-js/@swim/streamlet/src/main/Inout.ts","../../../swim-core-js/@swim/dataflow/src/main/RecordOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/AbstractRecordOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/RecordStreamlet.ts","../../../swim-core-js/@swim/dataflow/src/main/AbstractRecordStreamlet.ts","../../../swim-core-js/@swim/dataflow/src/main/RecordFieldUpdater.ts","../../../swim-core-js/@swim/dataflow/src/main/RecordModel.ts","../../../swim-core-js/@swim/dataflow/src/main/RecordScope.ts","../../../swim-core-js/@swim/dataflow/src/main/Reifier.ts","../../../swim-core-js/@swim/dataflow/src/main/selector/GetOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/BinaryOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/UnaryOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/ConditionalOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/OrOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/AndOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/BitwiseOrOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/BitwiseXorOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/BitwiseAndOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/LtOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/LeOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/EqOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/NeOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/GeOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/GtOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/PlusOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/MinusOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/TimesOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/DivideOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/ModuloOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/NotOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/BitwiseNotOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/NegativeOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/PositiveOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/operator/InvokeOutlet.ts","../../../swim-core-js/@swim/dataflow/src/main/Dataflow.ts","../../../swim-core-js/@swim/recon/src/main/Recon.ts","../../../swim-core-js/@swim/recon/src/main/parser/BlockParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/AttrParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/BlockItemParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/InlineItemParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/RecordParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/MarkupParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/DataParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/IdentParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/StringParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/RawStringParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/NumberParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/LambdaFuncParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/ConditionalOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/OrOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/AndOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/BitwiseOrOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/BitwiseXorOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/BitwiseAndOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/ComparisonOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/AttrExpressionParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/AdditiveOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/MultiplicativeOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/PrefixOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/InvokeOperatorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/PrimaryParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/LiteralParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/SelectorParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/ReconParser.ts","../../../swim-core-js/@swim/recon/src/main/parser/ReconStructureParser.ts","../../../swim-core-js/@swim/recon/src/main/writer/AttrWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/SlotWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/BlockWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/PrimaryWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/MarkupTextWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/DataWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/IdentWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/StringWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/LambdaFuncWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/ConditionalOperatorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/InfixOperatorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/PrefixOperatorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/InvokeOperatorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/LiteralSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/GetSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/GetAttrSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/GetItemSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/KeysSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/ValuesSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/ChildrenSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/DescendantsSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/FilterSelectorWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/ReconWriter.ts","../../../swim-core-js/@swim/recon/src/main/writer/ReconStructureWriter.ts","../../../swim-core-js/@swim/uri/src/main/UriException.ts","../../../swim-core-js/@swim/uri/src/main/Uri.ts","../../../swim-core-js/@swim/uri/src/main/UriScheme.ts","../../../swim-core-js/@swim/uri/src/main/UriAuthority.ts","../../../swim-core-js/@swim/uri/src/main/UriUser.ts","../../../swim-core-js/@swim/uri/src/main/UriHost.ts","../../../swim-core-js/@swim/uri/src/main/UriHostName.ts","../../../swim-core-js/@swim/uri/src/main/UriHostIPv4.ts","../../../swim-core-js/@swim/uri/src/main/UriHostIPv6.ts","../../../swim-core-js/@swim/uri/src/main/UriHostUndefined.ts","../../../swim-core-js/@swim/uri/src/main/UriPort.ts","../../../swim-core-js/@swim/uri/src/main/UriPath.ts","../../../swim-core-js/@swim/uri/src/main/UriPathSegment.ts","../../../swim-core-js/@swim/uri/src/main/UriPathSlash.ts","../../../swim-core-js/@swim/uri/src/main/UriPathEmpty.ts","../../../swim-core-js/@swim/uri/src/main/UriPathBuilder.ts","../../../swim-core-js/@swim/uri/src/main/UriPathForm.ts","../../../swim-core-js/@swim/uri/src/main/UriQuery.ts","../../../swim-core-js/@swim/uri/src/main/UriQueryParam.ts","../../../swim-core-js/@swim/uri/src/main/UriQueryUndefined.ts","../../../swim-core-js/@swim/uri/src/main/UriQueryBuilder.ts","../../../swim-core-js/@swim/uri/src/main/UriFragment.ts","../../../swim-core-js/@swim/uri/src/main/UriForm.ts","../../../swim-core-js/@swim/uri/src/main/UriCache.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriAbsoluteParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriSchemeParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriAuthorityParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriUserParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriHostParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriHostAddressParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriHostLiteralParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriPortParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriPathParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriQueryParser.ts","../../../swim-core-js/@swim/uri/src/main/parser/UriFragmentParser.ts","../../../swim-core-js/@swim/math/src/main/length/LengthException.ts","../../../swim-core-js/@swim/math/src/main/length/Length.ts","../../../swim-core-js/@swim/math/src/main/length/PxLength.ts","../../../swim-core-js/@swim/math/src/main/length/EmLength.ts","../../../swim-core-js/@swim/math/src/main/length/RemLength.ts","../../../swim-core-js/@swim/math/src/main/length/PctLength.ts","../../../swim-core-js/@swim/math/src/main/length/UnitlessLength.ts","../../../swim-core-js/@swim/math/src/main/length/LengthInterpolator.ts","../../../swim-core-js/@swim/math/src/main/length/LengthForm.ts","../../../swim-core-js/@swim/math/src/main/length/LengthParser.ts","../../../swim-core-js/@swim/math/src/main/angle/Angle.ts","../../../swim-core-js/@swim/math/src/main/angle/DegAngle.ts","../../../swim-core-js/@swim/math/src/main/angle/RadAngle.ts","../../../swim-core-js/@swim/math/src/main/angle/GradAngle.ts","../../../swim-core-js/@swim/math/src/main/angle/TurnAngle.ts","../../../swim-core-js/@swim/math/src/main/angle/AngleInterpolator.ts","../../../swim-core-js/@swim/math/src/main/angle/AngleForm.ts","../../../swim-core-js/@swim/math/src/main/angle/AngleParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Vector.ts","../../../swim-core-js/@swim/math/src/main/r2/R2VectorInterpolator.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Shape.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Point.ts","../../../swim-core-js/@swim/math/src/main/r2/R2PointInterpolator.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Curve.ts","../../../swim-core-js/@swim/math/src/main/r2/R2CurveParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2BezierCurve.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Segment.ts","../../../swim-core-js/@swim/math/src/main/r2/R2SegmentInterpolator.ts","../../../swim-core-js/@swim/math/src/main/r2/R2SegmentParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2QuadraticCurve.ts","../../../swim-core-js/@swim/math/src/main/r2/R2QuadraticCurveParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2CubicCurve.ts","../../../swim-core-js/@swim/math/src/main/r2/R2CubicCurveParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2EllipticCurve.ts","../../../swim-core-js/@swim/math/src/main/r2/R2EllipticCurveParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Spline.ts","../../../swim-core-js/@swim/math/src/main/r2/R2SplineBuilder.ts","../../../swim-core-js/@swim/math/src/main/r2/R2SplineParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Path.ts","../../../swim-core-js/@swim/math/src/main/r2/R2PathBuilder.ts","../../../swim-core-js/@swim/math/src/main/r2/R2PathParser.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Circle.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Box.ts","../../../swim-core-js/@swim/math/src/main/r2/R2BoxInterpolator.ts","../../../swim-core-js/@swim/math/src/main/r2/R2CircleInterpolator.ts","../../../swim-core-js/@swim/math/src/main/r2/R2Group.ts","../../../swim-core-js/@swim/math/src/main/transform/Transform.ts","../../../swim-core-js/@swim/math/src/main/transform/TransformForm.ts","../../../swim-core-js/@swim/math/src/main/transform/TransformParser.ts","../../../swim-core-js/@swim/math/src/main/transform/IdentityTransform.ts","../../../swim-core-js/@swim/math/src/main/transform/TranslateTransform.ts","../../../swim-core-js/@swim/math/src/main/transform/TranslateTransformInterpolator.ts","../../../swim-core-js/@swim/math/src/main/transform/TranslateTransformParser.ts","../../../swim-core-js/@swim/math/src/main/transform/ScaleTransform.ts","../../../swim-core-js/@swim/math/src/main/transform/ScaleTransformInterpolator.ts","../../../swim-core-js/@swim/math/src/main/transform/ScaleTransformParser.ts","../../../swim-core-js/@swim/math/src/main/transform/RotateTransform.ts","../../../swim-core-js/@swim/math/src/main/transform/RotateTransformInterpolator.ts","../../../swim-core-js/@swim/math/src/main/transform/RotateTransformParser.ts","../../../swim-core-js/@swim/math/src/main/transform/SkewTransform.ts","../../../swim-core-js/@swim/math/src/main/transform/SkewTransformInterpolator.ts","../../../swim-core-js/@swim/math/src/main/transform/SkewTransformParser.ts","../../../swim-core-js/@swim/math/src/main/transform/AffineTransform.ts","../../../swim-core-js/@swim/math/src/main/transform/AffineTransformInterpolator.ts","../../../swim-core-js/@swim/math/src/main/transform/AffineTransformParser.ts","../../../swim-core-js/@swim/math/src/main/transform/TransformList.ts","../../../swim-core-js/@swim/math/src/main/transform/TransformListInterpolator.ts","../../../swim-core-js/@swim/math/src/main/transform/TransformListParser.ts","../../../swim-core-js/@swim/geo/src/main/GeoProjection.ts","../../../swim-core-js/@swim/geo/src/main/GeoShape.ts","../../../swim-core-js/@swim/geo/src/main/GeoPoint.ts","../../../swim-core-js/@swim/geo/src/main/GeoPointInterpolator.ts","../../../swim-core-js/@swim/geo/src/main/GeoCurve.ts","../../../swim-core-js/@swim/geo/src/main/GeoSegment.ts","../../../swim-core-js/@swim/geo/src/main/GeoSegmentInterpolator.ts","../../../swim-core-js/@swim/geo/src/main/GeoSpline.ts","../../../swim-core-js/@swim/geo/src/main/GeoSplineBuilder.ts","../../../swim-core-js/@swim/geo/src/main/GeoPath.ts","../../../swim-core-js/@swim/geo/src/main/GeoPathBuilder.ts","../../../swim-core-js/@swim/geo/src/main/GeoBox.ts","../../../swim-core-js/@swim/geo/src/main/GeoTile.ts","../../../swim-core-js/@swim/geo/src/main/GeoBoxInterpolator.ts","../../../swim-core-js/@swim/geo/src/main/GeoGroup.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJson.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonGeometry.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonPoint.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonMultiPoint.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonLineString.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonMultiLineString.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonPolygon.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonMultiPolygon.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonGeometryCollection.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonFeature.ts","../../../swim-core-js/@swim/geo/src/main/json/GeoJsonFeatureCollection.ts","../../../swim-core-js/@swim/time/src/main/TimeZone.ts","../../../swim-core-js/@swim/time/src/main/TimeZoneForm.ts","../../../swim-core-js/@swim/time/src/main/DateTime.ts","../../../swim-core-js/@swim/time/src/main/DateTimeInterpolator.ts","../../../swim-core-js/@swim/time/src/main/DateTimeForm.ts","../../../swim-core-js/@swim/time/src/main/DateTimeParser.ts","../../../swim-core-js/@swim/time/src/main/format/DateTimeLocale.ts","../../../swim-core-js/@swim/time/src/main/format/DateTimeSpecifiers.ts","../../../swim-core-js/@swim/time/src/main/format/DateTimeFormat.ts","../../../swim-core-js/@swim/time/src/main/format/YearFormat.ts","../../../swim-core-js/@swim/time/src/main/format/MonthOfYearFormat.ts","../../../swim-core-js/@swim/time/src/main/format/MonthFormat.ts","../../../swim-core-js/@swim/time/src/main/format/ShortMonthFormat.ts","../../../swim-core-js/@swim/time/src/main/format/DayOfMonthFormat.ts","../../../swim-core-js/@swim/time/src/main/format/WeekdayFormat.ts","../../../swim-core-js/@swim/time/src/main/format/ShortWeekdayFormat.ts","../../../swim-core-js/@swim/time/src/main/format/Hour24Format.ts","../../../swim-core-js/@swim/time/src/main/format/Hour12Format.ts","../../../swim-core-js/@swim/time/src/main/format/PeriodFormat.ts","../../../swim-core-js/@swim/time/src/main/format/MinuteFormat.ts","../../../swim-core-js/@swim/time/src/main/format/SecondFormat.ts","../../../swim-core-js/@swim/time/src/main/format/MillisecondFormat.ts","../../../swim-core-js/@swim/time/src/main/format/PatternFormat.ts","../../../swim-core-js/@swim/time/src/main/format/YearParser.ts","../../../swim-core-js/@swim/time/src/main/format/MonthOfYearParser.ts","../../../swim-core-js/@swim/time/src/main/format/MonthParser.ts","../../../swim-core-js/@swim/time/src/main/format/ShortMonthParser.ts","../../../swim-core-js/@swim/time/src/main/format/DayOfMonthParser.ts","../../../swim-core-js/@swim/time/src/main/format/WeekdayParser.ts","../../../swim-core-js/@swim/time/src/main/format/ShortWeekdayParser.ts","../../../swim-core-js/@swim/time/src/main/format/Hour24Parser.ts","../../../swim-core-js/@swim/time/src/main/format/Hour12Parser.ts","../../../swim-core-js/@swim/time/src/main/format/PeriodParser.ts","../../../swim-core-js/@swim/time/src/main/format/MinuteParser.ts","../../../swim-core-js/@swim/time/src/main/format/SecondParser.ts","../../../swim-core-js/@swim/time/src/main/format/MillisecondParser.ts","../../../swim-core-js/@swim/time/src/main/format/PatternParser.ts","../../../swim-core-js/@swim/time/src/main/interval/TimeInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/FilterTimeInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/YearInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/YearsInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/MonthInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/WeekInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/DayInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/HourInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/MinuteInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/SecondInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/MillisecondInterval.ts","../../../swim-core-js/@swim/time/src/main/interval/MillisecondsInterval.ts","../../../swim-core-js/@swim/time/src/main/scale/TimeDomain.ts","../../../swim-core-js/@swim/time/src/main/scale/TimeDomainInterpolator.ts","../../../swim-core-js/@swim/time/src/main/scale/TimeRange.ts","../../../swim-core-js/@swim/time/src/main/scale/TimeRangeInterpolator.ts","../../../swim-core-js/@swim/time/src/main/scale/TimeScale.ts","../../../swim-core-js/@swim/time/src/main/scale/TimeScaleInterpolator.ts","../../../swim-host-js/@swim/warp/src/main/Envelope.ts","../../../swim-host-js/@swim/warp/src/main/HostAddressed.ts","../../../swim-host-js/@swim/warp/src/main/LaneAddressed.ts","../../../swim-host-js/@swim/warp/src/main/LinkAddressed.ts","../../../swim-host-js/@swim/warp/src/main/EventMessage.ts","../../../swim-host-js/@swim/warp/src/main/CommandMessage.ts","../../../swim-host-js/@swim/warp/src/main/LinkRequest.ts","../../../swim-host-js/@swim/warp/src/main/LinkedResponse.ts","../../../swim-host-js/@swim/warp/src/main/SyncRequest.ts","../../../swim-host-js/@swim/warp/src/main/SyncedResponse.ts","../../../swim-host-js/@swim/warp/src/main/UnlinkRequest.ts","../../../swim-host-js/@swim/warp/src/main/UnlinkedResponse.ts","../../../swim-host-js/@swim/warp/src/main/AuthRequest.ts","../../../swim-host-js/@swim/warp/src/main/AuthedResponse.ts","../../../swim-host-js/@swim/warp/src/main/DeauthRequest.ts","../../../swim-host-js/@swim/warp/src/main/DeauthedResponse.ts","../../../swim-host-js/@swim/client/src/main/host/Host.ts","../../../swim-host-js/@swim/client/src/main/host/RemoteHost.ts","../../../swim-host-js/@swim/client/src/main/host/WebSocketHost.ts","../../../swim-host-js/@swim/client/src/main/downlink/DownlinkModel.ts","../../../swim-host-js/@swim/client/src/main/downlink/Downlink.ts","../../../swim-host-js/@swim/client/src/main/downlink/EventDownlinkModel.ts","../../../swim-host-js/@swim/client/src/main/downlink/EventDownlink.ts","../../../swim-host-js/@swim/client/src/main/downlink/ListDownlinkModel.ts","../../../swim-host-js/@swim/client/src/main/downlink/ListDownlink.ts","../../../swim-host-js/@swim/client/src/main/downlink/MapDownlinkModel.ts","../../../swim-host-js/@swim/client/src/main/downlink/MapDownlink.ts","../../../swim-host-js/@swim/client/src/main/downlink/ValueDownlinkModel.ts","../../../swim-host-js/@swim/client/src/main/downlink/ValueDownlink.ts","../../../swim-host-js/@swim/client/src/main/downlink/DownlinkRecord.ts","../../../swim-host-js/@swim/client/src/main/downlink/MapDownlinkRecord.ts","../../../swim-host-js/@swim/client/src/main/downlink/DownlinkReifier.ts","../../../swim-host-js/@swim/client/src/main/downlink/DownlinkStreamlet.ts","../../../swim-host-js/@swim/client/src/main/ref/BaseRef.ts","../../../swim-host-js/@swim/client/src/main/ref/LaneRef.ts","../../../swim-host-js/@swim/client/src/main/ref/NodeRef.ts","../../../swim-host-js/@swim/client/src/main/ref/HostRef.ts","../../../swim-host-js/@swim/client/src/main/client/WarpClient.ts","../../../swim-host-js/@swim/client/src/main/client/global.ts","../../../swim-host-js/@swim/client/src/main/service/WarpService.ts","../../../swim-host-js/@swim/client/src/main/service/WarpProvider.ts","../../../swim-host-js/@swim/client/src/main/fastener/DownlinkFastener.ts","../../../swim-host-js/@swim/client/src/main/fastener/EventDownlinkFastener.ts","../../../swim-host-js/@swim/client/src/main/fastener/ListDownlinkFastener.ts","../../../swim-host-js/@swim/client/src/main/fastener/MapDownlinkFastener.ts","../../../swim-host-js/@swim/client/src/main/fastener/ValueDownlinkFastener.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintGroup.ts","../../../swim-core-js/@swim/constraint/src/main/ConstraintSolver.ts","../../../swim-core-js/@swim/fastener/src/main/hierarchy/GenericHierarchy.ts","../../../swim-core-js/@swim/streamlet/src/main/In.ts","../../../swim-host-js/@swim/client/src/main/downlink/ListDownlinkRecord.ts","../../../swim-core-js/@swim/streamlet/src/main/MapInput.ts","../../../swim-core-js/@swim/streamlet/src/main/MapOutput.ts","../../../swim-host-js/@swim/client/src/main/downlink/ValueDownlinkRecord.ts","../../../swim-core-js/@swim/streamlet/src/main/ValueOutput.ts"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Random","window","crypto","fillBytes","array","getRandomValues","msCrypto","Int8Array","Math","round","random","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","TypeError","ByteOrder","value","enumerable","get","nativeEndian","bom","ArrayBuffer","b","BigEndian","Error","LittleEndian","configurable","Murmur3","code","rotl","NativeOrder","mixUint8ArrayBE","mixUInt8ArrayLE","offset","limit","word","mix","string","mixStringBE","mixStringLE","k","n","utf8Length","codePointAt","charCodeAt","Strings","offsetByCodePoints","distance","Lazy","propertyKey","descriptor","writable","call","this","method","Identity","x","y","xh","hash","yh","NaN","nextId","hashCode","_hashCode","Booleans","Equivalent","epsilon","equivalentTo","is","object","Epsilon","Numbers","isNaN","abs","hashArrayBuffer","hashFloat64Array","Float64Array","hashInt32Array","mash","mixString","index","Number","c1","c2","count","Identifiers","identifier","isStartChar","isPartChar","isReserved","Functions","Constructors","name","Equals","equals","HashCode","Compare","compareTo","Objects","xKeys","keys","yKeys","Values","equal","equivalent","p","q","min","order","xKey","yKey","compare","hashValue","Date","getTime","Array","isArray","Arrays","freeze","inserted","newElement","oldArray","newArray","element","removed","oldElement","empty","FromAny","fromAny","ToAny","toAny","Mapping","_super","domain","range","mapping","setPrototypeOf","prototype","create","constructor","that","canEqual","toString","Function","Domain","x0","x1","Range","unit","contains","LinearDomain","y0","y1","u","LinearRange","Interpolate","interpolateTo","Interpolator","interpolator","IdentityInterpolator","NumberInterpolator","ArrayInterpolator","StepInterpolator","map","transform","InterpolatorMap","InterpolatorInterpolator","interpolators","interpolatorCount","Timing","easing","t0","t1","timing","t","max","withDomain","withDuration","dt","overRange","Tweening","fromInit","init","Easing","linear","type","quadIn","quadOut","quadInOut","cubicIn","cubicOut","cubicInOut","quartIn","quartOut","quartInOut","expoIn","expoOut","expoInOut","circIn","circOut","circInOut","backIn","backOut","backInOut","elasticIn","elasticOut","elasticInOut","bounceIn","bounceOut","bounceInOut","v","pow","sqrt","st","m","s","PI","asin","sin","st1","invert","tweening","dx","LinearDomainInterpolator","x00","x01","x10","x11","LinearRangeInterpolator","y00","y01","y10","y11","Scale","ContinuousScale","LinearScale","scale","inverse","clampDomain","xMin","xMax","zMin","zMax","dy","z","dz","xSum","solveDomain","x2","y2","reflect","y3","x3","LinearScaleInterpolator","s0","s1","Creatable","Initable","Observable","Consumable","Service","roots","observers","attachRoot","root","oldRoots","newRoots","needsAttach","willAttach","willAttachRoot","onAttach","onAttachRoot","didAttachRoot","didAttach","observer","serviceWillAttachRoot","serviceDidAttachRoot","detachRoot","needsDetach","willDetach","willDetachRoot","onDetach","onDetachRoot","didDetachRoot","didDetach","serviceWillDetachRoot","serviceDidDetachRoot","attached","serviceWillAttach","serviceDidAttach","serviceWillDetach","serviceDidDetach","observe","oldObservers","newObservers","willObserve","onObserve","didObserve","unobserve","willUnobserve","onUnobserve","didUnobserve","forEachObserver","callback","result","Cursor","set","newValue","delete","static","CursorEmpty","CursorUnary","CursorArray","isEmpty","head","step","skip","hasNext","nextIndex","next","done","hasPrevious","previousIndex","previous","super","HashGenCacheMap","size","buckets","gen4Hits","gen3Hits","gen2Hits","gen1Hits","misses","bucket","gen4Key","gen4Val","gen4Weight","gen3Key","gen3Val","gen3Weight","HashGenCacheMapBucket","gen2Key","gen2Val","gen2Weight","gen1Key","gen1Val","gen1Weight","put","remove","clear","hits","hitRatio","HashGenCacheSet","HashGenCacheSetBucket","AssertException","message","assert","condition","ok","notOk","lhs","rhs","notEqual","identical","notIdentical","instanceOf","notInstanceOf","compareLessThan","compareNotLessThan","compareLessThanOrEqual","compareNotLessThanOrEqual","compareEqual","compareNotEqual","compareGreaterThanOrEqual","compareNotGreaterThanOrEqual","compareGreaterThan","compareNotGreaterThan","Severity","level","label","isTrace","TRACE_LEVEL","isDebug","DEBUG_LEVEL","isInfo","INFO_LEVEL","isNote","NOTE_LEVEL","isWarning","WARNING_LEVEL","isError","ERROR_LEVEL","isAlert","ALERT_LEVEL","isFatal","FATAL_LEVEL","localeCompare","trace","debug","info","note","warning","error","alert","fatal","_trace","_debug","_info","_note","_warning","_error","_alert","_fatal","Tag","Mark","line","column","withNote","at","start","end","union","Span","from","shift","mark","display","output","Format","displayNumber","write","debugNumber","debugString","zero","tmp","OutputStyle","settings","isStyled","OutputSettings","lineSeparator","pretty","styled","precision","withLineSeparator","copy","isPretty","asPretty","asStyled","withPrecision","prettyStyled","standard","InputException","InputSettings","stripped","isStripped","asStripped","Input","trap","InputEmpty","InputDone","InputError","id","isCont","isDone","isPart","asPart","part","seek","withId","withMark","withSettings","clone","StringInput","OutputException","Output","writeln","displayAny","debugAny","flush","push","tokens","OutputFull","OutputDone","OutputError","StringOutput","isFull","token","String","fromCharCode","concat","bind","WriterException","Writer","feed","input","fork","asDone","asError","andThen","WriterSequence","WriterEnd","WriterDone","WriterError","StringWriter","pull","Unicode","isSpace","isNewline","import","e","Promise","reject","then","os","EOL","reason","stringOutput","isFinite","floor","digits","decimal","debugChar","encodeHex","stringInput","prefix","prefixes","exponential","toExponential","exponentIndex","indexOf","exponent","slice","power","scaled","trimTrailingZeros","toFixed","i1","i0","duration","millis","separator","SECOND","MINUTE","HOUR","DAY","WEEK","weeks","days","hours","minutes","seconds","Base10","Base10NumberParser","parse","Base10IntegerWriter","Diagnostic","tag","severity","cause","lineDigits","countDigits","contextLines","displayMessage","displayAnchor","cont","displayContext","formatSeverity","reset","bold","displayLineLeadArrow","displayLineLead","causeOrder","displayLineLeadEllipsis","displayLines","displayNote","startLine","endLine","consumeLineText","displayLine","displayLineComment","displaySingleLine","displayStartLine","displayEndLine","displayMidLine","displayLineLeadNumber","displayLineText","comment","displayLineLeadComment","blueBold","padding","redBold","yellowBold","greenBold","cyanBold","magentaBold","source","expected","InputBuffer","InputBufferEmpty","InputBufferDone","InputBufferError","withIndex","withLimit","capacity","remaining","has","tokenOrString","OutputBuffer","OutputBufferFull","OutputBufferDone","OutputBufferError","ParserException","diagnostic","Parser","ParserDone","ParserError","tail","ByteOutput","expand","toUint8Array","cloneArray","ByteOutputUint8Array","ByteOutputBuffer","buffer","Binary","initialCapacity","UtfErrorMode","isReplacement","UtfErrorModeFatal","UtfErrorModeReplacement","nonZero","replacementChar","isNonZero","asNonZero","fatalNonZero","replacementNonZero","replacement","Base16","alphabet","encodeDigit","uint8ArrayWriter","Base16Writer","writeUint8Array","writeInteger","width","Base16IntegerWriter","writeIntegerLiteral","writeLiteral","lowercase","uppercase","decodeDigit","Base16Parser","Utf8DecodedOutput","errorMode","c3","have","c4","invalid","base16","Utf8EncodedOutput","Utf8","sizeOf","decodedOutput","sign","mode","Base10DecimalParser","unexpected","isDigit","writeQuantum","Base64","w","parser","Base64Parser","parseUint8Array","Base64Writer","standardPadded","Base64Standard","standardUnpadded","padded","urlPadded","Base64Url","urlUnpadded","isPadded","asPadded","url","base64","Affinity","Mask","Shift","FastenerContext","fastenerContext","fastenerName","fastenerBound","fastener","getFastener","contextClass","fastenerClass","getFastenerClass","setFastener","hasOwnProperty","fastenerClassMap","getPrototypeOf","superContextClass","factory","fastenerExtends","extends","getSuperFastenerClass","define","lazy","fastenerClassInitMap","staticName","hasFastener","Fastener","decorator","setFlags","flags","hasAffinity","affinity","initAffinity","minAffinity","newAffinity","oldAffinity","Extrinsic","Reflexive","willSetAffinity","onSetAffinity","didSetAffinity","setAffinity","inherited","superFastener","Intrinsic","setInherited","inherits","InheritsFlag","initInherits","superName","setInherits","unbindSuperFastener","willSetInherits","onSetInherits","didSetInherits","bindSuperFastener","InheritedFlag","willInherit","onInherit","didInherit","willUninherit","onUninherit","didUninherit","getSuperFastener","owner","familyType","willBindSuperFastener","attachSubFastener","onBindSuperFastener","didBindSuperFastener","willUnbindSuperFastener","detachSubFastener","onUnbindSuperFastener","didUnbindSuperFastener","subFastener","DecoherentFlag","setCoherent","coherent","decohere","decohereFastener","recohere","MountedFlag","mount","willMount","onMount","didMount","unmount","willUnmount","onUnmount","didUnmount","construct","extend","className","classMembers","classIdentifier","isValid","classProperties","classMemberNames","getOwnPropertyNames","classMemberName","superClass","FlagShift","FlagMask","Property","setState","state","subFasteners","splice","getSuperState","superState","getSuperStateOr","elseState","getState","getStateOr","newState","oldState","equalState","willSetState","onSetState","didSetState","decohereSubFasteners","updateFlags","requireUpdate","decohereSubFastener","isDefined","propertyClass","property","specialize","StringProperty","NumberProperty","Boolean","BooleanProperty","initState","number","Animator","stateChanged","setValue","didInterrupt","startTweening","stopTweening","animated","DivergedFlag","InterruptFlag","getSuperValue","superValue","getSuperValueOr","elseValue","getValue","getValueOr","oldValue","willSetValue","onSetValue","didSetValue","setInterpolatedValue","tweenInherited","tween","willTransition","didTransition","TweeningFlag","willStartTweening","onStartTweening","didStartTweening","willStopTweening","onStopTweening","didStopTweening","animatorClass","animator","StringAnimator","NumberAnimator","BooleanAnimator","Provider","service","Inherited","Transient","getService","getServiceOr","elseService","createService","observes","providerClass","provider","Hierarchy","uid","fasteners","decoherent","setKey","attachParent","parent","willAttachParent","mounted","cascadeMount","onAttachParent","didAttachParent","detachParent","willDetachParent","cascadeUnmount","onDetachParent","didDetachParent","insertChildFlags","InsertChildFlags","willInsertChild","child","onInsertChild","didInsertChild","cascadeInsert","removeChildFlags","RemoveChildFlags","willRemoveChild","onRemoveChild","didRemoveChild","traversing","RemovingFlag","removeChild","getSuper","superBound","getBase","baseBound","base","mountFlags","MountFlags","TraversingFlag","mountChildren","mountFasteners","forEachChild","unmountChildren","unmountFasteners","immediate","newFastener","oldFastener","_a","detachFastener","attachFastener","willAttachFastener","onAttachFastener","didAttachFastener","willDetachFastener","onDetachFastener","didDetachFastener","getLazyFastener","parentFastener","recohereFasteners","decoherentCount","performance","now","callObservers","args","KeysCursor","cursor","ValuesCursor","NodeCursor","pages","childIndex","childCursor","pageCursor","page","pageSize","reversePageCursor","BTreeContext","pageSplitSize","pageShouldSplit","arity","pageShouldMerge","BTree","BTreePage","getEntry","firstKey","entry","firstEntry","firstValue","lastKey","lastEntry","lastValue","nextKey","nextEntry","nextValue","previousKey","previousEntry","previousValue","oldRoot","newRoot","updated","balanced","drop","lower","take","upper","cleared","reduced","identity","accumulator","combiner","fold","forEach","thisArg","forEachKey","forEachValue","values","entries","reverseKeys","reverseValues","reverseEntries","tree","BTreeLeaf","slots","minKey","maxKey","lookup","updatedSlot","insertedSlot","oldSlots","newSlots","removedSlot","split","newPages","newLeftPage","splitLeft","newRightPage","splitRight","newKnots","BTreeNode","slot","lo","hi","mid","knots","xx","oldPage","newPage","updatedPageSplit","updatedPage","oldKnots","newSize","oldPages","updatedPageMerge","midPages","midKnots","replacedPage","removedPage","newArity","newNode","BTreeNodeCursor","STreeContext","identify","STree","STreePage","RangeError","insert","newValues","pop","unshift","move","fromIndex","toIndex","deleteCount","deleted","STreeLeaf","updatedItem","oldItems","oldSlot","insertedItem","STreeNode","subIndex","STreeNodeCursor","ConstraintId","ConstraintMap","getField","item","last","newIndex","ConstraintSymbol","ConstraintSlack","isExternal","isDummy","isInvalid","addConstraintCondition","constraint","solver","removeConstraintCondition","updateConstraintSolution","ConstraintDummy","ConstraintError","ConstraintInvalid","ConstraintExpression","constant","expressions","terms","expression","ConstraintTerm","variable","field","coefficient","subterms","j","ConstraintSum","ConstraintProduct","ConstraintConstant","isConstant","plus","sum","negative","oldTerms","newTerms","minus","times","scalar","divide","product","term","ConstraintProperty","evaluateConstraintVariable","constrained","toNumber","setStrength","strength","ConstraintStrength","ConstrainedFlag","constrain","conditionCount","stopConstraining","startConstraining","updateConstraintVariable","ConstrainingFlag","willStartConstraining","onStartConstraining","didStartConstraining","constraintScope","ConstraintScope","addConstraintVariable","willStopConstraining","onStopConstraining","didStopConstraining","removeConstraintVariable","setConstraintVariable","constraining","Strong","ConstraintAnimator","Required","clip","Medium","Weak","Constraint","scope","relation","isConstrained","hasConstraint","addConstraint","removeConstraint","ConstraintRow","symbol","cells","setSymbol","invalidate","setConstant","add","insertSymbol","insertRow","removeSymbol","negate","solveFor","solveForEx","coefficientFor","substitute","row","Item","record","Record","updatedAttr","setAttr","setSlot","appended","items","prepended","lt","Bool","absent","le","eq","ne","ge","gt","invoke","filter","predicate","selector","Selector","literal","evaluate","interpreter","cast","form","orElse","coerce","precedence","iterator","unary","ItemInterpolator","Extant","extant","Absent","Value","MathModule","commit","Field","isDistinct","isDefinite","toValue","flattened","unflattened","of","header","headers","body","getAttr","getSlot","getItem","conditional","thenTerm","elseTerm","or","and","lambda","template","stringValue","numberValue","booleanValue","FieldInterpolator","Text","Attr","Slot","$key","$value","ImmutableFlag","updatedValue","bitwiseOr","Expression","BitwiseOrOperator","bitwiseXor","BitwiseXorOperator","bitwiseAnd","BitwiseAndOperator","PlusOperator","MinusOperator","TimesOperator","DivideOperator","modulo","ModuloOperator","not","bitwiseNot","positive","Interpreter","isAliased","isMutable","alias","branch","SlotInterpolator","typeOrder","keyEquals","keyInterpolator","valueInterpolator","AttrInterpolator","LtOperator","LeOperator","EqOperator","NeOperator","GeOperator","GtOperator","LambdaFunc","ValueBuilder","Num","Data","wrap","fromArray","fromObject","fieldCount","isObject","valueCount","member","modified","lastIndexOf","subRecord","attr","pushScope","changed","oldItem","newItem","popScope","recordString","itemString","toArray","toObject","RecordCursor","RecordInterpolator","xs","ys","RecordMap","AliasedFlag","pushField","pushValue","direction","setItem","table","RecordMapView","hashTable","setAliased","pushAliased","setMutable","updateMutable","pushMutable","setAttrAliased","setAttrMutable","updateAttrMutable","setSlotAliased","setSlotMutable","updateSlotMutable","setItemAliased","setItemMutable","newItems","spliceAliased","spliceMutable","deleteAliased","deleteMutable","itemCount","clearAliased","clearMutable","l","getByte","setByte","setByteAliased","setByteMutable","addByte","addByteAliased","addByteMutable","addData","data","addUint8Array","addUint8ArrayAliased","addUint8ArrayMutable","asUint8Array","byteOffset","writeBase16","toBase16","writeBase64","toBase64","xn","yn","mixUint8Array","writer","DataOutput","valueOf","text","cache","TextOutput","isInfinite","isUint32","Uint32Flag","isUint64","Uint64Flag","ceil","NumInterpolator","negativeZero","one","negativeOne","nan","Infinity","num","TypeMask","true","false","ConditionalOperator","OrOperator","AndOperator","NotOperator","BitwiseNotOperator","NegativeOperator","PositiveOperator","Operator","operand1","operator","operand2","operand","BinaryOperator","BinaryOperatorInterpolator","operand1Interpolator","operand2Interpolator","binary","UnaryOperator","UnaryOperatorInterpolator","operandInterpolator","ifTerm","willOperate","didOperate","ConditionalOperatorInterpolator","ifTermInterpolator","thenTermInterpolator","elseTermInterpolator","InterpreterException","InterpreterSettings","maxScopeDepth","withMaxScopeDepth","scopeStack","scopeDepth","peekScope","getScope","oldScopeStack","newScopeStack","swapScope","newScope","oldScope","willSelect","didSelect","willTransform","didTransform","objects","scopes","globalScope","argument1","argument2","InvokeOperator","func","Func","InvokeOperatorInterpolator","funcInterpolator","argsInterpolator","selected","forSelected","GetSelector","GetAttrSelector","GetItemSelector","children","descendants","FilterSelector","debugThen","IdentitySelector","KeysSelector","ValuesSelector","ChildrenSelector","DescendantsSelector","LiteralSelector","mapSelected","oldField","oldKey","newKey","oldChild","newChild","filterSelected","bindings","params","binding","arg","BridgeFunc","MaxFunc","MinFunc","AbsFunc","CeilFunc","FloorFunc","RoundFunc","SqrtFunc","PowFunc","RateFunc","RandomFunc","rate","period","v0","dv","FormException","Form","withTag","TagForm","withUnit","UnitForm","StringForm","NumberForm","BooleanForm","AnyForm","ItemForm","ValueForm","mold","ValueCursor","ValueEntryCursor","keyForm","valueForm","pair","Inlet","inlet","bindInput","unbindInput","Outlet","outlet","outputIterator","bindOutput","unbindOutput","OutletCombinators","memoize","watch","combinator","MemoizeValueCombinator","MapValueCombinator","WatchValueCombinator","KeyEffect","MapInlet","decohereOutputKey","recohereOutputKey","MapOutlet","keyIterator","MapOutletCombinators","reduce","MemoizeMapCombinator","FilterFieldsCombinator","MapFieldValuesCombinator","ReduceFieldsCombinator","WatchFieldsCombinator","StreamletException","StreamletScope","Streamlet","streamlet","setStreamletScope","setStreamletContext","AbstractInlet","version","newInput","oldInput","disconnectInputs","disconnectOutputs","decohereOutput","willDecohereOutput","onDecohereOutput","didDecohereOutput","recohereOutput","willRecohereOutput","recohereInput","onRecohereOutput","didRecohereOutput","AbstractOutlet","outputs","unbindOutputs","oldOutputs","decohereInput","willDecohereInput","onDecohereInput","didDecohereInput","willRecohereInput","onRecohereInput","didRecohereInput","AbstractInoutlet","willDecohere","onDecohere","didDecohere","willRecohere","onRecohere","didRecohere","KeyOutlet","AbstractMapInlet","effects","effect","oldEffects","willDecohereOutputKey","onDecohereOutputKey","didDecohereOutputKey","willRecohereOutputKey","recohereInputKey","onRecohereOutputKey","didRecohereOutputKey","AbstractMapOutlet","outlets","oldOutlets","keyOutlet","decohereInputKey","willDecohereInputKey","onDecohereInputKey","didDecohereInputKey","willRecohereInputKey","onRecohereInputKey","didRecohereInputKey","AbstractMapInoutlet","decohereKey","willDecohereKey","onDecohereKey","didDecohereKey","recohereKey","willRecohereKey","onRecohereKey","didRecohereKey","AbstractMapInletOutlet","AbstractMapInletMapOutlet","outputEffects","inputEffects","oldOutputEffects","oldInputEffects","oldEffect","newEffect","OutletInlet","OutletMapInlet","ValueInput","FilterFieldsOperator","MapValueOperator","MapFieldValuesOperator","ReduceFieldsOperator","accumulate","combine","WatchValueOperator","WatchFieldsOperator","StreamletInlet","willDecohereInlet","didDecohereInlet","willRecohereInlet","didRecohereInlet","StreamletOutlet","getOutput","willDecohereOutlet","didDecohereOutlet","willRecohereOutlet","didRecohereOutlet","StreamletInoutlet","InletDescriptor","OutletDescriptor","InoutletDescriptor","AbstractStreamlet","streamletScope","streamletContext","context","reflectInletKey","reflectOutletKey","inoutlet","onDecohereOutlets","onRecohereInlets","onRecohereOutlets","getInput","streamletPrototype","inlets","inletDescriptor","reflectInletField","reflectInoutletField","outletDescriptor","reflectOutletField","decohereOutlets","recohereInlets","recohereOutlets","_","reflectValueInletField","reflectMapInletField","reflectValueOutletField","reflectMapOutletField","inoutletDescriptor","reflectValueInoutletField","reflectMapInoutletField","inoutlets","options","Out","decorateOutlet","Inout","decorateInoutlet","RecordOutlet","AbstractRecordOutlet","hasOwn","RecordStreamlet","compile","reflectEachInlet","compileInlet","AbstractRecordStreamlet","reflectOutletCount","reflectOutletIndex","reflectEachOutlet","castInput","coerceInput","RecordFieldUpdater","RecordModel","fieldUpdaters","bindValue","expr","fieldUpdater","valueInput","Dataflow","oldFieldUpdaters","materialize","materializeItem","materializeField","materializeValue","RecordScope","compileItem","compileField","compileValue","reify","reifier","Reifier","system","reifyItem","model","GetOutlet","keyInlet","mapInlet","keyInput","mapInput","BinaryOutlet","operand1Inlet","operand2Inlet","operand1Input","operand2Input","UnaryOutlet","operandInlet","operandInput","argument","ConditionalOutlet","ifInlet","thenInlet","elseInlet","ifInput","thenInput","elseInput","OrOutlet","AndOutlet","BitwiseOrOutlet","BitwiseXorOutlet","BitwiseAndOutlet","LtOutlet","LeOutlet","EqOutlet","NeOutlet","GeOutlet","GtOutlet","PlusOutlet","MinusOutlet","TimesOutlet","DivideOutlet","ModuloOutlet","NotOutlet","BitwiseNotOutlet","NegativeOutlet","PositiveOutlet","InvokeOutlet","funcInlet","argsInlet","funcInput","argsInput","compileSelector","compileOperator","compileIdentitySelector","compileGetSelector","compileGetAttrSelector","compileGetItemSelector","compileKeysSelector","compileValuesSelector","compileChildrenSelector","compileDescendantsSelector","compileFilterSelector","getOutlet","compileConditionalOperator","compileBinaryOperator","compileUnaryOperator","compileInvokeOperator","ifOutlet","thenOutlet","elseOutlet","compileOrOperator","compileAndOperator","compileBitwiseOrOperator","compileBitwiseXorOperator","compileBitwiseAndOperator","compileLtOperator","compileLeOperator","compileEqOperator","compileNeOperator","compileGeOperator","compileGtOperator","compilePlusOperator","compileMinusOperator","compileTimesOperator","compileDivideOperator","compileModuloOperator","operand1Outlet","operand2Outlet","compileBinaryOutlet","compileNotOperator","compileBitwiseNotOperator","compileNegativeOperator","compilePositiveOperator","operandOutlet","compileUnaryOutlet","invokeOutlet","funcOutlet","argsOutlet","Recon","structureParser","ReconStructureParser","structureWriter","ReconStructureWriter","recon","parseBlockString","blockParser","sizeOfItem","sizeOfBlock","sizeOfBlockItem","writeItem","writeBlock","writeBlockItem","toBlockString","toData","encodedOutput","toBlockData","isWhitespace","isIdentStartChar","isIdentChar","toRecon","toReconBlock","parseRecon","BlockParser","builder","keyParser","valueParser","block","valueBuilder","parseBlockExpression","AttrParser","parseString","parseIdent","parseBlock","BlockItemParser","fieldParser","parseAttr","recordBuilder","parseRecord","parseMarkup","parseRawString","parseNumber","parseData","parseSelector","InlineItemParser","RecordParser","MarkupParser","textOutput","parseInlineItem","DataParser","base64Parser","dataOutput","IdentParser","ident","StringParser","quote","RawStringParser","NumberParser","DecimalParser","HexadecimalParser","uint32","uint64","LambdaFuncParser","bindingsParser","templateParser","parseConditionalOperator","ConditionalOperatorParser","ifParser","thenParser","elseParser","parseOrOperator","OrOperatorParser","lhsParser","rhsParser","parseAndOperator","AndOperatorParser","parseBitwiseOrOperator","BitwiseOrOperatorParser","parseBitwiseXorOperator","BitwiseXorOperatorParser","parseBitwiseAndOperator","BitwiseAndOperatorParser","parseComparisonOperator","ComparisonOperatorParser","parseAttrExpression","AttrExpressionParser","parseAdditiveOperator","AdditiveOperatorParser","parseMultiplicativeOperator","MultiplicativeOperatorParser","parsePrefixOperator","PrefixOperatorParser","operandParser","parseInvokeOperator","InvokeOperatorParser","exprParser","argsParser","parsePrimary","PrimaryParser","parseLiteral","LiteralParser","SelectorParser","parseInteger","ReconParser","parseBlockItem","parseLambdaFunc","bool","AttrWriter","sizeOfValue","isExtant","sizeOfBlockValue","writeValue","writeBlockValue","SlotWriter","BlockWriter","inBlock","inMarkup","inBraces","inBrackets","first","markupSafe","isExpression","isAttr","isText","sizeOfMarkupText","isRecord","isMarkupSafe","isField","isBool","isValue","isIdent","isNum","sizeOfSlot","writeMarkupText","writeSlot","PrimaryWriter","inParens","MarkupTextWriter","escape","DataWriter","IdentWriter","LambdaFuncWriter","sizeOfPrimary","writePrimary","ConditionalOperatorWriter","InfixOperatorWriter","writeString","PrefixOperatorWriter","InvokeOperatorWriter","LiteralSelectorWriter","sizeOfThen","writeThen","GetSelectorWriter","GetAttrSelectorWriter","GetItemSelectorWriter","KeysSelectorWriter","ValuesSelectorWriter","ChildrenSelectorWriter","DescendantsSelectorWriter","FilterSelectorWriter","ReconWriter","sizeOfAttr","writeAttr","isBlockSafe","sizeOfRecord","writeRecord","sizeOfData","writeData","sizeOfText","writeText","sizeOfNum","writeNum","sizeOfUint32","writeUint32","sizeOfUint64","writeUint64","sizeOfBool","writeBool","sizeOfLambdaFunc","writeLambdaFunc","sizeOfConditionalOperator","writeConditionalOperator","sizeOfInfixOperator","writeInfixOperator","sizeOfPrefixOperator","writePrefixOperator","sizeOfInvokeOperator","writeInvokeOperator","sizeOfIdentitySelector","writeIdentitySelector","sizeOfThenIdentitySelector","writeThenIdentitySelector","sizeOfLiteralSelector","writeLiteralSelector","sizeOfThenLiteralSelector","writeThenLiteralSelector","sizeOfGetSelector","writeGetSelector","sizeOfThenGetSelector","writeThenGetSelector","sizeOfGetAttrSelector","writeGetAttrSelector","sizeOfThenGetAttrSelector","writeThenGetAttrSelector","sizeOfGetItemSelector","writeGetItemSelector","sizeOfThenGetItemSelector","writeThenGetItemSelector","sizeOfKeysSelector","writeKeysSelector","sizeOfThenKeysSelector","writeThenKeysSelector","sizeOfValuesSelector","writeValuesSelector","sizeOfThenValuesSelector","writeThenValuesSelector","sizeOfChildrenSelector","writeChildrenSelector","sizeOfThenChildrenSelector","writeThenChildrenSelector","sizeOfDescendantsSelector","writeDescendantsSelector","sizeOfThenDescendantsSelector","writeThenDescendantsSelector","sizeOfFilterSelector","writeFilterSelector","sizeOfThenFilterSelector","writeThenFilterSelector","sizeOfExtant","writeExtant","sizeOfAbsent","writeAbsent","isSlot","sizeOfSelector","sizeOfOperator","sizeOfFunc","writeSelector","writeOperator","writeFunc","UriException","Uri","scheme","authority","path","query","fragment","withScheme","UriScheme","schemePart","withSchemePart","schemeName","withSchemeName","withAuthority","UriAuthority","authorityPart","withAuthorityPart","user","withUser","userPart","withUserPart","username","withUsername","password","withPassword","host","withHost","hostPart","withHostPart","hostAddress","hostName","withHostName","hostIPv4","withHostIPv4","hostIPv6","withHostIPv6","port","withPort","portPart","withPortPart","portNumber","withPortNumber","withPath","components","UriPath","pathPart","withPathPart","pathName","withPathName","withName","parentPath","basePath","appendedPath","appendedSlash","appendedSegment","segment","prependedPath","prependedSlash","prependedSegment","withQuery","UriQuery","queryPart","withQueryPart","updatedQuery","removedQuery","appendedQuery","prependedQuery","withFragment","UriFragment","fragmentPart","withFragmentPart","fragmentIdentifier","withFragmentIdentifier","endpoint","resolve","relative","removeDotSegments","isAbsolute","merge","unresolve","absolute","undefined","unmerge","uri","standardParser","UriParser","parseAbsoluteString","UriPathBuilder","UriQueryBuilder","UriForm","isUnreservedChar","isSubDelimChar","isSchemeChar","isAlpha","userInfo","isUserInfoChar","writeEncoded","isUserChar","address","isHostChar","isPathChar","isQueryChar","param","isParamChar","isFragmentChar","writePctEncoded","writeScheme","parseSchemeString","UriUser","UriHost","hostname","ipv4","ipv6","hostIPv5","UriPort","parseAuthorityString","writeUser","parseUserString","UriHostUndefined","UriHostName","UriHostIPv4","UriHostIPv6","parseHostString","writeHost","writeHostLiteral","parsePortString","isRelative","addPath","addSegment","foot","isSubpathOf","a","addSlash","UriPathSlash","rest","slash","prev","writePathSegment","UriPathEmpty","cacheSegment","UriPathSegment","parsePathString","UriPathForm","segmentCache","setTail","dealias","aliased","component","xi","addParam","addQuery","writeParam","writeQuery","UriQueryUndefined","cacheKey","UriQueryParam","parseQueryString","keyCache","writeFragment","parseFragmentString","UriCache","resolveCache","unresolveCache","pathEmpty","pathBuilder","queryBuilder","absoluteParser","UriAbsoluteParser","parseAbsolute","schemeParser","UriSchemeParser","parseScheme","authorityParser","UriAuthorityParser","parseAuthority","userParser","UriUserParser","parseUser","hostParser","UriHostParser","parseHost","hostAddressParser","UriHostAddressParser","parseHostAddress","hostLiteralParser","UriHostLiteralParser","parseHostLiteral","portParser","UriPortParser","parsePort","pathParser","UriPathParser","parsePath","queryParser","UriQueryParser","parseQuery","fragmentParser","UriFragmentParser","parseFragment","look","decodedString","toLowerCase","usernameOutput","passwordOutput","keyOutput","valueOutput","LengthException","Length","units","basis","emValue","pxValue","emUnit","remValue","remUnit","pctValue","pctUnit","px","em","rem","pct","to","LengthInterpolator","PxLength","EmLength","RemLength","PctLength","UnitlessLength","unitless","CSSUnitValue","defaultUnits","LengthParser","LengthForm","Node","node","Element","fontSize","getComputedStyle","parseFloat","parentNode","document","documentElement","toCssValue","l0","l1","fromValue","unitsOutput","parseDecimal","Angle","norm","total","deg","degValue","rad","radValue","grad","gradValue","turn","turnValue","AngleInterpolator","DegAngle","RadAngle","GradAngle","TurnAngle","AngleParser","AngleForm","a0","a1","angle","R2Vector","R2VectorInterpolator","isInit","v1","R2Shape","R2Box","yMin","yMax","bounds","R2Point","isTuple","fromTuple","R2Segment","R2Circle","vector","intersects","f","transformX","transformY","R2PointInterpolator","p0","p1","R2Curve","draw","drawMove","drawRest","transformDraw","transformDrawMove","transformDrawRest","writePath","writeMove","writeRest","toPathString","outputSettings","R2QuadraticCurve","R2CubicCurve","cx","cy","rx","ry","phi","da","R2EllipticCurve","R2CurveParser","x0Parser","y0Parser","command","R2SegmentParser","R2QuadraticCurveParser","R2CubicCurveParser","R2EllipticCurveParser","parseRest","R2BezierCurve","interpolateX","interpolateY","interpolate","containsPoint","containsSegment","ax","ay","bx","by","intersectsPoint","intersectsSegment","py","qx","qy","sx","sy","pqx","pqy","pqr","rs","rr","sr","moveTo","lineTo","R2SegmentInterpolator","x1Parser","y1Parser","x12","y12","x02","y02","quadraticCurveTo","x2Parser","y2Parser","x23","y23","x13","y13","x03","y03","bezierCurveTo","x3Parser","y3Parser","cos","a0x","a0y","a1x","a1y","b0x","b0y","b1x","b1y","b0","atan2","b1","db","toEndpoints","ellipse","ccw","large","sweep","cosPhi","sinPhi","cosA0","sinA0","cosA1","sinA1","x0p","y0p","rx2","ry2","x0p2","y0p2","sp","cxp","cyp","ux","uy","vx","vy","uv","uu","vv","acos","rxParser","ryParser","phiParser","fromEndpoints","R2Spline","curves","closed","boundingBox","pathString","isClosed","c0","curves0","curves1","subdivide","oldCurves","newCurves","curve","closePath","R2SplineBuilder","R2SplineParser","arcTo","dx01","dy01","dx12","dy12","r0x","r0y","r1x","r1y","r0x0","r0y0","r0x1","r0y1","r1x1","r1y1","r1x2","r1y2","intersection","arc","rect","h","xParser","yParser","curveParser","prevCurve","R2Path","splines","splines0","splines1","oldSplines","newSplines","spline","toAttributeString","R2PathBuilder","R2PathParser","splineParser","containsBox","containsCircle","dx0","dy0","dx1","dy1","r2","dxMin","dyMin","dxMax","dyMax","intersectsBox","intersectsCircle","unitX","unitY","dcx0","dcy0","dcx1","dcy1","uc","u0","u1","R2CircleInterpolator","height","top","right","bottom","left","center","hitY","hitX","d0","d1","R2BoxInterpolator","R2Group","shapes","oldShapes","newShapes","shape","Transform","translate","translateX","translateY","scaleX","scaleY","rotate","skew","skewX","skewY","toMatrix","toAffine","toCssTransformComponent","CSSTransformValue","AffineTransformInterpolator","IdentityTransform","TranslateTransform","ScaleTransform","RotateTransform","SkewTransform","tx","ty","AffineTransform","transforms","list","TransformList","fromCssTransform","fromCssTransformComponent","CSSTranslate","CSSRotate","CSSScale","CSSSkew","CSSMatrixComponent","TransformListParser","TransformForm","TransformParser","identOutput","TranslateTransformParser","ScaleTransformParser","RotateTransformParser","SkewTransformParser","AffineTransformParser","CSSKeywordValue","conformsTo","TranslateTransformInterpolator","fromCssValue","f0","f1","zParser","ScaleTransformInterpolator","cosA","sinA","RotateTransformInterpolator","angleParser","tan","SkewTransformInterpolator","multiply","m00","m10","m01","m11","m02","m12","det","MIN_VALUE","DOMMatrix","matrix","fromMatrix","entryParser","affine","yi","inverseTransforms","TransformListInterpolator","transforms0","transforms1","transformParser","GeoProjection","projection","project","unproject","GeoShape","GeoBox","lngMin","latMin","lngMax","latMax","GeoPoint","GeoSegment","GeoTile","lng","lat","normalized","oldLng","oldLat","newLng","normalizeLng","newLat","normalizeLat","GeoPointInterpolator","lng0","lat0","lng1","lat1","uw","ue","GeoCurve","interpolateLng","interpolateLat","lng01","lat01","forEachCoord","forEachCoordRest","GeoSegmentInterpolator","GeoSpline","points","p2","isPoints","fromPoints","GeoSplineBuilder","isAny","GeoPath","centroid","lngSum","latSum","isSplines","fromSplines","isAnySpline","GeoPathBuilder","west","south","east","north","southWest","northWest","southEast","northEast","containsTile","intersectsTile","bottomLeft","topRight","GeoBoxInterpolator","unprojectX","unprojectY","southWestTile","northWestTile","southEastTile","northEastTile","parentTile","atan","exp","GeoGroup","GeoJson","GeoJsonGeometry","GeoJsonFeature","GeoJsonFeatureCollection","toShape","toShapes","coordinates","geometries","GeoJsonPoint","GeoJsonMultiPoint","GeoJsonLineString","GeoJsonMultiLineString","GeoJsonPolygon","GeoJsonMultiPolygon","GeoJsonGeometryCollection","position","positions","lineString","multiLineString","polygons","polygon","multiPolygon","o","geometry","properties","feature","features","TimeZone","isUTC","isLocal","getTimezoneOffset","utc","local","forOffset","zone","forName","TimeZoneForm","DateTime","time","year","toUTCLocalDate","getUTCFullYear","withYear","month","day","hour","minute","second","millisecond","date","setUTCFullYear","setUTCMonth","setUTCDate","setUTCHours","setUTCMinutes","setUTCSeconds","setUTCMilliseconds","fromUTCLocalDate","getUTCMonth","withMonth","getUTCDate","withDay","getUTCHours","withHour","getUTCMinutes","withMinute","getUTCSeconds","withSecond","getUTCMilliseconds","withMillisecond","weekday","getUTCDay","toDate","DateTimeInterpolator","format","DateTimeFormat","iso8601","writeDate","UTC","positional","DateTimeForm","DateTimeParser","dateParser","DateTimeLocale","periods","Periods","weekdays","Weekdays","shortWeekdays","ShortWeekdays","months","Months","shortMonths","ShortMonths","DateTimeSpecifiers","locale","specifiers","Y","monthOfYear","B","withLocale","shortMonth","dayOfMonth","A","shortWeekday","H","hour24","I","hour12","M","S","L","parseDate","parseDateTime","YearFormat","MonthOfYearFormat","MonthFormat","ShortMonthFormat","DayOfMonthFormat","WeekdayFormat","ShortWeekdayFormat","Hour24Format","Hour12Format","PeriodFormat","MinuteFormat","SecondFormat","MillisecondFormat","pattern","PatternFormat","minDigits","maxDigits","writeDateNumber4","YearParser","writeDateNumber2","MonthOfYearParser","MonthParser","ShortMonthParser","DayOfMonthParser","WeekdayParser","ShortWeekdayParser","Hour24Parser","Hour12Parser","PeriodParser","MinuteParser","SecondParser","writeDateNumber3","MillisecondParser","charAt","PatternParser","parseDateNumber","parseDateString","TimeInterval","ds","FilterTimeInterval","YearInterval","MonthInterval","week","WeekInterval","DayInterval","HourInterval","MinuteInterval","SecondInterval","MillisecondInterval","MillisPerSecond","MillisPerMinute","MillisPerHour","UnitTimeInterval","every","YearsInterval","stride","dtz","MillisecondsInterval","TimeDomain","TimeRange","TimeDomainInterpolator","TimeRangeInterpolator","TimeScale","tMin","tMax","tSum","t2","t3","TimeScaleInterpolator","Envelope","withPrio","prio","withRate","EventMessage","CommandMessage","LinkRequest","LinkedResponse","SyncRequest","SyncedResponse","UnlinkRequest","UnlinkedResponse","AuthRequest","AuthedResponse","DeauthRequest","DeauthedResponse","HostAddressed","withNode","lane","withLane","withBody","LaneAddressed","LinkAddressed","Host","RemoteHost","hostUri","authenticated","session","sendBuffer","downlinks","downlinkCount","uriCache","reconnectTimer","reconnectTimeout","idleTimer","credentials","unlinkDelay","UnlinkDelay","maxReconnectTimeout","MaxReconnectTimeout","idleTimeout","IdleTimeout","sendBufferSize","SendBufferSize","isAuthenticated","isIdle","authenticate","isConnected","request","open","openDownlink","downlink","clearIdle","nodeUri","laneUri","nodeDownlinks","openUp","hostDidConnect","unlinkDownlink","onUnlinkRequest","closeDownlink","watchIdle","closeUp","onEnvelope","envelope","onEventMessage","onCommandMessage","onLinkRequest","onLinkedResponse","onSyncRequest","onSyncedResponse","onUnlinkedResponse","onAuthRequest","onAuthedResponse","onDeauthRequest","onDeauthedResponse","onUnknownEnvelope","resolvedMessage","response","resolvedResponse","hostDidAuthenticate","hostDidDeauthenticate","onConnect","onDisconnect","hostDidDisconnect","onError","hostDidFail","reconnect","setTimeout","clearReconnect","clearTimeout","checkIdle","close","closeHost","WebSocketHost","socket","readyState","OPEN","WebSocketConstructor","WebSocket","protocols","onopen","onWebSocketOpen","onmessage","onWebSocketMessage","onclose","onWebSocketClose","onerror","onWebSocketError","isOnline","send","ws","DownlinkModel","views","status","keepLinked","keepSynced","isLinked","Linked","isSynced","Synced","addDownlink","view","removeDownlink","oldViews","newViews","unlink","doUnlink","Linking","Syncing","Unlinking","sync","link","DownlinkFlags","Downlink","onEvent","onCommand","_b","willLink","_c","didLink","_d","willSync","_e","didSync","_f","willUnlink","_g","didUnlink","_h","didConnect","_j","didDisconnect","_k","didClose","_l","didFail","_m","ownHostUri","ownNodeUri","ownLaneUri","ownPrio","ownRate","ownBody","oldObserver","found","DownlinkInitForm","EventDownlinkModel","EventDownlink","getDownlink","ListDownlinkModel","listWillUpdate","oldEntry","listDidUpdate","newEntry","listWillRemove","listDidRemove","listWillMove","listDidMove","listWillClear","listDidClear","snapshot","event","onUpdateEvent","onInsertEvent","onMoveEvent","onRemoveEvent","onDropEvent","onTakeEvent","onClearEvent","listWillDrop","listDidDrop","listWillTake","listDidTake","ListDownlink","state0","willUpdate","didUpdate","willMove","didMove","willRemove","didRemove","willDrop","didDrop","willTake","didTake","willClear","didClear","ownValueForm","forValue","newObject","newObjects","apply","oldValues","oldObjects","newResult","oldObject","initialState","didAliasModel","MapDownlinkModel","mapWillUpdate","mapDidUpdate","mapWillRemove","mapDidRemove","mapWillDrop","mapDidDrop","mapWillTake","mapDidTake","mapWillClear","mapDidClear","MapDownlink","ownKeyForm","keyObject","nextKeyObject","nextObject","previousKeyObject","previousObject","ValueDownlinkModel","valueWillSet","valueDidSet","onSetEvent","ValueDownlink","willSet","didSet","DownlinkRecord","MapDownlinkRecord","DownlinkReifier","warp","reifyField","reifyValue","reifyModel","DownlinkStreamlet","bodyValue","downlinkRecord","inputHostUri","inputNodeUri","inputLaneUri","inputPrio","inputRate","inputBody","inputType","forString","forNumber","client","downlinkMap","downlinkValue","_reifier","BaseRef","openRef","closeRef","didAuthenticate","didDeauthenticate","LaneRef","hostRef","HostRef","nodeRef","NodeRef","laneRef","downlinkList","WarpClient","keepOnline","hosts","refs","online","onOnline","onOffline","watchOnline","addEventListener","removeEventListener","getHost","openHost","hostDownlinks","ref","WarpService","WarpProvider","global","DownlinkFastener","initHostUri","relink","initNodeUri","initLaneUri","initPrio","initRate","initBody","ownWarp","warpRef","warpProvider","createDownlink","bindDownlink","initDownlink","PendingFlag","ConsumingFlag","RelinkMask","consume","downlinkConsumer","oldConsumers","consumers","newConsumerrss","willConsume","onConsume","didConsume","startConsuming","unconsume","willUnconsume","onUnconsume","didUnconsume","stopConsuming","willStartConsuming","onStartConsuming","didStartConsuming","willStopConsuming","onStopConsuming","didStopConsuming","EventDownlinkFastener","ListDownlinkFastener","MapDownlinkFastener","ValueDownlinkFastener","constraints","enableConstraints","disableConstraints","constraintVariables","rows","infeasible","objective","artificial","invalidated","createRow","addConstraintRow","willAddConstraint","subject","chooseSubject","marker","addWithArtificialVariable","optimize","didAddConstraint","updateSolution","removeConstraintRow","willRemoveConstraint","removeConstraintEffects","leaving","getMarkerLeavingSymbol","didRemoveConstraint","constraintVariable","hasConstraintVariable","willAddConstraintVariable","didAddConstraintVariable","willRemoveConstraintVariable","didRemoveConstraintVariable","delta","willSetConstraintVariable","dualOptimize","other","didSetConstraintVariable","basic","slack","eplus","eminus","dummy","success","entering","anyPivotableSymbol","getEnteringSymbol","getLeavingSymbol","getDualEnteringSymbol","ratio","MAX_VALUE","coratio","r1","third","removeMarkerEffects","childMap","childCount","firstChild","lastChild","nextChild","targetIndex","previousChild","insertChildMap","removeChildMap","replaceChildMap","getChild","childBound","setChild","appendChild","prependChild","insertChild","replaceChild","removeChildren","decorateInlet"],"mappings":"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","file":"/Users/c9r/Swim/Code/swiminc/swim-js/swim-runtime-js/@swim/runtime/dist/swim-runtime.min.js","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport const Random = (function () {\n  const Random = {} as {\n    fillBytes(array: Int8Array | Uint8Array | Int16Array | Uint16Array | Int32Array | Uint32Array): void;\n  };\n\n  if (typeof window !== \"undefined\" && window.crypto !== void 0) {\n    Random.fillBytes = function (array: Int8Array | Uint8Array | Int16Array | Uint16Array | Int32Array | Uint32Array): void {\n      window.crypto.getRandomValues(array);\n    };\n  } else if (typeof window !== \"undefined\" && (window as any).msCrypto !== void 0) {\n    Random.fillBytes = function (array: Int8Array | Uint8Array | Int16Array | Uint16Array | Int32Array | Uint32Array): void {\n      ((window as any).msCrypto as Crypto).getRandomValues(array);\n    };\n  } else {\n    Random.fillBytes = function (array: Int8Array | Uint8Array | Int16Array | Uint16Array | Int32Array | Uint32Array): void {\n      if (array instanceof Int8Array) {\n        for (let i = 0; i < array.length; i += 1) {\n          array[i] = 128 - Math.round(Math.random() * 256);\n        }\n      } else if (array instanceof Uint8Array) {\n        for (let i = 0; i < array.length; i += 1) {\n          array[i] = Math.round(Math.random() * 256);\n        }\n      } else if (array instanceof Int16Array) {\n        for (let i = 0; i < array.length; i += 1) {\n          array[i] = 32768 - Math.round(Math.random() * 65536);\n        }\n      } else if (array instanceof Uint16Array) {\n        for (let i = 0; i < array.length; i += 1) {\n          array[i] = Math.round(Math.random() * 65536);\n        }\n      } else if (array instanceof Int32Array) {\n        for (let i = 0; i < array.length; i += 1) {\n          array[i] = 2147483648 - Math.round(Math.random() * 4294967296);\n        }\n      } else if (array instanceof Uint32Array) {\n        for (let i = 0; i < array.length; i += 1) {\n          array[i] = Math.round(Math.random() * 4294967296);\n        }\n      } else {\n        throw new TypeError(\"\" + array);\n      }\n    };\n  }\n\n  return Random;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Endianness of multi-byte words.\n * @public\n */\nexport type ByteOrder = \"BE\" | \"LE\";\n\n/** @public */\nexport const ByteOrder = (function () {\n  const ByteOrder = {} as {\n    /**\n     * Most significant byte first.\n     */\n    readonly BigEndian: ByteOrder;\n\n    /**\n     * Least significant byte first.\n     */\n    readonly LittleEndian: ByteOrder;\n\n    /**\n     * `ByteOrder` of the host machine.\n     */\n    readonly NativeOrder: ByteOrder;\n  };\n\n  Object.defineProperty(ByteOrder, \"BigEndian\", {\n    value: \"BE\",\n    enumerable: true,\n  });\n\n  Object.defineProperty(ByteOrder, \"LittleEndian\", {\n    value: \"LE\",\n    enumerable: true,\n  });\n\n  Object.defineProperty(ByteOrder, \"NativeOrder\", {\n    get(): ByteOrder {\n      let nativeEndian: ByteOrder;\n      const bom = new ArrayBuffer(2);\n      new Uint16Array(bom)[0] = 0xfeff;\n      const b = new Uint8Array(bom);\n      if (b[0] === 0xfe && b[1] === 0xff) {\n        nativeEndian = ByteOrder.BigEndian;\n      } else if (b[0] === 0xff && b[1] === 0xfe) {\n        nativeEndian = ByteOrder.LittleEndian;\n      } else {\n        throw new Error();\n      }\n      Object.defineProperty(ByteOrder, \"NativeOrder\", {\n        value: nativeEndian,\n        enumerable: true,\n      });\n      return nativeEndian;\n    },\n    configurable: true,\n    enumerable: true,\n  });\n\n  return ByteOrder;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {ByteOrder} from \"./ByteOrder\";\nimport {Strings} from \"../\"; // forward import\n\n/**\n * 32-bit [MurmurHash](https://en.wikipedia.org/wiki/MurmurHash) algorithm,\n * version 3.\n * @public\n */\nexport const Murmur3 = (function () {\n  const Murmur3 = {} as {\n    /**\n     * Mixes a new hash `value` into the accumulated hash `code`,\n     * and returns the accumulated hash value.\n     */\n    mix(code: number, value: number): number;\n\n    /**\n     * Mixes each consecutive 4-byte word of `array` into `code`,\n     * and returns the accumulated hash value.\n     */\n    mixUint8Array(code: number, array: Uint8Array): number;\n\n    /** @internal */\n    mixUint8ArrayBE(code: number, array: Uint8Array): number;\n\n    /** @internal */\n    mixUInt8ArrayLE(code: number, array: Uint8Array): number;\n\n    /**\n     * Mixes each consecutive 4-byte word of the UTF-8 encoding of `string`\n     * into `code`, and returns the accumulated hash value.\n     */\n    mixString(code: number, string: string): number;\n\n    /** @internal */\n    mixStringBE(code: number, string: string): number;\n\n    /** @internal */\n    mixStringLE(code: number, string: string): number;\n\n    /**\n     * Finalizes a hash `code`.\n     */\n    mash(code: number): number;\n\n    /** @internal */\n    rotl(value: number, distance: number): number;\n  };\n\n  Murmur3.mix = function (code: number, value: number): number {\n    value = ((value & 0xffff) * 0xcc9e2d51) + (((value >>> 16) * 0xcc9e2d51 & 0xffff) << 16) & 0xffffffff;\n    value = Murmur3.rotl(value, 15);\n    value = ((value & 0xffff) * 0x1b873593) + (((value >>> 16) * 0x1b873593 & 0xffff) << 16) & 0xffffffff;\n    code ^= value;\n    code = Murmur3.rotl(code, 13);\n    code = ((code & 0xffff) * 5) + (((code >>> 16) * 5 & 0xffff) << 16) & 0xffffffff;\n    code = ((code & 0xffff) + 0x6b64) + (((code >>> 16) + 0xe654 & 0xffff) << 16);\n    return code;\n  };\n\n  Murmur3.mixUint8Array = function (code: number, array: Uint8Array): number {\n    if (ByteOrder.NativeOrder === ByteOrder.BigEndian) {\n      return Murmur3.mixUint8ArrayBE(code, array);\n    } else if (ByteOrder.NativeOrder === ByteOrder.LittleEndian) {\n      return Murmur3.mixUInt8ArrayLE(code, array);\n    } else {\n      throw new Error();\n    }\n  };\n\n  Murmur3.mixUint8ArrayBE = function (code: number, array: Uint8Array): number {\n    let offset = 0;\n    const limit = array.length;\n    while (offset + 3 < limit) {\n      const word = (array[offset    ]! & 0xff) << 24 | (array[offset + 1]! & 0xff) << 16\n                 | (array[offset + 2]! & 0xff) <<  8 |  array[offset + 3]! & 0xff;\n      code = Murmur3.mix(code, word);\n      offset += 4;\n    }\n    if (offset < limit) {\n      let word = (array[offset]! & 0xff) << 24;\n      if (offset + 1 < limit) {\n        word |= (array[offset + 1]! & 0xff) << 16;\n        if (offset + 2 < limit) {\n          word |= (array[offset + 2]! & 0xff) << 8;\n          //assert offset + 3 === limit;\n        }\n      }\n      word = ((word & 0xffff) * 0xcc9e2d51) + (((word >>> 16) * 0xcc9e2d51 & 0xffff) << 16) & 0xffffffff;\n      word = Murmur3.rotl(word, 15);\n      word = ((word & 0xffff) * 0x1b873593) + (((word >>> 16) * 0x1b873593 & 0xffff) << 16) & 0xffffffff;\n      code ^= word;\n    }\n    return code ^ limit;\n  };\n\n  Murmur3.mixUInt8ArrayLE = function (code: number, array: Uint8Array): number {\n    let offset = 0;\n    const limit = array.length;\n    while (offset + 3 < limit) {\n      const word =  array[offset    ]! & 0xff        | (array[offset + 1]! & 0xff) <<  8\n                 | (array[offset + 2]! & 0xff) << 16 | (array[offset + 3]! & 0xff) << 24;\n      code = Murmur3.mix(code, word);\n      offset += 4;\n    }\n    if (offset < limit) {\n      let word = array[offset]! & 0xff;\n      if (offset + 1 < limit) {\n        word |= (array[offset + 1]! & 0xff) << 8;\n        if (offset + 2 < limit) {\n          word |= (array[offset + 2]! & 0xff) << 16;\n          //assert offset + 3 === limit;\n        }\n      }\n      word = ((word & 0xffff) * 0xcc9e2d51) + (((word >>> 16) * 0xcc9e2d51 & 0xffff) << 16) & 0xffffffff;\n      word = Murmur3.rotl(word, 15);\n      word = ((word & 0xffff) * 0x1b873593) + (((word >>> 16) * 0x1b873593 & 0xffff) << 16) & 0xffffffff;\n      code ^= word;\n    }\n    return code ^ limit;\n  };\n\n  Murmur3.mixString = function (code: number, string: string): number {\n    if (ByteOrder.NativeOrder === ByteOrder.BigEndian) {\n      return Murmur3.mixStringBE(code, string);\n    } else if (ByteOrder.NativeOrder === ByteOrder.LittleEndian) {\n      return Murmur3.mixStringLE(code, string);\n    } else {\n      throw new Error();\n    }\n  };\n\n  Murmur3.mixStringBE = function (code: number, string: string): number {\n    let word = 0;\n    let k = 32;\n    let i = 0;\n    const n = string.length;\n    let utf8Length = 0;\n    while (i < n) {\n      let c = string.codePointAt(i);\n      if (c === void 0) {\n        c = string.charCodeAt(i);\n      }\n      if (c >= 0 && c <= 0x7f) { // U+0000..U+007F\n        k -= 8;\n        word |= c << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        utf8Length += 1;\n      } else if (c >= 0x80 && c <= 0x7ff) { // U+0080..U+07FF\n        k -= 8;\n        word |= (0xc0 | (c >>> 6)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= (0x80 | (c & 0x3f)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        utf8Length += 2;\n      } else if (c >= 0x0800 && c <= 0xffff || // U+0800..U+D7FF\n                 c >= 0xe000 && c <= 0xffff) { // U+E000..U+FFFF\n        k -= 8;\n        word |= (0xe0 | (c  >>> 12)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= (0x80 | ((c >>>  6) & 0x3f)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= (0x80 | (c & 0x3f)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        utf8Length += 3;\n      } else if (c >= 0x10000 && c <= 0x10ffff) { // U+10000..U+10FFFF\n        k -= 8;\n        word |= (0xf0 | (c  >>> 18)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= (0x80 | ((c >>> 12) & 0x3f)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= (0x80 | ((c >>>  6) & 0x3f)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= (0x80 | (c & 0x3f)) << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        utf8Length += 4;\n      } else { // surrogate or invalid code point\n        k -= 8;\n        word |= 0xef << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= 0xbf << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        k -= 8;\n        word |= 0xbd << k;\n        if (k === 0) { code = Murmur3.mix(code, word); word = 0; k = 32; }\n        utf8Length += 3;\n      }\n      i = Strings.offsetByCodePoints(string, i, 1);\n    }\n    if (k !== 32) {\n      word = ((word & 0xffff) * 0xcc9e2d51) + (((word >>> 16) * 0xcc9e2d51 & 0xffff) << 16) & 0xffffffff;\n      word = Murmur3.rotl(word, 15);\n      word = ((word & 0xffff) * 0x1b873593) + (((word >>> 16) * 0x1b873593 & 0xffff) << 16) & 0xffffffff;\n      code ^= word;\n    }\n    return code ^ utf8Length;\n  };\n\n  Murmur3.mixStringLE = function (code: number, string: string): number {\n    let word = 0;\n    let k = 0;\n    let i = 0;\n    const n = string.length;\n    let utf8Length = 0;\n    while (i < n) {\n      let c = string.codePointAt(i);\n      if (c === void 0) {\n        c = string.charCodeAt(i);\n      }\n      if (c >= 0 && c <= 0x7f) { // U+0000..U+007F\n        word |= c << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        utf8Length += 1;\n      } else if (c >= 0x80 && c <= 0x7ff) { // U+0080..U+07FF\n        word |= (0xc0 | (c >>> 6)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= (0x80 | (c & 0x3f)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        utf8Length += 2;\n      } else if (c >= 0x0800 && c <= 0xffff || // U+0800..U+D7FF\n                 c >= 0xe000 && c <= 0xffff) { // U+E000..U+FFFF\n        word |= (0xe0 | (c  >>> 12)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= (0x80 | ((c >>>  6) & 0x3f)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= (0x80 | (c & 0x3f)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        utf8Length += 3;\n      } else if (c >= 0x10000 && c <= 0x10ffff) { // U+10000..U+10FFFF\n        word |= (0xf0 | (c  >>> 18)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= (0x80 | ((c >>> 12) & 0x3f)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= (0x80 | ((c >>>  6) & 0x3f)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= (0x80 | (c & 0x3f)) << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        utf8Length += 4;\n      } else { // surrogate or invalid code point\n        word |= 0xef << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= 0xbf << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        word |= 0xbd << k;\n        k += 8;\n        if (k === 32) { code = Murmur3.mix(code, word); word = 0; k = 0; }\n        utf8Length += 3;\n      }\n      i = Strings.offsetByCodePoints(string, i, 1);\n    }\n    if (k !== 32) {\n      word = ((word & 0xffff) * 0xcc9e2d51) + (((word >>> 16) * 0xcc9e2d51 & 0xffff) << 16) & 0xffffffff;\n      word = Murmur3.rotl(word, 15);\n      word = ((word & 0xffff) * 0x1b873593) + (((word >>> 16) * 0x1b873593 & 0xffff) << 16) & 0xffffffff;\n      code ^= word;\n    }\n    return code ^ utf8Length;\n  };\n\n  Murmur3.mash = function (code: number): number {\n    code ^= code >>> 16;\n    code = ((code & 0xffff) * 0x85ebca6b) + (((code >>> 16) * 0x85ebca6b & 0xffff) << 16) & 0xffffffff;\n    code ^= code >>> 13;\n    code = ((code & 0xffff) * 0xc2b2ae35) + (((code >>> 16) * 0xc2b2ae35 & 0xffff) << 16) & 0xffffffff;\n    code ^= code >>> 16;\n    return code >>> 0;\n  };\n\n  Murmur3.rotl = function (value: number, distance: number): number {\n    return (value << distance) | (value >>> (32 - distance));\n  };\n\n  return Murmur3;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Decorator that memoizes the computed value of a getter or nullary method.\n * @public\n */\nexport const Lazy: MethodDecorator = function <T>(target: Object, propertyKey: string | symbol,\n                                                  descriptor: TypedPropertyDescriptor<T>): void {\n  const writable = descriptor.writable;\n  const enumerable = descriptor.enumerable;\n  const configurable = descriptor.configurable;\n  if (descriptor.get !== void 0) {\n    const get = descriptor.get;\n    descriptor.get = function (this: unknown): T {\n      const value = get.call(this);\n      Object.defineProperty(target, propertyKey, {\n        value,\n        writable,\n        enumerable,\n        configurable,\n      });\n      return value;\n    };\n  } else if (descriptor.value !== void 0) {\n    const method = descriptor.value as unknown as () => T;\n    descriptor.value = function (this: unknown): T {\n      const value = method.call(this);\n      Object.defineProperty(target, propertyKey, {\n        value: function (): T {\n          return value;\n        },\n        writable,\n        enumerable,\n        configurable,\n      });\n      return value;\n    } as unknown as T;\n  } else {\n    throw new Error(\"invalid lazy property descriptor\");\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Utilities for comparing and hashing object identities.\n * @public\n */\nexport const Identity = (function () {\n  const Identity = {} as {\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the hash code of object `x` is less than the hash code of object `y`;\n     * returns `1` if the hash code of object `x` is greater than the hash code\n     * of object `y`; and returns `0` if `x` and `y` are identical objects.\n     * If either `x` or `y` is `null` or `undefined`, then objects order before\n     * `null`, and `null` orders before `undefined`.\n     */\n    compare(x: object | null | undefined, y: object | null | undefined): number;\n\n    /**\n     * Returns a unique 32-bit hash value for a particular object instance.\n     */\n    hash(x: object | null | undefined): number;\n  };\n\n  Identity.compare = function (x: object | null | undefined, y: object | null | undefined): number {\n    if (typeof x === \"object\" && x !== null) {\n      if (typeof y === \"object\" && y !== null) {\n        const xh = Identity.hash(x);\n        const yh = Identity.hash(y);\n        return xh < yh ? -1 : xh > yh ? 1 : 0;\n      } else {\n        return -1;\n      }\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  let nextId = 1;\n  Identity.hash = function (x: object | null | undefined): number {\n    if (typeof x === \"object\" && x !== null) {\n      let hashCode = (x as any)._hashCode as number | undefined;\n      if (hashCode === void 0) {\n        hashCode = ~~nextId;\n        nextId += 1;\n        Object.defineProperty(x, \"_hashCode\", {\n          value: hashCode,\n          configurable: true,\n        });\n      }\n      return hashCode;\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Identity;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Utilities for comparing and hashing booleans.\n * @public\n */\nexport const Booleans = (function () {\n  const Booleans = {} as {\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * `x` is `true` and `y` is `false`; returns `1` if `x` is `false` and `y`\n     * is `true`; and returns `0` if `x` and `y` are equal booleans. If either\n     * `x` or `y` is `null` or `undefined`, then booleans order before `null`,\n     * and `null` orders before `undefined`.\n     */\n    compare(x: boolean | null | undefined, y: boolean | null | undefined): number;\n\n    /**\n     * Returns a hash code for a number.\n     */\n    hash(x: boolean | null | undefined): number;\n  };\n\n  Booleans.compare = function (x: boolean | null | undefined, y: boolean | null | undefined): number {\n    if (typeof x === \"boolean\") {\n      return typeof y === \"boolean\" ? (x && !y ? -1 : !x && y ? 1 : 0) : -1;\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  Booleans.hash = function (x: boolean | null | undefined): number {\n    if (x === true) {\n      return 3;\n    } else if (x === false) {\n      return 2;\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Booleans;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\n\n/**\n * Type that implements a universal equivalence relation.\n * @public\n */\nexport interface Equivalent {\n  /**\n   * Returns `true` if `this` is equivalent to `that` within some optionally\n   * specified error tolerance `epsilon`, otherwise returns `false`.\n   */\n  equivalentTo(that: unknown, epsilon?: number): boolean;\n}\n\n/** @public */\nexport const Equivalent = (function () {\n  const Equivalent = function (x:unknown, y: unknown, epsilon?: number): boolean {\n    if (x === y) {\n      return true;\n    } else if (x !== void 0 && x !== null && typeof (x as Equivalent).equivalentTo === \"function\") {\n      return (x as Equivalent).equivalentTo(y, epsilon);\n    }\n    return false;\n  } as {\n    /**\n     * Returns `true` if `x` conforms to [[Equivalent]] and is\n     * [[Equivalent.equivalentTo equivalent to]] `y`, otherwise returns `x === y`.\n     */\n    (x: unknown, y: unknown, epsilon?: number): boolean;\n\n    /**\n     * Returns `true` if `object` conforms to the [[Equivalent]] interface.\n     */\n    is(object: unknown): object is Equivalent;\n\n    /**\n     * Default equivalence tolerance.\n     */\n    readonly Epsilon: number;\n  };\n\n  Equivalent.is = function (object: unknown): object is Equivalent {\n    return object !== void 0 && object !== null\n        && typeof (object as Equivalent).equivalentTo === \"function\";\n  };\n\n  (Equivalent as Mutable<typeof Equivalent>).Epsilon = 1.0e-8;\n\n  return Equivalent;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equivalent} from \"../compare/Equivalent\";\n\n/**\n * Utilities for comparing and hashing numbers.\n * @public\n */\nexport const Numbers = (function () {\n  const Numbers = {} as {\n    /**\n     * Returns `true` if `x` and `y` are equal numbers, or if both are `NaN`;\n     * otherwise returns `x === y` if either `x` or `y` is not defined.\n     */\n    equal(x: number | null | undefined, y: number | null | undefined): boolean;\n\n    /**\n     * Returns `true` if `x` and `y` are both defined, and the difference between\n     * the two is less than `epsilon`, or if both are `NaN`; otherwise returns\n     * `x === y` if either `x` or `y` is not defined.\n     */\n    equivalent(x: number | null | undefined, y: number | null | undefined, epsilon?: number): boolean;\n\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the number `x` less than the number `y`; returns `1` if the number `x` is\n     * greater than the number `y`; and returns `0` if `x` and `y` are equal\n     * numbers, or if both are `NaN`. If either `x` or `y` is `NaN`, `null`,\n     * or `undefined`, then numbers order before `NaN`, `NaN` orders before\n     * `null`, and `null` orders before `undefined`.\n     */\n    compare(x: number | null | undefined, y: number | null | undefined): number;\n\n    /**\n     * Returns a 32-bit hash value for the number `x`, if defined; otherwise\n     * returns `0` or `1` if `x` is `undefined` or `null`, respectively.\n     */\n    hash(x: number | null | undefined): number;\n  };\n\n  Numbers.equal = function (x: number | null | undefined, y: number | null | undefined): boolean {\n    return x === y || typeof x === \"number\" && typeof y === \"number\" && isNaN(x) && isNaN(y);\n  };\n\n  Numbers.equivalent = function (x: number | null | undefined, y: number | null | undefined, epsilon?: number): boolean {\n    return x === y || typeof x === \"number\" && typeof y === \"number\" && (isNaN(x) && isNaN(y) || Math.abs(y - x) < (epsilon !== void 0 ? epsilon : Equivalent.Epsilon));\n  };\n\n  Numbers.compare = function (x: number | null | undefined, y: number | null | undefined): number {\n    if (typeof x === \"number\") {\n      return typeof y === \"number\" ? (x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0) : -1;\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  const hashArrayBuffer = new ArrayBuffer(8);\n  const hashFloat64Array = new Float64Array(hashArrayBuffer);\n  const hashInt32Array = new Int32Array(hashArrayBuffer);\n  Numbers.hash = function (x: number | null | undefined): number {\n    if (typeof x === \"number\") {\n      if (x === ~~x) {\n        return ~~x;\n      } else {\n        hashFloat64Array[0] = x;\n        return hashInt32Array[0]! ^ hashInt32Array[1]!;\n      }\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Numbers;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3} from \"../runtime/Murmur3\";\n\n/**\n * Utilities for comparing and hashing strings.\n * @public\n */\nexport const Strings = (function () {\n  const Strings = {} as {\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the string `x` lexicographically orders before the string `y`; returns `1`\n     * if the string `x` lexicographically orders after the string `y`; and\n     * returns `0` if `x` and `y` are equal strings. If either `x` or `y` is\n     * `null` or `undefined`, then strings order before `null`, and `null` orders\n     * before `undefined`.\n     */\n    compare(x: string | null | undefined, y: string | null | undefined): number;\n\n    /**\n     * Returns a hash code for a string.\n     */\n    hash(x: string | null | undefined): number;\n\n    codePointAt(string: string, index: number): number | undefined;\n\n    offsetByCodePoints(string: string, index: number, count: number): number;\n  };\n\n  Strings.compare = function (x: string | null | undefined, y: string | null | undefined): number {\n    if (typeof x === \"string\") {\n      return typeof y === \"string\" ? (x < y ? -1 : x > y ? 1 : 0) : -1;\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  Strings.hash = function (x: string | null | undefined): number {\n    if (typeof x === \"string\") {\n      return Murmur3.mash(Murmur3.mixString(0, x));\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  Strings.codePointAt = function (string: string, index: number): number | undefined {\n    const length = string.length;\n    index = index ? Number(index) : 0; // Coerce to number.\n    if (index !== index) { // Convert NaN to zero.\n      index = 0;\n    }\n    if (index >= 0 && index < length) {\n      const c1 = string.charCodeAt(index);\n      if (c1 <= 0xd7ff || c1 >= 0xe000) { // U+0000..U+D7FF | U+E000..U+FFFF\n        return c1;\n      } else if (c1 <= 0xdbff && index + 1 < length) {\n        const c2 = string.charCodeAt(index + 1);\n        if (c2 >= 0xdc00 && c2 <= 0xdfff) { // U+10000..U+10FFFF\n          return ((c1 & 0x03ff) << 10 + c2 & 0x03ff) + 0x10000;\n        }\n      }\n    }\n    return void 0;\n  };\n\n  Strings.offsetByCodePoints = function (string: string, index: number, count: number): number {\n    if (count > 0) {\n      const length = string.length;\n      while (count > 0 && index < length) {\n        const c1 = string.charCodeAt(index);\n        if (c1 <= 0xd7ff || c1 >= 0xe000) { // U+0000..U+D7FF | U+E000..U+FFFF\n          index += 1;\n        } else if (c1 <= 0xdbff && index + 1 < length) {\n          const c2 = string.charCodeAt(index + 1);\n          if (c2 >= 0xdc00 && c2 <= 0xdfff) { // U+10000..U+10FFFF\n            index += 2;\n          } else {\n            index += 1;\n          }\n        } else {\n          index += 1;\n        }\n        count -= 1;\n      }\n    } else if (count < 0) {\n      while (count < 0 && index > 0) {\n        const c2 = string.charCodeAt(index - 1);\n        if (c2 <= 0xd7ff || c2 >= 0xe000) { // U+0000..U+D7FF | U+E000..U+FFFF\n          index -= 1;\n        } else if (c2 >= 0xdc00 && c2 <= 0xdfff && index - 1 > 0) {\n          const c1 = string.charCodeAt(index - 2);\n          if (c1 >= 0xd800 && c1 <= 0xdfff) { // U+10000..U+10FFFF\n            index -= 2;\n          } else {\n            index -= 1;\n          }\n        } else {\n          index -= 1;\n        }\n        count -= 1;\n      }\n    }\n    return index;\n  };\n\n  return Strings;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings} from \"./Strings\";\n\n/**\n * Utilities for working with ECMAScript identifiers.\n * @public\n */\nexport const Identifiers = (function () {\n  const Identifiers = {} as {\n    /** @internal */\n    isStartChar(c: number): boolean;\n\n    /** @internal */\n    isPartChar(c: number): boolean;\n\n    isValid(identifier: string): boolean;\n\n    isReserved(identifier: string): boolean;\n  };\n\n  Identifiers.isStartChar = function (c: number): boolean {\n    return c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c === 95/*'_'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c >= 0xc0 && c <= 0xd6\n        || c >= 0xd8 && c <= 0xf6\n        || c >= 0xf8 && c <= 0x2ff\n        || c >= 0x370 && c <= 0x37d\n        || c >= 0x37f && c <= 0x1fff\n        || c >= 0x200c && c <= 0x200d\n        || c >= 0x2070 && c <= 0x218f\n        || c >= 0x2c00 && c <= 0x2fef\n        || c >= 0x3001 && c <= 0xd7ff\n        || c >= 0xf900 && c <= 0xfdcf\n        || c >= 0xfdf0 && c <= 0xfffd\n        || c >= 0x10000 && c <= 0xeffff;\n  };\n\n  Identifiers.isPartChar = function (c: number): boolean {\n    return c === 45/*'-'*/\n        || c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c === 95/*'_'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c === 0xb7\n        || c >= 0xc0 && c <= 0xd6\n        || c >= 0xd8 && c <= 0xf6\n        || c >= 0xf8 && c <= 0x37d\n        || c >= 0x37f && c <= 0x1fff\n        || c >= 0x200c && c <= 0x200d\n        || c >= 0x203f && c <= 0x2040\n        || c >= 0x2070 && c <= 0x218f\n        || c >= 0x2c00 && c <= 0x2fef\n        || c >= 0x3001 && c <= 0xd7ff\n        || c >= 0xf900 && c <= 0xfdcf\n        || c >= 0xfdf0 && c <= 0xfffd\n        || c >= 0x10000 && c <= 0xeffff;\n  };\n\n  Identifiers.isValid = function (identifier: string): boolean {\n    const n = identifier.length;\n    if (n !== 0) {\n      let c = identifier.codePointAt(0);\n      if (c !== void 0 && Identifiers.isStartChar(c)) {\n        let i = Strings.offsetByCodePoints(identifier, 0, 1);\n        while (i < n && (c = identifier.codePointAt(0), c !== void 0 && Identifiers.isPartChar(c))) {\n          i = Strings.offsetByCodePoints(identifier, i, 1);\n        }\n        return i === n && !Identifiers.isReserved(identifier);\n      }\n    }\n    return false;\n  };\n\n  Identifiers.isReserved = function (identifier: string): boolean {\n    switch (identifier) {\n      case \"await\":\n      case \"break\":\n      case \"case\":\n      case \"catch\":\n      case \"class\":\n      case \"const\":\n      case \"continue\":\n      case \"debugger\":\n      case \"default\":\n      case \"delete\":\n      case \"do\":\n      case \"else\":\n      case \"enum\":\n      case \"export\":\n      case \"extends\":\n      case \"false\":\n      case \"finally\":\n      case \"for\":\n      case \"function\":\n      case \"if\":\n      case \"import\":\n      case \"in\":\n      case \"instanceof\":\n      case \"new\":\n      case \"null\":\n      case \"return\":\n      case \"super\":\n      case \"switch\":\n      case \"this\":\n      case \"throw\":\n      case \"true\":\n      case \"try\":\n      case \"typeof\":\n      case \"var\":\n      case \"void\":\n      case \"while\":\n      case \"with\":\n      case \"yield\":\n        return true;\n      default:\n        return false;\n    }\n  };\n\n  return Identifiers;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Utilities for comparing and hashing functions.\n * @public\n */\nexport const Functions = (function () {\n  const Functions = {} as {\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the hash code of function `x` is less than the hash code of function `y`;\n     * returns `1` if the hash code of function `x` is greater than the hash code\n     * of function `y`; and returns `0` if `x` and `y` are identical functions.\n     * If either `x` or `y` is `null` or `undefined`, then functions order before\n     * `null`, and `null` orders before `undefined`.\n     */\n    compare(x: Function | null | undefined, y: Function | null | undefined): number;\n\n    /**\n     * Returns a 32-bit hash value for a function.\n     */\n    hash(x: Function | null | undefined): number;\n  };\n\n  Functions.compare = function (x: Function | null | undefined, y: Function | null | undefined): number {\n    if (typeof x === \"function\") {\n      if (typeof y === \"function\") {\n        const xh = Functions.hash(x);\n        const yh = Functions.hash(y);\n        return xh < yh ? -1 : xh > yh ? 1 : 0;\n      } else {\n        return -1;\n      }\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  let nextId = -1;\n  Functions.hash = function (x: Function | null | undefined): number {\n    if (typeof x === \"function\") {\n      let hashCode = (x as any)._hashCode as number | undefined;\n      if (hashCode === void 0) {\n        hashCode = ~~nextId;\n        nextId -= 1;\n        Object.defineProperty(x, \"_hashCode\", {\n          value: hashCode,\n          configurable: true,\n        });\n      }\n      return hashCode;\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Functions;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3} from \"../runtime/Murmur3\";\n\n/**\n * Utilities for comparing and hashing constructors.\n * @public\n */\nexport const Constructors = (function () {\n  const Constructors = {} as {\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the hash code of constructor `x` is less than the hash code of constructor\n     * `y`; returns `1` if the hash code of constructor `x` is greater than the\n     * hash code of constructor `y`; and returns `0` if `x` and `y` are identical\n     * constructors. If either `x` or `y` is `null` or `undefined`, then\n     * constructors order before `null`, and `null` orders before `undefined`.\n     */\n    compare(x: Function | null | undefined, y: Function | null | undefined): number;\n\n    /**\n     * Returns a 32-bit hash value for a constructor.\n     */\n    hash(x: Function | null | undefined): number;\n  };\n\n  Constructors.compare = function (x: Function | null | undefined, y: Function | null | undefined): number {\n    if (typeof x === \"function\") {\n      if (typeof y === \"function\") {\n        const xh = Constructors.hash(x);\n        const yh = Constructors.hash(y);\n        return xh < yh ? -1 : xh > yh ? 1 : 0;\n      } else {\n        return -1;\n      }\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  Constructors.hash = function (x: Function | null | undefined): number {\n    if (typeof x === \"function\") {\n      let hashCode = (x as any)._hashCode as number | undefined;\n      if (hashCode === void 0) {\n        hashCode = Murmur3.mash(Murmur3.mixString(0, x.name));\n        Object.defineProperty(x, \"_hashCode\", {\n          value: hashCode,\n          configurable: true,\n        });\n      }\n      return hashCode;\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Constructors;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Type that implements a universal equality relation.\n * @public\n */\nexport interface Equals {\n  /**\n   * Returns `true` if `this` is equal to `that`, otherwise returns `false`.\n   */\n  equals(that: unknown): boolean;\n}\n\n/** @public */\nexport const Equals = (function () {\n  const Equals = function (x: unknown, y: unknown): boolean {\n    if (x === y) {\n      return true;\n    } else if (x !== void 0 && x !== null && typeof (x as Equals).equals === \"function\") {\n      return (x as Equals).equals(y);\n    }\n    return false;\n  } as {\n    /**\n     * Returns `true` if `x` conforms to [[Equals]] and is [[Equals.equals\n     * equal]] to `y`, otherwise returns `x === y`.\n     */\n    (x: unknown, y: unknown): boolean;\n\n    /**\n     * Returns `true` if `object` conforms to the [[Equals]] interface.\n     */\n    is(object: unknown): object is Equals;\n  };\n\n  Equals.is = function (object: unknown): object is Equals {\n    return object !== void 0 && object !== null\n        && typeof (object as Equals).equals === \"function\";\n  };\n\n  return Equals;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Equals} from \"./Equals\";\n\n/**\n * Type that is convertible to a hash value consistent with its universal\n * equality relation.\n * @public\n */\nexport interface HashCode extends Equals {\n  /**\n   * Returns a 32-bit hash value for this object.\n   */\n  hashCode(): number;\n}\n\n/** @public */\nexport const HashCode = (function () {\n  const HashCode = function (x: HashCode | null | undefined): number {\n    if (x === void 0) {\n      return 0;\n    } else if (x === null) {\n      return 1;\n    } else {\n      return x.hashCode();\n    }\n  } as {\n    /**\n     * Returns the [[HashCode.hashCode hash code]] of `x`, if `x` is an object;\n     * otherwise returns `0` or `1` if `x` is `undefined` or `null`, respectively.\n     */\n    (x: HashCode | null | undefined): number;\n\n    /**\n     * Returns `true` if `object` conforms to the [[HashCode]] interface.\n     */\n    is(object: unknown): object is HashCode;\n  };\n\n  HashCode.is = function (object: unknown): object is HashCode {\n    return object !== void 0 && object !== null\n        && typeof (object as HashCode).hashCode === \"function\";\n  };\n\n  return HashCode;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Type that implements a universal partial order.\n * @public\n */\nexport interface Compare {\n  /**\n   * Returns the relative order of `this` with respect to `that`. Returns `-1`\n   * if `this` orders before `that`; returns `1` if `this` orders after `that`;\n   * returns `0` if `this` and `that` are equivalent; and returns `NaN` if\n   * `this` is not comparable to `that`.\n   */\n  compareTo(that: unknown): number;\n}\n\n/** @public */\nexport const Compare = (function () {\n  const Compare = function (x: unknown, y: unknown): number {\n    if (x === void 0) {\n      if (y === void 0) {\n        return 0;\n      } else {\n        return 1;\n      }\n    } else if (x === null) {\n      if (y === void 0) {\n        return -1;\n      } else if (y === null) {\n        return 0;\n      } else {\n        return 1;\n      }\n    } else if (typeof (x as Compare).compareTo === \"function\") {\n      if (y === void 0 || y === null) {\n        return -1;\n      } else {\n        return (x as Compare).compareTo(y);\n      }\n    } else {\n      return NaN;\n    }\n  } as {\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if `x`\n     * orders before `y`; returns `1` if `x` orders after `y`; returns `0` if `x`\n     * and `y` are equivalent; and returns `NaN` if `x` is not comparable to `y`.\n     * Objects are [[Compare.compareTo compared to]] each other when both are\n     * defined, otherwise defined objects order before `null`, and `null` orders\n     * before `undefined`.\n     */\n    (x: unknown, y: unknown): number;\n\n    /**\n     * Returns `true` if `object` conforms to the [[Compare]] interface.\n     */\n    is(object: unknown): object is Compare;\n  };\n\n  Compare.is = function (object: unknown): object is Compare {\n    return object !== void 0 && object !== null\n        && typeof (object as Compare).compareTo === \"function\";\n  };\n\n  return Compare;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3} from \"../runtime/Murmur3\";\nimport {Strings} from \"./Strings\";\nimport {Values} from \"./Values\";\n\n/**\n * Utilities for comparing and hashing structural objects.\n * @public\n */\nexport const Objects = (function () {\n  const Objects = {} as {\n    /**\n     * Returns `true` if `x` and `y` are structurally equal objects; otherwise\n     * returns `x === y` if either `x` or `y` is not an object.\n     */\n    equal(x: object | null | undefined, y: object | null | undefined): boolean;\n\n    /**\n     * Returns `true` if `x` and `y` are structurally [[Equivalent.equivalentTo\n     * equivalent]] objects; otherwise returns `x === y` if either `x` or `y` is\n     * not an object.\n     */\n    equivalent(x: object | null | undefined, y: object | null | undefined, epsilon?: number): boolean;\n\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the entries of object `x` order lexicographically before the entries of\n     * object `y`; returns `1` if the entries of object `x` order\n     * lexicographically after the entries of object `y`; and returns `0` if `x`\n     * and `y` are equal objects. If either `x` or `y` is `null` or `undefined`,\n     * then objects order before `null`, and `null` orders before `undefined`.\n     */\n    compare(x: object | null | undefined, y: object | null | undefined): number;\n\n    /**\n     * Returns a 32-bit hash value for the entries of object `x`, if defined;\n     * otherwise returns `0` or `1` if `x` is `undefined` or `null`, respectively.\n     */\n    hash(x: object | null | undefined): number;\n  };\n\n  Objects.equal = function (x: object | null | undefined, y: object | null | undefined): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      const xKeys = Object.keys(x);\n      const yKeys = Object.keys(y);\n      const n = xKeys.length;\n      if (n !== yKeys.length) {\n        return false;\n      }\n      for (let i = 0; i < n; i += 1) {\n        const key = xKeys[i]!;\n        if (key !== yKeys[i] || !Values.equal((x as any)[key], (y as any)[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  Objects.equivalent = function (x: object | null | undefined, y: object | null | undefined, epsilon?: number): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      const xKeys = Object.keys(x);\n      const yKeys = Object.keys(y);\n      const n = xKeys.length;\n      if (n !== yKeys.length) {\n        return false;\n      }\n      for (let i = 0; i < n; i += 1) {\n        const key = xKeys[i]!;\n        if (key !== yKeys[i] || !Values.equivalent((x as any)[key], (y as any)[key], epsilon)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  Objects.compare = function (x: object | null | undefined, y: object | null | undefined): number {\n    if (typeof x === \"object\" && x !== null) {\n      if (typeof y === \"object\" && y !== null) {\n        if (x !== y) {\n          const xKeys = Object.keys(x);\n          const yKeys = Object.keys(y);\n          const p = xKeys.length;\n          const q = yKeys.length;\n          const n = Math.min(p, q);\n          let order = 0;\n          for (let i = 0; i < n && order === 0; i += 1) {\n            const xKey = xKeys[i]!;\n            const yKey = yKeys[i]!;\n            order = Strings.compare(xKey, yKey);\n            if (order === 0) {\n              order = Values.compare((x as any)[xKey], (y as any)[yKey]);\n            }\n          }\n          return order !== 0 ? order : p > q ? 1 : p < q ? -1 : 0;\n        } else {\n          return 0;\n        }\n      } else {\n        return -1;\n      }\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  Objects.hash = function (x: object | null | undefined): number {\n    if (typeof x === \"object\" && x !== null) {\n      let hashValue = 0;\n      const keys = Object.keys(x);\n      for (let i = 0, n = keys.length; i < n; i += 1) {\n        const key = keys[i]!;\n        hashValue = Murmur3.mix(Murmur3.mix(hashValue, Strings.hash(key)), Values.hash((x as any)[key]));\n      }\n      return Murmur3.mash(hashValue);\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Objects;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equals} from \"../compare/Equals\";\nimport {HashCode} from \"../compare/HashCode\";\nimport {Equivalent} from \"../compare/Equivalent\";\nimport {Compare} from \"../compare/Compare\";\nimport {Numbers} from \"./Numbers\";\nimport {Strings} from \"./Strings\";\nimport {Functions} from \"./Functions\";\nimport {Arrays} from \"./Arrays\";\nimport {Objects} from \"./Objects\";\n\n/**\n * Utilities for comparing and hashing structural values. A structural value\n * is typed by object structure, rather than by name.\n * @public\n */\nexport const Values = (function () {\n  const Values = {} as {\n    /**\n     * Returns `true` if `x` and `y` are structurally equal, otherwise returns `false`.\n     */\n    equal(x: unknown, y: unknown): boolean;\n\n    /**\n     * Returns a hash code for a structural value.\n     */\n    hash(x: unknown): number;\n\n    /**\n     * Returns `true` if `x` and `y` are structurally equivalent, otherwise returns `false`.\n     */\n    equivalent(x: unknown, y: unknown, epsilon?: number): boolean;\n\n    /**\n     * Returns `-1` if `x` orders before `y`; returns `1` if `x` orders after `y`;\n     * returns `0` if `x` and `y` are equivalent; and returns `NaN` if `x` is not\n     * comparable to `y`.\n     */\n    compare(x: unknown, y: unknown): number;\n  };\n\n  Values.equal = function (x: unknown, y: unknown): boolean {\n    if (x instanceof Date) {\n      x = x.getTime();\n    }\n    if (y instanceof Date) {\n      y = y.getTime();\n    }\n\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"number\") {\n      if (typeof y === \"number\") {\n        return isNaN(x) && isNaN(y);\n      }\n    } else if (Equals.is(x)) {\n      return x.equals(y);\n    } else if (Array.isArray(x)) {\n      if (Array.isArray(y)) {\n        return Arrays.equal(x, y);\n      }\n    } else if (typeof x === \"object\" && x !== null) {\n      if (typeof y === \"object\" && y !== null) {\n        return Objects.equal(x, y);\n      }\n    }\n    return false;\n  };\n\n  Values.hash = function (x: unknown): number {\n    if (x === void 0) {\n      return 0;\n    } else if (x === null) {\n      return 1;\n    } else if (x === false) {\n      return 2;\n    } else if (x === true) {\n      return 3;\n    } else if (typeof x === \"number\") {\n      return Numbers.hash(x);\n    } else if (typeof x === \"string\") {\n      return Strings.hash(x);\n    } else if (HashCode.is(x)) {\n      return x.hashCode();\n    } else if (typeof x === \"function\") {\n      return Functions.hash(x);\n    } else if (Array.isArray(x)) {\n      return Arrays.hash(x);\n    } else if (typeof x === \"object\") {\n      return Objects.hash(x);\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  Values.equivalent = function (x: unknown, y: unknown, epsilon: number = Equivalent.Epsilon): boolean {\n    if (x instanceof Date) {\n      x = x.getTime();\n    }\n    if (y instanceof Date) {\n      y = y.getTime();\n    }\n\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"number\") {\n      if (typeof y === \"number\") {\n        return isNaN(x) && isNaN(y) || Math.abs(y - x) < epsilon;\n      }\n    } else if (Equivalent.is(x)) {\n      return x.equivalentTo(y, epsilon);\n    } else if (Array.isArray(x)) {\n      if (Array.isArray(y)) {\n        return Arrays.equivalent(x, y, epsilon);\n      }\n    } else if (typeof x === \"object\" && x !== null) {\n      if (typeof y === \"object\" && y !== null) {\n        return Objects.equivalent(x, y, epsilon);\n      }\n    }\n    return false;\n  };\n\n  Values.compare = function (x: unknown, y: unknown): number {\n    if (x instanceof Date) {\n      x = x.getTime();\n    }\n    if (y instanceof Date) {\n      y = y.getTime();\n    }\n\n    if (x === void 0) {\n      if (y === void 0) {\n        return 0;\n      } else {\n        return 1;\n      }\n    } else if (x === null) {\n      if (y === void 0) {\n        return -1;\n      } else if (y === null) {\n        return 0;\n      } else {\n        return 1;\n      }\n    } else if (typeof x === \"boolean\") {\n      if (y === void 0 || y === null) {\n        return -1;\n      } else if (typeof y === \"boolean\") {\n        return x && !y ? -1 : !x && y ? 1 : 0;\n      } else {\n        return 1;\n      }\n    } else if (typeof x === \"number\") {\n      if (y === void 0 || y === null || typeof y === \"boolean\") {\n        return -1;\n      } else if (typeof y === \"number\") {\n        return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n      } else {\n        return 1;\n      }\n    } else if (typeof x === \"string\") {\n      if (y === void 0 || y === null || typeof y === \"boolean\" || typeof y === \"number\") {\n        return -1;\n      } else if (typeof y === \"string\") {\n        return x < y ? -1 : x > y ? 1 : 0;\n      } else {\n        return 1;\n      }\n    } else if (Compare.is(x)) {\n      return x.compareTo(y);\n    } else if (typeof x === \"function\") {\n      if (y === void 0 || y === null || typeof y === \"boolean\" || typeof y === \"number\" || typeof y === \"string\") {\n        return -1;\n      } else if (typeof y === \"function\") {\n        return Functions.compare(x, y);\n      } else {\n        return 1;\n      }\n    } else if (Array.isArray(x)) {\n      if (y === void 0 || y === null || typeof y === \"boolean\" || typeof y === \"number\" || typeof y === \"string\" || typeof y === \"function\") {\n        return -1;\n      } else if (Array.isArray(y)) {\n        return Arrays.compare(x, y);\n      } else {\n        return 1;\n      }\n    } else if (typeof x === \"object\") {\n      if (y === void 0 || y === null || typeof y === \"boolean\" || typeof y === \"number\" || typeof y === \"string\" || typeof y === \"function\" || Array.isArray(y)) {\n        return -1;\n      } else if (typeof y === \"object\") {\n        return Objects.compare(x, y);\n      } else {\n        return 1;\n      }\n    } else {\n      return NaN;\n    }\n  };\n\n  return Values;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3} from \"../runtime/Murmur3\";\nimport {Values} from \"./Values\";\n\n/**\n * Utilities for immutably updating, comparing, and hashing arrays.\n * @public\n */\nexport const Arrays = (function () {\n  const Arrays = {} as {\n    readonly empty: ReadonlyArray<never>;\n\n    /**\n     * Returns a copy of an array with the given element inserted, if the element\n     * is not already present in the arrary; otherwise returns the input array if\n     * it already containts the specified element.\n     */\n    inserted<T>(newElement: T, oldArray: ReadonlyArray<T> | null | undefined): ReadonlyArray<T>;\n\n    /**\n     * Returns a copy of an array with the given element removed; returns the\n     * input array if it does not contain the specified element.\n     */\n    removed<T>(oldElement: T, oldArray: ReadonlyArray<T> | null | undefined): ReadonlyArray<T>;\n\n    /**\n     * Returns `true` if `x` and `y` are structurally equal arrays; otherwise\n     * returns `x === y` if either `x` or `y` is not an array.\n     */\n    equal(x: ArrayLike<unknown> | null | undefined, y: ArrayLike<unknown> | null | undefined): boolean;\n\n    /**\n     * Returns `true` if `x` and `y` are structurally [[Equivalent.equivalentTo\n     * equivalent]] arrays; otherwise returns `x === y` if either `x` or `y` is\n     * not an array.\n     */\n    equivalent(x: ArrayLike<unknown> | null | undefined, y: ArrayLike<unknown> | null | undefined, epsilon?: number): boolean;\n\n    /**\n     * Returns the relative order of `x` with respect to `y`. Returns `-1` if\n     * the elements of array `x` order lexicographically before the elements of\n     * array `y`; returns `1` if the elements of array `x` order lexicographically\n     * after the elements of array `y`; and returns `0` if `x` and `y` are equal\n     * arrays. If either `x` or `y` is `null` or `undefined`, then arrays order\n     * before `null`, and `null` orders before `undefined`.\n     */\n    compare(x: ArrayLike<unknown> | null | undefined, y: ArrayLike<unknown> | null | undefined): number;\n\n    /**\n     * Returns a 32-bit hash value for the elements of array `x`, if defined;\n     * otherwise returns `0` or `1` if `x` is `undefined` or `null`, respectively.\n     */\n    hash(x: ArrayLike<unknown> | null | undefined): number;\n  };\n\n  Object.defineProperty(Arrays, \"empty\", {\n    value: Object.freeze([]),\n    enumerable: true,\n    configurable: true,\n  });\n\n  Arrays.inserted = function <T>(newElement: T, oldArray: ReadonlyArray<T> | null | undefined): ReadonlyArray<T> {\n    const n = oldArray !== void 0 && oldArray !== null ? oldArray.length : 0;\n    const newArray = new Array<T>(n + 1);\n    for (let i = 0; i < n; i += 1) {\n      const element = oldArray![i]!;\n      if (element !== newElement) {\n        newArray[i] = element;\n      } else {\n        return oldArray!;\n      }\n    }\n    newArray[n] = newElement;\n    return newArray\n  };\n\n  Arrays.removed = function <T>(oldElement: T, oldArray: ReadonlyArray<T> | null | undefined): ReadonlyArray<T> {\n    const n = oldArray !== void 0 && oldArray !== null ? oldArray.length : 0;\n    if (n === 0) {\n      return oldArray !== void 0 && oldArray !== null ? oldArray : Arrays.empty;\n    } else if (n === 1) {\n      return oldArray![0]! !== oldElement ? oldArray! : Arrays.empty;\n    } else {\n      const newArray = new Array<T>(n - 1);\n      let i = 0;\n      while (i < n) {\n        const element = oldArray![i]!;\n        if (element !== oldElement) {\n          newArray[i] = element;\n          i += 1;\n        } else {\n          i += 1;\n          while (i < n) {\n            newArray[i - 1] = oldArray![i]!;\n            i += 1\n          }\n          return newArray;\n        }\n      }\n      return oldArray!;\n    }\n  };\n\n  Arrays.equal = function (x: ArrayLike<unknown> | null | undefined, y: ArrayLike<unknown> | null | undefined): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      const n = x.length;\n      if (n !== y.length) {\n        return false;\n      }\n      for (let i = 0; i < n; i += 1) {\n        if (!Values.equal(x[i], y[i])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  Arrays.equivalent = function (x: ArrayLike<unknown> | null | undefined, y: ArrayLike<unknown> | null | undefined, epsilon?: number): boolean {\n    if (x === y) {\n      return true;\n    } else if (typeof x === \"object\" && x !== null && typeof y === \"object\" && y !== null) {\n      const n = x.length;\n      if (n !== y.length) {\n        return false;\n      }\n      for (let i = 0; i < n; i += 1) {\n        if (!Values.equivalent(x[i], y[i], epsilon)) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return false;\n  };\n\n  Arrays.compare = function (x: ArrayLike<unknown> | null | undefined, y: ArrayLike<unknown> | null | undefined): number {\n    if (typeof x === \"object\" && x !== null) {\n      if (typeof y === \"object\" && y !== null) {\n        if (x !== y) {\n          const p = x.length as number;\n          const q = y.length as number;\n          let order = 0;\n          for (let i = 0, n = Math.min(p, q); i < n && order === 0; i += 1) {\n            order = Values.compare(x[i], y[i]);\n          }\n          return order !== 0 ? order : p > q ? 1 : p < q ? -1 : 0;\n        } else {\n          return 0;\n        }\n      } else {\n        return -1;\n      }\n    } else if (x === null) {\n      return y === void 0 ? -1 : y === null ? 0 : 1;\n    } else if (x === void 0) {\n      return y === void 0 ? 0 : 1;\n    } else {\n      return NaN;\n    }\n  };\n\n  Arrays.hash = function (x: ArrayLike<unknown> | null | undefined): number {\n    if (typeof x === \"object\" && x !== null) {\n      let hashValue = 0;\n      for (let i = 0, n = x.length; i < n; i += 1) {\n        hashValue = Murmur3.mix(hashValue, Values.hash(x[i]));\n      }\n      return Murmur3.mash(hashValue);\n    } else if (x === null) {\n      return 1;\n    } else if (x === void 0) {\n      return 0;\n    } else {\n      throw new TypeError(\"\" + x);\n    }\n  };\n\n  return Arrays;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport interface FromAny<T, U = never> {\n  fromAny(value: T | U): T;\n}\n\n/** @public */\nexport const FromAny = (function () {\n  const FromAny = {} as {\n    /**\n     * Returns `true` if `object` conforms to the [[FromAny]] interface.\n     */\n    is<T, U = never>(object: unknown): object is FromAny<T, U>;\n  };\n\n  FromAny.is = function <T, U = never>(object: unknown): object is FromAny<T, U> {\n    return object !== void 0 && object !== null\n        && typeof (object as FromAny<T, U>).fromAny === \"function\";\n  };\n\n  return FromAny;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport interface ToAny<T> {\n  toAny(): T;\n}\n\n/** @public */\nexport const ToAny = (function () {\n  const ToAny = {} as {\n    /**\n     * Returns `true` if `object` conforms to the [[ToAny]] interface.\n     */\n    is<T>(object: unknown): object is ToAny<T>;\n  };\n\n  ToAny.is = function <T>(object: unknown): object is ToAny<T> {\n    return object !== void 0 && object !== null\n        && typeof (object as ToAny<T>).toAny === \"function\";\n  };\n\n  return ToAny;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport type {Equals} from \"../compare/Equals\";\nimport type {Equivalent} from \"../compare/Equivalent\";\nimport type {Domain} from \"./Domain\";\nimport type {Range} from \"./Range\";\n \n/** @public */\nexport interface Mapping<X, Y> extends Equals, Equivalent {\n  (x: X): Y;\n\n  readonly domain: Domain<X>;\n\n  readonly range: Range<Y>;\n\n  equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Mapping = (function (_super: typeof Function) {\n  const Mapping = function <X, Y>(domain: Domain<X>, range: Range<Y>): Mapping<X, Y> {\n    const mapping = function (x: X): Y {\n      return mapping.range(mapping.domain(x));\n    } as Mapping<X, Y>;\n    Object.setPrototypeOf(mapping, Mapping.prototype);\n    (mapping as Mutable<typeof mapping>).domain = domain;\n    (mapping as Mutable<typeof mapping>).range = range;\n    return mapping;\n  } as {\n    <X, Y>(domain: Domain<X>, range: Range<Y>): Mapping<X, Y>;\n\n    /** @internal */\n    prototype: Mapping<any, any>;\n  };\n\n  Mapping.prototype = Object.create(_super.prototype);\n  Mapping.prototype.constructor = Mapping;\n\n  Mapping.prototype.equivalentTo = function (that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Mapping) {\n      return this.domain.equivalentTo(that.domain, epsilon)\n          && this.range.equivalentTo(that.range, epsilon);\n    }\n    return false;\n  };\n\n  Mapping.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Mapping;\n  };\n\n  Mapping.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Mapping) {\n      return that.canEqual(this)\n          && this.domain.equals(that.domain)\n          && this.range.equals(that.range);\n    }\n    return false;\n  };\n\n  Mapping.prototype.toString = function (): string {\n    return \"Mapping(\" + this.domain + \", \" + this.range + \")\";\n  };\n\n  return Mapping;\n})(Function);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Values} from \"../values/Values\";\nimport {Mapping} from \"./Mapping\";\nimport {Range} from \"../\"; // forward import\nimport {LinearDomain} from \"../\"; // forward import\nimport type {LinearRange} from \"../scale/LinearRange\";\n\n/** @public */\nexport type AnyDomain<X> = Domain<X> | readonly [X, X];\n\n/** @public */\nexport interface Domain<X> extends Mapping<X, number> {\n  readonly 0: X;\n\n  readonly 1: X;\n\n  readonly domain: this;\n\n  readonly range: LinearRange;\n\n  contains(x: X): boolean;\n\n  equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Domain = (function (_super: typeof Mapping) {\n  const Domain = function <X>(x0: X, x1: X): Domain<X> {\n    const domain = function (x: X): number {\n      return Values.equal(x, domain[1]) ? 1 : 0;\n    } as Domain<X>;\n    Object.setPrototypeOf(domain, Domain.prototype);\n    (domain as Mutable<typeof domain>)[0] = x0;\n    (domain as Mutable<typeof domain>)[1] = x1;\n    return domain;\n  } as {\n    <X>(x0: X, x1: X): Domain<X>;\n\n    /** @internal */\n    prototype: Domain<any>;\n\n    readonly unit: LinearDomain;\n  };\n\n  Domain.prototype = Object.create(_super.prototype);\n  Domain.prototype.constructor = Domain;\n\n  Object.defineProperty(Domain.prototype, \"domain\", {\n    get<X>(this: Domain<X>): Domain<X> {\n      return this;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(Domain.prototype, \"range\", {\n    get(): LinearRange {\n      return Range.unit;\n    },\n    configurable: true,\n  });\n\n  Domain.prototype.contains = function (x: unknown): boolean {\n    return Values.compare(this[0], x) <= 0 && Values.compare(x, this[1]) <= 0;\n  };\n\n  Domain.prototype.equivalentTo = function (that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Domain) {\n      return Values.equivalent(this[0], that[0], epsilon)\n          && Values.equivalent(this[1], that[1], epsilon);\n    }\n    return false;\n  };\n\n  Domain.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Domain;\n  };\n\n  Domain.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Domain) {\n      return that.canEqual(this)\n          && Values.equal(this[0], that[0])\n          && Values.equal(this[1], that[1]);\n    }\n    return false;\n  };\n\n  Domain.prototype.toString = function (): string {\n    return \"Domain(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  Object.defineProperty(Domain, \"unit\", {\n    get(): Domain<number> {\n      const value = LinearDomain(0, 1);\n      Object.defineProperty(Domain, \"unit\", {\n        value: value,\n        enumerable: true,\n        configurable: true,\n      });\n      return value;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  return Domain;\n})(Mapping);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Values} from \"../values/Values\";\nimport {Mapping} from \"./Mapping\";\nimport {Domain} from \"../\"; // forward import\nimport type {LinearDomain} from \"../scale/LinearDomain\";\nimport {LinearRange} from \"../\"; // forward import\n\n/** @public */\nexport type AnyRange<Y> = Range<Y> | readonly [Y, Y];\n\n/** @public */\nexport interface Range<Y> extends Mapping<number, Y> {\n  readonly 0: Y;\n\n  readonly 1: Y;\n\n  readonly domain: LinearDomain;\n\n  readonly range: this;\n\n  equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Range = (function (_super: typeof Mapping) {\n  const Range = function <Y>(y0: Y, y1: Y): Range<Y> {\n    const range = function (u: number): Y {\n      return u < 1 ? range[0] : range[1];\n    } as Range<Y>;\n    Object.setPrototypeOf(range, Range.prototype);\n    (range as Mutable<typeof range>)[0] = y0;\n    (range as Mutable<typeof range>)[1] = y1;\n    return range;\n  } as {\n    <Y>(y0: Y, y1: Y): Range<Y>;\n\n    /** @internal */\n    prototype: Range<any>;\n\n    readonly unit: LinearRange;\n  };\n\n  Range.prototype = Object.create(_super.prototype);\n  Range.prototype.constructor = Range;\n\n  Object.defineProperty(Range.prototype, \"domain\", {\n    get(): LinearDomain {\n      return Domain.unit;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(Range.prototype, \"range\", {\n    get<Y>(this: Range<Y>): Range<Y> {\n      return this;\n    },\n    configurable: true,\n  });\n\n  Range.prototype.equivalentTo = function (that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Range) {\n      return Values.equivalent(this[0], that[0], epsilon)\n          && Values.equivalent(this[1], that[1], epsilon);\n    }\n    return false;\n  };\n\n  Range.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Range;\n  };\n\n  Range.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Range) {\n      return that.canEqual(this)\n          && Values.equal(this[0], that[0])\n          && Values.equal(this[1], that[1]);\n    }\n    return false;\n  };\n\n  Range.prototype.toString = function (): string {\n    return \"Range(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  Object.defineProperty(Range, \"unit\", {\n    get(): LinearRange {\n      const value = LinearRange(0, 1);\n      Object.defineProperty(Range, \"unit\", {\n        value: value,\n        enumerable: true,\n        configurable: true,\n      });\n      return value;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  return Range;\n})(Mapping);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Interpolator} from \"./Interpolator\";\n\n/**\n * Type that can be [[Interpolator interpolated]] to values of type `T`.\n * @public\n */\nexport interface Interpolate<T = unknown> {\n  /**\n   * Returns an [[Interpolator]] function that blends between `this` value and\n   * `that` value, if possible; otherwise returns `null` if `this` is unable to\n   * construct an interpolator to `that`.\n   */\n  interpolateTo(that: unknown): Interpolator<T> | null;\n}\n\n/** @public */\nexport const Interpolate = (function () {\n  const Interpolate = function (x: unknown, y: unknown): Interpolator | null {\n    if (x !== void 0 && x !== null && typeof (x as Interpolate).interpolateTo === \"function\") {\n      return (x as Interpolate).interpolateTo(y);\n    } else {\n      return null;\n    }\n  } as {\n    /**\n     * Returns `x.interpolateTo(y)`, if `x` conforms to the [[Interpolate]]\n     * interface; otherwise returns `null`.\n     */\n    <T>(x: Interpolate<T> | null | undefined, y: unknown): Interpolator<T> | null;\n    (x: unknown, y: unknown): Interpolator | null;\n\n    /**\n     * Returns `true` if `object` conforms to the [[Interpolate]] interface.\n     */\n    is(object: unknown): object is Interpolate;\n  };\n\n  Interpolate.is = function (object: unknown): object is Interpolate {\n    return object !== void 0 && object !== null\n        && typeof (object as Interpolate).interpolateTo === \"function\";\n  };\n\n  return Interpolate;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Values} from \"../values/Values\";\nimport {Range} from \"../mapping/Range\";\nimport {Interpolate} from \"./Interpolate\";\nimport {InterpolatorMap} from \"../\"; // forward import\nimport {IdentityInterpolator} from \"../\"; // forward import\nimport {StepInterpolator} from \"../\"; // forward import\nimport {NumberInterpolator} from \"../\"; // forward import\nimport {ArrayInterpolator} from \"../\"; // forward import\nimport {InterpolatorInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport interface Interpolator<Y = unknown> extends Range<Y>, Interpolate<Interpolator<Y>> {\n  readonly 0: Y;\n\n  readonly 1: Y;\n\n  map<FY>(transform: (y: Y) => FY): Interpolator<FY>;\n\n  interpolateTo(that: Interpolator<Y>): Interpolator<Interpolator<Y>>;\n  interpolateTo(that: unknown): Interpolator<Interpolator<Y>> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Interpolator = (function (_super: typeof Range) {\n  const Interpolator = function (y0: unknown, y1: unknown): Interpolator {\n    let interpolator: Interpolator | null;\n    if (y0 === y1) {\n      interpolator = IdentityInterpolator(y0);\n    } else if (typeof y0 === \"number\" && typeof y1 === \"number\") {\n      interpolator = NumberInterpolator(y0, y1);\n    } else if (Array.isArray(y0) && Array.isArray(y1)) {\n      interpolator = ArrayInterpolator(y0, y1);\n    } else {\n      interpolator = Interpolate(y0, y1);\n      if (interpolator === null) {\n        interpolator = StepInterpolator(y0, y1);\n      }\n    }\n    return interpolator;\n  } as {\n    <Y>(y0: Y, y1: Y): Interpolator<Y>;\n    (y0: unknown, y1: unknown): Interpolator;\n\n    /** @internal */\n    prototype: Interpolator<any>;\n  };\n\n  Interpolator.prototype = Object.create(_super.prototype);\n  Interpolator.prototype.constructor = Interpolator;\n\n  Interpolator.prototype.map = function <Y, FY>(this: Interpolator<Y>, transform: (y: Y) => FY): Interpolator<FY> {\n    return InterpolatorMap(this, transform);\n  };\n\n  Interpolator.prototype.interpolateTo = function <Y>(this: Interpolator<Y>, that: unknown): Interpolator<Interpolator<Y>> | null {\n    if (that instanceof Interpolator) {\n      return InterpolatorInterpolator(this, that);\n    }\n    return null;\n  } as typeof Interpolator.prototype.interpolateTo;\n\n  Interpolator.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof this.constructor;\n  };\n\n  Interpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Interpolator) {\n      return that.canEqual(this)\n          && Values.equal(this[0], that[0])\n          && Values.equal(this[1], that[1]);\n    }\n    return false;\n  };\n\n  Interpolator.prototype.toString = function (): string {\n    return \"Interpolator(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  return Interpolator;\n})(Range);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"./Interpolator\";\n\n/** @internal */\nexport interface InterpolatorMap<Y, FY> extends Interpolator<FY> {\n  /** @internal */\n  readonly interpolator: Interpolator<Y>;\n\n  /** @internal */\n  readonly transform: (y: Y) => FY;\n\n  readonly 0: FY;\n\n  readonly 1: FY;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const InterpolatorMap = (function (_super: typeof Interpolator) {\n  const InterpolatorMap = function <Y, FY>(interpolator: Interpolator<Y>,\n                                           transform: (y: Y) => FY): InterpolatorMap<Y, FY> {\n    const map = function (u: number): FY {\n      return map.transform(map.interpolator(u));\n    } as InterpolatorMap<Y, FY>;\n    Object.setPrototypeOf(map, InterpolatorMap.prototype);\n    (map as Mutable<typeof map>).interpolator = interpolator;\n    (map as Mutable<typeof map>).transform = transform;\n    return map;\n  } as {\n    <Y, FY>(interpolator: Interpolator<Y>, transform: (y: Y) => FY): InterpolatorMap<Y, FY>;\n\n    /** @internal */\n    prototype: InterpolatorMap<any, any>;\n  };\n\n  InterpolatorMap.prototype = Object.create(_super.prototype);\n  InterpolatorMap.prototype.constructor = InterpolatorMap;\n\n  Object.defineProperty(InterpolatorMap.prototype, 0, {\n    get<Y, FY>(this: InterpolatorMap<Y, FY>): FY {\n      return this.transform(this.interpolator[0]);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(InterpolatorMap.prototype, 1, {\n    get<Y, FY>(this: InterpolatorMap<Y, FY>): FY {\n      return this.transform(this.interpolator[1]);\n    },\n    configurable: true,\n  });\n\n  InterpolatorMap.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof InterpolatorMap) {\n      return this.interpolator.equals(that.interpolator)\n          && this.transform === that.transform;\n    }\n    return false;\n  };\n\n  return InterpolatorMap;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"./Interpolator\";\n\n/** @internal */\nexport interface IdentityInterpolator<Y> extends Interpolator<Y> {\n  /** @internal */\n  readonly value: Y;\n\n  readonly 0: Y;\n\n  readonly 1: Y;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const IdentityInterpolator = (function (_super: typeof Interpolator) {\n  const IdentityInterpolator = function <Y>(value: Y): IdentityInterpolator<Y> {\n    const interpolator = function (u: number): Y {\n      return interpolator.value;\n    } as IdentityInterpolator<Y>;\n    Object.setPrototypeOf(interpolator, IdentityInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).value = value;\n    return interpolator;\n  } as {\n    <Y>(value: Y): IdentityInterpolator<Y>;\n\n    /** @internal */\n    prototype: IdentityInterpolator<any>;\n  };\n\n  IdentityInterpolator.prototype = Object.create(_super.prototype);\n  IdentityInterpolator.prototype.constructor = IdentityInterpolator;\n\n  Object.defineProperty(IdentityInterpolator.prototype, 0, {\n    get<Y>(this: IdentityInterpolator<Y>): Y {\n      return this.value;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(IdentityInterpolator.prototype, 1, {\n    get<Y>(this: IdentityInterpolator<Y>): Y {\n      return this.value;\n    },\n    configurable: true,\n  });\n\n  IdentityInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof IdentityInterpolator) {\n      return this.value === that.value;\n    }\n    return false;\n  };\n\n  return IdentityInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"./Interpolator\";\n\n/** @internal */\nexport const StepInterpolator = (function (_super: typeof Interpolator) {\n  const StepInterpolator = function <Y>(y0: Y, y1: Y): Interpolator<Y> {\n    const interpolator = function (u: number): Y {\n      return u < 1 ? interpolator[0] : interpolator[1];\n    } as Interpolator<Y>;\n    Object.setPrototypeOf(interpolator, StepInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0;\n    (interpolator as Mutable<typeof interpolator>)[1] = y1;\n    return interpolator;\n  } as {\n    <Y>(y0: Y, y1: Y): Interpolator<Y>;\n\n    /** @internal */\n    prototype: Interpolator<any>;\n  };\n\n  StepInterpolator.prototype = Object.create(_super.prototype);\n  StepInterpolator.prototype.constructor = StepInterpolator;\n\n  return StepInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"./Interpolator\";\n\n/** @internal */\nexport const NumberInterpolator = (function (_super: typeof Interpolator) {\n  const NumberInterpolator = function (y0: number, y1: number): Interpolator<number> {\n    const interpolator = function (u: number): number {\n      const y0 = interpolator[0];\n      const y1 = interpolator[1];\n      return y0 + u * (y1 - y0);\n    } as Interpolator<number>;\n    Object.setPrototypeOf(interpolator, NumberInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0;\n    (interpolator as Mutable<typeof interpolator>)[1] = y1;\n    return interpolator;\n  } as {\n    (y0: number, y1: number): Interpolator<number>;\n\n    /** @internal */\n    prototype: Interpolator<number>;\n  };\n\n  NumberInterpolator.prototype = Object.create(_super.prototype);\n  NumberInterpolator.prototype.constructor = NumberInterpolator;\n\n  return NumberInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"./Interpolator\";\n\n/** @internal */\nexport interface ArrayInterpolator<Y> extends Interpolator<ReadonlyArray<Y>> {\n  /** @internal */\n  readonly interpolators: ReadonlyArray<Interpolator<Y>>;\n\n  readonly 0: ReadonlyArray<Y>;\n\n  readonly 1: ReadonlyArray<Y>;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const ArrayInterpolator = (function (_super: typeof Interpolator) {\n  const ArrayInterpolator = function <Y>(y0: ReadonlyArray<Y>, y1: ReadonlyArray<Y>): ArrayInterpolator<Y> {\n    const interpolator = function (u: number): ReadonlyArray<Y> {\n      const interpolators = interpolator.interpolators;\n      const interpolatorCount = interpolators.length;\n      const array = new Array<Y>(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        array[i] = interpolators[i]!(u);\n      }\n      return array;\n    } as ArrayInterpolator<Y>;\n    Object.setPrototypeOf(interpolator, ArrayInterpolator.prototype);\n    const interpolatorCount = Math.min(y0.length, y1.length);\n    const interpolators = new Array<Interpolator<Y>>(interpolatorCount);\n    for (let i = 0; i < interpolatorCount; i += 1) {\n      interpolators[i] = Interpolator(y0[i]!, y1[i]!);\n    }\n    (interpolator as Mutable<typeof interpolator>).interpolators = interpolators;\n    return interpolator;\n  } as {\n    <Y>(y0: ReadonlyArray<Y>, y1: ReadonlyArray<Y>): ArrayInterpolator<Y>;\n\n    /** @internal */\n    prototype: ArrayInterpolator<any>;\n  };\n\n  ArrayInterpolator.prototype = Object.create(_super.prototype);\n  ArrayInterpolator.prototype.constructor = ArrayInterpolator;\n\n  Object.defineProperty(ArrayInterpolator.prototype, 0, {\n    get<Y>(this: ArrayInterpolator<Y>): ReadonlyArray<Y> {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const array = new Array<Y>(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        array[i] = interpolators[i]![0];\n      }\n      return array;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ArrayInterpolator.prototype, 1, {\n    get<Y>(this: ArrayInterpolator<Y>): ReadonlyArray<Y> {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const array = new Array<Y>(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        array[i] = interpolators[i]![1];\n      }\n      return array;\n    },\n    configurable: true,\n  });\n\n  ArrayInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ArrayInterpolator) {\n      const n = this.interpolators.length;\n      if (n === that.interpolators.length) {\n        for (let i = 0; i < n; i += 1) {\n          if (!this.interpolators[i]!.equals(that.interpolators[i]!)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n\n  return ArrayInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"./Interpolator\";\n\n/** @internal */\nexport const InterpolatorInterpolator = (function (_super: typeof Interpolator) {\n  const InterpolatorInterpolator = function <Y>(y0: Interpolator<Y>, y1: Interpolator<Y>): Interpolator<Interpolator<Y>> {\n    const interpolator = function (u: number): Interpolator<Y> {\n      if (u === 0) {\n        return interpolator[0];\n      } else if (u === 1) {\n        return interpolator[1];\n      } else {\n        return Interpolator(interpolator[0](u), interpolator[1](u));\n      }\n    } as Interpolator<Interpolator<Y>>;\n    Object.setPrototypeOf(interpolator, InterpolatorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0;\n    (interpolator as Mutable<typeof interpolator>)[1] = y1;\n    return interpolator;\n  } as {\n    <Y>(y0: Interpolator<Y>, y1: Interpolator<Y>): Interpolator<Interpolator<Y>>;\n\n    /** @internal */\n    prototype: Interpolator<any>;\n  };\n\n  InterpolatorInterpolator.prototype = Object.create(_super.prototype);\n  InterpolatorInterpolator.prototype.constructor = InterpolatorInterpolator;\n\n  return InterpolatorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Values} from \"../values/Values\";\nimport {Domain} from \"../mapping/Domain\";\nimport {Interpolator} from \"../interpolate/Interpolator\";\nimport {AnyEasing, Easing} from \"../\"; // forward import\nimport {Tweening} from \"../\"; // forward import\n\n/** @public */\nexport type AnyTiming = Timing | TimingInit;\n\n/** @public */\nexport interface TimingInit {\n  easing?: AnyEasing;\n  t0?: number;\n  t1?: number;\n  dt?: number;\n}\n\n/** @public */\nexport interface Timing extends Domain<number> {\n  readonly 0: number;\n\n  readonly 1: number;\n\n  readonly duration: number;\n\n  readonly easing: Easing;\n\n  contains(t: number): boolean;\n\n  withDomain(t0: number, t1: number): Timing;\n\n  withDuration(dt: number): Timing;\n\n  overRange<Y>(range: Interpolator<Y>): Tweening<Y>;\n  overRange<Y>(y0: Y, y1: Y): Tweening<Y>;\n\n  equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Timing = (function (_super: typeof Domain) {\n  const Timing = function (easing: Easing, t0: number, t1: number): Timing {\n    const timing = function (t: number): number {\n      const t0 = timing[0];\n      const t1 = timing[1];\n      return timing.easing(Math.min(Math.max(0, (t - t0) / (t1 - t0)), 1));\n    } as Timing;\n    Object.setPrototypeOf(timing, Timing.prototype);\n    (timing as Mutable<typeof timing>).easing = easing;\n    (timing as Mutable<typeof timing>)[0] = t0;\n    (timing as Mutable<typeof timing>)[1] = t1;\n    return timing;\n  } as {\n    (easing: Easing, t0: number, t1: number): Timing;\n\n    /** @internal */\n    prototype: Timing;\n\n    fromInit(init: TimingInit): Timing;\n\n    fromAny(value: AnyTiming): Timing;\n    fromAny(value: AnyTiming | boolean | null | undefined): Timing | boolean;\n  };\n\n  Timing.prototype = Object.create(_super.prototype);\n  Timing.prototype.constructor = Timing;\n\n  Object.defineProperty(Timing.prototype, \"duration\", {\n    get(this: Timing): number {\n      return this[1] - this[0];\n    },\n    configurable: true,\n  });\n\n  Timing.prototype.contains = function (t: number): boolean {\n    return this[0] <= t && t <= this[1];\n  };\n\n  Timing.prototype.withDomain = function (t0: number, t1: number): Timing {\n    return Timing(this.easing, t0, t1);\n  };\n\n  Timing.prototype.withDuration = function (dt: number): Timing {\n    const t0 = this[0];\n    return Timing(this.easing, t0, t0 + dt);\n  };\n\n  Timing.prototype.overRange = function <Y>(this: Timing, y0: Interpolator<Y> | Y, y1: Y): Tweening<Y> {\n    let range: Interpolator<Y>;\n    if (arguments.length === 1) {\n      range = y0 as Interpolator<Y>;\n    } else {\n      range = Interpolator(y0 as Y, y1);\n    }\n    return Tweening(this, range);\n  } as typeof Timing.prototype.overRange;\n\n  Timing.prototype.equivalentTo = function (that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Timing) {\n      return this.easing.equivalentTo(that.easing, epsilon)\n          && Values.equivalent(this[0], that[0], epsilon)\n          && Values.equivalent(this[1], that[1], epsilon);\n    }\n    return false;\n  };\n\n  Timing.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Timing;\n  };\n\n  Timing.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Timing) {\n      return that.canEqual(this)\n          && this.easing.equals(that.easing)\n          && Values.equal(this[0], that[0])\n          && Values.equal(this[1], that[1]);\n    }\n    return false;\n  };\n\n  Timing.prototype.toString = function (): string {\n    return \"Timing(\" + this.easing + \", \" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  Timing.fromInit = function (init: TimingInit): Timing {\n    let easing = init.easing;\n    if (easing === void 0) {\n      easing = Easing.linear;\n    } else if (typeof easing === \"string\") {\n      easing = Easing(easing);\n    }\n    let t0 = init.t0;\n    if (t0 === void 0) {\n      t0 = 0;\n    }\n    let t1 = init.t1;\n    if (t1 === void 0) {\n      const dt = init.dt;\n      if (dt !== void 0) {\n        t1 = t0 + dt;\n      } else {\n        t1 = t0;\n      }\n    }\n    return Timing(easing, t0, t1);\n  };\n\n  Timing.fromAny = function (value: AnyTiming | boolean | null | undefined): Timing | boolean {\n    if (value === void 0 || value === null) {\n      return false;\n    } else if (value instanceof Timing || typeof value === \"boolean\") {\n      return value;\n    } else if (typeof value === \"object\") {\n      return Timing.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  } as typeof Timing.fromAny;\n\n  return Timing;\n})(Domain);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Timing} from \"./Timing\";\n\n/** @public */\nexport type AnyEasing = Easing | EasingType;\n\n/** @public */\nexport type EasingType = \"linear\" | \"quad-in\" | \"quad-out\" | \"quad-in-out\"\n                       | \"cubic-in\" | \"cubic-out\" | \"cubic-in-out\"\n                       | \"quart-in\" | \"quart-out\" | \"quart-in-out\"\n                       | \"expo-in\" | \"expo-out\" | \"expo-in-out\"\n                       | \"circ-in\" | \"circ-out\" | \"circ-in-out\"\n                       | \"back-in\" | \"back-out\" | \"back-in-out\"\n                       | \"elastic-in\" | \"elastic-out\" | \"elastic-in-out\"\n                       | \"bounce-in\" | \"bounce-out\" | \"bounce-in-out\";\n\n/** @public */\nexport interface Easing extends Timing {\n  readonly type: string;\n\n  readonly 0: 0;\n\n  readonly 1: 1;\n\n  readonly easing: this;\n\n  equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Easing = (function (_super: typeof Timing) {\n  const Easing = function (type: string): Easing {\n    switch (type) {\n      case \"linear\": return Easing.linear;\n      case \"quad-in\": return Easing.quadIn;\n      case \"quad-out\": return Easing.quadOut;\n      case \"quad-in-out\": return Easing.quadInOut;\n      case \"cubic-in\": return Easing.cubicIn;\n      case \"cubic-out\": return Easing.cubicOut;\n      case \"cubic-in-out\": return Easing.cubicInOut;\n      case \"quart-in\": return Easing.quartIn;\n      case \"quart-out\": return Easing.quartOut;\n      case \"quart-in-out\": return Easing.quartInOut;\n      case \"expo-in\": return Easing.expoIn;\n      case \"expo-out\": return Easing.expoOut;\n      case \"expo-in-out\": return Easing.expoInOut;\n      case \"circ-in\": return Easing.circIn;\n      case \"circ-out\": return Easing.circOut;\n      case \"circ-in-out\": return Easing.circInOut;\n      case \"back-in\": return Easing.backIn;\n      case \"back-out\": return Easing.backOut;\n      case \"back-in-out\": return Easing.backInOut;\n      case \"elastic-in\": return Easing.elasticIn;\n      case \"elastic-out\": return Easing.elasticOut;\n      case \"elastic-in-out\": return Easing.elasticInOut;\n      case \"bounce-in\": return Easing.bounceIn;\n      case \"bounce-out\": return Easing.bounceOut;\n      case \"bounce-in-out\": return Easing.bounceInOut;\n      default: throw new Error(\"unknown easing: \" + type);\n    }\n  } as {\n    (type: string): Easing;\n\n    /** @internal */\n    prototype: Easing;\n\n    readonly linear: Easing;\n    readonly quadIn: Easing;\n    readonly quadOut: Easing;\n    readonly quadInOut: Easing;\n    readonly cubicIn: Easing;\n    readonly cubicOut: Easing;\n    readonly cubicInOut: Easing;\n    readonly quartIn: Easing;\n    readonly quartOut: Easing;\n    readonly quartInOut: Easing;\n    readonly expoIn: Easing;\n    readonly expoOut: Easing;\n    readonly expoInOut: Easing;\n    readonly circIn: Easing;\n    readonly circOut: Easing;\n    readonly circInOut: Easing;\n    readonly backIn: Easing;\n    readonly backOut: Easing;\n    readonly backInOut: Easing;\n    readonly elasticIn: Easing;\n    readonly elasticOut: Easing;\n    readonly elasticInOut: Easing;\n    readonly bounceIn: Easing;\n    readonly bounceOut: Easing;\n    readonly bounceInOut: Easing;\n\n    fromAny(value: AnyEasing): Easing;\n  };\n\n  Easing.prototype = Object.create(_super.prototype);\n  Easing.prototype.constructor = Easing;\n\n  Object.defineProperty(Easing.prototype, 0, {\n    value: 0,\n  });\n\n  Object.defineProperty(Easing.prototype, 1, {\n    value: 1,\n  });\n\n  Object.defineProperty(Easing.prototype, \"easing\", {\n    get(this: Easing): Easing {\n      return this;\n    },\n  });\n\n  Easing.prototype.equivalentTo = function (that: unknown, epsilon?: number): boolean {\n    return this === that;\n  };\n\n  Easing.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Easing;\n  };\n\n  Easing.prototype.equals = function (that: unknown): boolean {\n    return this === that;\n  };\n\n  Easing.prototype.toString = function (): string {\n    return \"Easing(\\\"\" + this.type + \"\\\")\";\n  };\n\n  Easing.fromAny = function (value: AnyEasing): Easing {\n    if (value instanceof Easing) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return Easing(value);\n    }\n    throw new TypeError(\"\" + value);\n  };\n\n  (Easing as Mutable<typeof Easing>).linear = function (u: number): number {\n    return u;\n  } as unknown as Easing;\n  Object.setPrototypeOf(Easing.linear, Easing.prototype);\n  (Easing.linear as Mutable<Easing>).type = \"linear\";\n\n  (Easing as Mutable<typeof Easing>).quadIn = function (u: number): number {\n    return u * u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.quadIn, Easing.prototype);\n  (Easing.quadIn as Mutable<Easing>).type = \"quad-in\";\n\n  (Easing as Mutable<typeof Easing>).quadOut = function (u: number): number {\n    return u * (2 - u);\n  } as Easing;\n  Object.setPrototypeOf(Easing.quadOut, Easing.prototype);\n  (Easing.quadOut as Mutable<Easing>).type = \"quad-out\";\n\n  (Easing as Mutable<typeof Easing>).quadInOut = function (u: number): number {\n    u *= 2;\n    if (u <= 1) {\n      u = u * u;\n    } else {\n      u -= 1;\n      u = u * (2 - u);\n      u += 1;\n    }\n    u /= 2;\n    return u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.quadInOut, Easing.prototype);\n  (Easing.quadInOut as Mutable<Easing>).type = \"quad-in-out\";\n\n  (Easing as Mutable<typeof Easing>).cubicIn = function (u: number): number {\n    return u * u * u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.cubicIn, Easing.prototype);\n  (Easing.cubicIn as Mutable<Easing>).type = \"cubic-in\";\n\n  (Easing as Mutable<typeof Easing>).cubicOut = function (u: number): number {\n    u -= 1;\n    u = u * u * u;\n    u += 1;\n    return u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.cubicOut, Easing.prototype);\n  (Easing.cubicOut as Mutable<Easing>).type = \"cubic-out\";\n\n  (Easing as Mutable<typeof Easing>).cubicInOut = function (u: number): number {\n    u *= 2;\n    if (u <= 1) {\n      u = u * u * u;\n    } else {\n      u -= 2;\n      u = u * u * u;\n      u += 2;\n    }\n    u /= 2;\n    return u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.cubicInOut, Easing.prototype);\n  (Easing.cubicInOut as Mutable<Easing>).type = \"cubic-in-out\";\n\n  (Easing as Mutable<typeof Easing>).quartIn = function (u: number): number {\n    return u * u * u * u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.quartIn, Easing.prototype);\n  (Easing.quartIn as Mutable<Easing>).type = \"quart-in\";\n\n  (Easing as Mutable<typeof Easing>).quartOut = function (u: number): number {\n    u -= 1;\n    return 1 - u * u * u * u;\n  } as Easing;\n  Object.setPrototypeOf(Easing.quartOut, Easing.prototype);\n  (Easing.quartOut as Mutable<Easing>).type = \"quart-out\";\n\n  (Easing as Mutable<typeof Easing>).quartInOut = function (u: number): number {\n    const v = u - 1;\n    return u < 0.5 ? 8 * u * u * u * u : 1 - 8 * v * v * v * v;\n  } as Easing;\n  Object.setPrototypeOf(Easing.quartInOut, Easing.prototype);\n  (Easing.quartInOut as Mutable<Easing>).type = \"quart-in-out\";\n\n  (Easing as Mutable<typeof Easing>).expoIn = function (u: number): number {\n    if (u === 0) {\n      return 0;\n    }\n    return Math.pow(2, 10 * (u - 1) );\n  } as Easing;\n  Object.setPrototypeOf(Easing.expoIn, Easing.prototype);\n  (Easing.expoIn as Mutable<Easing>).type = \"expo-in\";\n\n  (Easing as Mutable<typeof Easing>).expoOut = function (u: number): number {\n    if (u === 1) {\n      return 1;\n    }\n    return (-Math.pow(2, -10 * u) + 1);\n  } as Easing;\n  Object.setPrototypeOf(Easing.expoOut, Easing.prototype);\n  (Easing.expoOut as Mutable<Easing>).type = \"expo-out\";\n\n  (Easing as Mutable<typeof Easing>).expoInOut = function (u: number): number {\n    if (u === 1 || u === 0) {\n      return u;\n    }\n    u *= 2;\n    if (u < 1) {\n      return 0.5 * Math.pow(2, 10 * (u - 1));\n    }\n    return 0.5 * (-Math.pow(2, -10 * (u - 1)) + 2);\n  } as Easing;\n  Object.setPrototypeOf(Easing.expoInOut, Easing.prototype);\n  (Easing.expoInOut as Mutable<Easing>).type = \"expo-in-out\";\n\n  (Easing as Mutable<typeof Easing>).circIn = function (u: number): number {\n    return -1 * (Math.sqrt(1 - (u / 1) * u) - 1);\n  } as Easing;\n  Object.setPrototypeOf(Easing.circIn, Easing.prototype);\n  (Easing.circIn as Mutable<Easing>).type = \"circ-in\";\n\n  (Easing as Mutable<typeof Easing>).circOut = function (u: number): number {\n    u -= 1;\n    return Math.sqrt(1 - u * u);\n  } as Easing;\n  Object.setPrototypeOf(Easing.circOut, Easing.prototype);\n  (Easing.circOut as Mutable<Easing>).type = \"circ-out\";\n\n  (Easing as Mutable<typeof Easing>).circInOut = function (u: number): number {\n    u *= 2;\n    if (u < 1) {\n      return -0.5 * (Math.sqrt(1 - u * u) - 1);\n    }\n    const st = u - 2;\n    return 0.5 * (Math.sqrt(1 - st * st) + 1);\n  } as Easing;\n  Object.setPrototypeOf(Easing.circInOut, Easing.prototype);\n  (Easing.circInOut as Mutable<Easing>).type = \"circ-in-out\";\n\n  (Easing as Mutable<typeof Easing>).backIn = function (u: number): number {\n    const m = 1.70158; // m - Magnitude\n    return u * u * (( m + 1) * u - m);\n  } as Easing;\n  Object.setPrototypeOf(Easing.backIn, Easing.prototype);\n  (Easing.backIn as Mutable<Easing>).type = \"back-in\";\n\n  (Easing as Mutable<typeof Easing>).backOut = function (u: number): number {\n    const m = 1.70158;\n    const st = (u / 1) - 1;\n    return (st * st * ((m + 1) * m + m)) + 1;\n  } as Easing;\n  Object.setPrototypeOf(Easing.backOut, Easing.prototype);\n  (Easing.backOut as Mutable<Easing>).type = \"back-out\";\n\n  (Easing as Mutable<typeof Easing>).backInOut = function (u: number): number {\n    const m = 1.70158;\n    const s = m * 1.525;\n    if ((u *= 2) < 1) {\n      return 0.5 * u * u * (((s + 1) * u) - s);\n    }\n    const st = u - 2;\n    return 0.5 * (st * st * ((s + 1) * st + s) + 2);\n  } as Easing;\n  Object.setPrototypeOf(Easing.backInOut, Easing.prototype);\n  (Easing.backInOut as Mutable<Easing>).type = \"back-in-out\";\n\n  (Easing as Mutable<typeof Easing>).elasticIn = function (u: number): number {\n    if (u === 0 || u === 1) {\n      return u;\n    }\n    const m = 0.7;\n    const st = (u / 1) - 1;\n    const s = (1 - m) / 2 * Math.PI * Math.asin(1);\n    return -(Math.pow(2, 10 * st) * Math.sin((st - s) * 2 * Math.PI / (1 - m)));\n  } as Easing;\n  Object.setPrototypeOf(Easing.elasticIn, Easing.prototype);\n  (Easing.elasticIn as Mutable<Easing>).type = \"elastic-in\";\n\n  (Easing as Mutable<typeof Easing>).elasticOut = function (u: number): number {\n    if (u === 0 || u === 1) {\n      return u;\n    }\n    const m = 0.7;\n    const s = (1 -  m) / (2 * Math.PI) * Math.asin(1);\n    u *= 2;\n    return (Math.pow(2, -10 * u) * Math.sin((u - s) * 2 * Math.PI / (1 - m))) + 1;\n  } as Easing;\n  Object.setPrototypeOf(Easing.elasticOut, Easing.prototype);\n  (Easing.elasticOut as Mutable<Easing>).type = \"elastic-out\";\n\n  (Easing as Mutable<typeof Easing>).elasticInOut = function (u: number): number {\n    if (u === 0 || u === 1) {\n      return u;\n    }\n    const m = 0.65;\n    const s = (1 - m) / (2 * Math.PI) * Math.asin(1);\n    const st = u * 2;\n    const st1 = st - 1;\n    if(st < 1) {\n      return -0.5 * (Math.pow(2, 10 * st1) * Math.sin((st1 - s) * 2 * Math.PI / (1 - m)));\n    }\n    return (Math.pow(2, -10 * st1) * Math.sin((st1 - s) * 2 * Math.PI / (1 - m)) * 0.5) + 1;\n  } as Easing;\n  Object.setPrototypeOf(Easing.elasticInOut, Easing.prototype);\n  (Easing.elasticInOut as Mutable<Easing>).type = \"elastic-in-out\";\n\n  (Easing as Mutable<typeof Easing>).bounceIn = function (u: number): number {\n    const p = 7.5625;\n    if ((u = 1 - u) < 1 / 2.75) {\n      return 1 - (p * u * u);\n    } else if (u < 2 / 2.75) {\n      return 1 - (p * (u -= 1.5 / 2.75) * u + 0.75);\n    } else if (u < 2.5 / 2.75) {\n      return 1 - (p * (u -= 2.25 / 2.75) * u + 0.9375);\n    }\n    return 1 - (p * (u -= 2.625 / 2.75) * u + 0.984375);\n  } as Easing;\n  Object.setPrototypeOf(Easing.bounceIn, Easing.prototype);\n  (Easing.bounceIn as Mutable<Easing>).type = \"bounce-in\";\n\n  (Easing as Mutable<typeof Easing>).bounceOut = function (u: number): number {\n    const p = 7.5625;\n    if (u < 1 / 2.75) {\n      return p * u * u;\n    } else if (u < 2 / 2.75) {\n      return p * (u -= 1.5 / 2.75) * u + 0.75;\n    } else if (u < 2.5 / 2.75) {\n      return p * (u -= 2.25 / 2.75) * u + 0.9375;\n    }\n    return p * (u -= 2.625 / 2.75) * u + 0.984375;\n  } as Easing;\n  Object.setPrototypeOf(Easing.bounceOut, Easing.prototype);\n  (Easing.bounceOut as Mutable<Easing>).type = \"bounce-out\";\n\n  (Easing as Mutable<typeof Easing>).bounceInOut = function (u: number): number {\n    const invert = u < 0.5;\n    u = invert ? 1 - (u * 2) : (u * 2) - 1;\n    const p = 7.5625;\n    if (u < 1 / 2.75) {\n      u = p * u * u;\n    } else if (u < 2 / 2.75) {\n      u = p * (u -= 1.5 / 2.75) * u + 0.75;\n    } else if (u < 2.5 / 2.75) {\n      u = p * (u -= 2.25 / 2.75) * u + 0.9375;\n    } else {\n      u = p * (u -= 2.625 / 2.75) * u + 0.984375;\n    }\n    return invert ? (1 - u) * 0.5 : u * 0.5 + 0.5;\n  } as Easing;\n  Object.setPrototypeOf(Easing.bounceInOut, Easing.prototype);\n  (Easing.bounceInOut as Mutable<Easing>).type = \"bounce-in-out\";\n\n  return Easing;\n})(Timing);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Mapping} from \"../mapping/Mapping\";\nimport type {Interpolator} from \"../interpolate/Interpolator\";\nimport type {Timing} from \"./Timing\";\n\n/** @public */\nexport interface Tweening<Y> extends Mapping<number, Y> {\n  readonly domain: Timing;\n\n  readonly range: Interpolator<Y>;\n\n  withDomain(t0: number, t1: number): Tweening<Y>;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Tweening = (function (_super: typeof Mapping) {\n  const Tweening = function <Y>(domain: Timing, range: Interpolator<Y>): Tweening<Y> {\n    const tweening = function (u: number): Y {\n      return tweening.range(tweening.domain(u));\n    } as Tweening<Y>;\n    Object.setPrototypeOf(tweening, Tweening.prototype);\n    (tweening as Mutable<typeof tweening>).domain = domain;\n    (tweening as Mutable<typeof tweening>).range = range;\n    return tweening;\n  } as {\n    <Y>(domain: Timing, range: Interpolator<Y>): Tweening<Y>\n\n    /** @internal */\n    prototype: Tweening<any>;\n  };\n\n  Tweening.prototype = Object.create(_super.prototype);\n  Tweening.prototype.constructor = Tweening;\n\n  Tweening.prototype.withDomain = function <Y>(this: Tweening<Y>, t0: number, t1: number): Tweening<Y> {\n    return this.domain.withDomain(t0, t1).overRange(this.range);\n  };\n\n  Tweening.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Tweening;\n  };\n\n  Tweening.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Tweening) {\n      return this.domain.equals(that.domain) && this.range.equals(that.range);\n    }\n    return false;\n  };\n\n  Tweening.prototype.toString = function (): string {\n    return \"Tweening(\" + this.domain + \", \" + this.range + \")\";\n  };\n\n  return Tweening;\n})(Mapping);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Domain} from \"../mapping/Domain\";\nimport type {Interpolate} from \"../interpolate/Interpolate\";\nimport type {Interpolator} from \"../interpolate/Interpolator\";\nimport {LinearDomainInterpolator} from \"../\"; // forward import\nimport {LinearRange} from \"../\"; // forward import\n\n/** @public */\nexport interface LinearDomain extends Domain<number>, Interpolate<LinearDomain> {\n  readonly 0: number;\n\n  readonly 1: number;\n\n  readonly inverse: LinearRange;\n\n  contains(x: number): boolean;\n\n  interpolateTo(that: LinearDomain): Interpolator<LinearDomain>;\n  interpolateTo(that: unknown): Interpolator<LinearDomain> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const LinearDomain = (function (_super: typeof Domain) {\n  const LinearDomain = function (x0: number, x1: number): LinearDomain {\n    const domain = function (x: number): number {\n      const x0 = domain[0];\n      const x1 = domain[1];\n      const dx = x1 - x0;\n      return dx !== 0 ? (x - x0) / dx : 0;\n    } as LinearDomain;\n    Object.setPrototypeOf(domain, LinearDomain.prototype);\n    (domain as Mutable<typeof domain>)[0] = x0;\n    (domain as Mutable<typeof domain>)[1] = x1;\n    return domain;\n  } as {\n    (x0: number, x1: number): LinearDomain;\n\n    /** @internal */\n    prototype: LinearDomain;\n  };\n\n  LinearDomain.prototype = Object.create(_super.prototype);\n  LinearDomain.prototype.constructor = LinearDomain;\n\n  Object.defineProperty(LinearDomain.prototype, \"inverse\", {\n    get(this: LinearDomain): LinearRange {\n      return LinearRange(this[0], this[1]);\n    },\n    configurable: true,\n  });\n\n  LinearDomain.prototype.contains = function (x: number): boolean {\n    return this[0] <= x && x <= this[1];\n  };\n\n  LinearDomain.prototype.interpolateTo = function (this: LinearDomain, that: unknown): Interpolator<LinearDomain> | null {\n    if (that instanceof LinearDomain) {\n      return LinearDomainInterpolator(this, that);\n    }\n    return null;\n  } as typeof LinearDomain.prototype.interpolateTo;\n\n  LinearDomain.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof LinearDomain;\n  };\n\n  LinearDomain.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinearDomain) {\n      return that.canEqual(this) && this[0] === that[0] && this[1] === that[1];\n    }\n    return false;\n  };\n\n  LinearDomain.prototype.toString = function (): string {\n    return \"LinearDomain(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  return LinearDomain;\n})(Domain);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"../interpolate/Interpolator\";\nimport {LinearDomain} from \"./LinearDomain\";\n\n/** @internal */\nexport const LinearDomainInterpolator = (function (_super: typeof Interpolator) {\n  const LinearDomainInterpolator = function (x0: LinearDomain, x1: LinearDomain): Interpolator<LinearDomain> {\n    const interpolator = function (u: number): LinearDomain {\n      const x0 = interpolator[0];\n      const x00 = x0[0];\n      const x01 = x0[1];\n      const x1 = interpolator[1];\n      const x10 = x1[0];\n      const x11 = x1[1];\n      return LinearDomain(x00 + u * (x10 - x00), x01 + u * (x11 - x01));\n    } as Interpolator<LinearDomain>;\n    Object.setPrototypeOf(interpolator, LinearDomainInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = x0;\n    (interpolator as Mutable<typeof interpolator>)[1] = x1;\n    return interpolator;\n  } as {\n    (x0: LinearDomain, x1: LinearDomain): Interpolator<LinearDomain>;\n\n    /** @internal */\n    prototype: Interpolator<LinearDomain>;\n  };\n\n  LinearDomainInterpolator.prototype = Object.create(_super.prototype);\n  LinearDomainInterpolator.prototype.constructor = LinearDomainInterpolator;\n\n  return LinearDomainInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Range} from \"../mapping/Range\";\nimport type {Interpolate} from \"../interpolate/Interpolate\";\nimport type {Interpolator} from \"../interpolate/Interpolator\";\nimport {LinearDomain} from \"../\"; // forward import\nimport {LinearRangeInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport interface LinearRange extends Range<number>, Interpolate<LinearRange> {\n  readonly 0: number;\n\n  readonly 1: number;\n\n  readonly inverse: LinearDomain;\n\n  interpolateTo(that: LinearRange): Interpolator<LinearRange>;\n  interpolateTo(that: unknown): Interpolator<LinearRange> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const LinearRange = (function (_super: typeof Range) {\n  const LinearRange = function (y0: number, y1: number): LinearRange {\n    const range = function (u: number): number {\n      const y0 = range[0];\n      const y1 = range[1];\n      return y0 + u * (y1 - y0);\n    } as LinearRange;\n    Object.setPrototypeOf(range, LinearRange.prototype);\n    (range as Mutable<typeof range>)[0] = y0;\n    (range as Mutable<typeof range>)[1] = y1;\n    return range;\n  } as {\n    (y0: number, y1: number): LinearRange;\n\n    /** @internal */\n    prototype: LinearRange;\n  };\n\n  LinearRange.prototype = Object.create(_super.prototype);\n  LinearRange.prototype.constructor = LinearRange;\n\n  Object.defineProperty(LinearRange.prototype, \"inverse\", {\n    get(this: LinearRange): LinearDomain {\n      return LinearDomain(this[0], this[1]);\n    },\n    configurable: true,\n  });\n\n  LinearRange.prototype.interpolateTo = function (this: LinearRange, that: unknown): Interpolator<LinearRange> | null {\n    if (that instanceof LinearRange) {\n      return LinearRangeInterpolator(this, that);\n    }\n    return null;\n  } as typeof LinearRange.prototype.interpolateTo;\n\n  LinearRange.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof LinearRange;\n  };\n\n  LinearRange.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinearRange) {\n      return that.canEqual(this) && this[0] === that[0] && this[1] === that[1];\n    }\n    return false;\n  };\n\n  LinearRange.prototype.toString = function (): string {\n    return \"LinearRange(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  return LinearRange;\n})(Range);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"../interpolate/Interpolator\";\nimport {LinearRange} from \"./LinearRange\";\n\n/** @internal */\nexport const LinearRangeInterpolator = (function (_super: typeof Interpolator) {\n  const LinearRangeInterpolator = function (y0: LinearRange, y1: LinearRange): Interpolator<LinearRange> {\n    const interpolator = function (u: number): LinearRange {\n      const y0 = interpolator[0];\n      const y00 = y0[0];\n      const y01 = y0[1];\n      const y1 = interpolator[1];\n      const y10 = y1[0];\n      const y11 = y1[1];\n      return LinearRange(y00 + u * (y10 - y00), y01 + u * (y11 - y01));\n    } as Interpolator<LinearRange>;\n    Object.setPrototypeOf(interpolator, LinearRangeInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0;\n    (interpolator as Mutable<typeof interpolator>)[1] = y1;\n    return interpolator;\n  } as {\n    (y0: LinearRange, y1: LinearRange): Interpolator<LinearRange>;\n\n    /** @internal */\n    prototype: Interpolator<LinearRange>;\n  };\n\n  LinearRangeInterpolator.prototype = Object.create(_super.prototype);\n  LinearRangeInterpolator.prototype.constructor = LinearRangeInterpolator;\n\n  return LinearRangeInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mapping} from \"../mapping/Mapping\";\nimport type {Domain} from \"../mapping/Domain\";\nimport type {Range} from \"../mapping/Range\";\n\n/** @public */\nexport interface Scale<X, Y> extends Mapping<X, Y> {\n  readonly inverse: Mapping<Y, X>;\n\n  withDomain(domain: Domain<X>): Scale<X, Y>;\n  withDomain(x0: X, x1: X): Scale<X, Y>;\n\n  overRange(range: Range<Y>): Scale<X, Y>;\n  overRange(y0: Y, y1: Y): Scale<X, Y>;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const Scale = (function (_super: typeof Mapping) {\n  const Scale = function (): never {\n    throw new Error();\n  } as {\n    /** @internal */\n    (): never;\n\n    /** @internal */\n    prototype: Scale<any, any>;\n  };\n\n  Scale.prototype = Object.create(_super.prototype);\n  Scale.prototype.constructor = Scale;\n\n  Scale.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof Scale;\n  };\n\n  Scale.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Scale) {\n      return this.domain.equals(that.domain) && this.range.equals(that.range);\n    }\n    return false;\n  };\n\n  Scale.prototype.toString = function (): string {\n    return \"Scale(\" + this.domain + \", \" + this.range + \")\";\n  };\n\n  return Scale;\n})(Mapping);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mapping} from \"../mapping/Mapping\";\nimport type {Domain} from \"../mapping/Domain\";\nimport type {Range} from \"../mapping/Range\";\nimport {Scale} from \"./Scale\";\n\n/** @public */\nexport interface ContinuousScale<X, Y> extends Scale<X, Y> {\n  readonly inverse: Mapping<Y, X>;\n\n  withDomain(domain: Domain<X>): ContinuousScale<X, Y>;\n  withDomain(x0: X, x1: X): ContinuousScale<X, Y>;\n\n  overRange(range: Range<Y>): ContinuousScale<X, Y>;\n  overRange(y0: Y, y1: Y): ContinuousScale<X, Y>;\n\n  clampDomain(xMin: X | undefined, xMax: X | undefined,\n              zMin: number | undefined, zMax: number | undefined,\n              epsilon?: number): ContinuousScale<X, Y>;\n\n  solveDomain(x1: X, y1: Y, x2?: X, y2?: Y,\n              reflect?: boolean, epsilon?: number): ContinuousScale<X, Y>;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const ContinuousScale = (function (_super: typeof Scale) {\n  const ContinuousScale = function (): never {\n    throw new Error();\n  } as {\n    /** @internal */\n    (): never;\n\n    /** @internal */\n    prototype: ContinuousScale<any, any>;\n  };\n\n  ContinuousScale.prototype = Object.create(_super.prototype);\n  ContinuousScale.prototype.constructor = ContinuousScale;\n\n  ContinuousScale.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof ContinuousScale;\n  };\n\n  ContinuousScale.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ContinuousScale) {\n      return this.domain.equals(that.domain) && this.range.equals(that.range);\n    }\n    return false;\n  };\n\n  ContinuousScale.prototype.toString = function (): string {\n    return \"ContinuousScale(\" + this.domain + \", \" + this.range + \")\";\n  };\n\n  return ContinuousScale;\n})(Scale);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Equivalent} from \"../compare/Equivalent\";\nimport type {Interpolate} from \"../interpolate/Interpolate\";\nimport type {Interpolator} from \"../interpolate/Interpolator\";\nimport {LinearDomain} from \"./LinearDomain\";\nimport {LinearRange} from \"./LinearRange\";\nimport {ContinuousScale} from \"./ContinuousScale\";\nimport {LinearScaleInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport interface LinearScale extends ContinuousScale<number, number>, Interpolate<LinearScale> {\n  readonly domain: LinearDomain;\n\n  readonly range: LinearRange;\n\n  readonly inverse: LinearScale;\n\n  withDomain(domain: LinearDomain): LinearScale;\n  withDomain(x0: number, x1: number): LinearScale;\n\n  overRange(range: LinearRange): LinearScale;\n  overRange(y0: number, y1: number): LinearScale;\n\n  clampDomain(xMin: number | undefined, xMax: number | undefined,\n              zMin: number | undefined, zMax: number | undefined,\n              epsilon?: number): LinearScale;\n\n  solveDomain(x1: number, y1: number, x2?: number, y2?: number,\n              reflect?: boolean, epsilon?: number): LinearScale;\n\n  interpolateTo(that: LinearScale): Interpolator<LinearScale>;\n  interpolateTo(that: unknown): Interpolator<LinearScale> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const LinearScale = (function (_super: typeof ContinuousScale) {\n  const LinearScale = function (domain: LinearDomain, range: LinearRange): LinearScale {\n    const scale = function (x: number): number {\n      return scale.range(scale.domain(x));\n    } as LinearScale;\n    Object.setPrototypeOf(scale, LinearScale.prototype);\n    (scale as Mutable<typeof scale>).domain = domain;\n    (scale as Mutable<typeof scale>).range = range;\n    return scale;\n  } as {\n    (domain: LinearDomain, range: LinearRange): LinearScale;\n\n    /** @internal */\n    prototype: LinearScale;\n  };\n\n  LinearScale.prototype = Object.create(_super.prototype);\n  LinearScale.prototype.constructor = LinearScale;\n\n  Object.defineProperty(LinearScale.prototype, \"inverse\", {\n    get(this: LinearScale): LinearScale {\n      return LinearScale(this.range.inverse, this.domain.inverse);\n    },\n    configurable: true,\n  });\n\n  LinearScale.prototype.withDomain = function (x0: LinearDomain | number, x1?: number): LinearScale {\n    let domain: LinearDomain;\n    if (arguments.length === 1) {\n      domain = x0 as LinearDomain;\n    } else {\n      domain = LinearDomain(x0 as number, x1!);\n    }\n    return LinearScale(domain, this.range);\n  };\n\n  LinearScale.prototype.overRange = function (y0: LinearRange | number, y1?: number): LinearScale {\n    let range: LinearRange;\n    if (arguments.length === 1) {\n      range = y0 as LinearRange;\n    } else {\n      range = LinearRange(y0 as number, y1!);\n    }\n    return LinearScale(this.domain, range);\n  };\n\n  LinearScale.prototype.clampDomain = function (xMin: number | undefined, xMax: number | undefined,\n                                                zMin: number | undefined, zMax: number | undefined,\n                                                epsilon?: number): LinearScale {\n    if (epsilon === void 0) {\n      epsilon = Equivalent.Epsilon;\n    }\n    let x0 = this.domain[0];\n    let x1 = this.domain[1];\n    if (xMin !== void 0 && xMax !== void 0 && Math.abs(x1 - x0) > xMax - xMin) {\n      if (x0 < x1) {\n        x0 = xMin;\n        x1 = xMax;\n      } else {\n        x1 = xMin;\n        x0 = xMax;\n      }\n    } else {\n      if (xMin !== void 0) {\n        if (x0 < x1 && x0 < xMin) {\n          x1 += xMin - x0;\n          x0 = xMin;\n        } else if (x1 < x0 && x1 < xMin) {\n          x0 += xMin - x1;\n          x1 = xMin;\n        }\n      }\n      if (xMax !== void 0) {\n        if (x0 < x1 && x1 > xMax) {\n          x0 -= x1 - xMax;\n          x1 = xMax;\n        } else if (x1 < x0 && x0 > xMax) {\n          x1 -= x0 - xMax;\n          x0 = xMax;\n        }\n      }\n    }\n\n    const y0 = this(x0);\n    const y1 = this(x1);\n    const dy = y0 < y1 ? y1 - y0 : y0 - y1;\n    const z = Math.abs(dy / (x1 - x0));\n    if (zMin !== void 0 && z < 1 / zMin) {\n      const dz = dy * zMin;\n      const xSum = x0 + x1;\n      x0 = (xSum - dz) / 2;\n      x1 = (xSum + dz) / 2;\n    } else if (zMax !== void 0 && z > 1 / zMax) {\n      const dz = dy * zMax;\n      const xSum = x0 + x1;\n      x0 = (xSum - dz) / 2;\n      x1 = (xSum + dz) / 2;\n    }\n\n    if (Math.abs(x0 - this.domain[0]) < epsilon && Math.abs(x1 - this.domain[1]) < epsilon) {\n      return this;\n    } else {\n      return LinearScale(LinearDomain(x0, x1), this.range);\n    }\n  };\n\n  LinearScale.prototype.solveDomain = function (x1: number, y1: number, x2?: number, y2?: number,\n                                                reflect?: boolean, epsilon?: number): LinearScale {\n    if (epsilon === void 0) {\n      epsilon = Equivalent.Epsilon;\n    }\n    const dx = this.domain[1] - this.domain[0];\n    const y0 = this.range[0];\n    const y3 = this.range[1];\n    let m: number;\n    if (x2 === void 0 || y2 === void 0 || Math.abs(x2 - x1) < epsilon || Math.abs(y2 - y1) < epsilon) {\n      m = (y3 - y0) / (dx !== 0 ? dx : epsilon);\n    } else {\n      m = (y2 - y1) / (x2 - x1);\n      if ((reflect === void 0 || !reflect) && (m < 0 !== (y3 - y0) / dx < 0)) {\n        m = -m;\n      }\n    }\n    const b = y1 - m * x1;\n    const x0 = (y0 - b) / m;\n    const x3 = (y3 - b) / m;\n\n    if (Math.abs(x0 - this.domain[0]) < epsilon && Math.abs(x3 - this.domain[1]) < epsilon) {\n      return this;\n    } else {\n      return LinearScale(LinearDomain(x0, x3), this.range);\n    }\n  };\n\n  LinearScale.prototype.interpolateTo = function (this: LinearScale, that: unknown): Interpolator<LinearScale> | null {\n    if (that instanceof LinearScale) {\n      return LinearScaleInterpolator(this, that);\n    }\n    return null;\n  } as typeof LinearScale.prototype.interpolateTo;\n\n  LinearScale.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof LinearScale;\n  };\n\n  LinearScale.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinearScale) {\n      return this.domain.equals(that.domain) && this.range.equals(that.range);\n    }\n    return false;\n  };\n\n  LinearScale.prototype.toString = function (): string {\n    return \"LinearScale(\" + this.domain + \", \" + this.range + \")\";\n  };\n\n  return LinearScale;\n})(ContinuousScale);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport {Interpolator} from \"../interpolate/Interpolator\";\nimport {LinearDomain} from \"./LinearDomain\";\nimport {LinearRange} from \"./LinearRange\";\nimport {LinearScale} from \"./LinearScale\";\n\n/** @internal */\nexport const LinearScaleInterpolator = (function (_super: typeof Interpolator) {\n  const LinearScaleInterpolator = function (s0: LinearScale, s1: LinearScale): Interpolator<LinearScale> {\n    const interpolator = function (u: number): LinearScale {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const x0 = s0.domain;\n      const x00 = x0[0];\n      const x01 = x0[1];\n      const x1 = s1.domain;\n      const x10 = x1[0];\n      const x11 = x1[1];\n      const domain = LinearDomain(x00 + u * (x10 - x00), x01 + u * (x11 - x01));\n      const y0 = s0.range;\n      const y00 = y0[0];\n      const y01 = y0[1];\n      const y1 = s1.range;\n      const y10 = y1[0];\n      const y11 = y1[1];\n      const range = LinearRange(y00 + u * (y10 - y00), y01 + u * (y11 - y01));\n      return LinearScale(domain, range);\n    } as Interpolator<LinearScale>;\n    Object.setPrototypeOf(interpolator, LinearScaleInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: LinearScale, s1: LinearScale): Interpolator<LinearScale>;\n\n    /** @internal */\n    prototype: Interpolator<LinearScale>;\n  };\n\n  LinearScaleInterpolator.prototype = Object.create(_super.prototype);\n  LinearScaleInterpolator.prototype.constructor = LinearScaleInterpolator;\n\n  return LinearScaleInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport type CreateType<C> =\n  C extends {create(...args: any[]): infer T} ? T : never;\n\n/** @public */\nexport interface Creatable<T> {\n  create(): T;\n}\n\n/** @public */\nexport const Creatable = (function () {\n  const Creatable = {} as {\n    is<T>(object: unknown): object is Creatable<T>;\n  };\n\n  Creatable.is = function <T>(object: unknown): object is Creatable<T> {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const creatable = object as Creatable<T>;\n      return \"create\" in creatable;\n    }\n    return false;\n  };\n\n  return Creatable;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport type InitType<I> =\n  I extends {init(init: infer T): any} ? T : never;\n\n/** @public */\nexport interface Initable<T> {\n  init(init: T): void;\n}\n\n/** @public */\nexport const Initable = (function () {\n  const Initable = {} as {\n    is<T>(object: unknown): object is Initable<T>;\n  };\n\n  Initable.is = function <T>(object: unknown): object is Initable<T> {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const init = object as Initable<T>;\n      return \"init\" in init;\n    }\n    return false;\n  };\n\n  return Initable;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"../types/Class\";\nimport type {Observer} from \"./Observer\";\n\n/** @public */\nexport type ObserverType<O> =\n  O extends {readonly observerType?: Class<infer T>} ? T : never;\n\n/** @public */\nexport interface Observable {\n  readonly observerType?: Class<Observer>;\n\n  observe(observer: ObserverType<this>): void;\n\n  unobserve(observer: ObserverType<this>): void;\n}\n\n/** @public */\nexport const Observable = (function () {\n  const Observable = {} as {\n    is(object: unknown): object is Observable;\n  };\n\n  Observable.is = function (object: unknown): object is Observable {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const observable = object as Observable;\n      return \"observe\" in observable;\n    }\n    return false;\n  };\n\n  return Observable;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"../types/Class\";\nimport type {Consumer} from \"./Consumer\";\n\n/** @public */\nexport type ConsumerType<O> =\n  O extends {readonly consumerType?: Class<infer T>} ? T : never;\n\n/** @public */\nexport interface Consumable {\n  readonly consumerType?: Class<Consumer>;\n\n  consume(consumer: ConsumerType<this>): void;\n\n  unconsume(consumer: ConsumerType<this>): void;\n}\n\n/** @public */\nexport const Consumable = (function () {\n  const Consumable = {} as {\n    is(object: unknown): object is Consumable;\n  };\n\n  Consumable.is = function (object: unknown): object is Consumable {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const consumable = object as Consumable;\n      return \"consume\" in consumable;\n    }\n    return false;\n  };\n\n  return Consumable;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"../types/Mutable\";\nimport type {Class} from \"../types/Class\";\nimport {Arrays} from \"../values/Arrays\";\nimport type {ObserverType, Observable} from \"../observable/Observable\";\nimport type {ServiceObserver} from \"./ServiceObserver\";\n\n/** @public */\nexport class Service<R> implements Observable {\n  constructor() {\n    this.roots = Arrays.empty;\n    this.observers = Arrays.empty;\n  }\n\n  /** @override */\n  readonly observerType?: Class<ServiceObserver<R>>;\n\n  /** @internal */\n  readonly roots: ReadonlyArray<R>;\n\n  /** @override */\n  attachRoot(root: R): void {\n    const oldRoots = this.roots;\n    const newRoots = Arrays.inserted(root, oldRoots);\n    if (oldRoots !== newRoots) {\n      const needsAttach = oldRoots.length === 0;\n      if (needsAttach) {\n        this.willAttach();\n      }\n      this.willAttachRoot(root);\n      (this as Mutable<this>).roots = newRoots;\n      if (needsAttach) {\n        this.onAttach();\n      }\n      this.onAttachRoot(root);\n      this.didAttachRoot(root);\n      if (needsAttach) {\n        this.didAttach();\n      }\n    }\n  }\n\n  protected willAttachRoot(root: R): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceWillAttachRoot !== void 0) {\n        observer.serviceWillAttachRoot(root, this);\n      }\n    }\n  }\n\n  protected onAttachRoot(root: R): void {\n    // hook\n  }\n\n  protected didAttachRoot(root: R): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceDidAttachRoot !== void 0) {\n        observer.serviceDidAttachRoot(root, this);\n      }\n    }\n  }\n\n  /** @override */\n  detachRoot(root: R): void {\n    const oldRoots = this.roots;\n    const newRoots = Arrays.removed(root, oldRoots);\n    if (oldRoots !== newRoots) {\n      const needsDetach = oldRoots.length === 1;\n      if (needsDetach) {\n        this.willDetach();\n      }\n      this.willDetachRoot(root);\n      (this as Mutable<this>).roots = newRoots;\n      if (needsDetach) {\n        this.onDetach();\n      }\n      this.onDetachRoot(root);\n      this.didDetachRoot(root);\n      if (needsDetach) {\n        this.didDetach();\n      }\n    }\n  }\n\n  protected willDetachRoot(root: R): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceWillDetachRoot !== void 0) {\n        observer.serviceWillDetachRoot(root, this);\n      }\n    }\n  }\n\n  protected onDetachRoot(root: R): void {\n    // hook\n  }\n\n  protected didDetachRoot(root: R): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceDidDetachRoot !== void 0) {\n        observer.serviceDidDetachRoot(root, this);\n      }\n    }\n  }\n\n  get attached(): boolean {\n    return this.roots.length !== 0;\n  }\n\n  protected willAttach(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceWillAttach !== void 0) {\n        observer.serviceWillAttach(this);\n      }\n    }\n  }\n\n  protected onAttach(): void {\n    // hook\n  }\n\n  protected didAttach(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceDidAttach !== void 0) {\n        observer.serviceDidAttach(this);\n      }\n    }\n  }\n\n  protected willDetach(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceWillDetach !== void 0) {\n        observer.serviceWillDetach(this);\n      }\n    }\n  }\n\n  protected onDetach(): void {\n    // hook\n  }\n\n  protected didDetach(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.serviceDidDetach !== void 0) {\n        observer.serviceDidDetach(this);\n      }\n    }\n  }\n\n  /** @internal */\n  readonly observers: ReadonlyArray<ObserverType<this>>;\n\n  /** @override */\n  observe(observer: ObserverType<this>): void {\n    const oldObservers = this.observers;\n    const newObservers = Arrays.inserted(observer, oldObservers);\n    if (oldObservers !== newObservers) {\n      this.willObserve(observer);\n      (this as Mutable<this>).observers = newObservers;\n      this.onObserve(observer);\n      this.didObserve(observer);\n    }\n  }\n\n  protected willObserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected onObserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected didObserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  /** @override */\n  unobserve(observer: ObserverType<this>): void {\n    const oldObservers = this.observers;\n    const newObservers = Arrays.removed(observer, oldObservers);\n    if (oldObservers !== newObservers) {\n      this.willUnobserve(observer);\n      (this as Mutable<this>).observers = newObservers;\n      this.onUnobserve(observer);\n      this.didUnobserve(observer);\n    }\n  }\n\n  protected willUnobserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected onUnobserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected didUnobserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected forEachObserver<T>(callback: (this: this, observer: ObserverType<this>) => T | void): T | undefined {\n    let result: T | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      result = callback.call(this, observer as ObserverType<this>) as T | undefined;\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return result;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"../runtime/Lazy\";\nimport type {Iterator} from \"./Iterator\";\nimport {CursorEmpty} from \"../\"; // forward import\nimport {CursorUnary} from \"../\"; // forward import\nimport {CursorArray} from \"../\"; // forward import\n\n/** @public */\nexport abstract class Cursor<T> implements Iterator<T> {\n  abstract isEmpty(): boolean;\n\n  abstract head(): T;\n\n  abstract step(): void;\n\n  abstract skip(count: number): void;\n\n  abstract hasNext(): boolean;\n\n  abstract nextIndex(): number;\n\n  abstract next(): {value?: T, done: boolean};\n\n  abstract hasPrevious(): boolean;\n\n  abstract previousIndex(): number;\n\n  abstract previous(): {value?: T, done: boolean};\n\n  set(newValue: T): void {\n    throw new Error(\"immutable\");\n  }\n\n  delete(): void {\n    throw new Error(\"immutable\");\n  }\n\n  @Lazy\n  static empty<T>(): Cursor<T> {\n    return new CursorEmpty();\n  }\n\n  static unary<T>(value: T): Cursor<T> {\n    return new CursorUnary<T>(value);\n  }\n\n  static array<T>(array: ReadonlyArray<T>, index?: number, limit?: number): Cursor<T> {\n    if (index === void 0) {\n      index = 0;\n    }\n    if (limit === void 0) {\n      limit = array.length;\n    }\n    return new CursorArray<T>(array, index, limit);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"./Cursor\";\n\n/** @internal */\nexport class CursorEmpty<T> extends Cursor<T> {\n  override isEmpty(): boolean {\n    return true;\n  }\n\n  override head(): T {\n    throw new Error(\"empty\");\n  }\n\n  override step(): void {\n    throw new Error(\"empty\");\n  }\n\n  override skip(count: number): void {\n    // nop\n  }\n\n  override hasNext(): boolean {\n    return false;\n  }\n\n  override nextIndex(): number {\n    return 0;\n  }\n\n  override next(): {value?: T, done: boolean} {\n    return {done: true};\n  }\n\n  override hasPrevious(): boolean {\n    return false;\n  }\n\n  override previousIndex(): number {\n    return -1;\n  }\n\n  override previous(): {value?: T, done: boolean} {\n    return {done: true};\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"./Cursor\";\n\n/** @internal */\nexport class CursorUnary<T> extends Cursor<T> {\n  constructor(value: T) {\n    super();\n    this.value = value;\n    this.index = 0;\n  }\n\n  /** @internal */\n  readonly value: T;\n\n  /** @internal */\n  index: number;\n\n  override isEmpty(): boolean {\n    return this.index !== 0;\n  }\n\n  override head(): T {\n    if (this.index === 0) {\n      return this.value;\n    } else {\n      throw new Error(\"empty\");\n    }\n  }\n\n  override step(): void {\n    if (this.index === 0) {\n      this.index = 1;\n    } else {\n      throw new Error(\"empty\");\n    }\n  }\n\n  override skip(count: number): void {\n    this.index = Math.min(Math.max(0, this.index + count), 1);\n  }\n\n  override hasNext(): boolean {\n    return this.index === 0;\n  }\n\n  override nextIndex(): number {\n    return this.index;\n  }\n\n  override next(): {value?: T, done: boolean} {\n    if (this.index === 0) {\n      this.index = 1;\n      return {value: this.value, done: true};\n    } else {\n      return {done: true};\n    }\n  }\n\n  override hasPrevious(): boolean {\n    return this.index === 1;\n  }\n\n  override previousIndex(): number {\n    return this.index - 1;\n  }\n\n  override previous(): {value?: T, done: boolean} {\n    if (this.index === 1) {\n      this.index = 0;\n      return {value: this.value, done: true};\n    } else {\n      return {done: true};\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"./Cursor\";\n\n/** @internal */\nexport class CursorArray<T> extends Cursor<T> {\n  constructor(array: ReadonlyArray<T>, index: number, limit: number) {\n    super();\n    this.array = array;\n    this.index = index;\n    this.limit = limit;\n  }\n\n  /** @internal */\n  readonly array: ReadonlyArray<T>;\n\n  /** @internal */\n  index: number;\n\n  /** @internal */\n  readonly limit: number;\n\n  override isEmpty(): boolean {\n    return this.index >= this.limit;\n  }\n\n  override head(): T {\n    if (this.index < this.limit) {\n      return this.array[this.index]!;\n    } else {\n      throw new Error(\"empty\");\n    }\n  }\n\n  override step(): void {\n    const index = this.index;\n    if (index < this.limit) {\n      this.index += 1;\n    } else {\n      throw new Error(\"empty\");\n    }\n  }\n\n  override skip(count: number): void {\n    this.index = Math.min(this.index + count, this.limit);\n  }\n\n  override hasNext(): boolean {\n    return this.index < this.limit;\n  }\n\n  override nextIndex(): number {\n    return this.index;\n  }\n\n  override next(): {value?: T, done: boolean} {\n    const index = this.index;\n    if (index < this.limit) {\n      this.index += 1;\n      return {value: this.array[index]!, done: this.index === this.limit};\n    } else {\n      this.index = this.limit;\n      return {done: true};\n    }\n  }\n\n  override hasPrevious(): boolean {\n    return this.index > 0;\n  }\n\n  override previousIndex(): number {\n    return this.index - 1;\n  }\n\n  override previous(): {value?: T, done: boolean} {\n    const index = this.index - 1;\n    if (index >= 0) {\n      this.index = index;\n      return {value: this.array[index]!, done: index === 0};\n    } else {\n      this.index = 0;\n      return {done: true};\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Values} from \"../values/Values\";\n\n/**\n * A hashed generational cache map discards the least recently used value\n * with the worst hit rate per hash bucket. HashGenCacheMap is an LRFU cache\n * with O(1) access time.\n *\n * Maintaining four \"generations\" of cached values per hash bucket, the cache\n * discards from the younger generations based on least recent usage, and\n * promotes younger generations to older generations based on most frequent\n * usage. Cache misses count as negative usage of the older generations,\n * biasing the cache against least recently used values with poor hit rates.\n *\n * @public\n */\nexport class HashGenCacheMap<K, V> {\n  /** @internal */\n  readonly buckets: Array<HashGenCacheMapBucket<K, V> | undefined>;\n  /** @internal */\n  gen4Hits: number;\n  /** @internal */\n  gen3Hits: number;\n  /** @internal */\n  gen2Hits: number;\n  /** @internal */\n  gen1Hits: number;\n  /** @internal */\n  misses: number;\n\n  constructor(size: number) {\n    this.buckets = new Array(size);\n    this.gen4Hits = 0;\n    this.gen3Hits = 0;\n    this.gen2Hits = 0;\n    this.gen1Hits = 0;\n    this.misses = 0;\n  }\n\n  get(key: K): V | undefined {\n    if (this.buckets.length === 0) {\n      return void 0;\n    }\n    const index = Math.abs(Values.hash(key)) % this.buckets.length;\n    const bucket = this.buckets[index];\n    if (bucket === void 0) {\n      return void 0;\n    }\n\n    const gen4Key = bucket.gen4Key;\n    if (gen4Key !== void 0 && Values.equal(key, gen4Key)) {\n      const gen4Val = bucket.gen4Val;\n      if (gen4Val !== void 0) {\n        this.gen4Hits += 1;\n        bucket.gen4Weight++;\n        return gen4Val;\n      } else {\n        bucket.gen4Key = void 0;\n      }\n    }\n\n    const gen3Key = bucket.gen3Key;\n    if (gen3Key !== void 0 && Values.equal(key, gen3Key)) {\n      const gen3Val = bucket.gen3Val;\n      if (gen3Val !== void 0) {\n        this.gen3Hits += 1;\n        if (bucket.gen3Weight++ > bucket.gen4Weight) {\n          this.buckets[index] = new HashGenCacheMapBucket(\n              bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n              bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n              bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n              bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight);\n        }\n        return gen3Val;\n      } else {\n        bucket.gen3Key = void 0;\n      }\n    }\n\n    const gen2Key = bucket.gen2Key;\n    if (gen2Key !== void 0 && Values.equal(key, gen2Key)) {\n      const gen2Val = bucket.gen2Val;\n      if (gen2Val !== void 0) {\n        this.gen2Hits += 1;\n        if (bucket.gen2Weight++ > bucket.gen3Weight) {\n          this.buckets[index] = new HashGenCacheMapBucket(\n              bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n              bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n              bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n              bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight);\n        }\n        return gen2Val;\n      } else {\n        bucket.gen2Key = void 0;\n      }\n    }\n\n    const gen1Key = bucket.gen1Key;\n    if (gen1Key !== void 0 && Values.equal(key, gen1Key)) {\n      const gen1Val = bucket.gen1Val;\n      if (gen1Val !== void 0) {\n        this.gen1Hits += 1;\n        if (bucket.gen1Weight++ > bucket.gen2Weight) {\n          this.buckets[index] = new HashGenCacheMapBucket(\n              bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n              bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n              bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n              bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight);\n        }\n        return gen1Val;\n      } else {\n        bucket.gen1Key = void 0;\n      }\n    }\n\n    this.misses += 1;\n    return void 0;\n  }\n\n  put(key: K, value: V): V {\n    if (this.buckets.length === 0) {\n      return value;\n    }\n    const index = Math.abs(Values.hash(key)) % this.buckets.length;\n    const bucket = this.buckets[index] || new HashGenCacheMapBucket();\n\n    let gen4Key = bucket.gen4Key;\n    if (gen4Key !== void 0 && Values.equal(key, gen4Key)) {\n      const gen4Val = bucket.gen4Val;\n      if (gen4Val !== void 0) {\n        this.gen4Hits += 1;\n        bucket.gen4Weight++;\n        return gen4Val;\n      } else {\n        bucket.gen4Key = void 0;\n        gen4Key = void 0;\n      }\n    }\n\n    let gen3Key = bucket.gen3Key;\n    if (gen3Key !== void 0 && Values.equal(key, gen3Key)) {\n      const gen3Val = bucket.gen3Val;\n      if (gen3Val !== void 0) {\n        this.gen3Hits += 1;\n        if (bucket.gen3Weight++ > bucket.gen4Weight) {\n          this.buckets[index] = new HashGenCacheMapBucket(\n              bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n              bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n              bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n              bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight);\n        }\n        return gen3Val;\n      } else {\n        bucket.gen3Key = void 0;\n        gen3Key = void 0;\n      }\n    }\n\n    let gen2Key = bucket.gen2Key;\n    if (gen2Key !== void 0 && Values.equal(key, gen2Key)) {\n      const gen2Val = bucket.gen2Val;\n      if (gen2Val !== void 0) {\n        this.gen2Hits += 1;\n        if (bucket.gen2Weight++ > bucket.gen3Weight) {\n          this.buckets[index] = new HashGenCacheMapBucket(\n              bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n              bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n              bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n              bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight);\n        }\n        return gen2Val;\n      } else {\n        bucket.gen2Key = void 0;\n        gen2Key = void 0;\n      }\n    }\n\n    let gen1Key = bucket.gen1Key;\n    if (gen1Key !== void 0 && Values.equal(key, gen1Key)) {\n      const gen1Val = bucket.gen1Val;\n      if (gen1Val !== void 0) {\n        this.gen1Hits += 1;\n        if (bucket.gen1Weight++ > bucket.gen2Weight) {\n          this.buckets[index] = new HashGenCacheMapBucket(\n              bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n              bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n              bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n              bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight);\n        }\n        return gen1Val;\n      } else {\n        bucket.gen1Key = void 0;\n        gen1Key = void 0;\n      }\n    }\n\n    this.misses += 1;\n    if (gen4Key === void 0) {\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          key, value, 1);\n    } else if (gen3Key === void 0) {\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          key, value, 1);\n    } else if (gen2Key === void 0) {\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          key, value, 1);\n    } else if (gen1Key === void 0) {\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n          key, value, 1);\n    } else {\n      // Penalize older gens for thrash. Promote gen1 to prevent nacent gens\n      // from flip-flopping. If sacrificed gen2 was worth keeping, it likely\n      // would have already been promoted.\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight - 1,\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight - 1,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          key, value, 1);\n    }\n\n    return value;\n  }\n\n  remove(key: K): V | undefined {\n    if (this.buckets.length === 0) {\n      return void 0;\n    }\n    const index = Math.abs(Values.hash(key)) % this.buckets.length;\n    const bucket = this.buckets[index];\n    if (bucket === void 0) {\n      return void 0;\n    }\n\n    const gen4Key = bucket.gen4Key;\n    if (gen4Key !== void 0 && Values.equal(key, gen4Key)) {\n      const gen4Val = bucket.gen4Val;\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          void 0, void 0, 0);\n      return gen4Val;\n    }\n\n    const gen3Key = bucket.gen3Key;\n    if (gen3Key !== void 0 && Values.equal(key, gen3Key)) {\n      const gen3Val = bucket.gen3Val;\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          void 0, void 0, 0);\n      return gen3Val;\n    }\n\n    const gen2Key = bucket.gen2Key;\n    if (gen2Key !== void 0 && Values.equal(key, gen2Key)) {\n      const gen2Val = bucket.gen2Val;\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen1Key, bucket.gen1Val, bucket.gen1Weight,\n          void 0, void 0, 0);\n      return gen2Val;\n    }\n\n    const gen1Key = bucket.gen1Key;\n    if (gen1Key !== void 0 && Values.equal(key, gen1Key)) {\n      const gen1Val = bucket.gen1Val;\n      this.buckets[index] = new HashGenCacheMapBucket(\n          bucket.gen4Key, bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Key, bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Key, bucket.gen2Val, bucket.gen2Weight,\n          void 0, void 0, 0);\n      return gen1Val;\n    }\n\n    return void 0;\n  }\n\n  clear(): void {\n    for (let i = 0; i < this.buckets.length; i += 1) {\n      this.buckets[i] = void 0;\n    }\n  }\n\n  /** @internal */\n  hits(): number {\n    return this.gen4Hits + this.gen3Hits + this.gen2Hits + this.gen1Hits;\n  }\n\n  hitRatio(): number {\n    const hits = this.hits();\n    return hits / (hits + this.misses);\n  }\n}\n\n/** @internal */\nexport class HashGenCacheMapBucket<K, V> {\n  /** @internal */\n  gen4Key: K | undefined;\n  /** @internal */\n  gen4Val: V | undefined;\n  /** @internal */\n  gen4Weight: number;\n  /** @internal */\n  gen3Key: K | undefined;\n  /** @internal */\n  gen3Val: V | undefined;\n  /** @internal */\n  gen3Weight: number;\n  /** @internal */\n  gen2Key: K | undefined;\n  /** @internal */\n  gen2Val: V | undefined;\n  /** @internal */\n  gen2Weight: number;\n  /** @internal */\n  gen1Key: K | undefined;\n  /** @internal */\n  gen1Val: V | undefined;\n  /** @internal */\n  gen1Weight: number;\n\n  constructor(gen4Key?: K, gen4Val?: V, gen4Weight: number = 0,\n              gen3Key?: K, gen3Val?: V, gen3Weight: number = 0,\n              gen2Key?: K, gen2Val?: V, gen2Weight: number = 0,\n              gen1Key?: K, gen1Val?: V, gen1Weight: number = 0) {\n    this.gen4Key = gen4Key;\n    this.gen4Val = gen4Val;\n    this.gen4Weight = gen4Weight;\n    this.gen3Key = gen3Key;\n    this.gen3Val = gen3Val;\n    this.gen3Weight = gen3Weight;\n    this.gen2Key = gen2Key;\n    this.gen2Val = gen2Val;\n    this.gen2Weight = gen2Weight;\n    this.gen1Key = gen1Key;\n    this.gen1Val = gen1Val;\n    this.gen1Weight = gen1Weight;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Values} from \"../values/Values\";\n\n/**\n * A hashed generational cache set discards the least recently used value\n * with the worst hit rate per hash bucket. HashGenCacheSet is a LRFU cache\n * with O(1) access time.\n *\n * Maintaining four \"generations\" of cached values per hash bucket, the cache\n * discards from the younger generations based on least recent usage, and\n * promotes younger generations to older generations based on most frequent\n * usage. Cache misses count as negative usage of the older generations,\n * biasing the cache against least recently used values with poor hit rates.\n *\n * The cache soft references the older generations, and weak references the\n * younger generations; the garbage collector can reclaim the entire cache,\n * but will preferentially wipe the younger cache generations before the older\n * cache generations.\n *\n * @public\n */\nexport class HashGenCacheSet<T> {\n  /** @internal */\n  readonly buckets: Array<HashGenCacheSetBucket<T> | undefined>;\n  /** @internal */\n  gen4Hits: number;\n  /** @internal */\n  gen3Hits: number;\n  /** @internal */\n  gen2Hits: number;\n  /** @internal */\n  gen1Hits: number;\n  /** @internal */\n  misses: number;\n\n  constructor(size: number) {\n    this.buckets = new Array(size);\n    this.gen4Hits = 0;\n    this.gen3Hits = 0;\n    this.gen2Hits = 0;\n    this.gen1Hits = 0;\n    this.misses = 0;\n  }\n\n  put(value: T): T {\n    if (this.buckets.length === 0) {\n      return value;\n    }\n    const index = Math.abs(Values.hash(value)) % this.buckets.length;\n    const bucket = this.buckets[index] || new HashGenCacheSetBucket<T>();\n\n    const gen4Val = bucket.gen4Val;\n    if (gen4Val !== void 0 && Values.equal(value, gen4Val)) {\n      this.gen4Hits += 1;\n      bucket.gen4Weight++;\n      return gen4Val;\n    }\n\n    const gen3Val = bucket.gen3Val;\n    if (gen3Val !== void 0 && Values.equal(value, gen3Val)) {\n      this.gen3Hits += 1;\n      if (bucket.gen3Weight++ > bucket.gen4Weight) {\n        this.buckets[index] = new HashGenCacheSetBucket<T>(\n            bucket.gen3Val, bucket.gen3Weight,\n            bucket.gen4Val, bucket.gen4Weight,\n            bucket.gen2Val, bucket.gen2Weight,\n            bucket.gen1Val, bucket.gen1Weight);\n      }\n      return gen3Val;\n    }\n\n    const gen2Val = bucket.gen2Val;\n    if (gen2Val !== void 0 && Values.equal(value, gen2Val)) {\n      this.gen2Hits += 1;\n      if (bucket.gen2Weight++ > bucket.gen3Weight) {\n        this.buckets[index] = new HashGenCacheSetBucket<T>(\n            bucket.gen4Val, bucket.gen4Weight,\n            bucket.gen2Val, bucket.gen2Weight,\n            bucket.gen3Val, bucket.gen3Weight,\n            bucket.gen1Val, bucket.gen1Weight);\n      }\n      return gen2Val;\n    }\n\n    const gen1Val = bucket.gen1Val;\n    if (gen1Val !== void 0 && Values.equal(value, gen1Val)) {\n      this.gen1Hits += 1;\n      if (bucket.gen1Weight++ > bucket.gen2Weight) {\n        this.buckets[index] = new HashGenCacheSetBucket<T>(\n            bucket.gen4Val, bucket.gen4Weight,\n            bucket.gen3Val, bucket.gen3Weight,\n            bucket.gen1Val, bucket.gen1Weight,\n            bucket.gen2Val, bucket.gen2Weight);\n      }\n      return gen1Val;\n    }\n\n    this.misses += 1;\n    if (gen4Val === void 0) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Val, bucket.gen1Weight,\n          value, 1);\n    } else if (gen3Val === void 0) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Val, bucket.gen1Weight,\n          value, 1);\n    } else if (gen2Val === void 0) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen1Val, bucket.gen1Weight,\n          value, 1);\n    } else if (gen1Val === void 0) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Val, bucket.gen2Weight,\n          value, 1);\n    } else {\n      // Penalize older gens for thrash. Promote gen1 to prevent nacent gens\n      // from flip-flopping. If sacrificed gen2 was worth keeping, it likely\n      // would have already been promoted.\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight - 1,\n          bucket.gen3Val, bucket.gen3Weight - 1,\n          bucket.gen1Val, bucket.gen1Weight,\n          value, 1);\n    }\n\n    return value;\n  }\n\n  remove(value: T): boolean {\n    if (this.buckets.length === 0) {\n      return false;\n    }\n    const index = Math.abs(Values.hash(value)) % this.buckets.length;\n    const bucket = this.buckets[index];\n    if (bucket === void 0) {\n      return false;\n    }\n\n    const gen4Val = bucket.gen4Val;\n    if (gen4Val !== void 0 && Values.equal(value, gen4Val)) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Val, bucket.gen1Weight,\n          void 0, 0);\n      return true;\n    }\n\n    const gen3Val = bucket.gen3Val;\n    if (gen3Val !== void 0 && Values.equal(value, gen3Val)) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen2Val, bucket.gen2Weight,\n          bucket.gen1Val, bucket.gen1Weight,\n          void 0, 0);\n      return true;\n    }\n\n    const gen2Val = bucket.gen2Val;\n    if (gen2Val !== void 0 && Values.equal(value, gen2Val)) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen1Val, bucket.gen1Weight,\n          void 0, 0);\n      return true;\n    }\n\n    const gen1Val = bucket.gen1Val;\n    if (gen1Val !== void 0 && Values.equal(value, gen1Val)) {\n      this.buckets[index] = new HashGenCacheSetBucket<T>(\n          bucket.gen4Val, bucket.gen4Weight,\n          bucket.gen3Val, bucket.gen3Weight,\n          bucket.gen2Val, bucket.gen2Weight,\n          void 0, 0);\n      return true;\n    }\n\n    return false;\n  }\n\n  clear(): void {\n    for (let i = 0; i < this.buckets.length; i += 1) {\n      this.buckets[i] = void 0;\n    }\n  }\n\n  /** @internal */\n  get hits(): number {\n    return this.gen4Hits + this.gen3Hits + this.gen2Hits + this.gen1Hits;\n  }\n\n  get hitRatio(): number {\n    const hits = this.hits;\n    return hits / (hits + this.misses);\n  }\n}\n\n/** @internal */\nexport class HashGenCacheSetBucket<T> {\n  /** @internal */\n  gen4Val: T | undefined;\n  /** @internal */\n  gen4Weight: number;\n  /** @internal */\n  gen3Val: T | undefined;\n  /** @internal */\n  gen3Weight: number;\n  /** @internal */\n  gen2Val: T | undefined;\n  /** @internal */\n  gen2Weight: number;\n  /** @internal */\n  gen1Val: T | undefined;\n  /** @internal */\n  gen1Weight: number;\n\n  constructor(gen4Val?: T, gen4Weight: number = 0,\n              gen3Val?: T, gen3Weight: number = 0,\n              gen2Val?: T, gen2Weight: number = 0,\n              gen1Val?: T, gen1Weight: number = 0) {\n    this.gen4Val = gen4Val;\n    this.gen4Weight = gen4Weight;\n    this.gen3Val = gen3Val;\n    this.gen3Weight = gen3Weight;\n    this.gen2Val = gen2Val;\n    this.gen2Weight = gen2Weight;\n    this.gen1Val = gen1Val;\n    this.gen1Weight = gen1Weight;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Exception thrown when an [[Assert]] fails.\n * @public\n */\nexport class AssertException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, AssertException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Values} from \"../values/Values\";\nimport {AssertException} from \"./AssertException\";\n\n/**\n * Callable assertion function.\n *\n * @throws [[AssertException]] if the assertion fails.\n * @public\n */\nexport interface AssertFunction {\n  (condition: unknown, message?: string): void;\n}\n\n/**\n * Type that implements common assertion functions.\n * @public\n */\nexport interface Assert {\n  /**\n   * Asserts that `condition` is truthy.\n   *\n   * @throws [[AssertException]] with `message` if `condition` is falsy.\n   */\n  ok(condition: unknown, message?: string): void;\n\n  /**\n   * Asserts that `condition` is falsy.\n   *\n   * @throws [[AssertException]] with `message` if `condition` is truthy.\n   */\n  notOk(condition: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` is identical (`===`) to `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` is not identical (`!==`) to `rhs`.\n   */\n  identical(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` is not identical (`!==`) to `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` is identical (`===`) to `rhs`.\n   */\n  notIdentical(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `object` has the prototype of `constructor` in its prototype chain.\n   *\n   * @throws [[AssertException]] with `message` if `object` does not have the prototype of `constructor` in its prototype chain.\n   */\n  instanceOf(object: unknown, constructor: Function, message?: string): void;\n\n  /**\n   * Asserts that `object` does not have the prototype of `constructor` in its prototype chain.\n   *\n   * @throws [[AssertException]] with `message` if `object` does have the prototype of `constructor` in its prototype chain.\n   */\n  notInstanceOf(object: unknown, constructor: Function, message?: string): void;\n\n  /**\n   * Asserts that `lhs` is [[Values.equal structurally equal]] to `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` is not structurally equal to `rhs`.\n   */\n  equal(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` is not [[Values.equal structurally equal]] to `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` is structurally equal to `rhs`.\n   */\n  notEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` is [[Values.equivalent structurally equivalent]] to `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` is not structurally equivalent to `rhs`.\n   */\n  equivalent(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` is not [[Values.equivalent structurally equivalent]] to `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` is structurally equivalent to `rhs`.\n   */\n  notEquivalent(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` [[Values.compare structurally orders before]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does not structurally order before `rhs`.\n   */\n  compareLessThan(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` does not [[Values.compare structurally order before]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does structurally order before `rhs`.\n   */\n  compareNotLessThan(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` [[Values.compare structurally orders before or the same as]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does not structurally order before or the same as `rhs`.\n   */\n  compareLessThanOrEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` does not [[Values.compare structurally order before or the same as]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does structurally order before or the same as `rhs`.\n   */\n  compareNotLessThanOrEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` [[Values.compare structurally orders the same as]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does not structurally order before or the same as `rhs`.\n   */\n  compareEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` does not [[Values.compare structurally order the same as]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does structurally order before or the same as `rhs`.\n   */\n  compareNotEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` [[Values.compare structurally orders after or the same as]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does not structurally order after or the same as `rhs`.\n   */\n  compareGreaterThanOrEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` does not [[Values.compare structurally order after or the same as]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does structurally order after or the same as `rhs`.\n   */\n  compareNotGreaterThanOrEqual(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` [[Values.compare structurally orders after]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does not structurally order after `rhs`.\n   */\n  compareGreaterThan(lhs: unknown, rhs: unknown, message?: string): void;\n\n  /**\n   * Asserts that `lhs` does not [[Values.compare structurally order after]] `rhs`.\n   *\n   * @throws [[AssertException]] with `message` if `lhs` does structurally order after `rhs`.\n   */\n  compareNotGreaterThan(lhs: unknown, rhs: unknown, message?: string): void;\n}\n\n/**\n * General `Assert` implementation. When called as a function, asserts that\n * `condition` is truthy.\n *\n * @throws [[AssertException]] with `message` if `condition` is falsy.\n * @public\n */\nexport const assert = (function () {\n  const assert = function (condition: unknown, message?: string): void {\n    if (!condition) {\n      throw new AssertException(message);\n    }\n  } as Assert & AssertFunction;\n\n  assert.ok = function (condition: unknown, message?: string): void {\n    if (!condition) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.notOk = function (condition: unknown, message?: string): void {\n    if (condition) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.equal = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (!Values.equal(lhs, rhs)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.notEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (Values.equal(lhs, rhs)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.identical = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (lhs !== rhs) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.notIdentical = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (lhs === rhs) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.instanceOf = function (object: unknown, constructor: Function, message?: string): void {\n    if (!(object instanceof constructor)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.notInstanceOf = function (object: unknown, constructor: Function, message?: string): void {\n    if (object instanceof constructor) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareLessThan = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (!(Values.compare(lhs, rhs) < 0)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareNotLessThan = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (Values.compare(lhs, rhs) < 0) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareLessThanOrEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (!(Values.compare(lhs, rhs) <= 0)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareNotLessThanOrEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (Values.compare(lhs, rhs) <= 0) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (!(Values.compare(lhs, rhs) === 0)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareNotEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (Values.compare(lhs, rhs) === 0) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareGreaterThanOrEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (!(Values.compare(lhs, rhs) >= 0)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareNotGreaterThanOrEqual = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (Values.compare(lhs, rhs) >= 0) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareGreaterThan = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (!(Values.compare(lhs, rhs) > 0)) {\n      throw new AssertException(message);\n    }\n  };\n\n  assert.compareNotGreaterThan = function (lhs: unknown, rhs: unknown, message?: string): void {\n    if (Values.compare(lhs, rhs) > 0) {\n      throw new AssertException(message);\n    }\n  };\n\n  return assert;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3} from \"../runtime/Murmur3\";\nimport type {HashCode} from \"../compare/HashCode\";\nimport type {Compare} from \"../compare/Compare\";\nimport {Numbers} from \"../values/Numbers\";\nimport {Strings} from \"../values/Strings\";\nimport {Constructors} from \"../values/Constructors\";\n\n/**\n * Level of importance. Used for log levels and diagnostic classifications.\n * @public\n */\nexport class Severity implements HashCode, Compare {\n  private constructor(level: number, label: string) {\n    this.level = level;\n    this.label = label;\n  }\n\n  /**\n   * The integer level of importance of this `Severity`, with higher  levels\n   * signifying greater importance. An integer between `0` and `7`, inclusive.\n   * One of `TRACE_LEVEL`, `DEBUG_LEVEL`, `INFO_LEVEL`, `NOTE_LEVEL`,\n   * `WARNING_LEVEL`, `ERROR_LEVEL`, `ALERT_LEVEL`, `FATAL_LEVEL`.\n   */\n  readonly level: number;\n\n  /**\n   * A descriptive label for this `Severity`.\n   */\n  readonly label: string;\n\n  /**\n   * Returns `true` if this `Severity` has `TRACE_LEVEL` of importance.\n   */\n  isTrace(): boolean {\n    return this.level === Severity.TRACE_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `DEBUG_LEVEL` of importance.\n   */\n  isDebug(): boolean {\n    return this.level === Severity.DEBUG_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `INFO_LEVEL` of importance.\n   */\n  isInfo(): boolean {\n    return this.level === Severity.INFO_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `NOTE_LEVEL` of importance.\n   */\n  isNote(): boolean {\n    return this.level === Severity.NOTE_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `WARNING_LEVEL` of importance.\n   */\n  isWarning(): boolean {\n    return this.level === Severity.WARNING_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `ERROR_LEVEL` of importance.\n   */\n  isError(): boolean {\n    return this.level === Severity.ERROR_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `ALERT_LEVEL` of importance.\n   */\n  isAlert(): boolean {\n    return this.level === Severity.ALERT_LEVEL;\n  }\n\n  /**\n   * Returns `true` if this `Severity` has `FATAL_LEVEL` of importance.\n   */\n  isFatal(): boolean {\n    return this.level === Severity.FATAL_LEVEL;\n  }\n\n  compareTo(that: unknown): number {\n    if (this === that) {\n      return 0;\n    } else if (that instanceof Severity) {\n      if (this.level < that.level) {\n        return -1;\n      } else if (this.level > that.level) {\n        return 1;\n      } else {\n        return this.label.localeCompare(that.label);\n      }\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Severity) {\n      return this.level === that.level && this.label === that.label;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Severity),\n        Numbers.hash(this.level)), Strings.hash(this.label)));\n  }\n\n  toString(): string {\n    return this.label;\n  }\n\n  static readonly TRACE_LEVEL: number = 0;\n  static readonly DEBUG_LEVEL: number = 1;\n  static readonly INFO_LEVEL: number = 2;\n  static readonly NOTE_LEVEL: number = 3;\n  static readonly WARNING_LEVEL: number = 4;\n  static readonly ERROR_LEVEL: number = 5;\n  static readonly ALERT_LEVEL: number = 6;\n  static readonly FATAL_LEVEL: number = 7;\n\n  private static _trace?: Severity;\n  private static _debug?: Severity;\n  private static _info?: Severity;\n  private static _note?: Severity;\n  private static _warning?: Severity;\n  private static _error?: Severity;\n  private static _alert?: Severity;\n  private static _fatal?: Severity;\n\n  /**\n   * Returns a `Severity` with the given importance `level`, and optional\n   * descriptive `label`.\n   *\n   * @throws `Error` if `level` is not a valid level of importance.\n   */\n  static create(level: number, label?: string): Severity {\n    switch (level) {\n      case Severity.TRACE_LEVEL: return Severity.trace(label);\n      case Severity.DEBUG_LEVEL: return Severity.debug(label);\n      case Severity.INFO_LEVEL: return Severity.info(label);\n      case Severity.NOTE_LEVEL: return Severity.note(label);\n      case Severity.WARNING_LEVEL: return Severity.warning(label);\n      case Severity.ERROR_LEVEL: return Severity.error(label);\n      case Severity.ALERT_LEVEL: return Severity.alert(label);\n      case Severity.FATAL_LEVEL: return Severity.fatal(label);\n      default: throw new Error(\"\" + level);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `TRACE_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static trace(label: string = \"trace\"): Severity {\n    if (label === \"trace\") {\n      if (Severity._trace === void 0) {\n        Severity._trace = new Severity(Severity.TRACE_LEVEL, label);\n      }\n      return Severity._trace;\n    } else {\n      return new Severity(Severity.TRACE_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `DEBUG_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static debug(label: string = \"debug\"): Severity {\n    if (label === \"debug\") {\n      if (Severity._debug === void 0) {\n        Severity._debug = new Severity(Severity.DEBUG_LEVEL, label);\n      }\n      return Severity._debug;\n    } else {\n      return new Severity(Severity.DEBUG_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `INFO_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static info(label: string = \"info\"): Severity {\n    if (label === \"info\") {\n      if (Severity._info === void 0) {\n        Severity._info = new Severity(Severity.INFO_LEVEL, label);\n      }\n      return Severity._info;\n    } else {\n      return new Severity(Severity.INFO_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `NOTE_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static note(label: string = \"note\"): Severity {\n    if (label === \"note\") {\n      if (Severity._note === void 0) {\n        Severity._note = new Severity(Severity.NOTE_LEVEL, label);\n      }\n      return Severity._note;\n    } else {\n      return new Severity(Severity.NOTE_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `WARNING_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static warning(label: string = \"warning\"): Severity {\n    if (label === \"warning\") {\n      if (Severity._warning === void 0) {\n        Severity._warning = new Severity(Severity.WARNING_LEVEL, label);\n      }\n      return Severity._warning;\n    } else {\n      return new Severity(Severity.WARNING_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `ERROR_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static error(label: string = \"error\"): Severity {\n    if (label === \"error\") {\n      if (Severity._error === void 0) {\n        Severity._error = new Severity(Severity.ERROR_LEVEL, label);\n      }\n      return Severity._error;\n    } else {\n      return new Severity(Severity.ERROR_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `ALERT_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static alert(label: string = \"alert\"): Severity {\n    if (label === \"alert\") {\n      if (Severity._alert === void 0) {\n        Severity._alert = new Severity(Severity.ALERT_LEVEL, label);\n      }\n      return Severity._alert;\n    } else {\n      return new Severity(Severity.ALERT_LEVEL, label);\n    }\n  }\n\n  /**\n   * Returns a `Severity` with `FATAL_LEVEL` of importance, and an optional\n   * descriptive `label`.\n   */\n  static fatal(label: string = \"fatal\"): Severity {\n    if (label === \"fatal\") {\n      if (Severity._fatal === void 0) {\n        Severity._fatal = new Severity(Severity.FATAL_LEVEL, label);\n      }\n      return Severity._fatal;\n    } else {\n      return new Severity(Severity.FATAL_LEVEL, label);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {HashCode} from \"@swim/util\";\nimport type {Mark} from \"./Mark\";\nimport type {Output} from \"../output/Output\";\nimport type {Display} from \"../format/Display\";\nimport type {Debug} from \"../format/Debug\";\n\n/**\n * Description of a source location. Tags are used to annotate input sources,\n * particularly for [[Diagnostic diagnostic]] purposes. A [[Mark]] tag\n * annotates a source position. A [[Span]] tag annotate a source range.\n *\n * @see [[Diagnostic]]\n * @public\n */\nexport abstract class Tag implements HashCode, Display, Debug {\n  /**\n   * The first source position covered by this `Tag`.\n   */\n  abstract readonly start: Mark;\n\n  /**\n   * The last source position covered by this `Tag`.\n   */\n  abstract readonly end: Mark;\n\n  /**\n   * Returns a `Tag` that includes all source locations covered by\n   * both this tag, and `that` tag.\n   */\n  abstract union(that: Tag): Tag;\n\n  /**\n   * Returns the position of this `Tag` relative to the given `mark`.\n   */\n  abstract shift(mark: Mark): Tag;\n\n  abstract display<T>(output: Output<T>): Output<T>;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Strings, Constructors} from \"@swim/util\";\nimport {Tag} from \"./Tag\";\nimport {Span} from \"../\"; // forward import\nimport type {Output} from \"../output/Output\";\nimport {Format} from \"../\"; // forward import\n\n/**\n * Description of a source position, identified by byte offset, line, and\n * column number, with an optional note.\n * @public\n */\nexport class Mark extends Tag {\n  /** @internal */\n  constructor(offset: number, line: number, column: number, note: string | undefined) {\n    super();\n    this.offset = offset;\n    this.line = line;\n    this.column = column;\n    this.note = note;\n  }\n\n  /**\n   * The zero-based byte offset of this position.\n   */\n  readonly offset: number;\n\n  /**\n   * The one-based line number of this position.\n   */\n  readonly line: number;\n\n  /**\n   * The one-based column number of this position.\n   */\n  readonly column: number;\n\n  /**\n   * The note attached to the marked position, or `null` if this position has\n   * no attached note.\n   */\n  readonly note: string | undefined;\n\n  withNote(note: string | undefined): Mark {\n    if (this.note !== note) {\n      return Mark.at(this.offset, this.line, this.column, note);\n    } else {\n      return this;\n    }\n  }\n\n  /**\n   * Returns this position, if its byte offset is less than or equal to\n   * `that` position; otherwise returns `that` position.\n   */\n  min(that: Mark): Mark {\n    return this.offset <= that.offset ? this : that;\n  }\n\n  /**\n   * Returns this position, if its byte offset is greater than or equal to\n   * `that` position; otherwise returns `that` position.\n   */\n  max(that: Mark): Mark {\n    return this.offset >= that.offset ? this : that;\n  }\n\n  override get start(): Mark {\n    return this;\n  }\n\n  override get end(): Mark {\n    return this;\n  }\n\n  override union(that: Tag): Tag {\n    if (that instanceof Mark) {\n      if (this.offset === that.offset && this.line === that.line\n          && this.column === that.column) {\n        return this;\n      } else {\n        return Span.from(this, that);\n      }\n    } else if (that instanceof Span) {\n      const start = this.min(that.start);\n      const end = this.max(that.end);\n      if (start === that.start && end === that.end) {\n        return that;\n      } else {\n        return Span.from(start, end);\n      }\n    }\n    throw new Error(that.toString());\n  }\n\n  override shift(mark: Mark): Mark {\n    const offset = this.offset + (this.offset - mark.offset);\n    const line = this.line + (this.line - mark.line);\n    let column = this.column;\n    if (line === 1) {\n      column += (this.column - mark.column);\n    }\n    if (offset === this.offset && line === this.line && column === this.column) {\n      return this;\n    } else {\n      return Mark.at(offset, line, column, this.note);\n    }\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Mark) {\n      return this.offset === that.offset && this.line === that.line\n          && this.column === that.column && this.note === that.note;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(Constructors.hash(Mark),\n        Numbers.hash(this.offset)), Numbers.hash(this.line)), Numbers.hash(this.column)),\n        Strings.hash(this.note)));\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = Format.displayNumber(output, this.line);\n    output = output.write(58/*':'*/);\n    output = Format.displayNumber(output, this.column);\n    if (this.note !== void 0) {\n      output = output.write(58/*':'*/).write(32/*' '*/).write(this.note);\n    }\n    return output;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Mark\").write(\".\").write(\"at\").write(\"(\");\n    output = Format.debugNumber(output, this.offset);\n    output = output.write(\", \");\n    output = Format.debugNumber(output, this.line);\n    output = output.write(\", \");\n    output = Format.debugNumber(output, this.column);\n    if (this.note !== void 0) {\n      output = output.write(\", \");\n      output = Format.debugString(output, this.note);\n    }\n    output = output.write(\")\");\n    return output;\n  }\n\n  override toString(): string {\n    return Format.display(this);\n  }\n\n  /**\n   * Returns a `Mark` at byte offset `0`, line `1`, and column `1`, with no\n   * attached note.\n   */\n  @Lazy\n  static get zero(): Mark {\n    return new Mark(0, 1, 1, void 0);\n  }\n\n  /**\n   * Returns a new `Mark` at the given zero-based byte `offset`, one-based\n   * `line` number, and one-based `column` number, with an optionally attached\n   * `note`.\n   */\n  static at(offset: number, line: number, column: number, note?: string | undefined): Mark {\n    return new Mark(offset, line, column, note);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Constructors} from \"@swim/util\";\nimport {Tag} from \"./Tag\";\nimport {Mark} from \"./Mark\";\nimport type {Output} from \"../output/Output\";\nimport {Format} from \"../\"; // forward import\n\n/**\n * Description of a source range, identified by a closed interval between start\n * and end [[Mark marks]].\n * @public\n */\nexport class Span extends Tag {\n  /** @internal */\n  constructor(start: Mark, end: Mark) {\n    super();\n    this.start = start;\n    this.end = end;\n  }\n\n  override readonly start: Mark;\n\n  override readonly end: Mark;\n\n  override union(that: Tag): Tag {\n    if (that instanceof Mark) {\n      const start = this.start.min(that);\n      const end = this.end.max(that);\n      if (start === this.start && end === this.end) {\n        return this;\n      } else {\n        return Span.from(start, end);\n      }\n    } else if (that instanceof Span) {\n      const start = this.start.min(that.start);\n      const end = this.end.max(that.end);\n      if (start === this.start && end === this.end) {\n        return this;\n      } else {\n        return Span.from(start, end);\n      }\n    }\n    throw new Error(that.toString());\n  }\n\n  override shift(mark: Mark): Span {\n    const start = this.start.shift(mark);\n    const end = this.end.shift(mark);\n    if (start === this.start && end === this.end) {\n      return this;\n    } else {\n      return Span.from(start, end);\n    }\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Span) {\n      return this.start.equals(that.start) && this.end.equals(that.end);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Span),\n        this.start.hashCode()), this.end.hashCode()));\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    if (this.start.note !== void 0) {\n      output = output.write(this.start.note).write(58/*':'*/).write(32/*' '*/);\n    }\n    output = Format.displayNumber(output, this.start.line);\n    output = output.write(58/*':'*/);\n    output = Format.displayNumber(output, this.start.column);\n    output = output.write(45/*'-'*/);\n    output = Format.displayNumber(output, this.end.line);\n    output = output.write(58/*':'*/);\n    output = Format.displayNumber(output, this.end.column);\n    if (this.end.note !== void 0) {\n      output = output.write(58/*':'*/).write(32/*' '*/).write(this.end.note);\n    }\n    return output;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Span\").write(\".\").write(\"from\").write(\"(\");\n    output = this.start.debug(output);\n    output = output.write(\", \");\n    output = this.end.debug(output);\n    output = output.write(\")\");\n    return output;\n  }\n\n  override toString(): string {\n    return Format.display(this);\n  }\n\n  /**\n   * Returns a new `Span` representing the closed interval between the given\n   * `start` and `end` marks.\n   */\n  static from(start: Mark, end: Mark): Span {\n    if (start.offset > end.offset) {\n      const tmp = start;\n      start = end;\n      end = tmp;\n    }\n    return new Span(start, end);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\n\n/**\n * Stylized text output utility functions.\n * @public\n */\nexport const OutputStyle = (function () {\n  const OutputStyle = {} as {\n    /**\n     * Writes the ASCII reset escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    reset<T>(output: Output<T>): Output<T>\n\n    /**\n     * Writes the ASCII bold (increased intensity) escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    bold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII faint (decreased intensity) escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    faint<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII black foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    black<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII red foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    red<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII green foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    green<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII yellow foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    yellow<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII blue foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    blue<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII magenta foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    magenta<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII cyan foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    cyan<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII gray foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    gray<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold black foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    blackBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold red foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    redBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold green foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    greenBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold yellow foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    yellowBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold blue foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    blueBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold magenta foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    magentaBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold cyan foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    cyanBold<T>(output: Output<T>): Output<T>;\n\n    /**\n     * Writes the ASCII bold gray foreground color escape code to `output`,\n     * if [[OutputSettings.isStyled `output.settings.isStyled()`]] is `true`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    grayBold<T>(output: Output<T>): Output<T>;\n  };\n\n  OutputStyle.reset = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.bold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.faint = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(50/*'2'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.black = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(48/*'0'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.red = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(49/*'1'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.green = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(50/*'2'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.yellow = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(51/*'3'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.blue = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(52/*'4'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.magenta = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(53/*'5'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.cyan = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(54/*'6'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.gray = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(48/*'0'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(55/*'7'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.blackBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(48/*'0'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.redBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(49/*'1'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.greenBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(50/*'2'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.yellowBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(51/*'3'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.blueBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(52/*'4'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.magentaBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(53/*'5'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.cyanBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(54/*'6'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  OutputStyle.grayBold = function <T>(output: Output<T>): Output<T> {\n    if (output.settings.isStyled()) {\n      output = output.write(27).write(91/*'['*/).write(49/*'1'*/).write(59/*';'*/)\n                     .write(51/*'3'*/).write(55/*'7'*/).write(109/*'m'*/);\n    }\n    return output;\n  };\n\n  return OutputStyle;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, HashCode, Booleans, Numbers, Strings, Constructors} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport type {Debug} from \"../format/Debug\";\nimport {Format} from \"../format/Format\";\n\n/**\n * Either an [[OutputSettings]] instance, or an [[OutputSettingsInit]] object\n * initializer.\n * @public\n */\nexport type AnyOutputSettings = OutputSettings | OutputSettingsInit;\n\n/**\n * [[OutputSettings]] object initializer.\n * @public\n */\nexport interface OutputSettingsInit {\n  lineSeparator?: string;\n  isPretty?: boolean;\n  isStyled?: boolean;\n  precision?: number;\n}\n\n/**\n * [[Output]] production parameters. `OutputSettings` provide contextual\n * configuration parameters to output producers, such as [[Writer Writers]].\n * Uses include enabling pretty printing and styling generated output.\n * Subclasses can provide additional parameters understood by specialized\n * output producers.\n * @public\n */\nexport class OutputSettings implements Debug, HashCode {\n  protected constructor(lineSeparator: string, pretty: boolean,\n                        styled: boolean, precision: number) {\n    Object.defineProperty(this, \"lineSeparator\", {\n      value: lineSeparator,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"pretty\", {\n      value: pretty,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"styled\", {\n      value: styled,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"precision\", {\n      value: precision,\n      enumerable: true,\n    });\n  }\n\n  /**\n   * The Unicode code point sequence used to separate lines of text.\n   * Defaults to the runtime operating system's line separator.\n   */\n  readonly lineSeparator!: string;\n\n  /**\n   * Returns a copy of these settings with the given `lineSeparator`.\n   */\n  withLineSeparator(lineSeparator: string | undefined): string | OutputSettings {\n    return this.copy(lineSeparator, this.pretty, this.styled, this.precision);\n  }\n\n  /** @internal */\n  readonly pretty!: boolean;\n\n  /**\n   * Returns `true` if output producers should pretty print their output,\n   * when possible.\n   */\n  isPretty(): boolean {\n    return this.pretty;\n  }\n\n  /**\n   * Returns a copy of these settings with the given `pretty` flag.\n   */\n  asPretty(pretty: boolean): OutputSettings {\n    return this.copy(this.lineSeparator, pretty, this.styled, this.precision);\n  }\n\n  /** @internal */\n  readonly styled!: boolean;\n\n  /**\n   * Returns `true` if output producers should style their output,\n   * when possible.\n   */\n  isStyled(): boolean {\n    return this.styled;\n  }\n\n  /**\n   * Returns a copy of these settings with the given `styled` flag.\n   */\n  asStyled(styled: boolean): OutputSettings {\n    return this.copy(this.lineSeparator, this.pretty, styled, this.precision);\n  }\n\n  /**\n   * Returns the numeric precision output producers should use\n   * when formatting numbers.\n   */\n  readonly precision!: number;\n\n  /**\n   * Returns a copy of these settings with the given numeric `precision`.\n   */\n  withPrecision(precision: number): OutputSettings {\n    return this.copy(this.lineSeparator, this.pretty, this.styled, precision);\n  }\n\n  protected copy(lineSeparator: string | undefined, pretty: boolean,\n                 styled: boolean, precision: number): OutputSettings {\n    return OutputSettings.create(lineSeparator, pretty, styled, precision);\n  }\n\n  protected canEqual(that: unknown): boolean {\n    return that instanceof OutputSettings;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof OutputSettings) {\n      return that.canEqual(this) && this.lineSeparator === that.lineSeparator\n          && this.pretty === that.pretty && this.styled === that.styled\n          && this.precision === that.precision;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(OutputSettings), Strings.hash(this.lineSeparator)),\n        Booleans.hash(this.pretty)), Booleans.hash(this.styled)),\n        Numbers.hash(this.precision)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"OutputSettings\").write(46/*'.'*/);\n    if (!this.pretty && !this.styled) {\n      output = output.write(\"standard\");\n    } else if (this.pretty && !this.styled) {\n      output = output.write(\"pretty\");\n    } else if (!this.pretty && this.styled) {\n      output = output.write(\"styled\");\n    } else {\n      output = output.write(\"prettyStyled\");\n    }\n    output = output.write(40/*'('*/).write(41/*')'*/);\n    if (this.lineSeparator !== Format.lineSeparator) {\n      output = output.write(46/*'.'*/).write(\"lineSeparator\").write(40/*'('*/)\n                     .display(this.lineSeparator).write(41/*')'*/);\n    }\n    if (this.precision !== -1) {\n      output = output.write(46/*'.'*/).write(\"precision\").write(40/*'('*/)\n                     .display(this.precision).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  /**\n   * Returns `OutputSettings` configured with the system line separator,\n   * pretty printing disabled, and styling disabled.\n   */\n  @Lazy\n  static standard(): OutputSettings {\n    return new OutputSettings(Format.lineSeparator, false, false, -1);\n  }\n\n  /**\n   * Returns `OutputSettings` configured with the system line separator,\n   * pretty printing enabled, and styling disabled.\n   */\n  @Lazy\n  static pretty(): OutputSettings {\n    return new OutputSettings(Format.lineSeparator, true, false, -1);\n  }\n\n  /**\n   * Returns `OutputSettings` configured with the system line separator,\n   * pretty printing disabled, and styling enabled.\n   */\n  @Lazy\n  static styled(): OutputSettings {\n    return new OutputSettings(Format.lineSeparator, false, true, -1);\n  }\n\n  /**\n   * Returns `OutputSettings` configured with the system line separator,\n   * pretty printing enabled, and styling enabled.\n   */\n  @Lazy\n  static prettyStyled(): OutputSettings {\n    return new OutputSettings(Format.lineSeparator, true, true, -1);\n  }\n\n  /**\n   * Returns `OutputSettings` configured with the given `lineSeparator`, pretty\n   * rinting enabled if `isPretty` is `true`, styling enabled if `isStyled` is\n   * `true`, and with the given numeric `precision`.\n   */\n  static create(lineSeparator?: string, pretty?: boolean,\n                styled?: boolean, precision?: number): OutputSettings {\n    if (typeof lineSeparator !== \"string\") {\n      lineSeparator = Format.lineSeparator;\n    }\n    if (typeof pretty !== \"boolean\") {\n      pretty = false;\n    }\n    if (typeof styled !== \"boolean\") {\n      styled = false;\n    }\n    if (typeof precision !== \"number\") {\n      precision = -1;\n    }\n    if (lineSeparator === Format.lineSeparator && precision === -1) {\n      if (!pretty && !styled) {\n        return OutputSettings.standard();\n      } else if (pretty && !styled) {\n        return OutputSettings.pretty();\n      } else if (!pretty && styled) {\n        return OutputSettings.styled();\n      } else {\n        return OutputSettings.prettyStyled();\n      }\n    }\n    return new OutputSettings(lineSeparator, pretty, styled, precision);\n  }\n\n  /**\n   * Converts a settings `init` object to an instance of `OutputSettings`.\n   */\n  static fromInit(init: OutputSettingsInit): OutputSettings {\n    return OutputSettings.create(init.lineSeparator, init.isPretty,\n                                 init.isStyled, init.precision);\n  }\n\n  /**\n   * Converts a loosely typed settings `value` to an instance of `OutputSettings`.\n   */\n  static fromAny(value: AnyOutputSettings | undefined): OutputSettings {\n    if (value instanceof OutputSettings) {\n      return value;\n    } else if (typeof value === \"object\" && value !== null) {\n      return OutputSettings.fromInit(value);\n    }\n    return OutputSettings.standard();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Thrown when reading invalid [[Input]].\n * @public\n */\nexport class InputException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, InputException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, HashCode, Booleans, Constructors} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport type {Debug} from \"../format/Debug\";\nimport {Format} from \"../format/Format\";\n\n/**\n * Either an [[InputSettings]] instance, or an [[InputSettingsInit]] object\n * initializer.\n * @public\n */\nexport type AnyInputSettings = InputSettings | InputSettingsInit;\n\n/**\n * [[InputSettings]] object initializer.\n * @public\n */\nexport interface InputSettingsInit {\n  isStripped?: boolean;\n}\n\n/**\n * [[Input]] consumption parameters. `InputSettings` provide contextual\n * configuration parameters to input consumers, such as [[Parser Parsers]].\n * @public\n */\nexport class InputSettings implements HashCode, Debug {\n  protected constructor(stripped: boolean) {\n    Object.defineProperty(this, \"stripped\", {\n      value: stripped,\n      enumerable: true,\n    });\n  }\n\n  /** @internal */\n  readonly stripped!: boolean;\n\n  /**\n   * Returns `true` if input consumers should not include diagnostic metadata\n   * in generated output.\n   */\n  isStripped(): boolean {\n    return this.stripped;\n  }\n\n  /**\n   * Returns a copy of these settings with the given `stripped` flag.\n   */\n  asStripped(stripped: boolean): InputSettings {\n    return this.copy(stripped);\n  }\n\n  protected copy(stripped: boolean): InputSettings {\n    return InputSettings.create(stripped);\n  }\n\n  protected canEqual(that: unknown): boolean {\n    return that instanceof InputSettings;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof InputSettings) {\n      return that.canEqual(this) && this.stripped === that.stripped;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(InputSettings),\n        Booleans.hash(this.stripped)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"InputSettings\").write(46/*'.'*/);\n    if (!this.stripped) {\n      output = output.write(\"standard\");\n    } else {\n      output = output.write(\"stripped\");\n    }\n    output = output.write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  /**\n   * Returns `InputSettings` configured to include diagnostic metadata in\n   * generated output.\n   */\n  @Lazy\n  static standard(): InputSettings {\n    return new InputSettings(false);\n  }\n\n  /**\n   * Returns `InputSettings` configured to omit diagnostic metadata in\n   * generated output.\n   */\n  @Lazy\n  static stripped(): InputSettings {\n    return new InputSettings(true);\n  }\n\n  /**\n   * Returns `InputSettings` configured to not include diagnostic metadata in\n   * generated output, if `isStripped` is `true`.\n   */\n  static create(isStripped?: boolean): InputSettings {\n    if (isStripped) {\n      return InputSettings.stripped();\n    }\n    return InputSettings.standard();\n  }\n\n  /**\n   * Converts the loosely typed `settings` to an instance of `InputSettings`.\n   */\n  static fromAny(settings: AnyInputSettings | undefined): InputSettings {\n    if (settings instanceof InputSettings) {\n      return settings;\n    } else if (typeof settings === \"object\" && settings !== null) {\n       return InputSettings.create(settings.isStripped);\n    } else {\n      return InputSettings.standard();\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {InputEmpty} from \"../\"; // forward import\nimport {InputDone} from \"../\"; // forward import\nimport {InputError} from \"../\"; // forward import\n\n/**\n * Non-blocking token stream reader, with single token lookahead.\n * `Input` enables incremental, interruptible parsing of network protocols and\n * data formats.\n *\n * ### Input tokens\n * Input tokens are modeled as primitive numbers, commonly representing Unicode\n * code points, or raw octets; each `Input` implementation specifies the\n * semantic type of its tokens. The [[head]]  method peeks at the lookahead\n * token, without consuming it, and the [[step]] method advances the input to\n * the next token.\n *\n * ### Input states\n * An `Input` reader is always in one of three states: _cont_​inue, _empty_, or\n * _done_. The _cont_ state indicates that a lookahead token is immediately\n * available; the _empty_ state indicates that no additional tokens are\n * available at this time, but that the stream may logically resume at some\n * point in the future; and the _done_ state indicates that the stream has\n * terminated. [[isCont]] returns `true` when in the _cont_ state; [[isEmpty]]\n * returns `true` when in the _empty_ state; and [[isDone]] returns `true` when\n * in the _done_ state.\n *\n * ### Non-blocking behavior\n * `Input` readers never block. An `Input` reader that would otherwise block\n * awaiting additional input instead enters the _empty_ state, signaling the\n * input consumer to back off processing the input, but to remain prepared to\n * process additional input in the future. An `Input` reader enters the _done_\n * state when it encounters the final end of its input, signaling the input\n * consumer to stop processing. [[Input.empty]] returns an `Input` reader in\n * the _empty_ state. [[Input.done]] returns an `Input` reader in the _done_\n * state.\n *\n * ### Position tracking\n * The logical position of the lookahead token is made available via the\n * [[mark]] method, with optimized callouts for the byte [[offset]], one-based\n * [[line]] number, and one-based [[column]] in the current line. The [[id]]\n * method returns a diagnostic identifier for the token stream.\n *\n * ### Cloning\n * An `Input` reader may be [[clone cloned]] to provide an indepently mutable\n * position into a shared token stream. Not all `Input` implementations\n * support cloning.\n *\n * @see [[InputSettings]]\n * @see [[Parser]]\n * @public\n */\nexport abstract class Input {\n  /**\n   * Returns `true` when a [[head lookahead]] token is immediately available.\n   * i.e. this `Input` is in the _cont_ state.\n   */\n  abstract isCont(): boolean;\n\n  /**\n   * Returns `true` when no lookahead token is currently available, but\n   * additional input may be available at some point in the future, i.e. this\n   * `Input` is in the _empty_ state.\n   */\n  abstract isEmpty(): boolean;\n\n  /**\n   * Returns `true` when no lookahead token is currently available, and no\n   * additional input will ever become available, i.e. this `Input` is in\n   * the _done_ state.\n   */\n  abstract isDone(): boolean;\n\n  /**\n   * Returns `true` when no lookahead token is currently available due to an\n   * error with the token stream. i.e. this `Input` is in the `error` state.\n   * When `true`, `trap()` will return the input error\n   */\n  abstract isError(): boolean;\n\n  /**\n   * Returns `true` if this is a partial `Input` will that enter the _empty_\n   * state after it consumes the last available input token.\n   */\n  abstract isPart(): boolean;\n\n   /**\n    * Returns a partial `Input` equivalent to this `Input`, if `part` is `true`;\n    * returns a final `Input` equivalent to this `Input` if `part` is `false`.\n    * The caller's reference to this `Input` should be replaced by the returned\n    * `Input`\n    */\n  abstract asPart(part: boolean): Input;\n\n  /**\n   * Returns the current lookahead token, if this `Input` is in the\n   * _cont_ state.\n   *\n   * @throws [[InputException]] if this `Input` is not in the _cont_ state.\n   */\n  abstract head(): number;\n\n  /**\n   * Advances to the next token, if this `Input` is in the _cont_ state.\n   *\n   * @throws `Error` if this `Input` is not in the _cont_ state.\n   */\n  abstract step(): Input;\n\n  /**\n   * Sets the position of this `Input` to the given `mark`. Rewinds to the\n   * start of this `Input`, if `mark` is `undefined`.\n   *\n   * @throws [[InputException]] if this `Input` does not support seeking,\n   *         or is unable to reposition to the `mark`.\n   */\n  abstract seek(mark?: Mark): Input;\n\n  /**\n   * Returns the input error when in the _error_ state\n   *\n   * @throws InputException if the `Input` is not the _error_state\n   */\n  trap(): Error {\n    throw new InputException();\n  }\n\n  /**\n   * An informative identifier for this token stream, or `undefined` if this\n   * stream is unidentified.\n   */\n  abstract readonly id: string | undefined;\n\n  /**\n   * Returns an `Input` equivalent to this `Input`, but logically identified\n   * by the given–possibly `undefined`–`id`. The caller's reference to this\n   * `Input` should be replaced by the returned `Input`.\n   */\n  abstract withId(id: string | undefined): Input;\n\n  /**\n   * The position of the current lookahead token, relative to the start\n   * of the stream.\n   */\n  abstract readonly mark: Mark;\n\n  /**\n   * Returns an `Input` equivalent to this `Input`, but logically positioned\n   * at the given `mark`. The physical position in the input stream is not\n   * modified. The caller's reference to this `Input` should be replaced by\n   * the returned `Input`.\n   */\n  abstract withMark(mark: Mark): Input;\n\n  /**\n   * The byte offset of the current lookahead token, relative to the start\n   * of the stream.\n   */\n  abstract readonly offset: number;\n\n  /**\n   * The one-based line number of the current lookahead token, relative to\n   * the start of the stream.\n   */\n  abstract readonly line: number;\n\n  /**\n   * The one-based column number of the current lookahead token, relative to\n   * the current line in the stream.\n   */\n  abstract readonly column: number;\n\n  /**\n   * The `InputSettings` used to configure the behavior of input consumers\n   * that read from this `Input`.\n   */\n  abstract readonly settings: InputSettings;\n\n  /**\n   * Returns a clone of this `Input` with the given `settings`.\n   *\n   * @throws `Error` if this `Input` reader cannot be cloned.\n   */\n  abstract withSettings(settings: AnyInputSettings): Input;\n\n  /**\n   * Returns an independently positioned view into the token stream,\n   * initialized with identical state to this `Input`.\n   *\n   * @throws `Error` if this `Input` reader cannot be cloned.\n   */\n  abstract clone(): Input;\n\n  /**\n   * Returns an `Input` reader in the _empty_ state.\n   */\n  @Lazy\n  static empty(): Input {\n    return new InputEmpty(void 0, Mark.zero, InputSettings.standard());\n  }\n\n  /**\n   * Returns an `Input` reader in the _done_ state.\n   */\n  @Lazy\n  static done(): Input {\n    return new InputDone(void 0, Mark.zero, InputSettings.standard());\n  }\n\n  /**\n   * Returns an `Input` in the _error_ state that traps the given `error`.\n   */\n  static error(error: Error): Input {\n    return new InputError(error, void 0, Mark.zero, InputSettings.standard());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {Input} from \"./Input\";\n\n/** @internal */\nexport class InputError extends Input {\n  /** @internal */\n  readonly error!: Error;\n\n  constructor(error: Error, id: string | undefined, mark: Mark, settings: InputSettings) {\n    super();\n    Object.defineProperty(this, \"error\", {\n      value: error,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"id\", {\n      value: id,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"mark\", {\n      value: mark,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return true;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Input {\n    return this;\n  }\n\n  override head(): number {\n    throw new InputException();\n  }\n\n  override step(): Input {\n    const error = new InputException(\"error step\");\n    return new InputError(error, this.id, this.mark, this.settings);\n  }\n\n  override trap(): Error {\n    return this.error;\n  }\n\n  override seek(mark?: Mark): Input {\n    const error = new InputException(\"error seek\");\n    return new InputError(error, this.id, this.mark, this.settings);\n  }\n\n  override readonly id!: string | undefined;\n\n  override withId(id: string | undefined): Input {\n    return new InputError(this.error, id, this.mark, this.settings);\n  }\n\n  override readonly mark!: Mark;\n\n  override withMark(mark: Mark): Input {\n    return new InputError(this.error, this.id, mark, this.settings);\n  }\n\n  override get offset(): number {\n    return this.mark.offset;\n  }\n\n  override get line(): number {\n    return this.mark.line;\n  }\n\n  override get column(): number {\n    return this.mark.column;\n  }\n\n  override readonly settings!: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): Input {\n    settings = InputSettings.fromAny(settings);\n    return new InputError(this.error, this.id, this.mark, settings);\n  }\n\n  override clone(): Input {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Strings} from \"@swim/util\";\nimport {Mark} from \"../source/Mark\";\nimport {InputException} from \"../input/InputException\";\nimport {AnyInputSettings, InputSettings} from \"../input/InputSettings\";\nimport {Input} from \"../input/Input\";\nimport {InputError} from \"../input/InputError\";\n\n/** @internal */\nexport class StringInput extends Input {\n  constructor(string: string, id: string | undefined, offset: number,\n              line: number, column: number, settings: InputSettings,\n              index: number, part: boolean) {\n    super();\n    this.string = string;\n    this.index = index;\n    this.part = part;\n    this.id = id;\n    this.offset = offset;\n    this.line = line;\n    this.column = column;\n    this.settings = settings;\n  }\n\n  /** @internal */\n  readonly string: string;\n\n  /** @internal */\n  readonly index: number;\n\n  /** @internal */\n  readonly part: boolean;\n\n  override isCont(): boolean {\n    return this.index < this.string.length;\n  }\n\n  override isEmpty(): boolean {\n    return this.part && this.index >= this.string.length;\n  }\n\n  override isDone(): boolean {\n    return !this.part && this.index >= this.string.length;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return this.part;\n  }\n\n  override asPart(part: boolean): Input {\n    (this as Mutable<this>).part = part;\n    return this;\n  }\n\n  override head(): number {\n    const string = this.string;\n    const index = this.index;\n    if (index < string.length) {\n      const c = string.codePointAt(index);\n      if (c !== void 0) {\n        return c;\n      } else {\n        return string.charCodeAt(index);\n      }\n    }\n    throw new InputException();\n  }\n\n  override step(): Input {\n    const string = this.string;\n    const index = this.index;\n    if (index < string.length) {\n      const c = string.codePointAt(index);\n      (this as Mutable<this>).index = Strings.offsetByCodePoints(string, index, 1);\n      (this as Mutable<this>).offset += this.index - index;\n      if (c === 10/*'\\n'*/) {\n        (this as Mutable<this>).line += 1;\n        (this as Mutable<this>).column = 1;\n      } else {\n        (this as Mutable<this>).column += 1;\n      }\n      return this;\n    } else {\n      const error = new InputException(\"invalid step\");\n      return new InputError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override seek(mark?: Mark): Input {\n    if (mark !== void 0) {\n      const index = this.index + (mark.offset - this.offset);\n      if (0 <= index && index <= this.string.length) {\n        (this as Mutable<this>).index = index;\n        (this as Mutable<this>).offset = mark.offset;\n        (this as Mutable<this>).line = mark.line;\n        (this as Mutable<this>).column = mark.column;\n        return this;\n      } else {\n        const error = new InputException(\"invalid seek to \" + mark);\n        return new InputError(error, this.id, this.mark, this.settings);\n      }\n    } else {\n      (this as Mutable<this>).index = 0;\n      (this as Mutable<this>).offset = 0;\n      (this as Mutable<this>).line = 1;\n      (this as Mutable<this>).column = 1;\n      return this;\n    }\n  }\n\n  readonly id: string | undefined;\n\n  override withId(id: string | undefined): Input {\n    (this as Mutable<this>).id = id;\n    return this;\n  }\n\n  override get mark(): Mark {\n    return Mark.at(this.offset, this.line, this.column);\n  }\n\n  override withMark(mark: Mark): Input {\n    (this as Mutable<this>).offset = mark.offset;\n    (this as Mutable<this>).line = mark.line;\n    (this as Mutable<this>).column = mark.column;\n    return this;\n  }\n\n  override readonly offset: number;\n\n  override readonly line: number;\n\n  override readonly column: number;\n\n  override readonly settings: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): Input {\n    settings = InputSettings.fromAny(settings);\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  override clone(): Input {\n    return new StringInput(this.string, this.id, this.offset, this.line,\n                           this.column, this.settings, this.index, this.part);\n  }\n\n  static create(string: string): Input {\n    return new StringInput(string, void 0, 0, 1, 1, InputSettings.standard(), 0, false);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Thrown when writing invalid [[Output]].\n * @public\n */\nexport class OutputException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, OutputException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Builder} from \"@swim/util\";\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {OutputFull} from \"../\"; // forward import\nimport {OutputDone} from \"../\"; // forward import\nimport {OutputError} from \"../\"; // forward import\nimport {Format} from \"../\"; // forward import\n\n/**\n * Non-blocking token stream writer. `Output` enables incremental,\n * interruptible writing of network protocols and data formats.\n *\n * ### Output tokens\n * Output tokens are modeled as primitive numbers, commonly representing\n * Unicode code points, or raw octets; each `Output` implementation specifies\n * the semantic type of its tokens.\n *\n * ### Output states\n * An `Output` writer is always in one of three states: _cont_​inue, _full_,\n * or _done_. The _cont_ state indicates that the stream is ready to write a\n * single token; the _full_ state indicates that the stream is unable to write\n * additional tokens at this time, but that the stream may logically resume at\n * some point in the future; and the _done_ state indicates that the stream has\n * terminated, and that [[bind]] will return the output result. [[isCont]]\n * returns `true` when in the _cont_ state; [[isFull]] returns `true` when in\n * the _full_ state; and [[isDone]] returns `true` when in the _done_ state.\n *\n * ### Output results\n * An `Output` writer yields a value of type `T`, obtained via the [[bind]]\n * method, representing some implementation defined result of writing the\n * output. For example, an `Output<string>` implementation may–but is not\n * required to–yield a `string` containing all code points written to the\n * output.\n *\n * ### Non-blocking behavior\n * `Output` writers never block. An `Output` writer that would otherwise block\n * writing additional output instead enters the _full_ state, signaling the\n * output generator to back off producing the output, but to remain prepared to\n * produce additional output in the future. An `Output` writer enters the\n * _done_ state when it encounters the final end of its output, signaling to\n * the output generator to stop producing.\n *\n * ### Output settings\n * An output generator may alter the tokens it produces based on its `Output`\n * writer's [[settings]]. Uses include pretty printing and styling generated\n * output. [[OutputSettings]] subclasses can provide additional parameters\n * understood by specialized output producers.\n *\n * ### Cloning\n * An `Output` writer may be [[clone cloned]] to branch the token stream in an\n * implementation specified manner. Not all `Output` implementations support\n * cloning.\n *\n * @see [[OutputSettings]]\n * @see [[Writer]]\n * @public\n */\nexport abstract class Output<T = unknown> implements Builder<number, T> {\n  /**\n   * Returns `true` when the next [[write write(number)]] will succeed.\n   * i.e. this `Output` is in the _cont_ state.\n   */\n  abstract isCont(): boolean;\n\n  /**\n   * Returns `true` when an immediate `write` will fail, but writes may succeed\n   * at some point in the future, i.e. this `Output` is in the _full_ state.\n   */\n  abstract isFull(): boolean;\n\n  /**\n   * Returns `true` when no `write` will ever again suucced.\n   * i.e. this `Output` is in the _done_ state.\n   */\n  abstract isDone(): boolean;\n\n  /**\n   * Returns `true` when an immediate `write` will fail due to an\n   * error with the token stream. i.e. this `Output` is in the `error` state.\n   * When `true`, `trap()` will return the output error.\n   */\n  abstract isError(): boolean;\n\n  /**\n   * Returns `true` if this is a partial `Output` that will enter\n   * the `full` state when it is unable to write additional tokens.\n   */\n  abstract isPart(): boolean;\n\n  /**\n   * Returns a partial `Output` equivalent to this `Output`, if `part` is `true`;\n   * returns a final `Output` equivalent to this `Output` if `part` is `false`.\n   * The caller's reference to this `Output` should be replaced by the returned\n   * `Output`.\n   */\n  abstract asPart(part: boolean): Output<T>;\n\n  /**\n   * Writes a single `token` to the stream, if this `Output` is in the\n   * _cont_ state.\n   *\n   * @returns `this`\n   * @throws [[OutputException]] if this `Output` is not in the _cont_ state.\n   */\n  abstract write(token: number): Output<T>;\n\n  /**\n   * Writes the code points of the given `string`. Assumes this is a Unicode\n   * `Output` writer with sufficient capacity.\n   *\n   * @returns `this`\n   * @throws [[OutputException]] if this `Output` exits the _cont_ state before\n   *         the full `string` has been written.\n   */\n  abstract write(string: string): Output<T>;\n\n  /**\n   * Writes the code points of the given `string`, followed by the code points\n   * of the `settings`' [[OutputSettings.lineSeparator line separator].\n   * Assumes this is a Unicode `Output` writer with sufficient capacity.\n   *\n   * @returns `this`\n   * @throws [[OutputException]] if this `Output` exits the _cont_ state before\n   *         the full `string` and line separator has been written.\n   */\n  writeln(string?: string): Output<T> {\n    if (typeof string === \"string\") {\n      this.write(string);\n    }\n    return this.write(this.settings.lineSeparator);\n  }\n\n  /**\n   * Writes the code points of the human-readable [[Display]] string of the\n   * given `object`. Assumes this is a Unicode `Output` writer with sufficient\n   * capacity.\n   *\n   * @returns the continuation of the `output`.\n   * @throws [[OutputException]] if this `Output` exits the _cont_ state before\n   *         the full display string has been written.\n   */\n  display(object: unknown): Output<T> {\n    return Format.displayAny(this, object);\n  }\n\n  /**\n   * Writes the code points of the developer-readable [[Debug]] string of the\n   * given `object`. Assumes this is a Unicode `Output` writer with sufficient\n   * capacity.\n   *\n   * @returns the continuation of the `output`.\n   * @throws [[OutputException]] if this `Output` exits the _cont_ state before\n   *         the full debug string has been written.\n   */\n  debug(object: unknown): Output<T> {\n    return Format.debugAny(this, object);\n  }\n\n  /**\n   * Writes any internally buffered state to the underlying output stream.\n   */\n  flush(): Output<T> {\n    return this;\n  }\n\n  push(...tokens: number[]): void {\n    const n = tokens.length;\n    for (let i = 0; i < n; i += 1) {\n      this.write(tokens[i]!);\n    }\n  }\n\n  /**\n   * The `OutputSettings` used to configure the behavior of output producers\n   * that write to this `Output`.\n   */\n  abstract readonly settings: OutputSettings;\n\n  /**\n   * Updates the `settings` associated with this `Output`.\n   *\n   * @returns `this`\n   */\n  abstract withSettings(settings: AnyOutputSettings): Output<T>;\n\n  /**\n   * Returns the implementation-defined result of writing the output.\n   */\n  abstract bind(): T;\n\n  /**\n   * Returns the output error. Only guaranteed to return an error when in the\n   * _error_ state.\n   *\n   * @throws OutputException if this `Output` is not in the _error_ state.\n   */\n  trap(): Error {\n    throw new OutputException();\n  }\n\n  /**\n   * Returns an implementation-defined branch of the token stream.\n   *\n   * @throws `Error` if this `Output` writer cannot be cloned.\n   */\n  clone(): Output<T> {\n    throw new Error();\n  }\n\n  /**\n   * Return an `Output` in the _full_ state.\n   */\n  @Lazy\n  static full(): Output<never> {\n    return new OutputFull(OutputSettings.standard());\n  }\n\n  /**\n   * Returns an `Output` in the _done_ state.\n   */\n  @Lazy\n  static done(): Output<never> {\n    return new OutputDone(OutputSettings.standard());\n  }\n\n  /**\n   * Return an `Output` in the _error_ state that traps the given `error`.\n   */\n  static error(error: Error): Output<never> {\n    return new OutputError(error, OutputSettings.standard());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport {Output} from \"../output/Output\";\n\n/** @internal */\nexport class StringOutput extends Output<string> {\n  constructor(string: string, settings: OutputSettings) {\n    super();\n    this.string = string;\n    this.settings = settings;\n  }\n\n  /** @internal */\n  readonly string: string;\n\n  override isCont(): boolean {\n    return true;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Output<string> {\n    return this;\n  }\n\n  override write(token: number | string): Output<string> {\n    if (typeof token === \"number\") {\n      if ((token >= 0x0000 && token <= 0xd7ff)\n          || (token >= 0xe000 && token <= 0xffff)) { // U+0000..U+D7FF | U+E000..U+FFFF\n        token = String.fromCharCode(token);\n      } else if (token >= 0x10000 && token <= 0x10ffff) { // U+10000..U+10FFFF\n        const u = token - 0x10000;\n        token = String.fromCharCode(0xd800 | (u >>> 10), 0xdc00 | (u & 0x3ff));\n      } else { // invalid code point\n        token = \"\\ufffd\";\n      }\n    }\n    (this as Mutable<this>).string += token;\n    return this;\n  }\n\n  override writeln(string?: string): Output<string> {\n    if (string !== void 0) {\n      (this as Mutable<this>).string = this.string.concat(string);\n    }\n    (this as Mutable<this>).string = this.string.concat(this.settings.lineSeparator);\n    return this;\n  }\n\n  override readonly settings: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<string> {\n    settings = OutputSettings.fromAny(settings);\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  override bind(): string {\n    return this.string;\n  }\n\n  override clone(): Output<string> {\n    return new StringOutput(this.string, this.settings);\n  }\n\n  override toString(): string {\n    return this.string;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * Thrown when a [[Writer]] attempts to write invalid syntax.\n * @public\n */\nexport class WriterException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, WriterException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"./WriterException\";\nimport {WriterEnd} from \"../\"; // forward import\nimport {WriterDone} from \"../\"; // forward import\nimport {WriterError} from \"../\"; // forward import\nimport {WriterSequence} from \"../\"; // forward import\n\n/**\n * Continuation of how to write subsequent [[Output]] tokens to a stream.\n * `Writer` enables efficient, interruptible writing of network protocols and\n * data formats, without intermediate buffering.\n *\n * ### Output tokens\n * A `Writer` writes tokens to an `Output` writer. Output tokens are modeled\n * as primitive numbers, commonly representing Unicode code points, or raw\n * octets. Each `Writer` implementation specifies the semantic type of output\n * tokens it produces.\n *\n * ### Writer states\n * A `Writer` is always in one of three states: _cont_​inue, _done_, or _error_.\n * The _cont_ state indicates that [[pull]] is ready to produce `Output`; the\n * _done_ state indicates that writing terminated successfully, and that\n * [[bind]] will return the written result; the _error_ state indicates that\n * writing terminated in failure, and that [[trap]] will return the write error.\n * `Writer` subclasses default to the _cont_ state.\n *\n * ### Feeding input\n * The [[feed]] method returns a `Writer` that represents the continuation\n * of how to write the given input object to subsequent `Output` writers.\n * `feed` can be used to specify an initial object to write, or to change\n * the object to be written.\n *\n * ### Pulling output\n * The [[pull]] method incrementally writes as much `Output` as it can, before\n * returning another `Writer` that represents the continuation of how to write\n * additional `Output`. The `Output` passed to `pull` is only guaranteed to be\n * valid for the duration of the method call; references to the provided\n * `Output` instance must not be stored.\n *\n * ### Writer results\n * A `Writer` produces a written result of type `O`, obtained via the [[bind]]\n * method. `bind` is only guaranteed to return a result when in the _done_\n * state; though `bind` may optionally make available partial results in other\n * states. A failed `Writer` provides a write error via the [[trap]] method.\n * `trap` is only guaranteed to return an error when in the _error_ state.\n *\n * ### Continuations\n * A `Writer` instance represents a continuation of how to write remaining\n * `Output`. Rather than writing a complete output in one go, a `Writer` takes\n * an `Output` chunk and returns another `Writer` instance that knows how to\n * write subsequent `Output` chunks. This enables non-blocking, incremental\n * writing that can be interrupted whenever an `Output` writer runs out of\n * space. A `Writer` terminates by returning a continuation in either the\n * _done_ state, or the _error_ state. [[Writer.done]] returns a `Writer` in\n * the _done_ state. [[Writer.error]] returns a `Writer` in the _error_ state.\n *\n * ### Forking\n * The [[fork]] method passes an out-of-band condition to a `Writer`, yielding\n * a `Writer` continuation whose behavior may be altered by the given condition.\n * For example, a console `Writer` might support a `fork` condition that changes\n * the color and style of printed text. The types of conditions accepted by\n * `fork`, and their intended semantics, are implementation defined.\n *\n * @public\n */\nexport abstract class Writer<I = unknown, O = unknown> {\n  /**\n   * Returns `true` when [[pull]] is able to produce `Output`, i.e. this\n   * `Writer` is in the _cont_ state.\n   */\n  isCont(): boolean {\n    return true;\n  }\n\n  /**\n   * Returns `true` when writing has terminated successfully, and [[bind]] will\n   * return the written result, i.e. this `Writer` is in the _done_ state.\n   */\n  isDone(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns `true` when writing has terminated in failure, and [[trap]] will\n   * return the write error, i.e. this `Writer` is in the _error_ state.\n   */\n  isError(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns a `Writer` that represents the continuation of how to write the\n   * given `input` object.\n   *\n   * @throws `WriterException` if this `Writer` does not know how to write the\n   *         given `input` object.\n   */\n  feed(input: I): Writer<I, O> {\n    throw new WriterException();\n  }\n\n  /**\n   * Incrementally writes as much `output` as possible, and returns another\n   * `Writer` that represents the continuation of how to write additional\n   * `Output`. If `output` enters the _done_ state, `pull` _must_ return a\n   * terminated `Writer`, i.e. a `Writer` in the _done_ state, or in the\n   * _error_ state. The given `output` is only guaranteed to be valid for the\n   * duration of the method call; references to `output` must not be stored.\n   */\n  abstract pull(output: Output): Writer<I, O>;\n\n  /**\n   * Returns a `Writer` continuation whose behavior may be altered by the given\n   * out-of-band `condition`.\n   */\n  fork(condition: unknown): Writer<I, O> {\n    return this;\n  }\n\n  /**\n   * Returns the written result. Only guaranteed to return a result when in\n   * the _done_ state.\n   *\n   * @throws `Error` if this `Writer` is not in the _done_ state.\n   */\n  bind(): O {\n    throw new WriterException();\n  }\n\n  /**\n   * Returns the write error. Only guaranteed to return an error when in the\n   * _error_ state.\n   *\n   * @throws `Error` if this `Writer` is not in the _error_ state.\n   */\n  trap(): Error {\n    throw new WriterException();\n  }\n\n  /**\n   * Casts a done `Writer` to a different input type. A `Writer` in the _done_\n   * state can have any input type.\n   *\n   * @throws `WriterException` if this `Writer` is not in the _done_ state.\n   */\n  asDone<I2>(): Writer<I2, O> {\n    throw new WriterException();\n  }\n\n  /**\n   * Casts an errored `Writer` to different input and output types. A `Writer`\n   * in the _error_ state can have any input type, and any output type.\n   *\n   * @throws `WriterException` if this `Writer` is not in the _error_ state.\n   */\n  asError<I2, O2>(): Writer<I2, O2> {\n    throw new WriterException();\n  }\n\n  /**\n   * Returns a `Writer` that continues writing `that` `Writer`, after it\n   * finishes writing this `Writer`.\n   */\n  andThen<O2>(that: Writer<unknown, O2>): Writer<never, O2> {\n    return new WriterSequence(this, that);\n  }\n\n  /**\n   * Returns a `Writer` in the _done_ state that never binds a value.\n   */\n  @Lazy\n  static end<I>(): Writer<I, never> {\n    return new WriterEnd();\n  }\n\n  /**\n   * Returns a `Writer` in the _done_ state that binds the given written `value`.\n   */\n  static done<I, O>(value: O): Writer<I, O> {\n    return new WriterDone(value);\n  }\n\n  /**\n   * Returns a `Writer` in the _error_ state that traps the given write `error`.\n   */\n  static error<I, O>(error: Error): Writer<I, O> {\n    return new WriterError(error);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"../writer/WriterException\";\nimport {Writer} from \"../writer/Writer\";\n\n/** @internal */\nexport class StringWriter extends Writer<unknown, unknown> {\n  /** @internal */\n  readonly value: unknown;\n  /** @internal */\n  readonly input: string;\n  /** @internal */\n  readonly index: number;\n\n  constructor(value: unknown, input: string, index: number = 0) {\n    super();\n    this.value = value;\n    this.input = input;\n    this.index = index;\n  }\n\n  override feed(input: unknown): Writer<unknown, unknown> {\n    return new StringWriter(input, \"\" + input);\n  }\n\n  override pull(output: Output): Writer<unknown, unknown> {\n    return StringWriter.write(output, this.value, this.input, this.index);\n  }\n\n  static write(output: Output, value: unknown, input: string, index: number = 0): Writer<unknown, unknown> {\n    const length = input.length;\n    while (index < length && output.isCont()) {\n      let c = input.codePointAt(index);\n      if (c === void 0) {\n        c = input.charCodeAt(index);\n      }\n      output = output.write(c);\n      index = Strings.offsetByCodePoints(input, index, 1);\n    }\n    if (index === length) {\n      return Writer.done(value);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new StringWriter(value, input, index);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input} from \"../input/Input\";\nimport {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport type {Output} from \"../output/Output\";\nimport type {Writer} from \"../writer/Writer\";\nimport {StringInput} from \"./StringInput\";\nimport {StringOutput} from \"./StringOutput\";\nimport {StringWriter} from \"./StringWriter\";\n\n/**\n * Unicode code point [[Input]]/[[Output]]/[[Writer]] factory.\n *\n * The `Unicode.stringInput(...)` function returns an `Input` that reads the\n * Unicode code points of a `string`.\n *\n * The `Unicode.stringOutput(...)` function returns an `Output` that writes\n * Unicode code points to an internal buffer, and [[Output.bind binds]] a\n * `string` containing all written code points.\n * @public\n */\nexport const Unicode = (function () {\n  const Unicode = {} as {\n    stringInput(string: string): Input;\n\n    /**\n     * Returns a new `Output` that appends Unicode code points to the given\n     * `string`, using the given output `settings`. The returned `Output`\n     * accepts an unbounded number of code points, remaining permanently in the\n     * _cont_ state, and [[Output.bind binds]] a `string` containing the given\n     * `string`, and all appended code points.\n     */\n    stringOutput(string?: string, settings?: AnyOutputSettings): Output<string>;\n\n    /**\n     * Returns a new `Output` that buffers Unicode code points, using the given\n     * output `settings`. The returned `Output` accepts an unbounded number of\n     * code points, remaining permanently in the _cont_ state, and [[Output.bind\n     * binds]] a `string` containing all written code points.\n     */\n    stringOutput(settings?: AnyOutputSettings): Output<string>;\n\n    stringWriter<I>(): Writer<I, unknown>;\n\n    stringWriter<I, O>(input: O): Writer<I, O>;\n\n    writeString<I>(output: Output, input: unknown): Writer<I, unknown>;\n\n    /** @internal */\n    isAlpha(c: number): boolean;\n\n    /** @internal */\n    isDigit(c: number): boolean;\n\n    /** @internal */\n    isSpace(c: number): boolean;\n\n    /** @internal */\n    isNewline(c: number): boolean;\n\n    /** @internal */\n    isWhitespace(c: number): boolean;\n  };\n\n  Unicode.stringInput = function (string: string): Input {\n    return StringInput.create(string);\n  };\n\n  Unicode.stringOutput = function (string?: string | AnyOutputSettings, settings?: AnyOutputSettings): Output<string> {\n    if (settings === void 0 && typeof string !== \"string\") {\n      settings = string;\n      string = \"\";\n    } else if (typeof string !== \"string\") {\n      string = \"\";\n    }\n    settings = OutputSettings.fromAny(settings);\n    return new StringOutput(string, settings);\n  };\n\n  Unicode.stringWriter = function <I, O>(input?: O): Writer<I, unknown> {\n    if (input === void 0) {\n      return new StringWriter(void 0, \"\");\n    } else {\n      return new StringWriter(input, \"\" + input);\n    }\n  };\n\n  Unicode.writeString = function <I>(output: Output, input: unknown): Writer<I, unknown> {\n    return StringWriter.write(output, void 0, \"\" + input);\n  };\n\n  Unicode.isAlpha = function (c: number): boolean {\n    return c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/;\n  };\n\n  Unicode.isDigit = function (c: number): boolean {\n    return c >= 48/*'0'*/ && c <= 57/*'9'*/;\n  };\n\n  Unicode.isSpace = function (c: number): boolean {\n    return c === 0x20 || c === 0x9;\n  };\n\n  Unicode.isNewline = function (c: number): boolean {\n    return c === 0xa || c === 0xd;\n  };\n\n  Unicode.isWhitespace = function (c: number): boolean {\n    return Unicode.isSpace(c) || Unicode.isNewline(c);\n  };\n\n  return Unicode;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {AnyOutputSettings} from \"../output/OutputSettings\";\nimport type {Output} from \"../output/Output\";\nimport type {Display} from \"./Display\";\nimport type {Debug} from \"./Debug\";\nimport {Unicode} from \"../unicode/Unicode\";\n\n/**\n * utility functions for formatting values.\n * @public\n */\nexport const Format = (function () {\n  const Format = {} as {\n    /**\n     * The operting system specific string used to separate lines of text.\n     */\n    readonly lineSeparator: string;\n\n    /**\n     * Returns the human-readable [[Display]] string for the givem `object`,\n     * output using the given `settings`. Delegates to [[Display.displa]],\n     * if `object` implements `Display`; otherwise returns the result of\n     * `Object.toString`.\n     */\n    display(object: unknown, settings?: AnyOutputSettings): string;\n\n    /**\n     * Returns the developer-readable [[Debug]] string for the givem `object`,\n     * output using the given `settings`. Delegates to [[Debug.debug]], if\n     * `object` implements `Debug`; returns a JavaScript string literal, if\n     * `object` is a `string`, and returns a JavaScript number literal, if\n     * `object` is a `number`; otherwise returns the result of `Object.toString`.\n     */\n    debug(object: unknown, settings?: AnyOutputSettings): string;\n\n    /**\n     * Writes the code points of the human-readable [[Display]] string for the\n     * given `object` to `output`. Assumes `output` is a Unicode `Output` writer\n     * with sufficient capacity. Delegates to [[Display.display]], if `object`\n     * implements `Display`; otherwise writes the result of `Object.toString`.\n     *\n     * @returns the continuation of the `output`.\n     * @throws [[OutputException]] if the `output` exits the _cont_ state before\n     *         the full display string has been written.\n     */\n    displayAny<T>(output: Output<T>, object: unknown): Output<T>;\n\n    /**\n     * Writes the code points of the developer-readable [[Debug]] string for the\n     * given `object` to `output`. Assumes `output` is a Unicode `Output` writer\n     * with sufficient capacity. Delegates to [[Debug.debug]], if `object`\n     * implements `Debug`; writes a JavaScript string literal, if `object` is a\n     * `string`, and writes a JavaScript number literal, if `object` is a\n     * `number`; otherwise writes the result of `Object.toString`.\n     *\n     * @returns the continuation of the `output`.\n     * @throws [[OutputException]] if the `output` exits the _cont_ state before\n     *         the full debug string has been written.\n     */\n    debugAny<T>(output: Output<T>, object: unknown): Output<T>;\n\n    /**\n     * Writes the code points of the numeric string for the given `value`\n     * to `output`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    displayNumber<T>(output: Output<T>, value: number): Output<T>;\n\n    /**\n     * Writes the code points of the JavaScript numeric literal for the given\n     * `value` to `output`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    debugNumber<T>(output: Output<T>, value: number): Output<T>;\n\n    /**\n     * Writes the code points of the JavaScript character literal for the given\n     * `character` to `output`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    debugChar<T>(output: Output<T>, character: number): Output<T>;\n\n    /**\n     * Writes the code points of the JavaScript string literal for the given\n     * `string` to `output`.\n     *\n     * @returns the continuation of the `output`.\n     */\n    debugString<T>(output: Output<T>, string: string): Output<T>;\n\n    /** @internal */\n    encodeHex(x: number): number;\n\n    /**\n     * Returns a string representation of `value` scaled by its SI magnitude,\n     * keeping at most `precision` digits past the decimal place, appended with\n     * the appropriate SI prefix.\n     */\n    prefix(value: number, precision?: number): string;\n\n    decimal(value: number, precision?: number): string;\n\n    /** @internal */\n    trimTrailingZeros(s: string): string;\n\n    /**\n     * Returns a string representation of the duration represented by the given\n     * number of milliseconds.\n     */\n    duration(millis: number, separator?: string): string;\n  };\n\n  Object.defineProperty(Format, \"lineSeparator\", {\n    value: \"\\n\",\n    enumerable: true,\n    configurable: true,\n  });\n  import(\"os\").then((os: typeof import(\"os\")): void => {\n    Object.defineProperty(Format, \"lineSeparator\", {\n      value: os.EOL,\n      enumerable: true,\n      configurable: true,\n    });\n  }, (reason: unknown): void => {\n    // nop\n  });\n\n  Format.display = function (object: unknown, settings?: AnyOutputSettings): string {\n    if (object === void 0) {\n      return \"undefined\";\n    } else if (object === null) {\n      return \"null\";\n    } else if (typeof object === \"number\") {\n      return \"\" + object;\n    } else if (typeof object === \"string\") {\n      return object;\n    } else if (typeof (object as Display).display === \"function\") {\n      let output = Unicode.stringOutput(settings);\n      output = (object as Display).display(output);\n      return output.bind();\n    } else {\n      return \"\" + object;\n    }\n  };\n\n  Format.debug = function (object: unknown, settings?: AnyOutputSettings): string {\n    if (object === void 0) {\n      return \"undefined\";\n    } else if (object === null) {\n      return \"null\";\n    } else if (typeof object === \"number\") {\n      return \"\" + object;\n    } else if (typeof object === \"string\") {\n      let output = Unicode.stringOutput(settings);\n      output = Format.debugString(output, object);\n      return output.bind();\n    } else if (typeof (object as Debug).debug === \"function\") {\n      let output = Unicode.stringOutput(settings);\n      output = (object as Debug).debug(output);\n      return output.bind();\n    } else {\n      return \"\" + object;\n    }\n  };\n\n  Format.displayAny = function <T>(output: Output<T>, object: unknown): Output<T> {\n    if (object === void 0) {\n      output = output.write(\"undefined\");\n    } else if (object === null) {\n      output = output.write(\"null\");\n    } else if (typeof object === \"number\") {\n      output = Format.displayNumber(output, object);\n    } else if (typeof object === \"string\") {\n      output = output.write(object);\n    } else if (typeof (object as Display).display === \"function\") {\n      output = (object as Display).display(output);\n    } else {\n      output = output.write(\"\" + object);\n    }\n    return output;\n  };\n\n  Format.debugAny = function <T>(output: Output<T>, object: unknown): Output<T> {\n    if (object === void 0) {\n      output = output.write(\"undefined\");\n    } else if (object === null) {\n      output = output.write(\"null\");\n    } else if (typeof object === \"number\") {\n      output = Format.debugNumber(output, object);\n    } else if (typeof object === \"string\") {\n      output = Format.debugString(output, object);\n    } else if (typeof (object as Debug).debug === \"function\") {\n      output = (object as Debug).debug(output);\n    } else {\n      output = output.write(\"\" + object);\n    }\n    return output;\n  };\n\n  Format.displayNumber = function <T>(output: Output<T>, value: number): Output<T> {\n    if (isFinite(value) && Math.floor(value) === value && Math.abs(value) < 2147483648) {\n      if (value < 0) {\n        output = output.write(45/*'-'*/);\n      }\n      if (value > -10 && value < 10) {\n        output = output.write(48/*'0'*/ + Math.abs(value));\n      } else {\n        const digits = new Array<number>(19);\n        let x = value;\n        let i = 18;\n        while (x !== 0) {\n          digits[i] = Math.abs((x % 10) | 0);\n          x = (x / 10) | 0;\n          i -= 1;\n        }\n        i += 1;\n        while (i < 19) {\n          output = output.write(48/*'0'*/ + digits[i]!);\n          i += 1;\n        }\n      }\n    } else {\n      output = output.write(Format.decimal(value, output.settings.precision));\n    }\n    return output;\n  };\n\n  Format.debugNumber = function <T>(output: Output<T>, value: number): Output<T> {\n    return Format.displayNumber(output, value);\n  };\n\n  Format.debugChar = function <T>(output: Output<T>, value: number): Output<T> {\n    output = output.write(39/*'\\''*/);\n    switch (value) {\n      case 8/*'\\b'*/: output.write(92/*'\\\\'*/).write(98/*'b'*/); break;\n      case 9/*'\\t'*/: output.write(92/*'\\\\'*/).write(116/*'t'*/); break;\n      case 10/*'\\n'*/: output.write(92/*'\\\\'*/).write(110/*'n'*/); break;\n      case 12/*'\\f'*/: output.write(92/*'\\\\'*/).write(102/*'f'*/); break;\n      case 13/*'\\r'*/: output.write(92/*'\\\\'*/).write(114/*'r'*/); break;\n      case 34/*'\\\"'*/: output.write(92/*'\\\\'*/).write(34/*'\\\"'*/); break;\n      case 39/*'\\\"'*/: output.write(92/*'\\\\'*/).write(39/*'\\''*/); break;\n      case 92/*'\\\\'*/: output.write(92/*'\\\\'*/).write(92/*'\\\\'*/); break;\n      default:\n        if (value >= 0x0000 && value <= 0x001f || value >= 0x007f && value <= 0x009f) {\n          output = output.write(92/*'\\\\'*/).write(117/*'u'*/)\n                         .write(Format.encodeHex(value >>> 12 & 0xf))\n                         .write(Format.encodeHex(value >>>  8 & 0xf))\n                         .write(Format.encodeHex(value >>>  4 & 0xf))\n                         .write(Format.encodeHex(value        & 0xf));\n        } else {\n          output = output.write(value);\n        }\n    }\n    output = output.write(39/*'\\''*/);\n    return output;\n  };\n\n  Format.debugString = function <T>(output: Output<T>, string: string): Output<T> {\n    output = output.write(34/*'\\\"'*/);\n    let input = Unicode.stringInput(string);\n    while (input.isCont()) {\n      const c = input.head();\n      switch (c) {\n        case 8/*'\\b'*/: output.write(92/*'\\\\'*/).write(98/*'b'*/); break;\n        case 9/*'\\t'*/: output.write(92/*'\\\\'*/).write(116/*'t'*/); break;\n        case 10/*'\\n'*/: output.write(92/*'\\\\'*/).write(110/*'n'*/); break;\n        case 12/*'\\f'*/: output.write(92/*'\\\\'*/).write(102/*'f'*/); break;\n        case 13/*'\\r'*/: output.write(92/*'\\\\'*/).write(114/*'r'*/); break;\n        case 34/*'\\\"'*/: output.write(92/*'\\\\'*/).write(34/*'\\\"'*/); break;\n        case 92/*'\\\\'*/: output.write(92/*'\\\\'*/).write(92/*'\\\\'*/); break;\n        default:\n          if (c >= 0x0000 && c <= 0x001f || c >= 0x007f && c <= 0x009f) {\n            output = output.write(92/*'\\\\'*/).write(117/*'u'*/)\n                           .write(Format.encodeHex(c >>> 12 & 0xf))\n                           .write(Format.encodeHex(c >>>  8 & 0xf))\n                           .write(Format.encodeHex(c >>>  4 & 0xf))\n                           .write(Format.encodeHex(c        & 0xf));\n          } else {\n            output = output.write(c);\n          }\n      }\n      input = input.step();\n    }\n    output = output.write(34/*'\\\"'*/);\n    return output;\n  };\n\n  Format.encodeHex = function (x: number): number {\n    if (x < 10) {\n      return 48/*'0'*/ + x;\n    } else {\n      return 65/*'A'*/ + (x - 10);\n    }\n  };\n\n  Format.prefix = (function () {\n    const prefixes: ReadonlyArray<string> = [\"y\", \"z\", \"a\", \"f\", \"p\", \"n\", \"µ\", \"m\", \"\", \"k\", \"M\", \"G\", \"T\", \"P\", \"E\",\" Z\", \"Y\"];\n    return function (value: number, precision: number = 1): string {\n      if (isFinite(value)) {\n        const exponential = Math.abs(value).toExponential();\n        const exponentIndex = exponential.indexOf(\"e\");\n        const exponent = exponentIndex >= 0 ? +exponential.slice(exponentIndex + 1) : NaN;\n        const power = Math.min(Math.max(-8, Math.floor(exponent / 3)), 8) * 3;\n        const scaled = Math.pow(10, -power) * value;\n        let s = Format.trimTrailingZeros(Math.abs(scaled).toFixed(precision));\n        if (scaled < 0 && +s !== 0) {\n          s = \"-\" + s;\n        }\n        s += prefixes[8 + power / 3];\n        return s;\n      } else {\n        return \"\" + value;\n      }\n    }\n  })();\n\n  Format.decimal = function (value: number, precision: number = -1): string {\n    if (precision >= 0) {\n      let s = Format.trimTrailingZeros(Math.abs(value).toFixed(precision));\n      if (value < 0 && +s !== 0) {\n        s = \"-\" + s;\n      }\n      return s;\n    } else {\n      return \"\" + value;\n    }\n  };\n\n  Format.trimTrailingZeros = function (s: string): string {\n    let i0 = -1;\n    let i1: number | undefined;\n    for (let i = 1, n = s.length; i < n; i += 1) {\n      const c = s.charCodeAt(i);\n      if (c === 46/*'.'*/) {\n        i0 = i; // candidate start of trailing zeros\n        i1 = i; // candidate end of trailing zeros\n      } else if (c === 48/*'0'*/) {\n        if (i0 === 0) { // if after decimal\n          i0 = i; // new candidate start of trailing zeros\n        }\n        i1 = i; // new candidate end of trailing zeros\n      } else if (c >= 49/*'1'*/ && c <= 57/*'9'*/) {\n        if (i0 > 0) { // if non-zero digit after decimal\n          i0 = 0; // no candidate start of trailing zeros\n        }\n      } else if (i0 > 0) { // if non-numeric character after decimal\n        break; // accept current range of trailing zeros\n      }\n    }\n    if (i0 > 0) {\n      s = s.slice(0, i0) + s.slice(i1! + 1); // cut out trailing zeros\n    }\n    return s;\n  };\n\n  Format.duration = function (millis: number, separator: string = \" \"): string {\n    if (isFinite(millis)) {\n      const SECOND = 1000;\n      const MINUTE = 60 * SECOND;\n      const HOUR = 60 * MINUTE;\n      const DAY = 24 * HOUR;\n      const WEEK = 7 * DAY;\n      let weeks: number | undefined;\n      if (millis > WEEK) {\n        weeks = Math.floor(millis / WEEK);\n        millis %= WEEK;\n      }\n      let days: number | undefined;\n      if (millis > DAY) {\n        days = Math.floor(millis / DAY);\n        millis %= DAY;\n      }\n      let hours: number | undefined;\n      if (millis > HOUR) {\n        hours = Math.floor(millis / HOUR);\n        millis %= HOUR;\n      }\n      let minutes: number | undefined;\n      if (millis > MINUTE) {\n        minutes = Math.floor(millis / MINUTE);\n        millis %= MINUTE;\n      }\n      let seconds: number | undefined;\n      if (millis > SECOND) {\n        seconds = Math.floor(millis / SECOND);\n        millis %= SECOND;\n      }\n      let s = \"\";\n      if (weeks !== void 0) {\n        s += weeks + \"w\";\n      }\n      if (days !== void 0) {\n        s += (s.length !== 0 ? separator : \"\") + days + \"d\";\n      }\n      if (hours !== void 0) {\n        s += (s.length !== 0 ? separator : \"\") + hours + \"h\";\n      }\n      if (minutes !== void 0) {\n        s += (s.length !== 0 ? separator : \"\") + minutes + \"m\";\n      }\n      if (seconds !== void 0 || millis === 0) {\n        s += (s.length !== 0 ? separator : \"\") + (seconds !== void 0 ? seconds : 0) + \"s\";\n      }\n      if (millis !== 0 && s.length === 0) {\n        s += millis + \"ms\";\n      }\n      return s;\n    } else {\n      return \"\" + millis;\n    }\n  };\n\n  return Format;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input} from \"../input/Input\";\nimport type {Output} from \"../output/Output\";\nimport type {Parser} from \"../parser/Parser\";\nimport type {Writer} from \"../writer/Writer\";\nimport {Format} from \"../format/Format\";\nimport {Unicode} from \"../unicode/Unicode\";\nimport {Base10NumberParser} from \"../\"; // forward import\nimport {Base10IntegerWriter} from \"../\"; // forward import\n\n/**\n * Base-10 (decimal) encoding [[Parser]]/[[Writer]] factory.\n * @public\n */\nexport const Base10 = (function () {\n  const Base10 = {} as {\n    /**\n     * Returns `true` if the Unicode code point `c` is a valid base-10 digit.\n     */\n    isDigit(c: number): boolean;\n\n    /**\n     * Returns the decimal quantity between `0` (inclusive) and `10` (exclusive)\n     * represented by the base-10 digit `c`.\n     *\n     * @throws `Error` if `c` is not a valid base-10 digit.\n     */\n    decodeDigit(c: number): number;\n\n    /**\n     * Returns the Unicode code point of the base-10 digit that encodes the given\n     * decimal quantity between `0` (inclusive) and `10` (exclusive).\n     */\n    encodeDigit(b: number): number;\n\n    /**\n     * Returns the number of whole decimal digits in the given absolute `value`.\n     */\n    countDigits(value: number): number;\n\n    integerParser(): Parser<number>;\n\n    parseInteger(input: Input): Parser<number>;\n\n    decimalParser(): Parser<number>;\n\n    parseDecimal(input: Input): Parser<number>;\n\n    numberParser(): Parser<number>;\n\n    parseNumber(input: Input): Parser<number>;\n\n    /**\n     * Returns a `Writer` that, when fed an input `number` value, returns a\n     * continuation that writes the base-10 (decimal) encoding of the input value.\n     */\n    integerWriter(): Writer<number, unknown>;\n\n    /**\n     * Returns a `Writer` continuation that writes the base-10 (decimal) encoding\n     * of the `input` value.\n     */\n    integerWriter(input: number): Writer<unknown, number>;\n\n    /**\n     * Writes the base-10 (decimal) encoding of the `input` value to the `output`,\n     * returning a `Writer` continuation that knows how to write any remaining\n     * output that couldn't be immediately generated.\n     */\n    writeInteger(output: Output, input: number): Writer;\n  };\n\n  Base10.isDigit = function (c: number): boolean {\n    return c >= 48/*'0'*/ && c <= 57/*'9'*/;\n  };\n\n  Base10.decodeDigit = function (c: number): number {\n    if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n      return c - 48/*'0'*/;\n    } else {\n      let message = Unicode.stringOutput();\n      message = message.write(\"Invalid base-10 digit: \");\n      message = Format.debugChar(message, c);\n      throw new Error(message.bind());\n    }\n  };\n\n  Base10.encodeDigit = function (b: number): number {\n    if (b >= 0 && b <= 9) {\n      return 48/*'0'*/ + b;\n    } else {\n      throw new Error(\"\" + b);\n    }\n  };\n\n  Base10.countDigits = function (value: number): number {\n    let size = 0;\n    do {\n      size += 1;\n      value = (value / 10) | 0;\n    } while (value !== 0);\n    return size;\n  };\n\n  Base10.integerParser = function (): Parser<number> {\n    return new Base10NumberParser(void 0, void 0, 0);\n  };\n\n  Base10.parseInteger = function (input: Input): Parser<number> {\n    return Base10NumberParser.parse(input, void 0, void 0, 0);\n  };\n\n  Base10.decimalParser = function (): Parser<number> {\n    return new Base10NumberParser(void 0, void 0, 1);\n  };\n\n  Base10.parseDecimal = function (input: Input): Parser<number> {\n    return Base10NumberParser.parse(input, void 0, void 0, 1);\n  };\n\n  Base10.numberParser = function (): Parser<number> {\n    return new Base10NumberParser();\n  };\n\n  Base10.parseNumber = function (input: Input): Parser<number> {\n    return Base10NumberParser.parse(input);\n  };\n\n  Base10.integerWriter = function (input?: number): Writer {\n    if (input === void 0) {\n      return new Base10IntegerWriter(void 0, 0);\n    } else {\n      return new Base10IntegerWriter(void 0, input);\n    }\n  } as typeof Base10.integerWriter;\n\n  Base10.writeInteger = function (output: Output, input: number): Writer {\n    return Base10IntegerWriter.write(output, void 0, input);\n  };\n\n  return Base10;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Values, Severity} from \"@swim/util\";\nimport type {Tag} from \"./Tag\";\nimport type {Mark} from \"./Mark\";\nimport type {Input} from \"../input/Input\";\nimport type {OutputSettings} from \"../output/OutputSettings\";\nimport type {Output} from \"../output/Output\";\nimport type {Display} from \"../format/Display\";\nimport {OutputStyle} from \"../format/OutputStyle\";\nimport {Format} from \"../format/Format\";\nimport {Unicode} from \"../unicode/Unicode\";\nimport {Base10} from \"../number/Base10\";\n\n/**\n * Informational message attached to an input location.\n * @public\n */\nexport class Diagnostic implements Display {\n  constructor(input: Input, tag: Tag, severity: Severity, message: string | undefined,\n              note: string | undefined, cause: Diagnostic | null) {\n    this.input = input;\n    this.tag = tag;\n    this.severity = severity;\n    this.message = message;\n    this.note = note;\n    this.cause = cause;\n  }\n\n  /** @internal */\n  readonly input: Input;\n\n  /**\n   * The location in the `input` to which this diagnostic is attached.\n   */\n  readonly tag: Tag;\n\n  /**\n   * The level of importance of this diagnostic.\n   */\n  readonly severity: Severity;\n\n  /**\n   * The help message that describes this diagnostic.\n   */\n  readonly message: string | undefined;\n\n  /**\n   * An informative comment on the source context to which this diagnostic is attached.\n   */\n  readonly note: string | undefined;\n\n  /**\n   * The `Diagnostic` cause of this diagnostic, forming a linked chain of\n   * diagnostics, or `null` if this diagnostic has no cause.\n   */\n  readonly cause: Diagnostic | null;\n\n  private lineDigits(): number {\n    let digits = Base10.countDigits(this.tag.end.line);\n    if (this.cause !== null) {\n      digits = Math.max(digits, this.cause.lineDigits());\n    }\n    return digits;\n  }\n\n  display<T>(output: Output<T>): Output<T> {\n    const input = this.input.clone();\n    const start = this.tag.start;\n    const end = this.tag.end;\n    const severity = this.severity;\n    const message = this.message;\n    const note = this.note;\n    const cause = this.cause;\n    const contextLines = 2;\n    const lineDigits = this.lineDigits();\n    output = Diagnostic.display(output, input, start, end, severity, message,\n                                note, cause, contextLines, lineDigits);\n    return output;\n  }\n\n\n  private static display<T>(output: Output<T>, input: Input, start: Mark, end: Mark,\n                            severity: Severity, message: string | undefined,\n                            note: string | undefined, cause: Diagnostic | null,\n                            contextLines: number, lineDigits: number): Output<T> {\n    do {\n      if (message !== void 0) {\n        output = Diagnostic.displayMessage(output, severity, message);\n        output = output.writeln();\n      }\n      output = Diagnostic.displayAnchor(output, input, start, lineDigits);\n      output = output.writeln();\n      const cont = Diagnostic.displayContext(output, input, start, end, severity,\n                                             note, cause, contextLines, lineDigits);\n      const next = cont[0];\n      output = cont[1];\n      if (next !== null) {\n        output = output.writeln();\n        input = next.input.clone();\n        start = next.tag.start;\n        end = next.tag.end;\n        severity = next.severity;\n        message = next.message;\n        note = next.note;\n        cause = next.cause;\n      } else {\n        break;\n      }\n    } while (true);\n    return output;\n  }\n\n  /** @internal */\n  static displayMessage<T>(output: Output<T>, severity: Severity, message: string | undefined): Output<T> {\n    output = Diagnostic.formatSeverity(output, severity);\n    output = output.write(severity.label);\n    output = OutputStyle.reset(output);\n    output = OutputStyle.bold(output);\n    output = output.write(58/*':'*/);\n    if (message !== void 0) {\n      output = output.write(32/*' '*/).write(message);\n    }\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayAnchor<T>(output: Output<T>, input: Input,\n                                  start: Mark, lineDigits: number): Output<T> {\n    output = Diagnostic.displayLineLeadArrow(output, lineDigits);\n    output = output.write(32/*' '*/);\n    const id = input.id;\n    if (id !== void 0) {\n      output = Format.displayAny(output, id);\n    }\n    output = output.write(58/*':'*/);\n    output = Format.displayNumber(output, start.line);\n    output = output.write(58/*':'*/);\n    output = Format.displayNumber(output, start.column);\n    output = output.writeln();\n\n    output = Diagnostic.displayLineLead(output, lineDigits);\n    return output;\n  }\n\n  private static displayContext<T>(output: Output<T>, input: Input, start: Mark, end: Mark,\n                                   severity: Severity, note: string | undefined,\n                                   cause: Diagnostic | null, contextLines: number,\n                                   lineDigits: number): [Diagnostic | null, Output<T>] {\n    let next = cause;\n    const sameCause = cause !== null && cause.message === void 0\n                   && Values.equal(input.id, cause.input.id);\n    const causeOrder = sameCause ? (start.offset <= cause!.tag.start.offset ? -1 : 1) : 0;\n    if (causeOrder === 1) {\n      const cont = Diagnostic.displayContext(output, cause!.input.clone(), cause!.tag.start,\n                                             cause!.tag.end, cause!.severity, cause!.note,\n                                             cause!.cause, contextLines, lineDigits);\n      next = cont[0];\n      output = cont[1];\n      output = output.writeln();\n      output = Diagnostic.displayLineLeadEllipsis(output, lineDigits);\n      output = output.writeln();\n    }\n    output = Diagnostic.displayLines(output, input, start, end, severity, contextLines, lineDigits);\n    if (note !== void 0) {\n      output = Diagnostic.displayNote(output, note, lineDigits);\n    }\n    if (causeOrder === -1) {\n      output = output.writeln();\n      output = Diagnostic.displayLineLeadEllipsis(output, lineDigits);\n      output = output.writeln();\n      const cont = Diagnostic.displayContext(output, cause!.input.clone(), cause!.tag.start,\n                                             cause!.tag.end, cause!.severity, cause!.note,\n                                             cause!.cause, contextLines, lineDigits);\n      next = cont[0];\n      output = cont[1];\n    }\n    return [next, output];\n  }\n\n  private static displayLines<T>(output: Output<T>, input: Input, start: Mark, end: Mark,\n                                 severity: Severity, contextLines: number,\n                                 lineDigits: number): Output<T> {\n    const startLine = start.line;\n    const endLine = end.line;\n    let line = input.line;\n\n    while (line < startLine) {\n      Diagnostic.consumeLineText(input, line);\n      line += 1;\n    }\n\n    if (endLine - startLine > 2 * contextLines + 2) {\n      while (line <= startLine + contextLines) {\n        output = Diagnostic.displayLine(output, input, start, end, severity, line, lineDigits);\n        line += 1;\n      }\n      output = Diagnostic.displayLineLeadEllipsis(output, lineDigits);\n      output = output.write(32/*' '*/);\n      output = Diagnostic.formatSeverity(output, severity);\n      output = output.write(124/*'|'*/);\n      output = OutputStyle.reset(output);\n      output = output.writeln();\n      while (line < endLine - contextLines) {\n        Diagnostic.consumeLineText(input, line);\n        line += 1;\n      }\n    }\n\n    while (line <= endLine) {\n      output = Diagnostic.displayLine(output, input, start, end, severity, line, lineDigits);\n      line += 1;\n    }\n    return output;\n  }\n\n  private static displayNote<T>(output: Output<T>, note: string | undefined, lineDigits: number): Output<T> {\n    output = output.writeln();\n    output = Diagnostic.displayLineLead(output, lineDigits);\n    output = output.writeln();\n    output = Diagnostic.displayLineComment(output, 'note', note, lineDigits);\n    return output;\n  }\n\n  private static displayLine<T>(output: Output<T>, input: Input, start: Mark, end: Mark,\n                                severity: Severity, line: number, lineDigits: number): Output<T> {\n    if (start.line === line && end.line === line) {\n      output = Diagnostic.displaySingleLine(output, input, start, end, severity, line, lineDigits);\n    } else if (start.line === line) {\n      output = Diagnostic.displayStartLine(output, input, start, severity, line, lineDigits);\n    } else if (end.line === line) {\n      output = Diagnostic.displayEndLine(output, input, end, severity, line, lineDigits);\n    } else {\n      output = Diagnostic.displayMidLine(output, input, severity, line, lineDigits);\n    }\n    return output;\n  }\n\n  private static displaySingleLine<T>(output: Output<T>, input: Input, start: Mark, end: Mark,\n                                      severity: Severity, line: number, lineDigits: number): Output<T> {\n    output = Diagnostic.displayLineLeadNumber(output, line, lineDigits);\n    output = output.write(32/*' '*/);\n    for (let i = 1; i < input.column; i += 1) {\n      output = output.write(32/*' '*/);\n    }\n    output = Diagnostic.displayLineText(output, input, line);\n\n    output = Diagnostic.displayLineLead(output, lineDigits);\n    output = output.write(32/*' '*/);\n    let i = 1;\n    while (i < start.column) {\n      output = output.write(32/*' '*/);\n      i += 1;\n    }\n    output = Diagnostic.formatSeverity(output, severity);\n    while (i <= end.column) {\n      output = output.write(94/*'^'*/);\n      i += 1;\n    }\n    if (end.note !== void 0) {\n      output = output.write(32/*' '*/).write(end.note);\n    }\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayStartLine<T>(output: Output<T>, input: Input, start: Mark,\n                                     severity: Severity, line: number, lineDigits: number): Output<T> {\n    output = Diagnostic.displayLineLeadNumber(output, line, lineDigits);\n    output = output.write(32/*' '*/).write(32/*' '*/).write(32/*' '*/);\n    for (let i = 1; i < input.column; i += 1) {\n      output = output.write(32/*' '*/);\n    }\n    output = Diagnostic.displayLineText(output, input, line);\n\n    output = Diagnostic.displayLineLead(output, lineDigits);\n    output = output.write(32/*' '*/).write(32/*' '*/);\n    output = Diagnostic.formatSeverity(output, severity);\n    output = output.write(95/*'_'*/);\n    let i = 1;\n    while (i < start.column) {\n      output = output.write(95/*'_'*/);\n      i += 1;\n    }\n    output = output.write(94/*'^'*/);\n    if (start.note !== void 0) {\n      output = output.write(32/*' '*/).write(start.note);\n    }\n    output = OutputStyle.reset(output);\n    output = output.writeln();\n    return output;\n  }\n\n  private static displayEndLine<T>(output: Output<T>, input: Input, end: Mark,\n                                   severity: Severity, line: number, lineDigits: number): Output<T> {\n    output = Diagnostic.displayLineLeadNumber(output, line, lineDigits);\n    output = output.write(32/*' '*/);\n    output = Diagnostic.formatSeverity(output, severity);\n    output = output.write(124/*'|'*/);\n    output = OutputStyle.reset(output);\n    output = output.write(32/*' '*/);\n    output = Diagnostic.displayLineText(output, input, line);\n\n    output = Diagnostic.displayLineLead(output, lineDigits);\n    output = output.write(32/*' '*/);\n    output = Diagnostic.formatSeverity(output, severity);\n    output = output.write(124/*'|'*/).write(95/*'_'*/);\n    let i = 1;\n    while (i < end.column) {\n      output = output.write(95/*'_'*/);\n      i += 1;\n    }\n    output = output.write(94/*'^'*/);\n    if (end.note !== void 0) {\n      output = output.write(32/*' '*/).write(end.note);\n    }\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayMidLine<T>(output: Output<T>, input: Input, severity: Severity,\n                                   line: number, lineDigits: number): Output<T> {\n    output = Diagnostic.displayLineLeadNumber(output, line, lineDigits);\n    output = output.write(32/*' '*/);\n    output = Diagnostic.formatSeverity(output, severity);\n    output = output.write(124/*'|'*/);\n    output = OutputStyle.reset(output);\n    output = output.write(32/*' '*/);\n    output = Diagnostic.displayLineText(output, input, line);\n    return output;\n  }\n\n  private static displayLineComment<T>(output: Output<T>, label: string,\n                                       comment: string | undefined, lineDigits: number): Output<T> {\n    output = Diagnostic.displayLineLeadComment(output, lineDigits);\n    output = output.write(32/*' '*/);\n    output = OutputStyle.bold(output);\n    output = output.write(label).write(58/*':'*/);\n    output = OutputStyle.reset(output);\n    if (comment !== void 0) {\n      output = output.write(32/*' '*/).write(comment);\n    }\n    return output;\n  }\n\n  private static displayLineLead<T>(output: Output<T>, lineDigits: number): Output<T> {\n    output = OutputStyle.blueBold(output);\n    const padding = 1 + lineDigits;\n    for (let i = 0; i < padding; i += 1) {\n      output = output.write(32/*' '*/);\n    }\n    output = output.write(124/*'|'*/);\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayLineLeadComment<T>(output: Output<T>, lineDigits: number): Output<T> {\n    output = OutputStyle.blueBold(output);\n    const padding = 1 + lineDigits;\n    for (let i = 0; i < padding; i += 1) {\n      output = output.write(32/*' '*/);\n    }\n    output = output.write(61/*'='*/);\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayLineLeadArrow<T>(output: Output<T>, lineDigits: number): Output<T> {\n    for (let i = 0; i < lineDigits; i += 1) {\n      output = output.write(32/*' '*/);\n    }\n    output = OutputStyle.blueBold(output);\n    output = output.write(45/*'-'*/).write(45/*'-'*/).write(62/*'>'*/);\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayLineLeadEllipsis<T>(output: Output<T>, lineDigits: number): Output<T> {\n    output = OutputStyle.blueBold(output);\n    for (let i = 0; i < lineDigits; i += 1) {\n      output = output.write(46/*'.'*/);\n    }\n    output = OutputStyle.reset(output);\n    output = output.write(32/*' '*/).write(32/*' '*/);\n    return output;\n  }\n\n  private static displayLineLeadNumber<T>(output: Output<T>, line: number, lineDigits: number): Output<T> {\n    const padding = lineDigits - Base10.countDigits(line);\n    for (let i = 0; i < padding; i += 1) {\n      output = output.write(32/*' '*/);\n    }\n    output = OutputStyle.blueBold(output);\n    output = Format.displayNumber(output, line);\n    output = output.write(32/*' '*/).write(124/*'|'*/);\n    output = OutputStyle.reset(output);\n    return output;\n  }\n\n  private static displayLineText<T>(output: Output<T>, input: Input, line: number): Output<T> {\n    while (input.isCont() && input.line === line) {\n      output = output.write(input.head());\n      input = input.step();\n    }\n    if (input.line === line) {\n      output = output.writeln();\n    }\n    return output;\n  }\n\n  private static consumeLineText(input: Input, line: number): void {\n    while (input.isCont() && input.line === line) {\n      input = input.step();\n    }\n  }\n\n  private static formatSeverity<T>(output: Output<T>, severity: Severity): Output<T> {\n    switch (severity.level) {\n      case Severity.FATAL_LEVEL:\n      case Severity.ALERT_LEVEL:\n      case Severity.ERROR_LEVEL:\n        output = OutputStyle.redBold(output);\n        break;\n      case Severity.WARNING_LEVEL:\n        output = OutputStyle.yellowBold(output);\n        break;\n      case Severity.NOTE_LEVEL:\n        output = OutputStyle.greenBold(output);\n        break;\n      case Severity.INFO_LEVEL:\n        output = OutputStyle.cyanBold(output);\n        break;\n      case Severity.DEBUG_LEVEL:\n      case Severity.TRACE_LEVEL:\n      default:\n        output = OutputStyle.magentaBold(output);\n    }\n    return output;\n  }\n\n  toString(settings?: OutputSettings): string {\n    return Format.display(this, settings);\n  }\n\n  static create(input: Input, tag: Tag, severity: Severity, cause?: Diagnostic | null): Diagnostic;\n  static create(input: Input, tag: Tag, severity: Severity, message: string | undefined,\n                cause?: Diagnostic | null): Diagnostic;\n  static create(input: Input, tag: Tag, severity: Severity, message: string | undefined,\n                note: string | undefined, cause?: Diagnostic | null): Diagnostic;\n  static create(input: Input, tag: Tag, severity: Severity, message?: Diagnostic | null | string | undefined,\n                note?: Diagnostic | null | string | undefined, cause?: Diagnostic | null): Diagnostic {\n    if (arguments.length === 3) { // (input, tag, severity)\n      cause = null;\n      note = void 0;\n      message = void 0;\n    } else if (arguments.length === 4) {\n      if (message === null || message instanceof Diagnostic) { // (input, tag, severity, cause)\n        cause = message;\n        message = void 0;\n      } else { // (input, tag, severity, message)\n        cause = null;\n      }\n    } else if (arguments.length === 5) {\n      if (note === null || note instanceof Diagnostic) { // (input, tag, severity, message, cause)\n        cause = note;\n        note = void 0;\n      } else { // (input, tag, severity, message, note)\n        cause = null;\n      }\n    } else { // (input, tag, severity, message, note, cause)\n      if (cause === void 0) {\n        cause = null;\n      }\n    }\n    return new Diagnostic(input.clone(), tag, severity, message as string | undefined, note as string | undefined, cause);\n  }\n\n  static message(message: string, input: Input, cause?: Diagnostic | null): Diagnostic;\n  static message(message: string, input: Input, note: string, cause?: Diagnostic | null): Diagnostic;\n  static message(message: string, input: Input, severity: Severity, cause?: Diagnostic | null): Diagnostic;\n  static message(message: string, input: Input, severity?: Severity, note?: string, cause?: Diagnostic | null): Diagnostic;\n  static message(message: string, input: Input, severity?: Diagnostic | null | Severity | string | undefined,\n                 note?: Diagnostic | null | string | undefined, cause?: Diagnostic | null): Diagnostic {\n    if (arguments.length === 2) { // (message, input)\n      cause = null;\n      note = void 0;\n      severity = Severity.error();\n    } else if (arguments.length === 3) {\n      if (severity === null || severity instanceof Diagnostic) { // (message, input, cause)\n        cause = severity;\n        severity = Severity.error();\n      } else if (typeof severity === \"string\") { // (message, input, note)\n        cause = null;\n        note = severity;\n        severity = Severity.error();\n      } else { // (message, input, severity)\n        cause = null;\n      }\n    } else if (arguments.length === 4) {\n      if (typeof severity === \"string\") { // (message, input, note, cause)\n        cause = note as Diagnostic | null;\n        note = severity;\n        severity = Severity.error();\n      } else if (note === null || note instanceof Diagnostic) { // (message, input, severity, cause)\n        cause = note;\n        note = void 0;\n      } else { // (message, input, severity, note)\n        cause = null;\n      }\n    } else { // (message, input, severity, note, cause)\n      if (cause === void 0) {\n        cause = null;\n      }\n    }\n\n    const mark = input.mark;\n    const source = input.clone();\n    source.seek();\n    return new Diagnostic(source, mark, severity as Severity, message, note as string | undefined, cause);\n  }\n\n  static unexpected(input: Input, cause?: Diagnostic | null): Diagnostic;\n  static unexpected(input: Input, note: string, cause?: Diagnostic | null): Diagnostic;\n  static unexpected(input: Input, severity: Severity, cause?: Diagnostic | null): Diagnostic;\n  static unexpected(input: Input, severity?: Severity, note?: string, cause?: Diagnostic | null): Diagnostic;\n  static unexpected(input: Input, severity?: Diagnostic | null | Severity | string | undefined,\n                    note?: Diagnostic | null | string | undefined, cause?: Diagnostic | null): Diagnostic {\n    if (arguments.length === 1) { // (input)\n      cause = null;\n      severity = Severity.error();\n    } else if (arguments.length === 2) {\n      if (severity === null || severity instanceof Diagnostic) { // (input, cause)\n        cause = severity;\n        severity = Severity.error();\n      } else if (typeof severity === \"string\") { // (input, note)\n        cause = null;\n        note = severity;\n        severity = Severity.error();\n      } else { // (input, severity)\n        cause = null;\n      }\n    } else if (arguments.length === 3) {\n      if (typeof severity === \"string\") { // (input, note, cause)\n        cause = note as Diagnostic | null;\n        note = severity;\n        severity = Severity.error();\n      } else if (note === null || note instanceof Diagnostic) { // (input, severity, cause)\n        cause = note;\n        note = void 0;\n      } else { // (input, severity, note)\n        cause = null;\n      }\n    } else { // (input, severity, note, cause)\n      if (cause === void 0) {\n        cause = null;\n      }\n    }\n\n    let message;\n    if (input.isCont()) {\n      let output = Unicode.stringOutput().write(\"unexpected\").write(32/*' '*/);\n      output = Format.debugChar(output, input.head());\n      message = output.bind();\n    } else {\n      message = \"unexpected end of input\";\n    }\n    const mark = input.mark;\n    const source = input.clone();\n    source.seek();\n    return new Diagnostic(source, mark, severity as Severity, message, note as string | undefined, cause);\n  }\n\n  static expected(expected: string | number, input: Input, cause?: Diagnostic | null): Diagnostic;\n  static expected(expected: string | number, input: Input, note: string, cause?: Diagnostic | null): Diagnostic;\n  static expected(expected: string | number, input: Input, severity: Severity, cause?: Diagnostic | null): Diagnostic;\n  static expected(expected: string | number, input: Input, severity?: Severity, note?: string, cause?: Diagnostic | null): Diagnostic;\n  static expected(expected: string | number, input: Input, severity?: Diagnostic | null | Severity | string | undefined,\n                  note?: Diagnostic | null | string | undefined, cause?: Diagnostic | null): Diagnostic {\n    if (arguments.length === 2) { // (excpected, input)\n      cause = null;\n      severity = Severity.error();\n    } else if (arguments.length === 3) {\n      if (severity === null || severity instanceof Diagnostic) { // (excpected, input, cause)\n        cause = severity;\n        severity = Severity.error();\n      } else if (typeof severity === \"string\") { // (excpected, input, note)\n        cause = null;\n        note = severity;\n        severity = Severity.error();\n      } else { // (expected, input, severity)\n        cause = null;\n      }\n    } else if (arguments.length === 4) {\n      if (typeof severity === \"string\") { // (excpected, input, note, cause)\n        cause = note as Diagnostic | null;\n        note = severity;\n        severity = Severity.error();\n      } else if (note === null || note instanceof Diagnostic) { // (excpected, input, severity, cause)\n        cause = note;\n        note = void 0;\n      } else { // (excpected, input, severity, note)\n        cause = null;\n      }\n    } else { // (excpected, input, severity, note, cause)\n      if (cause === void 0) {\n        cause = null;\n      }\n    }\n\n    let output = Unicode.stringOutput().write(\"expected\").write(32/*' '*/);\n    if (typeof expected === \"number\") {\n      output = Format.debugChar(output, expected);\n    } else {\n      output = output.write(expected);\n    }\n    output = output.write(44/*','*/).write(32/*' '*/).write(\"but found\").write(32/*' '*/);\n    if (input.isCont()) {\n      output = Format.debugChar(output, input.head());\n    } else {\n      output = output.write(\"end of input\");\n    }\n    const message = output.bind();\n    const mark = input.mark;\n    const source = input.clone();\n    source.seek();\n    return new Diagnostic(source, mark, severity as Severity, message, note as string | undefined, cause);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {Input} from \"./Input\";\nimport {InputDone} from \"../\"; // forward import\nimport {InputError} from \"../\"; // forward import\n\n/** @internal */\nexport class InputEmpty extends Input {\n  constructor(id: string | undefined, mark: Mark, settings: InputSettings) {\n    super();\n    Object.defineProperty(this, \"id\", {\n      value: id,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"mark\", {\n      value: mark,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return true;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return true;\n  }\n\n  override asPart(part: boolean): Input {\n    return part ? this : new InputDone(this.id, this.mark, this.settings);\n  }\n\n  override head(): number {\n    throw new InputException();\n  }\n\n  override step(): Input {\n    const error = new InputException(\"empty step\");\n    return new InputError(error, this.id, this.mark, this.settings);\n  }\n\n  override seek(mark?: Mark): Input {\n    const error = new InputException(\"empty seek\");\n    return new InputError(error, this.id, this.mark, this.settings);\n  }\n\n  override readonly id!: string | undefined;\n\n  override withId(id: string | undefined): Input {\n    return new InputEmpty(id, this.mark, this.settings);\n  }\n\n  override readonly mark!: Mark;\n\n  override withMark(mark: Mark): Input {\n    return new InputEmpty(this.id, mark, this.settings);\n  }\n\n  override get offset(): number {\n    return this.mark.offset;\n  }\n\n  override get line(): number {\n    return this.mark.line;\n  }\n\n  override get column(): number {\n    return this.mark.column;\n  }\n\n  override readonly settings!: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): Input {\n    settings = InputSettings.fromAny(settings);\n    return new InputEmpty(this.id, this.mark, settings);\n  }\n\n  override clone(): Input {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {Input} from \"./Input\";\nimport {InputEmpty} from \"../\"; // forward import\nimport {InputError} from \"../\"; // forward import\n\n/** @internal */\nexport class InputDone extends Input {\n  constructor(id: string | undefined, mark: Mark, settings: InputSettings) {\n    super();\n    Object.defineProperty(this, \"id\", {\n      value: id,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"mark\", {\n      value: mark,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Input {\n    return part ? new InputEmpty(this.id, this.mark, this.settings) : this;\n  }\n\n  override head(): number {\n    throw new InputException();\n  }\n\n  override step(): Input {\n    const error = new InputException(\"done step\");\n    return new InputError(error, this.id, this.mark, this.settings);\n  }\n\n  override seek(mark?: Mark): Input {\n    const error = new InputException(\"empty seek\");\n    return new InputError(error, this.id, this.mark, this.settings);\n  }\n\n  override readonly id!: string | undefined;\n\n  override withId(id: string | undefined): Input {\n    return new InputDone(id, this.mark, this.settings);\n  }\n\n  override readonly mark!: Mark;\n\n  override withMark(mark: Mark): Input {\n    return new InputDone(this.id, mark, this.settings);\n  }\n\n  override get offset(): number {\n    return this.mark.offset;\n  }\n\n  override get line(): number {\n    return this.mark.line;\n  }\n\n  override get column(): number {\n    return this.mark.column;\n  }\n\n  override readonly settings!: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): Input {\n    settings = InputSettings.fromAny(settings);\n    return new InputDone(this.id, this.mark, settings);\n  }\n\n  override clone(): Input {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {Mark} from \"../source/Mark\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {Input} from \"./Input\";\nimport {InputBufferEmpty} from \"../\"; // forward import\nimport {InputBufferDone} from \"../\"; // forward import\nimport {InputBufferError} from \"../\"; // forward import\n\n/**\n * Non-blocking token stream buffer.\n * @public\n */\nexport abstract class InputBuffer extends Input {\n  abstract override asPart(part: boolean): InputBuffer;\n\n  abstract readonly index: number;\n\n  abstract withIndex(index: number): InputBuffer;\n\n  abstract readonly limit: number;\n\n  abstract withLimit(limit: number): InputBuffer;\n\n  abstract readonly capacity: number;\n\n  abstract readonly remaining: number;\n\n  abstract has(index: number): boolean;\n\n  abstract get(index: number): number;\n\n  abstract set(index: number, token: number): void;\n\n  abstract override step(offset?: number): InputBuffer;\n\n  abstract override seek(mark: Mark): InputBuffer;\n\n  abstract override withId(id: string | undefined): InputBuffer;\n\n  abstract override withMark(mark: Mark): InputBuffer;\n\n  abstract override withSettings(settings: AnyInputSettings): InputBuffer;\n\n  abstract override clone(): InputBuffer;\n\n  /**\n   * Returns an `InputBuffer` in the _empty_ state.\n   */\n  @Lazy\n  static override empty(): InputBuffer {\n    return new InputBufferEmpty(void 0, Mark.zero, InputSettings.standard());\n  }\n\n  /**\n   * Returns an `InputBuffer` in the _done_ state.\n   */\n  @Lazy\n  static override done(): InputBuffer {\n    return new InputBufferDone(void 0, Mark.zero, InputSettings.standard());\n  }\n\n  /**\n   * Returns an `InputBuffer` in the _error_ state that traps the given `error`.\n   */\n  static override error(error: Error): InputBuffer {\n    return new InputBufferError(error, void 0, Mark.zero, InputSettings.standard());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {InputBuffer} from \"./InputBuffer\";\nimport {InputBufferDone} from \"../\"; // forward import\nimport {InputBufferError} from \"../\"; // forward import\n\n/** @internal */\nexport class InputBufferEmpty extends InputBuffer {\n  constructor(id: string | undefined, mark: Mark, settings: InputSettings) {\n    super();\n    Object.defineProperty(this, \"id\", {\n      value: id,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"mark\", {\n      value: mark,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return true;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return true;\n  }\n\n  override asPart(part: boolean): InputBuffer {\n    return part ? this : new InputBufferDone(this.id, this.mark, this.settings);\n  }\n\n  override get index(): number {\n    return 0;\n  }\n\n  override withIndex(index: number): InputBuffer {\n    if (index === 0) {\n      return this;\n    } else {\n      const error = new InputException(\"invalid index\");\n      return new InputBufferError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override get limit(): number {\n    return 0;\n  }\n\n  override withLimit(limit: number): InputBuffer {\n    if (limit === 0) {\n      return this;\n    } else {\n      const error = new InputException(\"invalid limit\");\n      return new InputBufferError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return 0;\n  }\n\n  override get remaining(): number {\n    return 0;\n  }\n\n  override has(index: number): boolean {\n    return false;\n  }\n\n  override get(index: number): number {\n    throw new InputException();\n  }\n\n  override set(index: number, token: number): void {\n    throw new InputException();\n  }\n\n  override head(): number {\n    throw new InputException();\n  }\n\n  override step(offset?: number): InputBuffer {\n    const error = new InputException(\"empty step\");\n    return new InputBufferError(error, this.id, this.mark, this.settings);\n  }\n\n  override seek(mark: Mark): InputBuffer {\n    const error = new InputException(\"empty seek\");\n    return new InputBufferError(error, this.id, this.mark, this.settings);\n  }\n\n  override readonly id!: string | undefined;\n\n  override withId(id: string | undefined): InputBuffer {\n    return new InputBufferEmpty(id, this.mark, this.settings);\n  }\n\n  override readonly mark!: Mark;\n\n  override withMark(mark: Mark): InputBuffer {\n    return new InputBufferEmpty(this.id, mark, this.settings);\n  }\n\n  override get offset(): number {\n    return this.mark.offset;\n  }\n\n  override get line(): number {\n    return this.mark.line;\n  }\n\n  override get column(): number {\n    return this.mark.column;\n  }\n\n  override readonly settings!: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): InputBuffer {\n    settings = InputSettings.fromAny(settings);\n    return new InputBufferEmpty(this.id, this.mark, settings);\n  }\n\n  override clone(): InputBuffer {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {InputBuffer} from \"./InputBuffer\";\nimport {InputBufferEmpty} from \"../\"; // forward import\nimport {InputBufferError} from \"../\"; // forward import\n\n/** @internal */\nexport class InputBufferDone extends InputBuffer {\n  constructor(id: string | undefined, mark: Mark, settings: InputSettings) {\n    super();\n    Object.defineProperty(this, \"id\", {\n      value: id,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"mark\", {\n      value: mark,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): InputBuffer {\n    return part ? new InputBufferEmpty(this.id, this.mark, this.settings) : this;\n  }\n\n  override get index(): number {\n    return 0;\n  }\n\n  override withIndex(index: number): InputBuffer {\n    if (index === 0) {\n      return this;\n    } else {\n      const error = new InputException(\"invalid index\");\n      return new InputBufferError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override get limit(): number {\n    return 0;\n  }\n\n  override withLimit(limit: number): InputBuffer {\n    if (limit === 0) {\n      return this;\n    } else {\n      const error = new InputException(\"invalid limit\");\n      return new InputBufferError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return 0;\n  }\n\n  override get remaining(): number {\n    return 0;\n  }\n\n  override has(index: number): boolean {\n    return false;\n  }\n\n  override get(index: number): number {\n    throw new InputException();\n  }\n\n  override set(index: number, token: number): void {\n    throw new InputException();\n  }\n\n  override head(): number {\n    throw new InputException();\n  }\n\n  override step(offset?: number): InputBuffer {\n    const error = new InputException(\"done step\");\n    return new InputBufferError(error, this.id, this.mark, this.settings);\n  }\n\n  override seek(mark: Mark): InputBuffer {\n    const error = new InputException(\"done seek\");\n    return new InputBufferError(error, this.id, this.mark, this.settings);\n  }\n\n  override readonly id!: string | undefined;\n\n  override withId(id: string | undefined): InputBuffer {\n    return new InputBufferDone(id, this.mark, this.settings);\n  }\n\n  override readonly mark!: Mark;\n\n  override withMark(mark: Mark): InputBuffer {\n    return new InputBufferDone(this.id, mark, this.settings);\n  }\n\n  override get offset(): number {\n    return this.mark.offset;\n  }\n\n  override get line(): number {\n    return this.mark.line;\n  }\n\n  override get column(): number {\n    return this.mark.column;\n  }\n\n  override readonly settings!: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): InputBuffer {\n    settings = InputSettings.fromAny(settings);\n    return new InputBufferDone(this.id, this.mark, settings);\n  }\n\n  override clone(): InputBuffer {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mark} from \"../source/Mark\";\nimport {InputException} from \"./InputException\";\nimport {AnyInputSettings, InputSettings} from \"./InputSettings\";\nimport {InputBuffer} from \"./InputBuffer\";\n\n/** @internal */\nexport class InputBufferError extends InputBuffer {\n  /** @internal */\n  readonly error!: Error;\n\n  constructor(error: Error, id: string | undefined, mark: Mark, settings: InputSettings) {\n    super();\n    Object.defineProperty(this, \"error\", {\n      value: error,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"id\", {\n      value: id,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"mark\", {\n      value: mark,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return true;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): InputBuffer {\n    return this;\n  }\n\n  override get index(): number {\n    return 0;\n  }\n\n  override withIndex(index: number): InputBuffer {\n    if (index === 0) {\n      return this;\n    } else {\n      const error = new InputException(\"invalid index\");\n      return new InputBufferError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override get limit(): number {\n    return 0;\n  }\n\n  override withLimit(limit: number): InputBuffer {\n    if (limit === 0) {\n      return this;\n    } else {\n      const error = new InputException(\"invalid limit\");\n      return new InputBufferError(error, this.id, this.mark, this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return 0;\n  }\n\n  override get remaining(): number {\n    return 0;\n  }\n\n  override has(index: number): boolean {\n    return false;\n  }\n\n  override get(index: number): number {\n    throw new InputException();\n  }\n\n  override set(index: number, token: number): void {\n    throw new InputException();\n  }\n\n  override head(): number {\n    throw new InputException();\n  }\n\n  override step(offset?: number): InputBuffer {\n    const error = new InputException(\"error step\");\n    return new InputBufferError(error, this.id, this.mark, this.settings);\n  }\n\n  override trap(): Error {\n    return this.error;\n  }\n\n  override seek(mark: Mark): InputBuffer {\n    const error = new InputException(\"error seek\");\n    return new InputBufferError(error, this.id, this.mark, this.settings);\n  }\n\n  override readonly id!: string | undefined;\n\n  withId(id: string | undefined): InputBuffer {\n    return new InputBufferError(this.error, id, this.mark, this.settings);\n  }\n\n  override readonly mark!: Mark;\n\n  override withMark(mark: Mark): InputBuffer {\n    return new InputBufferError(this.error, this.id, mark, this.settings);\n  }\n\n  override get offset(): number {\n    return this.mark.offset;\n  }\n\n  override get line(): number {\n    return this.mark.line;\n  }\n\n  override get column(): number {\n    return this.mark.column;\n  }\n\n  override readonly settings!: InputSettings;\n\n  override withSettings(settings: AnyInputSettings): InputBuffer {\n    settings = InputSettings.fromAny(settings);\n    return new InputBufferError(this.error, this.id, this.mark, settings);\n  }\n\n  override clone(): InputBuffer {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {Output} from \"./Output\";\nimport {OutputDone} from \"../\"; // forward import\nimport {OutputError} from \"../\"; // forward import\n\n/** @internal */\nexport class OutputFull extends Output<never> {\n  constructor(settings: OutputSettings) {\n    super();\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isFull(): boolean {\n    return true;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return true;\n  }\n\n  override asPart(part: boolean): Output<never> {\n    return part ? this : new OutputDone(this.settings);\n  }\n\n  override write(token: number): Output<never>;\n  override write(string: string): Output<never>;\n  override write(tokenOrString: number | string): Output<never> {\n    return new OutputError(new OutputException(\"full\"), this.settings);\n  }\n\n  override writeln(string?: string): Output<never> {\n    return new OutputError(new OutputException(\"full\"), this.settings);\n  }\n\n  override bind(): never {\n    throw new OutputException();\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<never> {\n    settings = OutputSettings.fromAny(settings);\n    return new OutputFull(settings);\n  }\n\n  override clone(): Output<never> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {Output} from \"./Output\";\nimport {OutputFull} from \"../\"; // forward import\nimport {OutputError} from \"../\"; // forward import\n\n/** @internal */\nexport class OutputDone extends Output<never> {\n  constructor(settings: OutputSettings) {\n    super();\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Output<never> {\n    return part ? new OutputFull(this.settings) : this;\n  }\n\n  override write(token: number): Output<never>;\n  override write(string: string): Output<never>;\n  override write(tokenOrString: number | string): Output<never> {\n    return new OutputError(new OutputException(\"done\"), this.settings);\n  }\n\n  override writeln(string?: string): Output<never> {\n    return new OutputError(new OutputException(\"done\"), this.settings);\n  }\n\n  override bind(): never {\n    throw new OutputException();\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<never> {\n    settings = OutputSettings.fromAny(settings);\n    return new OutputDone(settings);\n  }\n\n  override clone(): Output<never> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {Output} from \"./Output\";\n\n/** @internal */\nexport class OutputError extends Output<never> {\n  /** @internal */\n  readonly error!: Error;\n\n  constructor(error: Error, settings: OutputSettings) {\n    super();\n    Object.defineProperty(this, \"error\", {\n      value: error,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return true;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Output<never> {\n    return this;\n  }\n\n  override write(token: number): Output<never>;\n  override write(string: string): Output<never>;\n  override write(tokenOrString: number | string): Output<never> {\n    return this;\n  }\n\n  override writeln(string?: string): Output<never> {\n    return this;\n  }\n\n  override bind(): never {\n    throw new OutputException();\n  }\n\n  override trap(): Error {\n    return this.error;\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<never> {\n    settings = OutputSettings.fromAny(settings);\n    return new OutputError(this.error, settings);\n  }\n\n  override clone(): Output<never> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {Output} from \"./Output\";\nimport {OutputBufferFull} from \"../\"; // forward import\nimport {OutputBufferDone} from \"../\"; // forward import\nimport {OutputBufferError} from \"../\"; // forward import\n\n/**\n * Non-blocking token stream buffer.\n * @public\n */\nexport abstract class OutputBuffer<T = unknown> extends Output<T> {\n  abstract override asPart(part: boolean): OutputBuffer<T>;\n\n  abstract readonly index: number;\n\n  abstract withIndex(index: number): OutputBuffer<T>;\n\n  abstract readonly limit: number;\n\n  abstract withLimit(limit: number): OutputBuffer<T>;\n\n  abstract readonly capacity: number;\n\n  abstract readonly remaining: number;\n\n  abstract has(index: number): boolean;\n\n  abstract get(index: number): number;\n\n  abstract set(index: number, token: number): void;\n\n  abstract override write(token: number): OutputBuffer<T>;\n  abstract override write(string: string): OutputBuffer<T>;\n\n  override writeln(string?: string): OutputBuffer<T> {\n    if (typeof string === \"string\") {\n      this.write(string);\n    }\n    return this.write(this.settings.lineSeparator);\n  }\n\n  abstract step(offset?: number): OutputBuffer<T>;\n\n  override flush(): OutputBuffer<T> {\n    return this;\n  }\n\n  abstract override withSettings(settings: AnyOutputSettings): Output<T>;\n\n  override clone(): OutputBuffer<T> {\n    throw new Error();\n  }\n\n  /**\n   * Returns an `OutputBuffer` in the _full_ state.\n   */\n  @Lazy\n  static override full(): OutputBuffer<never> {\n    return new OutputBufferFull(OutputSettings.standard());\n  }\n\n  /**\n   * Returns an `OutputBuffer` in the _done_ state.\n   */\n  @Lazy\n  static override done(): OutputBuffer<never> {\n    return new OutputBufferDone(OutputSettings.standard());\n  }\n\n  /**\n   * Returns an `OutputBuffer` in the _error_ state that traps the given `error`.\n   */\n  static override error(error: Error): OutputBuffer<never> {\n    return new OutputBufferError(error, OutputSettings.standard());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {OutputBuffer} from \"./OutputBuffer\";\nimport {OutputBufferDone} from \"../\"; // forward import\nimport {OutputBufferError} from \"../\"; // forward import\n\n/** @internal */\nexport class OutputBufferFull extends OutputBuffer<never> {\n  constructor(settings: OutputSettings) {\n    super();\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isFull(): boolean {\n    return true;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return true;\n  }\n\n  override asPart(part: boolean): OutputBuffer<never> {\n    return part ? this : new OutputBufferDone(this.settings);\n  }\n\n  override get index(): number {\n    return 0;\n  }\n\n  override withIndex(index: number): OutputBuffer<never> {\n    if (index === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid index\"), this.settings);\n    }\n  }\n\n  override get limit(): number {\n    return 0;\n  }\n\n  override withLimit(limit: number): OutputBuffer<never> {\n    if (limit === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid limit\"), this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return 0;\n  }\n\n  override get remaining(): number {\n    return 0;\n  }\n\n  override has(index: number): boolean {\n    return false;\n  }\n\n  override get(index: number): number {\n    throw new OutputException();\n  }\n\n  override set(index: number, token: number): void {\n    throw new OutputException();\n  }\n\n  override write(token: number): OutputBuffer<never>;\n  override write(string: string): OutputBuffer<never>;\n  override write(tokenOrString: number | string): OutputBuffer<never> {\n    return new OutputBufferError(new OutputException(\"full\"), this.settings);\n  }\n\n  override writeln(string?: string): OutputBuffer<never> {\n    return new OutputBufferError(new OutputException(\"full\"), this.settings);\n  }\n\n  override step(offset: number = 1): OutputBuffer<never> {\n    if (offset === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid step\"), this.settings);\n    }\n  }\n\n  override bind(): never {\n    throw new OutputException();\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): OutputBuffer<never> {\n    settings = OutputSettings.fromAny(settings);\n    return new OutputBufferFull(settings);\n  }\n\n  override clone(): OutputBuffer<never> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {OutputBuffer} from \"./OutputBuffer\";\nimport {OutputBufferFull} from \"../\"; // forward import\nimport {OutputBufferError} from \"../\"; // forward import\n\n/** @internal */\nexport class OutputBufferDone extends OutputBuffer<never> {\n  constructor(settings: OutputSettings) {\n    super();\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): OutputBuffer<never> {\n    return part ? new OutputBufferFull(this.settings) : this;\n  }\n\n  override get index(): number {\n    return 0;\n  }\n\n  override withIndex(index: number): OutputBuffer<never> {\n    if (index === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid index\"), this.settings);\n    }\n  }\n\n  override get limit(): number {\n    return 0;\n  }\n\n  override withLimit(limit: number): OutputBuffer<never> {\n    if (limit === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid limit\"), this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return 0;\n  }\n\n  override get remaining(): number {\n    return 0;\n  }\n\n  override has(index: number): boolean {\n    return false;\n  }\n\n  override get(index: number): number {\n    throw new OutputException();\n  }\n\n  override set(index: number, token: number): void {\n    throw new OutputException();\n  }\n\n  override write(token: number): OutputBuffer<never>;\n  override write(string: string): OutputBuffer<never>;\n  override write(tokenOrString: number | string): OutputBuffer<never> {\n    return new OutputBufferError(new OutputException(\"done\"), this.settings);\n  }\n\n  override writeln(string?: string): OutputBuffer<never> {\n    return new OutputBufferError(new OutputException(\"done\"), this.settings);\n  }\n\n  override step(offset: number = 1): OutputBuffer<never> {\n    if (offset === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid step\"), this.settings);\n    }\n  }\n\n  override bind(): never {\n    throw new OutputException();\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): OutputBuffer<never> {\n    settings = OutputSettings.fromAny(settings);\n    return new OutputBufferDone(settings);\n  }\n\n  override clone(): OutputBuffer<never> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {OutputException} from \"./OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"./OutputSettings\";\nimport {OutputBuffer} from \"./OutputBuffer\";\n\n/** @internal */\nexport class OutputBufferError extends OutputBuffer<never> {\n  /** @internal */\n  readonly error!: Error;\n\n  constructor(error: Error, settings: OutputSettings) {\n    super();\n    Object.defineProperty(this, \"error\", {\n      value: error,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"settings\", {\n      value: settings,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return true;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): OutputBuffer<never> {\n    return this;\n  }\n\n  override get index(): number {\n    return 0;\n  }\n\n  override withIndex(index: number): OutputBuffer<never> {\n    if (index === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid index\"), this.settings);\n    }\n  }\n\n  override get limit(): number {\n    return 0;\n  }\n\n  override withLimit(limit: number): OutputBuffer<never> {\n    if (limit === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid limit\"), this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return 0;\n  }\n\n  override get remaining(): number {\n    return 0;\n  }\n\n  override has(index: number): boolean {\n    return false;\n  }\n\n  override get(index: number): number {\n    throw new OutputException();\n  }\n\n  override set(index: number, token: number): void {\n    throw new OutputException();\n  }\n\n  override write(token: number): OutputBuffer<never>;\n  override write(string: string): OutputBuffer<never>;\n  override write(tokenOrString: number | string): OutputBuffer<never> {\n    return this;\n  }\n\n  override writeln(string?: string): OutputBuffer<never> {\n    return this;\n  }\n\n  override step(offset: number = 1): OutputBuffer<never> {\n    if (offset === 0) {\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid step\"), this.settings);\n    }\n  }\n\n  override bind(): never {\n    throw new OutputException();\n  }\n\n  override trap(): Error {\n    return this.error;\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): OutputBuffer<never> {\n    settings = OutputSettings.fromAny(settings);\n    return new OutputBufferError(this.error, settings);\n  }\n\n  override clone(): OutputBuffer<never> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Diagnostic} from \"../source/Diagnostic\";\n\n/**\n * Thrown when a [[Parser]] parses invalid syntax.\n * @public\n */\nexport class ParserException extends Error {\n  constructor(message?: Diagnostic | string) {\n    super(message instanceof Diagnostic ? message.message : message);\n    Object.setPrototypeOf(this, ParserException.prototype);\n    this.diagnostic = message instanceof Diagnostic ? message : null;\n  }\n\n  readonly diagnostic: Diagnostic | null;\n\n  override toString(): string {\n    if (this.diagnostic !== null) {\n      return this.diagnostic.toString();\n    } else {\n      return super.toString();\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Diagnostic} from \"../source/Diagnostic\";\nimport type {Input} from \"../input/Input\";\nimport {ParserException} from \"./ParserException\";\nimport {ParserDone} from \"../\"; // forward import\nimport {ParserError} from \"../\"; // forward import\n\n/**\n * Continuation of how to parse subsequent [[Input]] tokens from a stream.\n * `Parser` enables efficient, interruptible parsing of network protocols and\n * data formats, without intermediate buffering.\n *\n * ### Input tokens\n * A `Parser` reads tokens from an `Input` reader. Input tokens are modeled as\n * primitive numbers, commonly representing Unicode code points, or raw octets.\n * Each `Parser` implementation specifies the semantic type of input tokens it\n * consumes.\n *\n * ### Parser states\n * A `Parser` is always in one of three states: _cont_​inue, _done_, or _error_.\n * The _cont_ state indicates that [[feed]] is ready to consume `Input`; the\n * _done_ state indicates that parsing terminated successfully, and that\n * [[bind]] will return the parsed result; the _error_ state indicates that\n * parsing terminated in failure, and that [[trap]] will return the parse error.\n * `Parser` subclasses default to the _cont_ state.\n *\n * ### Feeding input\n * The [[feed]] method incrementally parses as much `Input` as it can, before\n * returning another `Parser` that represents the continuation of how to parse\n * additional `Input`. The `Input` passed to `feed` is only guaranteed to be\n * valid for the duration of the method call; references to the provided `Input`\n * instance must not be stored.\n *\n * ### Parser results\n * A `Parser` produces a parsed result of type `O`, obtained via the [[bind]]\n * method. `bind` is only guaranteed to return a result when in the _done_\n * state; though `bind` may optionally make available partial results in other\n * states. A failed `Parser` provides a parse error via the [[trap]] method.\n * `trap` is only guaranteed to return an error when in the _error_ state.\n *\n * ### Continuations\n * A `Parser` instance represents a continuation of how to parse remaining\n * `Input`. Rather than parsing a complete input in one go, a `Parser` takes\n * an `Input` chunk and returns another `Parser` instance that knows how to\n * parse subsequent `Input` chunks. This enables non-blocking, incremental\n * parsing that can be interrupted whenever an `Input` reader runs out of\n * immediately available data. A `Parser` terminates by returning a\n * continuation in either the _done_ state, or the _error_ state.\n * [[Parser.done]] returns a `Parser` in the _done_ state. [[Parser.error]]\n * returns a `Parser` in the _error_ state.\n *\n * ### Iteratees\n * `Parser` is an [Iteratee](https://en.wikipedia.org/wiki/Iteratee). Though\n * unlike strictly functional iteratees, a `Parser` statefully iterates over\n * its `Input`, rather than allocating an object for each incremental input\n * continutaion. This internal mutability minimizes garbage collector memory\n * pressure, without violating the functional Iteratee abstraction, provided\n * that `feed` logically takes exclusive ownership of its `Input` when invoked,\n * and logically returns ownership of the `Input` in a state that's consistent\n * with the returned `Parser` continuation.\n *\n * ### Immutability\n * A `Parser` should be immutable. Specifically, an invocation of `feed`\n * should not alter the behavior of future calls to `feed` on the same `Parser`\n * instance. A `Parser` should only mutate its internal state if it's essential\n * to do so, such as for critical path performance reasons.\n *\n * ### Backtracking\n * `feed` can internally [[Input.clone clone]] its `Input`, if it might need to\n * backtrack. Keep in mind that, because `Input` is only valid for the duration\n * of a call to `feed`, input must be internally buffered if it needs to be\n * preserved between `feed` invocations.\n *\n * ### Forking\n * The [[fork]] method passes an out-of-band condition to a `Parser`, yielding\n * a `Parser` continuation whose behavior may be altered by the given condition.\n * For example, an HTML `Parser` might `fork` an inner text parser to directly\n * parse an embedded micro format out of an HTML element, based on some\n * out-of-band schema information. The types of conditions accepted by `fork`,\n * and their intended semantics, are implementation defined.\n *\n * @public\n */\nexport abstract class Parser<O> {\n  /**\n   * Returns `true` when [[feed]] is able to consume `Input`, i.e. this\n   * `Parser` is in the _cont_ state.\n   */\n  isCont(): boolean {\n    return true;\n  }\n\n  /**\n   * Returns `true` when parsing has terminated successfully, and [[bind]] will\n   * return the parsed result, i.e. this `Parser` is in the _done_ state.\n   */\n  isDone(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns `true` when parsing has terminated in failure, and [[trap]] will\n   * return the parse error, i.e. this `Parser` is in the _error_ state.\n   */\n  isError(): boolean {\n    return false;\n  }\n\n  /**\n   * Incrementally parses as much `input` as possible, and returns another\n   * `Parser` that represents the continuation of how to parse additional\n   * `Input`. If `input` enters the _done_ state, `feed` _must_ return a\n   * terminated `Parser`, i.e. a `Parser` in the _done_ state, or in the\n   * _error_ state. The given `input` is only guaranteed to be valid for the\n   * duration of the method call; references to `input` must not be stored.\n   */\n  abstract feed(input: Input): Parser<O>;\n\n  /**\n   * Returns a `Parser` continuation whose behavior may be altered by the\n   * given out-of-band `condition`.\n   */\n  fork(condition: unknown): Parser<O> {\n    return this;\n  }\n\n  /**\n   * Returns the parsed result. Only guaranteed to return a result when in the\n   * _done_ state.\n   *\n   * @throws `Error` if this `Parser` is not in the _done_ state.\n   */\n  bind(): O {\n    throw new ParserException();\n  }\n\n  /**\n   * Returns the parse error. Only guaranteed to return an error when in the\n   * _error_ state.\n   *\n   * @throws `Error` if this `Parser` is not in the _error_ state.\n   */\n  trap(): Error {\n    throw new ParserException();\n  }\n\n  /**\n   * Casts an errored `Parser` to a different output type. A `Parser` in the\n   * _error_ state can have any output type.\n   *\n   * @throws `ParserException` if this `Parser` is not in the _error_ state.\n   */\n  asError<O2>(): Parser<O2> {\n    throw new ParserException();\n  }\n\n  /**\n   * Returns a `Parser` in the _done_ state that binds the given parsed `value`.\n   */\n  static done<O>(value: O): Parser<O> {\n    return new ParserDone(value);\n  }\n\n  /**\n   * Returns a `Parser` in the _error_ state that `trap`s the given parse `error`.\n   */\n  static error<O>(error: Error | Diagnostic): Parser<O> {\n    if (error instanceof Error) {\n      return new ParserError(error);\n    } else {\n      return new ParserError(new ParserException(error));\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input} from \"../input/Input\";\nimport {Parser} from \"./Parser\";\n\n/** @internal */\nexport class ParserDone<O> extends Parser<O> {\n  /** @internal */\n  readonly value!: O;\n\n  constructor(value: O) {\n    super();\n    Object.defineProperty(this, \"value\", {\n      value: value,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override feed(input: Input): Parser<O> {\n    return this;\n  }\n\n  override bind(): O {\n    return this.value;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input} from \"../input/Input\";\nimport {Parser} from \"./Parser\";\n\n/** @internal */\nexport class ParserError extends Parser<never> {\n  /** @internal */\n  readonly error!: Error;\n\n  constructor(error: Error) {\n    super();\n    Object.defineProperty(this, \"error\", {\n      value: error,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return true;\n  }\n\n  override feed(input: Input): Parser<never> {\n    return this;\n  }\n\n  override bind(): never {\n    throw this.error;\n  }\n\n  override trap(): Error {\n    return this.error;\n  }\n\n  override asError<O2>(): Parser<O2> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"./WriterException\";\nimport {Writer} from \"./Writer\";\n\n/** @internal */\nexport class WriterEnd extends Writer<unknown, never> {\n  constructor() {\n    super();\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override pull(output: Output): Writer<unknown, never> {\n    return this;\n  }\n\n  override bind(): never {\n    throw new WriterException();\n  }\n\n  override asDone<I2>(): Writer<I2, never> {\n    return this;\n  }\n\n  override andThen<O2>(that: Writer<unknown, O2>): Writer<unknown, O2> {\n    return that;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {Writer} from \"./Writer\";\n\n/** @internal */\nexport class WriterDone<O> extends Writer<unknown, O> {\n  /** @internal */\n  readonly value!: O;\n\n  constructor(value: O) {\n    super();\n    Object.defineProperty(this, \"value\", {\n      value: value,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return true;\n  }\n\n  override pull(output: Output): Writer<unknown, O> {\n    return this;\n  }\n\n  override bind(): O {\n    return this.value;\n  }\n\n  override asDone<I2>(): Writer<I2, O> {\n    return this;\n  }\n\n  override andThen<O2>(that: Writer<unknown, O2>): Writer<unknown, O2> {\n    return that;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {Writer} from \"./Writer\";\n\n/** @internal */\nexport class WriterError extends Writer<never, never> {\n  /** @internal */\n  readonly error!: Error;\n\n  constructor(error: Error) {\n    super();\n    Object.defineProperty(this, \"error\", {\n      value: error,\n      enumerable: true,\n    });\n  }\n\n  override isCont(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return true;\n  }\n\n  override pull(output: Output): Writer<never, never> {\n    return this;\n  }\n\n  override bind(): never {\n    throw this.error;\n  }\n\n  override trap(): Error {\n    return this.error;\n  }\n\n  override asError<I2, O2>(): Writer<I2, O2> {\n    return this;\n  }\n\n  override andThen<O2>(that: Writer<never, O2>): Writer<never, O2> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {Writer} from \"./Writer\";\n\n/** @internal */\nexport class WriterSequence<O> extends Writer<never, O> {\n  /** @internal */\n  readonly head: Writer<unknown, unknown>;\n  /** @internal */\n  readonly tail: Writer<unknown, O>;\n\n  constructor(head: Writer<unknown, unknown>, tail: Writer<unknown, O>) {\n    super();\n    this.head = head;\n    this.tail = tail;\n  }\n\n  override pull(output: Output): Writer<never, O> {\n    let head = this.head;\n    if (head.isCont()) {\n      head = head.pull(output);\n    }\n    if (head.isError()) {\n      return head.asError();\n    } else if (head.isDone()) {\n      return this.tail.pull(output);\n    } else {\n      return new WriterSequence(head, this.tail);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport {Output} from \"../output/Output\";\n\n/** @internal */\nexport abstract class ByteOutput<T> extends Output<T> {\n  constructor(array: Uint8Array | null, size: number, settings: OutputSettings) {\n    super();\n    this.array = array;\n    this.size = size;\n    this.settings = settings;\n  }\n\n  /** @internal */\n  readonly array: Uint8Array | null;\n\n  /** @internal */\n  readonly size: number;\n\n  override isCont(): boolean {\n    return true;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Output<T> {\n    return this;\n  }\n\n  override write(b: number | string): Output<T> {\n    if (typeof b === \"number\") {\n      const n = this.size;\n      const oldArray = this.array;\n      let newArray;\n      if (oldArray === null || n + 1 > oldArray.length) {\n        newArray = new Uint8Array(ByteOutput.expand(n + 1));\n        if (oldArray !== null) {\n          newArray.set(oldArray, 0);\n        }\n        (this as Mutable<this>).array = newArray;\n      } else {\n        newArray = oldArray;\n      }\n      newArray[n] = b;\n      (this as Mutable<this>).size = n + 1;\n      return this;\n    } else {\n      throw new TypeError(\"\" + b);\n    }\n  }\n\n  override writeln(string?: string): Output<T> {\n    throw new TypeError(\"\" + string);\n  }\n\n  toUint8Array(): Uint8Array {\n    const n = this.size;\n    const oldArray = this.array;\n    if (oldArray !== null && n === oldArray.length) {\n      return oldArray;\n    } else {\n      const newArray = new Uint8Array(n);\n      if (oldArray !== null) {\n        newArray.set(oldArray.slice(0, n), 0);\n      }\n      (this as Mutable<this>).array = newArray;\n      return newArray;\n    }\n  }\n\n  cloneArray(): Uint8Array | null {\n    const oldArray = this.array;\n    if (oldArray !== null) {\n      return oldArray.slice(0, this.size);\n    } else {\n      return null;\n    }\n  }\n\n  override readonly settings: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<T> {\n    settings = OutputSettings.fromAny(settings);\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  /** @internal */\n  static expand(n: number): number {\n    n = Math.max(32, n) - 1;\n    n |= n >> 1; n |= n >> 2; n |= n >> 4; n |= n >> 8; n |= n >> 16;\n    return n + 1;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {OutputSettings} from \"../output/OutputSettings\";\nimport type {Output} from \"../output/Output\";\nimport {ByteOutput} from \"./ByteOutput\";\n\n/** @internal */\nexport class ByteOutputUint8Array extends ByteOutput<Uint8Array> {\n  constructor(array: Uint8Array | null, size: number, settings: OutputSettings) {\n    super(array, size, settings);\n  }\n\n  override bind(): Uint8Array {\n    return this.toUint8Array();\n  }\n\n  override clone(): Output<Uint8Array> {\n    return new ByteOutputUint8Array(this.cloneArray(), this.size, this.settings);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {OutputException} from \"../output/OutputException\";\nimport {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport {OutputBuffer} from \"../output/OutputBuffer\";\nimport {OutputBufferError} from \"../output/OutputBufferError\";\n\n/** @internal */\nexport class ByteOutputBuffer extends OutputBuffer<Uint8Array> {\n  constructor(array: Uint8Array, index: number, limit: number,\n              part: boolean, settings: OutputSettings) {\n    super();\n    this.array = array;\n    this.index = index;\n    this.limit = limit;\n    this.part = part;\n    this.settings = settings;\n  }\n\n  /** @internal */\n  readonly array: Uint8Array;\n\n  /** @internal */\n  readonly part: boolean;\n\n  override isCont(): boolean {\n    return this.index < this.limit;\n  }\n\n  override isFull(): boolean {\n    return this.part && this.index >= this.limit;\n  }\n\n  override isDone(): boolean {\n    return !this.part && this.index >= this.limit;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return this.part;\n  }\n\n  override asPart(part: boolean): OutputBuffer<Uint8Array> {\n    (this as Mutable<this>).part = part;\n    return this;\n  }\n\n  readonly index: number;\n\n  override withIndex(index: number): OutputBuffer<Uint8Array> {\n    if (0 <= index && index <= this.limit) {\n      (this as Mutable<this>).index = index;\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid index\"), this.settings);\n    }\n  }\n\n  readonly limit: number;\n\n  override withLimit(limit: number): OutputBuffer<Uint8Array> {\n    if (0 <= limit && limit <= this.array.length) {\n      (this as Mutable<this>).limit = limit;\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid limit\"), this.settings);\n    }\n  }\n\n  override get capacity(): number {\n    return this.array.length;\n  }\n\n  override get remaining(): number {\n    return this.limit - this.index;\n  }\n\n  override has(index: number): boolean {\n    return 0 <= index && index < this.limit;\n  }\n\n  override get(index: number): number {\n    if (0 <= index && index < this.limit) {\n      return this.array[index]!;\n    } else {\n      throw new OutputException();\n    }\n  }\n\n  override set(index: number, token: number): void {\n    if (0 <= index && index < this.limit) {\n      this.array[index] = token;\n    } else {\n      throw new OutputException();\n    }\n  }\n\n  override write(token: number | string): OutputBuffer<Uint8Array> {\n    if (typeof token === \"number\") {\n      const index = this.index;\n      if (index < this.limit) {\n        this.array[index] = token;\n        (this as Mutable<this>).index += 1;\n        return this;\n      } else {\n        return new OutputBufferError(new OutputException(\"full\"), this.settings);\n      }\n    } else {\n      return new OutputBufferError(new OutputException(\"binary output\"), this.settings);\n    }\n  }\n\n  override writeln(string?: string): OutputBuffer<Uint8Array> {\n    return new OutputBufferError(new OutputException(\"binary output\"), this.settings);\n  }\n\n  override step(offset: number): OutputBuffer<Uint8Array> {\n    const index = this.index + offset;\n    if (0 <= index && index <= this.limit) {\n      (this as Mutable<this>).index = index;\n      return this;\n    } else {\n      return new OutputBufferError(new OutputException(\"invalid step\"), this.settings);\n    }\n  }\n\n  override bind(): Uint8Array {\n    return new Uint8Array(this.array.buffer, 0, this.index);\n  }\n\n  override readonly settings: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): OutputBuffer<Uint8Array> {\n    settings = OutputSettings.fromAny(settings);\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  override clone(): OutputBuffer<Uint8Array> {\n    return new ByteOutputBuffer(this.array, this.index, this.limit, this.part, this.settings);\n  }\n\n  static create(array: Uint8Array, offset?: number, length?: number): OutputBuffer<Uint8Array> {\n    if (offset === void 0) {\n      offset = 0;\n    }\n    if (length === void 0) {\n      length = array.length;\n    }\n    return new ByteOutputBuffer(array, offset, offset + length, false, OutputSettings.standard());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport type {Output} from \"../output/Output\";\nimport type {OutputBuffer} from \"../output/OutputBuffer\";\nimport {ByteOutputBuffer} from \"./ByteOutputBuffer\";\nimport {ByteOutputUint8Array} from \"./ByteOutputUint8Array\";\n\n/**\n * Byte [[Input]]/[[Output]] factory.\n *\n * The `Binary.outputBuffer(...)` function returns an `Output` that writes\n * bytes to a growable array, and [[Output.bind binds]] a `Uint8Array`\n * containing all written bytes.\n * @public\n */\nexport const Binary = (function () {\n  const Binary = {} as {\n    /**\n     * Returns a new `Output` that appends bytes to a growable array,\n     * pre-allocated with space for `initialCapacity` bytes, if `initialCapacity`\n     * is defined, using the given `settings`, if `settings` is defined. The\n     * returned `Output` accepts an unbounded number of bytes, remaining\n     * permanently in the _cont_ state, and can [[Output.bind bind]] a\n     * `Uint8Array` with the current output state at any time.\n     */\n    output(initialCapacity?: number, settings?: AnyOutputSettings): Output<Uint8Array>;\n\n    /**\n     * Returns a new `Output` that appends bytes to a growable array, using the\n     * given `settings`. The returned `Output` accepts an unbounded number of\n     * bytes, remaining permanently in the _cont_ state, and can [[Output.bind\n     * bind]] a `Uint8Array` array with the current output state at any time.\n     */\n    output(settings: AnyOutputSettings): Output<Uint8Array>;\n\n    outputBuffer(array: Uint8Array, offset?: number, length?: number): OutputBuffer<Uint8Array>;\n  };\n\n  Binary.output = function (initialCapacity?: number | AnyOutputSettings,\n                            settings?: AnyOutputSettings): Output<Uint8Array> {\n    if (settings === void 0 && typeof initialCapacity !== \"number\") {\n      settings = initialCapacity;\n      initialCapacity = void 0;\n    } else if (typeof initialCapacity !== \"number\") {\n      initialCapacity = void 0;\n    }\n    let array: Uint8Array | null;\n    if (typeof initialCapacity === \"number\") {\n      array = new Uint8Array(initialCapacity);\n    } else {\n      array = null;\n    }\n    settings = OutputSettings.fromAny(settings);\n    return new ByteOutputUint8Array(array, 0, settings);\n  };\n\n  Binary.outputBuffer = function (array: Uint8Array, offset?: number,\n                                  length?: number): OutputBuffer<Uint8Array> {\n    return ByteOutputBuffer.create(array, offset, length);\n  };\n\n  return Binary;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport type {Debug} from \"../format/Debug\";\nimport {Format} from \"../format/Format\";\nimport {UtfErrorModeFatal} from \"../\"; // forward import\nimport {UtfErrorModeReplacement} from \"../\"; // forward import\n\n/**\n * Unicode transformation format error handling mode.\n * @public\n */\nexport abstract class UtfErrorMode implements HashCode, Debug {\n  /**\n   * Returns `true` if a Unicode decoding should abort with an error when an\n   * invalid code unit sequence is encountered.\n   */\n  isFatal(): boolean {\n    return false;\n  }\n\n  /**\n   * Returns `true` if a Unicode decoding should substitute invalid code unit\n   * sequences with a replacement character.\n   */\n  isReplacement(): boolean {\n    return false;\n  }\n\n  /**\n   * The Unicode code point of the replacement character used to substitute\n   * for invalid code unit sequences.\n   */\n  abstract readonly replacementChar: number;\n\n  /**\n   * Returns `true` if Unicode decoding should abort with an error when a\n   * `NUL` byte is encountered.\n   */\n  abstract isNonZero(): boolean;\n\n  /**\n   * Returns a `UtfErrorMode` that, if `isNonZero` is `true`, aborts when\n   * Unicode decoding encounters a `NUL` byte.\n   */\n  abstract asNonZero(isNonZero: boolean): UtfErrorMode;\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  /**\n   * Returns a `UtfErrorMode` that aborts Unicode decoding with an error when\n   * invalid code unit sequences are encountered.\n   */\n  @Lazy\n  static fatal(): UtfErrorMode {\n    return new UtfErrorModeFatal(false);\n  }\n\n  /**\n   * Returns a `UtfErrorMode` that aborts Unicode decoding with an error when\n   * invalid code unit sequences, and `NUL` bytes, are encountered.\n   */\n  @Lazy\n  static fatalNonZero(): UtfErrorMode {\n    return new UtfErrorModeFatal(true);\n  }\n\n  /**\n   * Returns a `UtfErrorMode` that substitutes invalid code unit sequences\n   * with the replacement character (`U+FFFD`).\n   */\n  @Lazy\n  static replacement(): UtfErrorMode {\n    return new UtfErrorModeReplacement(0xfffd, false);\n  }\n\n  /**\n   * Returns a `UtfErrorMode` that substitutes invalid code unit sequences\n   * with the replacement character (`U+FFFD`), and aborts decoding with an\n   * error when `NUL` bytes are encountered.\n   */\n  @Lazy\n  static replacementNonZero(): UtfErrorMode {\n    return new UtfErrorModeReplacement(0xfffd, true);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Booleans, Constructors} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport {UtfErrorMode} from \"./UtfErrorMode\";\n\n/** @internal */\nexport class UtfErrorModeFatal extends UtfErrorMode {\n  constructor(nonZero: boolean) {\n    super();\n    Object.defineProperty(this, \"nonZero\", {\n      value: nonZero,\n      enumerable: true,\n    });\n  }\n\n  override isFatal(): boolean {\n    return true;\n  }\n\n  override get replacementChar(): number {\n    return 0xfffd;\n  }\n\n  /** @internal */\n  readonly nonZero!: boolean;\n\n  override isNonZero(): boolean {\n    return this.nonZero;\n  }\n\n  override asNonZero(nonZero: boolean): UtfErrorMode {\n    if (nonZero) {\n      return UtfErrorMode.fatalNonZero();\n    } else {\n      return UtfErrorMode.fatal();\n    }\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UtfErrorModeFatal) {\n      return this.nonZero === that.nonZero;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(UtfErrorModeFatal),\n        Booleans.hash(this.nonZero)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UtfErrorMode\").write(46/*'.'*/)\n                   .write(this.nonZero ? \"fatalNonZero\" : \"fatal\")\n                   .write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Booleans, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport {UtfErrorMode} from \"./UtfErrorMode\";\n\n/** @internal */\nexport class UtfErrorModeReplacement extends UtfErrorMode {\n  constructor(replacementChar: number, nonZero: boolean) {\n    super();\n    Object.defineProperty(this, \"replacementChar\", {\n      value: replacementChar,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"nonZero\", {\n      value: nonZero,\n      enumerable: true,\n    });\n  }\n\n  override isReplacement(): boolean {\n    return true;\n  }\n\n  override readonly replacementChar!: number;\n\n  /** @internal */\n  readonly nonZero!: boolean;\n\n  override isNonZero(): boolean {\n    return this.nonZero;\n  }\n\n  override asNonZero(nonZero: boolean): UtfErrorMode {\n    if (this.replacementChar === 0xfffd) {\n      if (nonZero) {\n        return UtfErrorMode.replacementNonZero();\n      } else {\n        return UtfErrorMode.replacement();\n      }\n    } else {\n      return new UtfErrorModeReplacement(this.replacementChar, nonZero);\n    }\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UtfErrorModeReplacement) {\n      return this.replacementChar === that.replacementChar\n          && this.nonZero === that.nonZero;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(UtfErrorModeReplacement),\n        Numbers.hash(this.replacementChar)), Booleans.hash(this.nonZero)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UtfErrorMode\").write(46/*'.'*/)\n                   .write(this.nonZero ? \"replacementNonZero\" : \"replacement\")\n                   .write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport type {Input} from \"../input/Input\";\nimport type {Output} from \"../output/Output\";\nimport type {Parser} from \"../parser/Parser\";\nimport type {Writer} from \"../writer/Writer\";\nimport {Format} from \"../format/Format\";\nimport {Binary} from \"../binary/Binary\";\nimport {Unicode} from \"../unicode/Unicode\";\nimport {Base16Parser} from \"../\"; // forward import\nimport {Base16Writer} from \"../\"; // forward import\nimport {Base16IntegerWriter} from \"../\"; // forward import\n\n/**\n * Base-16 (hexadecimal) encoding [[Parser]]/[[Writer]] factory.\n * @public\n */\nexport class Base16 {\n  constructor(alphabet: string) {\n    Object.defineProperty(this, \"alphabet\", {\n      value: alphabet,\n      enumerable: true,\n    });\n  }\n\n  /**\n   * Returns a 16 character string, where the character at index `i` is the\n   * encoding of the base-16 digit `i`.\n   */\n  readonly alphabet!: string;\n\n  /**\n   * Returns the Unicode code point of the base-16 digit that encodes the given\n   * 4-bit quantity.\n   */\n  encodeDigit(b: number): number {\n    return this.alphabet.charCodeAt(b);\n  }\n\n  /**\n   * Returns a `Writer` that, when fed an input `Uint8Array`, returns a\n   * continuation that writes the base-16 (hexadecimal) encoding of the input\n   * byte array.\n   */\n  uint8ArrayWriter(): Writer<Uint8Array, unknown>;\n  /**\n   * Returns a `Writer` continuation that writes the base-16 (hexadecimal)\n   * encoding of the `input` `Uint8Array`.\n   */\n  uint8ArrayWriter(input: Uint8Array): Writer<unknown, Uint8Array>;\n  uint8ArrayWriter(input?: Uint8Array): Writer<unknown, unknown> {\n    if (input === void 0) {\n      return new Base16Writer(this, void 0, null);\n    } else {\n      return new Base16Writer(this, input, input);\n    }\n  }\n\n  /**\n   * Writes the base-16 (hexadecimal) encoding of the `input` `Uint8Array` to\n   * the `output`, returning a `Writer` continuation that knows how to write any\n   * remaining output that couldn't be immediately generated.\n   */\n  writeUint8Array(output: Output, input: Uint8Array): Writer<unknown, unknown> {\n    return Base16Writer.write(output, this, void 0, input);\n  }\n\n  writeInteger(output: Output, input: number, width: number = 0): Writer<unknown, unknown> {\n    return Base16IntegerWriter.write(output, this, void 0, input, width);\n  }\n\n  writeIntegerLiteral(output: Output, input: number, width: number = 0): Writer<unknown, unknown> {\n    return Base16IntegerWriter.writeLiteral(output, this, void 0, input, width);\n  }\n\n  /**\n   * Returns the `Base16` encoding with lowercase alphanumeric digits.\n   */\n  @Lazy\n  static get lowercase(): Base16 {\n    return new Base16(\"0123456789abcdef\");\n  }\n\n  /**\n   * Returns the `Base16` encoding with uppercase alphanumeric digits.\n   */\n  @Lazy\n  static get uppercase(): Base16 {\n    return new Base16(\"0123456789ABCDEF\");\n  }\n\n  /**\n   * Returns `true` if the Unicode code point `c` is a valid base-16 digit.\n   */\n  static isDigit(c: number): boolean {\n    return c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c >= 65/*'A'*/ && c <= 70/*'F'*/\n        || c >= 97/*'a'*/ && c <= 102/*'f'*/;\n  }\n\n  /**\n   * Returns the 4-bit quantity represented by the base-16 digit `c`.\n   *\n   * @throws `Error` if `c` is not a valid base-16 digit.\n   */\n  static decodeDigit(c: number): number {\n    if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n      return c - 48/*'0'*/;\n    } else if (c >= 65/*'A'*/ && c <= 70/*'F'*/) {\n      return 10 + (c - 65/*'A'*/);\n    } else if (c >= 97/*'a'*/ && c <= 102/*'f'*/) {\n      return 10 + (c - 97/*'a'*/);\n    } else {\n      let message = Unicode.stringOutput();\n      message = message.write(\"Invalid base-16 digit: \");\n      message = Format.debugChar(message, c);\n      throw new Error(message.bind());\n    }\n  }\n\n  /**\n   * Decodes the base-16 digits `c1` and `c2`, and writes the 8-bit  quantity\n   * they represent to the given `output`.\n   *\n   * @returns the continuation of the `output`.\n   */\n  static writeQuantum<T>(output: Output<T>, c1: number, c2: number): Output<T> {\n    const x = Base16.decodeDigit(c1);\n    const y = Base16.decodeDigit(c2);\n    output = output.write(x << 4 | y);\n    return output;\n  }\n\n  /**\n   * Returns a `Parser` that decodes base-16 (hexadecimal) encoded input, and\n   * writes the decoded bytes to `output`.\n   */\n  static parser<O>(output: Output<O>): Parser<O> {\n    return new Base16Parser<O>(output);\n  }\n\n  /**\n   * Parses the base-16 (hexadecimal) encoded `input`, and writes the decoded\n   * bytes to `output`, returning a `Parser` continuation that knows how to\n   * parse any additional input.\n   */\n  static parse<O>(input: Input, output: Output<O>): Parser<O> {\n    return Base16Parser.parse(input, output);\n  }\n\n  /**\n   * Parses the base-16 (hexadecimal) encoded `input`, and writes the decoded\n   * bytes to a growable array, returning a `Parser` continuation that knows\n   * how to parse any additional input. The returned `Parser` [[Parser.bind\n   * binds]] a `Uint8Array` array containing all parsed base-16 data.\n   */\n  static parseUint8Array(input: Input): Parser<Uint8Array> {\n    return Base16Parser.parse(input, Binary.output());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {OutputException} from \"../output/OutputException\";\nimport type {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport {Output} from \"../output/Output\";\nimport {Unicode} from \"./Unicode\";\nimport {UtfErrorMode} from \"./UtfErrorMode\";\nimport {Base16} from \"../number/Base16\";\n\n/** @internal */\nexport class Utf8DecodedOutput<T> extends Output<T> {\n  /** @internal */\n  readonly output: Output<T>;\n  /** @internal */\n  readonly errorMode: UtfErrorMode;\n  /** @internal */\n  c1: number;\n  /** @internal */\n  c2: number;\n  /** @internal */\n  c3: number;\n  /** @internal */\n  have: number;\n\n  constructor(output: Output<T>, errorMode: UtfErrorMode,\n              c1: number, c2: number, c3: number, have: number) {\n    super();\n    this.output = output;\n    this.errorMode = errorMode;\n    this.c1 = c1;\n    this.c2 = c2;\n    this.c3 = c3;\n    this.have = have;\n  }\n\n  override isCont(): boolean {\n    return this.output.isCont();\n  }\n\n  override isFull(): boolean {\n    return this.output.isFull();\n  }\n\n  override isDone(): boolean {\n    return this.output.isDone();\n  }\n\n  override isError(): boolean {\n    return this.output.isError();\n  }\n\n  override isPart(): boolean {\n    return this.output.isPart();\n  }\n\n  override asPart(part: boolean): Output<T> {\n    (this as Mutable<this>).output = this.output.asPart(part);\n    return this;\n  }\n\n  override write(token: number | string): Output<T> {\n    if (typeof token === \"number\") {\n      let c1 = this.c1;\n      let c2 = this.c2;\n      let c3 = this.c3;\n      let c4 = -1;\n      let have = this.have;\n\n      if (token >= 0) {\n        switch (have) {\n          case 0:\n            c1 = token & 0xff;\n            have = 1;\n            break;\n          case 1:\n            c2 = token & 0xff;\n            have = 2;\n            break;\n          case 2:\n            c3 = token & 0xff;\n            have = 3;\n            break;\n          case 3:\n            c4 = token & 0xff;\n            have = 4;\n            break;\n          default:\n            throw new Error(\"unreachable\");\n        }\n      }\n\n      if (c1 === 0 && this.errorMode.isNonZero()) { // invalid NUL byte\n        return Output.error(new OutputException(\"unexpected NUL byte\"));\n      } else if (c1 >= 0 && c1 <= 0x7f) { // U+0000..U+007F\n        (this as Mutable<this>).output = this.output.write(c1);\n        this.have = 0;\n      } else if (c1 >= 0xc2 && c1 <= 0xf4) {\n        if (c1 >= 0xc2 && c1 <= 0xdf && c2 >= 0x80 && c2 <= 0xbf) { // U+0080..U+07FF\n          (this as Mutable<this>).output = this.output.write((c1 & 0x1f) << 6 | c2 & 0x3f);\n          this.c1 = -1;\n          this.have = 0;\n        } else if (c1 === 0xe0 && c2 >= 0xa0 && c2 <= 0xbf // U+0800..U+0FFF\n                || c1 >= 0xe1 && c1 <= 0xec && c2 >= 0x80 && c2 <= 0xbf // U+1000..U+CFFF\n                || c1 === 0xed && c2 >= 0x80 && c2 <= 0x9f // U+D000..U+D7FF\n                || c1 >= 0xee && c1 <= 0xef && c2 >= 0x80 && c2 <= 0xbf) { // U+E000..U+FFFF\n          if (c3 >= 0x80 && c3 <= 0xbf) {\n            (this as Mutable<this>).output = this.output.write((c1 & 0x0f) << 12 | (c2 & 0x3f) << 6 | c3 & 0x3f);\n            this.c1 = -1;\n            this.c2 = -1;\n            this.have = 0;\n          } else if (c3 >= 0) { // invalid c3\n            if (this.errorMode.isFatal()) {\n              return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2, c3)));\n            }\n            (this as Mutable<this>).output = this.output.write(this.errorMode.replacementChar);\n            this.c1 = c3;\n            this.c2 = -1;\n            this.have = 1;\n          } else if (token < 0 || this.output.isDone()) { // incomplete c3\n            return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2)));\n          } else { // awaiting c3\n            this.c2 = c2;\n            this.have = 2;\n          }\n        } else if (c1 === 0xf0 && c2 >= 0x90 && c2 <= 0xbf // U+10000..U+3FFFF\n                || c1 >= 0xf1 && c1 <= 0xf3 && c2 >= 0x80 && c2 <= 0xbf // U+40000..U+FFFFF\n                || c1 === 0xf4 && c2 >= 0x80 && c2 <= 0x8f) { // U+100000..U+10FFFF\n          if (c3 >= 0x80 && c3 <= 0xbf) {\n            if (c4 >= 0x80 && c4 <= 0xbf) {\n              this.have = 4;\n              (this as Mutable<this>).output = this.output.write((c1 & 0x07) << 18 | (c2 & 0x3f) << 12 | (c3 & 0x3f) << 6 | c4 & 0x3f);\n              this.c1 = -1;\n              this.c2 = -1;\n              this.c3 = -1;\n              this.have = 0;\n            } else if (c4 >= 0) { // invalid c4\n              if (this.errorMode.isFatal()) {\n                return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2, c3, c4)));\n              }\n              (this as Mutable<this>).output = this.output.write(this.errorMode.replacementChar);\n              this.c1 = c4;\n              this.c2 = -1;\n              this.c3 = -1;\n              this.have = 1;\n            } else if (token < 0 || this.output.isDone()) { // incomplete c4\n              return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2, c3)));\n            } else { // awaiting c4\n              this.c3 = c3;\n              this.have = 3;\n            }\n          } else if (c3 >= 0) { // invalid c3\n            if (this.errorMode.isFatal()) {\n              return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2, c3)));\n            }\n            (this as Mutable<this>).output = this.output.write(this.errorMode.replacementChar);\n            this.c1 = c3;\n            this.c2 = -1;\n            this.have = 1;\n          } else if (token < 0 || this.output.isDone()) { // incomplete c3\n            return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2)));\n          } else { // awaiting c3\n            this.c2 = c2;\n            this.have = 2;\n          }\n        } else if (c2 >= 0) { // invalid c2\n          if (this.errorMode.isFatal()) {\n            return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1, c2)));\n          }\n          (this as Mutable<this>).output = this.output.write(this.errorMode.replacementChar);\n          this.c1 = c2;\n          this.have = 1;\n        } else if (token < 0 || this.output.isDone()) { // incomplete c2\n          return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1)));\n        } else { // awaiting c2\n          this.c1 = c1;\n          this.have = 1;\n        }\n      } else if (c1 >= 0) { // invalid c1\n        if (this.errorMode.isFatal()) {\n          return Output.error(new OutputException(Utf8DecodedOutput.invalid(c1)));\n        }\n        (this as Mutable<this>).output = this.output.write(this.errorMode.replacementChar);\n        this.have = 0;\n      }\n      if (this.output.isError()) {\n        return this.output;\n      }\n      return this;\n    } else if (typeof token === \"string\") {\n      (this as Mutable<this>).output = this.output.write(token);\n      return this;\n    } else {\n      throw new TypeError(\"\" + token);\n    }\n  }\n\n  private static invalid(c1: number, c2?: number, c3?: number, c4?: number): string {\n    let output = Unicode.stringOutput();\n    output = output.write(\"invalid UTF-8 code unit sequence: \");\n    const base16 = Base16.uppercase;\n    base16.writeIntegerLiteral(output, c1, 2);\n    if (c2 !== void 0) {\n      output = output.write(' ');\n      base16.writeIntegerLiteral(output, c2, 2);\n      if (c3 !== void 0) {\n        output = output.write(' ');\n        base16.writeIntegerLiteral(output, c3, 2);\n        if (c4 !== void 0) {\n          output = output.write(' ');\n          base16.writeIntegerLiteral(output, c4, 2);\n        }\n      }\n    }\n    return output.bind();\n  }\n\n  override get settings(): OutputSettings {\n    return this.output.settings;\n  }\n\n  override withSettings(settings: AnyOutputSettings): Output<T> {\n    (this as Mutable<this>).output = this.output.withSettings(settings);\n    return this;\n  }\n\n  override bind(): T {\n    if (this.have === 0) {\n      return this.output.bind();\n    } else {\n      return this.write(-1).bind();\n    }\n  }\n\n  override trap(): Error {\n    return this.output.trap();\n  }\n\n  override clone(): Output<T> {\n    return new Utf8DecodedOutput(this.output.clone(), this.errorMode,\n                                 this.c1, this.c2, this.c3, this.have);\n  }\n\n  static create<T>(output: Output<T>, errorMode?: UtfErrorMode): Output<T> {\n    if (errorMode === void 0) {\n      errorMode = UtfErrorMode.fatal();\n    }\n    return new Utf8DecodedOutput(output, errorMode, -1, -1, -1, 0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {OutputException} from \"../output/OutputException\";\nimport type {AnyOutputSettings, OutputSettings} from \"../output/OutputSettings\";\nimport {Output} from \"../output/Output\";\nimport {UtfErrorMode} from \"./UtfErrorMode\";\n\n/** @internal */\nexport class Utf8EncodedOutput<T> extends Output<T> {\n  /** @internal */\n  readonly output: Output<T>;\n  /** @internal */\n  readonly errorMode: UtfErrorMode;\n  /** @internal */\n  c2: number;\n  /** @internal */\n  c3: number;\n  /** @internal */\n  c4: number;\n  /** @internal */\n  index: number;\n\n  constructor(output: Output<T>, errorMode: UtfErrorMode, c2: number,\n              c3: number, c4: number, index: number) {\n    super();\n    this.output = output;\n    this.errorMode = errorMode;\n    this.c2 = c2;\n    this.c3 = c3;\n    this.c4 = c4;\n    this.index = index;\n  }\n\n  override isCont(): boolean {\n    return this.output.isCont();\n  }\n\n  override isFull(): boolean {\n    return this.output.isFull();\n  }\n\n  override isDone(): boolean {\n    return this.output.isDone();\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return this.output.isPart();\n  }\n\n  override asPart(part: boolean): Output<T> {\n    (this as Mutable<this>).output = this.output.asPart(part);\n    return this;\n  }\n\n  override write(token: number | string): Output<T> {\n    if (typeof token === \"number\") {\n      let c1 = 0;\n      let c2 = this.c2;\n      let c3 = this.c3;\n      let c4 = this.c4;\n      let output = this.output;\n      let index = this.index;\n      while (index < 4) {\n        if (output.isCont()) {\n          switch (index) {\n            case 1: output = output.write(c2); this.c2 = 0; break;\n            case 2: output = output.write(c3); this.c3 = 0; break;\n            case 3: output = output.write(c4); this.c4 = 0; break;\n            default: throw new Error(\"unreachable\");\n          }\n          index += 1;\n        } else {\n          return Output.error(new OutputException(\"unable to flush buffered code units\"));\n        }\n      }\n      if (token >= 0 && token <= 0x7f) { // U+0000..U+007F\n        c4 = token;\n        index = 3;\n      } else if (token >= 0x80 && token <= 0x7ff) { // U+0080..U+07FF\n        c3 = 0xc0 | (token >>> 6);\n        c4 = 0x80 | (token & 0x3f);\n        index = 2;\n      } else if (token >= 0x0800 && token <= 0xffff || // U+0800..U+D7FF\n                 token >= 0xe000 && token <= 0xffff) { // U+E000..U+FFFF\n        c2 = 0xe0 | (token  >>> 12);\n        c3 = 0x80 | ((token >>>  6) & 0x3f);\n        c4 = 0x80 | (token & 0x3f);\n        index = 1;\n      } else if (token >= 0x10000 && token <= 0x10ffff) { // U+10000..U+10FFFF\n        c1 = 0xf0 | (token  >>> 18);\n        c2 = 0x80 | ((token >>> 12) & 0x3f);\n        c3 = 0x80 | ((token >>>  6) & 0x3f);\n        c4 = 0x80 | (token & 0x3f);\n        index = 0;\n      } else { // surrogate or invalid code point\n        if (this.errorMode.isFatal()) {\n          return Output.error(new OutputException(\"invalid code point: \" + token));\n        } else {\n          return this.write(this.errorMode.replacementChar);\n        }\n      }\n      do {\n        switch (index) {\n          case 0: output = output.write(c1); break;\n          case 1: output = output.write(c2); this.c2 = 0; break;\n          case 2: output = output.write(c3); this.c3 = 0; break;\n          case 3: output = output.write(c4); this.c4 = 0; break;\n          default: throw new Error(\"unreachable\");\n        }\n        (this as Mutable<this>).output = output;\n        index += 1;\n      } while (index < 4 && output.isCont());\n      if (index < 4) {\n        if (index < 3) {\n          if (index < 2) {\n            this.c2 = c2;\n          }\n          this.c3 = c3;\n        }\n        this.c4 = c4;\n      }\n      (this as Mutable<this>).output = output;\n      this.index = index;\n      return this;\n    } else if (typeof token === \"string\") {\n      (this as Mutable<this>).output = this.output.write(token);\n      return this;\n    } else {\n      throw new TypeError(\"\" + token);\n    }\n  }\n\n  override flush(): Output<T> {\n    let output = this.output;\n    let index = this.index;\n    while (index < 4) {\n      if (output.isCont()) {\n        switch (index) {\n          case 1: output = output.write(this.c2); this.c2 = 0; break;\n          case 2: output = output.write(this.c3); this.c3 = 0; break;\n          case 3: output = output.write(this.c4); this.c4 = 0; break;\n          default: throw new Error(\"unreachable\");\n        }\n        index += 1;\n      } else {\n        return Output.error(new OutputException(\"unable to flush buffered code units\"));\n      }\n    }\n    (this as Mutable<this>).output = output;\n    this.index = index;\n    return this;\n  }\n\n  override get settings(): OutputSettings {\n    return this.output.settings;\n  }\n\n  override withSettings(settings: AnyOutputSettings): Output<T> {\n    (this as Mutable<this>).output = this.output.withSettings(settings);\n    return this;\n  }\n\n  override bind(): T {\n    return this.output.bind();\n  }\n\n  override clone(): Output<T> {\n    return new Utf8EncodedOutput(this.output.clone(), this.errorMode,\n                                 this.c2, this.c3, this.c4, this.index);\n  }\n\n  static create<T>(output: Output<T>, errorMode?: UtfErrorMode): Output<T> {\n    if (errorMode === void 0) {\n      errorMode = UtfErrorMode.fatal();\n    }\n    return new Utf8EncodedOutput(output, errorMode, 0, 0, 0, 4);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings} from \"@swim/util\";\nimport type {Output} from \"../output/Output\";\nimport {Unicode} from \"./Unicode\";\nimport type {UtfErrorMode} from \"./UtfErrorMode\";\nimport {Utf8DecodedOutput} from \"./Utf8DecodedOutput\";\nimport {Utf8EncodedOutput} from \"./Utf8EncodedOutput\";\n\n/**\n * UTF-8 [[Input]]/[[Output]] factory.\n * @public\n */\nexport const Utf8 = (function () {\n  const Utf8 = {} as {\n    /**\n     * Returns the number of bytes in the UTF-8 encoding of the Unicode code\n     * point `c`, handling invalid code unit sequences according to the\n     * `errorMode` policy. Returns the size of the\n     * [[UtfErrorMode.replacementChar]] for surrogates and invalid code points,\n     * if [[UtfErrorMode.isReplacement]] is `true`; otherwise returns `0` for\n     * surrogates and invalid code points. Uses the two byte modified UTF-8\n     * encoding of the NUL character (`U+0000`), if [[UtfErrorMode.isNonZero]]\n     * is `true`.\n     */\n    sizeOf(c: number | undefined, errorMode?: UtfErrorMode): number;\n\n    /**\n     * Returns the number of bytes in the UTF-8 encoding of the Unicode code\n     * point `c`; returns the size of the Unicode replacement character (`U+FFFD`)\n     * for surrogates and invalid code points.\n     */\n    sizeOf(c: number | undefined): number;\n\n    /**\n     * Returns the number of bytes in the UTF-8 encoding the given `string`,\n     * handling invalid code unit sequences according to the `errorMode` policy.\n     */\n    sizeOf(string: string, errorMode?: UtfErrorMode): number;\n\n    /**\n     * Returns the number of bytes in the UTF-8 encoding the given `string`,\n     * assuming the Unicode replacement character (`U+FFFD`) replaces unpaired\n     * surrogates and invalid code points.\n     */\n    sizeOf(string: string): number;\n\n    /**\n     * Returns a new `Output` that accepts UTF-8 code unit sequences, and writes\n     * writes decoded Unicode code points to the composed `output`, handling\n     * invalid code unit sequences according to the `errorMode` policy.\n     */\n    decodedOutput<T>(output: Output<T>, errorMode?: UtfErrorMode): Output<T>;\n\n    /**\n     * Returns a new `Output` that accepts Unicode code points, and writes\n     * encoded UTF-8 code unit sequences to the composed `output`, handling\n     * invalid code unit sequences according to the `errorMode` policy.\n     */\n    encodedOutput<T>(output: Output<T>, errorMode?: UtfErrorMode): Output<T>;\n\n    /**\n     * Returns a new `Output` that accepts UTF-8 code unit sequences, and writes\n     * decoded Unicode code points to a growable `string`, handling invalid code\n     * unit sequences according to the [[UtfErrorMode.fatal]] policy. The\n     * returned `Output` accepts an unbounded number of UTF-8 code units,\n     * remaining permanently in the _cont_ state, and [[Output.bind binds]] a\n     * `string` containing all decoded code points.\n     */\n    decodedString(): Output<string>;\n  };\n\n  Utf8.sizeOf = function (u: string | number | undefined, errorMode?: UtfErrorMode): number {\n    if (typeof u === \"number\" || u === void 0) {\n      if (typeof u === \"number\") {\n        if (u === 0x0000 && errorMode !== void 0 && errorMode.isNonZero()) { // Modified UTF-8\n          return 2; // U+0000 encoded as 0xC0, 0x80\n        } else if (u >= 0x0000 && u <= 0x007F) { // U+0000..U+007F\n          return 1;\n        } else if (u >= 0x0080 && u <= 0x07FF) { // U+0080..U+07FF\n          return 2;\n        } else if (u >= 0x0800 && u <= 0xFFFF || // U+0800..U+D7FF\n                   u >= 0xE000 && u <= 0xFFFF) { // U+E000..U+FFFF\n          return 3;\n        } else if (u >= 0x10000 && u <= 0x10FFFF) { // U+10000..U+10FFFF\n          return 4;\n        }\n      }\n      // surrogate or invalid code point\n      if (errorMode === void 0) {\n        return 3;\n      } else if (errorMode.isReplacement()) {\n        return Utf8.sizeOf(errorMode.replacementChar);\n      } else {\n        return 0;\n      }\n    } else if (typeof u === \"string\") {\n      let size = 0;\n      for (let i = 0, n = u.length; i < n; i = Strings.offsetByCodePoints(u, i, 1)) {\n        size += Utf8.sizeOf(u.charCodeAt(i), errorMode);\n      }\n      return size;\n    } else {\n      throw new TypeError(\"\" + u);\n    }\n  };\n\n  Utf8.decodedOutput = function <T>(output: Output<T>, errorMode?: UtfErrorMode): Output<T> {\n    return Utf8DecodedOutput.create(output, errorMode);\n  };\n\n  Utf8.encodedOutput = function <T>(output: Output<T>, errorMode?: UtfErrorMode): Output<T> {\n    return Utf8EncodedOutput.create(output, errorMode);\n  };\n\n  Utf8.decodedString = function (): Output<string> {\n    return Utf8.decodedOutput(Unicode.stringOutput());\n  };\n\n  return Utf8;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Diagnostic} from \"../source/Diagnostic\";\nimport type {Input} from \"../input/Input\";\nimport type {Output} from \"../output/Output\";\nimport {Parser} from \"../parser/Parser\";\nimport {Unicode} from \"../unicode/Unicode\";\n\n/** @internal */\nexport class Base10NumberParser extends Parser<number> {\n  /** @internal */\n  readonly sign: number;\n  /** @internal */\n  readonly value: number;\n  /** @internal */\n  readonly mode: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(sign: number = 1, value: number = 0, mode: number = 2, step: number = 1) {\n    super();\n    this.sign = sign;\n    this.value = value;\n    this.mode = mode;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<number> {\n    return Base10NumberParser.parse(input, this.sign, this.value, this.mode, this.step);\n  }\n\n  static parse(input: Input, sign: number = 1, value: number = 0,\n               mode: number = 2, step: number = 1): Parser<number> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 45/*'-'*/) {\n          input = input.step();\n          sign = -1;\n        } else if (c === 43/*'+'*/) {\n          input = input.step();\n          sign = 1;\n        }\n        step = 2;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"number\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 48/*'0'*/) {\n          input = input.step();\n          step = 4;\n        } else if (c >= 49/*'1'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          value = sign * (c - 48/*'0'*/);\n          step = 3;\n        } else if (mode > 0 && c === 46/*'.'*/) {\n          let output = Unicode.stringOutput();\n          if (sign < 0) {\n            output = output.write(45/*'-'*/);\n          }\n          return Base10DecimalParser.parse(input, output, mode);\n        } else {\n          return Parser.error(Diagnostic.expected(\"number\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"number\", input));\n      }\n    }\n    if (step === 3) {\n      while (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          const newValue = 10 * value + sign * (c - 48/*'0'*/);\n          if (-9007199254740991 <= newValue && newValue <= 9007199254740992) {\n            value = newValue;\n            input = input.step();\n          } else {\n            return Parser.error(Diagnostic.message(\"integer overflow\", input));\n          }\n        } else {\n          break;\n        }\n      }\n      if (input.isCont()) {\n        step = 4;\n      } else if (input.isDone()) {\n        return Parser.done(value);\n      }\n    }\n    if (step === 4) {\n      if (input.isCont()) {\n        c = input.head();\n        if (mode > 0 && c === 46/*'.'*/ || mode > 1 && (c === 69/*'E'*/ || c === 101/*'e'*/)) {\n          let output = Unicode.stringOutput();\n          if (sign < 0 && value === 0) {\n            output = output.write(45/*'-'*/).write(48/*'0'*/);\n          } else {\n            output = output.write(\"\" + value);\n          }\n          return Base10DecimalParser.parse(input, output, mode);\n        } else {\n          return Parser.done(value);\n        }\n      } else if (input.isDone()) {\n        return Parser.done(value);\n      }\n    }\n    return new Base10NumberParser(sign, value, mode, step);\n  }\n}\n\n/** @internal */\nclass Base10DecimalParser extends Parser<number> {\n  /** @internal */\n  readonly output: Output<string>;\n  /** @internal */\n  readonly mode: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(output: Output<string>, mode: number = 2, step: number = 1) {\n    super();\n    this.output = output;\n    this.mode = mode;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<number> {\n    return Base10DecimalParser.parse(input, this.output, this.mode, this.step);\n  }\n\n  static parse(input: Input, output: Output<string>, mode: number = 2,\n               step: number = 1): Parser<number> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 46/*'.'*/) {\n          input = input.step();\n          output = output.write(c);\n          step = 2;\n        } else if (mode > 1 && (c === 69/*'E'*/ || c === 101/*'e'*/)) {\n          input = input.step();\n          output = output.write(c);\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(\"decimal or exponent\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"decimal or exponent\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n          step = 3;\n        } else {\n          return Parser.error(Diagnostic.expected(\"digit\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"digit\", input));\n      }\n    }\n    if (step === 3) {\n      while (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n        } else {\n          break;\n        }\n      }\n      if (input.isCont()) {\n        if (mode > 1) {\n          step = 4;\n        } else {\n          return Parser.done(+output.bind());\n        }\n      } else if (input.isDone()) {\n        return Parser.done(+output.bind());\n      }\n    }\n    if (step === 4) {\n      c = input.head();\n      if (c === 69/*'E'*/ || c === 101/*'e'*/) {\n        input = input.step();\n        output = output.write(c);\n        step = 5;\n      } else {\n        return Parser.done(+output.bind());\n      }\n    }\n    if (step === 5) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 43/*'+'*/ || c === 45/*'-'*/) {\n          input = input.step();\n          output = output.write(c);\n        }\n        step = 6;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 6) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n          step = 7;\n        } else {\n          return Parser.error(Diagnostic.expected(\"digit\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"digit\", input));\n      }\n    }\n    if (step === 7) {\n      while (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n        } else {\n          break;\n        }\n      }\n      if (!input.isEmpty()) {\n        return Parser.done(+output.bind());\n      }\n    }\n    return new Base10DecimalParser(output, mode, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"../writer/WriterException\";\nimport {Writer} from \"../writer/Writer\";\nimport {Base10} from \"./Base10\";\n\n/** @internal */\nexport class Base10IntegerWriter extends Writer {\n  /** @internal */\n  readonly value: unknown;\n  /** @internal */\n  readonly input: number;\n  /** @internal */\n  readonly index: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(value: unknown, input: number, index: number = 0, step: number = 1) {\n    super();\n    this.value = value;\n    this.input = input;\n    this.index = index;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return Base10IntegerWriter.write(output, this.value, this.input, this.index, this.step);\n  }\n\n  static write(output: Output, value: unknown, input: number, index: number = 0,\n               step: number = 1): Writer {\n    if (step === 0) {\n      return Writer.end();\n    }\n    if (step === 1) {\n      if (input < 0) {\n        if (output.isCont()) {\n          output = output.write(45/*'-'*/);\n          step = 2;\n        }\n      } else {\n        step = 2;\n      }\n    }\n    if (step === 2) {\n      if (input > -10 && input < 10) {\n        if (output.isCont()) {\n          output = output.write(Base10.encodeDigit(Math.abs(input | 0)));\n          return Writer.done(value);\n        }\n      } else {\n        const digits = new Array<number>(19);\n        let x = input;\n        let i = 18;\n        while (x !== 0) {\n          digits[i] = Math.abs((x % 10) | 0);\n          x = (x / 10) | 0;\n          i -= 1;\n        }\n        i += 1 + index;\n        while (i < 19 && output.isCont()) {\n          output = output.write(Base10.encodeDigit(digits[i]!));\n          index += 1;\n          i += 1;\n        }\n        if (i === 19) {\n          return Writer.done(value);\n        }\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new Base10IntegerWriter(value, input, index, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Diagnostic} from \"../source/Diagnostic\";\nimport type {Input} from \"../input/Input\";\nimport type {Output} from \"../output/Output\";\nimport {Parser} from \"../parser/Parser\";\nimport {Base16} from \"./Base16\";\n\n/** @internal */\nexport class Base16Parser<O> extends Parser<O> {\n  /** @internal */\n  readonly output: Output<O>;\n  /** @internal */\n  readonly p: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(output: Output<O>, p: number = 0, step: number = 1) {\n    super();\n    this.output = output;\n    this.p = p;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<O> {\n    return Base16Parser.parse(input, this.output.clone(), this.p, this.step);\n  }\n\n  static parse<O>(input: Input, output: Output<O>, p: number = 0, step: number = 1): Parser<O> {\n    let c = 0;\n    while (!input.isEmpty()) {\n      if (step === 1) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          p = c;\n          step = 2;\n        } else if (!input.isEmpty()) {\n          return Parser.done(output.bind());\n        }\n      }\n      if (step === 2) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          output = Base16.writeQuantum(output, p, c);\n          p = 0;\n          step = 1;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"base16 digit\", input));\n        }\n      }\n    }\n    return new Base16Parser<O>(output, p, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"../writer/WriterException\";\nimport {Writer} from \"../writer/Writer\";\nimport type {Base16} from \"./Base16\";\n\n/** @internal */\nexport class Base16Writer extends Writer {\n  /** @internal */\n  readonly base16: Base16;\n  /** @internal */\n  readonly value: unknown;\n  /** @internal */\n  readonly input: Uint8Array | null;\n  /** @internal */\n  readonly index: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(base16: Base16, value: unknown, input: Uint8Array | null,\n              index: number = 0, step: number = 1) {\n    super();\n    this.base16 = base16;\n    this.value = value;\n    this.input = input;\n    this.index = index;\n    this.step = step;\n  }\n\n  override feed(value: unknown): Writer {\n    if (value instanceof Uint8Array) {\n      return new Base16Writer(this.base16, void 0, value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  override pull(output: Output): Writer {\n    if (this.input === null) {\n      throw new WriterException();\n    }\n    return Base16Writer.write(output, this.base16, this.value, this.input,\n                              this.index, this.step);\n  }\n\n  static write(output: Output, base16: Base16, value: unknown, input: Uint8Array,\n               index: number = 0, step: number = 1): Writer {\n    while (index < input.length) {\n      const x = input[index]!;\n      if (step === 1 && output.isCont()) {\n        output = output.write(base16.encodeDigit(x >>> 4));\n        step = 2;\n      }\n      if (step === 2 && output.isCont()) {\n        output = output.write(base16.encodeDigit(x & 0x0f));\n        index += 1;\n        step = 1;\n      }\n    }\n    if (index === input.length) {\n      return Writer.done(value);\n    } else if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new Base16Writer(base16, value, input, index, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"../writer/WriterException\";\nimport {Writer} from \"../writer/Writer\";\nimport type {Base16} from \"./Base16\";\n\n/** @internal */\nexport class Base16IntegerWriter extends Writer {\n  /** @internal */\n  readonly base16: Base16;\n  /** @internal */\n  readonly value: unknown;\n  /** @internal */\n  readonly input: number;\n  /** @internal */\n  readonly width: number;\n  /** @internal */\n  readonly index: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(base16: Base16, value: unknown, input: number,\n              width: number, index: number = 0, step: number = 3) {\n    super();\n    this.base16 = base16;\n    this.value = value;\n    this.input = input;\n    this.width = width;\n    this.index = index;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return Base16IntegerWriter.write(output, this.base16, this.value, this.input,\n                                     this.width, this.index, this.step);\n  }\n\n  static write(output: Output, base16: Base16, value: unknown, input: number,\n               width: number, index: number = 0, step: number = 3): Writer {\n    if (step <= 0) {\n      return Writer.end();\n    }\n    if (step === 1 && output.isCont()) {\n      output = output.write(48/*'0'*/);\n      step = 2;\n    }\n    if (step === 2 && output.isCont()) {\n      output = output.write(120/*'x'*/);\n      step = 3;\n    }\n    if (step === 3) {\n      if (input >= 0 && input < 16 && width <= 1) {\n        if (output.isCont()) {\n          output = output.write(base16.encodeDigit(input));\n          return Writer.done(value);\n        }\n      } else {\n        let i = 15;\n        const digits = new Array<number>(16);\n        let x = input;\n        while (x !== 0 || i >= 16 - width) {\n          digits[i] = x & 0xf;\n          x >>>= 4;\n          i -= 1;\n        }\n        i += 1 + index;\n        while (i < 16 && output.isCont()) {\n          output = output.write(base16.encodeDigit(digits[i]!));\n          index += 1;\n          i += 1;\n        }\n        if (i === 16) {\n          return Writer.done(value);\n        }\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new Base16IntegerWriter(base16, value, input, width, index, step);\n  }\n\n  static writeLiteral(output: Output, base16: Base16, value: unknown,\n                      input: number, width: number): Writer {\n    return Base16IntegerWriter.write(output, base16, value, input, width, 0, 1);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport type {Input} from \"../input/Input\";\nimport {Output} from \"../output/Output\";\nimport type {Parser} from \"../parser/Parser\";\nimport type {Writer} from \"../writer/Writer\";\nimport {Format} from \"../format/Format\";\nimport {Binary} from \"../binary/Binary\";\nimport {Unicode} from \"../unicode/Unicode\";\nimport {Base64Parser} from \"../\"; // forward import\nimport {Base64Writer} from \"../\"; // forward import\n\n/**\n * Base-64 (7-bit ASCII) encoding [[Parser]]/[[Writer]] factory.\n * @public\n */\nexport abstract class Base64 {\n  /**\n   * The 64 character string, where the character at index `i` is the encoding\n   * of the base-64 digit `i`.\n   */\n  abstract readonly alphabet: string;\n\n  /**\n   * Returns `true` if this base-64 encoding requires padding.\n   */\n  abstract isPadded(): boolean;\n\n  /**\n   * Returns this `Base64` encoding with required padding, if `padded` is `true`.\n   */\n  abstract asPadded(padded: boolean): Base64;\n\n  /**\n   * Returns `true` if the Unicode code point `c` is a valid base-64 digit.\n   */\n  abstract isDigit(c: number): boolean;\n\n  /**\n   * Returns the 7-bit quantity represented by the base-64 digit `c`.\n   *\n   * @throws `Error` if `c` is not a valid base-64 digit.\n   */\n  decodeDigit(c: number): number {\n    if (c >= 65/*'A'*/ && c <= 90/*'Z'*/) {\n      return c - 65/*'A'*/;\n    } else if (c >= 97/*'a'*/ && c <= 122/*'z'*/) {\n      return c + (26 - 97/*'a'*/);\n    } else if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n      return c + (52 - 48/*'0'*/);\n    } else if (c === 43/*'+'*/ || c === 45/*'-'*/) {\n      return 62;\n    } else if (c === 47/*'/'*/ || c === 95/*'_'*/) {\n      return 63;\n    } else {\n      let message = Unicode.stringOutput();\n      message = message.write(\"Invalid base-64 digit: \");\n      message = Format.debugChar(message, c);\n      throw new Error(message.bind());\n    }\n  }\n\n  /**\n   * Returns the Unicode code point of the base-64 digit that encodes the given\n   * 7-bit quantity.\n   */\n  encodeDigit(b: number): number {\n    return this.alphabet.charCodeAt(b);\n  }\n\n  /**\n   * Decodes the base-64 digits `c1`, `c2`, `c3`, and `c4`, and writes the 8 to\n   * 24 bit quantity they represent to the given `output`.\n   *\n   * @returns the continuation of the `output`.\n   */\n  writeQuantum<T>(output: Output<T>, c1: number, c2: number, c3: number, c4: number): Output<T> {\n    const x = this.decodeDigit(c1);\n    const y = this.decodeDigit(c2);\n    if (c3 !== 61/*'='*/) {\n      const z = this.decodeDigit(c3);\n      if (c4 !== 61/*'='*/) {\n        const w = this.decodeDigit(c4);\n        output = output.write((x << 2) | (y >>> 4));\n        output = output.write((y << 4) | (z >>> 2));\n        output = output.write((z << 6) | w);\n      } else {\n        output = output.write((x << 2) | (y >>> 4));\n        output = output.write((y << 4) | (z >>> 2));\n      }\n    } else {\n      if (c4 !== 61/*'='*/) {\n        return Output.error(new Error(\"Improperly padded base-64\"));\n      }\n      output = output.write((x << 2) | (y >>> 4));\n    }\n    return output;\n  }\n\n  /**\n   * Returns a `Parser` that decodes base-64 (7-bit ASCII) encoded input, and\n   * writes the decoded bytes to `output`.\n   */\n  parser<O>(output: Output<O>): Parser<O> {\n    return new Base64Parser<O>(this, output);\n  }\n\n  /**\n   * Parses the base-64 (7-bit ASCII) encoded `input`, and writes the decoded\n   * bytes to `output`, returning a `Parser` continuation that knows how to\n   * parse any additional input.\n   */\n  parse<O>(input: Input, output: Output<O>): Parser<O> {\n    return Base64Parser.parse(input, this, output);\n  }\n\n  /**\n   * Parses the base-64 (7-bit ASCII) encoded `input`, and writes the decoded\n   * bytes to a growable array, returning a `Parser` continuation that knows\n   * how to parse any additional input. The returned `Parser` [[Parser.bind\n   * binds]] a `Uint8Array` array containing all parsed base-64 data.\n   */\n  parseUint8Array(input: Input): Parser<Uint8Array> {\n    return Base64Parser.parse(input, this, Binary.output());\n  }\n\n  /**\n   * Returns a `Writer` that, when fed an input `Uint8Array`, returns a\n   * continuation that writes the base-64 (7-bit ASCII) encoding of the input\n   * `Uint8Array`.\n   */\n  uint8ArrayWriter(): Writer<Uint8Array, unknown>;\n  /**\n   * Returns a `Writer` continuation that writes the base-64 (7-bit ASCII)\n   * encoding of the `input` byte array.\n   */\n  uint8ArrayWriter(input: Uint8Array): Writer<unknown, Uint8Array>;\n  uint8ArrayWriter(input?: Uint8Array): Writer {\n    if (input === void 0) {\n      return new Base64Writer(this, void 0, null);\n    } else {\n      return new Base64Writer(this, input, input);\n    }\n  }\n\n  /**\n   * Writes the base-64 (7-bit ASCII) encoding of the `input` `Uint8Array` to\n   * the `output`, returning a `Writer` continuation that knows how to write\n   * any remaining output that couldn't be immediately generated.\n   */\n  writeUint8Array(output: Output, input: Uint8Array): Writer {\n    return Base64Writer.write(output, this, void 0, input);\n  }\n\n  /** @internal */\n  @Lazy\n  static get standardPadded(): Base64 {\n    return new Base64Standard(true);\n  }\n\n  /** @internal */\n  @Lazy\n  static get standardUnpadded(): Base64 {\n    return new Base64Standard(false);\n  }\n\n  /**\n   * Returns the `Base64` encoding with the standard alphabet, and required\n   * padding, if `isPadding` is `true`.\n   */\n  static standard(padded: boolean = true): Base64 {\n    if (padded) {\n      return Base64.standardPadded;\n    } else {\n      return Base64.standardUnpadded;\n    }\n  }\n\n  /** @internal */\n  @Lazy\n  static get urlPadded(): Base64 {\n    return new Base64Url(true);\n  }\n\n  /** @internal */\n  @Lazy\n  static get urlUnpadded(): Base64 {\n    return new Base64Url(false);\n  }\n\n  /**\n   * Returns the `Base64` encoding with the url and filename safe alphabet,\n   * and required padding, if `padded` is `true`.\n   */\n  static url(padded: boolean = true): Base64 {\n    if (padded) {\n      return Base64.urlPadded;\n    } else {\n      return Base64.urlUnpadded;\n    }\n  }\n}\n\n/** @internal */\nclass Base64Standard extends Base64 {\n  constructor(padded: boolean) {\n    super();\n    Object.defineProperty(this, \"padded\", {\n      value: padded,\n      enumerable: true,\n    });\n  }\n\n  get alphabet(): string {\n    return \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n  }\n\n  /** @internal */\n  readonly padded!: boolean;\n\n  isPadded(): boolean {\n    return this.padded;\n  }\n\n  asPadded(padded: boolean): Base64 {\n    if (padded === this.padded) {\n      return this;\n    } else {\n      return Base64.standard(padded);\n    }\n  }\n\n  isDigit(c: number): boolean {\n    return c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c === 43/*'+'*/ || c === 47/*'/'*/;\n  }\n}\n\n/** @internal */\nclass Base64Url extends Base64 {\n  constructor(padded: boolean) {\n    super();\n    Object.defineProperty(this, \"padded\", {\n      value: padded,\n      enumerable: true,\n    });\n  }\n\n  get alphabet(): string {\n    return \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\";\n  }\n\n  /** @internal */\n  readonly padded!: boolean;\n\n  isPadded(): boolean {\n    return this.padded;\n  }\n\n  asPadded(padded: boolean): Base64 {\n    if (padded === this.padded) {\n      return this;\n    } else {\n      return Base64.url(padded);\n    }\n  }\n\n  isDigit(c: number): boolean {\n    return c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c === 45/*'-'*/ || c === 95/*'_'*/;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Diagnostic} from \"../source/Diagnostic\";\nimport type {Input} from \"../input/Input\";\nimport type {Output} from \"../output/Output\";\nimport {Parser} from \"../parser/Parser\";\nimport type {Base64} from \"./Base64\";\n\n/** @internal */\nexport class Base64Parser<O> extends Parser<O> {\n  /** @internal */\n  readonly base64: Base64;\n  /** @internal */\n  readonly output: Output<O>;\n  /** @internal */\n  readonly p: number;\n  /** @internal */\n  readonly q: number;\n  /** @internal */\n  readonly r: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(base64: Base64, output: Output<O>, p: number = 0, q: number = 0,\n              r: number = 0, step: number = 1) {\n    super();\n    this.base64 = base64;\n    this.output = output;\n    this.p = p;\n    this.q = q;\n    this.r = r;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<O> {\n    return Base64Parser.parse(input, this.base64, this.output.clone(),\n                              this.p, this.q, this.r, this.step);\n  }\n\n  static parse<O>(input: Input, base64: Base64, output: Output<O>, p: number = 0,\n                  q: number = 0, r: number = 0, step: number = 1): Parser<O> {\n    let c = 0;\n    while (!input.isEmpty()) {\n      if (step === 1) {\n        if (input.isCont() && (c = input.head(), base64.isDigit(c))) {\n          input = input.step();\n          p = c;\n          step = 2;\n        } else if (!input.isEmpty()) {\n          return Parser.done(output.bind());\n        }\n      }\n      if (step === 2) {\n        if (input.isCont() && (c = input.head(), base64.isDigit(c))) {\n          input = input.step();\n          q = c;\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"base64 digit\", input));\n        }\n      }\n      if (step === 3) {\n        if (input.isCont() && (c = input.head(), base64.isDigit(c) || c === 61/*'='*/)) {\n          input = input.step();\n          r = c;\n          if (c !== 61/*'='*/) {\n            step = 4;\n          } else {\n            step = 5;\n          }\n        } else if (!input.isEmpty()) {\n          if (!base64.isPadded()) {\n            output = base64.writeQuantum(output, p, q, 61/*'='*/, 61/*'='*/);\n            return Parser.done(output.bind());\n          } else {\n            return Parser.error(Diagnostic.unexpected(input));\n          }\n        }\n      }\n      if (step === 4) {\n        if (input.isCont() && (c = input.head(), base64.isDigit(c) || c === 61/*'='*/)) {\n          input = input.step();\n          output = base64.writeQuantum(output, p, q, r, c);\n          r = 0;\n          q = 0;\n          p = 0;\n          if (c !== 61/*'='*/) {\n            step = 1;\n          } else {\n            return Parser.done(output.bind());\n          }\n        } else if (!input.isEmpty()) {\n          if (!base64.isPadded()) {\n            output = base64.writeQuantum(output, p, q, r, 61/*'='*/);\n            return Parser.done(output.bind());\n          } else {\n            return Parser.error(Diagnostic.unexpected(input));\n          }\n        }\n      } else if (step === 5) {\n        if (input.isCont() && (c = input.head(), c === 61/*'='*/)) {\n          input = input.step();\n          output = base64.writeQuantum(output, p, q, r, c);\n          r = 0;\n          q = 0;\n          p = 0;\n          return Parser.done(output.bind());\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(61/*'='*/, input));\n        }\n      }\n    }\n    return new Base64Parser<O>(base64, output, p, q, r, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"../output/Output\";\nimport {WriterException} from \"../writer/WriterException\";\nimport {Writer} from \"../writer/Writer\";\nimport type {Base64} from \"./Base64\";\n\n/** @internal */\nexport class Base64Writer extends Writer {\n  /** @internal */\n  readonly base64: Base64;\n  /** @internal */\n  readonly value: unknown;\n  /** @internal */\n  readonly input: Uint8Array | null;\n  /** @internal */\n  readonly index: number;\n  /** @internal */\n  readonly step: number;\n\n  constructor(base64: Base64, value: unknown, input: Uint8Array | null,\n              index: number = 0, step: number = 1) {\n    super();\n    this.base64 = base64;\n    this.value = value;\n    this.input = input;\n    this.index = index;\n    this.step = step;\n  }\n\n  override feed(value: unknown): Writer {\n    if (value instanceof Uint8Array) {\n      return new Base64Writer(this.base64, null, value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  override pull(output: Output): Writer {\n    if (this.input === null) {\n      throw new WriterException();\n    }\n    return Base64Writer.write(output, this.base64, this.value, this.input,\n                              this.index, this.step);\n  }\n\n  static write(output: Output, base64: Base64, value: unknown, input: Uint8Array,\n               index: number = 0, step: number = 1): Writer {\n    while (index + 2 < input.length && output.isCont()) {\n      const x = input[index]!;\n      const y = input[index + 1]!;\n      const z = input[index + 2]!;\n      if (step === 1 && output.isCont()) {\n        output = output.write(base64.encodeDigit(x >>> 2));\n        step = 2;\n      }\n      if (step === 2 && output.isCont()) {\n        output = output.write(base64.encodeDigit(((x << 4) | (y >>> 4)) & 0x3f));\n        step = 3;\n      }\n      if (step === 3 && output.isCont()) {\n        output = output.write(base64.encodeDigit(((y << 2) | (z >>> 6)) & 0x3f));\n        step = 4;\n      }\n      if (step === 4 && output.isCont()) {\n        output = output.write(base64.encodeDigit(z & 0x3f));\n        index += 3;\n        step = 1;\n      }\n    }\n    if (index + 1 < input.length && output.isCont()) {\n      const x = input[index]!;\n      const y = input[index + 1]!;\n      if (step === 1 && output.isCont()) {\n        output = output.write(base64.encodeDigit(x >>> 2));\n        step = 2;\n      }\n      if (step === 2 && output.isCont()) {\n        output = output.write(base64.encodeDigit(((x << 4) | (y >>> 4)) & 0x3f));\n        step = 3;\n      }\n      if (step === 3 && output.isCont()) {\n        output = output.write(base64.encodeDigit((y << 2) & 0x3f));\n        step = 4;\n      }\n      if (step === 4) {\n        if (!base64.isPadded()) {\n          index += 2;\n        } else if (output.isCont()) {\n          output = output.write(61/*'='*/);\n          index += 2;\n        }\n      }\n    } else if (index < input.length && output.isCont()) {\n      const x = input[index]!;\n      if (step === 1 && output.isCont()) {\n        output = output.write(base64.encodeDigit(x >>> 2));\n        step = 2;\n      }\n      if (step === 2 && output.isCont()) {\n        output = output.write(base64.encodeDigit((x << 4) & 0x3f));\n        step = 3;\n      }\n      if (step === 3) {\n        if (!base64.isPadded()) {\n          index += 1;\n        } else if (output.isCont()) {\n          output = output.write(61/*'='*/);\n          step = 4;\n        }\n      }\n      if (step === 4 && output.isCont()) {\n        output = output.write(61/*'='*/);\n        index += 1;\n      }\n    }\n    if (index === input.length) {\n      return Writer.done(value);\n    } else if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new Base64Writer(base64, value, input, index, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\n\n/** @public */\nexport type Affinity = number;\n\n/** @public */\nexport const Affinity = (function () {\n  const Affinity = {} as {\n    readonly Transient: Affinity;\n    readonly Inherited: Affinity;\n    readonly Intrinsic: Affinity;\n    readonly Extrinsic: Affinity;\n\n    readonly Reflexive: Affinity;\n\n    /** @internal */\n    readonly Shift: number;\n    /** @internal */\n    readonly Mask: number;\n  };\n\n  (Affinity as Mutable<typeof Affinity>).Transient = 0;\n  (Affinity as Mutable<typeof Affinity>).Inherited = 1;\n  (Affinity as Mutable<typeof Affinity>).Intrinsic = 2;\n  (Affinity as Mutable<typeof Affinity>).Extrinsic = 3;\n\n  (Affinity as Mutable<typeof Affinity>).Reflexive = 1 << 2;\n\n  (Affinity as Mutable<typeof Affinity>).Shift = 2;\n  (Affinity as Mutable<typeof Affinity>).Mask = (1 << Affinity.Shift) - 1;\n\n  return Affinity;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Class} from \"@swim/util\";\nimport type {FastenerDescriptor, FastenerClass, FastenerFactory, Fastener} from \"./Fastener\";\n\n/** @public */\nexport interface FastenerContextClass {\n  /** @internal */\n  fastenerClassMap?: {[fastenerName: string]: FastenerClass | undefined};\n  /** @internal */\n  fastenerClassInitMap?: {[fastenerName: string]: FastenerClass | undefined};\n}\n\n/** @public */\nexport interface FastenerContext {\n  hasFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): boolean;\n\n  getFastener<F extends Fastener<any>>(fastenerName: string, fastenerBound: Class<F>): F | null;\n  getFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n\n  setFastener(fastenerName: string, fastener: Fastener | null): void;\n\n  getLazyFastener<F extends Fastener<any>>(fastenerName: string, fastenerBound: Class<F>): F | null;\n  getLazyFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n\n  getSuperFastener<F extends Fastener<any>>(fastenerName: string, fastenerBound: Class<F>): F | null;\n  getSuperFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n\n  decohereFastener?(fastener: Fastener): void;\n\n  requireUpdate?(updateFlags: number): void;\n}\n\n/** @public */\nexport const FastenerContext = (function () {\n  const FastenerContext = {} as {\n    getLazyFastener<F extends Fastener<any>>(fastenerContext: FastenerContext, fastenerName: string, fastenerBound: Class<F>): F | null;\n    getLazyFastener(fastenerContext: FastenerContext, fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n  \n    getFastenerClass<F extends Fastener<any>>(contextClass: FastenerContextClass, fastenerName: string, fastenerBound: Class<F>): FastenerClass | null;\n    getFastenerClass(contextClass: FastenerContextClass, fastenerName: string, fastenerBound?: Class<Fastener> | null): FastenerClass | null;\n  \n    getSuperFastenerClass(contextClass: FastenerContextClass, fastenerName: string, fastenerBound?: Class<Fastener> | null): FastenerClass;\n  \n    decorate(factory: FastenerFactory, descriptor: FastenerDescriptor, target: Object, propertyKey: string | symbol): void;\n\n    decorator(factory: FastenerFactory, descriptor: FastenerDescriptor): PropertyDecorator;\n\n    init(fastenerContext: FastenerContext): void;\n  \n    /** @internal */\n    has<K extends keyof FastenerContext>(object: unknown, key: K): object is Required<Pick<FastenerContext, K>>;\n\n    /** @internal */\n    is(object: unknown): object is FastenerContext;\n  };\n\n  FastenerContext.getLazyFastener = function (fastenerContext: FastenerContext, fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null {\n    let fastener = fastenerContext.getFastener(fastenerName);\n    if (fastener === null) {\n      const contextClass = fastenerContext.constructor as FastenerContextClass;\n      const fastenerClass = FastenerContext.getFastenerClass(contextClass, fastenerName, fastenerBound);\n      if (fastenerClass !== null) {\n        fastener = fastenerClass.create(fastenerContext);\n        fastenerContext.setFastener(fastenerName, fastener);\n      }\n    } else if (fastenerBound !== void 0 && fastenerBound !== null && !(fastener instanceof fastenerBound)) {\n      fastener = null;\n    }\n    return fastener;\n  };\n\n  FastenerContext.getFastenerClass = function (contextClass: FastenerContextClass, fastenerName: string, fastenerBound: Class<Fastener> | null): FastenerClass | null {\n    do {\n      if (Object.prototype.hasOwnProperty.call(contextClass, \"fastenerClassMap\")) {\n        const fastenerClass = contextClass.fastenerClassMap![fastenerName];\n        if (fastenerClass !== void 0 && (fastenerBound === void 0 || fastenerBound === null || fastenerClass.prototype instanceof fastenerBound)) {\n          return fastenerClass;\n        }\n      }\n      contextClass = Object.getPrototypeOf(contextClass);\n    } while (contextClass !== null);\n    return null;\n  };\n\n  FastenerContext.getSuperFastenerClass = function (contextClass: FastenerContextClass, fastenerName: string, fastenerBound?: Class<Fastener> | null): FastenerClass {\n    const superContextClass = Object.getPrototypeOf(contextClass) as FastenerContextClass;\n    const fastenerClass = FastenerContext.getFastenerClass(superContextClass, fastenerName, fastenerBound);\n    if (fastenerClass === null) {\n      throw new Error(\"No \" + fastenerName + \" \" + (fastenerBound !== void 0 && fastenerBound !== null ? fastenerBound.name : \"fastener\") + \" class in \" + superContextClass.constructor.name);\n    }\n    return fastenerClass;\n  };\n\n  FastenerContext.decorate = function (factory: FastenerFactory, descriptor: FastenerDescriptor, target: Object, propertyKey: string | symbol): void {\n    const contextClass = target.constructor as FastenerContextClass;\n    const fastenerName = propertyKey.toString();\n\n    const fastenerExtends = descriptor.extends;\n    if (typeof fastenerExtends === \"string\") {\n      Object.defineProperty(descriptor, \"extends\", {\n        value: FastenerContext.getSuperFastenerClass(contextClass, fastenerExtends),\n        writable: true,\n        enumerable: true,\n        configurable: true,\n      });\n    } else if (fastenerExtends === true) {\n      Object.defineProperty(descriptor, \"extends\", {\n        value: FastenerContext.getSuperFastenerClass(contextClass, fastenerName),\n        writable: true,\n        enumerable: true,\n        configurable: true,\n      });\n    } else if (fastenerExtends === false) {\n      Object.defineProperty(descriptor, \"extends\", {\n        value: null,\n        writable: true,\n        enumerable: true,\n        configurable: true,\n      });\n    }\n\n    const fastenerClass = factory.define(fastenerName, descriptor);\n    fastenerClass.contextClass = contextClass;\n\n    if (!Object.prototype.hasOwnProperty.call(contextClass, \"fastenerClassMap\")) {\n      contextClass.fastenerClassMap = {};\n    }\n    contextClass.fastenerClassMap![fastenerName] = fastenerClass;\n\n    if (!fastenerClass.prototype.lazy) {\n      if (!Object.prototype.hasOwnProperty.call(contextClass, \"fastenerClassInitMap\")) {\n        contextClass.fastenerClassInitMap = {};\n      }\n      contextClass.fastenerClassInitMap![fastenerName] = fastenerClass;\n    }\n\n    let staticName = fastenerClass.prototype.static;\n    if (staticName !== false) {\n      if (staticName === true) {\n        staticName = fastenerName;\n      }\n      (contextClass as any)[staticName] = fastenerClass;\n    }\n\n    Object.defineProperty(target, propertyKey, {\n      get: function (this: FastenerContext): Fastener {\n        let fastener = this.getFastener(fastenerName);\n        if (fastener === null) {\n          fastener = fastenerClass.create(this);\n          this.setFastener(fastenerName, fastener);\n        }\n        return fastener;\n      },\n      configurable: true,\n    });\n  };\n\n  FastenerContext.decorator = function (factory: FastenerFactory, descriptor: FastenerDescriptor): PropertyDecorator {\n    return FastenerContext.decorate.bind(FastenerContext, factory, descriptor);\n  };\n\n  FastenerContext.init = function (fastenerContext: FastenerContext): void {\n    let contextClass: FastenerContextClass | null = fastenerContext.constructor as FastenerContextClass;\n    do {\n      if (Object.prototype.hasOwnProperty.call(contextClass, \"fastenerClassInitMap\")) {\n        const fastenerClassInitMap = contextClass.fastenerClassInitMap!;\n        for (const fastenerName in fastenerClassInitMap) {\n          const fastenerClass = fastenerClassInitMap[fastenerName]!;\n          if (!fastenerContext.hasFastener(fastenerName)) {\n            const fastener = fastenerClass.create(fastenerContext);\n            fastenerContext.setFastener(fastenerName, fastener);\n          }\n        }\n      }\n      contextClass = Object.getPrototypeOf(contextClass);\n    } while (contextClass !== null);\n  };\n\n  FastenerContext.has = function <K extends keyof FastenerContext>(object: unknown, key: K): object is Required<Pick<FastenerContext, K>> {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      return key in object;\n    }\n    return false;\n  };\n\n  FastenerContext.is = function (object: unknown): object is FastenerContext {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const fastenerContext = object as FastenerContext;\n      return \"hasFastener\" in fastenerContext;\n    }\n    return false;\n  };\n\n  return FastenerContext;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Class, Family, Identifiers} from \"@swim/util\";\nimport {Affinity} from \"./Affinity\";\nimport {FastenerContextClass, FastenerContext} from \"./FastenerContext\";\n\n/** @internal */\nexport type MemberFasteners<O, F extends Fastener<any> = Fastener<any>> =\n  {[K in keyof O as O[K] extends F ? K : never]: O[K]};\n\n/** @internal */\nexport type MemberFastener<O, K extends keyof MemberFasteners<O, F>, F extends Fastener<any> = Fastener<any>> =\n  MemberFasteners<O, F>[K] extends F ? MemberFasteners<O, F>[K] : never;\n\n/** @internal */\nexport type MemberFastenerClass<O, K extends keyof MemberFasteners<O, F>, F extends Fastener<any> = Fastener<any>> =\n  MemberFasteners<O, F>[K] extends F ? FastenerClass<MemberFasteners<O, F>[K]> : never;\n\n/** @public */\nexport type FastenerOwner<F> =\n  F extends Fastener<infer O> ? O : never;\n\n/** @public */\nexport type FastenerFlags = number;\n\n/** @public */\nexport interface FastenerInit {\n  name?: string;\n  lazy?: boolean;\n  static?: string | boolean;\n  extends?: {prototype: Fastener<any>} | string | boolean | null;\n  affinity?: Affinity;\n  inherits?: string | boolean;\n\n  init?(): void;\n\n  willSetAffinity?(newAffinity: Affinity, oldAffinity: Affinity): void;\n  didSetAffinity?(newAffinity: Affinity, oldAffinity: Affinity): void;\n\n  willSetInherits?(inherits: boolean, superName: string | undefined): void;\n  didSetInherits?(inherits: boolean, superName: string | undefined): void;\n\n  willInherit?(superFastener: Fastener): void;\n  didInherit?(superFastener: Fastener): void;\n  willUninherit?(superFastener: Fastener): void;\n  didUninherit?(superFastener: Fastener): void;\n\n  willBindSuperFastener?(superFastener: Fastener): void;\n  didBindSuperFastener?(superFastener: Fastener): void;\n  willUnbindSuperFastener?(superFastener: Fastener): void;\n  didUnbindSuperFastener?(superFastener: Fastener): void;\n\n  willMount?(): void;\n  didMount?(): void;\n  willUnmount?(): void;\n  didUnmount?(): void;\n}\n\n/** @public */\nexport type FastenerDescriptor<O = unknown, I = {}> = ThisType<Fastener<O> & I> & FastenerInit & Partial<I>;\n\n/** @public */\nexport interface FastenerClass<F extends Fastener<any> = Fastener<any>> extends Function {\n  /** @internal */\n  prototype: F;\n\n  /** @internal */\n  contextClass?: FastenerContextClass;\n\n  create(owner: FastenerOwner<F>): F;\n\n  construct(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F;\n\n  /** @internal */\n  readonly MountedFlag: FastenerFlags;\n  /** @internal */\n  readonly InheritsFlag: FastenerFlags;\n  /** @internal */\n  readonly InheritedFlag: FastenerFlags;\n  /** @internal */\n  readonly DecoherentFlag: FastenerFlags;\n\n  /** @internal */\n  readonly FlagShift: number;\n  /** @internal */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface FastenerFactory<F extends Fastener<any> = Fastener<any>> extends FastenerClass<F> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): FastenerFactory<F> & I;\n\n  define<O>(className: string, descriptor: FastenerDescriptor<O>): FastenerFactory<Fastener<any>>;\n  define<O, I = {}>(className: string, descriptor: FastenerDescriptor<O, I>): FastenerFactory<Fastener<any> & I>;\n\n  <O>(descriptor: FastenerDescriptor<O>): PropertyDecorator;\n  <O, I = {}>(descriptor: FastenerDescriptor<O, I>): PropertyDecorator;\n}\n\n/** @public */\nexport interface Fastener<O = unknown> extends Family {\n  readonly owner: O;\n\n  /** @internal */\n  init(): void;\n\n  /** @override */\n  get familyType(): Class<Fastener<any>> | null;\n\n  get name(): string;\n\n  /** @internal */\n  readonly flags: FastenerFlags;\n\n  /** @internal */\n  setFlags(flags: FastenerFlags): void;\n\n  get affinity(): Affinity;\n\n  hasAffinity(affinity: Affinity): boolean;\n\n  /** @internal */\n  initAffinity(affinity: Affinity): void;\n\n  /** @internal */\n  minAffinity(affinity: Affinity | undefined): boolean;\n\n  setAffinity(affinity: Affinity): void;\n\n  /** @protected */\n  willSetAffinity(newAffinity: Affinity, oldAffinity: Affinity): void;\n\n  /** @protected */\n  onSetAffinity(newAffinity: Affinity, oldAffinity: Affinity): void;\n\n  /** @protected */\n  didSetAffinity(newAffinity: Affinity, oldAffinity: Affinity): void;\n\n  get inherits(): boolean;\n\n  /** @internal */\n  initInherits(inherits: string | boolean): void;\n\n  setInherits(inherits: string | boolean): void;\n\n  /** @protected */\n  willSetInherits(inherits: boolean, superName: string | undefined): void;\n\n  /** @protected */\n  onSetInherits(inherits: boolean, superName: string | undefined): void;\n\n  /** @protected */\n  didSetInherits(inherits: boolean, superName: string | undefined): void;\n\n  get inherited(): boolean;\n\n  /** @internal */\n  setInherited(inherited: boolean, superFastener: Fastener): void;\n\n  /** @protected */\n  willInherit(superFastener: Fastener): void;\n\n  /** @protected */\n  onInherit(superFastener: Fastener): void;\n\n  /** @protected */\n  didInherit(superFastener: Fastener): void;\n\n  /** @protected */\n  willUninherit(superFastener: Fastener): void;\n\n  /** @protected */\n  onUninherit(superFastener: Fastener): void;\n\n  /** @protected */\n  didUninherit(superFastener: Fastener): void;\n\n  get superName(): string | undefined;\n\n  get superFastener(): Fastener | null;\n\n  /** @internal */\n  getSuperFastener(): Fastener | null;\n\n  /** @internal */\n  bindSuperFastener(): void;\n\n  /** @protected */\n  willBindSuperFastener(superFastener: Fastener): void;\n\n  /** @protected */\n  onBindSuperFastener(superFastener: Fastener): void;\n\n  /** @protected */\n  didBindSuperFastener(superFastener: Fastener): void;\n\n  /** @internal */\n  unbindSuperFastener(): void;\n\n  /** @protected */\n  willUnbindSuperFastener(superFastener: Fastener): void;\n\n  /** @protected */\n  onUnbindSuperFastener(superFastener: Fastener): void;\n\n  /** @protected */\n  didUnbindSuperFastener(superFastener: Fastener): void;\n\n  /** @internal */\n  attachSubFastener(subFastener: Fastener): void;\n\n  /** @internal */\n  detachSubFastener(subFastener: Fastener): void;\n\n  get coherent(): boolean;\n\n  /** @internal */\n  setCoherent(coherent: boolean): void;\n\n  /** @internal */\n  decohere(): void;\n\n  /** @internal */\n  recohere(t: number): void;\n\n  get mounted(): boolean;\n\n  /** @internal */\n  mount(): void;\n\n  /** @protected */\n  willMount(): void;\n\n  /** @protected */\n  onMount(): void;\n\n  /** @protected */\n  didMount(): void;\n\n  /** @internal */\n  unmount(): void;\n\n  /** @protected */\n  willUnmount(): void;\n\n  /** @protected */\n  onUnmount(): void;\n\n  /** @protected */\n  didUnmount(): void;\n\n  /** @override */\n  toString(): string;\n\n  /** @internal */\n  get lazy(): boolean; // prototype property\n\n  /** @internal */\n  get static(): string | boolean; // prototype property\n}\n\n/** @public */\nexport const Fastener = (function (_super: typeof Object) {\n  const Fastener = function (descriptor: FastenerDescriptor): PropertyDecorator {\n    return FastenerContext.decorator(Fastener, descriptor);\n  } as FastenerFactory;\n\n  Fastener.prototype = Object.create(_super.prototype);\n  Fastener.prototype.constructor = Fastener;\n\n  Fastener.prototype.init = function (this: Fastener): void {\n    // hook\n  };\n\n  Object.defineProperty(Fastener.prototype, \"familyType\", {\n    get: function (this: Fastener): Class<Fastener<any>> | null {\n      return null;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(Fastener.prototype, \"name\", {\n    value: \"\",\n    configurable: true,\n  });\n\n  Fastener.prototype.setFlags = function (this: Fastener, flags: FastenerFlags): void {\n    (this as Mutable<typeof this>).flags = flags;\n  };\n\n  Object.defineProperty(Fastener.prototype, \"affinity\", {\n    get(this: Fastener): Affinity {\n      return this.flags & Affinity.Mask;\n    },\n    configurable: true,\n  });\n\n  Fastener.prototype.hasAffinity = function (this: Fastener, affinity: Affinity): boolean {\n    return affinity >= this.affinity;\n  };\n\n  Fastener.prototype.initAffinity = function (this: Fastener, affinity: Affinity): void {\n    (this as Mutable<typeof this>).flags = this.flags & ~Affinity.Mask | affinity & Affinity.Mask;\n  };\n\n  Fastener.prototype.minAffinity = function (this: Fastener, newAffinity: Affinity | undefined): boolean {\n    const oldAffinity = this.affinity;\n    if (newAffinity === void 0) {\n      newAffinity = Affinity.Extrinsic;\n    } else if (newAffinity === Affinity.Reflexive) {\n      newAffinity = oldAffinity;\n    } else if ((newAffinity & ~Affinity.Mask) !== 0) {\n      throw new Error(\"invalid affinity: \" + newAffinity);\n    }\n    if (newAffinity > oldAffinity) {\n      this.willSetAffinity(newAffinity, oldAffinity);\n      this.setFlags(this.flags & ~Affinity.Mask | newAffinity);\n      this.onSetAffinity(newAffinity, oldAffinity);\n      this.didSetAffinity(newAffinity, oldAffinity);\n    }\n    return newAffinity >= oldAffinity;\n  };\n\n  Fastener.prototype.setAffinity = function (this: Fastener, newAffinity: Affinity): void {\n    if ((newAffinity & ~Affinity.Mask) !== 0) {\n      throw new Error(\"invalid affinity: \" + newAffinity);\n    }\n    const oldAffinity = this.affinity;\n    if (newAffinity !== oldAffinity) {\n      this.willSetAffinity(newAffinity, oldAffinity);\n      this.setFlags(this.flags & ~Affinity.Mask | newAffinity);\n      this.onSetAffinity(newAffinity, oldAffinity);\n      this.didSetAffinity(newAffinity, oldAffinity);\n    }\n  };\n\n  Fastener.prototype.willSetAffinity = function (this: Fastener, newAffinity: Affinity, oldAffinity: Affinity): void {\n    // hook\n  };\n\n  Fastener.prototype.onSetAffinity = function (this: Fastener, newAffinity: Affinity, oldAffinity: Affinity): void {\n    if (newAffinity > oldAffinity && this.inherited) {\n      const superFastener = this.superFastener;\n      if (superFastener !== null && Math.min(superFastener.affinity, Affinity.Intrinsic) < newAffinity) {\n        this.setInherited(false, superFastener);\n      }\n    } else if (newAffinity < oldAffinity && this.inherits) {\n      const superFastener = this.superFastener;\n      if (superFastener !== null && Math.min(superFastener.affinity, Affinity.Intrinsic) >= newAffinity) {\n        this.setInherited(true, superFastener);\n      }\n    }\n  };\n\n  Fastener.prototype.didSetAffinity = function (this: Fastener, newAffinity: Affinity, oldAffinity: Affinity): void {\n    // hook\n  };\n\n  Object.defineProperty(Fastener.prototype, \"inherits\", {\n    get: function (this: Fastener): boolean {\n      return (this.flags & Fastener.InheritsFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  Fastener.prototype.initInherits = function (this: Fastener, inherits: string | boolean): void {\n    let superName: string | undefined;\n    if (typeof inherits === \"string\") {\n      superName = inherits;\n      inherits = true;\n    }\n    if (inherits) {\n      if (superName !== void 0) {\n        Object.defineProperty(this, \"name\", {\n          value: superName,\n          enumerable: true,\n          configurable: true,\n        });\n      }\n      (this as Mutable<typeof this>).flags = this.flags | Fastener.InheritsFlag;\n    } else {\n      (this as Mutable<typeof this>).flags = this.flags & ~Fastener.InheritsFlag;\n    }\n  };\n\n  Fastener.prototype.setInherits = function (this: Fastener, inherits: string | boolean): void {\n    let superName: string | undefined;\n    if (typeof inherits === \"string\") {\n      if (inherits !== this.name) {\n        superName = inherits;\n      }\n      inherits = true;\n    }\n    if (inherits !== ((this.flags & Fastener.InheritsFlag) !== 0) || superName !== void 0) {\n      this.unbindSuperFastener();\n      this.willSetInherits(inherits, superName);\n      if (inherits) {\n        if (superName !== void 0) {\n          Object.defineProperty(this, \"name\", {\n            value: superName,\n            enumerable: true,\n            configurable: true,\n          });\n        }\n        this.setFlags(this.flags | Fastener.InheritsFlag);\n      } else {\n        this.setFlags(this.flags & ~Fastener.InheritsFlag);\n      }\n      this.onSetInherits(inherits, superName);\n      this.didSetInherits(inherits, superName);\n      this.bindSuperFastener();\n    }\n  };\n\n  Fastener.prototype.willSetInherits = function (this: Fastener, inherits: boolean, superName: string | undefined): void {\n    // hook\n  };\n\n  Fastener.prototype.onSetInherits = function (this: Fastener, inherits: boolean, superName: string | undefined): void {\n    // hook\n  };\n\n  Fastener.prototype.didSetInherits = function (this: Fastener, inherits: boolean, superName: string | undefined): void {\n    // hook\n  };\n\n  Object.defineProperty(Fastener.prototype, \"inherited\", {\n    get: function (this: Fastener): boolean {\n      return (this.flags & Fastener.InheritedFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  Fastener.prototype.setInherited = function (this: Fastener, inherited: boolean, superFastener: Fastener): void {\n    if (inherited && (this.flags & Fastener.InheritedFlag) === 0) {\n      this.willInherit(superFastener);\n      this.setFlags(this.flags | Fastener.InheritedFlag);\n      this.onInherit(superFastener);\n      this.didInherit(superFastener);\n    } else if (!inherited && (this.flags & Fastener.InheritedFlag) !== 0) {\n      this.willUninherit(superFastener);\n      this.setFlags(this.flags & ~Fastener.InheritedFlag);\n      this.onUninherit(superFastener);\n      this.didUninherit(superFastener);\n    }\n  };\n\n  Fastener.prototype.willInherit = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.onInherit = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.didInherit = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.willUninherit = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.onUninherit = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.didUninherit = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Object.defineProperty(Fastener.prototype, \"superName\", {\n    get: function (this: Fastener): string | undefined {\n      return this.inherits ? this.name : void 0;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(Fastener.prototype, \"superFastener\", {\n    get: function (this: Fastener): Fastener | null {\n      return this.getSuperFastener();\n    },\n    configurable: true,\n  });\n\n  Fastener.prototype.getSuperFastener = function (this: Fastener): Fastener | null {\n    const superName = this.superName;\n    if (superName !== void 0) {\n      const fastenerContext = this.owner;\n      if (FastenerContext.is(fastenerContext)) {\n        const superFastener = fastenerContext.getSuperFastener(superName, this.familyType);\n        if (superFastener !== null) {\n          return superFastener;\n        }\n      }\n    }\n    return null;\n  }\n\n  Fastener.prototype.bindSuperFastener = function (this: Fastener): void {\n    const superName = this.superName;\n    if (superName !== void 0) {\n      const fastenerContext = this.owner;\n      if (FastenerContext.is(fastenerContext)) {\n        const superFastener = fastenerContext.getSuperFastener(superName, this.familyType);\n        if (superFastener !== null) {\n          this.willBindSuperFastener(superFastener);\n          superFastener.attachSubFastener(this);\n          this.onBindSuperFastener(superFastener);\n          this.didBindSuperFastener(superFastener);\n        }\n      }\n    }\n  };\n\n  Fastener.prototype.willBindSuperFastener = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.onBindSuperFastener = function (this: Fastener, superFastener: Fastener): void {\n    if (superFastener.affinity >= this.affinity) {\n      this.setInherited(true, superFastener);\n    }\n  };\n\n  Fastener.prototype.didBindSuperFastener = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.unbindSuperFastener = function (this: Fastener): void {\n    const superFastener = this.superFastener;\n    if (superFastener !== null) {\n      this.willUnbindSuperFastener(superFastener);\n      superFastener.detachSubFastener(this);\n      this.onUnbindSuperFastener(superFastener);\n      this.didUnbindSuperFastener(superFastener);\n    }\n  };\n\n  Fastener.prototype.willUnbindSuperFastener = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.onUnbindSuperFastener = function (this: Fastener, superFastener: Fastener): void {\n    this.setInherited(false, superFastener);\n  };\n\n  Fastener.prototype.didUnbindSuperFastener = function (this: Fastener, superFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.attachSubFastener = function (this: Fastener, subFastener: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.detachSubFastener = function (this: Fastener, subFastener: Fastener): void {\n    // hook\n  };\n\n  Object.defineProperty(Fastener.prototype, \"coherent\", {\n    get: function (this: Fastener): boolean {\n      return (this.flags & Fastener.DecoherentFlag) === 0;\n    },\n    configurable: true,\n  });\n\n  Fastener.prototype.setCoherent = function (this: Fastener, coherent: boolean): void {\n    if (coherent) {\n      this.setFlags(this.flags & ~Fastener.DecoherentFlag);\n    } else {\n      this.setFlags(this.flags | Fastener.DecoherentFlag);\n    }\n  };\n\n  Fastener.prototype.decohere = function (this: Fastener): void {\n    const fastenerContext = this.owner;\n    if (FastenerContext.has(fastenerContext, \"decohereFastener\")) {\n      fastenerContext.decohereFastener(this);\n    }\n  };\n\n  Fastener.prototype.recohere = function (this: Fastener, t: number): void {\n    // hook\n  };\n\n  Object.defineProperty(Fastener.prototype, \"mounted\", {\n    get: function (this: Fastener): boolean {\n      return (this.flags & Fastener.MountedFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  Fastener.prototype.mount = function (this: Fastener): void {\n    if ((this.flags & Fastener.MountedFlag) === 0) {\n      this.willMount();\n      this.setFlags(this.flags | Fastener.MountedFlag);\n      this.onMount();\n      this.didMount();\n    }\n  };\n\n  Fastener.prototype.willMount = function (this: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.onMount = function (this: Fastener): void {\n    this.bindSuperFastener();\n  };\n\n  Fastener.prototype.didMount = function (this: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.unmount = function (this: Fastener): void {\n    if ((this.flags & Fastener.MountedFlag) !== 0) {\n      this.willUnmount();\n      this.setFlags(this.flags & ~Fastener.MountedFlag);\n      this.onUnmount();\n      this.didUnmount();\n    }\n  };\n\n  Fastener.prototype.willUnmount = function (this: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.onUnmount = function (this: Fastener): void {\n    this.unbindSuperFastener();\n  };\n\n  Fastener.prototype.didUnmount = function (this: Fastener): void {\n    // hook\n  };\n\n  Fastener.prototype.toString = function (this: Fastener): string {\n    return this.name;\n  };\n\n  Object.defineProperty(Fastener.prototype, \"lazy\", {\n    get: function (this: Fastener): boolean {\n      return true;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(Fastener.prototype, \"static\", {\n    get: function (this: Fastener): string | boolean {\n      return false;\n    },\n    configurable: true,\n  });\n\n  Fastener.create = function <F extends Fastener<any>>(this: FastenerClass<F>, owner: FastenerOwner<F>): F {\n    const fastener = this.construct(this, null, owner);\n    fastener.init();\n    return fastener;\n  };\n\n  Fastener.construct = function <F extends Fastener<any>>(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F {\n    if (fastener === null) {\n      fastener = Object.create(fastenerClass.prototype) as F;\n    }\n    (fastener as Mutable<typeof fastener>).owner = owner;\n    (fastener as Mutable<typeof fastener>).flags = 0;\n    return fastener;\n  };\n\n  Fastener.extend = function <I>(className: string, classMembers?: {readonly name?: string} & Partial<I> | null): FastenerFactory & I {\n    let classIdentifier: string | undefined;\n    if (classMembers !== void 0 && classMembers !== null && typeof classMembers.name === \"string\" && Identifiers.isValid(classMembers.name)) {\n      classIdentifier = classMembers.name;\n      className = classIdentifier;\n    } else if (Identifiers.isValid(className)) {\n      classIdentifier = className;\n    }\n\n    let fastenerClass: FastenerFactory & I;\n    if (classIdentifier !== void 0) {\n      fastenerClass = new Function(\"FastenerContext\",\n        \"return function \" + className + \"(descriptor) { return FastenerContext.decorator(\" + className + \", descriptor); }\"\n      )(FastenerContext);\n    } else {\n      fastenerClass = function (descriptor: FastenerDescriptor): PropertyDecorator {\n        return FastenerContext.decorator(fastenerClass, descriptor);\n      } as FastenerFactory & I;\n      Object.defineProperty(fastenerClass, \"name\", {\n        value: className,\n        configurable: true,\n      });\n    }\n\n    const classProperties: PropertyDescriptorMap = {};\n    if (classMembers !== void 0 && classMembers !== null) {\n      classProperties.name = {\n        value: className,\n        configurable: true,\n      };\n      const classMemberNames = Object.getOwnPropertyNames(classMembers);\n      for (let i = 0; i < classMemberNames.length; i += 1) {\n        const classMemberName = classMemberNames[i]!;\n        classProperties[classMemberName] = Object.getOwnPropertyDescriptor(classMembers, classMemberName)!;\n      }\n    } else {\n      classProperties.name = {\n        value: \"\",\n        configurable: true,\n      };\n    }\n\n    Object.setPrototypeOf(fastenerClass, this);\n    fastenerClass.prototype = Object.create(this.prototype, classProperties);\n    fastenerClass.prototype.constructor = fastenerClass;\n\n    return fastenerClass;\n  }\n\n  Fastener.define = function <O>(className: string, descriptor: FastenerDescriptor<O>): FastenerFactory<Fastener<any>> {\n    let superClass = descriptor.extends as FastenerFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const fastenerClass = superClass.extend(className, descriptor);\n\n    fastenerClass.construct = function (fastenerClass: {prototype: Fastener<any>}, fastener: Fastener<O> | null, owner: O): Fastener<O> {\n      fastener = superClass!.construct(fastenerClass, fastener, owner);\n      if (affinity !== void 0) {\n        fastener.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        fastener.initInherits(inherits);\n      }\n      return fastener;\n    };\n\n    return fastenerClass;\n  };\n\n  (Fastener as Mutable<typeof Fastener>).MountedFlag = 1 << (Affinity.Shift + 0);\n  (Fastener as Mutable<typeof Fastener>).InheritsFlag = 1 << (Affinity.Shift + 1);\n  (Fastener as Mutable<typeof Fastener>).InheritedFlag = 1 << (Affinity.Shift + 2);\n  (Fastener as Mutable<typeof Fastener>).DecoherentFlag = 1 << (Affinity.Shift + 3);\n\n  (Fastener as Mutable<typeof Fastener>).FlagShift = Affinity.Shift + 4;\n  (Fastener as Mutable<typeof Fastener>).FlagMask = (1 << Fastener.FlagShift) - 1;\n\n  return Fastener;\n})(Object);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Class, Equals, FromAny} from \"@swim/util\";\nimport {Affinity} from \"../fastener/Affinity\";\nimport {FastenerContext} from \"../fastener/FastenerContext\";\nimport {FastenerOwner, FastenerInit, FastenerClass, Fastener} from \"../fastener/Fastener\";\nimport {StringProperty} from \"./\"; // forward import\nimport {NumberProperty} from \"./\"; // forward import\nimport {BooleanProperty} from \"./\"; // forward import\n\n/** @internal */\nexport type MemberPropertyState<O, K extends keyof O> =\n  O[K] extends Property<any, infer T> ? T : never;\n\n/** @internal */\nexport type MemberPropertyStateInit<O, K extends keyof O> =\n  O[K] extends Property<any, any, infer U> ? U : never;\n\n/** @internal */\nexport type MemberPropertyInit<O, K extends keyof O> =\n  O[K] extends Property<any, infer T, infer U> ? T | U : never;\n\n/** @internal */\nexport type MemberPropertyInitMap<O> =\n  {-readonly [K in keyof O as O[K] extends Property ? K : never]?: MemberPropertyInit<O, K>};\n\n/** @internal */\nexport type PropertyState<P extends Property<any, any>> =\n  P extends Property<any, infer T> ? T : never;\n\n/** @internal */\nexport type PropertyStateInit<P extends Property<any, any>> =\n  P extends Property<any, infer T, infer U> ? T | U : never;\n\n/** @public */\nexport interface PropertyInit<T = unknown, U = T> extends FastenerInit {\n  extends?: {prototype: Property<any, any>} | string | boolean | null;\n  type?: unknown;\n\n  state?: T | U;\n  updateFlags?: number;\n\n  willInherit?(superFastener: Property<unknown, T>): void;\n  didInherit?(superFastener: Property<unknown, T>): void;\n  willUninherit?(superFastener: Property<unknown, T>): void;\n  didUninherit?(superFastener: Property<unknown, T>): void;\n\n  willBindSuperFastener?(superFastener: Property<unknown, T>): void;\n  didBindSuperFastener?(superFastener: Property<unknown, T>): void;\n  willUnbindSuperFastener?(superFastener: Property<unknown, T>): void;\n  didUnbindSuperFastener?(superFastener: Property<unknown, T>): void;\n\n  willSetState?(newState: T, oldState: T): void;\n  didSetState?(newState: T, oldState: T): void;\n\n  initState?(): T | U;\n  isDefined?(value: T): boolean;\n  equalState?(newState: T, oldState: T | undefined): boolean;\n  fromAny?(value: T | U): T;\n}\n\n/** @public */\nexport type PropertyDescriptor<O = unknown, T = unknown, U = T, I = {}> = ThisType<Property<O, T, U> & I> & PropertyInit<T, U> & Partial<I>;\n\n/** @public */\nexport interface PropertyClass<P extends Property<any, any> = Property<any, any>> extends FastenerClass<P> {\n}\n\n/** @public */\nexport interface PropertyFactory<P extends Property<any, any> = Property<any, any>> extends PropertyClass<P> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): PropertyFactory<P> & I;\n\n  specialize(type: unknown): PropertyFactory | null;\n\n  define<O, T, U = T>(className: string, descriptor: PropertyDescriptor<O, T, U>): PropertyFactory<Property<any, T, U>>;\n  define<O, T, U = T, I = {}>(className: string, descriptor: PropertyDescriptor<O, T, U, I>): PropertyFactory<Property<any, T, U> & I>;\n\n  <O, T extends string | undefined = string | undefined, U extends string | undefined = string | undefined>(descriptor: {type: typeof String} & PropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T extends number | undefined = number | undefined, U extends number | string | undefined = number | string | undefined>(descriptor: {type: typeof Number} & PropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T extends boolean | undefined = boolean | undefined, U extends boolean | string | undefined = boolean | string | undefined>(descriptor: {type: typeof Boolean} & PropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: ({type: FromAny<T, U>} | {fromAny(value: T | U): T}) & PropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: PropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T, I = {}>(descriptor: PropertyDescriptor<O, T, U, I>): PropertyDecorator;\n}\n\n/** @public */\nexport interface Property<O = unknown, T = unknown, U = T> extends Fastener<O> {\n  (): T;\n  (state: T | U, affinity?: Affinity): O;\n\n  /** @override */\n  get familyType(): Class<Property<any, any>> | null;\n\n  /** @internal @override */\n  setInherited(inherited: boolean, superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  willInherit(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  onInherit(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  didInherit(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  willUninherit(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  onUninherit(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  didUninherit(superFastener: Property<unknown, T>): void;\n\n  /** @override */\n  readonly superFastener: Property<unknown, T> | null;\n\n  /** @internal @override */\n  getSuperFastener(): Property<unknown, T> | null;\n\n  /** @protected @override */\n  willBindSuperFastener(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  onBindSuperFastener(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  didBindSuperFastener(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  willUnbindSuperFastener(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  onUnbindSuperFastener(superFastener: Property<unknown, T>): void;\n\n  /** @protected @override */\n  didUnbindSuperFastener(superFastener: Property<unknown, T>): void;\n\n  /** @internal */\n  readonly subFasteners: ReadonlyArray<Property<unknown, T>> | null;\n\n  /** @internal @override */\n  attachSubFastener(subFastener: Property<unknown, T>): void;\n\n  /** @internal @override */\n  detachSubFastener(subFastener: Property<unknown, T>): void;\n\n  get superState(): T | undefined;\n\n  getSuperState(): NonNullable<T>;\n\n  getSuperStateOr<E>(elseState: E): NonNullable<T> | E;\n\n  readonly state: T;\n\n  getState(): NonNullable<T>;\n\n  getStateOr<E>(elseState: E): NonNullable<T> | E;\n\n  setState(newState: T | U, affinity?: Affinity): void;\n\n  /** @protected */\n  willSetState(newState: T, oldState: T): void;\n\n  /** @protected */\n  onSetState(newState: T, oldState: T): void;\n\n  /** @protected */\n  didSetState(newState: T, oldState: T): void;\n\n  /** @internal @protected */\n  decohereSubFasteners(): void;\n\n  /** @internal @protected */\n  decohereSubFastener(subFastener: Property<unknown, T>): void;\n\n  /** @override */\n  recohere(t: number): void;\n\n  get updateFlags(): number | undefined; // optional prototype field\n\n  /** @internal @protected */\n  isDefined(value: T): boolean;\n\n  /** @internal @protected */\n  equalState(newState: T, oldState: T | undefined): boolean;\n\n  /** @internal @protected */\n  fromAny(value: T | U): T;\n}\n\n/** @public */\nexport const Property = (function (_super: typeof Fastener) {\n  const Property: PropertyFactory = _super.extend(\"Property\");\n\n  Object.defineProperty(Property.prototype, \"familyType\", {\n    get: function (this: Property): Class<Property<any, any>> | null {\n      return Property;\n    },\n    configurable: true,\n  });\n\n  Property.prototype.onInherit = function <T>(this: Property<unknown, T>, superFastener: Property<unknown, T>): void {\n    this.setState(superFastener.state, Affinity.Reflexive);\n  };\n\n  Property.prototype.onBindSuperFastener = function <T>(this: Property<unknown, T>, superFastener: Property<unknown, T>): void {\n    (this as Mutable<typeof this>).superFastener = superFastener;\n    _super.prototype.onBindSuperFastener.call(this, superFastener);\n  };\n\n  Property.prototype.onUnbindSuperFastener = function <T>(this: Property<unknown, T>, superFastener: Property<unknown, T>): void {\n    _super.prototype.onUnbindSuperFastener.call(this, superFastener);\n    (this as Mutable<typeof this>).superFastener = null;\n  };\n\n  Property.prototype.attachSubFastener = function <T>(this: Property<unknown, T>, subFastener: Property<unknown, T>): void {\n    let subFasteners = this.subFasteners as Property<unknown, T>[] | null;\n    if (subFasteners === null) {\n      subFasteners = [];\n      (this as Mutable<typeof this>).subFasteners = subFasteners;\n    }\n    subFasteners.push(subFastener);\n  };\n\n  Property.prototype.detachSubFastener = function <T>(this: Property<unknown, T>, subFastener: Property<unknown, T>): void {\n    const subFasteners = this.subFasteners as Property<unknown, T>[] | null;\n    if (subFasteners !== null) {\n      const index = subFasteners.indexOf(subFastener);\n      if (index >= 0) {\n        subFasteners.splice(index, 1);\n      }\n    }\n  };\n\n  Object.defineProperty(Property.prototype, \"superState\", {\n    get: function <T>(this: Property<unknown, T>): T | undefined {\n      const superFastener = this.superFastener;\n      return superFastener !== null ? superFastener.state : void 0;\n    },\n    configurable: true,\n  });\n\n  Property.prototype.getSuperState = function <T>(this: Property<unknown, T>): NonNullable<T> {\n    const superState = this.superState;\n    if (superState === void 0 || superState === null) {\n      let message = superState + \" \";\n      if (this.name.length !== 0) {\n        message += this.name + \" \";\n      }\n      message += \"super state\";\n      throw new TypeError(message);\n    }\n    return superState as NonNullable<T>;\n  };\n\n  Property.prototype.getSuperStateOr = function <T, E>(this: Property<unknown, T>, elseState: E): NonNullable<T> | E {\n    let superState: T | E | undefined = this.superState;\n    if (superState === void 0 || superState === null) {\n      superState = elseState;\n    }\n    return superState as NonNullable<T> | E;\n  };\n\n  Property.prototype.getState = function <T>(this: Property<unknown, T>): NonNullable<T> {\n    const state = this.state;\n    if (state === void 0 || state === null) {\n      let message = state + \" \";\n      if (this.name.length !== 0) {\n        message += this.name + \" \";\n      }\n      message += \"state\";\n      throw new TypeError(message);\n    }\n    return state as NonNullable<T>;\n  };\n\n  Property.prototype.getStateOr = function <T, E>(this: Property<unknown, T>, elseState: E): NonNullable<T> | E {\n    let state: T | E = this.state;\n    if (state === void 0 || state === null) {\n      state = elseState;\n    }\n    return state as NonNullable<T> | E;\n  };\n\n  Property.prototype.setState = function <T, U>(this: Property<unknown, T, U>, newState: T | U, affinity?: Affinity): void {\n    if (this.minAffinity(affinity)) {\n      newState = this.fromAny(newState);\n      const oldState = this.state;\n      if (!this.equalState(newState, oldState)) {\n        this.willSetState(newState, oldState);\n        (this as Mutable<typeof this>).state = newState;\n        this.onSetState(newState, oldState);\n        this.didSetState(newState, oldState);\n        this.setCoherent(true);\n        this.decohereSubFasteners();\n      }\n    }\n  };\n\n  Property.prototype.willSetState = function <T>(this: Property<unknown, T>, newState: T, oldState: T): void {\n    // hook\n  };\n\n  Property.prototype.onSetState = function <T>(this: Property<unknown, T>, newState: T, oldState: T): void {\n    const updateFlags = this.updateFlags;\n    const fastenerContext = this.owner;\n    if (updateFlags !== void 0 && FastenerContext.has(fastenerContext, \"requireUpdate\")) {\n      fastenerContext.requireUpdate(updateFlags);\n    }\n  };\n\n  Property.prototype.didSetState = function <T>(this: Property<unknown, T>, newState: T, oldState: T): void {\n    // hook\n  };\n\n  Property.prototype.decohereSubFasteners = function (this: Property): void {\n    const subFasteners = this.subFasteners;\n    for (let i = 0, n = subFasteners !== null ? subFasteners.length : 0; i < n; i += 1) {\n      this.decohereSubFastener(subFasteners![i]!);\n    }\n  };\n\n  Property.prototype.decohereSubFastener = function (this: Property, subFastener: Property): void {\n    if (!subFastener.inherited && Math.min(this.affinity, Affinity.Intrinsic) >= subFastener.affinity) {\n      subFastener.setInherited(true, this);\n    } else if (subFastener.inherited && subFastener.coherent) {\n      subFastener.setCoherent(false);\n      subFastener.decohere();\n    }\n  };\n\n  Property.prototype.recohere = function (this: Property, t: number): void {\n    if (this.inherited) {\n      const superFastener = this.superFastener;\n      if (superFastener !== null) {\n        this.setState(superFastener.state, Affinity.Reflexive);\n      }\n    }\n  };\n\n  Property.prototype.isDefined = function <T>(this: Property<unknown, T>, value: T): boolean {\n    return value !== void 0 && value !== null;\n  };\n\n  Property.prototype.equalState = function <T>(this: Property<unknown, T>, newState: T, oldState: T | undefined): boolean {\n    return Equals(newState, oldState);\n  };\n\n  Property.prototype.fromAny = function <T, U>(this: Property<unknown, T, U>, value: T | U): T {\n    return value as T;\n  };\n\n  Property.construct = function <P extends Property<any, any>>(propertyClass: {prototype: P}, property: P | null, owner: FastenerOwner<P>): P {\n    if (property === null) {\n      property = function (state?: PropertyState<P> | PropertyStateInit<P>, affinity?: Affinity): PropertyState<P> | FastenerOwner<P> {\n        if (arguments.length === 0) {\n          return property!.state;\n        } else {\n          property!.setState(state!, affinity);\n          return property!.owner;\n        }\n      } as P;\n      delete (property as Partial<Mutable<P>>).name; // don't clobber prototype name\n      Object.setPrototypeOf(property, propertyClass.prototype);\n    }\n    property = _super.construct(propertyClass, property, owner) as P;\n    Object.defineProperty(property, \"superFastener\", { // override getter\n      value: null,\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    });\n    (property as Mutable<typeof property>).subFasteners = null;\n    (property as Mutable<typeof property>).state = void 0 as unknown as PropertyState<P>;\n    return property;\n  };\n\n  Property.specialize = function (type: unknown): PropertyFactory | null {\n    if (type === String) {\n      return StringProperty;\n    } else if (type === Number) {\n      return NumberProperty;\n    } else if (type === Boolean) {\n      return BooleanProperty;\n    }\n    return null;\n  };\n\n  Property.define = function <O, T, U>(className: string, descriptor: PropertyDescriptor<O, T, U>): PropertyFactory<Property<any, T, U>> {\n    let superClass = descriptor.extends as PropertyFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const state = descriptor.state;\n    const initState = descriptor.initState;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.state;\n    delete descriptor.initState;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this.specialize(descriptor.type);\n    }\n    if (superClass === null) {\n      superClass = this;\n      if (descriptor.fromAny === void 0 && FromAny.is<T, U>(descriptor.type)) {\n        descriptor.fromAny = descriptor.type.fromAny;\n      }\n    }\n\n    const propertyClass = superClass.extend(className, descriptor);\n\n    propertyClass.construct = function (propertyClass: {prototype: Property<any, any>}, property: Property<O, T, U> | null, owner: O): Property<O, T, U> {\n      property = superClass!.construct(propertyClass, property, owner);\n      if (affinity !== void 0) {\n        property.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        property.initInherits(inherits);\n      }\n      if (initState !== void 0) {\n        (property as Mutable<typeof property>).state = property.fromAny(initState());\n      } else if (state !== void 0) {\n        (property as Mutable<typeof property>).state = property.fromAny(state);\n      }\n      return property;\n    };\n\n    return propertyClass;\n  };\n\n  return Property;\n})(Fastener);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {PropertyFactory, Property} from \"./Property\";\n\n/** @internal */\nexport const StringProperty = (function (_super: typeof Property) {\n  const StringProperty = _super.extend(\"StringProperty\") as PropertyFactory<Property<any, string | null | undefined, string | null | undefined>>;\n\n  StringProperty.prototype.fromAny = function (value: string | null | undefined): string | null | undefined {\n    return value;\n  };\n\n  StringProperty.prototype.equalState = function (newState: string | null | undefined, oldState: string | null | undefined): boolean {\n    return newState === oldState;\n  };\n\n  return StringProperty;\n})(Property);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {PropertyFactory, Property} from \"./Property\";\n\n/** @internal */\nexport const NumberProperty = (function (_super: typeof Property) {\n  const NumberProperty = _super.extend(\"NumberProperty\") as PropertyFactory<Property<any, number | null | undefined, number | string | null | undefined>>;\n\n  NumberProperty.prototype.fromAny = function (value: number | string | null | undefined): number | null | undefined {\n    if (typeof value === \"string\") {\n      const number = +value;\n      if (isFinite(number)) {\n        return number;\n      } else {\n        throw new Error(value);\n      }\n    } else {\n      return value;\n    }\n  };\n\n  NumberProperty.prototype.equalState = function (newState: number | null | undefined, oldState: number | null | undefined): boolean {\n    return newState === oldState;\n  };\n\n  return NumberProperty;\n})(Property);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {PropertyFactory, Property} from \"./Property\";\n\n/** @internal */\nexport const BooleanProperty = (function (_super: typeof Property) {\n  const BooleanProperty = _super.extend(\"BooleanProperty\") as PropertyFactory<Property<any, boolean | null | undefined, boolean | string | null | undefined>>;\n\n  BooleanProperty.prototype.fromAny = function (value: boolean | string | null | undefined): boolean | null | undefined {\n    return !!value;\n  };\n\n  BooleanProperty.prototype.equalState = function (newState: boolean | null | undefined, oldState: boolean | null | undefined): boolean {\n    return newState === oldState;\n  };\n\n  return BooleanProperty;\n})(Property);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, FromAny, AnyTiming, Timing, Easing, Interpolator} from \"@swim/util\";\nimport {Affinity} from \"../fastener/Affinity\";\nimport {FastenerContext} from \"../fastener/FastenerContext\";\nimport type {FastenerOwner, FastenerFlags} from \"../fastener/Fastener\";\nimport {PropertyInit, PropertyClass, Property} from \"../property/Property\";\nimport {StringAnimator} from \"./\"; // forward import\nimport {NumberAnimator} from \"./\"; // forward import\nimport {BooleanAnimator} from \"./\"; // forward import\n\n/** @internal */\nexport type MemberAnimatorState<O, K extends keyof O> =\n  O[K] extends Animator<any, infer T> ? T : never;\n\n/** @internal */\nexport type MemberAnimatorStateInit<O, K extends keyof O> =\n  O[K] extends Animator<any, any, infer U> ? U : never;\n\n/** @internal */\nexport type MemberAnimatorInit<O, K extends keyof O> =\n  O[K] extends Animator<any, infer T, infer U> ? T | U : never;\n\n/** @internal */\nexport type MemberAnimatorInitMap<O> =\n  {-readonly [K in keyof O as O[K] extends Property<any, any> ? K : never]?: MemberAnimatorInit<O, K>};\n\n/** @internal */\nexport type AnimatorState<A extends Animator<any, any>> =\n  A extends Animator<any, infer T, any> ? T : never;\n\n/** @internal */\nexport type AnimatorStateInit<A extends Animator<any, any>> =\n  A extends Animator<any, infer T, infer U> ? T | U : never;\n\n/** @public */\nexport interface AnimatorInit<T = unknown, U = never> extends PropertyInit<T, U> {\n  extends?: {prototype: Animator<any, any>} | string | boolean | null;\n\n  willSetValue?(newValue: T, oldValue: T): void;\n  didSetValue?(newValue: T, oldValue: T): void;\n\n  willStartTweening?(): void;\n  didStartTweening?(): void;\n  willStopTweening?(): void;\n  didStopTweening?(): void;\n\n  willTransition?(oldValue: T): void;\n  didTransition?(newValue: T): void;\n  didInterrupt?(value: T): void;\n}\n\n/** @public */\nexport type AnimatorDescriptor<O = unknown, T = unknown, U = T, I = {}> = ThisType<Animator<O, T, U> & I> & AnimatorInit<T, U> & Partial<I>;\n\n/** @public */\nexport interface AnimatorClass<A extends Animator<any, any> = Animator<any, any>> extends PropertyClass<A> {\n  /** @internal */\n  readonly TweeningFlag: FastenerFlags;\n  /** @internal */\n  readonly DivergedFlag: FastenerFlags;\n  /** @internal */\n  readonly InterruptFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface AnimatorFactory<A extends Animator<any, any> = Animator<any, any>> extends AnimatorClass<A> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): AnimatorFactory<A> & I;\n\n  specialize(type: unknown): AnimatorFactory | null;\n\n  define<O, T, U = T>(className: string, descriptor: AnimatorDescriptor<O, T, U>): AnimatorFactory<Animator<any, T, U>>;\n  define<O, T, U = T, I = {}>(className: string, descriptor: AnimatorDescriptor<O, T, U, I>): AnimatorFactory<Animator<any, T, U> & I>;\n\n  <O, T extends string | undefined = string | undefined, U extends string | undefined = string | undefined>(descriptor: {type: typeof String} & AnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T extends number | undefined = number | undefined, U extends number | string | undefined = number | string | undefined>(descriptor: {type: typeof Number} & AnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T extends boolean | undefined = boolean | undefined, U extends boolean | string | undefined = boolean | string | undefined>(descriptor: {type: typeof Boolean} & AnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: ({type: FromAny<T, U>} | {fromAny(value: T | U): T}) & AnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: AnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T, I = {}>(descriptor: AnimatorDescriptor<O, T, U, I>): PropertyDecorator;\n\n}\n\n/** @public */\nexport interface Animator<O = unknown, T = unknown, U = T> extends Property<O, T, U> {\n  (): T;\n  (newState: T | U, timingOrAffinity: Affinity | AnyTiming | boolean | null | undefined): O;\n  (newState: T | U, timing?: AnyTiming | boolean | null, affinity?: Affinity): O;\n\n  /** @protected @override */\n  onInherit(superFastener: Property<unknown, T>): void;\n\n  setState(newState: T | U, timingOrAffinity: Affinity | AnyTiming | boolean | null | undefined): void;\n  /** @override */\n  setState(newState: T | U, timing?: AnyTiming | boolean | null, affinity?: Affinity): void;\n\n  /** @protected @override */\n  onSetState(newState: T, oldState: T): void;\n\n  get superValue(): T | undefined;\n\n  getSuperValue(): NonNullable<T>;\n\n  getSuperValueOr<E>(elseValue: E): NonNullable<T> | E;\n\n  readonly value: T;\n\n  getValue(): NonNullable<T>;\n\n  getValueOr<E>(elseValue: E): NonNullable<T> | E;\n\n  setValue(newValue: T, oldValue?: T): void;\n\n  /** @protected */\n  willSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected */\n  didSetValue(newValue: T, oldValue: T): void;\n\n  readonly timing: Timing | null;\n\n  readonly interpolator: Interpolator<T> | null;\n\n  setInterpolatedValue(newValue: T, newState?: T): void;\n\n  /** @internal @protected @override */\n  decohereSubFastener(subFastener: Property<unknown, T>): void;\n\n  /** @override */\n  recohere(t: number): void;\n\n  /** @internal @protected */\n  tween(t: number): void;\n\n  /** @internal @protected */\n  tweenInherited(t: number): void;\n\n  /**\n   * Returns `true` if this animator is actively transitioning to a new `state`.\n   */\n  get tweening(): boolean;\n\n  /** @internal */\n  startTweening(): void;\n\n  /** @protected */\n  willStartTweening(): void;\n\n  /** @protected */\n  onStartTweening(): void;\n\n  /** @protected */\n  didStartTweening(): void;\n\n  /** @internal */\n  stopTweening(): void;\n\n  /** @protected */\n  willStopTweening(): void;\n\n  /** @protected */\n  onStopTweening(): void;\n\n  /** @protected */\n  didStopTweening(): void;\n\n  /** @internal @protected */\n  willTransition(oldValue: T): void;\n\n  /** @internal @protected */\n  didTransition(newValue: T): void;\n\n  /** @internal @protected */\n  didInterrupt(value: T): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n}\n\n/** @public */\nexport const Animator = (function (_super: typeof Property) {\n  const Animator: AnimatorFactory = _super.extend(\"Animator\");\n\n  Animator.prototype.onInherit = function <T>(this: Animator<unknown, T>, superFastener: Property<unknown, T>): void {\n    const newState = superFastener.state;\n    const oldState = this.state;\n    const stateChanged = !this.equalState(newState, oldState);\n    if (stateChanged) {\n      this.willSetState(newState, oldState);\n      (this as Mutable<typeof this>).state = newState;\n      (this as Mutable<typeof this>).timing = null;\n      (this as Mutable<typeof this>).interpolator = null;\n      this.onSetState(newState, oldState);\n    }\n    if (superFastener instanceof Animator) {\n      this.setValue(superFastener.value);\n    } else {\n      this.setValue(newState);\n    }\n    if (stateChanged) {\n      this.didSetState(newState, oldState);\n      if (this.tweening) {\n        this.didInterrupt(this.value);\n      }\n    }\n    if (superFastener instanceof Animator && superFastener.tweening) {\n      this.startTweening();\n    } else {\n      this.stopTweening();\n    }\n  };\n\n  Animator.prototype.setState = function <T, U>(this: Animator<unknown, T, U>, newState: T | U, timing?: Affinity | AnyTiming | boolean | null, affinity?: Affinity): void {\n    if (typeof timing === \"number\") {\n      affinity = timing;\n      timing = void 0;\n    }\n\n    if (this.minAffinity(affinity)) {\n      newState = this.fromAny(newState);\n      const oldState = this.state;\n      if (!this.equalState(newState, oldState)) {\n        if (timing === void 0 || timing === null || timing === false) {\n          timing = false;\n        } else if (timing === true) {\n          timing = this.timing !== null ? this.timing : false;\n        } else {\n          timing = Timing.fromAny(timing);\n        }\n\n        const animated = timing !== false && this.isDefined(oldState);\n\n        this.willSetState(newState, oldState);\n\n        (this as Mutable<typeof this>).state = newState;\n\n        if (animated) {\n          (this as Mutable<typeof this>).timing = timing as Timing;\n          (this as Mutable<typeof this>).interpolator = Interpolator(this.value, newState);\n          if (this.tweening) {\n            this.setFlags(this.flags | (Animator.DivergedFlag | Animator.InterruptFlag));\n          } else {\n            this.setFlags(this.flags | Animator.DivergedFlag);\n          }\n        } else {\n          (this as Mutable<typeof this>).timing = null;\n          (this as Mutable<typeof this>).interpolator = null;\n        }\n\n        this.onSetState(newState, oldState);\n\n        if (!animated) {\n          this.setValue(newState);\n        }\n\n        this.didSetState(newState, oldState);\n\n        if (animated) {\n          this.startTweening();\n        } else {\n          if (this.tweening) {\n            this.didInterrupt(this.value);\n            this.stopTweening();\n          }\n        }\n      }\n    }\n  };\n\n  Animator.prototype.onSetState = function <T>(this: Animator<unknown, T>, newState: T, oldState: T): void {\n    // suppress super\n  };\n\n  Object.defineProperty(Animator.prototype, \"superValue\", {\n    get: function <T>(this: Animator<unknown, T>): T | undefined {\n      const superFastener = this.superFastener;\n      return superFastener instanceof Animator ? superFastener.value : void 0;\n    },\n    configurable: true,\n  });\n\n  Animator.prototype.getSuperValue = function <T>(this: Animator<unknown, T>): NonNullable<T> {\n    const superValue = this.superValue;\n    if (superValue === void 0 || superValue === null) {\n      let message = superValue + \" \";\n      if (this.name.length !== 0) {\n        message += this.name + \" \";\n      }\n      message += \"super value\";\n      throw new TypeError(message);\n    }\n    return superValue as NonNullable<T>;\n  };\n\n  Animator.prototype.getSuperValueOr = function <T, E>(this: Animator<unknown, T>, elseValue: E): NonNullable<T> | E {\n    let superValue: T | E | undefined = this.superValue;\n    if (superValue === void 0 || superValue === null) {\n      superValue = elseValue;\n    }\n    return superValue as NonNullable<T> | E;\n  };\n\n  Animator.prototype.getValue = function <T>(this: Animator<unknown, T>): NonNullable<T> {\n    const value = this.value;\n    if (value === void 0 || value === null) {\n      let message = value + \" \";\n      if (this.name.length !== 0) {\n        message += this.name + \" \";\n      }\n      message += \"value\";\n      throw new TypeError(message);\n    }\n    return value as NonNullable<T>;\n  };\n\n  Animator.prototype.getValueOr = function <T, E>(this: Animator<unknown, T>, elseValue: E): NonNullable<T> | E {\n    let value: T | E = this.value;\n    if (value === void 0 || value === null) {\n      value = elseValue;\n    }\n    return value as NonNullable<T> | E;\n  };\n\n  Animator.prototype.setValue = function <T>(this: Animator<unknown, T>, newValue: T, oldValue?: T): void {\n    if (arguments.length === 1) {\n      oldValue = this.value;\n    }\n    if (!this.equalState(newValue, oldValue)) {\n      this.willSetValue(newValue, oldValue!);\n      (this as Mutable<typeof this>).value = newValue;\n      this.onSetValue(newValue, oldValue!);\n      this.didSetValue(newValue, oldValue!);\n      this.decohereSubFasteners();\n    }\n  };\n\n  Animator.prototype.willSetValue = function <T>(this: Animator<unknown, T>, newValue: T, oldValue: T): void {\n    // hook\n  };\n\n  Animator.prototype.onSetValue = function <T>(this: Animator<unknown, T>, newValue: T, oldValue: T): void {\n    const updateFlags = this.updateFlags;\n    const fastenerContext = this.owner;\n    if (updateFlags !== void 0 && FastenerContext.has(fastenerContext, \"requireUpdate\")) {\n      fastenerContext.requireUpdate(updateFlags);\n    }\n  };\n\n  Animator.prototype.didSetValue = function <T>(this: Animator<unknown, T>, newValue: T, oldValue: T): void {\n    // hook\n  };\n\n  Animator.prototype.setInterpolatedValue = function <T>(this: Animator<unknown, T>, newValue: T, newState?: T): void {\n    const oldState = arguments.length > 1 ? this.state : void 0;\n    const stateChanged = arguments.length > 1 && !this.equalState(newState!, oldState);\n    if (stateChanged) {\n      this.willSetState(newState!, oldState!);\n      (this as Mutable<typeof this>).state = newState!;\n      (this as Mutable<typeof this>).timing = null;\n      (this as Mutable<typeof this>).interpolator = null;\n      this.onSetState(newState!, oldState!);\n    }\n    this.setValue(newValue);\n    if (stateChanged) {\n      this.didSetState(newState!, oldState!);\n      if (this.tweening) {\n        this.didInterrupt(this.value);\n        this.stopTweening();\n      }\n    }\n  };\n\n  Animator.prototype.decohereSubFastener = function (this: Animator, subFastener: Property): void {\n    if (!subFastener.inherited && Math.min(this.affinity, Affinity.Intrinsic) >= subFastener.affinity) {\n      subFastener.setInherited(true, this);\n    } else if (subFastener.inherited) {\n      if (this.tweening && subFastener instanceof Animator) {\n        subFastener.startTweening();\n      }\n      if (subFastener.coherent) {\n        subFastener.setCoherent(false);\n        subFastener.decohere();\n      }\n    }\n  };\n\n  Animator.prototype.recohere = function <T>(this: Animator<unknown, T>, t: number): void {\n    if (this.inherited) {\n      this.tweenInherited(t);\n    } else if (this.tweening) {\n      this.tween(t);\n    }\n  };\n\n  Animator.prototype.tween = function <T>(this: Animator<unknown, T>, t: number): void {\n    const oldValue = this.value;\n\n    let timing = this.timing;\n    if (timing === null) {\n      timing = Easing.linear.withDomain(t, t);\n      (this as Mutable<typeof this>).timing = timing;\n    }\n\n    let interpolator = this.interpolator;\n    if (interpolator === null) {\n      interpolator = Interpolator(oldValue, this.state);\n      (this as Mutable<typeof this>).interpolator = interpolator;\n    }\n\n    if ((this.flags & Animator.InterruptFlag) !== 0) {\n      this.setFlags(this.flags & ~Animator.InterruptFlag);\n      this.didInterrupt(oldValue);\n    }\n\n    if ((this.flags & Animator.DivergedFlag) !== 0) {\n      this.setFlags(this.flags & ~Animator.DivergedFlag);\n      if (!this.equalState(this.state, oldValue)) {\n        timing = timing.withDomain(t, t + timing.duration);\n      } else {\n        timing = timing.withDomain(t - timing.duration, t);\n      }\n      (this as Mutable<typeof this>).timing = timing;\n      this.willTransition(oldValue);\n    }\n\n    const u = timing(t);\n    const newValue = interpolator(u);\n    this.setValue(newValue);\n\n    if (u < 1) {\n      this.decohere();\n    } else if (this.tweening) {\n      this.stopTweening();\n      (this as Mutable<typeof this>).interpolator = null;\n      this.didTransition(newValue);\n    } else {\n      this.setCoherent(true);\n    }\n  };\n\n  Animator.prototype.tweenInherited = function <T>(this: Animator<unknown, T>, t: number): void {\n    const superFastener = this.superFastener;\n    if (superFastener !== null) {\n      const newState = superFastener.state;\n      const oldState = this.state;\n      const stateChanged = !this.equalState(newState, oldState);\n      if (stateChanged) {\n        this.willSetState(newState, oldState);\n        (this as Mutable<typeof this>).state = newState!;\n        (this as Mutable<typeof this>).timing = null;\n        (this as Mutable<typeof this>).interpolator = null;\n        this.onSetState(newState, oldState);\n      }\n\n      if (superFastener instanceof Animator) {\n        this.setValue(superFastener.value);\n      } else {\n        this.setValue(superFastener.state);\n      }\n\n      if (stateChanged) {\n        this.didSetState(newState, oldState!);\n        if (this.tweening) {\n          this.didInterrupt(this.value);\n        }\n      }\n\n      if (superFastener instanceof Animator && superFastener.tweening) {\n        this.decohere();\n      } else if (this.tweening) {\n        this.stopTweening();\n      } else {\n        this.setCoherent(true);\n      }\n    } else {\n      this.stopTweening();\n    }\n  };\n\n  Object.defineProperty(Animator.prototype, \"tweening\", {\n    get: function (this: Animator): boolean {\n      return (this.flags & Animator.TweeningFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  Animator.prototype.startTweening = function (this: Animator): void {\n    if ((this.flags & Animator.TweeningFlag) === 0) {\n      this.willStartTweening();\n      this.setFlags(this.flags | Animator.TweeningFlag);\n      this.onStartTweening();\n      this.didStartTweening();\n    }\n  };\n\n  Animator.prototype.willStartTweening = function (this: Animator): void {\n    // hook\n  };\n\n  Animator.prototype.onStartTweening = function (this: Animator): void {\n    if (this.coherent) {\n      this.setCoherent(false);\n      this.decohere();\n    }\n    this.decohereSubFasteners();\n  };\n\n  Animator.prototype.didStartTweening = function (this: Animator): void {\n    // hook\n  };\n\n  Animator.prototype.stopTweening = function (this: Animator): void {\n    if ((this.flags & Animator.TweeningFlag) !== 0) {\n      this.willStopTweening();\n      this.setFlags(this.flags & ~Animator.TweeningFlag);\n      this.onStopTweening();\n      this.didStopTweening();\n    }\n  };\n\n  Animator.prototype.willStopTweening = function (this: Animator): void {\n    // hook\n  };\n\n  Animator.prototype.onStopTweening = function (this: Animator): void {\n    this.setCoherent(true);\n  };\n\n  Animator.prototype.didStopTweening = function (this: Animator): void {\n    // hook\n  };\n\n  Animator.prototype.willTransition = function <T>(this: Animator<unknown, T>, oldValue: T): void {\n    // hook\n  };\n\n  Animator.prototype.didTransition = function <T>(this: Animator<unknown, T>, newValue: T): void {\n    // hook\n  };\n\n  Animator.prototype.didInterrupt = function <T>(this: Animator<unknown, T>, value: T): void {\n    // hook\n  };\n\n  Animator.prototype.onUnmount = function (this: Animator): void {\n    this.stopTweening();\n    _super.prototype.onUnmount.call(this);\n  };\n\n  Animator.construct = function <A extends Animator<any, any>>(animatorClass: {prototype: A}, animator: A | null, owner: FastenerOwner<A>): A {\n    if (animator === null) {\n      animator = function (state?: AnimatorStateInit<A>, timing?: Affinity | AnyTiming | boolean | null, affinity?: Affinity): AnimatorState<A> | FastenerOwner<A> {\n        if (arguments.length === 0) {\n          return animator!.value;\n        } else {\n          if (arguments.length === 2) {\n            animator!.setState(state!, timing);\n          } else {\n            animator!.setState(state!, timing as AnyTiming | boolean | null | undefined, affinity);\n          }\n          return animator!.owner;\n        }\n      } as A;\n      delete (animator as Partial<Mutable<A>>).name; // don't clobber prototype name\n      Object.setPrototypeOf(animator, animatorClass.prototype);\n    }\n    animator = _super.construct(animatorClass, animator, owner) as A;\n    (animator as Mutable<typeof animator>).value = animator.state;\n    (animator as Mutable<typeof animator>).timing = null;\n    (animator as Mutable<typeof animator>).interpolator = null;\n    return animator;\n  };\n\n  Animator.specialize = function (type: unknown): AnimatorFactory | null {\n    if (type === String) {\n      return StringAnimator;\n    } else if (type === Number) {\n      return NumberAnimator;\n    } else if (type === Boolean) {\n      return BooleanAnimator;\n    }\n    return null;\n  };\n\n  Animator.define = function <O, T, U>(className: string, descriptor: AnimatorDescriptor<O, T, U>): AnimatorFactory<Animator<any, T, U>> {\n    let superClass = descriptor.extends as AnimatorFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const state = descriptor.state;\n    const initState = descriptor.initState;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.state;\n    delete descriptor.initState;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this.specialize(descriptor.type);\n    }\n    if (superClass === null) {\n      superClass = this;\n      if (descriptor.fromAny === void 0 && FromAny.is<T, U>(descriptor.type)) {\n        descriptor.fromAny = descriptor.type.fromAny;\n      }\n    }\n\n    const animatorClass = superClass.extend(className, descriptor);\n\n    animatorClass.construct = function (animatorClass: {prototype: Animator<any, any>}, animator: Animator<O, T, U> | null, owner: O): Animator<O, T, U> {\n      animator = superClass!.construct(animatorClass, animator, owner);\n      if (affinity !== void 0) {\n        animator.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        animator.initInherits(inherits);\n      }\n      if (initState !== void 0) {\n        (animator as Mutable<typeof animator>).state = animator.fromAny(initState());\n        (animator as Mutable<typeof animator>).value = animator.state;\n      } else if (state !== void 0) {\n        (animator as Mutable<typeof animator>).state = animator.fromAny(state);\n        (animator as Mutable<typeof animator>).value = animator.state;\n      }\n      return animator;\n    };\n\n    return animatorClass;\n  };\n\n  (Animator as Mutable<typeof Animator>).TweeningFlag = 1 << (_super.FlagShift + 0);\n  (Animator as Mutable<typeof Animator>).DivergedFlag = 1 << (_super.FlagShift + 1);\n  (Animator as Mutable<typeof Animator>).InterruptFlag = 1 << (_super.FlagShift + 2);\n\n  (Animator as Mutable<typeof Animator>).FlagShift = _super.FlagShift + 3;\n  (Animator as Mutable<typeof Animator>).FlagMask = (1 << Animator.FlagShift) - 1;\n\n  return Animator;\n})(Property);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnimatorFactory, Animator} from \"./Animator\";\n\n/** @internal */\nexport const StringAnimator = (function (_super: typeof Animator) {\n  const StringAnimator = _super.extend(\"StringAnimator\") as AnimatorFactory<Animator<any, string | null | undefined, string | null | undefined>>;\n\n  StringAnimator.prototype.fromAny = function (value: string | null | undefined): string | null | undefined {\n    return value;\n  };\n\n  StringAnimator.prototype.equalState = function (newState: string | null | undefined, oldState: string | null | undefined): boolean {\n    return newState === oldState;\n  };\n\n  return StringAnimator;\n})(Animator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnimatorFactory, Animator} from \"./Animator\";\n\n/** @internal */\nexport const NumberAnimator = (function (_super: typeof Animator) {\n  const NumberAnimator = _super.extend(\"NumberAnimator\") as AnimatorFactory<Animator<any, number | null | undefined, number | string | null | undefined>>;\n\n  NumberAnimator.prototype.fromAny = function (value: number | string | null | undefined): number | null | undefined {\n    if (typeof value === \"string\") {\n      const number = +value;\n      if (isFinite(number)) {\n        return number;\n      } else {\n        throw new Error(value);\n      }\n    } else {\n      return value;\n    }\n  };\n\n  NumberAnimator.prototype.equalState = function (newState: number | null | undefined, oldState: number | null | undefined): boolean {\n    return newState === oldState;\n  };\n\n  return NumberAnimator;\n})(Animator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnimatorFactory, Animator} from \"./Animator\";\n\n/** @internal */\nexport const BooleanAnimator = (function (_super: typeof Animator) {\n  const BooleanAnimator = _super.extend(\"BooleanAnimator\") as AnimatorFactory<Animator<any, boolean | null | undefined, boolean | string | null | undefined>>;\n\n  BooleanAnimator.prototype.fromAny = function (value: boolean | string | null | undefined): boolean | null | undefined {\n    return !!value;\n  };\n\n  BooleanAnimator.prototype.equalState = function (newState: boolean | null | undefined, oldState: boolean | null | undefined): boolean {\n    return newState === oldState;\n  };\n\n  return BooleanAnimator;\n})(Animator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Class, Observable, ObserverType, Service} from \"@swim/util\";\nimport {Affinity} from \"../fastener/Affinity\";\nimport {FastenerOwner, FastenerInit, FastenerClass, Fastener} from \"../fastener/Fastener\";\n\n/** @internal */\nexport type MemberProviderService<O, K extends keyof O> =\n  O[K] extends Provider<any, infer S> ? S : never;\n\n/** @internal */\nexport type ProviderService<P extends Provider<any, any>> =\n  P extends Provider<any, infer S> ? S : never;\n\n/** @public */\nexport interface ProviderInit<S = unknown> extends FastenerInit {\n  extends?: {prototype: Provider<any, any>} | string | boolean | null;\n  type?: unknown;\n  observes?: boolean;\n\n  willInherit?(superFastener: Provider<unknown, S>): void;\n  didInherit?(superFastener: Provider<unknown, S>): void;\n  willUninherit?(superFastener: Provider<unknown, S>): void;\n  didUninherit?(superFastener: Provider<unknown, S>): void;\n\n  willBindSuperFastener?(superFastener: Provider<unknown, S>): void;\n  didBindSuperFastener?(superFastener: Provider<unknown, S>): void;\n  willUnbindSuperFastener?(superFastener: Provider<unknown, S>): void;\n  didUnbindSuperFastener?(superFastener: Provider<unknown, S>): void;\n\n  service?: S;\n  createService?(): S;\n}\n\n/** @public */\nexport type ProviderDescriptor<O = unknown, S = unknown, I = {}> = ThisType<Provider<O, S> & I> & ProviderInit<S> & Partial<I>;\n\n/** @public */\nexport interface ProviderClass<P extends Provider<any, any> = Provider<any, any>> extends FastenerClass<P> {\n}\n\n/** @public */\nexport interface ProviderFactory<P extends Provider<any, any> = Provider<any, any>> extends ProviderClass<P> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): ProviderFactory<P> & I;\n\n  define<O, S>(className: string, descriptor: ProviderDescriptor<O, S>): ProviderFactory;\n  define<O, S extends Observable>(className: string, descriptor: {observes: boolean} & ProviderDescriptor<O, S, ObserverType<S>>): ProviderFactory<Provider<any, S>>;\n  define<O, S, I = {}>(className: string, descriptor: ProviderDescriptor<O, S, I>): ProviderFactory<Provider<any, S> & I>;\n  define<O, S extends Observable, I = {}>(className: string, descriptor: {observes: boolean} & ProviderDescriptor<O, S, I & ObserverType<S>>): ProviderFactory<Provider<any, S> & I>;\n\n  <O, S>(descriptor: ProviderDescriptor<O, S>): PropertyDecorator;\n  <O, S extends Observable>(descriptor: {observes: boolean} & ProviderDescriptor<O, S, ObserverType<S>>): PropertyDecorator;\n  <O, S, I = {}>(descriptor: ProviderDescriptor<O, S, I>): PropertyDecorator;\n  <O, S extends Observable, I = {}>(descriptor: {observes: boolean} & ProviderDescriptor<O, S, I & ObserverType<S>>): PropertyDecorator;\n}\n\n/** @public */\nexport interface Provider<O = unknown, S = unknown> extends Fastener<O> {\n  (): S;\n\n  /** @override */\n  get familyType(): Class<Provider<any, any>> | null;\n\n  /** @internal @override */\n  setInherited(inherited: boolean, superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  willInherit(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  onInherit(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  didInherit(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  willUninherit(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  onUninherit(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  didUninherit(superFastener: Provider<unknown, S>): void;\n\n  /** @override */\n  get superFastener(): Provider<unknown, S> | null;\n\n  /** @internal @override */\n  getSuperFastener(): Provider<unknown, S> | null;\n\n  /** @protected @override */\n  willBindSuperFastener(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  onBindSuperFastener(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  didBindSuperFastener(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  willUnbindSuperFastener(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  onUnbindSuperFastener(superFastener: Provider<unknown, S>): void;\n\n  /** @protected @override */\n  didUnbindSuperFastener(superFastener: Provider<unknown, S>): void;\n\n  /** @internal @override */\n  attachSubFastener(subFastener: Provider<unknown, S>): void;\n\n  /** @internal @override */\n  detachSubFastener(subFastener: Provider<unknown, S>): void;\n\n  readonly service: S;\n\n  getService(): NonNullable<S>;\n\n  getServiceOr<E>(elseService: E): NonNullable<S> | E;\n\n  /** @internal */\n  createService(): S;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n\n  /** @internal */\n  get observes(): boolean | undefined; // optional prototype field\n}\n\n/** @public */\nexport const Provider = (function (_super: typeof Fastener) {\n  const Provider: ProviderFactory = _super.extend(\"Provider\");\n\n  Object.defineProperty(Provider.prototype, \"familyType\", {\n    get: function (this: Provider): Class<Provider<any, any>> | null {\n      return Provider;\n    },\n    configurable: true,\n  });\n\n  Provider.prototype.onInherit = function <S>(this: Provider<unknown, S>, superFastener: Provider<unknown, S>): void {\n    (this as Mutable<typeof this>).service = superFastener.service;\n  };\n\n  Provider.prototype.onBindSuperFastener = function <S>(this: Provider<unknown, S>, superFastener: Provider<unknown, S>): void {\n    if (this.inherits && this.affinity === Affinity.Inherited) {\n      this.initAffinity(Affinity.Transient);\n    }\n    _super.prototype.onBindSuperFastener.call(this, superFastener);\n  };\n\n  Provider.prototype.onUnbindSuperFastener = function <S>(this: Provider<unknown, S>, superFastener: Provider<unknown, S>): void {\n    _super.prototype.onUnbindSuperFastener.call(this, superFastener);\n    if (this.inherits && this.affinity === Affinity.Transient) {\n      this.initAffinity(Affinity.Inherited);\n    }\n  };\n\n  Provider.prototype.getService = function <S>(this: Provider<unknown, S>): NonNullable<S> {\n    const service = this.service;\n    if (service === void 0 || service === null) {\n      let message = service + \" \";\n      if (this.name.length !== 0) {\n        message += this.name + \" \";\n      }\n      message += \"service\";\n      throw new TypeError(message);\n    }\n    return service as NonNullable<S>;\n  };\n\n  Provider.prototype.getServiceOr = function <S, E>(this: Provider<unknown, S>, elseService: E): NonNullable<S> | E {\n    let service: S | E = this.service;\n    if (service === void 0 || service === null) {\n      service = elseService;\n    }\n    return service as NonNullable<S> | E;\n  };\n\n  Provider.prototype.createService = function <S>(this: Provider<unknown, S>): S {\n    return this.service;\n  };\n\n  Provider.prototype.onMount = function (this: Provider): void {\n    _super.prototype.onMount.call(this);\n    let service = this.service;\n    if (service === void 0 || service === null) {\n      service = this.createService();\n      (this as Mutable<typeof this>).service = service;\n    }\n    if (Observable.is(service)) {\n      if (!this.inherited && service instanceof Service) {\n        service.attachRoot(this.owner);\n      }\n      if (this.observes !== false) {\n        service.observe(this);\n      }\n    }\n  };\n\n  Provider.prototype.onUnmount = function (this: Provider): void {\n    const service = this.service;\n    if (Observable.is(service)) {\n      if (this.observes !== false) {\n        service.unobserve(this);\n      }\n      if (!this.inherited && service instanceof Service) {\n        service.detachRoot(this.owner);\n      }\n    }\n    _super.prototype.onUnmount.call(this);\n  };\n\n  Provider.construct = function <P extends Provider<any, any>>(providerClass: {prototype: P}, provider: P | null, owner: FastenerOwner<P>): P {\n    if (provider === null) {\n      provider = function (): ProviderService<P> {\n        return provider!.service;\n      } as P;\n      delete (provider as Partial<Mutable<P>>).name; // don't clobber prototype name\n      Object.setPrototypeOf(provider, providerClass.prototype);\n    }\n    provider = _super.construct(providerClass, provider, owner) as P;\n    (provider as Mutable<typeof provider>).service = void 0 as unknown as ProviderService<P>;\n    provider.initAffinity(Affinity.Inherited);\n    provider.initInherits(true);\n    return provider;\n  };\n\n  Provider.define = function <O, S>(className: string, descriptor: ProviderDescriptor<O, S>): ProviderFactory<Provider<any, S>> {\n    let superClass = descriptor.extends as ProviderFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const service = descriptor.service;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.service;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const providerClass = superClass.extend(className, descriptor);\n\n    providerClass.construct = function (providerClass: {prototype: Provider<any, any>}, provider: Provider<O, S> | null, owner: O): Provider<O, S> {\n      provider = superClass!.construct(providerClass, provider, owner);\n      if (affinity !== void 0) {\n        provider.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        provider.initInherits(inherits);\n      }\n      if (service !== void 0) {\n        (provider as Mutable<typeof provider>).service = service;\n      }\n      return provider;\n    };\n\n    return providerClass;\n  };\n\n  return Provider;\n})(Fastener);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Mutable,\n  Class,\n  Family,\n  Arrays,\n  HashCode,\n  ObserverType,\n  Observable,\n  ObserverMethods,\n  ObserverParameters,\n} from \"@swim/util\";\nimport {FastenerContext} from \"../fastener/FastenerContext\";\nimport type {Fastener} from \"../fastener/Fastener\";\nimport type {HierarchyObserver} from \"./HierarchyObserver\";\n\n/** @beta */\nexport type HierarchyFlags = number;\n\n/** @beta */\nexport abstract class Hierarchy implements HashCode, Family, Observable, FastenerContext {\n  constructor() {\n    this.uid = (this.constructor as typeof Hierarchy).uid();\n    this.key = void 0;\n    this.flags = 0;\n    this.fasteners = null;\n    this.decoherent = null;\n    this.observers = Arrays.empty;\n  }\n\n  /** @override */\n  readonly familyType?: Class<Hierarchy>;\n\n  /** @override */\n  readonly observerType?: Class<HierarchyObserver>;\n\n  /** @internal */\n  readonly uid: number;\n\n  readonly key: string | undefined;\n\n  /** @internal */\n  setKey(key: string | undefined): void {\n    (this as Mutable<this>).key = key;\n  }\n\n  /** @internal */\n  readonly flags: HierarchyFlags;\n\n  /** @internal */\n  setFlags(flags: HierarchyFlags): void {\n    (this as Mutable<this>).flags = flags;\n  }\n\n  abstract readonly parent: Hierarchy | null;\n\n  /** @internal */\n  attachParent(parent: Hierarchy): void {\n    // assert(this.parent === null);\n    this.willAttachParent(parent);\n    if (parent.mounted) {\n      this.cascadeMount();\n    }\n    this.onAttachParent(parent);\n    this.didAttachParent(parent);\n  }\n\n  protected willAttachParent(parent: Hierarchy): void {\n    // hook\n  }\n\n  protected onAttachParent(parent: Hierarchy): void {\n    // hook\n  }\n\n  protected didAttachParent(parent: Hierarchy): void {\n    // hook\n  }\n\n  /** @internal */\n  detachParent(parent: Hierarchy): void {\n    // assert(this.parent === parent);\n    this.willDetachParent(parent);\n    if (this.mounted) {\n      this.cascadeUnmount();\n    }\n    this.onDetachParent(parent);\n    this.didDetachParent(parent);\n  }\n\n  protected willDetachParent(parent: Hierarchy): void {\n    // hook\n  }\n\n  protected onDetachParent(parent: Hierarchy): void {\n    // hook\n  }\n\n  protected didDetachParent(parent: Hierarchy): void {\n    // hook\n  }\n\n  abstract readonly childCount: number;\n\n  abstract readonly children: ReadonlyArray<Hierarchy>;\n\n  abstract firstChild(): Hierarchy | null;\n\n  abstract lastChild(): Hierarchy | null;\n\n  abstract nextChild(target: Hierarchy): Hierarchy | null;\n\n  abstract previousChild(target: Hierarchy): Hierarchy | null;\n\n  abstract forEachChild<T>(callback: (child: Hierarchy) => T | void): T | undefined;\n  abstract forEachChild<T, S>(callback: (this: S, child: Hierarchy) => T | void, thisArg: S): T | undefined;\n\n  abstract getChild<F extends abstract new (...args: any[]) => Hierarchy>(key: string, childBound: F): InstanceType<F> | null;\n  abstract getChild(key: string, childBound?: abstract new (...args: any[]) => Hierarchy): Hierarchy | null;\n\n  abstract setChild(key: string, newChild: Hierarchy | null): Hierarchy | null;\n\n  abstract appendChild<H extends Hierarchy>(child: H, key?: string): H;\n\n  abstract prependChild<H extends Hierarchy>(child: H, key?: string): H;\n\n  abstract insertChild<H extends Hierarchy>(child: H, target: Hierarchy | null, key?: string): H;\n\n  abstract replaceChild<H extends Hierarchy>(newChild: Hierarchy, oldChild: H): H;\n\n  get insertChildFlags(): HierarchyFlags {\n    return (this.constructor as typeof Hierarchy).InsertChildFlags;\n  }\n\n  protected willInsertChild(child: Hierarchy, target: Hierarchy | null): void {\n    // hook\n  }\n\n  protected onInsertChild(child: Hierarchy, target: Hierarchy | null): void {\n    this.requireUpdate(this.insertChildFlags);\n  }\n\n  protected didInsertChild(child: Hierarchy, target: Hierarchy | null): void {\n    // hook\n  }\n\n  /** @internal */\n  cascadeInsert(): void {\n    // hook\n  }\n\n  abstract removeChild(key: string): Hierarchy | null;\n  abstract removeChild<H extends Hierarchy>(child: H): H;\n\n  get removeChildFlags(): HierarchyFlags {\n    return (this.constructor as typeof Hierarchy).RemoveChildFlags;\n  }\n\n  protected willRemoveChild(child: Hierarchy): void {\n    // hook\n  }\n\n  protected onRemoveChild(child: Hierarchy): void {\n    this.requireUpdate(this.removeChildFlags);\n  }\n\n  protected didRemoveChild(child: Hierarchy): void {\n    // hook\n  }\n\n  abstract removeChildren(): void;\n\n  remove(): void {\n    const parent: Hierarchy | null = this.parent;\n    if (parent !== null) {\n      if (!this.traversing) {\n        parent.removeChild(this);\n      } else {\n        this.setFlags(this.flags | Hierarchy.RemovingFlag);\n      }\n    }\n  }\n\n  getSuper<F extends abstract new (...args: any[]) => Hierarchy>(superBound: F): InstanceType<F> | null {\n    const parent = this.parent;\n    if (parent === null) {\n      return null;\n    } else if (parent instanceof superBound) {\n      return parent as InstanceType<F>;\n    } else {\n      return (parent as Hierarchy).getSuper(superBound);\n    }\n  }\n\n  getBase<F extends abstract new (...args: any[]) => Hierarchy>(baseBound: F): InstanceType<F> | null {\n    const parent = this.parent;\n    if (parent === null) {\n      return null;\n    } else {\n      const base = parent.getBase(baseBound);\n      if (base !== null) {\n        return base;\n      } else {\n        return parent instanceof baseBound ? parent as InstanceType<F> : null;\n      }\n    }\n  }\n\n  get mounted(): boolean {\n    return (this.flags & Hierarchy.MountedFlag) !== 0;\n  }\n\n  get mountFlags(): HierarchyFlags {\n    return (this.constructor as typeof Hierarchy).MountFlags;\n  }\n\n  /** @internal */\n  cascadeMount(): void {\n    if ((this.flags & Hierarchy.MountedFlag) === 0) {\n      this.setFlags(this.flags | (Hierarchy.MountedFlag | Hierarchy.TraversingFlag));\n      try {\n        this.willMount();\n        this.onMount();\n        this.mountChildren();\n        this.didMount();\n      } finally {\n        this.setFlags(this.flags & ~Hierarchy.TraversingFlag);\n      }\n    } else {\n      throw new Error(\"already mounted\");\n    }\n  }\n\n  protected willMount(): void {\n    // hook\n  }\n\n  protected onMount(): void {\n    this.requireUpdate(this.mountFlags);\n    this.mountFasteners();\n  }\n\n  protected didMount(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected mountChildren(): void {\n    type self = this;\n    function mountChild(this: self, child: Hierarchy): void {\n      child.cascadeMount();\n      if ((child.flags & Hierarchy.RemovingFlag) !== 0) {\n        child.setFlags(child.flags & ~Hierarchy.RemovingFlag);\n        this.removeChild(child);\n      }\n    }\n    this.forEachChild(mountChild, this);\n  }\n\n  /** @internal */\n  cascadeUnmount(): void {\n    if ((this.flags & Hierarchy.MountedFlag) !== 0) {\n      this.setFlags(this.flags & ~Hierarchy.MountedFlag | Hierarchy.TraversingFlag);\n      try {\n        this.willUnmount();\n        this.unmountChildren();\n        this.onUnmount();\n        this.didUnmount();\n      } finally {\n        this.setFlags(this.flags & ~Hierarchy.TraversingFlag);\n      }\n    } else {\n      throw new Error(\"already unmounted\");\n    }\n  }\n\n  protected willUnmount(): void {\n    // hook\n  }\n\n  protected onUnmount(): void {\n    this.unmountFasteners();\n    this.setFlags(this.flags & ~Hierarchy.RemovingFlag);\n  }\n\n  protected didUnmount(): void {\n    // hook\n  }\n\n  /** @internal */\n  protected unmountChildren(): void {\n    type self = this;\n    function unmountChild(this: self, child: Hierarchy): void {\n      child.cascadeUnmount();\n      if ((child.flags & Hierarchy.RemovingFlag) !== 0) {\n        child.setFlags(child.flags & ~Hierarchy.RemovingFlag);\n        this.removeChild(child);\n      }\n    }\n    this.forEachChild(unmountChild, this);\n  }\n\n  get traversing(): boolean {\n    return (this.flags & Hierarchy.TraversingFlag) !== 0;\n  }\n\n  requireUpdate(updateFlags: HierarchyFlags, immediate?: boolean): void {\n    // hook\n  }\n\n  /** @internal */\n  readonly fasteners: {[fastenerName: string]: Fastener | undefined} | null;\n\n  /** @override */\n  hasFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): boolean {\n    const fasteners = this.fasteners;\n    if (fasteners !== null) {\n      const fastener = fasteners[fastenerName];\n      if (fastener !== void 0 && (fastenerBound === void 0 || fastenerBound === null || fastener instanceof fastenerBound)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** @override */\n  getFastener<F extends Fastener<any>>(fastenerName: string, fastenerBound: Class<F>): F | null;\n  /** @override */\n  getFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n  getFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null {\n    const fasteners = this.fasteners;\n    if (fasteners !== null) {\n      const fastener = fasteners[fastenerName];\n      if (fastener !== void 0 && (fastenerBound === void 0 || fastenerBound === null || fastener instanceof fastenerBound)) {\n        return fastener;\n      }\n    }\n    return null;\n  }\n\n  /** @override */\n  setFastener(fastenerName: string, newFastener: Fastener | null): void {\n    const fasteners = this.fasteners;\n    const oldFastener: Fastener | null | undefined = fasteners !== null ? fasteners[fastenerName] ?? null : null;\n    if (oldFastener !== newFastener) {\n      if (oldFastener !== null) {\n        this.detachFastener(fastenerName, oldFastener);\n      }\n      if (newFastener !== null) {\n        this.attachFastener(fastenerName, newFastener);\n      }\n    }\n  }\n\n  /** @internal */\n  protected attachFastener(fastenerName: string, fastener: Fastener): void {\n    let fasteners = this.fasteners;\n    if (fasteners === null) {\n      fasteners = {};\n      (this as Mutable<this>).fasteners = fasteners;\n    }\n    // assert(fasteners[fastenerName] === void 0);\n    this.willAttachFastener(fastenerName, fastener);\n    fasteners[fastenerName] = fastener;\n    if (this.mounted) {\n      fastener.mount();\n    }\n    this.onAttachFastener(fastenerName, fastener);\n    this.didAttachFastener(fastenerName, fastener);\n  }\n\n  protected willAttachFastener(fastenerName: string, fastener: Fastener): void {\n    // hook\n  }\n\n  protected onAttachFastener(fastenerName: string, fastener: Fastener): void {\n    // hook\n  }\n\n  protected didAttachFastener(fastenerName: string, fastener: Fastener): void {\n    // hook\n  }\n\n  /** @internal */\n  protected detachFastener(fastenerName: string, fastener: Fastener): void {\n    const fasteners = this.fasteners!;\n    // assert(fasteners !== null);\n    // assert(fasteners[fastenerName] === fastener);\n    this.willDetachFastener(fastenerName, fastener);\n    this.onDetachFastener(fastenerName, fastener);\n    if (this.mounted) {\n      fastener.unmount();\n    }\n    delete fasteners[fastenerName];\n    this.didDetachFastener(fastenerName, fastener);\n  }\n\n  protected willDetachFastener(fastenerName: string, fastener: Fastener): void {\n    // hook\n  }\n\n  protected onDetachFastener(fastenerName: string, fastener: Fastener): void {\n    // hook\n  }\n\n  protected didDetachFastener(fastenerName: string, fastener: Fastener): void {\n    // hook\n  }\n\n  /** @override */\n  getLazyFastener<F extends Fastener<any>>(fastenerName: string, fastenerBound: Class<F>): F | null;\n  /** @override */\n  getLazyFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n  getLazyFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null {\n    return FastenerContext.getLazyFastener(this, fastenerName, fastenerBound);\n  }\n\n  /** @override */\n  getSuperFastener<F extends Fastener<any>>(fastenerName: string, fastenerBound: Class<F>): F | null;\n  /** @override */\n  getSuperFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null;\n  getSuperFastener(fastenerName: string, fastenerBound?: Class<Fastener> | null): Fastener | null {\n    const parent = this.parent;\n    if (parent === null) {\n      return null;\n    } else {\n      const parentFastener = parent.getLazyFastener(fastenerName, fastenerBound);\n      if (parentFastener !== null) {\n        return parentFastener;\n      } else {\n        return parent.getSuperFastener(fastenerName, fastenerBound);\n      }\n    }\n  }\n\n  /** @internal */\n  protected mountFasteners(): void {\n    const fasteners = this.fasteners;\n    for (const fastenerName in fasteners) {\n      const fastener = fasteners[fastenerName]!;\n      fastener.mount();\n    }\n    FastenerContext.init(this);\n  }\n\n  /** @internal */\n  protected unmountFasteners(): void {\n    const fasteners = this.fasteners;\n    for (const fastenerName in fasteners) {\n      const fastener = fasteners[fastenerName]!;\n      fastener.unmount();\n    }\n  }\n\n  /** @internal */\n  readonly decoherent: ReadonlyArray<Fastener> | null;\n\n  /** @override */\n  decohereFastener(fastener: Fastener): void {\n    let decoherent = this.decoherent as Fastener[];\n    if (decoherent === null) {\n      decoherent = [];\n      (this as Mutable<this>).decoherent = decoherent;\n    }\n    decoherent.push(fastener);\n  }\n\n  recohereFasteners(t?: number): void {\n    const decoherent = this.decoherent;\n    if (decoherent !== null) {\n      const decoherentCount = decoherent.length;\n      if (decoherentCount !== 0) {\n        if (t === void 0) {\n          t = performance.now();\n        }\n        (this as Mutable<this>).decoherent = null;\n        for (let i = 0; i < decoherentCount; i += 1) {\n          const fastener = decoherent[i]!;\n          fastener.recohere(t);\n        }\n      }\n    }\n  }\n\n  /** @internal */\n  readonly observers: ReadonlyArray<ObserverType<this>>;\n\n  /** @override */\n  observe(observer: ObserverType<this>): void {\n    const oldObservers = this.observers;\n    const newObservers = Arrays.inserted(observer, oldObservers);\n    if (oldObservers !== newObservers) {\n      this.willObserve(observer);\n      (this as Mutable<this>).observers = newObservers;\n      this.onObserve(observer);\n      this.didObserve(observer);\n    }\n  }\n\n  protected willObserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected onObserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected didObserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  /** @override */\n  unobserve(observer: ObserverType<this>): void {\n    const oldObservers = this.observers;\n    const newObservers = Arrays.removed(observer, oldObservers);\n    if (oldObservers !== newObservers) {\n      this.willUnobserve(observer);\n      (this as Mutable<this>).observers = newObservers;\n      this.onUnobserve(observer);\n      this.didUnobserve(observer);\n    }\n  }\n\n  protected willUnobserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected onUnobserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  protected didUnobserve(observer: ObserverType<this>): void {\n    // hook\n  }\n\n  forEachObserver<T>(callback: (this: this, observer: ObserverType<this>) => T | void): T | undefined {\n    let result: T | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      result = callback.call(this, observer as ObserverType<this>) as T | undefined;\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return result;\n  }\n\n  callObservers<O, K extends keyof ObserverMethods<O>>(this: this & {readonly observerType?: Class<O>}, key: K, ...args: ObserverParameters<O, K>): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]! as ObserverMethods<O>;\n      const method = observer[key];\n      if (typeof method === \"function\") {\n        method.call(observer, ...args);\n      }\n    }\n  }\n\n  /** @override */\n  equals(that: unknown): boolean {\n    return this === that;\n  }\n\n  /** @override */\n  hashCode(): number {\n    return this.uid;\n  }\n\n  /** @internal */\n  static uid: () => number = (function () {\n    let nextId = 1;\n    return function uid(): number {\n      const id = ~~nextId;\n      nextId += 1;\n      return id;\n    }\n  })();\n\n  /** @internal */\n  static readonly MountedFlag: HierarchyFlags = 1 << 0;\n  /** @internal */\n  static readonly RemovingFlag: HierarchyFlags = 1 << 1;\n  /** @internal */\n  static readonly TraversingFlag: HierarchyFlags = 1 << 2;\n\n  /** @internal */\n  static readonly FlagShift: number = 3;\n  /** @internal */\n  static readonly FlagMask: HierarchyFlags = (1 << Hierarchy.FlagShift) - 1;\n\n  static readonly MountFlags: HierarchyFlags = 0;\n  static readonly InsertChildFlags: HierarchyFlags = 0;\n  static readonly RemoveChildFlags: HierarchyFlags = 0;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\n\n/** @internal */\nexport class KeysCursor<K, V> extends Cursor<K> {\n  constructor(cursor: Cursor<[K, V]>) {\n    super();\n    this.cursor = cursor;\n  }\n\n  /** @internal */\n  readonly cursor: Cursor<[K, V]>;\n\n  override isEmpty(): boolean {\n    return this.cursor.isEmpty();\n  }\n\n  override head(): K {\n    return this.cursor.head()[0];\n  }\n\n  override step(): void {\n    this.cursor.step();\n  }\n\n  override skip(count: number): void {\n    this.cursor.skip(count);\n  }\n\n  override hasNext(): boolean {\n    return this.cursor.hasNext();\n  }\n\n  override nextIndex(): number {\n    return this.cursor.nextIndex();\n  }\n\n  override next(): {value?: K, done: boolean} {\n    const {value, done} = this.cursor.next();\n    return {value: value && value[0], done};\n  }\n\n  override hasPrevious(): boolean {\n    return this.cursor.hasPrevious();\n  }\n\n  override previousIndex(): number {\n    return this.cursor.previousIndex();\n  }\n\n  override previous(): {value?: K, done: boolean} {\n    const {value, done} = this.cursor.previous();\n    return {value: value && value[0], done};\n  }\n\n  override delete(): void {\n    this.cursor.delete();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\n\n/** @internal */\nexport class ValuesCursor<K, V> extends Cursor<V> {\n  constructor(cursor: Cursor<[K, V]>) {\n    super();\n    this.cursor = cursor;\n  }\n\n  /** @internal */\n  readonly cursor: Cursor<[K, V]>;\n\n  override isEmpty(): boolean {\n    return this.cursor.isEmpty();\n  }\n\n  override head(): V {\n    return this.cursor.head()[1];\n  }\n\n  override step(): void {\n    this.cursor.step();\n  }\n\n  override skip(count: number): void {\n    this.cursor.skip(count);\n  }\n\n  override hasNext(): boolean {\n    return this.cursor.hasNext();\n  }\n\n  override nextIndex(): number {\n    return this.cursor.nextIndex();\n  }\n\n  override next(): {value?: V, done: boolean} {\n    const {value, done} = this.cursor.next();\n    return {value: value && value[1], done};\n  }\n\n  override hasPrevious(): boolean {\n    return this.cursor.hasPrevious();\n  }\n\n  override previousIndex(): number {\n    return this.cursor.previousIndex();\n  }\n\n  override previous(): {value?: V, done: boolean} {\n    const {value, done} = this.cursor.previous();\n    return {value: value && value[1], done};\n  }\n\n  override delete(): void {\n    this.cursor.delete();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\n\n/** @internal */\nexport abstract class NodeCursor<T, P> extends Cursor<T> {\n  constructor(pages: ReadonlyArray<P>, index: number,\n              childIndex: number, childCursor: Cursor<T> | null) {\n    super();\n    this.pages = pages;\n    this.index = index;\n    this.childIndex = childIndex;\n    this.childCursor = childCursor;\n  }\n\n  /** @internal */\n  readonly pages: ReadonlyArray<P>;\n\n  /** @internal */\n  index: number;\n\n  /** @internal */\n  childIndex: number;\n\n  /** @internal */\n  childCursor: Cursor<T> | null;\n\n  protected abstract pageSize(page: P): number;\n\n  protected abstract pageCursor(page: P): Cursor<T>;\n\n  protected abstract reversePageCursor(page: P): Cursor<T>;\n\n  override isEmpty(): boolean {\n    do {\n      if (this.childCursor !== null) {\n        if (!this.childCursor.isEmpty()) {\n          return false;\n        } else {\n          this.childCursor = null;\n        }\n      } else if (this.childIndex < this.pages.length) {\n        this.childCursor = this.pageCursor(this.pages[this.childIndex]!);\n        this.childIndex += 1;\n      } else {\n        this.childIndex = this.pages.length;\n        return true;\n      }\n    } while (true);\n  }\n\n  override head(): T {\n    do {\n      if (this.childCursor !== null) {\n        if (!this.childCursor.isEmpty()) {\n          return this.childCursor.head();\n        } else {\n          this.childCursor = null;\n        }\n      } else {\n        if (this.childIndex < this.pages.length) {\n          this.childCursor = this.pageCursor(this.pages[this.childIndex]!);\n          this.childIndex += 1;\n        } else {\n          this.childIndex = this.pages.length;\n          throw new Error(\"empty\");\n        }\n      }\n    } while (true);\n  }\n\n  override step(): void {\n    do {\n      if (this.childCursor !== null) {\n        if (!this.childCursor.isEmpty()) {\n          this.index += 1;\n          return;\n        } else {\n          this.childCursor = null;\n        }\n      } else {\n        if (this.childIndex < this.pages.length) {\n          this.childCursor = this.pageCursor(this.pages[this.childIndex]!);\n          this.childIndex += 1;\n        } else {\n          this.childIndex = this.pages.length;\n          throw new Error(\"empty\");\n        }\n      }\n    } while (true);\n  }\n\n  override skip(count: number): void {\n    while (count > 0) {\n      if (this.childCursor !== null) {\n        if (this.childCursor.hasNext()) {\n          this.index += 1;\n          count -= 1;\n          this.childCursor.next();\n        } else {\n          this.childCursor = null;\n        }\n      } else if (this.childIndex < this.pages.length) {\n        const page = this.pages[this.childIndex]!;\n        const pageSize = this.pageSize(page);\n        this.childIndex += 1;\n        if (pageSize < count) {\n          this.childCursor = this.pageCursor(page);\n          if (count > 0) {\n            this.index += count;\n            this.childCursor!.skip(count);\n            count = 0;\n          }\n          break;\n        } else {\n          this.index += pageSize;\n          count -= pageSize;\n        }\n      } else {\n        break;\n      }\n    }\n  }\n\n  override hasNext(): boolean {\n    do {\n      if (this.childCursor !== null) {\n        if (this.childCursor.hasNext()) {\n          return true;\n        } else {\n          this.childCursor = null;\n        }\n      } else if (this.childIndex < this.pages.length) {\n        this.childCursor = this.pageCursor(this.pages[this.childIndex]!);\n        this.childIndex += 1;\n      } else {\n        this.childIndex = this.pages.length;\n        return false;\n      }\n    } while (true);\n  }\n\n  override nextIndex(): number {\n    return this.index;\n  }\n\n  override next(): {value?: T, done: boolean} {\n    do {\n      if (this.childCursor !== null) {\n        if (this.childCursor.hasNext()) {\n          this.index += 1;\n          return this.childCursor.next();\n        } else {\n          this.childCursor = null;\n        }\n      } else {\n        if (this.childIndex < this.pages.length) {\n          this.childCursor = this.pageCursor(this.pages[this.childIndex]!);\n          this.childIndex += 1;\n        } else {\n          this.childIndex = this.pages.length;\n          return {done: true};\n        }\n      }\n    } while (true);\n  }\n\n  override hasPrevious(): boolean {\n    do {\n      if (this.childCursor !== null) {\n        if (this.childCursor.hasPrevious()) {\n          return true;\n        } else {\n          this.childCursor = null;\n        }\n      } else if (this.childIndex > 0) {\n        this.childCursor = this.reversePageCursor(this.pages[this.childIndex - 1]!);\n        this.childIndex -= 1;\n      } else {\n        this.childIndex = 0;\n        return false;\n      }\n    } while (true);\n  }\n\n  override previousIndex(): number {\n    return this.index - 1;\n  }\n\n  override previous(): {value?: T, done: boolean} {\n    do {\n      if (this.childCursor !== null) {\n        if (this.childCursor.hasPrevious()) {\n          this.index -= 1;\n          return this.childCursor.previous();\n        } else {\n          this.childCursor = null;\n        }\n      } else if (this.childIndex > 0) {\n        this.childCursor = this.reversePageCursor(this.pages[this.childIndex - 1]!);\n        this.childIndex -= 1;\n      } else {\n        this.childIndex = 0;\n        return {done: true};\n      }\n    } while (true);\n  }\n\n  override set(newValue: T): void {\n    this.childCursor!.set(newValue);\n  }\n\n  override delete(): void {\n    this.childCursor!.delete();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Values} from \"@swim/util\";\nimport type {BTreePage} from \"./BTreePage\";\n\n/** @public */\nexport abstract class BTreeContext<K, V> {\n  pageSplitSize: number = 32;\n\n  compare(x: K, y: K): number {\n    return Values.compare(x, y);\n  }\n\n  /** @internal */\n  pageShouldSplit(page: BTreePage<K, V, unknown>): boolean {\n    return page.arity > this.pageSplitSize;\n  }\n\n  /** @internal */\n  pageShouldMerge(page: BTreePage<K, V, unknown>): boolean {\n    return page.arity < this.pageSplitSize >>> 1;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor, ReducedMap} from \"@swim/util\";\nimport {BTreeContext} from \"./BTreeContext\";\nimport {BTreePage} from \"./\"; // forward import\n\n/** @public */\nexport class BTree<K = unknown, V = unknown, U = never> extends BTreeContext<K, V> implements ReducedMap<K, V, U> {\n  /** @internal */\n  root: BTreePage<K, V, U>;\n\n  constructor();\n  /** @internal */\n  constructor(root: BTreePage<K, V, U>);\n  constructor(root?: BTreePage<K, V, U>) {\n    super();\n    if (root === void 0) {\n      root = BTreePage.empty();\n    }\n    this.root = root;\n  }\n\n  get size(): number {\n    return this.root.size;\n  }\n\n  isEmpty(): boolean {\n    return this.root.isEmpty();\n  }\n\n  has(key: K): boolean {\n    return this.root.has(key, this);\n  }\n\n  get(key: K): V | undefined {\n    return this.root.get(key, this);\n  }\n\n  getEntry(index: number): [K, V] | undefined {\n    return this.root.getEntry(index);\n  }\n\n  firstKey(): K | undefined {\n    const entry = this.root.firstEntry();\n    if (entry !== void 0) {\n      return entry[0];\n    } else {\n      return void 0;\n    }\n  }\n\n  firstValue(): V | undefined {\n    const entry = this.root.firstEntry();\n    if (entry !== void 0) {\n      return entry[1];\n    } else {\n      return void 0;\n    }\n  }\n\n  firstEntry(): [K, V] | undefined {\n    return this.root.firstEntry();\n  }\n\n  lastKey(): K | undefined {\n    const entry = this.root.lastEntry();\n    if (entry !== void 0) {\n      return entry[0];\n    } else {\n      return void 0;\n    }\n  }\n\n  lastValue(): V | undefined {\n    const entry = this.root.lastEntry();\n    if (entry !== void 0) {\n      return entry[1];\n    } else {\n      return void 0;\n    }\n  }\n\n  lastEntry(): [K, V] | undefined {\n    return this.root.lastEntry();\n  }\n\n  nextKey(key: K): K | undefined {\n    const entry = this.root.nextEntry(key, this);\n    if (entry !== void 0) {\n      return entry[0];\n    } else {\n      return void 0;\n    }\n  }\n\n  nextValue(key: K): V | undefined {\n    const entry = this.root.nextEntry(key, this);\n    if (entry !== void 0) {\n      return entry[1];\n    } else {\n      return void 0;\n    }\n  }\n\n  nextEntry(key: K): [K, V] | undefined {\n    return this.root.nextEntry(key, this);\n  }\n\n  previousKey(key: K): K | undefined {\n    const entry = this.root.previousEntry(key, this);\n    if (entry !== void 0) {\n      return entry[0];\n    } else {\n      return void 0;\n    }\n  }\n\n  previousValue(key: K): V | undefined {\n    const entry = this.root.previousEntry(key, this);\n    if (entry !== void 0) {\n      return entry[1];\n    } else {\n      return void 0;\n    }\n  }\n\n  previousEntry(key: K): [K, V] | undefined {\n    return this.root.previousEntry(key, this);\n  }\n\n  set(key: K, newValue: V): this {\n    const oldRoot = this.root;\n    let newRoot = this.root.updated(key, newValue, this);\n    if (oldRoot !== newRoot) {\n      if (newRoot.size > oldRoot.size) {\n        newRoot = newRoot.balanced(this);\n      }\n      this.root = newRoot;\n    }\n    return this;\n  }\n\n  delete(key: K): boolean {\n    const oldRoot = this.root;\n    const newRoot = this.root.removed(key, this);\n    if (oldRoot !== newRoot) {\n      this.root = newRoot;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  drop(lower: number): this {\n    if (lower > 0 && this.root.size > 0) {\n      if (lower < this.root.size) {\n        this.root = this.root.drop(lower, this);\n      } else {\n        this.root = BTreePage.empty();\n      }\n    }\n    return this;\n  }\n\n  take(upper: number): this {\n    if (upper < this.root.size && this.root.size > 0) {\n      if (upper > 0) {\n        this.root = this.root.take(upper, this);\n      } else {\n        this.root = BTreePage.empty();\n      }\n    }\n    return this;\n  }\n\n  clear(): void {\n    this.root = BTreePage.empty();\n  }\n\n  updated(key: K, newValue: V): BTree<K, V, U> {\n    const oldRoot = this.root;\n    let newRoot = oldRoot.updated(key, newValue, this);\n    if (oldRoot !== newRoot) {\n      if (newRoot.size > oldRoot.size) {\n        newRoot = newRoot.balanced(this);\n      }\n      return this.copy(newRoot);\n    } else {\n      return this;\n    }\n  }\n\n  removed(key: K): BTree<K, V, U> {\n    const oldRoot = this.root;\n    const newRoot = oldRoot.removed(key, this);\n    if (oldRoot !== newRoot) {\n      return this.copy(newRoot);\n    } else {\n      return this;\n    }\n  }\n\n  cleared(): BTree<K, V, U> {\n    if (!this.root.isEmpty()) {\n      return this.copy(BTreePage.empty());\n    } else {\n      return this;\n    }\n  }\n\n  reduced(identity: U, accumulator: (result: U, element: V) => U, combiner: (result: U, result2: U) => U): U {\n    const oldRoot = this.root;\n    const newRoot = oldRoot.reduced(identity, accumulator, combiner);\n    if (oldRoot !== newRoot) {\n      this.root = newRoot;\n    }\n    return newRoot.fold!;\n  }\n\n  forEach<T>(callback: (key: K, value: V) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, key: K, value: V) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, key: K, value: V) => T | void,\n                thisArg?: S): T | undefined {\n    return this.root.forEach(callback, thisArg);\n  }\n\n  forEachKey<T>(callback: (key: K) => T | void): T | undefined;\n  forEachKey<T, S>(callback: (this: S, key: K) => T | void,\n                   thisArg: S): T | undefined;\n  forEachKey<T, S>(callback: (this: S | undefined, key: K) => T | void,\n                   thisArg?: S): T | undefined {\n    return this.root.forEachKey(callback, thisArg);\n  }\n\n  forEachValue<T>(callback: (value: V) => T | void): T | undefined;\n  forEachValue<T, S>(callback: (this: S, value: V) => T | void,\n                     thisArg: S): T | undefined;\n  forEachValue<T, S>(callback: (this: S | undefined, value: V) => T | void,\n                     thisArg?: S): T | undefined {\n    return this.root.forEachValue(callback, thisArg);\n  }\n\n  keys(): Cursor<K> {\n    return this.root.keys();\n  }\n\n  values(): Cursor<V> {\n    return this.root.values();\n  }\n\n  entries(): Cursor<[K, V]> {\n    return this.root.entries();\n  }\n\n  reverseKeys(): Cursor<K> {\n    return this.root.reverseKeys();\n  }\n\n  reverseValues(): Cursor<V> {\n    return this.root.reverseValues();\n  }\n\n  reverseEntries(): Cursor<[K, V]> {\n    return this.root.reverseEntries();\n  }\n\n  clone(): BTree<K, V, U> {\n    return this.copy(this.root);\n  }\n\n  /** @internal */\n  protected copy(root: BTreePage<K, V, U>): BTree<K, V, U> {\n    const tree = new BTree(root);\n    if (tree.compare !== this.compare) {\n      tree.compare = this.compare;\n    }\n    if (tree.pageSplitSize !== this.pageSplitSize) {\n      tree.pageSplitSize = this.pageSplitSize;\n    }\n    return tree;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Cursor} from \"@swim/util\";\nimport {KeysCursor} from \"./KeysCursor\";\nimport {ValuesCursor} from \"./ValuesCursor\";\nimport type {BTreeContext} from \"./BTreeContext\";\nimport {BTreeLeaf} from \"./\"; // forward import\n\n/** @internal */\nexport abstract class BTreePage<K, V, U> {\n  abstract readonly arity: number;\n\n  abstract readonly size: number;\n\n  abstract isEmpty(): boolean;\n\n  abstract readonly fold: U | undefined;\n\n  abstract minKey(): K;\n\n  abstract maxKey(): K;\n\n  abstract has(key: K, tree: BTreeContext<K, V>): boolean;\n\n  abstract get(key: K, tree: BTreeContext<K, V>): V | undefined;\n\n  abstract getEntry(index: number): [K, V] | undefined;\n\n  abstract firstEntry(): [K, V] | undefined;\n\n  abstract lastEntry(): [K, V] | undefined;\n\n  abstract nextEntry(key: K, tree: BTreeContext<K, V>): [K, V] | undefined;\n\n  abstract previousEntry(key: K, tree: BTreeContext<K, V>): [K, V] | undefined;\n\n  abstract updated(key: K, newValue: V, tree: BTreeContext<K, V>): BTreePage<K, V, U>;\n\n  abstract removed(key: K, tree: BTreeContext<K, V>): BTreePage<K, V, U>;\n\n  abstract drop(lower: number, tree: BTreeContext<K, V>): BTreePage<K, V, U>;\n\n  abstract take(upper: number, tree: BTreeContext<K, V>): BTreePage<K, V, U>;\n\n  abstract balanced(tree: BTreeContext<K, V>): BTreePage<K, V, U>;\n\n  abstract split(index: number): BTreePage<K, V, U>;\n\n  abstract splitLeft(index: number): BTreePage<K, V, U>;\n\n  abstract splitRight(index: number): BTreePage<K, V, U>;\n\n  abstract reduced(identity: U, accumulator: (result: U, element: V) => U,\n                   combiner: (result: U, result2: U) => U): BTreePage<K, V, U>;\n\n  abstract forEach<T, S>(callback: (this: S, key: K, value: V) => T | void,\n                         thisArg: S): T | undefined;\n\n  abstract forEachKey<T, S>(callback: (this: S, key: K) => T | void,\n                            thisArg: S): T | undefined;\n\n  abstract forEachValue<T, S>(callback: (this: S, value: V) => T | void,\n                              thisArg: S): T | undefined;\n\n  keys(): Cursor<K> {\n    return new KeysCursor(this.entries());\n  }\n\n  values(): Cursor<V> {\n    return new ValuesCursor(this.entries());\n  }\n\n  abstract entries(): Cursor<[K, V]>;\n\n  reverseKeys(): Cursor<K> {\n    return new KeysCursor(this.reverseEntries());\n  }\n\n  reverseValues(): Cursor<V> {\n    return new ValuesCursor(this.reverseEntries());\n  }\n\n  abstract reverseEntries(): Cursor<[K, V]>;\n\n  @Lazy\n  static empty<K, V, U>(): BTreeLeaf<K, V, U> {\n    return new BTreeLeaf([], void 0 as U | undefined);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport type {BTreeContext} from \"./BTreeContext\";\nimport {BTreePage} from \"./BTreePage\";\nimport {BTreeNode} from \"./\"; // forward import\n\n/** @internal */\nexport class BTreeLeaf<K, V, U> extends BTreePage<K, V, U> {\n  constructor(slots: ReadonlyArray<[K, V]>, fold: U | undefined) {\n    super();\n    this.slots = slots;\n    this.fold = fold;\n  }\n\n  /** @internal */\n  readonly slots: ReadonlyArray<[K, V]>;\n\n  override get arity(): number {\n    return this.slots.length;\n  }\n\n  override get size(): number {\n    return this.slots.length;\n  }\n\n  override isEmpty(): boolean {\n    return this.slots.length === 0;\n  }\n\n  override readonly fold: U | undefined;\n\n  override minKey(): K {\n    return this.slots[0]![0];\n  }\n\n  override maxKey(): K {\n    return this.slots[this.slots.length - 1]![0];\n  }\n\n  override has(key: K, tree: BTreeContext<K, V>): boolean {\n    return this.lookup(key, tree) >= 0;\n  }\n\n  override get(key: K, tree: BTreeContext<K, V>): V | undefined {\n    const x = this.lookup(key, tree);\n    if (x >= 0) {\n      return this.slots[x]![1];\n    } else {\n      return void 0;\n    }\n  }\n\n  override getEntry(index: number): [K, V] | undefined {\n    return this.slots[index];\n  }\n\n  override firstEntry(): [K, V] | undefined {\n    const slots = this.slots;\n    if (slots.length !== 0) {\n      return slots[0];\n    } else {\n      return void 0;\n    }\n  }\n\n  override lastEntry(): [K, V] | undefined {\n    const slots = this.slots;\n    if (slots.length !== 0) {\n      return slots[slots.length - 1];\n    } else {\n      return void 0;\n    }\n  }\n\n  override nextEntry(key: K, tree: BTreeContext<K, V>): [K, V] | undefined {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    return this.slots[x];\n  }\n\n  override previousEntry(key: K, tree: BTreeContext<K, V>): [K, V] | undefined {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x -= 1;\n    } else {\n      x = -(x + 2);\n    }\n    return this.slots[x];\n  }\n\n  override updated(key: K, newValue: V, tree: BTreeContext<K, V>): BTreeLeaf<K, V, U> {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      return this.updatedSlot(x, key, newValue);\n    } else {\n      x = -(x + 1);\n      return this.insertedSlot(x, key, newValue);\n    }\n  }\n\n  /** @internal */\n  updatedSlot(x: number, key: K, newValue: V): BTreeLeaf<K, V, U> {\n    const oldSlots = this.slots;\n    if (newValue !== oldSlots[x]![1]) {\n      const newSlots = oldSlots.slice(0);\n      newSlots[x] = [key, newValue];\n      return new BTreeLeaf(newSlots, void 0 as U | undefined);\n    } else {\n      return this;\n    }\n  }\n\n  /** @internal */\n  insertedSlot(x: number, key: K, newValue: V): BTreeLeaf<K, V, U> {\n    const oldSlots = this.slots;\n    const n = oldSlots.length + 1;\n    const newSlots = new Array<[K, V]>(n);\n    for (let i = 0; i < x; i += 1) {\n      newSlots[i] = oldSlots[i]!;\n    }\n    newSlots[x] = [key, newValue];\n    for (let i = x; i < n - 1; i += 1) {\n      newSlots[i + 1] = oldSlots[i]!;\n    }\n    return new BTreeLeaf(newSlots, void 0 as U | undefined);\n  }\n\n  override removed(key: K, tree: BTreeContext<K, V>): BTreeLeaf<K, V, U> {\n    const x = this.lookup(key, tree);\n    if (x >= 0) {\n      if (this.slots.length > 1) {\n        return this.removedSlot(x);\n      } else {\n        return BTreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  /** @internal */\n  removedSlot(x: number): BTreeLeaf<K, V, U> {\n    const oldSlots = this.slots;\n    const newSlots = new Array<[K, V]>(oldSlots.length - 1);\n    for (let i = 0; i < x; i += 1) {\n      newSlots[i] = oldSlots[i]!;\n    }\n    for (let i = x; i < newSlots.length; i += 1) {\n      newSlots[i] = oldSlots[i + 1]!;\n    }\n    return new BTreeLeaf(newSlots, void 0 as U | undefined);\n  }\n\n  override drop(lower: number, tree: BTreeContext<K, V>): BTreeLeaf<K, V, U> {\n    if (lower > 0) {\n      const oldSlots = this.slots;\n      if (lower < oldSlots.length) {\n        const size = oldSlots.length - lower;\n        const newSlots = new Array<[K, V]>(size);\n        for (let i = 0; i < size; i += 1) {\n          newSlots[i] = oldSlots[i + lower]!;\n        }\n        return new BTreeLeaf(newSlots, void 0 as U | undefined);\n      } else {\n        return BTreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override take(upper: number, tree: BTreeContext<K, V>): BTreeLeaf<K, V, U> {\n    const oldSlots = this.slots;\n    if (upper < oldSlots.length) {\n      if (upper > 0) {\n        const newSlots = new Array<[K, V]>(upper);\n        for (let i = 0; i < upper; i += 1) {\n          newSlots[i] = oldSlots[i]!;\n        }\n        return new BTreeLeaf(newSlots, void 0 as U | undefined);\n      } else {\n        return BTreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override balanced(tree: BTreeContext<K, V>): BTreePage<K, V, U> {\n    const n = this.slots.length;\n    if (n > 1 && tree.pageShouldSplit(this)) {\n      const x = n >>> 1;\n      return this.split(x);\n    } else {\n      return this;\n    }\n  }\n\n  override split(x: number): BTreeNode<K, V, U> {\n    const newPages = new Array<BTreePage<K, V, U>>(2);\n    const newLeftPage = this.splitLeft(x);\n    const newRightPage = this.splitRight(x);\n    newPages[0] = newLeftPage;\n    newPages[1] = newRightPage;\n\n    const newKnots = new Array<K>(1);\n    newKnots[0] = newRightPage.minKey();\n\n    return new BTreeNode(newPages, newKnots, void 0, this.slots.length);\n  }\n\n  override splitLeft(x: number): BTreeLeaf<K, V, U> {\n    const oldSlots = this.slots;\n    const newSlots = new Array<[K, V]>(x);\n    for (let i = 0; i < x; i += 1) {\n      newSlots[i] = oldSlots[i]!;\n    }\n    return new BTreeLeaf(newSlots, void 0 as U | undefined);\n  }\n\n  override splitRight(x: number): BTreeLeaf<K, V, U> {\n    const oldSlots = this.slots;\n    const y = oldSlots.length - x;\n    const newSlots = new Array<[K, V]>(y);\n    for (let i = 0; i < y; i += 1) {\n      newSlots[i] = oldSlots[i + x]!;\n    }\n    return new BTreeLeaf(newSlots, void 0 as U | undefined);\n  }\n\n  override reduced(identity: U, accumulator: (result: U, element: V) => U,\n                   combiner: (result: U, result2: U) => U): BTreeLeaf<K, V, U> {\n    if (this.fold === void 0) {\n      const slots = this.slots;\n      let fold = identity;\n      for (let i = 0, n = slots.length; i < n; i += 1) {\n        fold = accumulator(fold, slots[i]![1]);\n      }\n      return new BTreeLeaf(slots, fold);\n    } else {\n      return this;\n    }\n  }\n\n  override forEach<T, S>(callback: (this: S, key: K, value: V) => T | void,\n                         thisArg: S): T | undefined {\n    const slots = this.slots;\n    for (let i = 0, n = slots.length; i < n; i += 1) {\n      const slot = slots[i]!;\n      const result = callback.call(thisArg, slot[0], slot[1]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override forEachKey<T, S>(callback: (this: S, key: K) => T | void,\n                            thisArg: S): T | undefined {\n    const slots = this.slots;\n    for (let i = 0, n = slots.length; i < n; i += 1) {\n      const slot = slots[i]!;\n      const result = callback.call(thisArg, slot[0]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override forEachValue<T, S>(callback: (this: S, value: V) => T | void,\n                              thisArg: S): T | undefined {\n    const slots = this.slots;\n    for (let i = 0, n = slots.length; i < n; i += 1) {\n      const slot = slots[i]!;\n      const result = callback.call(thisArg, slot[1]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override entries(): Cursor<[K, V]> {\n    return Cursor.array(this.slots);\n  }\n\n  override reverseEntries(): Cursor<[K, V]> {\n    return Cursor.array(this.slots, this.slots.length);\n  }\n\n  /** @internal */\n  lookup(key: K, tree: BTreeContext<K, V>): number {\n    let lo = 0;\n    let hi = this.slots.length - 1;\n    while (lo <= hi) {\n      const mid = (lo + hi) >>> 1;\n      const order = tree.compare(key, this.slots[mid]![0]);\n      if (order > 0) {\n        lo = mid + 1;\n      } else if (order < 0) {\n        hi = mid - 1;\n      } else {\n        return mid;\n      }\n    }\n    return -(lo + 1);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport type {BTreeContext} from \"./BTreeContext\";\nimport {BTreePage} from \"./BTreePage\";\nimport {BTreeNodeCursor} from \"./\"; // forward import\n\n/** @internal */\nexport class BTreeNode<K, V, U> extends BTreePage<K, V, U> {\n  constructor(pages: ReadonlyArray<BTreePage<K, V, U>>, knots: ReadonlyArray<K>,\n              fold: U | undefined, size: number) {\n    super();\n    this.pages = pages;\n    this.knots = knots;\n    this.fold = fold;\n    this.size = size;\n  }\n\n  /** @internal */\n  readonly pages: ReadonlyArray<BTreePage<K, V, U>>;\n\n  /** @internal */\n  readonly knots: ReadonlyArray<K>;\n\n  override get arity(): number {\n    return this.pages.length;\n  }\n\n  override readonly size: number;\n\n  override isEmpty(): boolean {\n    return this.size === 0;\n  }\n\n  override readonly fold: U | undefined;\n\n  override minKey(): K {\n    return this.pages[0]!.minKey();\n  }\n\n  override maxKey(): K {\n    return this.pages[this.pages.length - 1]!.maxKey();\n  }\n\n  override has(key: K, tree: BTreeContext<K, V>): boolean {\n    let xx = this.lookup(key, tree);\n    if (xx > 0) {\n      xx += 1;\n    } else if (xx < 0) {\n      xx = -(xx + 1);\n    } else {\n      return true;\n    }\n    return this.pages[xx]!.has(key, tree);\n  }\n\n  override get(key: K, tree: BTreeContext<K, V>): V | undefined {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    return this.pages[x]!.get(key, tree);\n  }\n\n  override getEntry(x: number): [K, V] | undefined {\n    const pages = this.pages;\n    for (let i = 0, n = pages.length; i < n; i += 1) {\n      const page = pages[i]!;\n      if (x < page.size) {\n        return page.getEntry(x);\n      } else {\n        x -= page.size;\n      }\n    }\n    return void 0;\n  }\n\n  override firstEntry(): [K, V] | undefined {\n    const pages = this.pages;\n    if (pages.length !== 0) {\n      return pages[0]!.firstEntry();\n    } else {\n      return void 0;\n    }\n  }\n\n  override lastEntry(): [K, V] | undefined {\n    const pages = this.pages;\n    if (pages.length !== 0) {\n      return pages[pages.length - 1]!.lastEntry();\n    } else {\n      return void 0;\n    }\n  }\n\n  override nextEntry(key: K, tree: BTreeContext<K, V>): [K, V] | undefined {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const pages = this.pages;\n    let entry = pages[x]!.nextEntry(key, tree);\n    if (entry === void 0 && x + 1 < pages.length) {\n      entry = pages[x + 1]!.nextEntry(key, tree);\n    }\n    return entry;\n  }\n\n  override previousEntry(key: K, tree: BTreeContext<K, V>): [K, V] | undefined {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const pages = this.pages;\n    let entry = pages[x]!.previousEntry(key, tree);\n    if (entry === void 0 && x > 0) {\n      entry = pages[x - 1]!.previousEntry(key, tree);\n    }\n    return entry;\n  }\n\n  override updated(key: K, newValue: V, tree: BTreeContext<K, V>): BTreeNode<K, V, U> {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const oldPage = this.pages[x]!;\n    const newPage = oldPage.updated(key, newValue, tree);\n    if (oldPage !== newPage) {\n      if (oldPage.size !== newPage.size && tree.pageShouldSplit(newPage)) {\n        return this.updatedPageSplit(x, newPage, oldPage);\n      } else {\n        return this.updatedPage(x, newPage, oldPage);\n      }\n    } else {\n      return this;\n    }\n  }\n\n  /** @internal */\n  updatedPage(x: number, newPage: BTreePage<K, V, U>, oldPage: BTreePage<K, V, U>): BTreeNode<K, V, U> {\n    const oldPages = this.pages;\n    const newPages = oldPages.slice(0);\n    newPages[x] = newPage;\n\n    const oldKnots = this.knots;\n    let newKnots: K[];\n    if (oldKnots.length > 0) {\n      newKnots = oldKnots.slice(0);\n      if (x > 0) {\n        newKnots[x - 1] = newPage.minKey();\n      }\n    } else {\n      newKnots = [];\n    }\n\n    const newSize = this.size - oldPage.size + newPage.size;\n    return new BTreeNode(newPages, newKnots, void 0, newSize);\n  }\n\n  /** @internal */\n  updatedPageSplit(x: number, newPage: BTreePage<K, V, U>, oldPage: BTreePage<K, V, U>): BTreeNode<K, V, U> {\n    const oldPages = this.pages;\n    const newPages = new Array<BTreePage<K, V, U>>(oldPages.length + 1);\n    for (let i = 0; i < x; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n\n    const newLeftPage = newPage.splitLeft(newPage.arity >>> 1);\n    const newRightPage = newPage.splitRight(newPage.arity >>> 1);\n    newPages[x] = newLeftPage;\n    newPages[x + 1] = newRightPage;\n    for (let i = x + 1; i < oldPages.length; i += 1) {\n      newPages[i + 1] = oldPages[i]!;\n    }\n\n    const oldKnots = this.knots;\n    const newKnots = new Array<K>(oldPages.length);\n    if (x > 0) {\n      for (let i = 0; i < x - 1; i += 1) {\n        newKnots[i] = oldKnots[i]!;\n      }\n      newKnots[x - 1] = newLeftPage.minKey();\n      newKnots[x] = newRightPage.minKey();\n      for (let i = x; i < oldKnots.length; i += 1) {\n        newKnots[i + 1] = oldKnots[i]!;\n      }\n    } else {\n      newKnots[0] = newRightPage.minKey();\n      for (let i = 0; i < oldKnots.length; i += 1) {\n        newKnots[i + 1] = oldKnots[i]!;\n      }\n    }\n\n    const newSize = this.size - oldPage.size + newPage.size;\n    return new BTreeNode(newPages, newKnots, void 0, newSize);\n  }\n\n  /** @internal */\n  updatedPageMerge(x: number, newPage: BTreeNode<K, V, U>, oldPage: BTreePage<K, V, U>): BTreeNode<K, V, U> {\n    const oldPages = this.pages;\n    const midPages = newPage.pages;\n    const newPages = new Array<BTreePage<K, V, U>>(oldPages.length + midPages.length - 1);\n    for (let i = 0; i < x; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n    for (let i = 0; i < midPages.length; i += 1) {\n      newPages[i + x] = midPages[i]!;\n    }\n    for (let i = x + 1; i < oldPages.length; i += 1) {\n      newPages[i + midPages.length - 1] = oldPages[i]!;\n    }\n\n    const oldKnots = this.knots;\n    const midKnots = newPage.knots;\n    const newKnots = new Array<K>(newPages.length - 1);\n    if (x > 0) {\n      for (let i = 0; i < x - 1; i += 1) {\n        newKnots[i] = oldKnots[i]!;\n      }\n      newKnots[x - 1] = midPages[0]!.minKey();\n      for (let i = 0; i < midKnots.length; i += 1) {\n        newKnots[i + x] = midKnots[i]!;\n      }\n      for (let i = x; i < oldKnots.length; i += 1) {\n        newKnots[i + midKnots.length] = oldKnots[i]!;\n      }\n    } else {\n      for (let i = 0; i < midKnots.length; i += 1) {\n        newKnots[i] = midKnots[i]!;\n      }\n      newKnots[midKnots.length] = oldPages[1]!.minKey();\n      for (let i = 1; i < oldKnots.length; i += 1) {\n        newKnots[i + midKnots.length] = oldKnots[i]!;\n      }\n    }\n\n    const newSize = this.size - oldPage.size + newPage.size;\n    return new BTreeNode(newPages, newKnots, void 0, newSize);\n  }\n\n  override removed(key: K, tree: BTreeContext<K, V>): BTreePage<K, V, U> {\n    let x = this.lookup(key, tree);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const oldPage = this.pages[x]!;\n    const newPage = oldPage.removed(key, tree);\n    if (oldPage !== newPage) {\n      return this.replacedPage(x, newPage, oldPage, tree);\n    } else {\n      return this;\n    }\n  }\n\n  /** @internal */\n  replacedPage(x: number, newPage: BTreePage<K, V, U>, oldPage: BTreePage<K, V, U>,\n               tree: BTreeContext<K, V>): BTreePage<K, V, U> {\n    if (!newPage.isEmpty()) {\n      if (newPage instanceof BTreeNode && tree.pageShouldMerge(newPage)) {\n        return this.updatedPageMerge(x, newPage, oldPage);\n      } else {\n        return this.updatedPage(x, newPage, oldPage);\n      }\n    } else if (this.pages.length > 2) {\n      return this.removedPage(x, newPage, oldPage);\n    } else if (this.pages.length > 1) {\n      if (x === 0) {\n        return this.pages[1]!;\n      } else {\n        return this.pages[0]!;\n      }\n    } else {\n      return BTreePage.empty();\n    }\n  }\n\n  /** @internal */\n  removedPage(x: number, newPage: BTreePage<K, V, U>, oldPage: BTreePage<K, V, U>): BTreeNode<K, V, U> {\n    const oldPages = this.pages;\n    const newPages = new Array<BTreePage<K, V, U>>(oldPages.length - 1);\n    for (let i = 0; i < x; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n    for (let i = x + 1; i < oldPages.length; i += 1) {\n      newPages[i - 1] = oldPages[i]!;\n    }\n\n    const oldKnots = this.knots;\n    const newKnots = new Array<K>(oldKnots.length - 1);\n    if (x > 0) {\n      for (let i = 0; i < x - 1; i += 1) {\n        newKnots[i] = oldKnots[i]!;\n      }\n      for (let i = x; i < oldKnots.length; i += 1) {\n        newKnots[i - 1] = oldKnots[i]!;\n      }\n    } else {\n      for (let i = 1; i < oldKnots.length; i += 1) {\n        newKnots[i - 1] = oldKnots[i]!;\n      }\n    }\n\n    const newSize = this.size - oldPage.size;\n    return new BTreeNode(newPages, newKnots, void 0, newSize);\n  }\n\n  override drop(lower: number, tree: BTreeContext<K, V>): BTreePage<K, V, U> {\n    if (lower > 0) {\n      let newSize = this.size;\n      if (lower < newSize) {\n        const oldPages = this.pages;\n        let x = 0;\n        while (x < oldPages.length) {\n          const size = oldPages[x]!.size;\n          if (size <= lower) {\n            newSize -= size;\n            lower -= size;\n            x += 1;\n          } else {\n            break;\n          }\n        }\n        const newArity = oldPages.length - x;\n        if (newArity > 1) {\n          let newNode: BTreeNode<K, V, U>;\n          if (x > 0) {\n            const newPages = new Array<BTreePage<K, V, U>>(newArity);\n            for (let i = 0; i < newArity; i += 1) {\n              newPages[i] = oldPages[i + x]!;\n            }\n            const newKnots = new Array<K>(newArity - 1);\n            for (let i = 0; i < newKnots.length; i += 1) {\n              newKnots[i] = this.knots[i + x]!;\n            }\n            newNode = new BTreeNode(newPages, newKnots, void 0, newSize);\n          } else {\n            newNode = this;\n          }\n          if (lower > 0) {\n            const oldPage = oldPages[x]!;\n            const newPage = oldPage.drop(lower, tree);\n            return newNode.replacedPage(0, newPage, oldPage, tree);\n          } else {\n            return newNode;\n          }\n        } else {\n          return oldPages[x]!.drop(lower, tree);\n        }\n      } else {\n        return BTreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override take(upper: number, tree: BTreeContext<K, V>): BTreePage<K, V, U> {\n    if (upper < this.size) {\n      if (upper > 0) {\n        const oldPages = this.pages;\n        let x = 0;\n        let newSize = 0;\n        while (x < oldPages.length && upper > 0) {\n          const size = oldPages[x]!.size;\n          newSize += size;\n          x += 1;\n          if (size <= upper) {\n            upper -= size;\n          } else {\n            break;\n          }\n        }\n        const newArity = upper === 0 ? x : x + 1;\n        if (newArity > 1) {\n          let newNode: BTreeNode<K, V, U>;\n          if (x < oldPages.length) {\n            const newPages = new Array<BTreePage<K, V, U>>(newArity);\n            for (let i = 0; i < newArity; i += 1) {\n              newPages[i] = oldPages[i]!;\n            }\n            const newKnots = new Array<K>(newArity - 1);\n            for (let i = 0; i < newKnots.length; i += 1) {\n              newKnots[i] = this.knots[i]!;\n            }\n            newNode = new BTreeNode(newPages, newKnots, void 0, newSize);\n          } else {\n            newNode = this;\n          }\n          if (upper > 0) {\n            const oldPage = oldPages[x - 1]!;\n            const newPage = oldPage.take(upper, tree);\n            return newNode.replacedPage(x - 1, newPage, oldPage, tree);\n          } else {\n            return newNode;\n          }\n        } else if (upper > 0) {\n          return oldPages[0]!.take(upper, tree);\n        } else {\n          return oldPages[0]!;\n        }\n      } else {\n        return BTreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override balanced(tree: BTreeContext<K, V>): BTreeNode<K, V, U> {\n    if (this.pages.length > 1 && tree.pageShouldSplit(this)) {\n      const x = this.knots.length >>> 1;\n      return this.split(x);\n    } else {\n      return this;\n    }\n  }\n\n  override split(x: number): BTreeNode<K, V, U> {\n    const newPages = new Array<BTreePage<K, V, U>>(2);\n    const newLeftPage = this.splitLeft(x);\n    const newRightPage = this.splitRight(x);\n    newPages[0] = newLeftPage;\n    newPages[1] = newRightPage;\n\n    const newKnots = new Array<K>(1);\n    newKnots[0] = newRightPage.minKey();\n\n    return new BTreeNode(newPages, newKnots, void 0, this.size);\n  }\n\n  override splitLeft(x: number): BTreeNode<K, V, U> {\n    const oldPages = this.pages;\n    const newPages = new Array<BTreePage<K, V, U>>(x + 1);\n    for (let i = 0; i < x + 1; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n\n    const oldKnots = this.knots;\n    const newKnots = new Array<K>(x);\n    for (let i = 0; i < x; i += 1) {\n      newKnots[i] = oldKnots[i]!;\n    }\n\n    let newSize = 0;\n    for (let i = 0; i <= x; i += 1) {\n      newSize += newPages[i]!.size;\n    }\n\n    return new BTreeNode(newPages, newKnots, void 0, newSize);\n  }\n\n  override splitRight(x: number): BTreeNode<K, V, U> {\n    const oldPages = this.pages;\n    const newArity = oldPages.length - (x + 1);\n    const newPages = new Array<BTreePage<K, V, U>>(newArity);\n    for (let i = 0; i < newArity; i += 1) {\n      newPages[i] = oldPages[i + (x + 1)]!;\n    }\n\n    const oldKnots = this.knots;\n    const newKnots = new Array<K>(newArity - 1);\n    for (let i = 0; i < newKnots.length; i += 1) {\n      newKnots[i] = oldKnots[i + (x + 1)]!;\n    }\n\n    let newSize = 0;\n    for (let i = 0; i < newArity; i += 1) {\n      newSize += newPages[i]!.size;\n    }\n\n    return new BTreeNode(newPages, newKnots, void 0, newSize);\n  }\n\n  override reduced(identity: U, accumulator: (result: U, element: V) => U,\n                   combiner: (result: U, result2: U) => U): BTreeNode<K, V, U> {\n    if (this.fold === void 0) {\n      const oldPages = this.pages;\n      const n = oldPages.length;\n      const newPages = new Array<BTreePage<K, V, U>>(n);\n      for (let i = 0; i < n; i += 1) {\n        newPages[i] = oldPages[i]!.reduced(identity, accumulator, combiner);\n      }\n      // assert n > 0;\n      let fold: U = newPages[0]!.fold!;\n      for (let i = 1; i < n; i += 1) {\n        fold = combiner(fold, newPages[i]!.fold!);\n      }\n      return new BTreeNode(newPages, this.knots, fold, this.size);\n    } else {\n      return this;\n    }\n  }\n\n  override forEach<T, S>(callback: (this: S, key: K, value: V) => T | void,\n                         thisArg: S): T | undefined {\n    const pages = this.pages;\n    for (let i = 0, n = pages.length; i < n; i += 1) {\n      const result = pages[i]!.forEach(callback, thisArg);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override forEachKey<T, S>(callback: (this: S, key: K) => T | void,\n                            thisArg: S): T | undefined {\n    const pages = this.pages;\n    for (let i = 0, n = pages.length; i < n; i += 1) {\n      const result = pages[i]!.forEachKey(callback, thisArg);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override forEachValue<T, S>(callback: (this: S, value: V) => T | void,\n                              thisArg: S): T | undefined {\n    const pages = this.pages;\n    for (let i = 0, n = pages.length; i < n; i += 1) {\n      const result = pages[i]!.forEachValue(callback, thisArg);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override entries(): Cursor<[K, V]> {\n    return new BTreeNodeCursor(this.pages);\n  }\n\n  override reverseEntries(): Cursor<[K, V]> {\n    return new BTreeNodeCursor(this.pages, this.size, this.pages.length);\n  }\n\n  /** @internal */\n  lookup(key: K, tree: BTreeContext<K, V>): number {\n    let lo = 0;\n    let hi = this.knots.length - 1;\n    while (lo <= hi) {\n      const mid = (lo + hi) >>> 1;\n      const order = tree.compare(key, this.knots[mid]!);\n      if (order > 0) {\n        lo = mid + 1;\n      } else if (order < 0) {\n        hi = mid - 1;\n      } else {\n        return mid;\n      }\n    }\n    return -(lo + 1);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {NodeCursor} from \"./NodeCursor\";\nimport type {BTreePage} from \"./BTreePage\";\n\n/** @internal */\nexport class BTreeNodeCursor<K, V, U> extends NodeCursor<[K, V], BTreePage<K, V, U>> {\n  constructor(pages: ReadonlyArray<BTreePage<K, V, U>>, index: number = 0,\n              childIndex: number = 0, childCursor: Cursor<[K, V]> | null = null) {\n    super(pages, index, childIndex, childCursor);\n  }\n\n  protected override pageSize(page: BTreePage<K, V, U>): number {\n    return page.size;\n  }\n\n  protected override pageCursor(page: BTreePage<K, V, U>): Cursor<[K, V]> {\n    return page.entries();\n  }\n\n  protected override reversePageCursor(page: BTreePage<K, V, U>): Cursor<[K, V]> {\n    return page.reverseEntries();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Random, Values} from \"@swim/util\";\nimport type {STreePage} from \"./STreePage\";\n\n/** @public */\nexport abstract class STreeContext<V, I> {\n  pageSplitSize: number = 32;\n\n  identify(value: V): I {\n    const id = new Uint8Array(6);\n    Random.fillBytes(id);\n    return id as unknown as I;\n  }\n\n  compare(x: I, y: I): number {\n    return Values.compare(x, y);\n  }\n\n  /** @internal */\n  pageShouldSplit(page: STreePage<V, I>): boolean {\n    return page.arity > this.pageSplitSize;\n  }\n\n  /** @internal */\n  pageShouldMerge(page: STreePage<V, I>): boolean {\n    return page.arity < this.pageSplitSize >>> 1;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {STreeContext} from \"./STreeContext\";\nimport {STreePage} from \"./\"; // forward import\n\n/** @public */\nexport class STree<V = unknown, I = unknown> extends STreeContext<V, I> {\n  /** @internal */\n  root: STreePage<V, I>;\n\n  constructor();\n  /** @internal */\n  constructor(root: STreePage<V, I>);\n  constructor(root?: STreePage<V, I>) {\n    super();\n    if (root === void 0) {\n      root = STreePage.empty();\n    }\n    this.root = root;\n  }\n\n  get length(): number {\n    return this.root.size;\n  }\n\n  isEmpty(): boolean {\n    return this.root.isEmpty();\n  }\n\n  get(index: number, id?: I): V | undefined {\n    if (id !== void 0) {\n      index = this.lookup(id, index);\n      if (index < 0) {\n        return void 0;\n      }\n    }\n    return this.root.get(index);\n  }\n\n  getEntry(index: number, id?: I): [I, V] | undefined {\n    if (id !== void 0) {\n      index = this.lookup(id, index);\n      if (index < 0) {\n        return void 0;\n      }\n    }\n    return this.root.getEntry(index);\n  }\n\n  set(index: number, newValue: V, id?: I): this {\n    if (id !== void 0) {\n      index = this.lookup(id, index);\n      if (index < 0) {\n        throw new RangeError(\"\" + id);\n      }\n    }\n    const oldRoot = this.root;\n    if (index < 0 || index >= oldRoot.size) {\n      throw new RangeError(\"\" + index);\n    }\n    this.root = oldRoot.updated(index, newValue, this);\n    return this;\n  }\n\n  insert(index: number, newValue: V, id?: I): this {\n    const oldRoot = this.root;\n    if (index < 0 || index > oldRoot.size) {\n      throw new RangeError(\"\" + index);\n    }\n    this.root = oldRoot.inserted(index, newValue, id, this).balanced(this);\n    return this;\n  }\n\n  remove(index: number, id?: I): this {\n    if (id !== void 0) {\n      index = this.lookup(id, index);\n      if (index < 0) {\n        throw new RangeError(\"\" + id);\n      }\n    }\n    const oldRoot = this.root;\n    if (index < 0 || index > oldRoot.size) {\n      throw new RangeError(\"\" + index);\n    }\n    this.root = oldRoot.removed(index, this);\n    return this;\n  }\n\n  push(...newValues: V[]): number {\n    let newRoot = this.root;\n    for (let i = 0; i < newValues.length; i += 1) {\n      newRoot = newRoot.inserted(newRoot.size, newValues[i]!, void 0, this).balanced(this);\n    }\n    this.root = newRoot;\n    return newRoot.size;\n  }\n\n  pop(): V | undefined {\n    const oldRoot = this.root;\n    const index = oldRoot.size - 1;\n    if (index >= 0) {\n      const oldValue = oldRoot.get(index);\n      this.root = oldRoot.removed(index, this);\n      return oldValue;\n    } else {\n      return void 0;\n    }\n  }\n\n  unshift(...newValues: V[]): number {\n    let newRoot = this.root;\n    for (let i = newValues.length - 1; i >= 0; i -= 1) {\n      newRoot = newRoot.inserted(0, newValues[i]!, void 0, this).balanced(this);\n    }\n    this.root = newRoot;\n    return newRoot.size;\n  }\n\n  shift(): V | undefined {\n    const oldRoot = this.root;\n    if (oldRoot.size > 0) {\n      const oldValue = oldRoot.get(0);\n      this.root = oldRoot.removed(0, this);\n      return oldValue;\n    } else {\n      return void 0;\n    }\n  }\n\n  move(fromIndex: number, toIndex: number, id?: I): this {\n    if (id !== void 0) {\n      fromIndex = this.lookup(id, fromIndex);\n      if (fromIndex < 0) {\n        throw new RangeError(\"\" + id);\n      }\n    }\n    const oldRoot = this.root;\n    if (fromIndex < 0 || fromIndex >= oldRoot.size) {\n      throw new RangeError(\"\" + fromIndex);\n    }\n    if (toIndex < 0 || toIndex >= oldRoot.size) {\n      throw new RangeError(\"\" + toIndex);\n    }\n    if (fromIndex !== toIndex) {\n      const entry = oldRoot.getEntry(fromIndex)!;\n      this.root = oldRoot.removed(fromIndex, this)\n                         .inserted(toIndex, entry[1], entry[0], this)\n                         .balanced(this);\n    }\n    return this;\n  }\n\n  splice(start: number, deleteCount?: number, ...newValues: V[]): V[] {\n    let newRoot = this.root;\n    if (start < 0) {\n      start = newRoot.size + start;\n    }\n    start = Math.min(Math.max(0, start), newRoot.size);\n    if (deleteCount === void 0) {\n      deleteCount = newRoot.size - start;\n    }\n    const deleted = [] as V[];\n    for (let i = start, n = start + deleteCount; i < n; i += 1) {\n      deleted.push(newRoot.get(start)!);\n      newRoot = newRoot.removed(start, this);\n    }\n    for (let i = 0; i < newValues.length; i += 1) {\n      newRoot = newRoot.inserted(start + i, newValues[i]!, void 0, this).balanced(this);\n    }\n    this.root = newRoot;\n    return deleted;\n  }\n\n  drop(lower: number): this {\n    const oldRoot = this.root;\n    if (lower > 0 && oldRoot.size > 0) {\n      if (lower < oldRoot.size) {\n        this.root = oldRoot.drop(lower, this);\n      } else {\n        this.root = STreePage.empty();\n      }\n    }\n    return this;\n  }\n\n  take(upper: number): this {\n    const oldRoot = this.root;\n    if (upper < oldRoot.size && oldRoot.size > 0) {\n      if (upper > 0) {\n        this.root = oldRoot.take(upper, this);\n      } else {\n        this.root = STreePage.empty();\n      }\n    }\n    return this;\n  }\n\n  clear(): void {\n    this.root = STreePage.empty();\n  }\n\n  forEach<T>(callback: (value: V, index: number, id: I) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, value: V, index: number, id: I) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, value: V, index: number, id: I) => T | void,\n                thisArg?: S): T | undefined {\n    return this.root.forEach(callback, thisArg, 0);\n  }\n\n  keys(): Cursor<I> {\n    return this.root.keys();\n  }\n\n  values(): Cursor<V> {\n    return this.root.values();\n  }\n\n  entries(): Cursor<[I, V]> {\n    return this.root.entries();\n  }\n\n  reverseKeys(): Cursor<I> {\n    return this.root.reverseKeys();\n  }\n\n  reverseValues(): Cursor<V> {\n    return this.root.reverseValues();\n  }\n\n  reverseEntries(): Cursor<[I, V]> {\n    return this.root.reverseEntries();\n  }\n\n  clone(): STree<V, I> {\n    return this.copy(this.root);\n  }\n\n  /** @internal */\n  protected copy(root: STreePage<V, I>): STree<V, I> {\n    const tree = new STree(root);\n    if (tree.identify !== this.identify) {\n      tree.identify = this.identify;\n    }\n    if (tree.compare !== this.compare) {\n      tree.compare = this.compare;\n    }\n    if (tree.pageSplitSize !== this.pageSplitSize) {\n      tree.pageSplitSize = this.pageSplitSize;\n    }\n    return tree;\n  }\n\n  lookup(id: I, start: number = 0): number {\n    const root = this.root;\n    start = Math.min(Math.max(0, start), root.size - 1);\n    let index = start;\n    do {\n      const entry = root.getEntry(index);\n      if (entry !== void 0 && this.compare(entry[0], id) === 0) {\n        return index;\n      }\n      index = (index + 1) % root.size;\n    } while (isFinite(index) && index !== start);\n    return -1;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Cursor} from \"@swim/util\";\nimport {KeysCursor} from \"./KeysCursor\";\nimport {ValuesCursor} from \"./ValuesCursor\";\nimport type {STreeContext} from \"./STreeContext\";\nimport {STreeLeaf} from \"./\"; // forward import\n\n/** @internal */\nexport abstract class STreePage<V = unknown, I = unknown> {\n  abstract readonly arity: number;\n\n  abstract readonly size: number;\n\n  abstract isEmpty(): boolean;\n\n  abstract get(index: number): V | undefined;\n\n  abstract getEntry(index: number): [I, V] | undefined;\n\n  abstract updated(index: number, newValue: V, tree: STreeContext<V, I>): STreePage<V, I>;\n\n  abstract inserted(index: number, newValue: V, id: I | undefined, tree: STreeContext<V, I>): STreePage<V, I>;\n\n  abstract removed(index: number, tree: STreeContext<V, I>): STreePage<V, I>;\n\n  abstract drop(lower: number, tree: STreeContext<V, I>): STreePage<V, I>;\n\n  abstract take(upper: number, tree: STreeContext<V, I>): STreePage<V, I>;\n\n  abstract balanced(tree: STreeContext<V, I>): STreePage<V, I>;\n\n  abstract split(index: number): STreePage<V, I>;\n\n  abstract splitLeft(index: number): STreePage<V, I>;\n\n  abstract splitRight(index: number): STreePage<V, I>;\n\n  abstract forEach<T, S>(callback: (this: S, value: V, index: number, id: I) => T | void,\n                         thisArg: S, offset: number): T | undefined;\n\n  keys(): Cursor<I> {\n    return new KeysCursor(this.entries());\n  }\n\n  values(): Cursor<V> {\n    return new ValuesCursor(this.entries());\n  }\n\n  abstract entries(): Cursor<[I, V]>;\n\n  reverseKeys(): Cursor<I> {\n    return new KeysCursor(this.reverseEntries());\n  }\n\n  reverseValues(): Cursor<V> {\n    return new ValuesCursor(this.reverseEntries());\n  }\n\n  abstract reverseEntries(): Cursor<[I, V]>;\n\n  @Lazy\n  static empty<V, I>(): STreeLeaf<V, I> {\n    return new STreeLeaf([]);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport type {STreeContext} from \"./STreeContext\";\nimport {STreePage} from \"./STreePage\";\nimport {STreeNode} from \"./\"; // forward import\n\n/** @internal */\nexport class STreeLeaf<V, I> extends STreePage<V, I> {\n  constructor(slots: ReadonlyArray<[I, V]>) {\n    super();\n    this.slots = slots;\n  }\n\n  /** @internal */\n  readonly slots: ReadonlyArray<[I, V]>;\n\n  override get arity(): number {\n    return this.slots.length;\n  }\n\n  override get size(): number {\n    return this.slots.length;\n  }\n\n  override isEmpty(): boolean {\n    return this.slots.length === 0;\n  }\n\n  override get(index: number): V | undefined {\n    const slot = this.slots[index];\n    if (slot !== void 0) {\n      return slot[1];\n    } else {\n      return void 0;\n    }\n  }\n\n  override getEntry(index: number): [I, V] | undefined {\n    return this.slots[index];\n  }\n\n  override updated(index: number, newValue: V, tree: STreeContext<V, I>): STreeLeaf<V, I> {\n    if (index < 0 || index >= this.slots.length) {\n      throw new RangeError(\"\" + index);\n    }\n    return this.updatedItem(index, newValue);\n  }\n\n  /** @internal */\n  updatedItem(index: number, newValue: V): STreeLeaf<V, I> {\n    const oldItems = this.slots;\n    const oldSlot = oldItems[index];\n    if (oldSlot !== void 0 && newValue !== oldSlot[1]) {\n      const newValues = oldItems.slice(0);\n      newValues[index] = [oldSlot[0], newValue];\n      return new STreeLeaf(newValues);\n    } else {\n      return this;\n    }\n  }\n\n  override inserted(index: number, newValue: V, id: I | undefined, tree: STreeContext<V, I>): STreeLeaf<V, I> {\n    if (index < 0 || index > this.slots.length) {\n      throw new RangeError(\"\" + index);\n    }\n    return this.insertedItem(index, newValue, id, tree);\n  }\n\n  /** @internal */\n  insertedItem(index: number, newValue: V, id: I | undefined, tree: STreeContext<V, I>): STreeLeaf<V, I> {\n    if (id === void 0) {\n      id = tree.identify(newValue);\n    }\n    const oldSlots = this.slots;\n    const newSlots = new Array<[I, V]>(oldSlots.length + 1);\n    for (let i = 0; i < index; i += 1) {\n      newSlots[i] = oldSlots[i]!;\n    }\n    newSlots[index] = [id, newValue];\n    for (let i = index; i < oldSlots.length; i += 1) {\n      newSlots[i + 1] = oldSlots[i]!;\n    }\n    return new STreeLeaf(newSlots);\n  }\n\n  override removed(index: number, tree: STreeContext<V, I>): STreeLeaf<V, I> {\n    if (index < 0 || index >= this.slots.length) {\n      throw new RangeError(\"\" + index);\n    }\n    if (this.slots.length > 1) {\n      return this.removedSlot(index);\n    } else {\n      return STreePage.empty();\n    }\n  }\n\n  /** @internal */\n  removedSlot(index: number): STreeLeaf<V, I> {\n    const oldSlots = this.slots;\n    const newSlots = new Array<[I, V]>(oldSlots.length - 1);\n    for (let i = 0; i < index; i += 1) {\n      newSlots[i] = oldSlots[i]!;\n    }\n    for (let i = index; i < newSlots.length; i += 1) {\n      newSlots[i] = oldSlots[i + 1]!;\n    }\n    return new STreeLeaf(newSlots);\n  }\n\n  override drop(lower: number, tree: STreeContext<V, I>): STreeLeaf<V, I> {\n    const oldSlots = this.slots;\n    if (lower > 0 && oldSlots.length > 0) {\n      if (lower < oldSlots.length) {\n        const size = oldSlots.length - lower;\n        const newSlots = new Array<[I, V]>(size);\n        for (let i = 0; i < size; i += 1) {\n          newSlots[i] = oldSlots[i + lower]!;\n        }\n        return new STreeLeaf(newSlots);\n      } else {\n        return STreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override take(upper: number, tree: STreeContext<V, I>): STreeLeaf<V, I> {\n    const oldSlots = this.slots;\n    if (upper < oldSlots.length && oldSlots.length > 0) {\n      if (upper > 0) {\n        const newSlots = new Array<[I, V]>(upper);\n        for (let i = 0; i < upper; i += 1) {\n          newSlots[i] = oldSlots[i]!;\n        }\n        return new STreeLeaf(newSlots);\n      } else {\n        return STreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override balanced(tree: STreeContext<V, I>): STreePage<V, I> {\n    const size = this.slots.length;\n    if (size > 1 && tree.pageShouldSplit(this)) {\n      return this.split(size >>> 1);\n    } else {\n      return this;\n    }\n  }\n\n  override split(index: number): STreeNode<V, I> {\n    const newPages = new Array<STreePage<V, I>>(2);\n    const newLeftPage = this.splitLeft(index);\n    const newRightPage = this.splitRight(index);\n    newPages[0] = newLeftPage;\n    newPages[1] = newRightPage;\n\n    const newKnots = new Array<number>(1);\n    newKnots[0] = index;\n\n    return new STreeNode(newPages, newKnots, this.slots.length);\n  }\n\n  override splitLeft(index: number): STreeLeaf<V, I> {\n    const oldSlots = this.slots;\n    const newSlots = new Array<[I, V]>(index);\n    for (let i = 0; i < index; i += 1) {\n      newSlots[i] = oldSlots[i]!;\n    }\n    return new STreeLeaf(newSlots);\n  }\n\n  override splitRight(index: number): STreeLeaf<V, I> {\n    const oldSlots = this.slots;\n    const newSize = oldSlots.length - index;\n    const newSlots = new Array<[I, V]>(newSize);\n    for (let i = 0; i < newSize; i += 1) {\n      newSlots[i] = oldSlots[i + index]!;\n    }\n    return new STreeLeaf(newSlots);\n  }\n\n  override forEach<T, S>(callback: (this: S, value: V, index: number, id: I) => T | void,\n                         thisArg: S, offset: number): T | undefined {\n    for (let i = 0; i < this.slots.length; i += 1) {\n      const slot = this.slots[i]!;\n      const result = callback.call(thisArg, slot[1], offset + i, slot[0]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override entries(): Cursor<[I, V]> {\n    return Cursor.array(this.slots);\n  }\n\n  override reverseEntries(): Cursor<[I, V]> {\n    return Cursor.array(this.slots, this.slots.length);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport type {STreeContext} from \"./STreeContext\";\nimport {STreePage} from \"./STreePage\";\nimport {STreeNodeCursor} from \"./\"; // forward import\n\n/** @internal */\nexport class STreeNode<V, I> extends STreePage<V, I> {\n  constructor(pages: ReadonlyArray<STreePage<V, I>>, knots: ReadonlyArray<number>, size: number) {\n    super();\n    this.pages = pages;\n    this.knots = knots;\n    this.size = size;\n  }\n\n  /** @internal */\n  readonly pages: ReadonlyArray<STreePage<V, I>>;\n\n  /** @internal */\n  readonly knots: ReadonlyArray<number>;\n\n  override get arity(): number {\n    return this.pages.length;\n  }\n\n  override readonly size: number;\n\n  override isEmpty(): boolean {\n    return this.size === 0;\n  }\n\n  override get(index: number): V | undefined {\n    let x = this.lookup(index);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const i = x === 0 ? index : index - this.knots[x - 1]!;\n    return this.pages[x]!.get(i);\n  }\n\n  override getEntry(index: number): [I, V] | undefined {\n    let x = this.lookup(index);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const i = x === 0 ? index : index - this.knots[x - 1]!;\n    return this.pages[x]!.getEntry(i);\n  }\n\n  override updated(index: number, newValue: V, tree: STreeContext<V, I>): STreeNode<V, I> {\n    let x = this.lookup(index);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const i = x === 0 ? index : index - this.knots[x - 1]!;\n    const oldPage = this.pages[x]!;\n    const newPage = oldPage.updated(i, newValue, tree);\n    if (oldPage !== newPage) {\n      if (oldPage.size !== newPage.size && tree.pageShouldSplit(newPage)) {\n        return this.updatedPageSplit(x, newPage, oldPage);\n      } else {\n        return this.updatedPage(x, newPage, oldPage);\n      }\n    } else {\n      return this;\n    }\n  }\n\n  /** @internal */\n  updatedPage(x: number, newPage: STreePage<V, I>, oldPage: STreePage<V, I>): STreeNode<V, I> {\n    const oldPages = this.pages;\n    const newPages = oldPages.slice(0);\n    newPages[x] = newPage;\n\n    const oldKnots = this.knots;\n    let newKnots: number[];\n    let newSize: number;\n    if (oldPages.length - 1 > 0) {\n      newKnots = oldKnots.slice(0);\n      if (x > 0) {\n        newSize = oldKnots[x - 1]!;\n      } else {\n        newSize = 0;\n      }\n      for (let i = x; i < newKnots.length; i += 1) {\n        newSize += newPages[i]!.size;\n        newKnots[i] = newSize;\n      }\n      newSize += newPages[newKnots.length]!.size;\n    } else {\n      newKnots = [];\n      newSize = 0;\n    }\n\n    return new STreeNode(newPages, newKnots, newSize);\n  }\n\n  /** @internal */\n  updatedPageSplit(x: number, newPage: STreePage<V, I>, oldPage: STreePage<V, I>): STreeNode<V, I> {\n    const oldPages = this.pages;\n    const newPages = new Array<STreePage<V, I>>(oldPages.length + 1);\n    for (let i = 0; i < x; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n\n    const newLeftPage = newPage.splitLeft(newPage.arity >>> 1);\n    const newRightPage = newPage.splitRight(newPage.arity >>> 1);\n    newPages[x] = newLeftPage;\n    newPages[x + 1] = newRightPage;\n    for (let i = x + 1; i < oldPages.length; i += 1) {\n      newPages[i + 1] = oldPages[i]!;\n    }\n\n    return STreeNode.create(newPages);\n  }\n\n  /** @internal */\n  updatedPageMerge(x: number, newPage: STreeNode<V, I>, oldPage: STreePage<V, I>): STreeNode<V, I> {\n    const oldPages = this.pages;\n    const midPages = newPage.pages;\n    const newPages = new Array<STreePage<V, I>>(oldPages.length + midPages.length - 1);\n    for (let i = 0; i < x; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n    for (let i = 0; i < midPages.length; i += 1) {\n      newPages[i + x] = midPages[i]!;\n    }\n    for (let i = x + 1; i < oldPages.length; i += 1) {\n      newPages[i + midPages.length - 1] = oldPages[i]!;\n    }\n\n    return STreeNode.create(newPages);\n  }\n\n  override inserted(index: number, newValue: V, id: I | undefined, tree: STreeContext<V, I>): STreeNode<V, I> {\n    let x = this.lookup(index);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const subIndex = x === 0 ? index : index - this.knots[x - 1]!;\n    const oldPage = this.pages[x]!;\n    const newPage = oldPage.inserted(subIndex, newValue, id, tree);\n    if (oldPage !== newPage) {\n      if (tree.pageShouldSplit(newPage)) {\n        return this.updatedPageSplit(x, newPage, oldPage);\n      } else {\n        return this.updatedPage(x, newPage, oldPage);\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override removed(index: number, tree: STreeContext<V, I>): STreePage<V, I> {\n    let x = this.lookup(index);\n    if (x >= 0) {\n      x += 1;\n    } else {\n      x = -(x + 1);\n    }\n    const subIndex = x === 0 ? index : index - this.knots[x - 1]!;\n    const oldPage = this.pages[x]!;\n    const newPage = oldPage.removed(subIndex, tree);\n    if (oldPage !== newPage) {\n      return this.replacedPage(x, newPage, oldPage, tree);\n    } else {\n      return this;\n    }\n  }\n\n  /** @internal */\n  replacedPage(x: number, newPage: STreePage<V, I>, oldPage: STreePage<V, I>,\n               tree: STreeContext<V, I>): STreePage<V, I> {\n    if (!newPage.isEmpty()) {\n      if (newPage instanceof STreeNode && tree.pageShouldMerge(newPage)) {\n        return this.updatedPageMerge(x, newPage, oldPage);\n      } else {\n        return this.updatedPage(x, newPage, oldPage);\n      }\n    } else if (this.pages.length > 2) {\n      return this.removedPage(x, newPage, oldPage);\n    } else if (this.pages.length > 1) {\n      if (x === 0) {\n        return this.pages[1]!;\n      } else {\n        return this.pages[0]!;\n      }\n    } else {\n      return STreePage.empty();\n    }\n  }\n\n  /** @internal */\n  removedPage(x: number, newPage: STreePage<V, I>, oldPage: STreePage<V, I>): STreeNode<V, I> {\n    const oldPages = this.pages;\n    const newPages = new Array<STreePage<V, I>>(oldPages.length - 1);\n    for (let i = 0; i < x; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n    for (let i = x + 1; i < oldPages.length; i += 1) {\n      newPages[i - 1] = oldPages[i]!;\n    }\n\n    const oldKnots = this.knots;\n    const newKnots = new Array<number>(oldKnots.length - 1);\n    let newSize: number;\n    if (x > 0) {\n      for (let i = 0; i < x; i += 1) {\n        newKnots[i] = oldKnots[i]!;\n      }\n      newSize = oldKnots[x - 1]!;\n    } else {\n      newSize = 0;\n    }\n    for (let i = x; i < newKnots.length; i += 1) {\n      newSize += newPages[i]!.size;\n      newKnots[i] = newSize;\n    }\n    newSize += newPages[newKnots.length]!.size;\n\n    return new STreeNode(newPages, newKnots, newSize);\n  }\n\n  override drop(lower: number, tree: STreeContext<V, I>): STreePage<V, I> {\n    if (lower > 0) {\n      if (lower < this.size) {\n        let x = this.lookup(lower);\n        if (x >= 0) {\n          x += 1;\n        } else {\n          x = -(x + 1);\n        }\n        lower = x === 0 ? lower : lower - this.knots[x - 1]!;\n        const oldPages = this.pages;\n        const n = oldPages.length - x;\n        if (n > 1) {\n          let newNode: STreeNode<V, I>;\n          if (x > 0) {\n            const newPages = new Array<STreePage<V, I>>(n);\n            for (let i = 0; i < n; i += 1) {\n              newPages[i] = oldPages[i + x]!;\n            }\n            newNode = STreeNode.create(newPages);\n          } else {\n            newNode = this;\n          }\n          if (lower > 0) {\n            const oldPage = oldPages[x]!;\n            const newPage = oldPage.drop(lower, tree);\n            return newNode.replacedPage(0, newPage, oldPage, tree);\n          } else {\n            return newNode;\n          }\n        } else {\n          return oldPages[x]!.drop(lower, tree);\n        }\n      } else {\n        return STreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override take(upper: number, tree: STreeContext<V, I>): STreePage<V, I> {\n    if (upper < this.size) {\n      if (upper > 0) {\n        let x = this.lookup(upper);\n        if (x >= 0) {\n          x += 1;\n        } else {\n          x = -(x + 1);\n        }\n        upper = x === 0 ? upper : upper - this.knots[x - 1]!;\n        const oldPages = this.pages;\n        const n = upper === 0 ? x : x + 1;\n        if (n > 1) {\n          let newNode: STreeNode<V, I>;\n          if (x < oldPages.length) {\n            const newPages = new Array<STreePage<V, I>>(n);\n            for (let i = 0; i < n; i += 1) {\n              newPages[i] = oldPages[i]!;\n            }\n            const newKnots = new Array<number>(n - 1);\n            for (let i = 0; i < newKnots.length; i += 1) {\n              newKnots[i] = this.knots[i]!;\n            }\n            const newSize = newKnots[n - 2]! + newPages[n - 1]!.size;\n            newNode = new STreeNode(newPages, newKnots, newSize);\n          } else {\n            newNode = this;\n          }\n          if (upper > 0) {\n            const oldPage = oldPages[x]!;\n            const newPage = oldPage.take(upper, tree);\n            return newNode.replacedPage(x, newPage, oldPage, tree);\n          } else {\n            return newNode;\n          }\n        } else if (upper > 0) {\n          return oldPages[0]!.take(upper, tree);\n        } else {\n          return oldPages[0]!;\n        }\n      } else {\n        return STreePage.empty();\n      }\n    } else {\n      return this;\n    }\n  }\n\n  override balanced(tree: STreeContext<V, I>): STreeNode<V, I> {\n    if (this.pages.length > 1 && tree.pageShouldSplit(this)) {\n      const x = this.knots.length >>> 1;\n      return this.split(x);\n    } else {\n      return this;\n    }\n  }\n\n  override split(x: number): STreeNode<V, I> {\n    const newPages = new Array<STreePage<V, I>>(2);\n    const newLeftPage = this.splitLeft(x);\n    const newRightPage = this.splitRight(x);\n    newPages[0] = newLeftPage;\n    newPages[1] = newRightPage;\n\n    const newKnots = new Array<number>(1);\n    newKnots[0] = newLeftPage.size;\n\n    return new STreeNode(newPages, newKnots, this.size);\n  }\n\n  override splitLeft(x: number): STreeNode<V, I> {\n    const oldPages = this.pages;\n    const newPages = new Array<STreePage<V, I>>(x + 1);\n    for (let i = 0; i < x + 1; i += 1) {\n      newPages[i] = oldPages[i]!;\n    }\n\n    const oldKnots = this.knots;\n    const newKnots = new Array<number>(x);\n    for (let i = 0; i < x; i += 1) {\n      newKnots[i] = oldKnots[i]!;\n    }\n\n    let newSize = 0;\n    for (let i = 0; i <= x; i += 1) {\n      newSize += newPages[i]!.size;\n    }\n\n    return new STreeNode(newPages, newKnots, newSize);\n  }\n\n  override splitRight(x: number): STreeNode<V, I> {\n    const oldPages = this.pages;\n    const y = oldPages.length - (x + 1);\n    const newPages = new Array<STreePage<V, I>>(y);\n    for (let i = 0; i < y; i += 1) {\n      newPages[i] = oldPages[i + (x + 1)]!;\n    }\n\n    const newKnots = new Array<number>(y - 1);\n    let newSize;\n    if (y > 0) {\n      newSize = newPages[0]!.size;\n      for (let i = 1; i < y; i += 1) {\n        newKnots[i - 1] = newSize;\n        newSize += newPages[i]!.size;\n      }\n    } else {\n      newSize = 0;\n    }\n\n    return new STreeNode(newPages, newKnots, newSize);\n  }\n\n  override forEach<T, S>(callback: (this: S, value: V, index: number, id: I) => T | void,\n                         thisArg: S, offset: number): T | undefined {\n    for (let i = 0; i < this.pages.length; i += 1) {\n      const page = this.pages[i]!;\n      const result = page.forEach(callback, thisArg, offset);\n      if (result !== void 0) {\n        return result;\n      }\n      offset += page.size;\n    }\n    return void 0;\n  }\n\n  override entries(): Cursor<[I, V]> {\n    return new STreeNodeCursor(this.pages);\n  }\n\n  override reverseEntries(): Cursor<[I, V]> {\n    return new STreeNodeCursor(this.pages, this.size, this.pages.length);\n  }\n\n  /** @internal */\n  lookup(index: number): number {\n    let lo = 0;\n    let hi = this.knots.length - 1;\n    while (lo <= hi) {\n      const mid = (lo + hi) >>> 1;\n      if (index > this.knots[mid]!) {\n        lo = mid + 1;\n      } else if (index < this.knots[mid]!) {\n        hi = mid - 1;\n      } else {\n        return mid;\n      }\n    }\n    return -(lo + 1);\n  }\n\n  static create<V, I>(pages: ReadonlyArray<STreePage<V, I>>): STreeNode<V, I> {\n    const knots = new Array<number>(pages.length - 1);\n    let size = 0;\n    for (let i = 0, n  = knots.length; i < n; i += 1) {\n      size += pages[i]!.size;\n      knots[i] = size;\n    }\n    size += pages[knots.length]!.size;\n    return new STreeNode(pages, knots, size);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {NodeCursor} from \"./NodeCursor\";\nimport type {STreePage} from \"./STreePage\";\n\n/** @internal */\nexport class STreeNodeCursor<V, I> extends NodeCursor<[I, V], STreePage<V, I>> {\n  constructor(pages: ReadonlyArray<STreePage<V, I>>, index: number = 0,\n              childIndex: number = 0, childCursor: Cursor<[I, V]> | null = null) {\n    super(pages, index, childIndex, childCursor);\n  }\n\n  protected override pageSize(page: STreePage<V, I>): number {\n    return page.size;\n  }\n\n  protected override pageCursor(page: STreePage<V, I>): Cursor<[I, V]> {\n    return page.entries();\n  }\n\n  protected override reversePageCursor(page: STreePage<V, I>): Cursor<[I, V]> {\n    return page.reverseEntries();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport interface ConstraintId {\n  /** @internal */\n  readonly id: number;\n}\n\n/** @public */\nexport const ConstraintId = (function () {\n  const ConstraintId = {} as {\n    /** @internal */\n    next(): number;\n  };\n\n  let nextId = 1;\n  ConstraintId.next = function (): number {\n    const id = ~~nextId;\n    nextId += 1;\n    return id;\n  };\n\n  return ConstraintId;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {ConstraintId} from \"./ConstraintId\";\n\n/** @public */\nexport class ConstraintMap<K extends ConstraintId, V> {\n  constructor(index?: {[id: number]: number | undefined}, array?: Array<[K, V]>) {\n    this.index = index !== void 0 ? index : {};\n    this.array = array !== void 0 ? array : [];\n  }\n\n  /** @internal */\n  readonly index: {[id: number]: number | undefined};\n\n  /** @internal */\n  readonly array: Array<[K, V]>;\n\n  get size(): number {\n    return this.array.length;\n  }\n\n  isEmpty(): boolean {\n    return this.array.length === 0;\n  }\n\n  has(key: K): boolean {\n    return this.index[key.id] !== void 0;\n  }\n\n  get(key: K): V | undefined {\n    const k = this.index[key.id];\n    return k !== void 0 ? this.array[k]![1] : void 0;\n  }\n\n  getField(key: K): [K, V] | undefined {\n    const k = this.index[key.id];\n    return k !== void 0 ? this.array[k] : void 0;\n  }\n\n  getEntry(k: number): [K, V] | undefined {\n    return this.array[k];\n  }\n\n  set(key: K, newValue: V): V | undefined {\n    const k = this.index[key.id];\n    if (k !== void 0) {\n      const entry = this.array[k]!;\n      const oldValue = entry[1];\n      entry[1] = newValue;\n      return oldValue;\n    } else {\n      this.index[key.id] = this.array.length;\n      this.array.push([key, newValue]);\n      return void 0;\n    }\n  }\n\n  delete(key: K): boolean {\n    const k = this.index[key.id];\n    if (k !== void 0) {\n      delete this.index[key.id];\n      const item = this.array[k];\n      const last = this.array.pop()!;\n      if (item !== last) {\n        this.array[k] = last;\n        this.index[last[0].id] = k;\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  remove(key: K): V | undefined {\n    const k = this.index[key.id];\n    if (k !== void 0) {\n      delete this.index[key.id];\n      const item = this.array[k]!;\n      const last = this.array.pop()!;\n      if (item !== last) {\n        this.array[k] = last;\n        this.index[last[0].id] = k;\n      }\n      return item[1];\n    } else {\n      return void 0;\n    }\n  }\n\n  clear(): void {\n    (this as Mutable<this>).index = {};\n    this.array.length = 0;\n  }\n\n  forEach<T>(callback: (key: K, value: V) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, key: K, value: V) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, key: K, value: V) => T | void,\n                thisArg?: S): T | undefined {\n    const array = this.array;\n    for (let i = 0, n = array.length; i < n; i += 1) {\n      const item = array[i]!;\n      const result = callback.call(thisArg, item[0], item[1]);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  clone(): ConstraintMap<K, V> {\n    const oldArray = this.array;\n    const n = oldArray.length;\n    const newIndex = {} as {[id: number]: number | undefined};\n    const newArray = new Array<[K, V]>(n);\n    for (let i = 0; i < n; i += 1) {\n      const [key, value] = oldArray[i]!;\n      newArray[i] = [key, value];\n      newIndex[key.id] = i;\n    }\n    return new ConstraintMap(newIndex, newArray);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {ConstraintId} from \"./ConstraintId\";\nimport type {Constraint} from \"./Constraint\";\nimport type {ConstraintSolver} from \"./ConstraintSolver\";\n\n/** @public */\nexport interface ConstraintSymbol extends ConstraintId {\n  /** @internal */\n  isExternal(): boolean;\n\n  /** @internal */\n  isDummy(): boolean;\n\n  /** @internal */\n  isInvalid(): boolean;\n\n  /** @internal */\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal */\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal */\n  updateConstraintSolution(value: number): void;\n}\n\n/** @public */\nexport const ConstraintSymbol = {} as {\n  /** @internal */\n  readonly invalid: ConstraintSymbol; // defined by ConstraintInvalid\n};\n\n/** @internal */\nexport class ConstraintSlack implements ConstraintSymbol {\n  constructor() {\n    this.id = ConstraintId.next();\n  }\n\n  readonly id: number;\n\n  isExternal(): boolean {\n    return false;\n  }\n\n  isDummy(): boolean {\n    return false;\n  }\n\n  isInvalid(): boolean {\n    return false;\n  }\n\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  updateConstraintSolution(value: number): void {\n    // nop\n  }\n}\n\n/** @internal */\nexport class ConstraintDummy implements ConstraintSymbol {\n  constructor() {\n    this.id = ConstraintId.next();\n  }\n\n  readonly id: number;\n\n  isExternal(): boolean {\n    return false;\n  }\n\n  isDummy(): boolean {\n    return true;\n  }\n\n  isInvalid(): boolean {\n    return false;\n  }\n\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  updateConstraintSolution(value: number): void {\n    // nop\n  }\n}\n\n/** @internal */\nexport class ConstraintError implements ConstraintSymbol {\n  constructor() {\n    this.id = ConstraintId.next();\n  }\n\n  readonly id: number;\n\n  isExternal(): boolean {\n    return false;\n  }\n\n  isDummy(): boolean {\n    return false;\n  }\n\n  isInvalid(): boolean {\n    return false;\n  }\n\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  updateConstraintSolution(value: number): void {\n    // nop\n  }\n}\n\n/** @internal */\nexport class ConstraintInvalid implements ConstraintSymbol {\n  get id(): number {\n    return -1;\n  }\n\n  isExternal(): boolean {\n    return false;\n  }\n\n  isDummy(): boolean {\n    return false;\n  }\n\n  isInvalid(): boolean {\n    return true;\n  }\n\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void {\n    // nop\n  }\n\n  updateConstraintSolution(value: number): void {\n    // nop\n  }\n}\n(ConstraintSymbol as Mutable<typeof ConstraintSymbol>).invalid = new ConstraintInvalid();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\nimport {ConstraintSum} from \"./\"; // forward import\nimport {ConstraintTerm} from \"./\"; // forward import\nimport {ConstraintProduct} from \"./\"; // forward import\nimport {ConstraintConstant} from \"./\"; // forward import\n\n/** @public */\nexport type AnyConstraintExpression = ConstraintExpression | number;\n\n/** @public */\nexport interface ConstraintExpression {\n  readonly terms: ConstraintMap<ConstraintVariable, number>;\n\n  readonly constant: number;\n\n  isConstant(): boolean;\n\n  plus(that: AnyConstraintExpression): ConstraintExpression;\n\n  negative(): ConstraintExpression;\n\n  minus(that: AnyConstraintExpression): ConstraintExpression;\n\n  times(scalar: number): ConstraintExpression;\n\n  divide(scalar: number): ConstraintExpression;\n}\n\n/** @public */\nexport const ConstraintExpression = (function () {\n  const ConstraintExpression = {} as {\n    fromAny(value: AnyConstraintExpression): ConstraintExpression;\n\n    sum(...expressions: AnyConstraintExpression[]): ConstraintSum;\n\n    product(coefficient: number, variable: ConstraintVariable): ConstraintProduct;\n\n    constant(value: number): ConstraintConstant;\n\n    readonly zero: ConstraintConstant; // defined by ConstraintConstant\n  };\n\n  ConstraintExpression.fromAny = function (value: AnyConstraintExpression): ConstraintExpression {\n    if (typeof value === \"number\") {\n      return ConstraintExpression.constant(value);\n    } else {\n      return value;\n    }\n  };\n\n  ConstraintExpression.sum = function (...expressions: AnyConstraintExpression[]): ConstraintSum {\n    const terms = new ConstraintMap<ConstraintVariable, number>();\n    let constant = 0;\n    for (let i = 0, n = expressions.length; i < n; i += 1) {\n      const expression = expressions[i]!;\n      if (typeof expression === \"number\") {\n        constant += expression;\n      } else if (ConstraintTerm.is(expression)) {\n        const variable = expression.variable;\n        if (variable !== null) {\n          const field = terms.getField(variable);\n          if (field !== void 0) {\n            field[1] += expression.coefficient;\n          } else {\n            terms.set(variable, expression.coefficient);\n          }\n        } else {\n          constant += expression.constant;\n        }\n      } else {\n        const subterms = expression.terms;\n        for (let j = 0, k = subterms.size; j < k; j += 1) {\n          const [variable, coefficient] = subterms.getEntry(j)!;\n          const field = terms.getField(variable);\n          if (field !== void 0) {\n            field[1] += coefficient;\n          } else {\n            terms.set(variable, coefficient);\n          }\n        }\n        constant += expression.constant;\n      }\n    }\n    return new ConstraintSum(terms, constant);\n  };\n\n  ConstraintExpression.product = function (coefficient: number, variable: ConstraintVariable): ConstraintProduct {\n    return new ConstraintProduct(coefficient, variable);\n  };\n\n  ConstraintExpression.constant = function (value: number): ConstraintConstant {\n    if (value === 0) {\n      return ConstraintExpression.zero;\n    } else {\n      return new ConstraintConstant(value);\n    }\n  };\n\n  return ConstraintExpression;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\n\n/** @public */\nexport class ConstraintSum implements ConstraintExpression, Debug {\n  constructor(terms: ConstraintMap<ConstraintVariable, number>, constant: number) {\n    this.terms = terms;\n    this.constant = constant;\n  }\n\n  isConstant(): boolean {\n    return this.terms.isEmpty();\n  }\n\n  readonly terms: ConstraintMap<ConstraintVariable, number>;\n\n  readonly constant: number;\n\n  plus(that: AnyConstraintExpression): ConstraintExpression {\n    return ConstraintExpression.sum(this, that);\n  }\n\n  negative(): ConstraintExpression {\n    const oldTerms = this.terms;\n    const newTerms = new ConstraintMap<ConstraintVariable, number>();\n    for (let i = 0, n = oldTerms.size; i < n; i += 1) {\n      const [variable, coefficient] = oldTerms.getEntry(i)!;\n      newTerms.set(variable, -coefficient);\n    }\n    return new ConstraintSum(newTerms, -this.constant);\n  }\n\n  minus(that: AnyConstraintExpression): ConstraintExpression {\n    if (typeof that === \"number\") {\n      that = ConstraintExpression.constant(that);\n    } else {\n      that = that.negative();\n    }\n    return ConstraintExpression.sum(this, that);\n  }\n\n  times(scalar: number): ConstraintExpression {\n    const oldTerms = this.terms;\n    const newTerms = new ConstraintMap<ConstraintVariable, number>();\n    for (let i = 0, n = oldTerms.size; i < n; i += 1) {\n      const [variable, coefficient] = oldTerms.getEntry(i)!;\n      newTerms.set(variable, coefficient * scalar);\n    }\n    return new ConstraintSum(newTerms, this.constant * scalar);\n  }\n\n  divide(scalar: number): ConstraintExpression {\n    const oldTerms = this.terms;\n    const newTerms = new ConstraintMap<ConstraintVariable, number>();\n    for (let i = 0, n = oldTerms.size; i < n; i += 1) {\n      const [variable, coefficient] = oldTerms.getEntry(i)!;\n      newTerms.set(variable, coefficient / scalar);\n    }\n    return new ConstraintSum(newTerms, this.constant / scalar);\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"ConstraintExpression\").write(46/*'.'*/).write(\"sum\").write(40/*'('*/);\n    const n = this.terms.size;\n    for (let i = 0; i < n; i += 1) {\n      const [variable, coefficient] = this.terms.getEntry(i)!;\n      if (i > 0) {\n        output = output.write(\", \");\n      }\n      if (coefficient === 1) {\n        output = output.debug(variable);\n      } else {\n        output = output.debug(ConstraintExpression.product(coefficient, variable));\n      }\n    }\n    if (this.constant !== 0) {\n      if (n > 0) {\n        output = output.write(\", \");\n      }\n      output = output.debug(this.constant);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\n\n/** @public */\nexport interface ConstraintTerm extends ConstraintExpression {\n  readonly coefficient: number;\n\n  readonly variable: ConstraintVariable | null;\n\n  negative(): ConstraintTerm;\n}\n\n/** @public */\nexport const ConstraintTerm = (function () {\n  const ConstraintTerm = {} as {\n    is(value: unknown): value is ConstraintTerm;\n  };\n\n  ConstraintTerm.is = function (value: unknown): value is ConstraintTerm {\n    if (typeof value === \"object\" && value !== null || typeof value === \"function\") {\n      const term = value as ConstraintTerm;\n      return \"coefficient\" in term && \"variable\" in term;\n    }\n    return false;\n  };\n\n  return ConstraintTerm;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintTerm} from \"./ConstraintTerm\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\n\n/** @public */\nexport class ConstraintProduct implements ConstraintTerm, Debug {\n  constructor(coefficient: number, variable: ConstraintVariable) {\n    this.coefficient = coefficient;\n    this.variable = variable;\n  }\n\n  isConstant(): boolean {\n    return false;\n  }\n\n  readonly coefficient: number;\n\n  readonly variable: ConstraintVariable;\n\n  get terms(): ConstraintMap<ConstraintVariable, number> {\n    const terms = new ConstraintMap<ConstraintVariable, number>();\n    terms.set(this.variable, this.coefficient);\n    return terms;\n  }\n\n  get constant(): number {\n    return 0;\n  }\n\n  plus(that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (that instanceof ConstraintProduct && this.variable === that.variable) {\n      return ConstraintExpression.product(this.coefficient + that.coefficient, this.variable);\n    } else if (this.variable === that) {\n      return ConstraintExpression.product(this.coefficient + 1, this.variable);\n    } else {\n      return ConstraintExpression.sum(this, that);\n    }\n  }\n\n  negative(): ConstraintTerm {\n    return ConstraintExpression.product(-this.coefficient, this.variable);\n  }\n\n  minus(that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (that instanceof ConstraintProduct && this.variable === that.variable) {\n      return ConstraintExpression.product(this.coefficient - that.coefficient, this.variable);\n    } else if (this.variable === that) {\n      return ConstraintExpression.product(this.coefficient - 1, this.variable);\n    } else {\n      return ConstraintExpression.sum(this, that.negative());\n    }\n  }\n\n  times(scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(this.coefficient * scalar, this.variable);\n  }\n\n  divide(scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(this.coefficient / scalar, this.variable);\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"ConstraintExpression\").write(46/*'.'*/).write(\"product\").write(40/*'('*/)\n                   .debug(this.coefficient).write(\", \").debug(this.variable).write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintTerm} from \"./ConstraintTerm\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\n\n/** @public */\nexport class ConstraintConstant implements ConstraintTerm, Debug {\n  constructor(constant: number) {\n    this.constant = constant;\n  }\n\n  isConstant(): boolean {\n    return true;\n  }\n\n  get coefficient(): number {\n    return 0;\n  }\n\n  get variable(): ConstraintVariable | null {\n    return null;\n  }\n\n  get terms(): ConstraintMap<ConstraintVariable, number> {\n    return new ConstraintMap<ConstraintVariable, number>();\n  }\n\n  readonly constant: number;\n\n  plus(that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (that instanceof ConstraintConstant) {\n      return ConstraintExpression.constant(this.constant + that.constant);\n    } else {\n      return ConstraintExpression.sum(this, that);\n    }\n  }\n\n  negative(): ConstraintTerm {\n    return ConstraintExpression.constant(-this.constant);\n  }\n\n  minus(that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (that instanceof ConstraintConstant) {\n      return ConstraintExpression.constant(this.constant - that.constant);\n    } else {\n      return ConstraintExpression.sum(this, that.negative());\n    }\n  }\n\n  times(scalar: number): ConstraintExpression {\n    return ConstraintExpression.constant(this.constant * scalar);\n  }\n\n  divide(scalar: number): ConstraintExpression {\n    return ConstraintExpression.constant(this.constant / scalar);\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"ConstraintExpression\").write(46/*'.'*/);\n    if (this.constant === 0) {\n      output = output.write(\"zero\");\n    } else {\n      output = output.write(\"constant\").write(40/*'('*/).debug(this.constant).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n}\n(ConstraintExpression as Mutable<typeof ConstraintExpression>).zero = new ConstraintConstant(0);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, FromAny} from \"@swim/util\";\nimport {Affinity, FastenerOwner, FastenerFlags, PropertyInit, PropertyClass, Property} from \"@swim/fastener\";\nimport {ConstraintId} from \"./ConstraintId\";\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintTerm} from \"./ConstraintTerm\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\nimport {AnyConstraintStrength, ConstraintStrength} from \"./\"; // forward import\nimport type {Constraint} from \"./Constraint\";\nimport {ConstraintScope} from \"./\"; // forward import\nimport type {ConstraintSolver} from \"./ConstraintSolver\";\n\n/** @public */\nexport interface ConstraintPropertyInit<T = unknown, U = T> extends PropertyInit<T, U> {\n  extends?: {prototype: ConstraintProperty<any, any>} | string | boolean | null;\n  constrain?: boolean;\n  strength?: AnyConstraintStrength;\n\n  willStartConstraining?(): void;\n  didStartConstraining?(): void;\n  willStopConstraining?(): void;\n  didStopConstraining?(): void;\n\n  toNumber?(value: T): number;\n}\n\n/** @public */\nexport type ConstraintPropertyDescriptor<O = unknown, T = unknown, U = T, I = {}> = ThisType<ConstraintProperty<O, T, U> & I> & ConstraintPropertyInit<T, U> & Partial<I>;\n\n/** @public */\nexport interface ConstraintPropertyClass<P extends ConstraintProperty<any, any> = ConstraintProperty<any, any>> extends PropertyClass<P> {\n  /** @internal */\n  readonly ConstrainedFlag: FastenerFlags;\n  /** @internal */\n  readonly ConstrainingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ConstraintPropertyFactory<P extends ConstraintProperty<any, any> = ConstraintProperty<any, any>> extends ConstraintPropertyClass<P> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): ConstraintPropertyFactory<P> & I;\n\n  specialize(type: unknown): ConstraintPropertyFactory | null;\n\n  define<O, T, U = T>(className: string, descriptor: ConstraintPropertyDescriptor<O, T, U>): ConstraintPropertyFactory<ConstraintProperty<any, T, U>>;\n  define<O, T, U = T, I = {}>(className: string, descriptor: ConstraintPropertyDescriptor<O, T, U, I>): ConstraintPropertyFactory<ConstraintProperty<any, T, U> & I>;\n\n  <O, T extends number | undefined = number | undefined, U extends number | string | undefined = number | string | undefined>(descriptor: {type: typeof Number} & ConstraintPropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: ({type: FromAny<T, U>} | {fromAny(value: T | U): T}) & ConstraintPropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: ConstraintPropertyDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T, I = {}>(descriptor: ConstraintPropertyDescriptor<O, T, U, I>): PropertyDecorator;\n}\n\n/** @public */\nexport interface ConstraintProperty<O = unknown, T = unknown, U = T> extends Property<O, T, U>, ConstraintVariable {\n  /** @internal @override */\n  readonly id: number;\n\n  /** @internal @override */\n  isExternal(): boolean;\n\n  /** @internal @override */\n  isDummy(): boolean;\n\n  /** @internal @override */\n  isInvalid(): boolean;\n\n  /** @override */\n  isConstant(): boolean;\n\n  /** @internal @override */\n  evaluateConstraintVariable(): void;\n\n  /** @internal @override */\n  updateConstraintSolution(value: number): void;\n\n  /** @override */\n  readonly strength: ConstraintStrength;\n\n  setStrength(strength: AnyConstraintStrength): void;\n\n  /** @override */\n  get coefficient(): number;\n\n  /** @override */\n  get variable(): ConstraintVariable | null;\n\n  /** @override */\n  get terms(): ConstraintMap<ConstraintVariable, number>;\n\n  /** @override */\n  get constant(): number;\n\n  /** @override */\n  plus(that: AnyConstraintExpression): ConstraintExpression;\n\n  /** @override */\n  negative(): ConstraintTerm;\n\n  /** @override */\n  minus(that: AnyConstraintExpression): ConstraintExpression;\n\n  /** @override */\n  times(scalar: number): ConstraintExpression;\n\n  /** @override */\n  divide(scalar: number): ConstraintExpression;\n\n  get constrained(): boolean;\n\n  constrain(constrained?: boolean): this;\n\n  /** @internal */\n  readonly conditionCount: number;\n\n  /** @internal @override */\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal @override */\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal */\n  get constraining(): boolean;\n\n  /** @internal */\n  startConstraining(): void;\n\n  /** @protected */\n  willStartConstraining(): void;\n\n  /** @protected */\n  onStartConstraining(): void;\n\n  /** @protected */\n  didStartConstraining(): void;\n\n  /** @internal */\n  stopConstraining(): void;\n\n  /** @protected */\n  willStopConstraining(): void;\n\n  /** @protected */\n  onStopConstraining(): void;\n\n  /** @protected */\n  didStopConstraining(): void;\n\n  /** @internal */\n  updateConstraintVariable(): void;\n\n  /** @protected @override */\n  onSetState(newState: T, oldState: T): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n\n  /** @override */\n  fromAny(value: T | U): T;\n\n  /** @internal @protected */\n  toNumber(value: T): number;\n}\n\n/** @public */\nexport const ConstraintProperty = (function (_super: typeof Property) {\n  const ConstraintProperty: ConstraintPropertyFactory = _super.extend(\"ConstraintProperty\");\n\n  ConstraintProperty.prototype.isExternal = function (this: ConstraintProperty): boolean {\n    return true;\n  };\n\n  ConstraintProperty.prototype.isDummy = function (this: ConstraintProperty): boolean {\n    return false;\n  };\n\n  ConstraintProperty.prototype.isInvalid = function (this: ConstraintProperty): boolean {\n    return false;\n  };\n\n  ConstraintProperty.prototype.isConstant = function (this: ConstraintProperty): boolean {\n    return false;\n  };\n\n  ConstraintProperty.prototype.evaluateConstraintVariable = function <T>(this: ConstraintProperty<unknown, T>): void {\n    // hook\n  };\n\n  ConstraintProperty.prototype.updateConstraintSolution = function <T>(this: ConstraintProperty<unknown, T>, state: number): void {\n    if (this.constrained && this.toNumber(this.state) !== state) {\n      this.setState(state as unknown as T, Affinity.Reflexive);\n    }\n  };\n\n  ConstraintProperty.prototype.setStrength = function (this: ConstraintProperty, strength: AnyConstraintStrength): void {\n    (this as Mutable<typeof this>).strength = ConstraintStrength.fromAny(strength);\n  };\n\n  Object.defineProperty(ConstraintProperty.prototype, \"coefficient\", {\n    get(this: ConstraintProperty): number {\n      return 1;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConstraintProperty.prototype, \"variable\", {\n    get(this: ConstraintProperty): ConstraintVariable {\n      return this;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConstraintProperty.prototype, \"terms\", {\n    get(this: ConstraintProperty): ConstraintMap<ConstraintVariable, number> {\n      const terms = new ConstraintMap<ConstraintVariable, number>();\n      terms.set(this, 1);\n      return terms;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConstraintProperty.prototype, \"constant\", {\n    get(this: ConstraintProperty): number {\n      return 0;\n    },\n    configurable: true,\n  });\n\n  ConstraintProperty.prototype.plus = function (this: ConstraintProperty, that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (this === that) {\n      return ConstraintExpression.product(2, this);\n    } else {\n      return ConstraintExpression.sum(this, that);\n    }\n  };\n\n  ConstraintProperty.prototype.negative = function (this: ConstraintProperty): ConstraintTerm {\n    return ConstraintExpression.product(-1, this);\n  };\n\n  ConstraintProperty.prototype.minus = function (this: ConstraintProperty, that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (this === that) {\n      return ConstraintExpression.zero;\n    } else {\n      return ConstraintExpression.sum(this, that.negative());\n    }\n  };\n\n  ConstraintProperty.prototype.times = function (this: ConstraintProperty, scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(scalar, this);\n  };\n\n  ConstraintProperty.prototype.divide = function (this: ConstraintProperty, scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(1 / scalar, this);\n  };\n\n  Object.defineProperty(ConstraintProperty.prototype, \"constrained\", {\n    get(this: ConstraintProperty): boolean {\n      return (this.flags & ConstraintProperty.ConstrainedFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  ConstraintProperty.prototype.constrain = function (this: ConstraintProperty<unknown, unknown, unknown>, constrained?: boolean): typeof this {\n    if (constrained === void 0) {\n      constrained = true;\n    }\n    const flags = this.flags;\n    if (constrained && (flags & ConstraintProperty.ConstrainedFlag) === 0) {\n      this.setFlags(flags | ConstraintProperty.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.stopConstraining();\n      }\n    } else if (!constrained && (flags & ConstraintProperty.ConstrainedFlag) !== 0) {\n      this.setFlags(flags & ~ConstraintProperty.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.startConstraining();\n        this.updateConstraintVariable();\n      }\n    }\n    return this;\n  };\n\n  ConstraintProperty.prototype.addConstraintCondition = function (this: ConstraintProperty, constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount += 1;\n    if (!this.constrained && this.conditionCount === 1 && this.mounted) {\n      this.startConstraining();\n      this.updateConstraintVariable();\n    }\n  };\n\n  ConstraintProperty.prototype.removeConstraintCondition = function (this: ConstraintProperty, constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount -= 1;\n    if (!this.constrained && this.conditionCount === 0 && this.mounted) {\n      this.stopConstraining();\n    }\n  };\n\n  Object.defineProperty(ConstraintProperty.prototype, \"constraining\", {\n    get(this: ConstraintProperty): boolean {\n      return (this.flags & ConstraintProperty.ConstrainingFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  ConstraintProperty.prototype.startConstraining = function (this: ConstraintProperty): void {\n    if ((this.flags & ConstraintProperty.ConstrainingFlag) === 0) {\n      this.willStartConstraining();\n      this.setFlags(this.flags | ConstraintProperty.ConstrainingFlag);\n      this.onStartConstraining();\n      this.didStartConstraining();\n    }\n  };\n\n  ConstraintProperty.prototype.willStartConstraining = function (this: ConstraintProperty): void {\n    // hook\n  };\n\n  ConstraintProperty.prototype.onStartConstraining = function (this: ConstraintProperty): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope.is(constraintScope)) {\n      constraintScope.addConstraintVariable(this);\n    }\n  };\n\n  ConstraintProperty.prototype.didStartConstraining = function (this: ConstraintProperty): void {\n    // hook\n  };\n\n  ConstraintProperty.prototype.stopConstraining = function (this: ConstraintProperty): void {\n    if ((this.flags & ConstraintProperty.ConstrainingFlag) !== 0) {\n      this.willStopConstraining();\n      this.setFlags(this.flags & ~ConstraintProperty.ConstrainingFlag);\n      this.onStopConstraining();\n      this.didStopConstraining();\n    }\n  };\n\n  ConstraintProperty.prototype.willStopConstraining = function (this: ConstraintProperty): void {\n    // hook\n  };\n\n  ConstraintProperty.prototype.onStopConstraining = function (this: ConstraintProperty): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope.is(constraintScope)) {\n      constraintScope.removeConstraintVariable(this);\n    }\n  };\n\n  ConstraintProperty.prototype.didStopConstraining = function (this: ConstraintProperty): void {\n    // hook\n  };\n\n  ConstraintProperty.prototype.updateConstraintVariable = function (this: ConstraintProperty): void {\n    const constraintScope = this.owner;\n    const state = this.state;\n    if (state !== void 0 && ConstraintScope.is(constraintScope)) {\n      constraintScope.setConstraintVariable(this, this.toNumber(state));\n    }\n  };\n\n  ConstraintProperty.prototype.onSetState = function <T>(this: ConstraintProperty<unknown, T>, newState: T, oldState: T): void {\n    _super.prototype.onSetState.call(this, newState, oldState);\n    const constraintScope = this.owner;\n    if (this.constraining && ConstraintScope.is(constraintScope)) {\n      constraintScope.setConstraintVariable(this, newState !== void 0 && newState !== null ? this.toNumber(newState) : 0);\n    }\n  };\n\n  ConstraintProperty.prototype.onMount = function <T>(this: ConstraintProperty<unknown, T>): void {\n    _super.prototype.onMount.call(this);\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.startConstraining();\n    }\n  };\n\n  ConstraintProperty.prototype.onUnmount = function <T>(this: ConstraintProperty<unknown, T>): void {\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.stopConstraining();\n    }\n    _super.prototype.onUnmount.call(this);\n  };\n\n  ConstraintProperty.prototype.fromAny = function <T, U>(this: ConstraintProperty<unknown, T, U>, value: T | U): T {\n    if (typeof value === \"string\") {\n      const number = +value;\n      if (isFinite(number)) {\n        return number as unknown as T;\n      }\n    }\n    return value as T;\n  };\n\n  ConstraintProperty.prototype.toNumber = function <T>(this: ConstraintProperty<unknown, T>, value: T): number {\n    return value !== void 0 && value !== null ? +value : 0;\n  };\n\n  ConstraintProperty.construct = function <P extends ConstraintProperty<any, any>>(propertyClass: {prototype: P}, property: P | null, owner: FastenerOwner<P>): P {\n    property = _super.construct(propertyClass, property, owner) as P;\n    (property as Mutable<typeof property>).id = ConstraintId.next();\n    (property as Mutable<typeof property>).strength = ConstraintStrength.Strong;\n    (property as Mutable<typeof property>).conditionCount = 0;\n    return property;\n  };\n\n  ConstraintProperty.specialize = function (type: unknown): ConstraintPropertyFactory | null {\n    return null;\n  };\n\n  ConstraintProperty.define = function <O, T, U>(className: string, descriptor: ConstraintPropertyDescriptor<O, T, U>): ConstraintPropertyFactory<ConstraintProperty<any, T, U>> {\n    let superClass = descriptor.extends as ConstraintPropertyFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const strength = descriptor.strength !== void 0 ? ConstraintStrength.fromAny(descriptor.strength) : void 0;\n    const constrain = descriptor.constrain;\n    const state = descriptor.state;\n    const initState = descriptor.initState;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.strength;\n    delete descriptor.constrain;\n    delete descriptor.state;\n    delete descriptor.initState;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this.specialize(descriptor.type);\n    }\n    if (superClass === null) {\n      superClass = this;\n      if (descriptor.fromAny === void 0 && FromAny.is<T, U>(descriptor.type)) {\n        descriptor.fromAny = descriptor.type.fromAny;\n      }\n    }\n\n    const propertyClass = superClass.extend(className, descriptor);\n\n    propertyClass.construct = function (propertyClass: {prototype: ConstraintProperty<any, any>}, property: ConstraintProperty<O, T, U> | null, owner: O): ConstraintProperty<O, T, U> {\n      property = superClass!.construct(propertyClass, property, owner);\n      if (affinity !== void 0) {\n        property.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        property.initInherits(inherits);\n      }\n      if (strength !== void 0) {\n        (property as Mutable<typeof property>).strength = strength;\n      }\n      if (initState !== void 0) {\n        (property as Mutable<typeof property>).state = property.fromAny(initState());\n      } else if (state !== void 0) {\n        (property as Mutable<typeof property>).state = property.fromAny(state);\n      }\n      if (constrain === true) {\n        property.constrain();\n      }\n      return property;\n    };\n\n    return propertyClass;\n  };\n\n  (ConstraintProperty as Mutable<typeof ConstraintProperty>).ConstrainedFlag = 1 << (_super.FlagShift + 0);\n  (ConstraintProperty as Mutable<typeof ConstraintProperty>).ConstrainingFlag = 1 << (_super.FlagShift + 1);\n\n  (ConstraintProperty as Mutable<typeof ConstraintProperty>).FlagShift = _super.FlagShift + 2;\n  (ConstraintProperty as Mutable<typeof ConstraintProperty>).FlagMask = (1 << ConstraintProperty.FlagShift) - 1;\n\n  return ConstraintProperty;\n})(Property);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, FromAny} from \"@swim/util\";\nimport {Affinity, FastenerOwner, FastenerFlags, AnimatorInit, AnimatorClass, Animator} from \"@swim/fastener\";\nimport {ConstraintId} from \"./ConstraintId\";\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintTerm} from \"./ConstraintTerm\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\nimport {AnyConstraintStrength, ConstraintStrength} from \"./\"; // forward import\nimport type {Constraint} from \"./Constraint\";\nimport {ConstraintScope} from \"./\"; // forward import\nimport type {ConstraintSolver} from \"./ConstraintSolver\";\n\n/** @public */\nexport interface ConstraintAnimatorInit<T = unknown, U = T> extends AnimatorInit<T, U> {\n  extends?: {prototype: ConstraintAnimator<any, any>} | string | boolean | null;\n  constrain?: boolean;\n  strength?: AnyConstraintStrength;\n\n  willStartConstraining?(): void;\n  didStartConstraining?(): void;\n  willStopConstraining?(): void;\n  didStopConstraining?(): void;\n\n  toNumber?(value: T): number;\n}\n\n/** @public */\nexport type ConstraintAnimatorDescriptor<O = unknown, T = unknown, U = T, I = {}> = ThisType<ConstraintAnimator<O, T, U> & I> & ConstraintAnimatorInit<T, U> & Partial<I>;\n\n/** @public */\nexport interface ConstraintAnimatorClass<A extends ConstraintAnimator<any, any> = ConstraintAnimator<any, any>> extends AnimatorClass<A> {\n  /** @internal */\n  readonly ConstrainedFlag: FastenerFlags;\n  /** @internal */\n  readonly ConstrainingFlag: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @public */\nexport interface ConstraintAnimatorFactory<A extends ConstraintAnimator<any, any> = ConstraintAnimator<any, any>> extends ConstraintAnimatorClass<A> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): ConstraintAnimatorFactory<A> & I;\n\n  specialize(type: unknown): ConstraintAnimatorFactory | null;\n\n  define<O, T, U = T>(className: string, descriptor: ConstraintAnimatorDescriptor<O, T, U>): ConstraintAnimatorFactory<ConstraintAnimator<any, T, U>>;\n  define<O, T, U = T, I = {}>(className: string, descriptor: ConstraintAnimatorDescriptor<O, T, U, I>): ConstraintAnimatorFactory<ConstraintAnimator<any, T, U> & I>;\n\n  <O, T extends number | undefined = number | undefined, U extends number | string | undefined = number | string | undefined>(descriptor: {type: typeof Number} & ConstraintAnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: ({type: FromAny<T, U>} | {fromAny(value: T | U): T}) & ConstraintAnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T>(descriptor: ConstraintAnimatorDescriptor<O, T, U>): PropertyDecorator;\n  <O, T, U = T, I = {}>(descriptor: ConstraintAnimatorDescriptor<O, T, U, I>): PropertyDecorator;\n}\n\n/** @public */\nexport interface ConstraintAnimator<O = unknown, T = unknown, U = T> extends Animator<O, T, U>, ConstraintVariable {\n  /** @internal @override */\n  readonly id: number;\n\n  /** @internal @override */\n  isExternal(): boolean;\n\n  /** @internal @override */\n  isDummy(): boolean;\n\n  /** @internal @override */\n  isInvalid(): boolean;\n\n  /** @override */\n  isConstant(): boolean;\n\n  /** @internal @override */\n  evaluateConstraintVariable(): void;\n\n  /** @internal @override */\n  updateConstraintSolution(value: number): void;\n\n  /** @override */\n  readonly strength: ConstraintStrength;\n\n  setStrength(strength: AnyConstraintStrength): void;\n\n  /** @override */\n  get coefficient(): number;\n\n  /** @override */\n  get variable(): ConstraintVariable | null;\n\n  /** @override */\n  get terms(): ConstraintMap<ConstraintVariable, number>;\n\n  /** @override */\n  get constant(): number;\n\n  /** @override */\n  plus(that: AnyConstraintExpression): ConstraintExpression;\n\n  /** @override */\n  negative(): ConstraintTerm;\n\n  /** @override */\n  minus(that: AnyConstraintExpression): ConstraintExpression;\n\n  /** @override */\n  times(scalar: number): ConstraintExpression;\n\n  /** @override */\n  divide(scalar: number): ConstraintExpression;\n\n  get constrained(): boolean;\n\n  constrain(constrained?: boolean): this;\n\n  /** @internal */\n  readonly conditionCount: number;\n\n  /** @internal @override */\n  addConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal @override */\n  removeConstraintCondition(constraint: Constraint, solver: ConstraintSolver): void;\n\n  /** @internal */\n  get constraining(): boolean;\n\n  /** @internal */\n  startConstraining(): void;\n\n  /** @protected */\n  willStartConstraining(): void;\n\n  /** @protected */\n  onStartConstraining(): void;\n\n  /** @protected */\n  didStartConstraining(): void;\n\n  /** @internal */\n  stopConstraining(): void;\n\n  /** @protected */\n  willStopConstraining(): void;\n\n  /** @protected */\n  onStopConstraining(): void;\n\n  /** @protected */\n  didStopConstraining(): void;\n\n  /** @internal */\n  updateConstraintVariable(): void;\n\n  /** @protected @override */\n  onSetValue(newValue: T, oldValue: T): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n\n  /** @override */\n  fromAny(value: T | U): T;\n\n  /** @internal @protected */\n  toNumber(value: T): number;\n}\n\n/** @public */\nexport const ConstraintAnimator = (function (_super: typeof Animator) {\n  const ConstraintAnimator: ConstraintAnimatorFactory = _super.extend(\"ConstraintAnimator\");\n\n  ConstraintAnimator.prototype.isExternal = function (this: ConstraintAnimator): boolean {\n    return true;\n  };\n\n  ConstraintAnimator.prototype.isDummy = function (this: ConstraintAnimator): boolean {\n    return false;\n  };\n\n  ConstraintAnimator.prototype.isInvalid = function (this: ConstraintAnimator): boolean {\n    return false;\n  };\n\n  ConstraintAnimator.prototype.isConstant = function (this: ConstraintAnimator): boolean {\n    return false;\n  };\n\n  ConstraintAnimator.prototype.evaluateConstraintVariable = function <T>(this: ConstraintAnimator<unknown, T>): void {\n    // hook\n  };\n\n  ConstraintAnimator.prototype.updateConstraintSolution = function <T>(this: ConstraintAnimator<unknown, T>, state: number): void {\n    if (this.constrained && this.toNumber(this.state) !== state) {\n      this.setState(state as unknown as T, Affinity.Reflexive);\n    }\n  };\n\n  ConstraintAnimator.prototype.setStrength = function (this: ConstraintAnimator, strength: AnyConstraintStrength): void {\n    (this as Mutable<typeof this>).strength = ConstraintStrength.fromAny(strength);\n  };\n\n  Object.defineProperty(ConstraintAnimator.prototype, \"coefficient\", {\n    get(this: ConstraintAnimator): number {\n      return 1;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConstraintAnimator.prototype, \"variable\", {\n    get(this: ConstraintAnimator): ConstraintVariable {\n      return this;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConstraintAnimator.prototype, \"terms\", {\n    get(this: ConstraintAnimator): ConstraintMap<ConstraintVariable, number> {\n      const terms = new ConstraintMap<ConstraintVariable, number>();\n      terms.set(this, 1);\n      return terms;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConstraintAnimator.prototype, \"constant\", {\n    get(this: ConstraintAnimator): number {\n      return 0;\n    },\n    configurable: true,\n  });\n\n  ConstraintAnimator.prototype.plus = function (this: ConstraintAnimator, that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (this === that) {\n      return ConstraintExpression.product(2, this);\n    } else {\n      return ConstraintExpression.sum(this, that);\n    }\n  };\n\n  ConstraintAnimator.prototype.negative = function (this: ConstraintAnimator): ConstraintTerm {\n    return ConstraintExpression.product(-1, this);\n  };\n\n  ConstraintAnimator.prototype.minus = function (this: ConstraintAnimator, that: AnyConstraintExpression): ConstraintExpression {\n    that = ConstraintExpression.fromAny(that);\n    if (this === that) {\n      return ConstraintExpression.zero;\n    } else {\n      return ConstraintExpression.sum(this, that.negative());\n    }\n  };\n\n  ConstraintAnimator.prototype.times = function (this: ConstraintAnimator, scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(scalar, this);\n  };\n\n  ConstraintAnimator.prototype.divide = function (this: ConstraintAnimator, scalar: number): ConstraintExpression {\n    return ConstraintExpression.product(1 / scalar, this);\n  };\n\n  Object.defineProperty(ConstraintAnimator.prototype, \"constrained\", {\n    get(this: ConstraintAnimator): boolean {\n      return (this.flags & ConstraintAnimator.ConstrainedFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  ConstraintAnimator.prototype.constrain = function (this: ConstraintAnimator<unknown, unknown, unknown>, constrained?: boolean): typeof this {\n    if (constrained === void 0) {\n      constrained = true;\n    }\n    const flags = this.flags;\n    if (constrained && (flags & ConstraintAnimator.ConstrainedFlag) === 0) {\n      this.setFlags(flags | ConstraintAnimator.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.stopConstraining();\n      }\n    } else if (!constrained && (flags & ConstraintAnimator.ConstrainedFlag) !== 0) {\n      this.setFlags(flags & ~ConstraintAnimator.ConstrainedFlag);\n      if (this.conditionCount !== 0 && this.mounted) {\n        this.startConstraining();\n        this.updateConstraintVariable();\n      }\n    }\n    return this;\n  };\n\n  ConstraintAnimator.prototype.addConstraintCondition = function (this: ConstraintAnimator, constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount += 1;\n    if (!this.constrained && this.conditionCount === 1 && this.mounted) {\n      this.startConstraining();\n      this.updateConstraintVariable();\n    }\n  };\n\n  ConstraintAnimator.prototype.removeConstraintCondition = function (this: ConstraintAnimator, constraint: Constraint, solver: ConstraintSolver): void {\n    (this as Mutable<typeof this>).conditionCount -= 1;\n    if (!this.constrained && this.conditionCount === 0 && this.mounted) {\n      this.stopConstraining();\n    }\n  };\n\n  Object.defineProperty(ConstraintAnimator.prototype, \"constraining\", {\n    get(this: ConstraintAnimator): boolean {\n      return (this.flags & ConstraintAnimator.ConstrainingFlag) !== 0;\n    },\n    configurable: true,\n  });\n\n  ConstraintAnimator.prototype.startConstraining = function (this: ConstraintAnimator): void {\n    if ((this.flags & ConstraintAnimator.ConstrainingFlag) === 0) {\n      this.willStartConstraining();\n      this.setFlags(this.flags | ConstraintAnimator.ConstrainingFlag);\n      this.onStartConstraining();\n      this.didStartConstraining();\n    }\n  };\n\n  ConstraintAnimator.prototype.willStartConstraining = function (this: ConstraintAnimator): void {\n    // hook\n  };\n\n  ConstraintAnimator.prototype.onStartConstraining = function (this: ConstraintAnimator): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope.is(constraintScope)) {\n      constraintScope.addConstraintVariable(this);\n    }\n  };\n\n  ConstraintAnimator.prototype.didStartConstraining = function (this: ConstraintAnimator): void {\n    // hook\n  };\n\n  ConstraintAnimator.prototype.stopConstraining = function (this: ConstraintAnimator): void {\n    if ((this.flags & ConstraintAnimator.ConstrainingFlag) !== 0) {\n      this.willStopConstraining();\n      this.setFlags(this.flags & ~ConstraintAnimator.ConstrainingFlag);\n      this.onStopConstraining();\n      this.didStopConstraining();\n    }\n  };\n\n  ConstraintAnimator.prototype.willStopConstraining = function (this: ConstraintAnimator): void {\n    // hook\n  };\n\n  ConstraintAnimator.prototype.onStopConstraining = function (this: ConstraintAnimator): void {\n    const constraintScope = this.owner;\n    if (ConstraintScope.is(constraintScope)) {\n      constraintScope.removeConstraintVariable(this);\n    }\n  };\n\n  ConstraintAnimator.prototype.didStopConstraining = function (this: ConstraintAnimator): void {\n    // hook\n  };\n\n  ConstraintAnimator.prototype.updateConstraintVariable = function (this: ConstraintAnimator): void {\n    const constraintScope = this.owner;\n    const value = this.value;\n    if (value !== void 0 && ConstraintScope.is(constraintScope)) {\n      constraintScope.setConstraintVariable(this, this.toNumber(value));\n    }\n  };\n\n  ConstraintAnimator.prototype.onSetValue = function <T>(this: ConstraintAnimator<unknown, T>, newValue: T, oldValue: T): void {\n    _super.prototype.onSetValue.call(this, newValue, oldValue);\n    const constraintScope = this.owner;\n    if (this.constraining && ConstraintScope.is(constraintScope)) {\n      constraintScope.setConstraintVariable(this, newValue !== void 0 && newValue !== null ? this.toNumber(newValue) : 0);\n    }\n  };\n\n  ConstraintAnimator.prototype.onMount = function <T>(this: ConstraintAnimator<unknown, T>): void {\n    _super.prototype.onMount.call(this);\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.startConstraining();\n    }\n  };\n\n  ConstraintAnimator.prototype.onUnmount = function <T>(this: ConstraintAnimator<unknown, T>): void {\n    if (!this.constrained && this.conditionCount !== 0) {\n      this.stopConstraining();\n    }\n    _super.prototype.onUnmount.call(this);\n  };\n\n  ConstraintAnimator.prototype.fromAny = function <T, U>(this: ConstraintAnimator<unknown, T, U>, value: T | U): T {\n    if (typeof value === \"string\") {\n      const number = +value;\n      if (isFinite(number)) {\n        return number as unknown as T;\n      }\n    }\n    return value as T;\n  };\n\n  ConstraintAnimator.prototype.toNumber = function <T>(this: ConstraintAnimator<unknown, T>, value: T): number {\n    return value !== void 0 && value !== null ? +value : 0;\n  };\n\n  ConstraintAnimator.construct = function <A extends ConstraintAnimator<any, any>>(animatorClass: {prototype: A}, animator: A | null, owner: FastenerOwner<A>): A {\n    animator = _super.construct(animatorClass, animator, owner) as A;\n    (animator as Mutable<typeof animator>).id = ConstraintId.next();\n    (animator as Mutable<typeof animator>).strength = ConstraintStrength.Strong;\n    (animator as Mutable<typeof animator>).conditionCount = 0;\n    return animator;\n  };\n\n  ConstraintAnimator.specialize = function (type: unknown): ConstraintAnimatorFactory | null {\n    return null;\n  };\n\n  ConstraintAnimator.define = function <O, T, U>(className: string, descriptor: ConstraintAnimatorDescriptor<O, T, U>): ConstraintAnimatorFactory<ConstraintAnimator<any, T, U>> {\n    let superClass = descriptor.extends as ConstraintAnimatorFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const strength = descriptor.strength !== void 0 ? ConstraintStrength.fromAny(descriptor.strength) : void 0;\n    const constrain = descriptor.constrain;\n    const state = descriptor.state;\n    const initState = descriptor.initState;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.strength;\n    delete descriptor.constrain;\n    delete descriptor.state;\n    delete descriptor.initState;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this.specialize(descriptor.type);\n    }\n    if (superClass === null) {\n      superClass = this;\n      if (descriptor.fromAny === void 0 && FromAny.is<T, U>(descriptor.type)) {\n        descriptor.fromAny = descriptor.type.fromAny;\n      }\n    }\n\n    const animatorClass = superClass.extend(className, descriptor);\n\n    animatorClass.construct = function (animatorClass: {prototype: ConstraintAnimator<any, any>}, animator: ConstraintAnimator<O, T, U> | null, owner: O): ConstraintAnimator<O, T, U> {\n      animator = superClass!.construct(animatorClass, animator, owner);\n      if (affinity !== void 0) {\n        animator.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        animator.initInherits(inherits);\n      }\n      if (strength !== void 0) {\n        (animator as Mutable<typeof animator>).strength = strength;\n      }\n      if (initState !== void 0) {\n        (animator as Mutable<typeof animator>).state = animator.fromAny(initState());\n        (animator as Mutable<typeof animator>).value = animator.state;\n      } else if (state !== void 0) {\n        (animator as Mutable<typeof animator>).state = animator.fromAny(state);\n        (animator as Mutable<typeof animator>).value = animator.state;\n      }\n      if (constrain === true) {\n        animator.constrain();\n      }\n      return animator;\n    };\n\n    return animatorClass;\n  };\n\n  (ConstraintAnimator as Mutable<typeof ConstraintAnimator>).ConstrainedFlag = 1 << (_super.FlagShift + 0);\n  (ConstraintAnimator as Mutable<typeof ConstraintAnimator>).ConstrainingFlag = 1 << (_super.FlagShift + 1);\n\n  (ConstraintAnimator as Mutable<typeof ConstraintAnimator>).FlagShift = _super.FlagShift + 2;\n  (ConstraintAnimator as Mutable<typeof ConstraintAnimator>).FlagMask = (1 << ConstraintAnimator.FlagShift) - 1;\n\n  return ConstraintAnimator;\n})(Animator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\n\n/** @public */\nexport type AnyConstraintStrength = ConstraintStrength | ConstraintStrengthInit;\n\n/** @public */\nexport type ConstraintStrengthInit = \"required\" | \"strong\" | \"medium\" | \"weak\";\n\n/** @public */\nexport type ConstraintStrength = number;\n\n/** @public */\nexport const ConstraintStrength = (function () {\n  const ConstraintStrength = {} as {\n    readonly Required: ConstraintStrength;\n    readonly Strong: ConstraintStrength;\n    readonly Medium: ConstraintStrength;\n    readonly Weak: ConstraintStrength;\n    readonly Unbound: ConstraintStrength;\n\n    clip(strength: ConstraintStrength): ConstraintStrength;\n\n    fromAny(strength: AnyConstraintStrength): ConstraintStrength;\n  };\n\n  (ConstraintStrength as Mutable<typeof ConstraintStrength>).Required = 1001001000;\n  (ConstraintStrength as Mutable<typeof ConstraintStrength>).Strong = 1000000;\n  (ConstraintStrength as Mutable<typeof ConstraintStrength>).Medium = 1000;\n  (ConstraintStrength as Mutable<typeof ConstraintStrength>).Weak = 1;\n  (ConstraintStrength as Mutable<typeof ConstraintStrength>).Unbound = -1;\n\n  ConstraintStrength.clip = function (strength: ConstraintStrength): ConstraintStrength {\n    return Math.min(Math.max(0, strength), ConstraintStrength.Required);\n  };\n\n  ConstraintStrength.fromAny = function (strength: AnyConstraintStrength): ConstraintStrength {\n    if (typeof strength === \"number\") {\n      return ConstraintStrength.clip(strength);\n    } else if (strength === \"required\") {\n      return ConstraintStrength.Required;\n    } else if (strength === \"strong\") {\n      return ConstraintStrength.Strong;\n    } else if (strength === \"medium\") {\n      return ConstraintStrength.Medium;\n    } else if (strength === \"weak\") {\n      return ConstraintStrength.Weak;\n    }\n    throw new TypeError(\"\" + strength);\n  };\n\n  return ConstraintStrength;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport {ConstraintId} from \"./ConstraintId\";\nimport type {ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintRelation} from \"./ConstraintRelation\";\nimport {ConstraintStrength} from \"./ConstraintStrength\";\nimport type {ConstraintScope} from \"./ConstraintScope\";\n\n/** @public */\nexport class Constraint implements ConstraintId, Debug {\n  constructor(scope: ConstraintScope, expression: ConstraintExpression,\n              relation: ConstraintRelation, strength: ConstraintStrength) {\n    this.id = ConstraintId.next();\n    this.scope = scope;\n    this.expression = expression;\n    this.relation = relation;\n    this.strength = strength;\n  }\n\n  readonly id: number;\n\n  readonly scope: ConstraintScope;\n\n  readonly expression: ConstraintExpression;\n\n  readonly relation: ConstraintRelation;\n\n  readonly strength: ConstraintStrength;\n\n  isConstrained(): boolean {\n    return this.scope.hasConstraint(this);\n  }\n\n  constrain(constrained: boolean = true): this {\n    if (constrained) {\n      this.scope.addConstraint(this);\n    } else {\n      this.scope.removeConstraint(this);\n    }\n    return this;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.scope).write(46/*'.'*/).write(\"constraint\").write(40/*'('*/)\n                   .debug(this.expression).write(\", \").debug(this.relation).write(\", \")\n                   .debug(void 0).write(\", \");\n    if (this.strength === ConstraintStrength.Required) {\n      output = output.debug(\"required\");\n    } else if (this.strength === ConstraintStrength.Strong) {\n      output = output.debug(\"strong\");\n    } else if (this.strength === ConstraintStrength.Medium) {\n      output = output.debug(\"medium\");\n    } else if (this.strength === ConstraintStrength.Weak) {\n      output = output.debug(\"weak\");\n    } else {\n      output = output.debug(this.strength);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {AnyConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\nimport type {ConstraintProperty} from \"./ConstraintProperty\";\nimport type {ConstraintRelation} from \"./ConstraintRelation\";\nimport type {AnyConstraintStrength} from \"./ConstraintStrength\";\nimport type {Constraint} from \"./Constraint\";\n\n/** @public */\nexport interface ConstraintScope {\n  constraint(lhs: AnyConstraintExpression, relation: ConstraintRelation,\n             rhs?: AnyConstraintExpression, strength?: AnyConstraintStrength): Constraint;\n\n  hasConstraint(constraint: Constraint): boolean;\n\n  addConstraint(constraint: Constraint): void;\n\n  removeConstraint(constraint: Constraint): void;\n\n  constraintVariable(name: string, value?: number, strength?: AnyConstraintStrength): ConstraintProperty<unknown, number>;\n\n  hasConstraintVariable(variable: ConstraintVariable): boolean;\n\n  addConstraintVariable(variable: ConstraintVariable): void;\n\n  removeConstraintVariable(variable: ConstraintVariable): void;\n\n  setConstraintVariable(variable: ConstraintVariable, state: number): void;\n}\n\n/** @public */\nexport const ConstraintScope = (function () {\n  const ConstraintScope = {} as {\n    is(object: unknown): object is ConstraintScope;\n  };\n\n  ConstraintScope.is = function (object: unknown): object is ConstraintScope {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const constraintScope = object as ConstraintScope;\n      return \"constraint\" in constraintScope;\n    }\n    return false;\n  };\n\n  return ConstraintScope;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equivalent, Mutable} from \"@swim/util\";\nimport type {ConstraintMap} from \"./ConstraintMap\";\nimport {ConstraintSymbol, ConstraintDummy} from \"./ConstraintSymbol\";\nimport type {ConstraintSolver} from \"./ConstraintSolver\";\n\n/** @internal */\nexport class ConstraintRow {\n  constructor(solver: ConstraintSolver, symbol: ConstraintSymbol | null,\n              cells: ConstraintMap<ConstraintSymbol, number>, constant: number) {\n    this.solver = solver;\n    this.symbol = symbol;\n    this.cells = cells;\n    this.constant = constant;\n  }\n\n  readonly solver: ConstraintSolver;\n\n  readonly symbol: ConstraintSymbol | null;\n\n  /** @internal */\n  setSymbol(symbol: ConstraintSymbol | null): void {\n    (this as Mutable<this>).symbol = symbol;\n    this.invalidate();\n  }\n\n  readonly cells: ConstraintMap<ConstraintSymbol, number>;\n\n  readonly constant: number;\n\n  /** @internal */\n  setConstant(constant: number): void {\n    if (this.constant !== constant) {\n      (this as Mutable<this>).constant = constant;\n      this.invalidate();\n    }\n  }\n\n  isConstant(): boolean {\n    return this.cells.isEmpty();\n  }\n\n  isDummy(): boolean {\n    for (let i = 0, n = this.cells.size; i < n; i += 1) {\n      const symbol = this.cells.getEntry(i)![0];\n      if (!(symbol instanceof ConstraintDummy)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  clone(): ConstraintRow {\n    return new ConstraintRow(this.solver, this.symbol, this.cells.clone(), this.constant);\n  }\n\n  add(value: number): number {\n    const sum = this.constant + value;\n    this.setConstant(sum);\n    return sum;\n  }\n\n  insertSymbol(symbol: ConstraintSymbol, coefficient: number = 1): void {\n    coefficient += this.cells.get(symbol) ?? 0;\n    if (Math.abs(coefficient) < Equivalent.Epsilon) {\n      this.cells.remove(symbol);\n    } else {\n      this.cells.set(symbol, coefficient);\n    }\n  }\n\n  insertRow(that: ConstraintRow, coefficient: number): void {\n    this.setConstant(this.constant + that.constant * coefficient);\n    for (let i = 0, n = that.cells.size; i < n; i += 1) {\n      const [symbol, value] = that.cells.getEntry(i)!;\n      this.insertSymbol(symbol, value * coefficient);\n    }\n  }\n\n  removeSymbol(symbol: ConstraintSymbol): void {\n    this.cells.remove(symbol);\n  }\n\n  negate(): void {\n    this.setConstant(-this.constant);\n    for (let i = 0, n = this.cells.size; i < n; i += 1) {\n      const entry = this.cells.getEntry(i)!;\n      entry[1] = -entry[1];\n    }\n  }\n\n  solveFor(symbol: ConstraintSymbol): void {\n    const value = this.cells.remove(symbol);\n    if (value !== void 0) {\n      const coefficient = -1 / value;\n      this.setConstant(this.constant * coefficient);\n      for (let i = 0, n = this.cells.size; i < n; i += 1) {\n        const entry = this.cells.getEntry(i)!;\n        entry[1] *= coefficient;\n      }\n    }\n  }\n\n  solveForEx(lhs: ConstraintSymbol, rhs: ConstraintSymbol): void {\n    this.insertSymbol(lhs, -1.0);\n    this.solveFor(rhs);\n  }\n\n  coefficientFor(symbol: ConstraintSymbol): number {\n    const value = this.cells.get(symbol);\n    return value !== void 0 ? value : 0;\n  }\n\n  substitute(symbol: ConstraintSymbol, row: ConstraintRow): void {\n    const value = this.cells.remove(symbol);\n    if (value !== void 0) {\n      this.insertRow(row, value);\n    }\n  }\n\n  invalidate(): void {\n    const symbol = this.symbol;\n    if (symbol !== null) {\n      this.solver.invalidate(symbol, this);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Equivalent, Compare, Cursor, Interpolate, Interpolator} from \"@swim/util\";\nimport {Debug, Display, Format, Output} from \"@swim/codec\";\nimport {ItemInterpolator} from \"./\"; // forward import\nimport type {Field} from \"./Field\";\nimport {AnyValue, Value} from \"./\"; // forward import\nimport {Record} from \"./\"; // forward import\nimport type {AnyText} from \"./Text\";\nimport type {AnyNum} from \"./Num\";\nimport {Bool} from \"./\"; // forward import\nimport {Extant} from \"./\"; // forward import\nimport {Absent} from \"./\"; // forward import\nimport {Selector} from \"./\"; // forward import\nimport {MathModule} from \"./\"; // forward import\nimport type {AnyInterpreter} from \"./interpreter/Interpreter\";\nimport type {Form} from \"./form/Form\";\n\n/** @public */\nexport type AnyItem = Item\n                    | {readonly $key: AnyValue, readonly $value: AnyValue}\n                    | {readonly [key: string]: AnyValue}\n                    | ReadonlyArray<AnyItem>\n                    | Uint8Array\n                    | string\n                    | number\n                    | boolean\n                    | null\n                    | undefined;\n\n/** @public */\nexport abstract class Item implements Interpolate<Item>, HashCode, Equivalent, Compare, Debug, Display {\n  /** @internal */\n  constructor() {\n    // stub\n  }\n\n  /**\n   * Returns `true` if this `Item` is not [[Absent]].\n   */\n  abstract isDefined(): boolean;\n\n  /**\n   * Returns `true` if this `Item` is neither [[Extant]] nor [[Absent]].\n   */\n  abstract isDistinct(): boolean;\n\n  /**\n   * Returns `true` if this `Item` is not one of: an empty `Record`, `False`,\n   * `Extant`, or `Absent`.\n   */\n  abstract isDefinite(): boolean;\n\n  /**\n   * Returns `true` if this `Item` always [[Item.evaluate evaluates]] to the\n   * same `Item`.\n   */\n  abstract isConstant(): boolean;\n\n  /**\n   * Returns the key component of this `Item`, if this `Item` is a [[Field]];\n   * otherwise returns [[Absent]] if this `Item` is a `Value`.\n   */\n  abstract readonly key: Value;\n\n  /**\n   * Returns the value component of this `Item`, if this `Item` is a [[Field]];\n   * otherwise returns `this` if this `Item` is a `Value`.\n   */\n  abstract toValue(): Value;\n\n  /**\n   * Returns the `key` string of the first member of this `Item`, if this `Item`\n   * is a [[Record]], and its first member is an [[Attr]]; otherwise returns\n   * `undefined` if this `Item` is not a `Record`, or if this `Item` is a\n   * `Record` whose first member is not an `Attr`.\n   *\n   * Used to concisely get the name of the discriminating attribute of a\n   * structure. The `tag` can be used to discern the nominal type of a\n   * polymorphic structure, similar to an XML element tag.\n   */\n  abstract readonly tag: string | undefined;\n\n  /**\n   * Returns the [[Item.flattened flattened]] members of this `Item` after all\n   * attributes have been removed, if this `Item` is a [[Record]]; otherwise\n   * returns `this` if this `Item` is a non-`Record` `Value`, or returns\n   * the value component if this `Item` is a `Field`.\n   *\n   * Used to concisely get the scalar value of an attributed structure. An\n   * attributed structure is a `Record` with one or more attributes that modify\n   * one or more other members.\n   */\n  abstract readonly target: Value;\n\n  /**\n   * Returns the sole member of this `Item`, if this `Item` is a [[Record]]\n   * with exactly one member, and its member is a `Value`; returns [[Extant]]\n   * if this `Item` is an empty `Record`; returns [[Absent]] if this `Item` is\n   * a `Field`; otherwise returns `this` if this `Item` is a `Record` with more\n   * than one member, or if this `Item` is a non-`Record` `Value`.\n   *\n   * Used to convert a unary `Record` into its member `Value`. Facilitates\n   * writing code that treats a unary `Record` equivalently to a bare `Value`.\n   */\n  abstract flattened(): Value;\n\n  /**\n   * Returns `this` if this `Item` is a [[Record]]; returns a `Record`\n   * containing just this `Item`, if this `Item` is [[Item.isDistinct\n   * distinct]]; otherwise returns an empty `Record` if this `Item` is\n   * [[Extant]] or [[Absent]]. Facilitates writing code that treats a bare\n   * `Value` equivalently to a unary `Record`.\n   */\n  abstract unflattened(): Record;\n\n  /**\n   * Returns the value of the first member of this `Item`, if this `Item` is a\n   * [[Record]], and its first member is an [[Attr]] whose `key` string is\n   * equal to `tag`; otherwise returns [[Absent]] if this `Item` is not a\n   * `Record`, or if this `Item` is a `Record` whose first member is not an\n   * `Attr`, or if this `Item` is a `Record` whose first member is an `Attr`\n   * whose `key` does not equal the `tag`.\n   *\n   * Used to conditionally get the value of the head `Attr` of a structure, if\n   * and only if the key string of the head `Attr` is equal to the `tag`. Can\n   * be used to check if a structure might conform to a nominal type named\n   * `tag`, while simultaneously getting the value of the `tag` attribute.\n   */\n  abstract header(tag: string): Value;\n\n  /**\n   * Returns the [[Item.unflattened unflattened]] [[Item.header header]] of\n   * this `Item`, if this `Item` is a [[Record]], and its first member is an\n   * [[Attr]] whose `key` string is equal to `tag`; otherwise returns\n   * `undefined`.\n   *\n   * The `headers` of the `tag` attribute of a structure are like the\n   * attributes of an XML element tag; through unlike an XML element, `tag`\n   * attribute headers are not limited to string keys and values.\n   */\n  abstract headers(tag: string): Record | undefined;\n\n  /**\n   * Returns the first member of this `Item`, if this `Item` is a non-empty\n   * [[Record]]; otherwise returns [[Absent]].\n   */\n  abstract head(): Item;\n\n  /**\n   * Returns a view of all but the first member of this `Item`, if this `Item`\n   * is a non-empty [[Record]]; otherwise returns an empty `Record` if this\n   * `Item` is not a `Record`, or if this `Item` is itself an empty `Record`.\n   */\n  abstract tail(): Record;\n\n  /**\n   * Returns the [[Record.flattened flattened]] [[Item.tail tail]] of this\n   * `Item`. Used to recursively deconstruct a structure, terminating with its\n   * last `Value`, rather than a unary `Record` containing its last value, if\n   * the structure ends with a `Value` member.\n   */\n  abstract body(): Value;\n\n  /**\n   * Returns the number of members contained in this `Item`, if this `Item` is\n   * a [[Record]]; otherwise returns `0` if this `Item` is not a `Record`.\n   */\n  abstract readonly length: number;\n\n  /**\n   * Returns `true` if this `Item` is a [[Record]] that has a [[Field]] member\n   * with a key that is equal to the given `key`; otherwise returns `false` if\n   * this `Item` is not a `Record`, or if this `Item` is a `Record`, but has no\n   * `Field` member with a key equal to the given `key`.\n   */\n  abstract has(key: AnyValue): boolean;\n\n  /**\n   * Returns the value of the last [[Field]] member of this `Item` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Item` is not a\n   * [[Record]], or if this `Item` is a `Record`, but has no `Field` member\n   * with a key equal to the given `key`.\n   */\n  abstract get(key: AnyValue): Value;\n\n  /**\n   * Returns the value of the last [[Attr]] member of this `Item` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Item` is not a\n   * [[Record]], or if this `Item` is a `Record`, but has no `Attr` member\n   * with a key equal to the given `key`.\n   */\n  abstract getAttr(key: AnyText): Value;\n\n  /**\n   * Returns the value of the last [[Slot]] member of this `Item` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Item` is not a\n   * [[Record]], or if this `Item` is a `Record`, but has no `Slot` member\n   * with a key equal to the given `key`.\n   */\n  abstract getSlot(key: AnyValue): Value;\n\n  /**\n   * Returns the last [[Field]] member of this `Item` whose key is equal to the\n   * given `key`; returns `undefined` if this `Item` is not a [[Record]], or if\n   * this `Item` is a `Record`, but has no `Field` member with a `key` equal to\n   * the given `key`.\n   */\n  abstract getField(key: AnyValue): Field | undefined;\n\n  /**\n   * Returns the member of this `Item` at the given `index`, if this `Item` is\n   * a [[Record]], and the `index` is greater than or equal to zero, and less\n   * than the [[Record.length length]] of the `Record`; otherwise returns\n   * [[Absent]] if this `Item` is not a `Record`, or if this `Item` is a\n   * `Record`, but the `index` is out of bounds.\n   */\n  abstract getItem(index: AnyNum): Item;\n\n  updated(key: AnyValue, value: AnyValue): Record {\n    const record = Record.create(2);\n    record.push(this);\n    record.set(key, value);\n    return record;\n  }\n\n  updatedAttr(key: AnyText, value: AnyValue): Record {\n    const record = Record.create(2);\n    record.push(this);\n    record.setAttr(key, value);\n    return record;\n  }\n\n  updatedSlot(key: AnyValue, value: AnyValue): Record {\n    const record = Record.create(2);\n    record.push(this);\n    record.setSlot(key, value);\n    return record;\n  }\n\n  appended(...items: AnyItem[]): Record {\n    const record = Record.create(1 + arguments.length);\n    record.push(this);\n    record.push(...items);\n    return record;\n  }\n\n  prepended(...items: AnyItem[]): Record {\n    const record = Record.create(arguments.length + 1);\n    record.push(...items);\n    record.push(this);\n    return record;\n  }\n\n  abstract deleted(key: AnyValue): Item;\n\n  concat(...items: AnyItem[]): Record {\n    const record = Record.create();\n    record.push(this);\n    for (let i = 0, n = items.length; i < n; i += 1) {\n      Item.fromAny(items[i]).forEach(function (item: Item): void {\n        record.push(item);\n      });\n    }\n    return record;\n  }\n\n  abstract conditional(thenTerm: Item, elseTerm: Item): Item;\n\n  abstract or(that: Item): Item;\n\n  abstract and(that: Item): Item;\n\n  abstract bitwiseOr(that: AnyItem): Item;\n\n  abstract bitwiseXor(that: AnyItem): Item;\n\n  abstract bitwiseAnd(that: AnyItem): Item;\n\n  lt(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return this.compareTo(that) < 0 ? Bool.from(true) : Item.absent();\n  }\n\n  le(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return this.compareTo(that) <= 0 ? Bool.from(true) : Item.absent();\n  }\n\n  eq(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return this.equals(that) ? Bool.from(true) : Item.absent();\n  }\n\n  ne(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return !this.equals(that) ? Bool.from(true) : Item.absent();\n  }\n\n  ge(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return this.compareTo(that) >= 0 ? Bool.from(true) : Item.absent();\n  }\n\n  gt(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return this.compareTo(that) > 0 ? Bool.from(true) : Item.absent();\n  }\n\n  abstract plus(that: AnyItem): Item;\n\n  abstract minus(that: AnyItem): Item;\n\n  abstract times(that: AnyItem): Item;\n\n  abstract divide(that: AnyItem): Item;\n\n  abstract modulo(that: AnyItem): Item;\n\n  abstract not(): Item;\n\n  abstract bitwiseNot(): Item;\n\n  abstract negative(): Item;\n\n  abstract positive(): Item;\n\n  abstract inverse(): Item;\n\n  invoke(args: Value): Item {\n    return Item.absent();\n  }\n\n  abstract lambda(template: Value): Value;\n\n  filter(predicate?: AnyItem): Selector {\n    const selector = Selector.literal(this);\n    if (arguments.length === 0) {\n      return selector.filter();\n    } else {\n      return selector.filter(predicate);\n    }\n  }\n\n  max(that: Item): Item {\n    return this.compareTo(that) >= 0 ? this : that;\n  }\n\n  min(that: Item): Item {\n    return this.compareTo(that) <= 0 ? this : that;\n  }\n\n  evaluate(interpreter: AnyInterpreter): Item {\n    return this;\n  }\n\n  substitute(interpreter: AnyInterpreter): Item {\n    return this;\n  }\n\n  /**\n   * Converts this `Item` into a `string` value, if possible; otherwise returns\n   * `undefined` if this `Item` can't be converted into a `string` value.\n   */\n  abstract stringValue(): string | undefined;\n\n  /**\n   * Converts this `Item` into a `string` value, if possible; otherwise returns\n   * `orElse` if this `Item` can't be converted into a `string` value.\n   */\n  abstract stringValue<T>(orElse: T): string | T;\n\n  /**\n   * Converts this `Item` into a `number` value, if possible; otherwise returns\n   * `undefined` if this `Item` can't be converted into a `number` value.\n   */\n  abstract numberValue(): number | undefined;\n\n  /**\n   * Converts this `Item` into a `number` value, if possible; otherwise returns\n   * `orElse` if this `Item` can't be converted into a `number` value.\n   */\n  abstract numberValue<T>(orElse: T): number | T;\n\n  /**\n   * Converts this `Item` into a `boolean` value, if possible; otherwise returns\n   * `undefined` if this `Item` can't be converted into a `boolean` value.\n   */\n  abstract booleanValue(): boolean | undefined;\n\n  /**\n   * Converts this `Item` into a `boolean` value, if possible; otherwise returns\n   * `orElse` if this `Item` can't be converted into a `boolean` value.\n   */\n  abstract booleanValue<T>(orElse: T): boolean | T;\n\n  cast<T>(form: Form<T, unknown>): T | undefined;\n\n  cast<T, E = T>(form: Form<T, unknown>, orElse: E): T | E;\n\n  cast<T, E = T>(form: Form<T, unknown>, orElse?: E): T | E | undefined {\n    let object: T | E | undefined = form.cast(this);\n    if (object === void 0) {\n      object = orElse;\n    }\n    return object;\n  }\n\n  coerce<T>(form: Form<T, unknown>): T;\n\n  coerce<T, E = T>(form: Form<T, unknown>, orElse: E): T | E;\n\n  coerce<T, E = T>(form: Form<T, unknown>, orElse?: E): T | E {\n    let object: T | E | undefined = form.cast(this);\n    if (object === void 0) {\n      object = form.unit;\n    }\n    if (object === void 0) {\n      object = orElse;\n    }\n    return object!;\n  }\n\n  abstract toAny(): AnyItem;\n\n  abstract isAliased(): boolean;\n\n  abstract isMutable(): boolean;\n\n  abstract alias(): void;\n\n  abstract branch(): Item;\n\n  abstract clone(): Item;\n\n  abstract commit(): this;\n\n  /** @internal */\n  get precedence(): number {\n    return 11;\n  }\n\n  forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | undefined,\n                thisArg?: S): T | undefined {\n    return callback.call(thisArg, this, 0);\n  }\n\n  iterator(): Cursor<Item> {\n    return Cursor.unary(this);\n  }\n\n  interpolateTo(that: Item): Interpolator<Item>;\n  interpolateTo(that: unknown): Interpolator<Item> | null;\n  interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof Item) {\n      return ItemInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Returns the heterogeneous sort order of this `Item`. Used to impose a\n   * total order on the set of all items. When comparing two items of\n   * different types, the items order according to their `typeOrder`.\n   */\n  abstract readonly typeOrder: number;\n\n  abstract compareTo(that: unknown): number;\n\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  abstract keyEquals(key: unknown): boolean;\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  display<T>(output: Output<T>): Output<T> {\n    return this.debug(output);\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static empty(): Item {\n    return Record.empty();\n  }\n\n  static extant(): Item {\n    return Extant.extant();\n  }\n\n  static absent(): Item {\n    return Absent.absent();\n  }\n\n  static fromAny(item: AnyItem): Item {\n    if (item instanceof Item) {\n      return item;\n    } else {\n      return Value.fromAny(item);\n    }\n  }\n\n  @Lazy\n  static globalScope(): Item {\n    return Record.create(1)\n        .slot(\"math\", MathModule.scope)\n        .commit();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Item} from \"./Item\";\n\n/** @internal */\nexport const ItemInterpolator = (function (_super: typeof Interpolator) {\n  const ItemInterpolator = function <Y extends Item>(y0: Y, y1: Y): Interpolator<Y> {\n    const interpolator = function (u: number): Y {\n      return u < 1 ? interpolator[0] : interpolator[1];\n    } as Interpolator<Y>;\n    Object.setPrototypeOf(interpolator, ItemInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0.commit();\n    (interpolator as Mutable<typeof interpolator>)[1] = y1.commit();\n    return interpolator;\n  } as {\n    <Y extends Item>(y0: Y, y1: Y): Interpolator<Y>;\n\n    /** @internal */\n    prototype: Interpolator<any>;\n  };\n\n  ItemInterpolator.prototype = Object.create(_super.prototype);\n  ItemInterpolator.prototype.constructor = ItemInterpolator;\n\n  return ItemInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Interpolator} from \"@swim/util\";\nimport {AnyItem, Item} from \"./Item\";\nimport {FieldInterpolator} from \"./\"; // forward import\nimport {Attr} from \"./\"; // forward import\nimport {Slot} from \"./\" // forward import\nimport {AnyValue, Value} from \"./\"; // forward import\nimport {Record} from \"./\"; // forward import\nimport {AnyText, Text} from \"./\"; // forward import\nimport type {AnyNum} from \"./Num\";\n\n/** @public */\nexport type AnyField = Field\n                     | {readonly $key: AnyValue, readonly $value: AnyValue}\n                     | {[key: string]: AnyValue};\n\n/** @public */\nexport abstract class Field extends Item {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Always returns `true` because a `Field` can never be [[Absent]].\n   */\n  override isDefined(): boolean {\n    return true;\n  }\n\n  /**\n   * Always returns `true` because a `Field` can be neither [[Extant]] nor\n   * [[Absent]].\n   */\n  override isDistinct(): boolean {\n    return true;\n  }\n\n  /**\n   * Always returns `true` because a `Field` cannot be one of:\n   * an empty `Record`, `False`, `Extant`, or `Absent`.\n   */\n  override isDefinite(): boolean {\n    return true;\n  }\n\n  /**\n   * Returns the key component of this `Field`.\n   */\n  abstract override readonly key: Value;\n\n  /**\n   * Returns the value component of this `Field`.\n   */\n  abstract readonly value: Value;\n\n  /**\n   * Sets the value of this `Field` to the new `value`, returning the old value.\n   *\n   * @throws `Error` if this `Field` is immutable.\n   */\n  abstract setValue(value: AnyValue): Value;\n\n  /**\n   * Returns a copy of this `Field` with the updated `value`.\n   */\n  abstract updatedValue(value: AnyValue): Field;\n\n  /**\n   * Returns the value component of this `Field`.\n   */\n  override toValue(): Value {\n    return this.value;\n  }\n\n  /**\n   * Always returns `undefined` because a `Field` can't be a `Record`, so it\n   * can't have a first member `Attr` whose key string could be returned.\n   */\n  override get tag(): string | undefined {\n    return void 0;\n  }\n\n  /**\n   * Always returns the value component of this `Field`.\n   */\n  override get target(): Value {\n    return this.value;\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be flattened into a\n   * `Value`.\n   */\n  override flattened(): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Returns a `Record` containing just this `Field`.\n   */\n  override unflattened(): Record {\n    return Record.of(this);\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have a head `Attr` whose value could be returned if its key were\n   * equal to the `tag`.\n   */\n  override header(tag: string): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns `undefined` because a `Field` can't be a `Record`, so it\n   * can't have a head `Attr` whose value could be returned as a `Record` if\n   * its key were equal to the `tag`.\n   */\n  override headers(tag: string): Record | undefined {\n    return void 0;\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have a first member.\n   */\n  override head(): Item {\n    return Item.absent();\n  }\n\n  /**\n   * Always returns an empty `Record` because a `Field` can't itself be a\n   * `Record`, so it can't have any non-first members.\n   */\n  override tail(): Record {\n    return Record.empty();\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have any non-first members to flatten, and because a `Field` isn't\n   * a distinct `Value`, so it can't return `Extant`.\n   */\n  override body(): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns `0` because a `Field` can't be a `Record`, so it can't\n   * contain any members.\n   */\n  override get length(): number {\n    return 0;\n  }\n\n  /**\n   * Always returns `false` because a `Field` can't be a `Record`, so it can't\n   * have a `Field` member whose key is equal to the given `key`.\n   */\n  override has(key: AnyValue): boolean {\n    return false;\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have a `Field` member whose key is equal to the given `key`.\n   */\n  override get(key: AnyValue): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have an `Attr` member whose key is equal to the given `key`.\n   */\n  override getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have a `Slot` member whose key is equal to the given `key`.\n   */\n  override getSlot(key: AnyValue): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns `undefined` because a `Field` can't be a `Record`, so it\n   * can't have a `Field` member whose key is equal to the given `key`.\n   */\n  override getField(key: AnyValue): Field | undefined {\n    return void 0;\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Field` can't be a `Record`, so it\n   * can't have a member at the given `index`.\n   */\n  override getItem(index: AnyNum): Item {\n    return Item.absent();\n  }\n\n  override deleted(key: AnyValue): Field {\n    return this;\n  }\n\n  override conditional(thenTerm: Field, elseTerm: Field): Field;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item {\n    thenTerm = Item.fromAny(thenTerm);\n    return thenTerm;\n  }\n\n  override or(that: Field): Field;\n  override or(that: AnyItem): Item;\n  override or(that: AnyItem): Item {\n    return this;\n  }\n\n  override and(that: Field): Field;\n  override and(that: AnyItem): Item;\n  override and(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return that;\n  }\n\n  override lambda(template: Value): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Converts the value of this `Field` into a `string` value, if possible.\n   *\n   * @throws `Error` if the value of this `Field` can't be converted into a\n   *         `string` value.\n   */\n  override stringValue(): string | undefined;\n  /**\n   * Converts the value of this `Field` into a `string` value, if possible;\n   * otherwise returns `orElse` if the value of this `Field` can't be converted\n   * into a `string` value.\n   */\n  override stringValue<T>(orElse: T): string | T;\n  override stringValue<T>(orElse?: T): string | T | undefined {\n    return this.value.stringValue(orElse);\n  }\n\n  /**\n   * Converts the value of this `Field` into a `number` value, if possible.\n   *\n   * @throws `Error` if the value of this `Field` can't be converted into a\n   *         `number` value.\n   */\n  override numberValue(): number | undefined;\n  /**\n   * Converts the value of this `Field` into a `number` value, if possible;\n   * otherwise returns `orElse` if the value of this `Field` can't be converted\n   * into a `number` value.\n   */\n  override numberValue<T>(orElse: T): number | T;\n  override numberValue<T>(orElse?: T): number | T | undefined {\n    return this.value.numberValue(orElse);\n  }\n\n  /**\n   * Converts the value of this `Field` into a `boolean` value, if possible.\n   *\n   * @throws `Error` if the value of this `Field` can't be converted into a\n   *         `boolean` value.\n   */\n  override booleanValue(): boolean | undefined;\n  /**\n   * Converts the value of this `Field` into a `boolean` value, if possible;\n   * otherwise returns `orElse` if the value of this `Field` can't be converted\n   * into a `boolean` value.\n   */\n  override booleanValue<T>(orElse: T): boolean | T;\n  override booleanValue<T>(orElse?: T): boolean | T | undefined {\n    return this.value.booleanValue(orElse);\n  }\n\n  abstract override toAny(): AnyField;\n\n  abstract override branch(): Field;\n\n  abstract override clone(): Field;\n\n  abstract override commit(): this;\n\n  override interpolateTo(that: Field): Interpolator<Field>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof Field) {\n      return FieldInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  /** @internal */\n  static readonly ImmutableFlag: number = 1 << 0;\n\n  static of(key: AnyValue, value?: AnyValue): Field {\n    let name: string | undefined;\n    if (typeof key === \"string\") {\n      name = key;\n    } else if (key instanceof Text) {\n      name = key.value;\n    }\n    if (name !== void 0 && name.charCodeAt(0) === 64/*'@'*/) {\n      name = name.slice(1);\n      if (arguments.length === 1) {\n        return Attr.of(name);\n      } else {\n        return Attr.of(name, value);\n      }\n    } else {\n      if (arguments.length === 1) {\n        return Slot.of(key);\n      } else {\n        return Slot.of(key, value);\n      }\n    }\n  }\n\n  static override fromAny(field: AnyField): Field {\n    if (field instanceof Field) {\n      return field;\n    } else if (typeof field === \"object\" && field !== null) {\n      if ((field as any).$key !== void 0) {\n        return Field.of((field as any).$key, (field as any).$value);\n      } else {\n        for (const key in field) {\n          return Field.of(key, (field as any)[key]);\n        }\n      }\n    }\n    throw new TypeError(\"\" + field);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {AnyField, Field} from \"./Field\";\nimport {SlotInterpolator} from \"./\"; // forward import\nimport {AnyValue, Value} from \"./\"; // forward import\nimport {Text} from \"./\"; // forward import\nimport {Extant} from \"./\" // forward import\nimport {Expression} from \"./\"; // forward import\nimport {BitwiseOrOperator} from \"./\"; // forward import\nimport {BitwiseXorOperator} from \"./\"; // forward import\nimport {BitwiseAndOperator} from \"./\"; // forward import\nimport {PlusOperator} from \"./\"; // forward import\nimport {MinusOperator} from \"./\"; // forward import\nimport {TimesOperator} from \"./\"; // forward import\nimport {DivideOperator} from \"./\"; // forward import\nimport {ModuloOperator} from \"./\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"./\"; // forward import\n\n/** @public */\nexport class Slot extends Field {\n  constructor(key: Value, value: Value, flags?: number) {\n    super();\n    this.key = key.commit();\n    this.value = value;\n    this.flags = flags !== void 0 ? flags : 0;\n  }\n\n  override readonly key: Value;\n\n  override readonly value: Value;\n\n  /** @internal */\n  readonly flags: number;\n\n  override isConstant(): boolean {\n    return this.key.isConstant() && this.value.isConstant();\n  }\n\n  override setValue(newValue: Value): Value {\n    if ((this.flags & Field.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    const oldValue = this.value;\n    (this as Mutable<this>).value = newValue;\n    return oldValue;\n  }\n\n  override updatedValue(value: Value): Slot {\n    return new Slot(this.key, value);\n  }\n\n  override bitwiseOr(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseOrOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.bitwiseOr(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.bitwiseOr(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override bitwiseXor(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseXorOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.bitwiseXor(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.bitwiseXor(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override bitwiseAnd(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseAndOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.bitwiseAnd(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.bitwiseAnd(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override plus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new PlusOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.plus(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.plus(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override minus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new MinusOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.minus(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.minus(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override times(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new TimesOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.times(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.times(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override divide(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new DivideOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.divide(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.divide(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override modulo(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new ModuloOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Slot && this.key.equals(that.key)) {\n      newValue = this.value.modulo(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.modulo(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override not(): Item {\n    const newValue = this.value.not();\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override bitwiseNot(): Item {\n    const newValue = this.value.bitwiseNot();\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override negative(): Item {\n    const newValue = this.value.negative();\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override positive(): Item {\n    const newValue = this.value.positive();\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override inverse(): Item {\n    const newValue = this.value.inverse();\n    if (newValue.isDefined()) {\n      return new Slot(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const key = this.key.evaluate(interpreter).toValue();\n    const value = this.value.evaluate(interpreter).toValue();\n    if (key === this.key && value === this.value) {\n      return this;\n    } else if (key.isDefined() && value.isDefined()) {\n      return new Slot(key, value);\n    }\n    return Item.absent();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const key = this.key.substitute(interpreter).toValue();\n    const value = this.value.substitute(interpreter).toValue();\n    if (key === this.key && value === this.value) {\n      return this;\n    } else if (key.isDefined() && value.isDefined()) {\n      return new Slot(key, value);\n    }\n    return Item.absent();\n  }\n\n  override toAny(): AnyField {\n    const field = {} as {[key: string]: AnyValue};\n    if (this.key instanceof Text) {\n      field[this.key.value] = this.value.toAny();\n    } else {\n      field.$key = this.key.toAny();\n      field.$value = this.value.toAny();\n    }\n    return field;\n  }\n\n  override isAliased(): boolean {\n    return false;\n  }\n\n  override isMutable(): boolean {\n    return (this.flags & Field.ImmutableFlag) === 0;\n  }\n\n  override alias(): void {\n    (this as Mutable<this>).flags |= Field.ImmutableFlag;\n  }\n\n  override branch(): Slot {\n    if ((this.flags & Field.ImmutableFlag) !== 0) {\n      return new Slot(this.key, this.value, this.flags & ~Field.ImmutableFlag);\n    } else {\n      return this;\n    }\n  }\n\n  override clone(): Slot {\n    return new Slot(this.key.clone(), this.value.clone());\n  }\n\n  override commit(): this {\n    (this as Mutable<this>).flags |= Field.ImmutableFlag;\n    this.value.commit();\n    return this;\n  }\n\n  override interpolateTo(that: Slot): Interpolator<Slot>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof Slot) {\n      return SlotInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override get typeOrder(): number {\n    return 2;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Slot) {\n      let order = this.key.compareTo(that.key);\n      if (order === 0) {\n        order = this.value.compareTo(that.value);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Slot) {\n      return this.key.equals(that.key) && this.value.equivalentTo(that.value, epsilon);\n    }\n    return false;\n  }\n\n  override keyEquals(key: unknown): boolean {\n    if (typeof key === \"string\" && this.key instanceof Text) {\n      return this.key.value === key;\n    } else if (key instanceof Field) {\n      return this.key.equals(key.key);\n    } else {\n      return this.key.equals(key);\n    }\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Slot) {\n      return this.key.equals(that.key) && this.value.equals(that.value);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Slot),\n        this.key.hashCode()), this.value.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Slot\").write(46/*'.'*/).write(\"of\").write(40/*'('*/).display(this.key);\n    if (!(this.value instanceof Extant)) {\n      output = output.write(44/*','*/).write(32/*' '*/).display(this.value);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  static override of(key: AnyValue, value?: AnyValue): Slot {\n    key = Value.fromAny(key);\n    if (arguments.length === 1) {\n      value = Value.extant();\n    } else {\n      value = Value.fromAny(value);\n    }\n    return new Slot(key, value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Field} from \"./Field\";\nimport {Slot} from \"./Slot\";\nimport type {Value} from \"./Value\";\n\n/** @internal */\nexport interface FieldInterpolator extends Interpolator<Field> {\n  /** @internal */\n  readonly keyInterpolator: Interpolator<Value>;\n  /** @internal */\n  readonly valueInterpolator: Interpolator<Value>;\n\n  readonly 0: Field;\n\n  readonly 1: Field;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const FieldInterpolator = (function (_super: typeof Interpolator) {\n  const FieldInterpolator = function (y0: Field, y1: Field): FieldInterpolator {\n    const interpolator = function (u: number): Field {\n      const key = interpolator.keyInterpolator(u);\n      const value = interpolator.valueInterpolator(u);\n      return Slot.of(key, value);\n    } as FieldInterpolator;\n    Object.setPrototypeOf(interpolator, FieldInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).keyInterpolator = y0.key.interpolateTo(y1.key);\n    (interpolator as Mutable<typeof interpolator>).valueInterpolator = y0.value.interpolateTo(y1.value);\n    return interpolator;\n  } as {\n    (y0: Field, y1: Field): FieldInterpolator;\n\n    /** @internal */\n    prototype: FieldInterpolator;\n  };\n\n  FieldInterpolator.prototype = Object.create(_super.prototype);\n  FieldInterpolator.prototype.constructor = FieldInterpolator;\n\n  Object.defineProperty(FieldInterpolator.prototype, 0, {\n    get(this: FieldInterpolator): Field {\n      return Slot.of(this.keyInterpolator[0], this.valueInterpolator[0]);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(FieldInterpolator.prototype, 1, {\n    get(this: FieldInterpolator): Field {\n      return Slot.of(this.keyInterpolator[1], this.valueInterpolator[1]);\n    },\n    configurable: true,\n  });\n\n  FieldInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof FieldInterpolator) {\n      return this.keyInterpolator.equals(that.keyInterpolator)\n          && this.valueInterpolator.equals(that.valueInterpolator);\n    }\n    return false;\n  };\n\n  return FieldInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {AnyField, Field} from \"./Field\";\nimport {AttrInterpolator} from \"./\"; // forward import\nimport {Slot} from \"./\"; // forward import\nimport {AnyValue, Value} from \"./\"; // forward import\nimport {AnyText, Text} from \"./\"; // forward import\nimport {Extant} from \"./\" // forward import\nimport {Expression} from \"./\"; // forward import\nimport {BitwiseOrOperator} from \"./\"; // forward import\nimport {BitwiseXorOperator} from \"./\"; // forward import\nimport {BitwiseAndOperator} from \"./\"; // forward import\nimport {PlusOperator} from \"./\"; // forward import\nimport {MinusOperator} from \"./\"; // forward import\nimport {TimesOperator} from \"./\"; // forward import\nimport {DivideOperator} from \"./\"; // forward import\nimport {ModuloOperator} from \"./\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"./\"; // forward import\n\n/** @public */\nexport class Attr extends Field {\n  constructor(key: Text, value: Value, flags?: number) {\n    super();\n    this.key = key;\n    this.value = value;\n    this.flags = flags !== void 0 ? flags : 0;\n  }\n\n  override isConstant(): boolean {\n    return this.key.isConstant() && this.value.isConstant();\n  }\n\n  get name(): string {\n    return this.key.value;\n  }\n\n  override readonly key: Text;\n\n  override readonly value: Value;\n\n  /** @internal */\n  readonly flags: number;\n\n  override setValue(newValue: Value): Value {\n    if ((this.flags & Field.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    const oldValue = this.value;\n    (this as Mutable<this>).value = newValue;\n    return oldValue;\n  }\n\n  override updatedValue(value: Value): Attr {\n    return new Attr(this.key, value);\n  }\n\n  override bitwiseOr(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseOrOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.bitwiseOr(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.bitwiseOr(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override bitwiseXor(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseXorOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.bitwiseXor(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.bitwiseXor(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override bitwiseAnd(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseAndOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.bitwiseAnd(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.bitwiseAnd(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override plus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new PlusOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.plus(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.plus(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override minus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new MinusOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.minus(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.minus(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override times(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new TimesOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.times(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.times(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override divide(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new DivideOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.divide(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.divide(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override modulo(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new ModuloOperator(this, that);\n    }\n    let newValue;\n    if (that instanceof Attr && this.key.equals(that.key)) {\n      newValue = this.value.modulo(that.value);\n    } else if (that instanceof Value) {\n      newValue = this.value.modulo(that);\n    } else {\n      newValue = Value.absent();\n    }\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override not(): Item {\n    const newValue = this.value.not();\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override bitwiseNot(): Item {\n    const newValue = this.value.bitwiseNot();\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override negative(): Item {\n    const newValue = this.value.negative();\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override positive(): Item {\n    const newValue = this.value.positive();\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override inverse(): Item {\n    const newValue = this.value.inverse();\n    if (newValue.isDefined()) {\n      return new Attr(this.key, newValue);\n    }\n    return Item.absent();\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const key = this.key.evaluate(interpreter).toValue();\n    const value = this.value.evaluate(interpreter).toValue();\n    if (key === this.key && value === this.value) {\n      return this;\n    } else if (key.isDefined() && value.isDefined()) {\n      if (key instanceof Text) {\n        return new Attr(key, value);\n      } else {\n        return new Slot(key, value);\n      }\n    }\n    return Item.absent();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const key = this.key.substitute(interpreter).toValue();\n    const value = this.value.substitute(interpreter).toValue();\n    if (key === this.key && value === this.value) {\n      return this;\n    } else if (key.isDefined() && value.isDefined()) {\n      if (key instanceof Text) {\n        return new Attr(key, value);\n      } else {\n        return new Slot(key, value);\n      }\n    }\n    return Item.absent();\n  }\n\n  override toAny(): AnyField {\n    const field = {} as {[key: string]: AnyValue};\n    field[\"@\" + this.key.value] = this.value.toAny();\n    return field;\n  }\n\n  override isAliased(): boolean {\n    return false;\n  }\n\n  override isMutable(): boolean {\n    return (this.flags & Field.ImmutableFlag) === 0;\n  }\n\n  override alias(): void {\n    (this as Mutable<this>).flags |= Field.ImmutableFlag;\n  }\n\n  override branch(): Attr {\n    if ((this.flags & Field.ImmutableFlag) !== 0) {\n      return new Attr(this.key, this.value, this.flags & ~Field.ImmutableFlag);\n    } else {\n      return this;\n    }\n  }\n\n  override clone(): Attr {\n    return new Attr(this.key.clone(), this.value.clone());\n  }\n\n  override commit(): this {\n    (this as Mutable<this>).flags |= Field.ImmutableFlag;\n    this.value.commit();\n    return this;\n  }\n\n  override interpolateTo(that: Attr): Interpolator<Attr>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof Attr) {\n      return AttrInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override get typeOrder(): number {\n    return 1;\n  }\n\n  override compareTo(that: Item): number {\n    if (that instanceof Attr) {\n      let order = this.key.compareTo(that.key);\n      if (order === 0) {\n        order = this.value.compareTo(that.value);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Attr) {\n      return this.key.equals(that.key) && this.value.equivalentTo(that.value, epsilon);\n    }\n    return false;\n  }\n\n  override keyEquals(key: unknown): boolean {\n    if (typeof key === \"string\") {\n      return this.key.value === key;\n    } else if (key instanceof Field) {\n      return this.key.equals(key.key);\n    } else {\n      return this.key.equals(key);\n    }\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Attr) {\n      return this.key.equals(that.key) && this.value.equals(that.value);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(Attr),\n        this.key.hashCode()), this.value.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Attr\").write(46/*'.'*/).write(\"of\").write(40/*'('*/).display(this.key);\n    if (!(this.value instanceof Extant)) {\n      output = output.write(44/*','*/).write(32/*' '*/).display(this.value);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  static override of(key: AnyText, value?: AnyValue): Attr {\n    key = Text.fromAny(key);\n    if (arguments.length === 1) {\n      value = Value.extant();\n    } else {\n      value = Value.fromAny(value);\n    }\n    return new Attr(key, value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Attr} from \"./Attr\";\nimport type {Value} from \"./Value\";\nimport type {Text} from \"./Text\";\n\n/** @internal */\nexport interface AttrInterpolator extends Interpolator<Attr> {\n  /** @internal */\n  readonly keyInterpolator: Interpolator<Text>;\n  /** @internal */\n  readonly valueInterpolator: Interpolator<Value>;\n\n  readonly 0: Attr;\n\n  readonly 1: Attr;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const AttrInterpolator = (function (_super: typeof Interpolator) {\n  const AttrInterpolator = function (y0: Attr, y1: Attr): AttrInterpolator {\n    const interpolator = function (u: number): Attr {\n      const key = interpolator.keyInterpolator(u);\n      const value = interpolator.valueInterpolator(u);\n      return Attr.of(key, value);\n    } as AttrInterpolator;\n    Object.setPrototypeOf(interpolator, AttrInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).keyInterpolator = y0.key.interpolateTo(y1.key);\n    (interpolator as Mutable<typeof interpolator>).valueInterpolator = y0.value.interpolateTo(y1.value);\n    return interpolator;\n  } as {\n    (y0: Attr, y1: Attr): AttrInterpolator;\n\n    /** @internal */\n    prototype: AttrInterpolator;\n  };\n\n  AttrInterpolator.prototype = Object.create(_super.prototype);\n  AttrInterpolator.prototype.constructor = AttrInterpolator;\n\n  Object.defineProperty(AttrInterpolator.prototype, 0, {\n    get(this: AttrInterpolator): Attr {\n      return Attr.of(this.keyInterpolator[0], this.valueInterpolator[0]);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(AttrInterpolator.prototype, 1, {\n    get(this: AttrInterpolator): Attr {\n      return Attr.of(this.keyInterpolator[1], this.valueInterpolator[1]);\n    },\n    configurable: true,\n  });\n\n  AttrInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof AttrInterpolator) {\n      return this.keyInterpolator.equals(that.keyInterpolator)\n          && this.valueInterpolator.equals(that.valueInterpolator);\n    }\n    return false;\n  };\n\n  return AttrInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Slot} from \"./Slot\";\nimport type {Value} from \"./Value\";\n\n/** @internal */\nexport interface SlotInterpolator extends Interpolator<Slot> {\n  /** @internal */\n  readonly keyInterpolator: Interpolator<Value>;\n  /** @internal */\n  readonly valueInterpolator: Interpolator<Value>;\n\n  readonly 0: Slot;\n\n  readonly 1: Slot;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const SlotInterpolator = (function (_super: typeof Interpolator) {\n  const SlotInterpolator = function (y0: Slot, y1: Slot): SlotInterpolator {\n    const interpolator = function (u: number): Slot {\n      const key = interpolator.keyInterpolator(u);\n      const value = interpolator.valueInterpolator(u);\n      return Slot.of(key, value);\n    } as SlotInterpolator;\n    Object.setPrototypeOf(interpolator, SlotInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).keyInterpolator = y0.key.interpolateTo(y1.key);\n    (interpolator as Mutable<typeof interpolator>).valueInterpolator = y0.value.interpolateTo(y1.value);\n    return interpolator;\n  } as {\n    (y0: Slot, y1: Slot): SlotInterpolator;\n\n    /** @internal */\n    prototype: SlotInterpolator;\n  };\n\n  SlotInterpolator.prototype = Object.create(_super.prototype);\n  SlotInterpolator.prototype.constructor = SlotInterpolator;\n\n  Object.defineProperty(SlotInterpolator.prototype, 0, {\n    get(this: SlotInterpolator): Slot {\n      return Slot.of(this.keyInterpolator[0], this.valueInterpolator[0]);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(SlotInterpolator.prototype, 1, {\n    get(this: SlotInterpolator): Slot {\n      return Slot.of(this.keyInterpolator[1], this.valueInterpolator[1]);\n    },\n    configurable: true,\n  });\n\n  SlotInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof SlotInterpolator) {\n      return this.keyInterpolator.equals(that.keyInterpolator)\n          && this.valueInterpolator.equals(that.valueInterpolator);\n    }\n    return false;\n  };\n\n  return SlotInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyItem, Item} from \"./Item\";\nimport type {Interpolator, Builder} from \"@swim/util\";\nimport type {Field} from \"./Field\";\nimport {Attr} from \"./Attr\";\nimport {Slot} from \"./Slot\";\nimport {ValueBuilder} from \"./\"; // forward import\nimport {Record} from \"./\"; // forward import\nimport {Data} from \"./\"; // forward import\nimport {AnyText, Text} from \"./\"; // forward import\nimport {AnyNum, Num} from \"./\"; // forward import\nimport {Bool} from \"./\"; // forward import\nimport {Extant} from \"./\"; // forward import\nimport {Absent} from \"./\"; // forward import\nimport {Expression} from \"./\"; // forward import\nimport {BitwiseOrOperator} from \"./\"; // forward import\nimport {BitwiseXorOperator} from \"./\"; // forward import\nimport {BitwiseAndOperator} from \"./\"; // forward import\nimport {LtOperator} from \"./\"; // forward import\nimport {LeOperator} from \"./\"; // forward import\nimport {EqOperator} from \"./\"; // forward import\nimport {NeOperator} from \"./\"; // forward import\nimport {GeOperator} from \"./\"; // forward import\nimport {GtOperator} from \"./\"; // forward import\nimport {PlusOperator} from \"./\"; // forward import\nimport {MinusOperator} from \"./\"; // forward import\nimport {TimesOperator} from \"./\"; // forward import\nimport {DivideOperator} from \"./\"; // forward import\nimport {ModuloOperator} from \"./\"; // forward import\nimport {LambdaFunc} from \"./\"; // forward import\n\n/** @public */\nexport type AnyValue = Value\n                     | {readonly [key: string]: AnyValue}\n                     | ReadonlyArray<AnyItem>\n                     | Uint8Array\n                     | string\n                     | number\n                     | boolean\n                     | null\n                     | undefined;\n\n/** @public */\nexport abstract class Value extends Item {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  /**\n   * Returns `true` if this `Value` is not [[Absent]].\n   */\n  override isDefined(): boolean {\n    return true;\n  }\n\n  /**\n   * Returns `true` if this `Value` is neither [[Extant]] nor [[Absent]].\n   */\n  override isDistinct(): boolean {\n    return true;\n  }\n\n  /**\n   * Returns `true` if this `Value` is not one of: an empty `Record`, `False`,\n   * `Extant`, or `Absent`.\n   */\n  override isDefinite(): boolean {\n    return true;\n  }\n\n  /**\n   * Always returns [[Absent]] because a `Value` can't be a `Field`, so it\n   * can't have a key component.\n   */\n  override get key(): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns `this` because every `Value` is its own value component.\n   */\n  override toValue(): Value {\n    return this;\n  }\n\n  /**\n   * Returns the `key` string of the first member of this `Value`, if this\n   * `Value` is a [[Record]], and its first member is an [[Attr]]; otherwise\n   * returns `undefined` if this `Value` is not a `Record`, or if this `Value`\n   * is a `Record` whose first member is not an `Attr`.\n   *\n   * Used to concisely get the name of the discriminating attribute of a\n   * structure. The `tag` can be used to discern the nominal type of a\n   * polymorphic structure, similar to an XML element tag.\n   */\n  override get tag(): string | undefined {\n    return void 0;\n  }\n\n  /**\n   * Returns the [[Value.flattened flattened]] members of this `Value` after\n   * all attributes have been removed, if this `Value` is a [[Record]];\n   * otherwise returns `this` if this `Value` is not a `Record`.\n   *\n   * Used to concisely get the scalar value of an attributed structure. An\n   * attributed structure is a `Record` with one or more attributes that modify\n   * one or more other members.\n   */\n  override get target(): Value {\n    return this;\n  }\n\n  /**\n   * Returns the sole member of this `Value`, if this `Value` is a [[Record]]\n   * with exactly one member, and its member is a `Value`; returns [[Extant]]\n   * if this `Value` is an empty `Record`; otherwise returns `this` if this\n   * `Value` is a `Record` with more than one member, or if this `Value` is a\n   * not a `Record`.\n   *\n   * Used to convert a unary `Record` into its member `Value`. Facilitates\n   * writing code that treats a unary `Record` equivalently to a bare `Value`.\n   */\n  override flattened(): Value {\n    return this;\n  }\n\n  /**\n   * Returns `this` if this `Value` is a [[Record]]; returns a `Record`\n   * containing just this `Value`, if this `Value` is [[Value.isDistinct\n   * distinct]]; otherwise returns an empty `Record` if this `Value` is\n   * [[Extant]] or [[Absent]]. Facilitates writing code that treats a bare\n   * `Value` equivalently to a unary `Record`.\n   */\n  override unflattened(): Record {\n    return Record.of(this);\n  }\n\n  /**\n   * Returns the value of the first member of this `Value`, if this `Value` is\n   * a `Record`, and its first member is an [[Attr]] whose `key` string is\n   * equal to `tag`; otherwise returns [[Absent]] if this `Value` is not a\n   * `Record`, or if this `Value` is a `Record` whose first member is not an\n   * `Attr`, or if this `Value` is a `Record` whose first member is an `Attr`\n   * whose `key` does not equal the `tag`.\n   *\n   * Used to conditionally get the value of the head `Attr` of a structure, if\n   * and only if the key string of the head `Attr` is equal to the `tag`. Can\n   * be used to check if a structure might conform to a nominal type named\n   * `tag`, while simultaneously getting the value of the `tag` attribute.\n   */\n  override header(tag: string): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Returns the [[Value.unflattened unflattened]] [[Value.header header]] of\n   * this `Value`, if this `Value` is a [[Record]], and its first member is an\n   * [[Attr]] whose `key` string is equal to `tag`; otherwise returns\n   * `undefined`.\n   *\n   * The `headers` of the `tag` attribute of a structure are like the\n   * attributes of an XML element tag; through unlike an XML element, `tag`\n   * attribute headers are not limited to string keys and values.\n   */\n  override headers(tag: string): Record | undefined {\n    return void 0;\n  }\n\n  /**\n   * Returns the first member of this `Value`, if this `Value` is a non-empty\n   * [[Record]]; otherwise returns [[Absent]].\n   */\n  override head(): Item {\n    return Item.absent();\n  }\n\n  /**\n   * Returns a view of all but the first member of this `Value`, if this\n   * `Value` is a non-empty [[Record]]; otherwise returns an empty `Record`\n   * if this `Value` is not a `Record`, of if this `Value` is itself an\n   * empty `Record`.\n   */\n  override tail(): Record {\n    return Record.empty();\n  }\n\n  /**\n   * Returns the [[Record.flattened flattened]] [[Value.tail tail]] of this\n   * `Value`. Used to recursively deconstruct a structure, terminating with\n   * its last `Value`, rather than a unary `Record` containing its last value,\n   * if the structure ends with a `Value` member.\n   */\n  override body(): Value {\n    return Value.extant();\n  }\n\n  /**\n   * Returns the number of members contained in this `Value`, if this `Value`\n   * is a [[Record]]; otherwise returns `0` if this `Value` is not a `Record`.\n   */\n  override get length(): number {\n    return 0;\n  }\n\n  /**\n   * Returns `true` if this `Value` is a [[Record]] that has a [[Field]] member\n   * with a key that is equal to the given `key`; otherwise returns `false` if\n   * this `Value` is not a `Record`, or if this `Value` is a `Record`, but has\n   * no `Field` member with a key equal to the given `key`.\n   */\n  override has(key: AnyValue): boolean {\n    return false;\n  }\n\n  /**\n   * Returns the value of the last [[Field]] member of this `Value` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Value` is not a\n   * [[Record]], or if this `Value` is a `Record`, but has no `Field` member\n   * with a key equal to the given `key`.\n   */\n  override get(key: AnyValue): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Returns the value of the last [[Attr]] member of this `Value` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Value` is not a\n   * [[Record]], or if this `Value` is a `Record`, but has no `Attr` member\n   * with a key equal to the given `key`.\n   */\n  override getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Returns the value of the last [[Slot]] member of this `Value` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Value` is not a\n   * [[Record]], or if this `Value` is a `Record`, but has no `Slot` member\n   * with a key equal to the given `key`.\n   */\n  override getSlot(key: AnyValue): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Returns the last [[Field]] member of this `Value` whose key is equal to\n   * the given `key`; returns `undefined` if this `Value` is not a [[Record]],\n   * or if this `Value` is a `Record`, but has no `Field` member with a `key`\n   * equal to the given `key`.\n   */\n  override getField(key: AnyValue): Field | undefined {\n    return void 0;\n  }\n\n  /**\n   * Returns the member of this `Value` at the given `index`, if this `Value`\n   * is a [[Record]], and the `index` is greater than or equal to zero, and\n   * less than the [[Record.length length]] of the `Record`; otherwise returns\n   * [[Absent]] if this `Value` is not a `Record`, or if this `Value` is a\n   * `Record`, but the `index` is out of bounds.\n   */\n  override getItem(index: AnyNum): Item {\n    return Item.absent();\n  }\n\n  override deleted(key: AnyValue): Value {\n    return this;\n  }\n\n  override conditional(thenTerm: AnyValue, elseTerm: AnyValue): Value;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item {\n    thenTerm = Item.fromAny(thenTerm);\n    return thenTerm;\n  }\n\n  override or(that: AnyValue): Value;\n  override or(that: AnyItem): Item;\n  override or(that: AnyItem): Item {\n    return this;\n  }\n\n  override and(that: AnyValue): Value;\n  override and(that: AnyItem): Item;\n  override and(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    return that;\n  }\n\n  override bitwiseOr(that: AnyValue): Value;\n  override bitwiseOr(that: AnyItem): Item;\n  override bitwiseOr(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseOrOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.bitwiseOr(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.bitwiseOr(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override bitwiseXor(that: AnyValue): Value;\n  override bitwiseXor(that: AnyItem): Item;\n  override bitwiseXor(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseXorOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.bitwiseXor(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.bitwiseXor(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override bitwiseAnd(that: AnyValue): Value;\n  override bitwiseAnd(that: AnyItem): Item;\n  override bitwiseAnd(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new BitwiseAndOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.bitwiseAnd(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.bitwiseAnd(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override lt(that: AnyValue): Value;\n  override lt(that: AnyItem): Item;\n  override lt(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new LtOperator(this, that);\n    }\n    return super.lt(that);\n  }\n\n  override le(that: AnyValue): Value;\n  override le(that: AnyItem): Item;\n  override le(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new LeOperator(this, that);\n    }\n    return super.le(that);\n  }\n\n  override eq(that: AnyValue): Value;\n  override eq(that: AnyItem): Item;\n  override eq(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new EqOperator(this, that);\n    }\n    return super.eq(that);\n  }\n\n  override ne(that: AnyValue): Value;\n  override ne(that: AnyItem): Item;\n  override ne(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new NeOperator(this, that);\n    }\n    return super.ne(that);\n  }\n\n  override ge(that: AnyValue): Value;\n  override ge(that: AnyItem): Item;\n  override ge(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new GeOperator(this, that);\n    }\n    return super.ge(that);\n  }\n\n  override gt(that: AnyValue): Value;\n  override gt(that: AnyItem): Item;\n  override gt(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new GtOperator(this, that);\n    }\n    return super.gt(that);\n  }\n\n  override plus(that: AnyValue): Value;\n  override plus(that: AnyItem): Item;\n  override plus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new PlusOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.plus(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.plus(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override minus(that: AnyValue): Value;\n  override minus(that: AnyItem): Item;\n  override minus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new MinusOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.minus(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.minus(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override times(that: AnyValue): Value;\n  override times(that: AnyItem): Item;\n  override times(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new TimesOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.times(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.times(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override divide(that: AnyValue): Value;\n  override divide(that: AnyItem): Item;\n  override divide(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new DivideOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.divide(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.divide(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override modulo(that: AnyValue): Value;\n  override modulo(that: AnyItem): Item;\n  override modulo(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Expression) {\n      return new ModuloOperator(this, that);\n    } else if (that instanceof Attr) {\n      const newValue = this.modulo(that.value);\n      if (newValue.isDefined()) {\n        return new Attr(that.key, newValue);\n      }\n    } else if (that instanceof Slot) {\n      const newValue = this.modulo(that.value);\n      if (newValue.isDefined()) {\n        return new Slot(that.key, newValue);\n      }\n    }\n    return Item.absent();\n  }\n\n  override not(): Value {\n    return Value.absent();\n  }\n\n  override bitwiseNot(): Value {\n    return Value.absent();\n  }\n\n  override negative(): Value {\n    return Value.absent();\n  }\n\n  override positive(): Value {\n    return Value.absent();\n  }\n\n  override inverse(): Value {\n    return Value.absent();\n  }\n\n  override lambda(template: Value): Value {\n    return new LambdaFunc(this, template);\n  }\n\n  /**\n   * Converts this `Value` into a `string` value, if possible; otherwise returns\n   * `undefined` if this `Value` can't be converted into a `string` value.\n   */\n  override stringValue(): string | undefined;\n  /**\n   * Converts this `Value` into a `string` value, if possible; otherwise returns\n   * `orElse` if this `Value` can't be converted into a `string` value.\n   */\n  override stringValue<T>(orElse: T): string | T;\n  override stringValue<T>(orElse?: T): string | T | undefined {\n    return orElse;\n  }\n\n  /**\n   * Converts this `Value` into a `number` value, if possible; otherwise returns\n   * `undefined` if this `Value` can't be converted into a `number` value.\n   */\n  override numberValue(): number | undefined;\n  /**\n   * Converts this `Value` into a `number` value, if possible; otherwise returns\n   * `orElse` if this `Value` can't be converted into a `number` value.\n   */\n  override numberValue<T>(orElse: T): number | T;\n  override numberValue<T>(orElse?: T): number | T | undefined {\n    return orElse;\n  }\n\n  /**\n   * Converts this `Value` into a `boolean` value, if possible; otherwise\n   * returns `undefined` if this `Value` can't be converted into a `boolean`\n   * value.\n   */\n  override booleanValue(): boolean | undefined;\n  /**\n   * Converts this `Value` into a `boolean` value, if possible; otherwise\n   * returns `orElse` if this `Value` can't be converted into a `boolean` value.\n   */\n  override booleanValue<T>(orElse: T): boolean | T;\n  override booleanValue<T>(orElse?: T): boolean | T | undefined {\n    return orElse;\n  }\n\n  abstract override toAny(): AnyValue;\n\n  override isAliased(): boolean {\n    return false;\n  }\n\n  override isMutable(): boolean {\n    return false;\n  }\n\n  override alias(): void {\n    // nop\n  }\n\n  override branch(): Value {\n    return this;\n  }\n\n  override clone(): Value {\n    return this;\n  }\n\n  override commit(): this {\n    return this;\n  }\n\n  override interpolateTo(that: Value): Interpolator<Value>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    return super.interpolateTo(that);\n  }\n\n  override keyEquals(key: unknown): boolean {\n    return false;\n  }\n\n  static builder(): Builder<Item, Value> {\n    return new ValueBuilder();\n  }\n\n  static override empty(): Value {\n    return Record.empty();\n  }\n\n  static override extant(): Value {\n    return Extant.extant();\n  }\n\n  static override absent(): Value {\n    return Absent.absent();\n  }\n\n  static override fromAny(value: AnyValue): Value {\n    if (value instanceof Value) {\n      return value;\n    } else if (value === void 0) {\n      return Absent.absent();\n    } else if (value === null) {\n      return Extant.extant();\n    } else if (typeof value === \"boolean\") {\n      return Bool.from(value);\n    } else if (typeof value === \"number\") {\n      return Num.from(value);\n    } else if (typeof value === \"string\") {\n      return Text.from(value);\n    } else if (value instanceof Uint8Array) {\n      return Data.wrap(value);\n    } else if (Array.isArray(value)) {\n      return Record.fromArray(value);\n    } else if (typeof value === \"object\") {\n      return Record.fromObject(value as {[key: string]: AnyValue});\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors, Interpolator, Cursor, Builder} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {Field} from \"./Field\";\nimport {Attr} from \"./Attr\";\nimport {Slot} from \"./Slot\";\nimport {AnyValue, Value} from \"./Value\";\nimport {RecordInterpolator} from \"./\"; // forward import\nimport {RecordCursor} from \"./\"; // forward import\nimport {RecordMap} from \"./\"; // forward import\nimport {AnyText, Text} from \"./\"; // forward import\nimport type {AnyNum} from \"./Num\";\nimport {AnyInterpreter, Interpreter} from \"./\"; // forward import\n\n/** @public */\nexport type AnyRecord = Record\n                      | {readonly [key: string]: AnyValue}\n                      | ReadonlyArray<AnyItem>;\n\n/** @public */\nexport abstract class Record extends Value implements Builder<Item, Record> {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  override isDefinite(): boolean {\n    return !this.isEmpty();\n  }\n\n  /**\n   * Returns `true` if this `Record` has no members.\n   */\n  abstract isEmpty(): boolean;\n\n  /**\n   * Returns `true` if this `Record` has only [[Value]] members–no `Field`\n   * members.\n   */\n  isArray(): boolean {\n    return this.fieldCount === 0;\n  }\n\n  /**\n   * Returns `true` if this `Record` has only [[Field]] members–no `Value`\n   * members.\n   */\n  isObject(): boolean {\n    return this.valueCount === 0;\n  }\n\n  /**\n   * Returns the number of members contained in this `Record`.\n   */\n  abstract override get length(): number;\n\n  /**\n   * Returns the number of [[Field]] members contained in this `Record`.\n   */\n  declare readonly fieldCount: number; // getter defined below to work around useDefineForClassFields lunacy\n\n  /**\n   * Returns the number of [[Value]] members contained in this `Record`.\n   */\n  get valueCount(): number {\n    let count = 0;\n    this.forEach(function (member: Item): void {\n      if (member instanceof Value) {\n        count += 1;\n      }\n    }, this);\n    return count;\n  }\n\n  override isConstant(): boolean {\n    return this.forEach(function (member: Item): boolean | undefined {\n      return member.isConstant() ? void 0 : false;\n    }, this) === void 0;\n  }\n\n  /**\n   * Returns the `key` string of the first member of this `Record`, if the\n   * first member is an [[Attr]]; otherwise returns `undefined` if the first\n   * member is not an `Attr`.\n   *\n   * Used to concisely get the name of the discriminating attribute of a\n   * structure. The `tag` can be used to discern the nominal type of a\n   * polymorphic structure, similar to an XML element tag.\n   */\n  override get tag(): string | undefined {\n    const item = this.head();\n    if (item instanceof Attr) {\n      return item.key.value;\n    }\n    return void 0;\n  }\n\n  /**\n   * Returns the [[Record.flattened flattened]] members of this `Record` after\n   * all attributes have been removed.\n   *\n   * Used to concisely get the scalar value of an attributed structure. An\n   * attributed structure is a `Record` with one or more attributes that modify\n   * one or more other members.\n   */\n  override get target(): Value {\n    let value: Value | undefined;\n    let record: Record | undefined;\n    let modified = false;\n    this.forEach(function (item: Item): void {\n      if (item instanceof Attr) {\n        modified = true;\n      } else if (value === void 0 && item instanceof Value) {\n        value = item;\n      } else {\n        if (record === void 0) {\n          record = Record.create();\n          if (value !== void 0) {\n            record.push(value);\n          }\n        }\n        record.push(item);\n      }\n    }, this);\n    if (value === void 0) {\n      return Value.extant();\n    } else if (record === void 0) {\n      return value;\n    } else if (modified) {\n      return record;\n    } else {\n      return this;\n    }\n  }\n\n  /**\n   * Returns the sole member of this `Record`, if this `Record` has exactly one\n   * member, and its member is a `Value`; returns [[Extant]] if this `Record`\n   * is empty; otherwise returns `this` if this `Record` has more than one\n   * member.\n   *\n   * Used to convert a unary `Record` into its member `Value`. Facilitates\n   * writing code that treats a unary `Record` equivalently to a bare `Value`.\n   */\n  override flattened(): Value {\n    if (this.isEmpty()) {\n      return Value.extant();\n    } else {\n      const items = this.iterator();\n      const head = items.head();\n      items.step();\n      if (items.isEmpty() && head instanceof Value) {\n        return head;\n      } else {\n        return this.branch();\n      }\n    }\n  }\n\n  /**\n   * Returns this `Record`.\n   */\n  override unflattened(): Record {\n    return this;\n  }\n\n  /**\n   * Returns the value of the first member of this `Record`, if the first\n   * member is an [[Attr]] whose `key` string is equal to `tag`; otherwise\n   * returns [[Absent]] if the first member of this `Record` is not an `Attr`,\n   * or if the first member of this `Record` is an `Attr` whose `key` does not\n   * equal the `tag`.\n   *\n   * Used to conditionally get the value of the head `Attr` of a structure, if\n   * and only if the key string of the head `Attr` is equal to the `tag`. Can\n   * be used to check if a structure might conform to a nominal type named\n   * `tag`, while simultaneously getting the value of the `tag` attribute.\n   */\n  override header(tag: string): Value {\n    const head = this.head();\n    if (head instanceof Attr && head.key.value === tag) {\n      return head.value;\n    } else {\n      return Value.absent();\n    }\n  }\n\n  /**\n   * Returns the [[Record.unflattened unflattened]] [[Record.header header]] of\n   * this `Record`. The `headers` of the `tag` attribute of a structure are\n   * like the attributes of an XML element tag; through unlike an XML element,\n   * `tag` attribute headers are not limited to string keys and values.\n   */\n  override headers(tag: string): Record | undefined {\n    const head = this.head();\n    if (head instanceof Attr && head.key.value === tag) {\n      const header = head.value;\n      if (header instanceof Record) {\n        return header;\n      } else {\n        return Record.of(header);\n      }\n    }\n    return void 0;\n  }\n\n  /**\n   * Returns the first member of this `Record`, if this `Record` is non-empty;\n   * otherwise returns [[Absent]].\n   */\n  override head(): Item {\n    return this.forEach(function (item: Item): Item {\n      return item;\n    }, this) || Item.absent();\n  }\n\n  /**\n   * Returns a view of all but the first member of this `Record`, if this\n   * `Record` is non-empty; otherwise returns an empty `Record`, if this\n   * `Record` is itself empty.\n   */\n  override tail(): Record {\n    const tail = Record.create();\n    this.forEach(function (item: Item, index: number): void {\n      if (index > 0) {\n        tail.push(item);\n      }\n    }, this);\n    return tail;\n  }\n\n  /**\n   * Returns the [[Record.flattened flattened]] [[Record.tail tail]] of this\n   * `Record`. Used to recursively deconstruct a structure, terminating\n   * with its last `Value`, rather than a unary `Record` containing its last\n   * value, if the structure ends with a `Value` member.\n   */\n  override body(): Value {\n    const tail = this.tail();\n    if (!tail.isEmpty()) {\n      return tail.flattened();\n    } else {\n      return Value.absent();\n    }\n  }\n\n  /**\n   * Returns `true` if this `Record` has a [[Field]] member with a key that is\n   * equal to the given `key`; otherwise returns `false` if this `Record` has\n   * no `Field` member with a key equal to the given `key`.\n   */\n  override has(key: AnyValue): boolean {\n    key = Value.fromAny(key);\n    return this.forEach(function (item: Item): boolean | undefined {\n      return item instanceof Field && item.key.equals(key) ? true : void 0;\n    }, this) || false;\n  }\n\n  indexOf(item: AnyItem, index: number = 0): number {\n    item = Item.fromAny(item);\n    if (index < 0) {\n      index = Math.max(0, this.length + index);\n    }\n    const i = this.forEach(function (member: Item, i: number): number | undefined {\n      return i >= index && (item as Item).equals(member) ? i : void 0;\n    }, this);\n    return i !== void 0 ? i : -1;\n  }\n\n  lastIndexOf(item: AnyItem, index?: number): number {\n    item = Item.fromAny(item);\n    const n = this.length;\n    if (index === void 0) {\n      index = n - 1;\n    } else if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(index, n - 1);\n    while (index >= 0) {\n      if (item.equals(this.getItem(index))) {\n        return index;\n      }\n      index -= 1;\n    }\n    return -1;\n  }\n\n  /**\n   * Returns the value of the last [[Field]] member of this `Record` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Record` has no\n   * `Field` member with a key equal to the given `key`.\n   */\n  override get(key: AnyValue): Value {\n    key = Value.fromAny(key);\n    return this.forEach(function (item: Item): Value | undefined {\n      return item instanceof Field && item.key.equals(key) ? item.value : void 0;\n    }, this) || Value.absent();\n  }\n\n  /**\n   * Returns the value of the last [[Attr]] member of this `Record` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Record` has no\n   * `Attr` member with a key equal to the given `key`.\n   */\n  override getAttr(key: AnyText): Value {\n    key = Text.fromAny(key);\n    return this.forEach(function (item: Item): Value | undefined {\n      return item instanceof Attr && item.key.equals(key) ? item.value : void 0;\n    }, this) || Value.absent();\n  }\n\n  /**\n   * Returns the value of the last [[Slot]] member of this `Record` whose key\n   * is equal to the given `key`; returns [[Absent]] if this `Record` has no\n   * `Slot` member with a key equal to the given `key`.\n   */\n  override getSlot(key: AnyValue): Value {\n    key = Value.fromAny(key);\n    return this.forEach(function (item: Item): Value | undefined {\n      return item instanceof Slot && item.key.equals(key) ? item.value : void 0;\n    }, this) || Value.absent();\n  }\n\n  /**\n   * Returns the last [[Field]] member of this `Record` whose key is equal to\n   * the given `key`; returns `undefined` if this `Record` has no `Field` member\n   * with a `key` equal to the given `key`.\n   */\n  override getField(key: AnyValue): Field | undefined {\n    key = Value.fromAny(key);\n    return this.forEach(function (item: Item): Field | undefined {\n      return item instanceof Field && item.key.equals(key) ? item : void 0;\n    }, this);\n  }\n\n  /**\n   * Returns the member of this `Record` at the given `index`, if the `index`\n   * is greater than or equal to zero, and less than the [[Record.length\n   * length]] of this `Record`; otherwise returns [[Absent]] if the `index` is\n   * out of bounds.\n   */\n  abstract override getItem(index: AnyNum): Item;\n\n  set(key: AnyValue, newValue: AnyValue): this {\n    key = Value.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    const items = this.iterator();\n    while (!items.isEmpty()) {\n      const item = items.head();\n      if (item instanceof Field && item.key.equals(key)) {\n        if (item.isMutable()) {\n          item.setValue(newValue);\n        } else {\n          items.set(item.updatedValue(newValue));\n        }\n        return this;\n      }\n      items.step();\n    }\n    this.push(new Slot(key, newValue));\n    return this;\n  }\n\n  setAttr(key: AnyText, newValue: AnyValue): this {\n    key = Text.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    const items = this.iterator();\n    while (!items.isEmpty()) {\n      const item = items.head();\n      if (item instanceof Field && item.key.equals(key)) {\n        if (item instanceof Attr && item.isMutable()) {\n          item.setValue(newValue);\n        } else {\n          items.set(new Attr(key, newValue));\n        }\n        return this;\n      }\n      items.step();\n    }\n    this.push(new Attr(key, newValue));\n    return this;\n  }\n\n  setSlot(key: AnyValue, newValue: AnyValue): this {\n    key = Value.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    const items = this.iterator();\n    while (!items.isEmpty()) {\n      const item = items.head();\n      if (item instanceof Field && item.key.equals(key)) {\n        if (item instanceof Slot && item.isMutable()) {\n          item.setValue(newValue);\n        } else {\n          items.set(new Slot(key, newValue));\n        }\n        return this;\n      }\n      items.step();\n    }\n    this.push(new Slot(key, newValue));\n    return this;\n  }\n\n  /**\n   * Replaces the member of this `Record` at the given `index` with a new\n   * `item`, returning `this` `Record`, if the `index` is greater than or\n   * equal to zero, and less than the [[Record.length length]] of this `Record`.\n   *\n   * @throws `Error` if this is an immutable `Record`.\n   * @throws `RangeError` if the `index` is out of bounds.\n   */\n  abstract setItem(index: number, item: AnyItem): this;\n\n  override updated(key: AnyValue, value: AnyValue): Record {\n    key = Value.fromAny(key);\n    value = Value.fromAny(value);\n    const record = this.isMutable() ? this : this.branch();\n    const items = record.iterator();\n    while (!items.isEmpty()) {\n      const item = items.head();\n      if (item.key.equals(key)) {\n        if (item instanceof Field && item.isMutable()) {\n          item.setValue(value);\n        } else {\n          items.set(new Slot(key, value));\n        }\n        return record;\n      }\n      items.step();\n    }\n    record.push(new Slot(key, value));\n    return record;\n  }\n\n  override updatedAttr(key: AnyText, value: AnyValue): Record {\n    key = Text.fromAny(key);\n    value = Value.fromAny(value);\n    const record = this.isMutable() ? this : this.branch();\n    const items = record.iterator();\n    while (!items.isEmpty()) {\n      const item = items.head();\n      if (item.key.equals(key)) {\n        if (item instanceof Attr && item.isMutable()) {\n          item.setValue(value);\n        } else {\n          items.set(new Attr(key, value));\n        }\n        return record;\n      }\n      items.step();\n    }\n    record.push(new Attr(key, value));\n    return record;\n  }\n\n  override updatedSlot(key: AnyValue, value: AnyValue): Record {\n    key = Value.fromAny(key);\n    value = Value.fromAny(value);\n    const record = this.isMutable() ? this : this.branch();\n    const items = record.iterator();\n    while (!items.isEmpty()) {\n      const item = items.head();\n      if (item.key.equals(key)) {\n        if (item instanceof Slot && item.isMutable()) {\n          item.setValue(value);\n        } else {\n          items.set(new Slot(key, value));\n        }\n        return record;\n      }\n      items.step();\n    }\n    record.push(new Slot(key, value));\n    return record;\n  }\n\n  abstract push(...items: AnyItem[]): number;\n\n  abstract splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[];\n\n  abstract delete(key: AnyValue): Item;\n\n  abstract clear(): void;\n\n  override appended(...items: AnyItem[]): Record {\n    const record = this.isMutable() ? this : this.branch();\n    record.push(...items);\n    return record;\n  }\n\n  override prepended(...items: AnyItem[]): Record {\n    const record = this.isMutable() ? this : this.branch();\n    record.splice(0, 0, ...items);\n    return record;\n  }\n\n  override deleted(key: AnyValue): Record {\n    const record = this.isMutable() ? this : this.branch();\n    record.delete(key);\n    return record;\n  }\n\n  override concat(...items: AnyItem[]): Record {\n    const record = this.isMutable() ? this : this.branch();\n    for (let i = 0, n = items.length; i < n; i += 1) {\n      Item.fromAny(items[i]).forEach(function (item: Item): void {\n        record.push(item);\n      });\n    }\n    return record;\n  }\n\n  slice(lower?: number, upper?: number): Record {\n    return this.subRecord(lower, upper).branch();\n  }\n\n  attr(key: AnyText, value?: AnyValue): this {\n    let field: Field;\n    if (arguments.length === 1) {\n      field = Attr.of(key);\n    } else {\n      field = Attr.of(key, value);\n    }\n    this.push(field);\n    return this;\n  }\n\n  slot(key: AnyValue, value?: AnyValue): this {\n    let field: Field;\n    if (arguments.length === 1) {\n      field = Slot.of(key);\n    } else {\n      field = Slot.of(key, value);\n    }\n    this.push(field);\n    return this;\n  }\n\n  item(item: AnyItem): this {\n    this.push(item);\n    return this;\n  }\n\n  items(...items: AnyItem[]): this {\n    this.push(this, ...items);\n    return this;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Record {\n    interpreter = Interpreter.fromAny(interpreter);\n    const scope = Record.create();\n    interpreter.pushScope(scope);\n    let changed = false;\n    this.forEach(function (oldItem: Item): void {\n      const newItem = oldItem.evaluate(interpreter);\n      if (newItem.isDefined()) {\n        scope.push(newItem);\n      }\n      if (oldItem !== newItem) {\n        changed = true;\n      }\n    }, this);\n    interpreter.popScope();\n    return changed ? scope : this;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Record {\n    interpreter = Interpreter.fromAny(interpreter);\n    const scope = Record.create();\n    interpreter.pushScope(scope);\n    let changed = false;\n    this.forEach(function (oldItem: Item) {\n      const newItem = oldItem.substitute(interpreter);\n      if (newItem.isDefined()) {\n        scope.push(newItem);\n      }\n      if (oldItem !== newItem) {\n        changed = true;\n      }\n    }, this);\n    interpreter.popScope();\n    return changed ? scope : this;\n  }\n\n  override stringValue(): string | undefined;\n  override stringValue<T>(orElse: T): string | T;\n  override stringValue<T>(orElse?: T): string | T | undefined {\n    let recordString = \"\";\n    const defined = this.forEach(function (item: Item): null | void {\n      if (item instanceof Value) {\n        const itemString = item.stringValue();\n        if (itemString !== void 0) {\n          recordString += itemString;\n          return;\n        }\n      }\n      return null; // break\n    }, this) === void 0;\n    return defined ? recordString : void 0;\n  }\n\n  override toAny(): AnyValue {\n    if (!this.isEmpty() && this.isArray()) {\n      return this.toArray();\n    } else {\n      return this.toObject();\n    }\n  }\n\n  toArray(): AnyItem[] {\n    const array = new Array<AnyItem>(this.length);\n    this.forEach(function (item: Item, index: number): void {\n      if (item instanceof Value) {\n        array[index] = item.toAny();\n      } else if (item instanceof Field) {\n        array[index] = {\n          $key: item.key.toAny(),\n          $value: item.value.toAny(),\n        };\n      }\n    }, this);\n    return array;\n  }\n\n  toObject(): {[key: string]: AnyValue} {\n    const object = {} as {[key: string]: AnyValue};\n    this.forEach(function (item: Item, index: number): void {\n      if (item instanceof Attr) {\n        object[\"@\" + item.key.value] = item.value.toAny();\n      } else if (item instanceof Slot) {\n        if (item.key instanceof Text) {\n          object[item.key.value] = item.value.toAny();\n        } else {\n          object[\"$\" + index] = {\n            $key: item.key.toAny(),\n            $value: item.value.toAny(),\n          };\n        }\n      } else if (item instanceof Value) {\n        object[\"$\" + index] = item.toAny();\n      }\n    }, this);\n    return object;\n  }\n\n  override isAliased(): boolean {\n    return false;\n  }\n\n  override isMutable(): boolean {\n    return true;\n  }\n\n  override alias(): void {\n    // nop\n  }\n\n  override branch(): Record {\n    const branch = Record.create();\n    this.forEach(function (item: Item): void {\n      branch.push(item);\n    }, this);\n    return branch;\n  }\n\n  override clone(): Record {\n    const clone = Record.create();\n    this.forEach(function (item: Item): void {\n      clone.push(item.clone());\n    }, this);\n    return clone;\n  }\n\n  override commit(): this {\n    return this;\n  }\n\n  bind(): Record {\n    return this;\n  }\n\n  subRecord(lower?: number, upper?: number): Record {\n    const n = this.length;\n    if (lower === void 0) {\n      lower = 0;\n    } else if (lower < 0) {\n      lower = n + lower;\n    }\n    lower = Math.min(Math.max(0, lower), n);\n    if (upper === void 0) {\n      upper = n;\n    } else if (upper < 0) {\n      upper = n + upper;\n    }\n    const record = Record.create();\n    this.forEach(function (item: Item, index: number): null | void {\n      if (index < lower!) {\n        return;\n      } else if (index < upper!) {\n        record.push(item);\n        return;\n      } else {\n        return null;\n      }\n    }, this);\n    return record;\n  }\n\n  abstract override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  abstract override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                                  thisArg: S): T | undefined;\n\n  override iterator(): Cursor<Item> {\n    return new RecordCursor(this);\n  }\n\n  override interpolateTo(that: Record): Interpolator<Record>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof Record) {\n      return RecordInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override get typeOrder(): number {\n    return 3;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Record) {\n      const xs = this.iterator();\n      const ys = that.iterator();\n      let order = 0;\n      do {\n        if (!xs.isEmpty() && !ys.isEmpty()) {\n          order = xs.head().compareTo(ys.head());\n          xs.step();\n          ys.step();\n        } else {\n          break;\n        }\n      } while (order === 0);\n      if (order !== 0) {\n        return order;\n      } else if (xs.isEmpty() && !ys.isEmpty()) {\n        return -1;\n      } else if (!xs.isEmpty() && ys.isEmpty()) {\n        return 1;\n      } else {\n        return 0;\n      }\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Record) {\n      const xs = this.iterator();\n      const ys = that.iterator();\n      while (!xs.isEmpty() && !ys.isEmpty()) {\n        if (!xs.head().equivalentTo(ys.head(), epsilon)) {\n          return false;\n        }\n        xs.step();\n        ys.step();\n      }\n      return xs.isEmpty() && ys.isEmpty();\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Record) {\n      const xs = this.iterator();\n      const ys = that.iterator();\n      while (!xs.isEmpty() && !ys.isEmpty()) {\n        if (!xs.head().equals(ys.head())) {\n          return false;\n        }\n        xs.step();\n        ys.step();\n      }\n      return xs.isEmpty() && ys.isEmpty();\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    let hashValue = Constructors.hash(Record);\n    this.forEach(function (item: Item): void {\n      hashValue = Murmur3.mix(hashValue, item.hashCode());\n    }, this);\n    return hashValue;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Record\").write(46/*'.'*/);\n    if (this.isEmpty()) {\n      output = output.write(\"empty\").write(40/*'('*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"of\").write(40/*'('*/);\n      this.forEach(function (item: Item, index: number): void {\n        if (index !== 0) {\n          output = output.write(44/*','*/).write(32/*' '*/);\n        }\n        output = output.display(item);\n      }, this);\n      output = output.write(41/*')'*/);\n    }\n    return output;\n  }\n\n  /** @internal */\n  static readonly AliasedFlag: number = 1;\n  /** @internal */\n  static readonly ImmutableFlag: number = 2;\n\n  static override empty(): Record {\n    return RecordMap.empty();\n  }\n\n  static create(initialCapacity?: number): Record {\n    return RecordMap.create(initialCapacity);\n  }\n\n  static of(...items: AnyItem[]): Record {\n    return RecordMap.of(...items);\n  }\n\n  static override fromAny(value: AnyRecord): Record {\n    if (value instanceof Record) {\n      return value;\n    } else if (Array.isArray(value)) {\n      return Record.fromArray(value);\n    } else if (typeof value === \"object\" && value !== null) {\n      return Record.fromObject(value as {[key: string]: AnyValue});\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static fromArray(array: {[index: number]: AnyItem, length?: number}): Record {\n    const n = array.length || 0;\n    const record = Record.create(n);\n    for (let i = 0; i < n; i += 1) {\n      record.push(Item.fromAny(array[i]));\n    }\n    return record;\n  }\n\n  static fromObject(object: {[key: string]: AnyValue}): Record {\n    const record = Record.create();\n    for (const key in object) {\n      const value = object[key];\n      if (key.charCodeAt(0) === 36/*'$'*/) {\n        if (!value || typeof value !== \"object\" || !Object.prototype.hasOwnProperty.call(value, \"$key\")) {\n          record.push(Value.fromAny(value));\n        } else {\n          record.push(Field.of((value as any).$key, (value as any).$value));\n        }\n      } else {\n        record.push(Field.of(key, value));\n      }\n    }\n    return record;\n  }\n\n  /** @internal */\n  static expand(n: number): number {\n    n = Math.max(8, n) - 1;\n    n |= n >> 1; n |= n >> 2; n |= n >> 4; n |= n >> 8; n |= n >> 16;\n    return n + 1;\n  }\n}\nObject.defineProperty(Record.prototype, \"fieldCount\", {\n  get(this: Record): number {\n    let count = 0;\n    this.forEach(function (member: Item): void {\n      if (member instanceof Field) {\n        count += 1;\n      }\n    }, this);\n    return count;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport type {Item} from \"./Item\";\nimport {Field} from \"./Field\";\nimport {Value} from \"./Value\";\nimport {Record} from \"./Record\";\n\n/** @internal */\nexport class ValueBuilder implements Builder<Item, Value> {\n  /** @internal */\n  record: Record | null;\n  /** @internal */\n  value: Value | null;\n\n  constructor() {\n    this.record = null;\n    this.value = null;\n  }\n\n  push(...items: Item[]): void {\n    for (let i = 0, n = items.length; i < n; i += 1) {\n      const item = items[i]!;\n      if (item instanceof Field) {\n        return this.pushField(item);\n      } else if (item instanceof Value) {\n        return this.pushValue(item);\n      } else {\n        throw new TypeError(\"\" + item);\n      }\n    }\n  }\n\n  /** @internal */\n  pushField(item: Field): void {\n    if (this.record === null) {\n      this.record = Record.create();\n      if (this.value !== null) {\n        this.record.push(this.value);\n        this.value = null;\n      }\n    }\n    this.record.push(item);\n  }\n\n  /** @internal */\n  pushValue(item: Value): void {\n    if (this.record !== null) {\n      this.record.push(item);\n    } else if (this.value === null) {\n      this.value = item;\n    } else {\n      this.record = Record.create();\n      this.record.push(this.value);\n      this.value = null;\n      this.record.push(item);\n    }\n  }\n\n  bind(): Value {\n    if (this.record !== null) {\n      return this.record;\n    } else if (this.value !== null) {\n      return this.value;\n    } else {\n      return Value.absent();\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Item} from \"./Item\";\nimport {Record} from \"./Record\";\n\n/** @internal */\nexport interface RecordInterpolator extends Interpolator<Record> {\n  /** @internal */\n  readonly interpolators: ReadonlyArray<Interpolator<Item>>;\n\n  readonly 0: Record;\n\n  readonly 1: Record;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const RecordInterpolator = (function (_super: typeof Interpolator) {\n  const RecordInterpolator = function (y0: Record, y1: Record): RecordInterpolator {\n    const interpolator = function (u: number): Record {\n      const interpolators = interpolator.interpolators;\n      const interpolatorCount = interpolators.length;\n      const record = Record.create(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        record.push(interpolators[i]!(u));\n      }\n      return record;\n    } as RecordInterpolator;\n    Object.setPrototypeOf(interpolator, RecordInterpolator.prototype);\n    const interpolatorCount = Math.min(y0.length, y1.length);\n    const interpolators = new Array<Interpolator<Item>>(interpolatorCount);\n    for (let i = 0; i < interpolatorCount; i += 1) {\n      interpolators[i] = y0.getItem(i)!.interpolateTo(y1.getItem(i)!);\n    }\n    (interpolator as Mutable<typeof interpolator>).interpolators = interpolators;\n    return interpolator;\n  } as {\n    (y0: Record, y1: Record): RecordInterpolator;\n\n    /** @internal */\n    prototype: RecordInterpolator;\n  };\n\n  RecordInterpolator.prototype = Object.create(_super.prototype);\n  RecordInterpolator.prototype.constructor = RecordInterpolator;\n\n  Object.defineProperty(RecordInterpolator.prototype, 0, {\n    get(this: RecordInterpolator): Record {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const record = Record.create(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        record.push(interpolators[i]![0]);\n      }\n      return record;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(RecordInterpolator.prototype, 1, {\n    get(this: RecordInterpolator): Record {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const record = Record.create(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        record.push(interpolators[i]![1]);\n      }\n      return record;\n    },\n    configurable: true,\n  });\n\n  RecordInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof RecordInterpolator) {\n      const n = this.interpolators.length;\n      if (n === that.interpolators.length) {\n        for (let i = 0; i < n; i += 1) {\n          if (!this.interpolators[i]!.equals(that.interpolators[i]!)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n\n  return RecordInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Cursor} from \"@swim/util\";\nimport type {Item} from \"./Item\";\nimport type {Record} from \"./Record\";\n\n/** @internal */\nexport class RecordCursor extends Cursor<Item> {\n  constructor(record: Record, lower?: number, upper?: number, index?: number) {\n    super();\n    if (lower === void 0) {\n      lower = 0;\n    }\n    if (upper === void 0) {\n      upper = record.length;\n    }\n    if (index === void 0) {\n      index = lower;\n    }\n    this.record = record;\n    this.lower = lower;\n    this.upper = upper;\n    this.index = index;\n    this.direction = 0;\n  }\n\n  /** @internal */\n  readonly record: Record;\n\n  /** @internal */\n  readonly lower: number;\n\n  /** @internal */\n  readonly upper: number;\n\n  /** @internal */\n  readonly index: number;\n\n  /** @internal */\n  readonly direction: number;\n\n  override isEmpty(): boolean {\n    return this.index >= this.upper;\n  }\n\n  override head(): Item {\n    (this as Mutable<this>).direction = 0;\n    if (this.index < this.upper) {\n      return this.record.getItem(this.index);\n    } else {\n      throw new Error(\"empty\");\n    }\n  }\n\n  override step(): void {\n    (this as Mutable<this>).direction = 0;\n    const index = this.index;\n    if (index < this.upper) {\n      (this as Mutable<this>).index = index + 1;\n    } else {\n      throw new Error(\"empty\");\n    }\n  }\n\n  override skip(count: number): void {\n    (this as Mutable<this>).index = Math.min(Math.max(this.lower, this.index + count, this.upper));\n  }\n\n  override hasNext(): boolean {\n    return this.index < this.upper;\n  }\n\n  override nextIndex(): number {\n    return this.index - this.lower;\n  }\n\n  override next(): {value?: Item, done: boolean} {\n    (this as Mutable<this>).direction = 1;\n    const index = this.index;\n    if (index < this.upper) {\n      (this as Mutable<this>).index = index + 1;\n      return {value: this.record.getItem(index), done: this.index === this.upper};\n    } else {\n      (this as Mutable<this>).index = this.upper;\n      return {done: true};\n    }\n  }\n\n  override hasPrevious(): boolean {\n    return this.index > this.lower;\n  }\n\n  override previousIndex(): number {\n    return this.index - this.lower - 1;\n  }\n\n  override previous(): {value?: Item, done: boolean} {\n    (this as Mutable<this>).direction = -1;\n    const index = this.index - 1;\n    if (index >= this.lower) {\n      (this as Mutable<this>).index = index;\n      return {value: this.record.getItem(index), done: index === this.lower};\n    } else {\n      (this as Mutable<this>).index = 0;\n      return {done: true};\n    }\n  }\n\n  override set(newItem: Item): void {\n    if (this.direction > 0) {\n      this.record.setItem(this.index - 1, newItem);\n    } else {\n      this.record.setItem(this.index, newItem);\n    }\n  }\n\n  override delete(): void {\n    let index = this.index;\n    if (this.direction > 0) {\n      index -= 1;\n      (this as Mutable<this>).index = index;\n    }\n    this.record.splice(index, 1);\n    (this as Mutable<this>).direction = 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Mutable} from \"@swim/util\";\nimport {AnyItem, Item} from \"./Item\";\nimport {Field} from \"./Field\";\nimport {Attr} from \"./Attr\";\nimport {Slot} from \"./Slot\";\nimport {AnyValue, Value} from \"./Value\";\nimport {Record} from \"./Record\";\nimport {RecordMapView} from \"./\"; // forward import\nimport {AnyText, Text} from \"./\"; // forward import\nimport {AnyNum, Num} from \"./\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"./\"; // forward import\n\n/** @internal */\nexport class RecordMap extends Record {\n  constructor(array: Array<Item> | null, table: Array<Field> | null,\n              length: number, fieldCount: number, flags: number) {\n    super();\n    this.array = array;\n    this.table = table;\n    Object.defineProperty(this, \"length\", {\n      value: length,\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    })\n    Object.defineProperty(this, \"fieldCount\", {\n      value: fieldCount,\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    })\n    this.flags = flags;\n  }\n\n  /** @internal */\n  readonly array: Array<Item> | null;\n\n  /** @internal */\n  readonly table: Array<Field> | null;\n\n  override isEmpty(): boolean {\n    return this.length === 0;\n  }\n\n  override readonly length!: number;\n\n  override readonly fieldCount!: number;\n\n  override get valueCount(): number {\n    return this.length - this.fieldCount;\n  }\n\n  /** @internal */\n  readonly flags: number;\n\n  override isConstant(): boolean {\n    const array = this.array;\n    for (let i = 0, n = this.length; i < n; i += 1) {\n      if (!array![i]!.isConstant()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override get tag(): string | undefined {\n    if (this.fieldCount > 0) {\n      const head = this.array![0];\n      if (head instanceof Attr) {\n        return head.key.value;\n      }\n    }\n    return void 0;\n  }\n\n  override get target(): Value {\n    let value: Value | undefined;\n    let record: Record | undefined;\n    let modified = false;\n    const array = this.array!;\n    for (let i = 0, n = this.length; i < n; i += 1) {\n      const item = array[i];\n      if (item instanceof Attr) {\n        modified = true;\n      } else if (value === void 0 && item instanceof Value) {\n        value = item;\n      } else {\n        if (record === void 0) {\n          record = Record.create();\n          if (value !== void 0) {\n            record.push(value);\n          }\n        }\n        record.push(item);\n      }\n    }\n    if (value === void 0) {\n      return Value.extant();\n    } else if (record === void 0) {\n      return value;\n    } else if (modified) {\n      return record;\n    } else {\n      return this;\n    }\n  }\n\n  override head(): Item {\n    if (this.length > 0) {\n      return this.array![0]!;\n    }\n    return Item.absent();\n  }\n\n  override tail(): Record {\n    const n = this.length;\n    if (n > 0) {\n      return new RecordMapView(this, 1, n);\n    } else {\n      return Record.empty();\n    }\n  }\n\n  override body(): Value {\n    const n = this.length;\n    if (n > 2) {\n      return new RecordMapView(this, 1, n).branch();\n    } else if (n === 2) {\n      const item = this.array![1];\n      if (item instanceof Value) {\n        return item;\n      } else {\n        return Record.of(item);\n      }\n    }\n    return Value.absent();\n  }\n\n  override has(key: AnyValue): boolean {\n    if (this.fieldCount !== 0) {\n      key = Value.fromAny(key);\n      const table = this.hashTable()!;\n      const n = table.length;\n      //assert(n > 0);\n      const x = Math.abs(key.hashCode() % n);\n      let i = x;\n      do {\n        const field = table[i];\n        if (field !== void 0) {\n          if (field.key.equals(key)) {\n            return true;\n          }\n        } else {\n          break;\n        }\n        i = (i + 1) % n;\n      } while (i !== x);\n    }\n    return false;\n  }\n\n  override indexOf(item: AnyItem, index: number = 0): number {\n    item = Item.fromAny(item);\n    const array = this.array!;\n    const n = this.length;\n    if (index < 0) {\n      index = Math.max(0, n + index);\n    }\n    while (index < n) {\n      if (item.equals(array[index])) {\n        return index;\n      }\n      index += 1;\n    }\n    return -1;\n  }\n\n  override lastIndexOf(item: AnyItem, index?: number): number {\n    item = Item.fromAny(item);\n    const array = this.array!;\n    const n = this.length;\n    if (index === void 0) {\n      index = n - 1;\n    } else if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(index, n - 1);\n    while (index >= 0) {\n      if (item.equals(array[index])) {\n        return index;\n      }\n      index -= 1;\n    }\n    return -1;\n  }\n\n  override get(key: AnyValue): Value {\n    if (this.fieldCount > 0) {\n      key = Value.fromAny(key);\n      const table = this.hashTable()!;\n      const n = table.length;\n      //assert(n > 0);\n      const x = Math.abs(key.hashCode() % n);\n      let i = x;\n      do {\n        const field = table[i];\n        if (field !== void 0) {\n          if (field.key.equals(key)) {\n            return field.value;\n          }\n        } else {\n          break;\n        }\n        i = (i + 1) % n;\n      } while (i !== x);\n    }\n    return Value.absent();\n  }\n\n  override getAttr(key: AnyText): Value {\n    if (this.fieldCount > 0) {\n      key = Text.fromAny(key);\n      const table = this.hashTable()!;\n      const n = table.length;\n      //assert(n > 0);\n      const x = Math.abs(key.hashCode() % n);\n      let i = x;\n      do {\n        const field = table[i];\n        if (field !== void 0) {\n          if (field instanceof Attr && field.key.equals(key)) {\n            return field.value;\n          }\n        } else {\n          break;\n        }\n        i = (i + 1) % n;\n      } while (i !== x);\n    }\n    return Value.absent();\n  }\n\n  override getSlot(key: AnyValue): Value {\n    if (this.fieldCount > 0) {\n      key = Value.fromAny(key);\n      const table = this.hashTable()!;\n      const n = table.length;\n      //assert(n > 0);\n      const x = Math.abs(key.hashCode() % n);\n      let i = x;\n      do {\n        const field = table[i];\n        if (field !== void 0) {\n          if (field instanceof Slot && field.key.equals(key)) {\n            return field.value;\n          }\n        } else {\n          break;\n        }\n        i = (i + 1) % n;\n      } while (i !== x);\n    }\n    return Value.absent();\n  }\n\n  override getField(key: AnyValue): Field | undefined {\n    if (this.fieldCount > 0) {\n      key = Value.fromAny(key);\n      const table = this.hashTable()!;\n      const n = table.length;\n      //assert(n > 0);\n      const x = Math.abs(key.hashCode() % n);\n      let i = x;\n      do {\n        const field = table[i];\n        if (field !== void 0) {\n          if (field.key.equals(key)) {\n            return field;\n          }\n        } else {\n          break;\n        }\n        i = (i + 1) % n;\n      } while (i !== x);\n    }\n    return void 0;\n  }\n\n  override getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    if (index >= 0 && index < n) {\n      return this.array![index]!;\n    } else {\n      return Item.absent();\n    }\n  }\n\n  override set(key: AnyValue, newValue: Value): this {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    key = Value.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      if (this.fieldCount > 0) {\n        this.setAliased(key, newValue);\n      } else {\n        this.pushAliased(new Slot(key, newValue));\n      }\n    } else {\n      if (this.fieldCount > 0) {\n        if (this.table !== null) {\n          this.setMutable(key, newValue);\n        } else {\n          this.updateMutable(key, newValue);\n        }\n      } else {\n        this.pushMutable(new Slot(key, newValue));\n      }\n    }\n    return this;\n  }\n\n  /** @internal */\n  setAliased(key: Value, newValue: Value): void {\n    const n = this.length;\n    const oldArray = this.array!;\n    const newArray = new Array(Record.expand(n + 1));\n    for (let i = 0; i < n; i += 1) {\n      const item = oldArray[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        newArray[i] = item.updatedValue(newValue);\n        i += 1;\n        while (i < n) {\n          newArray[i] = oldArray[i];\n          i += 1;\n        }\n        (this as Mutable<this>).array = newArray;\n        (this as Mutable<this>).table = null;\n        (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n        return;\n      }\n      newArray[i] = item;\n    }\n    newArray[n] = new Slot(key, newValue);\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).table = null;\n    (this as Mutable<this>).length = n + 1;\n    (this as Mutable<this>).fieldCount += 1;\n    (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n  }\n\n  /** @internal */\n  setMutable(key: Value, newValue: Value): void {\n    const table = this.table!;\n    const n = table.length;\n    //assert(n > 0);\n    const x = Math.abs(key.hashCode() % n);\n    let i = x;\n    do {\n      const field = table[i];\n      if (field !== void 0) {\n        if (field.key.equals(key)) {\n          if (field.isMutable()) {\n            field.setValue(newValue);\n            return;\n          } else {\n            this.updateMutable(key, newValue);\n            return;\n          }\n        }\n      } else {\n        break;\n      }\n      i = (i + 1) % n;\n    } while (i !== x);\n    const field = new Slot(key, newValue);\n    this.pushMutable(field);\n    RecordMap.put(table, field);\n  }\n\n  /** @internal */\n  updateMutable(key: Value, newValue: Value): void {\n    const array = this.array!;\n    for (let i = 0, n = this.length; i < n; i += 1) {\n      const item = array[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        array[i] = item.updatedValue(newValue);\n        (this as Mutable<this>).table = null;\n        return;\n      }\n    }\n    const field = new Slot(key, newValue);\n    this.pushMutable(field);\n    RecordMap.put(this.table, field);\n  }\n\n  override setAttr(key: AnyText, newValue: Value): this {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    key = Text.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      if (this.fieldCount > 0) {\n        this.setAttrAliased(key, newValue);\n      } else {\n        this.pushAliased(new Attr(key, newValue));\n      }\n    } else {\n      if (this.fieldCount > 0) {\n        if (this.table !== null) {\n          this.setAttrMutable(key, newValue);\n        } else {\n          this.updateAttrMutable(key, newValue);\n        }\n      } else {\n        this.pushMutable(new Attr(key, newValue));\n      }\n    }\n    return this;\n  }\n\n  /** @internal */\n  setAttrAliased(key: Text, newValue: Value): void {\n    const n = this.length;\n    const oldArray = this.array!;\n    const newArray = new Array(Record.expand(n + 1));\n    for (let i = 0; i < n; i += 1) {\n      const item = oldArray[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        newArray[i] = new Attr(key, newValue);\n        i += 1;\n        while (i < n) {\n          newArray[i] = oldArray[i];\n          i += 1;\n        }\n        (this as Mutable<this>).array = newArray;\n        (this as Mutable<this>).table = null;\n        (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n        return;\n      }\n      newArray[i] = item;\n    }\n    newArray[n] = new Attr(key, newValue);\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).table = null;\n    (this as Mutable<this>).length = n + 1;\n    (this as Mutable<this>).fieldCount += 1;\n    (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n  }\n\n  /** @internal */\n  setAttrMutable(key: Text, newValue: Value): void {\n    const table = this.table!;\n    const n = table.length;\n    //assert(n > 0);\n    const x = Math.abs(key.hashCode() % n);\n    let i = x;\n    do {\n      const field = table[i];\n      if (field !== void 0) {\n        if (field.key.equals(key)) {\n          if (field instanceof Attr && field.isMutable()) {\n            field.setValue(newValue);\n          } else {\n            this.updateAttrMutable(key, newValue);\n          }\n          return;\n        }\n      } else {\n        break;\n      }\n      i = (i + 1) % n;\n    } while (i !== x);\n    const field = new Attr(key, newValue);\n    this.push(field);\n    RecordMap.put(table, field);\n  }\n\n  /** @internal */\n  updateAttrMutable(key: Text, newValue: Value): void {\n    const array = this.array!;\n    for (let i = 0, n = this.length; i < n; i += 1) {\n      const item = array[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        array[i] = new Attr(key, newValue);\n        (this as Mutable<this>).table = null;\n        return;\n      }\n    }\n    const field = new Attr(key, newValue);\n    this.push(field);\n    RecordMap.put(this.table, field);\n  }\n\n  override setSlot(key: AnyValue, newValue: Value): this {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    key = Value.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      if (this.fieldCount > 0) {\n        this.setSlotAliased(key, newValue);\n      } else {\n        this.pushAliased(new Slot(key, newValue));\n      }\n    } else {\n      if (this.fieldCount > 0) {\n        if (this.table !== null) {\n          this.setSlotMutable(key, newValue);\n        } else {\n          this.updateSlotMutable(key, newValue);\n        }\n      } else {\n        this.pushMutable(new Slot(key, newValue));\n      }\n    }\n    return this;\n  }\n\n  /** @internal */\n  setSlotAliased(key: Value, newValue: Value): void {\n    const n = this.length;\n    const oldArray = this.array!;\n    const newArray = new Array(Record.expand(n + 1));\n    for (let i = 0; i < n; i += 1) {\n      const item = oldArray[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        newArray[i] = new Slot(key, newValue);\n        i += 1;\n        while (i < n) {\n          newArray[i] = oldArray[i];\n          i += 1;\n        }\n        (this as Mutable<this>).array = newArray;\n        (this as Mutable<this>).table = null;\n        (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n        return;\n      }\n      newArray[i] = item;\n    }\n    newArray[n] = new Slot(key, newValue);\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).table = null;\n    (this as Mutable<this>).length = n + 1;\n    (this as Mutable<this>).fieldCount += 1;\n    (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n  }\n\n  /** @internal */\n  setSlotMutable(key: Value, newValue: Value): void {\n    const table = this.table!;\n    const n = table.length;\n    //assert(n > 0);\n    const x = Math.abs(key.hashCode() % n);\n    let i = x;\n    do {\n      const field = table[i];\n      if (field !== void 0) {\n        if (field.key.equals(key)) {\n          if (field instanceof Slot && field.isMutable()) {\n            field.setValue(newValue);\n          } else {\n            this.updateSlotMutable(key, newValue);\n          }\n          return;\n        }\n      } else {\n        break;\n      }\n      i = (i + 1) % n;\n    } while (i !== x);\n    const field = new Slot(key, newValue);\n    this.push(field);\n    RecordMap.put(table, field);\n  }\n\n  /** @internal */\n  updateSlotMutable(key: Value, newValue: Value): void {\n    const array = this.array!;\n    for (let i = 0, n = this.length; i < n; i += 1) {\n      const item = array[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        array[i] = new Slot(key, newValue);\n        (this as Mutable<this>).table = null;\n        return;\n      }\n    }\n    const field = new Slot(key, newValue);\n    this.push(field);\n    RecordMap.put(this.table, field);\n  }\n\n  override setItem(index: number, newItem: AnyItem): this {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    newItem = Item.fromAny(newItem);\n    const n = this.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    if (index < 0 || index > n) {\n      throw new RangeError(\"\" + index);\n    }\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      this.setItemAliased(index, newItem);\n    } else {\n      this.setItemMutable(index, newItem);\n    }\n    return this;\n  }\n\n  /** @internal */\n  setItemAliased(index: number, newItem: Item): void {\n    const n = this.length;\n    const oldArray = this.array!;\n    const newArray = new Array(Record.expand(n));\n    for (let i = 0; i < n; i += 1) {\n      newArray[i] = oldArray[i];\n    }\n    const oldItem = oldArray[index];\n    newArray[index] = newItem;\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).table = null;\n    if (newItem instanceof Field) {\n      if (!(oldItem instanceof Field)) {\n        (this as Mutable<this>).fieldCount += 1;\n      }\n    } else if (oldItem instanceof Field) {\n      (this as Mutable<this>).fieldCount -= 1;\n    }\n    (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n  }\n\n  /** @internal */\n  setItemMutable(index: number, newItem: Item): void {\n    const array = this.array!;\n    const oldItem = array[index];\n    array[index] = newItem;\n    if (newItem instanceof Field) {\n      (this as Mutable<this>).table = null;\n      if (!(oldItem instanceof Field)) {\n        (this as Mutable<this>).fieldCount += 1;\n      }\n    } else if (oldItem instanceof Field) {\n      (this as Mutable<this>).table = null;\n      (this as Mutable<this>).fieldCount -= 1;\n    }\n  }\n\n  override updated(key: AnyValue, newValue: AnyValue): Record {\n    key = Value.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    const record = (this.flags & Record.ImmutableFlag) === 0 ? this : this.branch();\n    if ((record.flags & Record.AliasedFlag) !== 0) {\n      if (record.fieldCount > 0) {\n        record.setAliased(key, newValue);\n      } else {\n        record.pushAliased(new Slot(key, newValue));\n      }\n    } else {\n      if (record.fieldCount > 0) {\n        if (record.table !== null) {\n          record.setMutable(key, newValue);\n        } else {\n          record.updateMutable(key, newValue);\n        }\n      } else {\n        record.pushMutable(new Slot(key, newValue));\n      }\n    }\n    return record;\n  }\n\n  override updatedAttr(key: AnyText, newValue: AnyValue): Record {\n    key = Text.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    const record = (this.flags & Record.ImmutableFlag) === 0 ? this : this.branch();\n    if ((record.flags & Record.AliasedFlag) !== 0) {\n      if (record.fieldCount > 0) {\n        record.setAttrAliased(key, newValue);\n      } else {\n        record.pushAliased(new Attr(key, newValue));\n      }\n    } else {\n      if (record.fieldCount > 0) {\n        if (record.table !== null) {\n          record.setAttrMutable(key, newValue);\n        } else {\n          record.updateAttrMutable(key, newValue);\n        }\n      } else {\n        record.pushMutable(new Attr(key, newValue));\n      }\n    }\n    return record;\n  }\n\n  override updatedSlot(key: AnyValue, newValue: AnyValue): Record {\n    key = Value.fromAny(key);\n    newValue = Value.fromAny(newValue);\n    const record = (this.flags & Record.ImmutableFlag) === 0 ? this : this.branch();\n    if ((record.flags & Record.AliasedFlag) !== 0) {\n      if (record.fieldCount > 0) {\n        record.setSlotAliased(key, newValue);\n      } else {\n        record.pushAliased(new Slot(key, newValue));\n      }\n    } else {\n      if (record.fieldCount > 0) {\n        if (record.table !== null) {\n          record.setSlotMutable(key, newValue);\n        } else {\n          record.updateSlotMutable(key, newValue);\n        }\n      } else {\n        record.pushMutable(new Slot(key, newValue));\n      }\n    }\n    return record;\n  }\n\n  override push(...newItems: AnyItem[]): number {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      this.pushAliased(...newItems);\n    } else {\n      this.pushMutable(...newItems);\n    }\n    return this.length;\n  }\n\n  /** @internal */\n  pushAliased(...newItems: AnyItem[]): void {\n    const k = newItems.length;\n    let m = this.length;\n    let n = this.fieldCount;\n    const oldArray = this.array;\n    const newArray = new Array(Record.expand(m + k));\n    if (oldArray !== null) {\n      for (let i = 0; i < m; i += 1) {\n        newArray[i] = oldArray[i];\n      }\n    }\n    for (let i = 0; i < k; i += 1) {\n      const newItem = Item.fromAny(newItems[i]);\n      newArray[m] = newItem;\n      m += 1;\n      if (newItem instanceof Field) {\n        n += 1;\n      }\n    }\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).table = null;\n    (this as Mutable<this>).length = m;\n    (this as Mutable<this>).fieldCount = n;\n    (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n  }\n\n  /** @internal */\n  pushMutable(...newItems: AnyItem[]): void {\n    const k = newItems.length;\n    let m = this.length;\n    let n = this.fieldCount;\n    const oldArray = this.array;\n    let newArray;\n    if (oldArray === null || m + k > oldArray.length) {\n      newArray = new Array(Record.expand(m + k));\n      if (oldArray !== null) {\n        for (let i = 0; i < m; i += 1) {\n          newArray[i] = oldArray[i];\n        }\n      }\n    } else {\n      newArray = oldArray;\n    }\n    for (let i = 0; i < k; i += 1) {\n      const newItem = Item.fromAny(newItems[i]);\n      newArray[m] = newItem;\n      m += 1;\n      if (newItem instanceof Field) {\n        n += 1;\n        (this as Mutable<this>).table = null;\n      }\n    }\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).length = m;\n    (this as Mutable<this>).fieldCount = n;\n  }\n\n  splice(start: number, deleteCount: number = 0, ...newItems: AnyItem[]): Item[] {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    const n = this.length;\n    if (start < 0) {\n      start = n + start;\n    }\n    start = Math.min(Math.max(0, start), n);\n    deleteCount = Math.min(Math.max(0, deleteCount), n - start);\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      return this.spliceAliased(start, deleteCount, ...newItems);\n    } else {\n      return this.spliceMutable(start, deleteCount, ...newItems);\n    }\n  }\n\n  /** @internal */\n  spliceAliased(start: number, deleteCount: number, ...newItems: AnyItem[]): Item[] {\n    const k = newItems.length;\n    let m = this.length;\n    let n = this.fieldCount;\n    const oldArray = this.array!;\n    const newArray = new Array(Record.expand(m - deleteCount + k));\n    for (let i = 0; i < start; i += 1) {\n      newArray[i] = oldArray[i];\n    }\n    const oldItems: Item[] = [];\n    for (let i = start; i < start + deleteCount; i += 1) {\n      const oldItem = oldArray[i]!;\n      oldItems.push(oldItem);\n      m -= 1;\n      if (oldItem instanceof Field) {\n        n -= 1;\n      }\n    }\n    for (let i = start; i < m; i += 1) {\n      newArray[i + k] = oldArray[i + deleteCount];\n    }\n    for (let i = 0; i < k; i += 1) {\n      const newItem = Item.fromAny(newItems[i]);\n      newArray[i + start] = newItem;\n      m += 1;\n      if (newItem instanceof Field) {\n        n += 1;\n      }\n    }\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).table = null;\n    (this as Mutable<this>).length = m;\n    (this as Mutable<this>).fieldCount = n;\n    (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n    return oldItems;\n  }\n\n  /** @internal */\n  spliceMutable(start: number, deleteCount: number, ...newItems: AnyItem[]): Item[] {\n    const k = newItems.length;\n    let m = this.length;\n    let n = this.fieldCount;\n    const oldArray = this.array!;\n    let newArray;\n    if (oldArray === null || m - deleteCount + k > oldArray.length) {\n      newArray = new Array(Record.expand(m - deleteCount + k));\n      if (oldArray !== null) {\n        for (let i = 0; i < start; i += 1) {\n          newArray[i] = oldArray[i];\n        }\n      }\n    } else {\n      newArray = oldArray;\n    }\n    const oldItems: Item[] = [];\n    for (let i = start; i < start + deleteCount; i += 1) {\n      const oldItem = oldArray[i]!;\n      oldItems.push(oldItem);\n      m -= 1;\n      if (oldItem instanceof Field) {\n        n -= 1;\n      }\n    }\n    if (k > deleteCount) {\n      for (let i = m - 1; i >= start; i -= 1) {\n        newArray[i + k] = oldArray[i + deleteCount];\n      }\n    } else {\n      for (let i = start; i < m; i += 1) {\n        newArray[i + k] = oldArray[i + deleteCount];\n      }\n    }\n    for (let i = 0; i < k; i += 1) {\n      const newItem = Item.fromAny(newItems[i]);\n      newArray[i + start] = newItem;\n      m += 1;\n      if (newItem instanceof Field) {\n        n += 1;\n      }\n    }\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).length = m;\n    (this as Mutable<this>).fieldCount = n;\n    return oldItems;\n  }\n\n  override delete(key: AnyValue): Item {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    key = Value.fromAny(key);\n    if ((this.flags & Record.AliasedFlag) !== 0) {\n      return this.deleteAliased(key);\n    } else {\n      return this.deleteMutable(key);\n    }\n  }\n\n  /** @internal */\n  deleteAliased(key: Value): Item {\n    const n = this.length;\n    const oldArray = this.array!;\n    const newArray = new Array(Record.expand(n));\n    for (let i = 0; i < n; i += 1) {\n      const item = oldArray[i];\n      if (item instanceof Field && item.key.equals(key)) {\n        for (let j = i + 1; j < n; j += 1, i += 1) {\n          newArray[i] = oldArray[j];\n        }\n        (this as Mutable<this>).array = newArray;\n        (this as Mutable<this>).table = null;\n        (this as Mutable<this>).length = n - 1;\n        (this as Mutable<this>).fieldCount -= 1;\n        (this as Mutable<this>).flags &= ~Record.AliasedFlag;\n        return item;\n      }\n      newArray[i] = item;\n    }\n    return Item.absent();\n  }\n\n  /** @internal */\n  deleteMutable(key: Value): Item {\n    const n = this.length;\n    const array = this.array!;\n    for (let i = 0; i < n; i += 1) {\n      const item = array[i]!;\n      if (item instanceof Field && item.key.equals(key)) {\n        for (let j = i + 1; j < n; j += 1, i += 1) {\n          array[i] = array[j]!;\n        }\n        array[n - 1] = void 0 as unknown as Item;\n        (this as Mutable<this>).table = null;\n        (this as Mutable<this>).length = n - 1;\n        (this as Mutable<this>).fieldCount -= 1;\n        return item;\n      }\n    }\n    return Item.absent();\n  }\n\n  override clear(): void {\n    if ((this.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    (this as Mutable<this>).array = null;\n    (this as Mutable<this>).table = null;\n    (this as Mutable<this>).length = 0;\n    (this as Mutable<this>).fieldCount = 0;\n    (this as Mutable<this>).flags = 0;\n  }\n\n  override isAliased(): boolean {\n    return (this.flags & Record.AliasedFlag) !== 0;\n  }\n\n  override isMutable(): boolean {\n    return (this.flags & Record.ImmutableFlag) === 0;\n  }\n\n  override alias(): void {\n    (this as Mutable<this>).flags |= Record.AliasedFlag;\n  }\n\n  override branch(): RecordMap {\n    if ((this.flags & (Record.AliasedFlag | Record.ImmutableFlag)) === 0) {\n      const array = this.array!;\n      for (let i = 0, n = this.length; i < n; i += 1) {\n        array[i]!.alias();\n      }\n    }\n    (this as Mutable<this>).flags |= Record.AliasedFlag;\n    return new RecordMap(this.array, this.table, this.length, this.fieldCount, Record.AliasedFlag);\n  }\n\n  override clone(): RecordMap {\n    const itemCount = this.length;\n    const oldArray = this.array!;\n    const newArray = new Array(itemCount);\n    for (let i = 0; i < itemCount; i += 1) {\n      newArray[i] = oldArray[i]!.clone();\n    }\n    return new RecordMap(newArray, null, itemCount, this.fieldCount, 0);\n  }\n\n  override commit(): this {\n    if ((this.flags & Record.ImmutableFlag) === 0) {\n      (this as Mutable<this>).flags |= Record.ImmutableFlag;\n      const array = this.array!;\n      for (let i = 0, n = this.length; i < n; i += 1) {\n        array[i]!.commit();\n      }\n    }\n    return this;\n  }\n\n  hashTable(): Array<Field> | null {\n    const n = this.fieldCount;\n    let table = this.table;\n    if (n !== 0 && table === null) {\n      table = new Array(Record.expand(Math.max(n, n * 10 / 7)));\n      const array = this.array!;\n      for (let i = 0, m = this.length; i < m; i += 1) {\n        const item = array[i];\n        if (item instanceof Field) {\n          RecordMap.put(table, item);\n        }\n      }\n      (this as Mutable<this>).table = table;\n    }\n    return table;\n  }\n\n  /** @internal */\n  static put(table: Field[] | null, field: Field): void {\n    if (table !== null) {\n      const n = table.length;\n      const x = Math.abs(field.key.hashCode() % n);\n      let i = x;\n      do {\n        const item = table[i];\n        if (item !== void 0) {\n          if (field.key.equals(item.key)) {\n            table[i] = field;\n            return;\n          }\n        } else {\n          table[i] = field;\n          return;\n        }\n        i = (i + 1) % n;\n      } while (i !== x);\n      throw new Error();\n    }\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Record {\n    interpreter = Interpreter.fromAny(interpreter);\n    const array = this.array!;\n    const n = this.length;\n    const scope = Record.create(n);\n    interpreter.pushScope(scope);\n    let changed = false;\n    for (let i = 0; i < n; i += 1) {\n      const oldItem = array[i]!;\n      const newItem = oldItem.evaluate(interpreter);\n      if (newItem.isDefined()) {\n        scope.push(newItem);\n      }\n      if (oldItem !== newItem) {\n        changed = true;\n      }\n    }\n    interpreter.popScope();\n    return changed ? scope : this;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Record {\n    interpreter = Interpreter.fromAny(interpreter);\n    const array = this.array!;\n    const n = this.length;\n    const scope = Record.create(n);\n    interpreter.pushScope(scope);\n    let changed = false;\n    for (let i = 0; i < n; i += 1) {\n      const oldItem = array[i]!;\n      const newItem = oldItem.substitute(interpreter);\n      if (newItem.isDefined()) {\n        scope.push(newItem);\n      }\n      if (oldItem !== newItem) {\n        changed = true;\n      }\n    }\n    interpreter.popScope();\n    return changed ? scope : this;\n  }\n\n  override subRecord(lower?: number, upper?: number): Record {\n    const n = this.length;\n    if (lower === void 0) {\n      lower = 0;\n    } else if (lower < 0) {\n      lower = n + lower;\n    }\n    if (upper === void 0) {\n      upper = n;\n    } else if (upper < 0) {\n      upper = n + upper;\n    }\n    if (lower < 0 || upper > n || lower > upper) {\n      throw new RangeError(lower + \", \" + upper);\n    }\n    return new RecordMapView(this, lower, upper);\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    const array = this.array!;\n    for (let i = 0, n = this.length; i < n; i += 1) {\n      const result = callback.call(thisArg, array[i]!, i);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  @Lazy\n  static override empty(): RecordMap {\n    return new RecordMap(null, null, 0, 0, Record.AliasedFlag | Record.ImmutableFlag);\n  }\n\n  static override create(initialCapacity?: number): RecordMap {\n    if (initialCapacity === void 0) {\n      return new RecordMap(null, null, 0, 0, Record.AliasedFlag);\n    } else {\n      return new RecordMap(new Array(initialCapacity), null, 0, 0, 0);\n    }\n  }\n\n  static override of(...items: AnyItem[]): RecordMap {\n    const n = items.length;\n    if (n === 0) {\n      return new RecordMap(null, null, 0, 0, Record.AliasedFlag);\n    } else {\n      const array = new Array(n);\n      let itemCount = 0;\n      let fieldCount = 0;\n      for (let i = 0; i < n; i += 1) {\n        const item = Item.fromAny(items[i]);\n        array[i] = item;\n        itemCount += 1;\n        if (item instanceof Field) {\n          fieldCount += 1;\n        }\n      }\n      return new RecordMap(array, null, itemCount, fieldCount, 0);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyItem, Item} from \"./Item\";\nimport {Field} from \"./Field\";\nimport {Attr} from \"./Attr\";\nimport {AnyValue, Value} from \"./Value\";\nimport {Record} from \"./Record\";\nimport {RecordMap} from \"./RecordMap\";\nimport {AnyNum, Num} from \"./\"; // forward import\n\n/** @internal */\nexport class RecordMapView extends Record {\n  constructor(record: RecordMap, lower: number, upper: number) {\n    super();\n    this.record = record;\n    this.lower = lower;\n    this.upper = upper;\n  }\n\n  /** @internal */\n  readonly record: RecordMap;\n\n  /** @internal */\n  readonly lower: number;\n\n  /** @internal */\n  readonly upper: number;\n\n  override isEmpty(): boolean {\n    return this.lower === this.upper;\n  }\n\n  override isArray(): boolean {\n    const array = this.record.array;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      if (array![i] instanceof Field) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override isObject(): boolean {\n    const array = this.record.array;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      if (array![i] instanceof Value) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override get length(): number {\n    return this.upper - this.lower;\n  }\n\n  declare readonly fieldCount: number; // getter defined below to work around useDefineForClassFields lunacy\n\n  override get valueCount(): number {\n    let k = 0;\n    const array = this.record.array;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      if (array![i] instanceof Value) {\n        k += 1;\n      }\n    }\n    return k;\n  }\n\n  override isConstant(): boolean {\n    const array = this.record.array;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      if (!array![i]!.isConstant()) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  override get tag(): string | undefined {\n    if (this.length > 0) {\n      const item = this.record.array![this.lower];\n      if (item instanceof Attr) {\n        return item.key.value;\n      }\n    }\n    return void 0;\n  }\n\n  override get target(): Value {\n    let value: Value | undefined;\n    let record: Record | undefined;\n    let modified = false;\n    const array = this.record.array;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      const item = array![i];\n      if (item instanceof Attr) {\n        modified = true;\n      } else if (value === void 0 && item instanceof Value) {\n        value = item;\n      } else {\n        if (record === void 0) {\n          record = Record.create();\n          if (value !== void 0) {\n            record.push(value);\n          }\n        }\n        record.push(item);\n      }\n    }\n    if (value === void 0) {\n      return Value.extant();\n    } else if (record === void 0) {\n      return value;\n    } else if (modified) {\n      return record;\n    } else {\n      return this;\n    }\n  }\n\n  override head(): Item {\n    if (this.length > 0) {\n      return this.record.array![this.lower]!;\n    } else {\n      return Item.absent();\n    }\n  }\n\n  override tail(): Record {\n    if (this.length > 0) {\n      return new RecordMapView(this.record, this.lower + 1, this.upper);\n    } else {\n      return Record.empty();\n    }\n  }\n\n  override body(): Value {\n    const n = this.length;\n    if (n > 2) {\n      return new RecordMapView(this.record, this.lower + 1, this.upper).branch();\n    } else if (n === 2) {\n      const item = this.record.array![this.lower + 1];\n      if (item instanceof Value) {\n        return item;\n      } else {\n        return Record.of(item);\n      }\n    } else {\n      return Value.absent();\n    }\n  }\n\n  override indexOf(item: AnyItem, index: number = 0): number {\n    item = Item.fromAny(item);\n    const array = this.record.array;\n    const n = this.length;\n    if (index < 0) {\n      index = Math.max(0, n + index);\n    }\n    index = this.lower + index;\n    while (index < this.upper) {\n      if (item.equals(array![index])) {\n        return index - this.lower;\n      }\n      index += 1;\n    }\n    return -1;\n  }\n\n  override lastIndexOf(item: AnyItem, index?: number): number {\n    item = Item.fromAny(item);\n    const array = this.record.array;\n    const n = this.length;\n    if (index === void 0) {\n      index = n - 1;\n    } else if (index < 0) {\n      index = n + index;\n    }\n    index = this.lower + Math.min(index, n - 1);\n    while (index >= this.lower) {\n      if (item.equals(array![index])) {\n        return index - this.lower;\n      }\n      index -= 1;\n    }\n    return -1;\n  }\n\n  override getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    if (index >= 0 && index < n) {\n      return this.record.array![this.lower + index]!;\n    } else {\n      return Item.absent();\n    }\n  }\n\n  override setItem(index: number, newItem: AnyItem): this {\n    if ((this.record.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    newItem = Item.fromAny(newItem);\n    const n = this.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    if (index < 0 || index > n) {\n      throw new RangeError(\"\" + index);\n    }\n    if ((this.record.flags & Record.AliasedFlag) !== 0) {\n      this.setItemAliased(index, newItem);\n    } else {\n      this.setItemMutable(index, newItem);\n    }\n    return this;\n  }\n\n  /** @internal */\n  setItemAliased(index: number, newItem: Item): void {\n    const record = this.record;\n    const n = record.length;\n    const oldArray = record.array;\n    const newArray = new Array(Record.expand(n));\n    for (let i = 0; i < n; i += 1) {\n      newArray[i] = oldArray![i];\n    }\n    const oldItem = oldArray !== null ? oldArray[this.lower + index] : null;\n    newArray[this.lower + index] = newItem;\n    (record as Mutable<RecordMap>).array = newArray;\n    (record as Mutable<RecordMap>).table = null;\n    if (newItem instanceof Field) {\n      if (!(oldItem instanceof Field)) {\n        (record as Mutable<RecordMap>).fieldCount += 1;\n      }\n    } else if (oldItem instanceof Field) {\n      (record as Mutable<RecordMap>).fieldCount -= 1;\n    }\n    (record as Mutable<RecordMap>).flags &= ~Record.AliasedFlag;\n  }\n\n  /** @internal */\n  setItemMutable(index: number, newItem: Item): void {\n    const record = this.record;\n    const array = record.array!;\n    const oldItem = array[this.lower + index];\n    array[this.lower + index] = newItem;\n    if (newItem instanceof Field) {\n      (record as Mutable<RecordMap>).table = null;\n      if (!(oldItem instanceof Field)) {\n        (record as Mutable<RecordMap>).fieldCount += 1;\n      }\n    } else if (oldItem instanceof Field) {\n      (record as Mutable<RecordMap>).table = null;\n      (record as Mutable<RecordMap>).fieldCount -= 1;\n    }\n  }\n\n  override push(...newItems: AnyItem[]): number {\n    if ((this.record.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    if ((this.record.flags & Record.AliasedFlag) !== 0) {\n      this.pushAliased(...newItems);\n    } else {\n      this.pushMutable(...newItems);\n    }\n    return this.length;\n  }\n\n  /** @internal */\n  pushAliased(...newItems: AnyItem[]): void {\n    const record = this.record;\n    const k = newItems.length;\n    let m = record.length;\n    let n = record.fieldCount;\n    const oldArray = record.array;\n    const newArray = new Array(Record.expand(m + k));\n    if (oldArray !== null) {\n      for (let i = 0; i < this.upper; i += 1) {\n        newArray[i] = oldArray[i];\n      }\n      for (let i = this.upper; i < m; i += 1) {\n        newArray[i + k] = oldArray[i];\n      }\n    }\n    for (let i = 0; i < k; i += 1) {\n      const newItem = Item.fromAny(newItems[i]);\n      newArray[i + this.upper] = newItem;\n      m += 1;\n      if (newItem instanceof Field) {\n        n += 1;\n      }\n    }\n    (record as Mutable<RecordMap>).array = newArray;\n    (record as Mutable<RecordMap>).table = null;\n    (record as Mutable<RecordMap>).length = m;\n    (record as Mutable<RecordMap>).fieldCount = n;\n    (record as Mutable<RecordMap>).flags &= ~Record.AliasedFlag;\n    (this as Mutable<this>).upper += k;\n  }\n\n  /** @internal */\n  pushMutable(...newItems: AnyItem[]): void {\n    const record = this.record;\n    const k = newItems.length;\n    let m = record.length;\n    let n = record.fieldCount;\n    const oldArray = record.array!;\n    let newArray;\n    if (oldArray === null || m + k > oldArray.length) {\n      newArray = new Array(Record.expand(m + k));\n      if (oldArray !== null) {\n        for (let i = 0; i < this.upper; i += 1) {\n          newArray[i] = oldArray[i];\n        }\n      }\n    } else {\n      newArray = oldArray;\n    }\n    for (let i = m - 1; i >= this.upper; i -= 1) {\n      newArray[i + k] = oldArray[i];\n    }\n    for (let i = 0; i < k; i += 1) {\n      const newItem = Item.fromAny(newItems[i]);\n      newArray[i + this.upper] = newItem;\n      m += 1;\n      if (newItem instanceof Field) {\n        n += 1;\n        (record as Mutable<RecordMap>).table = null;\n      }\n    }\n    (record as Mutable<RecordMap>).array = newArray;\n    (record as Mutable<RecordMap>).length = m;\n    (record as Mutable<RecordMap>).fieldCount = n;\n    (this as Mutable<this>).upper += k;\n  }\n\n  override splice(start: number, deleteCount: number = 0, ...newItems: AnyItem[]): Item[] {\n    if ((this.record.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    const n = this.length;\n    if (start < 0) {\n      start = n + start;\n    }\n    start = Math.min(Math.max(0, start), n);\n    deleteCount = Math.min(Math.max(0, deleteCount), n - start);\n    let deleted;\n    if ((this.record.flags & Record.AliasedFlag) !== 0) {\n      deleted = this.record.spliceAliased(this.lower + start, deleteCount, ...newItems);\n    } else {\n      deleted = this.record.spliceMutable(this.lower + start, deleteCount, ...newItems);\n    }\n    (this as Mutable<this>).upper += newItems.length - deleted.length;\n    return deleted;\n  }\n\n  override delete(key: AnyValue): Item {\n    if ((this.record.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    key = Value.fromAny(key);\n    if ((this.record.flags & Record.AliasedFlag) !== 0) {\n      return this.deleteAliased(key);\n    } else {\n      return this.deleteMutable(key);\n    }\n  }\n\n  /** @internal */\n  deleteAliased(key: Value): Item {\n    const record = this.record;\n    const n = record.length;\n    const oldArray = record.array;\n    const newArray = new Array(Record.expand(n));\n    for (let i = this.lower; i < this.upper; i += 1) {\n      const item = oldArray![i];\n      if (item instanceof Field && item.key.equals(key)) {\n        for (let j = i + 1; j < n; j += 1, i += 1) {\n          newArray[i] = oldArray![j];\n        }\n        (record as Mutable<RecordMap>).array = newArray;\n        (record as Mutable<RecordMap>).table = null;\n        (record as Mutable<RecordMap>).length = n - 1;\n        (record as Mutable<RecordMap>).fieldCount -= 1;\n        (record as Mutable<RecordMap>).flags &= ~Record.AliasedFlag;\n        (this as Mutable<this>).upper -= 1;\n        return item;\n      }\n      newArray[i] = item;\n    }\n    return Item.absent();\n  }\n\n  /** @internal */\n  deleteMutable(key: Value): Item {\n    const record = this.record;\n    const n = record.length;\n    const array = record.array;\n    for (let i = this.lower; i < this.upper; i += 1) {\n      const item = array![i]!;\n      if (item instanceof Field && item.key.equals(key)) {\n        for (let j = i + 1; j < n; j += 1, i += 1) {\n          array![i] = array![j]!;\n        }\n        array![n - 1] = void 0 as any;\n        (record as Mutable<RecordMap>).table = null;\n        (record as Mutable<RecordMap>).length = n - 1;\n        (record as Mutable<RecordMap>).fieldCount -= 1;\n        (this as Mutable<this>).upper -= 1;\n        return item;\n      }\n    }\n    return Item.absent();\n  }\n\n  override clear(): void {\n    if ((this.record.flags & Record.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    if ((this.record.flags & Record.AliasedFlag) !== 0) {\n      this.clearAliased();\n    } else {\n      this.clearMutable();\n    }\n  }\n\n  /** @internal */\n  clearAliased(): void {\n    const record = this.record;\n    const m = record.length;\n    let n = record.fieldCount;\n    const l = m - this.length;\n    const oldArray = record.array;\n    const newArray = new Array(Record.expand(l));\n    let i = 0;\n    while (i < this.lower) {\n      newArray[i] = oldArray![i];\n      i += 1;\n    }\n    while (i < this.upper) {\n      if (oldArray![i] instanceof Field) {\n        n -= 1;\n      }\n      i += 1;\n    }\n    i = this.lower;\n    let j = this.upper;\n    while (j < m) {\n      newArray[i] = oldArray![j];\n      i += 1;\n      j += 1;\n    }\n    (record as Mutable<RecordMap>).array = newArray;\n    (record as Mutable<RecordMap>).table = null;\n    (record as Mutable<RecordMap>).length = l;\n    (record as Mutable<RecordMap>).fieldCount = n;\n    (record as Mutable<RecordMap>).flags &= ~Record.AliasedFlag;\n    (this as Mutable<this>).upper = this.lower;\n  }\n\n  /** @internal */\n  clearMutable(): void {\n    const record = this.record;\n    const m = record.length;\n    let n = record.fieldCount;\n    const array = record.array;\n    let i = this.lower;\n    while (i < this.upper) {\n      if (array![i] instanceof Field) {\n        n -= 1;\n      }\n      i += 1;\n    }\n    i = this.lower;\n    let j = this.upper;\n    while (j < m) {\n      const item = array![j]!;\n      if (item instanceof Field) {\n        (record as Mutable<RecordMap>).table = null;\n      }\n      array![i] = item;\n      i += 1;\n      j += 1;\n    }\n    (record as Mutable<RecordMap>).length = i;\n    (record as Mutable<RecordMap>).fieldCount = n;\n    while (i < m) {\n      array![i] = void 0 as any;\n      i += 1;\n    }\n    (this as Mutable<this>).upper = this.lower;\n  }\n\n  override isAliased(): boolean {\n    return (this.record.flags & Record.AliasedFlag) !== 0;\n  }\n\n  override isMutable(): boolean {\n    return (this.record.flags & Record.ImmutableFlag) === 0;\n  }\n\n  override alias(): void {\n    (this.record as Mutable<RecordMap>).flags |= Record.AliasedFlag;\n  }\n\n  override branch(): RecordMap {\n    const m = this.length;\n    let n = 0;\n    const oldArray = this.record.array;\n    const newArray = new Array(Record.expand(m));\n    let i = this.lower;\n    let j = 0;\n    while (j < m) {\n      const item = oldArray![i];\n      newArray[j] = item;\n      if (item instanceof Field) {\n        n += 1;\n      }\n      i += 1;\n      j += 1;\n    }\n    return new RecordMap(newArray, null, m, n, 0);\n  }\n\n  override clone(): RecordMap {\n    const m = this.length;\n    let n = 0;\n    const oldArray = this.record.array;\n    const newArray = new Array(Record.expand(m));\n    let i = this.lower;\n    let j = 0;\n    while (j < m) {\n      const item = oldArray![i]!;\n      newArray[j] = item.clone();\n      if (item instanceof Field) {\n        n += 1;\n      }\n      i += 1;\n      j += 1;\n    }\n    return new RecordMap(newArray, null, m, n, 0);\n  }\n\n  override commit(): this {\n    this.record.commit();\n    return this;\n  }\n\n  override subRecord(lower?: number, upper?: number): Record {\n    const n = this.length;\n    if (lower === void 0) {\n      lower = 0;\n    } else if (lower < 0) {\n      lower = n + lower;\n    }\n    if (upper === void 0) {\n      upper = n;\n    } else if (upper < 0) {\n      upper = n + upper;\n    }\n    if (lower < 0 || upper > n || lower > upper) {\n      throw new RangeError(lower + \", \" + upper);\n    }\n    return new RecordMapView(this.record, this.lower + lower, this.upper + upper);\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    const array = this.record.array;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      const result = callback.call(thisArg, array![i]!, i);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n}\nObject.defineProperty(RecordMapView.prototype, \"fieldCount\", {\n  get(this: RecordMapView): number {\n    const array = this.record.array;\n    let k = 0;\n    for (let i = this.lower, n = this.upper; i < n; i += 1) {\n      if (array![i] instanceof Field) {\n        k += 1;\n      }\n    }\n    return k;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Mutable, Random, Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport {Input, OutputSettings, Output, Writer, Unicode, Base16, Base64} from \"@swim/codec\";\nimport {Item} from \"./Item\";\nimport {Value} from \"./Value\";\nimport {DataOutput} from \"./\"; // forward import\n\n/** @public */\nexport type AnyData = Data | Uint8Array;\n\n/** @public */\nexport class Data extends Value {\n  constructor(array: Uint8Array | null, size: number, flags: number) {\n    super();\n    this.array = array;\n    this.size = size;\n    this.flags = flags;\n  }\n\n  /** @internal */\n  readonly array: Uint8Array | null;\n\n  override isConstant(): boolean {\n    return true;\n  }\n\n  readonly size: number;\n\n  /** @internal */\n  readonly flags: number;\n\n  getByte(index: number): number {\n    if (index < 0 || index >= this.size) {\n      throw new RangeError(\"\" + index);\n    }\n    return this.array![index]!;\n  }\n\n  setByte(index: number, value: number): Data {\n    const flags = this.flags;\n    if ((flags & Data.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    } else if (index < 0 || index >= this.size) {\n      throw new RangeError(\"\" + index);\n    }\n    if ((flags & Data.AliasedFlag) !== 0) {\n      return this.setByteAliased(index, value);\n    } else {\n      return this.setByteMutable(index, value);\n    }\n  }\n\n  /** @internal */\n  setByteAliased(index: number, value: number): Data {\n    const n = this.size;\n    const oldArray = this.array!;\n    const newArray = new Uint8Array(Data.expand(n));\n    newArray.set(oldArray, 0);\n    newArray[index] = value;\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).flags &= ~Data.AliasedFlag;\n    return this;\n  }\n\n  /** @internal */\n  setByteMutable(index: number, value: number): Data {\n    this.array![index] = value;\n    return this;\n  }\n\n  addByte(value: number): Data {\n    const flags = this.flags;\n    if ((flags & Data.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    if ((flags & Data.AliasedFlag) !== 0) {\n      return this.addByteAliased(value);\n    } else {\n      return this.addByteMutable(value);\n    }\n  }\n\n  /** @internal */\n  addByteAliased(value: number): Data {\n    const n = this.size;\n    const oldArray = this.array;\n    const newArray = new Uint8Array(Data.expand(n + 1));\n    if (oldArray !== null) {\n      newArray.set(oldArray, 0);\n    }\n    newArray[n] = value;\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).size = n + 1;\n    (this as Mutable<this>).flags &= ~Data.AliasedFlag;\n    return this;\n  }\n\n  /** @internal */\n  addByteMutable(value: number): Data {\n    const n = this.size;\n    const oldArray = this.array;\n    let newArray;\n    if (oldArray === null || n + 1 > oldArray.length) {\n      newArray = new Uint8Array(Data.expand(n + 1));\n      if (oldArray !== null) {\n        newArray.set(oldArray, 0);\n      }\n      (this as Mutable<this>).array = newArray;\n    } else {\n      newArray = oldArray;\n    }\n    newArray[n] = value;\n    (this as Mutable<this>).size = n + 1;\n    return this;\n  }\n\n  addData(data: Data): Data {\n    let array = data.array;\n    if (array !== null) {\n      const size = data.size;\n      if (array.length > size) {\n        array = array.slice(0, size);\n      }\n      return this.addUint8Array(array);\n    } else {\n      return this;\n    }\n  }\n\n  addUint8Array(array: Uint8Array): Data {\n    const flags = this.flags;\n    if ((flags & Data.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    if ((flags & Data.AliasedFlag) !== 0) {\n      return this.addUint8ArrayAliased(array);\n    } else {\n      return this.addUint8ArrayMutable(array);\n    }\n  }\n\n  /** @internal */\n  addUint8ArrayAliased(array: Uint8Array): Data {\n    const size = array.length;\n    if (size === 0) {\n      return this;\n    }\n    const n = this.size;\n    const oldArray = this.array;\n    const newArray = new Uint8Array(Data.expand(n + size));\n    if (oldArray !== null) {\n      newArray.set(oldArray, 0);\n    }\n    newArray.set(array, n);\n    (this as Mutable<this>).array = newArray;\n    (this as Mutable<this>).size = n + size;\n    (this as Mutable<this>).flags &= ~Data.AliasedFlag;\n    return this;\n  }\n\n  /** @internal */\n  addUint8ArrayMutable(array: Uint8Array): Data {\n    const size = array.length;\n    if (size === 0) {\n      return this;\n    }\n    const n = this.size;\n    const oldArray = this.array;\n    let newArray;\n    if (oldArray === null || n + size > oldArray.length) {\n      newArray = new Uint8Array(Data.expand(n + size));\n      if (oldArray !== null) {\n        newArray.set(oldArray, 0);\n      }\n      (this as Mutable<this>).array = newArray;\n    } else {\n      newArray = oldArray;\n    }\n    newArray.set(array, n);\n    (this as Mutable<this>).size = n + size;\n    return this;\n  }\n\n  clear(): void {\n    if ((this.flags & Data.ImmutableFlag) !== 0) {\n      throw new Error(\"immutable\");\n    }\n    (this as Mutable<this>).array = null;\n    (this as Mutable<this>).size = 0;\n    (this as Mutable<this>).flags = Data.AliasedFlag;\n  }\n\n  toUint8Array(): Uint8Array {\n    const oldArray = this.array;\n    const flags = this.flags;\n    if ((flags & Data.ImmutableFlag) !== 0) {\n      return oldArray !== null ? oldArray.slice(0) : new Uint8Array(0);\n    } else if ((flags & Data.AliasedFlag) !== 0 || this.size !== oldArray!.length) {\n      const newArray = oldArray !== null ? oldArray.slice(0) : new Uint8Array(0);\n      (this as Mutable<this>).array = newArray;\n      (this as Mutable<this>).flags &= ~Data.AliasedFlag;\n      return newArray;\n    } else {\n      return oldArray!;\n    }\n  }\n\n  asUint8Array(): Uint8Array | undefined {\n    let array: Uint8Array | undefined;\n    if (this.array !== null && this.size > 0) {\n      array = this.array;\n      if (array.length !== this.size) {\n        array = new Uint8Array(array.buffer, array.byteOffset, this.size);\n      }\n    } else {\n      array = void 0;\n    }\n    return array;\n  }\n\n  override toAny(): AnyData {\n    return this.toUint8Array();\n  }\n\n  override isAliased(): boolean {\n    return (this.flags & Data.AliasedFlag) !== 0;\n  }\n\n  override isMutable(): boolean {\n    return (this.flags & Data.ImmutableFlag) === 0;\n  }\n\n  override branch(): Data {\n    (this as Mutable<this>).flags |= Data.AliasedFlag;\n    return new Data(this.array, this.size, Data.AliasedFlag);\n  }\n\n  override clone(): Data {\n    return this.branch();\n  }\n\n  override commit(): this {\n    (this as Mutable<this>).flags |= Data.ImmutableFlag;\n    return this;\n  }\n\n  writeBase16(output: Output, base16: Base16 = Base16.uppercase): Writer<unknown, unknown> {\n    let array = this.array;\n    const size = this.size;\n    if (array !== null && size !== 0) {\n      if (array.length !== size) {\n        array = array.slice(0, size);\n      }\n      return base16.writeUint8Array(output, array);\n    } else {\n      return Writer.end();\n    }\n  }\n\n  toBase16(base16: Base16 = Base16.uppercase): string {\n    const output = Unicode.stringOutput();\n    this.writeBase16(output, base16).bind();\n    return output.bind();\n  }\n\n  writeBase64(output: Output, base64: Base64 = Base64.standard()): Writer<unknown, unknown> {\n    let array = this.array;\n    const size = this.size;\n    if (array !== null && size !== 0) {\n      if (array.length !== size) {\n        array = array.slice(0, size);\n      }\n      return base64.writeUint8Array(output, array);\n    } else {\n      return Writer.end();\n    }\n  }\n\n  toBase64(base64: Base64 = Base64.standard()): string {\n    const output = Unicode.stringOutput();\n    this.writeBase64(output, base64);\n    return output.bind();\n  }\n\n  override interpolateTo(that: Data): Interpolator<Data>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    return super.interpolateTo(that);\n  }\n\n  override get typeOrder(): number {\n    return 4;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Data) {\n      const xs = this.array!;\n      const ys = that.array!;\n      const xn = this.size;\n      const yn = that.size;\n      let order = 0;\n      let i = 0;\n      do {\n        if (i < xn && i < yn) {\n          order = xs[i]! - ys[i]!;\n          i += 1;\n        } else {\n          break;\n        }\n      } while (order === 0);\n      if (order > 0) {\n        return 1;\n      } else if (order < 0) {\n        return -1;\n      } else if (xn > yn) {\n        return 1;\n      } else if (xn < yn) {\n        return -1;\n      } else {\n        return 0;\n      }\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: Item): boolean {\n    return this.equals(that);\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Data) {\n      const xs = this.array!;\n      const ys = that.array!;\n      const xn = this.size;\n      if (xn !== that.size) {\n        return false;\n      }\n      for (let i = 0; i < xn; i += 1) {\n        if (xs[i] !== ys[i]) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mixUint8Array(Constructors.hash(Data),\n        this.array !== null ? this.array : new Uint8Array(0)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Data\").write(46/*'.'*/);\n    if (this.size === 0) {\n      output = output.write(\"empty\").write(40/*'('*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"base16\").write(40/*'('*/).write(34/*'\"'*/);\n      const writer = this.writeBase16(output);\n      if (!writer.isDone()) {\n        return Output.error(writer.trap());\n      }\n      output = output.write(34/*'\"'*/).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  /** @internal */\n  static readonly AliasedFlag: number = 1 << 0;\n  /** @internal */\n  static readonly ImmutableFlag: number = 1 << 1;\n\n  @Lazy\n  static override empty(): Data {\n    return new Data(null, 0, Data.AliasedFlag | Data.ImmutableFlag);\n  }\n\n  static create(initialCapacity?: number): Data {\n    if (initialCapacity === void 0) {\n      return new Data(null, 0, Data.AliasedFlag);\n    } else {\n      return new Data(new Uint8Array(initialCapacity), 0, 0);\n    }\n  }\n\n  static wrap(value: Uint8Array): Data {\n    return new Data(value, value.length, Data.AliasedFlag);\n  }\n\n  static fromBase16(input: Input | string): Data {\n    if (typeof input === \"string\") {\n      input = Unicode.stringInput(input);\n    }\n    return Base16.parse(input, Data.output()).bind();\n  }\n\n  static fromBase64(input: Input | string, base64: Base64 = Base64.standard()): Data {\n    if (typeof input === \"string\") {\n      input = Unicode.stringInput(input);\n    }\n    return base64.parse(input, Data.output()).bind();\n  }\n\n  static override fromAny(value: AnyData): Data {\n    if (value instanceof Data) {\n      return value;\n    } else if (value instanceof Uint8Array) {\n      return Data.wrap(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static random(size: number): Data {\n    const array = new Uint8Array(size);\n    Random.fillBytes(array);\n    return Data.wrap(array);\n  }\n\n  static output(): Output<Data>;\n  static output(initialCapacity: number): Output<Data>;\n  static output(data: Data): Output<Data>;\n  static output(data?: number | Data): Output<Data> {\n    if (!(data instanceof Data)) {\n      data = Data.create(data);\n    }\n    return new DataOutput(data, OutputSettings.standard());\n  }\n\n  /** @internal */\n  static expand(n: number): number {\n    n = Math.max(32, n) - 1;\n    n |= n >> 1; n |= n >> 2; n |= n >> 4; n |= n >> 8; n |= n >> 16;\n    return n + 1;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyOutputSettings, OutputSettings, Output} from \"@swim/codec\";\nimport type {Data} from \"./Data\";\n\n/** @internal */\nexport class DataOutput extends Output<Data> {\n  constructor(data: Data, settings: OutputSettings) {\n    super();\n    this.data = data;\n    this.settings = settings;\n  }\n\n  /** @internal */\n  readonly data: Data;\n\n  override isCont(): boolean {\n    return true;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Output<Data> {\n    return this;\n  }\n\n  override write(b: number | string): Output<Data> {\n    if (typeof b === \"number\") {\n      this.data.addByte(b);\n      return this;\n    } else {\n      throw new TypeError(\"\" + b);\n    }\n  }\n\n  override writeln(string?: string): Output<Data> {\n    throw new TypeError(\"\" + string);\n  }\n\n  override readonly settings: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<Data> {\n    settings = OutputSettings.fromAny(settings);\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  override bind(): Data {\n    return this.data;\n  }\n\n  override clone(): Output<Data> {\n    return new DataOutput(this.data.branch(), this.settings);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Mutable, Numbers, Strings, Interpolator, HashGenCacheSet} from \"@swim/util\";\nimport {OutputSettings, Output, Format} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {AnyValue, Value} from \"./Value\";\nimport {Num} from \"./\"; // forward import\nimport {TextOutput} from \"./\"; // forward import\n\n/** @public */\nexport type AnyText = Text | string;\n\n/** @public */\nexport class Text extends Value {\n  private constructor(value: string) {\n    super();\n    this.value = value;\n    this.hashValue = void 0;\n  }\n\n  override isConstant(): boolean {\n    return true;\n  }\n\n  readonly value: string;\n\n  get size(): number {\n    return this.value.length;\n  }\n\n  override stringValue(): string;\n  override stringValue<T>(orElse: T): string;\n  override stringValue<T>(orElse?: T): string {\n    return this.value;\n  }\n\n  override numberValue(): number | undefined;\n  override numberValue<T>(orElse: T): number | T;\n  override numberValue<T>(orElse?: T): number | T | undefined {\n    try {\n      return Num.parse(this.value).numberValue();\n    } catch (error) {\n      return orElse;\n    }\n  }\n\n  override booleanValue(): boolean | undefined;\n  override booleanValue<T>(orElse: T): boolean | T;\n  override booleanValue<T>(orElse?: T): boolean | T | undefined {\n    if (this.value === \"true\") {\n      return true;\n    } else if (this.value === \"false\") {\n      return false;\n    } else {\n      return orElse;\n    }\n  }\n\n  override toAny(): AnyText {\n    return this.value;\n  }\n\n  override valueOf(): string {\n    return this.value;\n  }\n\n  override plus(that: AnyValue): Value;\n  override plus(that: AnyItem): Item;\n  override plus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Text) {\n      return Text.from(this.value + that.value);\n    }\n    return super.plus(that);\n  }\n\n  override branch(): Text {\n    return this;\n  }\n\n  override clone(): Text {\n    return this;\n  }\n\n  override commit(): this {\n    return this;\n  }\n\n  override interpolateTo(that: Text): Interpolator<Text>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    return super.interpolateTo(that);\n  }\n\n  override get typeOrder(): number {\n    return 5;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Text) {\n      return this.value.localeCompare(that.value);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown): boolean {\n    return this.equals(that);\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Text) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  /** @internal */\n  readonly hashValue: number | undefined;\n\n  override hashCode(): number {\n    let hashValue = this.hashValue;\n    if (hashValue === void 0) {\n      hashValue = Strings.hash(this.value);\n      (this as Mutable<this>).hashValue = hashValue;\n    }\n    return hashValue;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Text\").write(46/*'.'*/);\n    if (this.value.length === 0) {\n      output = output.write(\"empty\").write(40/*'('*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"from\").write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    return Format.debugAny(output, this.value);\n  }\n\n  override toString(): string {\n    return this.value;\n  }\n\n  @Lazy\n  static override empty(): Text {\n    return new Text(\"\");\n  }\n\n  static from(value: string): Text {\n    const n = value.length;\n    if (n === 0) {\n      return Text.empty();\n    } else {\n      let text = new Text(value);\n      if (n <= 64) {\n        text = Text.cache.put(text);\n      }\n      return text;\n    }\n  }\n\n  static override fromAny(value: AnyText): Text {\n    if (value instanceof Text) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return Text.from(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static output(settings?: OutputSettings): Output<Text> {\n    if (settings === void 0) {\n      settings = OutputSettings.standard();\n    }\n    return new TextOutput(\"\", settings);\n  }\n\n  /** @internal */\n  @Lazy\n  static get cache(): HashGenCacheSet<Text> {\n    const cacheSize = 128;\n    return new HashGenCacheSet<Text>(cacheSize);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyOutputSettings, OutputSettings, Output} from \"@swim/codec\";\nimport {Text} from \"./Text\";\n\n/** @internal */\nexport class TextOutput extends Output<Text> {\n  constructor(string: string, settings: OutputSettings) {\n    super();\n    this.string = string;\n    this.settings = settings;\n  }\n\n  /** @internal */\n  readonly string: string;\n\n  override isCont(): boolean {\n    return true;\n  }\n\n  override isFull(): boolean {\n    return false;\n  }\n\n  override isDone(): boolean {\n    return false;\n  }\n\n  override isError(): boolean {\n    return false;\n  }\n\n  override isPart(): boolean {\n    return false;\n  }\n\n  override asPart(part: boolean): Output<Text> {\n    return this;\n  }\n\n  override write(token: number | string): Output<Text> {\n    if (typeof token === \"number\") {\n      if ((token >= 0x0000 && token <= 0xd7ff)\n          || (token >= 0xe000 && token <= 0xffff)) { // U+0000..U+D7FF | U+E000..U+FFFF\n        token = String.fromCharCode(token);\n      } else if (token >= 0x10000 && token <= 0x10ffff) { // U+10000..U+10FFFF\n        const u = token - 0x10000;\n        token = String.fromCharCode(0xd800 | (u >>> 10), 0xdc00 | (u & 0x3ff));\n      } else { // invalid code point\n        token = \"\\ufffd\";\n      }\n    }\n    (this as Mutable<this>).string += token;\n    return this;\n  }\n\n  override readonly settings!: OutputSettings;\n\n  override withSettings(settings: AnyOutputSettings): Output<Text> {\n    settings = OutputSettings.fromAny(settings);\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  override bind(): Text {\n    return Text.from(this.string);\n  }\n\n  override clone(): Output<Text> {\n    return new TextOutput(this.string, this.settings);\n  }\n\n  override toString(): string {\n    return this.string;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equivalent, Lazy, Numbers, Interpolator, HashGenCacheSet} from \"@swim/util\";\nimport {Output, Format} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {AnyValue, Value} from \"./Value\";\nimport {NumInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport type AnyNum = Num | number;\n\n/** @public */\nexport class Num extends Value {\n  private constructor(value: number, flags?: number ) {\n    super();\n    this.value = value;\n    this.flags = flags !== void 0 ? flags : 0;\n  }\n\n  override isConstant(): boolean {\n    return true;\n  }\n\n  readonly value: number;\n\n  /** @internal */\n  readonly flags: number;\n\n  isNaN(): boolean {\n    return isNaN(this.value);\n  }\n\n  isInfinite(): boolean {\n    return !isNaN(this.value) && !isFinite(this.value);\n  }\n\n  isUint32(): boolean {\n    return (this.flags & Num.Uint32Flag) !== 0;\n  }\n\n  isUint64(): boolean {\n    return (this.flags & Num.Uint64Flag) !== 0;\n  }\n\n  override stringValue(): string;\n  override stringValue<T>(orElse: T): string;\n  override stringValue<T>(orElse?: T): string {\n    return \"\" + this.value;\n  }\n\n  override numberValue(): number;\n  override numberValue<T>(orElse: T): number;\n  override numberValue<T>(orElse?: T): number {\n    return this.value;\n  }\n\n  override booleanValue(): boolean;\n  override booleanValue<T>(orElse: T): boolean;\n  override booleanValue<T>(orElse?: T): boolean {\n    return !!this.value;\n  }\n\n  override toAny(): AnyNum {\n    return this.value;\n  }\n\n  override valueOf(): number {\n    return this.value;\n  }\n\n  override bitwiseOr(that: AnyValue): Value;\n  override bitwiseOr(that: AnyItem): Item;\n  override bitwiseOr(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from((this.value | that.value) >>> 0);\n    }\n    return super.bitwiseOr(that);\n  }\n\n  override bitwiseXor(that: AnyValue): Value;\n  override bitwiseXor(that: AnyItem): Item;\n  override bitwiseXor(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from((this.value ^ that.value) >>> 0);\n    }\n    return super.bitwiseXor(that);\n  }\n\n  override bitwiseAnd(that: AnyValue): Value;\n  override bitwiseAnd(that: AnyItem): Item;\n  override bitwiseAnd(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from((this.value & that.value) >>> 0);\n    }\n    return super.bitwiseAnd(that);\n  }\n\n  override plus(that: AnyValue): Value;\n  override plus(that: AnyItem): Item;\n  override plus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from(this.value + that.value);\n    }\n    return super.plus(that);\n  }\n\n  override minus(that: AnyValue): Value;\n  override minus(that: AnyItem): Item;\n  override minus(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from(this.value - that.value);\n    }\n    return super.minus(that);\n  }\n\n  override times(that: AnyValue): Value;\n  override times(that: AnyItem): Item;\n  override times(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from(this.value * that.value);\n    }\n    return super.times(that);\n  }\n\n  override divide(that: AnyValue): Value;\n  override divide(that: AnyItem): Item;\n  override divide(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from(this.value / that.value);\n    }\n    return super.divide(that);\n  }\n\n  override modulo(that: AnyValue): Value;\n  override modulo(that: AnyItem): Item;\n  override modulo(that: AnyItem): Item {\n    that = Item.fromAny(that);\n    if (that instanceof Num) {\n      return Num.from(this.value % that.value);\n    }\n    return super.modulo(that);\n  }\n\n  override bitwiseNot(): Value {\n    return Num.from(~this.value >>> 0);\n  }\n\n  override negative(): Value {\n    return Num.from(-this.value);\n  }\n\n  override positive(): Value {\n    return this;\n  }\n\n  override inverse(): Value {\n    return Num.from(1 / this.value);\n  }\n\n  abs(): Num {\n    return Num.from(Math.abs(this.value));\n  }\n\n  ceil(): Num {\n    return Num.from(Math.ceil(this.value));\n  }\n\n  floor(): Num {\n    return Num.from(Math.floor(this.value));\n  }\n\n  round(): Num {\n    return Num.from(Math.round(this.value));\n  }\n\n  sqrt(): Num {\n    return Num.from(Math.sqrt(this.value));\n  }\n\n  pow(that: AnyNum): Num {\n    that = Num.fromAny(that);\n    return Num.from(Math.pow(this.value, that.value));\n  }\n\n  override max(that: Num): Num;\n  override max(that: Item): Item;\n  override max(that: Item): Item {\n    return this.compareTo(that) >= 0 ? this : that;\n  }\n\n  override min(that: Num): Num;\n  override min(that: Item): Item;\n  override min(that: Item): Item {\n    return this.compareTo(that) <= 0 ? this : that;\n  }\n\n  override interpolateTo(that: Num): Interpolator<Num>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof Num) {\n      return NumInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override get typeOrder(): number {\n    return 6;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Num) {\n      const x = this.value;\n      const y = that.value;\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Num) {\n      const x = this.value;\n      const y = that.value;\n      return x === y || isNaN(x) && isNaN(y) || Math.abs(y - x) < (epsilon !== void 0 ? epsilon : Equivalent.Epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Num) {\n      const x = this.value;\n      const y = that.value;\n      return x === y || isNaN(x) && isNaN(y);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Numbers.hash(this.value);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Num\").write(46/*'.'*/).write(\"from\")\n                   .write(40/*'('*/).display(this).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    return Format.displayNumber(output, this.value);\n  }\n\n  /** @internal */\n  static readonly Uint32Flag: number = 1;\n  /** @internal */\n  static readonly Uint64Flag: number = 2;\n  /** @internal */\n  static readonly TypeMask = 0x3;\n\n  @Lazy\n  static get zero(): Num {\n    return new Num(0);\n  }\n\n  @Lazy\n  static get negativeZero(): Num {\n    return new Num(-0);\n  }\n\n  @Lazy\n  static get one(): Num {\n    return new Num(1);\n  }\n\n  @Lazy\n  static get negativeOne(): Num {\n    return new Num(-1);\n  }\n\n  @Lazy\n  static get nan(): Num {\n    return new Num(NaN);\n  }\n\n  static uint32(value: number): Num {\n    return new Num(value, Num.Uint32Flag);\n  }\n\n  static uint64(value: number): Num {\n    return new Num(value, Num.Uint64Flag);\n  }\n\n  static from(value: number): Num {\n    if (value === 0) {\n      if (1 / value === -Infinity) {\n        return Num.negativeZero;\n      } else {\n        return Num.zero;\n      }\n    } else if (value === 1) {\n      return Num.one;\n    } else if (value === -1) {\n      return Num.negativeOne;\n    } else if (isNaN(value)) {\n      return Num.nan;\n    } else {\n      return Num.cache.put(new Num(value));\n    }\n  }\n\n  static override fromAny(value: AnyNum): Num {\n    if (value instanceof Num) {\n      return value;\n    } else if (typeof value === \"number\") {\n      return Num.from(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(value: string): Num {\n    if (value === \"NaN\") {\n      return Num.nan;\n    } else {\n      const num = +value;\n      if (isFinite(num)) {\n        return Num.from(num);\n      }\n    }\n    throw new Error(value);\n  }\n\n  /** @internal */\n  @Lazy\n  static get cache(): HashGenCacheSet<Num> {\n    const cacheSize = 128;\n    return new HashGenCacheSet<Num>(cacheSize);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Num} from \"./Num\";\n\n/** @internal */\nexport const NumInterpolator = (function (_super: typeof Interpolator) {\n  const NumInterpolator = function (y0: Num, y1: Num): Interpolator<Num> {\n    const interpolator = function (u: number): Num {\n      const y0 = interpolator[0].value;\n      const y1 = interpolator[1].value;\n      return Num.from(y0 + u * (y1 - y0));\n    } as Interpolator<Num>;\n    Object.setPrototypeOf(interpolator, NumInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0;\n    (interpolator as Mutable<typeof interpolator>)[1] = y1;\n    return interpolator;\n  } as {\n    (y0: Num, y1: Num): Interpolator<Num>;\n\n    /** @internal */\n    prototype: Interpolator<Num>;\n  };\n\n  NumInterpolator.prototype = Object.create(_super.prototype);\n  NumInterpolator.prototype.constructor = NumInterpolator;\n\n  return NumInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Numbers, Strings} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {AnyValue, Value} from \"./Value\";\n\n/** @public */\nexport type AnyBool = Bool | boolean;\n\n/** @public */\nexport class Bool extends Value {\n  private constructor(value: boolean) {\n    super();\n    Object.defineProperty(this, \"value\", {\n      value: value,\n      enumerable: true,\n    });\n    Object.defineProperty(this, \"hashValue\", {\n      value: Strings.hash(value ? \"true\" : \"false\"),\n    });\n  }\n\n  override isDefinite(): boolean {\n    return this.value;\n  }\n\n  override isConstant(): boolean {\n    return true;\n  }\n\n  readonly value!: boolean;\n\n  override stringValue(): string;\n  override stringValue<T>(orElse: T): string;\n  override stringValue<T>(orElse?: T): string {\n    return this.value ? \"true\" : \"false\";\n  }\n\n  override booleanValue(): boolean;\n  override booleanValue<T>(orElse: T): boolean;\n  override booleanValue<T>(orElse?: T): boolean {\n    return this.value;\n  }\n\n  override toAny(): AnyBool {\n    return this.value;\n  }\n\n  override valueOf(): boolean {\n    return this.value;\n  }\n\n  override conditional(thenTerm: AnyValue, elseTerm: AnyValue): Value;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item {\n    return this.value ? Item.fromAny(thenTerm) : Item.fromAny(elseTerm);\n  }\n\n  override or(that: AnyValue): Value;\n  override or(that: AnyItem): Item;\n  override or(that: AnyItem): Item {\n    return this.value ? this : Item.fromAny(that);\n  }\n\n  override and(that: AnyValue): Value;\n  override and(that: AnyItem): Item;\n  override and(that: AnyItem): Item {\n    return this.value ? Item.fromAny(that) : this;\n  }\n\n  override not(): Value {\n    return Bool.from(!this.value);\n  }\n\n  override get typeOrder(): number {\n    return 7;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Bool) {\n      if (this.value && !that.value) {\n        return -1;\n      } else if (!this.value && that.value) {\n        return 1;\n      } else {\n        return 0;\n      }\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown): boolean {\n    return this.equals(that);\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Bool) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  /** @internal */\n  readonly hashValue!: number;\n\n  override hashCode(): number {\n    return this.hashValue;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Bool\").write(46/*'.'*/).write(\"from\").write(40/*'('*/)\n                   .write(this.value ? \"true\" : \"false\").write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = output.write(this.value ? \"true\" : \"false\");\n    return output;\n  }\n\n  @Lazy\n  static get true(): Bool {\n    return new Bool(true);\n  }\n\n  @Lazy\n  static get false(): Bool {\n    return new Bool(false);\n  }\n\n  static from(value: boolean): Bool {\n    return value ? Bool.true : Bool.false;\n  }\n\n  static override fromAny(value: AnyBool): Bool {\n    if (value instanceof Bool) {\n      return value;\n    } else if (typeof value === \"boolean\") {\n      return Bool.from(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"./Item\";\nimport {Value} from \"./Value\";\nimport {Record} from \"./Record\";\n\n/** @public */\nexport type AnyExtant = Extant | null;\n\n/** @public */\nexport class Extant extends Value {\n  /** @internal */\n  private constructor() {\n    super();\n  }\n\n  /**\n   * Always returns `true` because `Extant` is a defined value.\n   */\n  override isDefined(): boolean {\n    return true;\n  }\n\n  /**\n   * Always returns `false` because `Extant` is not a distinct value.\n   */\n  override isDistinct(): boolean {\n    return false;\n  }\n\n  /**\n   * Always returns `false` because `Extant` is not a definite value.\n   */\n  override isDefinite(): boolean {\n    return false;\n  }\n\n  override isConstant(): boolean {\n    return true;\n  }\n\n  /**\n   * Always returns an empty `Record` because `Extant` is not a distinct value.\n   */\n  override unflattened(): Record {\n    return Record.empty();\n  }\n\n  override not(): Value {\n    return Value.absent();\n  }\n\n  /**\n   * Always returns the empty `string` because `Extant` behaves like an empty\n   * `Record`, which converts to a `string` by concatenating the string values\n   * of all its members, if all its members convert to string values.\n   */\n  override stringValue(): string;\n  /**\n   * Always returns the empty `string` because `Extant` behaves like an empty\n   * `Record`, which converts to a `string` by concatenating the string values\n   * of all its members, if all its members convert to string values.\n   */\n  override stringValue<T>(orElse: T): string;\n  override stringValue<T>(orElse?: T): string {\n    return \"\";\n  }\n\n  /**\n   * Always returns `true` because `Extant` behaves like a truthy value.\n   */\n  override booleanValue(): boolean;\n  /**\n   * Always returns `true` because `Extant` behaves like a truthy value.\n   */\n  override booleanValue<T>(orElse: T): boolean;\n  override booleanValue<T>(orElse?: T): boolean {\n    return true;\n  }\n\n  override toAny(): AnyExtant {\n    return null;\n  }\n\n  override interpolateTo(that: Extant): Interpolator<Extant>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    return super.interpolateTo(that);\n  }\n\n  override get typeOrder(): number {\n    return 98;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown): boolean {\n    return this === that;\n  }\n\n  override equals(that: unknown): boolean {\n    return this === that;\n  }\n\n  override hashCode(): number {\n    return Constructors.hash(Extant);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Value\").write(46/*'.'*/).write(\"extant\").write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = output.write(\"null\");\n    return output;\n  }\n\n  @Lazy\n  static override extant(): Extant {\n    return new Extant();\n  }\n\n  static override fromAny(value: AnyExtant): Extant {\n    if (value instanceof Extant) {\n      return value;\n    } else if (value === null) {\n      return Extant.extant();\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Numbers, Constructors, Cursor, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"./Item\";\nimport {Attr} from \"./Attr\";\nimport {Slot} from \"./Slot\";\nimport {AnyValue, Value} from \"./Value\";\nimport {Record} from \"./Record\";\nimport type {AnyText} from \"./Text\";\n\n/** @public */\nexport type AnyAbsent = Absent | undefined;\n\n/** @public */\nexport class Absent extends Value {\n  /** @internal */\n  private constructor() {\n    super();\n  }\n\n  /**\n   * Always returns `false` because `Absent` represents an undefined value.\n   */\n  override isDefined(): boolean {\n    return false;\n  }\n\n  /**\n   * Always returns `false` because `Absent` is not a distinct value.\n   */\n  override isDistinct(): boolean {\n    return false;\n  }\n\n  /**\n   * Always returns `false` because `Absent` is not a definite value.\n   */\n  override isDefinite(): boolean {\n    return false;\n  }\n\n  override isConstant(): boolean {\n    return true;\n  }\n\n  /**\n   * Always returns an empty `Record` because `Absent` is not a distinct value.\n   */\n  override unflattened(): Record {\n    return Record.empty();\n  }\n\n  override updated(key: AnyValue, value: AnyValue): Record {\n    return Record.of(Slot.of(key, value));\n  }\n\n  override updatedAttr(key: AnyText, value: AnyValue): Record {\n    return Record.of(Attr.of(key, value));\n  }\n\n  override updatedSlot(key: AnyValue, value: AnyValue): Record {\n    return Record.of(Slot.of(key, value));\n  }\n\n  override appended(...items: AnyItem[]): Record {\n    return Record.of(items);\n  }\n\n  override prepended(...items: AnyItem[]): Record {\n    return Record.of(items);\n  }\n\n  override concat(...items: AnyItem[]): Record {\n    const record = Record.create();\n    for (let i = 0, n = items.length; i < n; i += 1) {\n      Item.fromAny(items[i]).forEach(function (item: Item): void {\n        record.push(item);\n      });\n    }\n    return record;\n  }\n\n  override conditional(thenTerm: AnyValue, elseTerm: AnyValue): Value;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item {\n    return Item.fromAny(elseTerm);\n  }\n\n  override or(that: AnyValue): Value;\n  override or(that: AnyItem): Item;\n  override or(that: AnyItem): Item {\n    return Item.fromAny(that);\n  }\n\n  override and(that: AnyValue): Value;\n  override and(that: AnyItem): Item;\n  override and(that: AnyItem): Item {\n    return this;\n  }\n\n  override not(): Value {\n    return Value.extant();\n  }\n\n  /**\n   * Always returns `false` because `Absent` behaves like a falsey value.\n   */\n  override booleanValue(): boolean;\n  /**\n   * Always returns `false` because `Absent` behaves like a falsey value.\n   */\n  override booleanValue<T>(orElse: T): boolean;\n  override booleanValue<T>(orElse?: T): boolean {\n    return false;\n  }\n\n  override toAny(): AnyAbsent {\n    return void 0;\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    return void 0;\n  }\n\n  override iterator(): Cursor<Item> {\n    return Cursor.empty();\n  }\n\n  override interpolateTo(that: Absent): Interpolator<Absent>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    return super.interpolateTo(that);\n  }\n\n  override get typeOrder(): number {\n    return 99;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown): boolean {\n    return this === that;\n  }\n\n  override equals(that: unknown): boolean {\n    return this === that;\n  }\n\n  override hashCode(): number {\n    return Constructors.hash(Absent);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Value\").write(46/*'.'*/).write(\"absent\").write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = output.write(\"undefined\");\n    return output;\n  }\n\n  @Lazy\n  static override absent(): Absent {\n    return new Absent();\n  }\n\n  static override fromAny(value: AnyAbsent): Absent {\n    if (value instanceof Absent) {\n      return value;\n    } else if (value === void 0) {\n      return Absent.absent();\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyItem, Item} from \"./Item\";\nimport {AnyValue, Value} from \"./Value\";\nimport {Num} from \"./Num\";\nimport type {Operator} from \"./operator/Operator\";\nimport {ConditionalOperator} from \"./\"; // forward import\nimport {OrOperator} from \"./\"; // forward import\nimport {AndOperator} from \"./\"; // forward import\nimport {BitwiseOrOperator} from \"./\"; // forward import\nimport {BitwiseXorOperator} from \"./\"; // forward import\nimport {BitwiseAndOperator} from \"./\"; // forward import\nimport {LtOperator} from \"./\"; // forward import\nimport {LeOperator} from \"./\"; // forward import\nimport {EqOperator} from \"./\"; // forward import\nimport {NeOperator} from \"./\"; // forward import\nimport {GeOperator} from \"./\"; // forward import\nimport {GtOperator} from \"./\"; // forward import\nimport {PlusOperator} from \"./\"; // forward import\nimport {MinusOperator} from \"./\"; // forward import\nimport {TimesOperator} from \"./\"; // forward import\nimport {DivideOperator} from \"./\"; // forward import\nimport {ModuloOperator} from \"./\"; // forward import\nimport {NotOperator} from \"./\"; // forward import\nimport {BitwiseNotOperator} from \"./\"; // forward import\nimport {NegativeOperator} from \"./\"; // forward import\nimport {PositiveOperator} from \"./\"; // forward import\n\n/** @public */\nexport abstract class Expression extends Value {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  override conditional(thenTerm: Value, elseTerm: Value): Value;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item;\n  override conditional(thenTerm: AnyItem, elseTerm: AnyItem): Item {\n    thenTerm = Item.fromAny(thenTerm);\n    elseTerm = Item.fromAny(elseTerm);\n    return new ConditionalOperator(this, thenTerm, elseTerm);\n  }\n\n  override or(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new OrOperator(this, that);\n  }\n\n  override and(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new AndOperator(this, that);\n  }\n\n  override bitwiseOr(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new BitwiseOrOperator(this, that);\n  }\n\n  override bitwiseXor(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new BitwiseXorOperator(this, that);\n  }\n\n  override bitwiseAnd(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new BitwiseAndOperator(this, that);\n  }\n\n  override lt(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new LtOperator(this, that);\n  }\n\n  override le(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new LeOperator(this, that);\n  }\n\n  override eq(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new EqOperator(this, that);\n  }\n\n  override ne(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new NeOperator(this, that);\n  }\n\n  override ge(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new GeOperator(this, that);\n  }\n\n  override gt(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new GtOperator(this, that);\n  }\n\n  override plus(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new PlusOperator(this, that);\n  }\n\n  override minus(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new MinusOperator(this, that);\n  }\n\n  override times(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new TimesOperator(this, that);\n  }\n\n  override divide(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new DivideOperator(this, that);\n  }\n\n  override modulo(that: AnyItem): Operator {\n    that = Item.fromAny(that);\n    return new ModuloOperator(this, that);\n  }\n\n  override not(): Operator {\n    return new NotOperator(this);\n  }\n\n  override bitwiseNot(): Operator {\n    return new BitwiseNotOperator(this);\n  }\n\n  override negative(): Operator {\n    return new NegativeOperator(this);\n  }\n\n  override positive(): Operator {\n    return new PositiveOperator(this);\n  }\n\n  override inverse(): Operator {\n    return new DivideOperator(Num.one, this);\n  }\n\n  override toAny(): AnyValue {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {Expression} from \"../Expression\";\nimport type {BinaryOperator} from \"./BinaryOperator\";\nimport type {UnaryOperator} from \"./UnaryOperator\";\nimport {OrOperator} from \"../\"; // forward import\nimport {AndOperator} from \"../\"; // forward import\nimport {BitwiseOrOperator} from \"../\"; // forward import\nimport {BitwiseXorOperator} from \"../\"; // forward import\nimport {BitwiseAndOperator} from \"../\"; // forward import\nimport {LtOperator} from \"../\"; // forward import\nimport {LeOperator} from \"../\"; // forward import\nimport {EqOperator} from \"../\"; // forward import\nimport {NeOperator} from \"../\"; // forward import\nimport {GeOperator} from \"../\"; // forward import\nimport {GtOperator} from \"../\"; // forward import\nimport {PlusOperator} from \"../\"; // forward import\nimport {MinusOperator} from \"../\"; // forward import\nimport {TimesOperator} from \"../\"; // forward import\nimport {DivideOperator} from \"../\"; // forward import\nimport {ModuloOperator} from \"../\"; // forward import\nimport {NotOperator} from \"../\"; // forward import\nimport {BitwiseNotOperator} from \"../\"; // forward import\nimport {NegativeOperator} from \"../\"; // forward import\nimport {PositiveOperator} from \"../\"; // forward import\n\n/** @public */\nexport abstract class Operator extends Expression {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  static binary(operand1: Item, operator: string, operand2: Item): BinaryOperator {\n    switch (operator) {\n      case \"||\": return new OrOperator(operand1, operand2);\n      case \"&&\": return new AndOperator(operand1, operand2);\n      case \"|\": return new BitwiseOrOperator(operand1, operand2);\n      case \"^\": return new BitwiseXorOperator(operand1, operand2);\n      case \"&\": return new BitwiseAndOperator(operand1, operand2);\n      case \"<\": return new LtOperator(operand1, operand2);\n      case \"<=\": return new LeOperator(operand1, operand2);\n      case \"==\": return new EqOperator(operand1, operand2);\n      case \"!=\": return new NeOperator(operand1, operand2);\n      case \">=\": return new GeOperator(operand1, operand2);\n      case \">\": return new GtOperator(operand1, operand2);\n      case \"+\": return new PlusOperator(operand1, operand2);\n      case \"-\": return new MinusOperator(operand1, operand2);\n      case \"*\": return new TimesOperator(operand1, operand2);\n      case \"/\": return new DivideOperator(operand1, operand2);\n      case \"%\": return new ModuloOperator(operand1, operand2);\n      default: throw new Error(operator);\n    }\n  }\n\n  static unary(operator: string, operand: Item): UnaryOperator {\n    switch (operator) {\n      case \"!\": return new NotOperator(operand);\n      case \"~\": return new BitwiseNotOperator(operand);\n      case \"-\": return new NegativeOperator(operand);\n      case \"+\": return new PositiveOperator(operand);\n      default: throw new Error(operator);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Interpolator} from \"@swim/util\";\nimport type {Item} from \"../Item\";\nimport {Operator} from \"./Operator\";\nimport {BinaryOperatorInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport abstract class BinaryOperator extends Operator {\n  constructor(operand1: Item, operand2: Item) {\n    super();\n    this.operand1 = operand1;\n    this.operand2 = operand2;\n  }\n\n  readonly operand1: Item;\n\n  abstract readonly operator: string;\n\n  readonly operand2: Item;\n\n  override isConstant(): boolean {\n    return this.operand1.isConstant() && this.operand2.isConstant();\n  }\n\n  override interpolateTo(that: BinaryOperator): Interpolator<BinaryOperator>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof BinaryOperator && this.operator === that.operator) {\n      return BinaryOperatorInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Item} from \"../Item\";\nimport {Operator} from \"./Operator\";\nimport type {BinaryOperator} from \"./BinaryOperator\";\n\n/** @internal */\nexport interface BinaryOperatorInterpolator extends Interpolator<BinaryOperator> {\n  /** @internal */\n  readonly operand1Interpolator: Interpolator<Item>;\n  /** @internal */\n  readonly operator: string;\n  /** @internal */\n  readonly operand2Interpolator: Interpolator<Item>;\n\n  readonly 0: BinaryOperator;\n\n  readonly 1: BinaryOperator;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const BinaryOperatorInterpolator = (function (_super: typeof Interpolator) {\n  const BinaryOperatorInterpolator = function (y0: BinaryOperator, y1: BinaryOperator): BinaryOperatorInterpolator {\n    const operator = y0.operator;\n    if (operator !== y1.operator) {\n      throw new Error();\n    }\n    const interpolator = function (u: number): BinaryOperator {\n      const operand1 = interpolator.operand1Interpolator(u);\n      const operand2 = interpolator.operand2Interpolator(u);\n      return Operator.binary(operand1, interpolator.operator, operand2);\n    } as BinaryOperatorInterpolator;\n    Object.setPrototypeOf(interpolator, BinaryOperatorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).operand1Interpolator = y0.operand1.interpolateTo(y1.operand1);\n    (interpolator as Mutable<typeof interpolator>).operator = operator;\n    (interpolator as Mutable<typeof interpolator>).operand2Interpolator = y0.operand2.interpolateTo(y1.operand2);\n    return interpolator;\n  } as {\n    (y0: BinaryOperator, y1: BinaryOperator): BinaryOperatorInterpolator;\n\n    /** @internal */\n    prototype: BinaryOperatorInterpolator;\n  };\n\n  BinaryOperatorInterpolator.prototype = Object.create(_super.prototype);\n  BinaryOperatorInterpolator.prototype.constructor = BinaryOperatorInterpolator;\n\n  Object.defineProperty(BinaryOperatorInterpolator.prototype, 0, {\n    get(this: BinaryOperatorInterpolator): BinaryOperator {\n      const operand1 = this.operand1Interpolator[0];\n      const operand2 = this.operand2Interpolator[0];\n      return Operator.binary(operand1, this.operator, operand2);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(BinaryOperatorInterpolator.prototype, 1, {\n    get(this: BinaryOperatorInterpolator): BinaryOperator {\n      const operand1 = this.operand1Interpolator[1];\n      const operand2 = this.operand2Interpolator[1];\n      return Operator.binary(operand1, this.operator, operand2);\n    },\n    configurable: true,\n  });\n\n  BinaryOperatorInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BinaryOperatorInterpolator) {\n      return this.operator === that.operator\n          && this.operand1Interpolator.equals(that.operand1Interpolator)\n          && this.operand2Interpolator.equals(that.operand2Interpolator);\n    }\n    return false;\n  };\n\n  return BinaryOperatorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Interpolator} from \"@swim/util\";\nimport type {Item} from \"../Item\";\nimport {Operator} from \"./Operator\";\nimport {UnaryOperatorInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport abstract class UnaryOperator extends Operator {\n  constructor(operand: Item) {\n    super();\n    this.operand = operand;\n  }\n\n  readonly operand: Item;\n\n  abstract readonly operator: string;\n\n  override isConstant(): boolean {\n    return this.operand.isConstant();\n  }\n\n  override interpolateTo(that: UnaryOperator): Interpolator<UnaryOperator>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof UnaryOperator && this.operator === that.operator) {\n      return UnaryOperatorInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Item} from \"../Item\";\nimport {Operator} from \"./Operator\";\nimport type {UnaryOperator} from \"./UnaryOperator\";\n\n/** @internal */\nexport interface UnaryOperatorInterpolator extends Interpolator<UnaryOperator> {\n  /** @internal */\n  readonly operator: string;\n  /** @internal */\n  readonly operandInterpolator: Interpolator<Item>;\n\n  readonly 0: UnaryOperator;\n\n  readonly 1: UnaryOperator;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const UnaryOperatorInterpolator = (function (_super: typeof Interpolator) {\n  const UnaryOperatorInterpolator = function (y0: UnaryOperator, y1: UnaryOperator): UnaryOperatorInterpolator {\n    const operator = y0.operator;\n    if (operator !== y1.operator) {\n      throw new Error();\n    }\n    const interpolator = function (u: number): UnaryOperator {\n      const operand = interpolator.operandInterpolator(u);\n      return Operator.unary(interpolator.operator, operand);\n    } as UnaryOperatorInterpolator;\n    Object.setPrototypeOf(interpolator, UnaryOperatorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).operator = operator;\n    (interpolator as Mutable<typeof interpolator>).operandInterpolator = y0.operand.interpolateTo(y1.operand);\n    return interpolator;\n  } as {\n    (y0: UnaryOperator, y1: UnaryOperator): UnaryOperatorInterpolator;\n\n    /** @internal */\n    prototype: UnaryOperatorInterpolator;\n  };\n\n  UnaryOperatorInterpolator.prototype = Object.create(_super.prototype);\n  UnaryOperatorInterpolator.prototype.constructor = UnaryOperatorInterpolator;\n\n  Object.defineProperty(UnaryOperatorInterpolator.prototype, 0, {\n    get(this: UnaryOperatorInterpolator): UnaryOperator {\n      const operand = this.operandInterpolator[0];\n      return Operator.unary(this.operator, operand);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(UnaryOperatorInterpolator.prototype, 1, {\n    get(this: UnaryOperatorInterpolator): UnaryOperator {\n      const operand = this.operandInterpolator[1];\n      return Operator.unary(this.operator, operand);\n    },\n    configurable: true,\n  });\n\n  UnaryOperatorInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UnaryOperatorInterpolator) {\n      return this.operator === that.operator\n          && this.operandInterpolator.equals(that.operandInterpolator);\n    }\n    return false;\n  };\n\n  return UnaryOperatorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Operator} from \"./Operator\";\nimport {ConditionalOperatorInterpolator} from \"../\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class ConditionalOperator extends Operator {\n  constructor(ifTerm: Item, thenTerm: Item, elseTerm: Item) {\n    super();\n    this.ifTerm = ifTerm.commit();\n    this.thenTerm = thenTerm.commit();\n    this.elseTerm = elseTerm.commit();\n  }\n\n  readonly ifTerm: Item;\n\n  readonly thenTerm: Item;\n\n  readonly elseTerm: Item;\n\n  override isConstant(): boolean {\n    return this.ifTerm.isConstant() && this.thenTerm.isConstant()\n        && this.elseTerm.isConstant();\n  }\n\n  override get precedence(): number {\n    return 2;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    let result;\n    const ifTerm = this.ifTerm.evaluate(interpreter);\n    if (ifTerm.isDefinite()) {\n      const theTerm = this.thenTerm.evaluate(interpreter);\n      result = theTerm;\n    } else {\n      const elseTerm = this.elseTerm.evaluate(interpreter);\n      result = elseTerm;\n    }\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const ifTerm = this.ifTerm.substitute(interpreter);\n    const thenTerm = this.thenTerm.substitute(interpreter);\n    const elseTerm = this.elseTerm.substitute(interpreter);\n    return new ConditionalOperator(ifTerm, thenTerm, elseTerm);\n  }\n\n  override interpolateTo(that: ConditionalOperator): Interpolator<ConditionalOperator>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof ConditionalOperator) {\n      return ConditionalOperatorInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override get typeOrder(): number {\n    return 20;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof ConditionalOperator) {\n      let order = this.ifTerm.compareTo(that.ifTerm);\n      if (order === 0) {\n        order = this.thenTerm.compareTo(that.thenTerm);\n        if (order === 0) {\n          order = this.elseTerm.compareTo(that.elseTerm);\n        }\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ConditionalOperator) {\n      return this.ifTerm.equivalentTo(that.ifTerm, epsilon)\n          && this.thenTerm.equivalentTo(that.thenTerm, epsilon)\n          && this.elseTerm.equivalentTo(that.elseTerm, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ConditionalOperator) {\n      return this.ifTerm.equals(that.ifTerm) && this.thenTerm.equals(that.thenTerm)\n          && this.elseTerm.equals(that.elseTerm);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Constructors.hash(ConditionalOperator),\n        this.ifTerm.hashCode()), this.thenTerm.hashCode()), this.elseTerm.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.ifTerm).write(46/*'.'*/).write(\"conditional\").write(40/*'('*/)\n                   .debug(this.thenTerm).write(44/*','*/).write(32/*' '*/)\n                   .debug(this.elseTerm).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): ConditionalOperator {\n    return new ConditionalOperator(this.ifTerm.clone(), this.thenTerm.clone(), this.elseTerm.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Item} from \"../Item\";\nimport {ConditionalOperator} from \"./ConditionalOperator\";\n\n/** @internal */\nexport interface ConditionalOperatorInterpolator extends Interpolator<ConditionalOperator> {\n  /** @internal */\n  readonly ifTermInterpolator: Interpolator<Item>;\n  /** @internal */\n  readonly thenTermInterpolator: Interpolator<Item>;\n  /** @internal */\n  readonly elseTermInterpolator: Interpolator<Item>;\n\n  readonly 0: ConditionalOperator;\n\n  readonly 1: ConditionalOperator;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const ConditionalOperatorInterpolator = (function (_super: typeof Interpolator) {\n  const ConditionalOperatorInterpolator = function (y0: ConditionalOperator, y1: ConditionalOperator): ConditionalOperatorInterpolator {\n    const interpolator = function (u: number): ConditionalOperator {\n      const ifTerm = interpolator.ifTermInterpolator(u);\n      const thenTerm = interpolator.thenTermInterpolator(u);\n      const elseTerm = interpolator.elseTermInterpolator(u);\n      return new ConditionalOperator(ifTerm, thenTerm, elseTerm);\n    } as ConditionalOperatorInterpolator;\n    Object.setPrototypeOf(interpolator, ConditionalOperatorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).ifTermInterpolator = y0.ifTerm.interpolateTo(y1.ifTerm);\n    (interpolator as Mutable<typeof interpolator>).thenTermInterpolator = y0.thenTerm.interpolateTo(y1.thenTerm);\n    (interpolator as Mutable<typeof interpolator>).elseTermInterpolator = y0.elseTerm.interpolateTo(y1.elseTerm);\n    return interpolator;\n  } as {\n    (y0: ConditionalOperator, y1: ConditionalOperator): ConditionalOperatorInterpolator;\n\n    /** @internal */\n    prototype: ConditionalOperatorInterpolator;\n  };\n\n  ConditionalOperatorInterpolator.prototype = Object.create(_super.prototype);\n  ConditionalOperatorInterpolator.prototype.constructor = ConditionalOperatorInterpolator;\n\n  Object.defineProperty(ConditionalOperatorInterpolator.prototype, 0, {\n    get(this: ConditionalOperatorInterpolator): ConditionalOperator {\n      const ifTerm = this.ifTermInterpolator[0];\n      const thenTerm = this.thenTermInterpolator[0];\n      const elseTerm = this.elseTermInterpolator[0];\n      return new ConditionalOperator(ifTerm, thenTerm, elseTerm);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(ConditionalOperatorInterpolator.prototype, 1, {\n    get(this: ConditionalOperatorInterpolator): ConditionalOperator {\n      const ifTerm = this.ifTermInterpolator[1];\n      const thenTerm = this.thenTermInterpolator[1];\n      const elseTerm = this.elseTermInterpolator[1];\n      return new ConditionalOperator(ifTerm, thenTerm, elseTerm);\n    },\n    configurable: true,\n  });\n\n  ConditionalOperatorInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ConditionalOperatorInterpolator) {\n      return this.ifTermInterpolator.equals(that.ifTermInterpolator)\n          && this.thenTermInterpolator.equals(that.thenTermInterpolator)\n          && this.elseTermInterpolator.equals(that.elseTermInterpolator);\n    }\n    return false;\n  };\n\n  return ConditionalOperatorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport class InterpreterException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, InterpreterException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, HashCode, Numbers, Constructors} from \"@swim/util\";\nimport {Output, Format, Debug} from \"@swim/codec\";\n\n/**\n * Either an [[InterpreterSettings]] instance, or an [[InterpreterSettingsInit]]\n * object initializer.\n * @public\n */\nexport type AnyInterpreterSettings = InterpreterSettings | InterpreterSettingsInit;\n\n/**\n * [[InterpreterSettings]] object initializer.\n * @public\n */\nexport interface InterpreterSettingsInit {\n  maxScopeDepth?: number;\n}\n\n/** @public */\nexport class InterpreterSettings implements Debug, HashCode {\n  constructor(maxScopeDepth: number) {\n    Object.defineProperty(this, \"maxScopeDepth\", {\n      value: maxScopeDepth,\n      enumerable: true,\n    });\n  }\n\n  readonly maxScopeDepth!: number;\n\n  withMaxScopeDepth(maxScopeDepth: number): InterpreterSettings {\n    return this.copy(maxScopeDepth);\n  }\n\n  protected copy(maxScopeDepth: number): InterpreterSettings {\n    return new InterpreterSettings(maxScopeDepth);\n  }\n\n  protected canEqual(that: unknown): boolean {\n    return that instanceof InterpreterSettings;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof InterpreterSettings) {\n      return that.canEqual(this) && this.maxScopeDepth === that.maxScopeDepth;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(InterpreterSettings),\n        Numbers.hash(this.maxScopeDepth)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"new\").write(32/*' '*/).write(\"InterpreterSettings\")\n                   .write(40/*'('*/).debug(this.maxScopeDepth).write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static standard(): InterpreterSettings {\n    const maxScopeDepth = 1024;\n    return new InterpreterSettings(maxScopeDepth);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {InterpreterException} from \"./InterpreterException\";\nimport {InterpreterSettings} from \"./InterpreterSettings\";\nimport {AnyItem, Item} from \"../Item\";\nimport type {Operator} from \"../operator/Operator\";\nimport type {Selector} from \"../selector/Selector\";\n\n/** @public */\nexport type AnyInterpreter = Interpreter | AnyItem;\n\n/** @public */\nexport class Interpreter {\n  constructor(settings?: InterpreterSettings, scopeStack?: Item[] | null, scopeDepth?: number) {\n    this.settings = settings !== void 0 ? settings : InterpreterSettings.standard();\n    this.scopeStack = scopeStack !== void 0 ? scopeStack : null;\n    this.scopeDepth = scopeDepth !== void 0 ? scopeDepth : 0;\n  }\n\n  readonly settings: InterpreterSettings;\n\n  withSettings(settings: InterpreterSettings): this {\n    (this as Mutable<this>).settings = settings;\n    return this;\n  }\n\n  /** @internal */\n  readonly scopeStack: Item[] | null;\n\n  readonly scopeDepth: number;\n\n  peekScope(): Item {\n    const scopeDepth = this.scopeDepth;\n    if (scopeDepth <= 0) {\n      throw new InterpreterException(\"scope stack empty\");\n    }\n    return this.scopeStack![scopeDepth - 1]!;\n  }\n\n  getScope(index: number): Item {\n    if (index < 0 || index >= this.scopeDepth) {\n      throw new RangeError(\"\" + index);\n    }\n    return this.scopeStack![index]!;\n  }\n\n  pushScope(scope: Item): void {\n    const scopeDepth = this.scopeDepth;\n    if (scopeDepth >= this.settings.maxScopeDepth) {\n      throw new InterpreterException(\"scope stack overflow\");\n    }\n    const oldScopeStack = this.scopeStack;\n    let newScopeStack;\n    if (oldScopeStack === null || scopeDepth + 1 > oldScopeStack.length) {\n      newScopeStack = new Array<Item>(Interpreter.expand(scopeDepth + 1));\n      if (oldScopeStack !== null) {\n        for (let i = 0; i < scopeDepth; i += 1) {\n          newScopeStack[i] = oldScopeStack[i]!;\n        }\n      }\n      (this as Mutable<this>).scopeStack = newScopeStack;\n    } else {\n      newScopeStack = oldScopeStack;\n    }\n    newScopeStack[scopeDepth] = scope;\n    (this as Mutable<this>).scopeDepth += 1;\n  }\n\n  popScope(): Item {\n    const scopeDepth = this.scopeDepth;\n    if (scopeDepth <= 0) {\n      throw new InterpreterException(\"scope stack empty\");\n    }\n    const scopeStack = this.scopeStack!;\n    const scope = scopeStack[scopeDepth - 1]!;\n    scopeStack[scopeDepth - 1] = void 0 as any;\n    (this as Mutable<this>).scopeDepth -= 1;\n    return scope;\n  }\n\n  swapScope(newScope: Item): Item {\n    const scopeDepth = this.scopeDepth;\n    if (scopeDepth <= 0) {\n      throw new InterpreterException(\"scope stack empty\");\n    }\n    const scopeStack = this.scopeStack!;\n    const oldScope = scopeStack[scopeDepth - 1]!;\n    scopeStack[scopeDepth - 1] = newScope;\n    return oldScope;\n  }\n\n  willOperate(operator: Operator): void {\n    // stub\n  }\n\n  didOperate(operator: Operator, result: Item): void {\n    // stub\n  }\n\n  willSelect(selector: Selector): void {\n    // stub\n  }\n\n  didSelect(selector: Selector, result: unknown): void {\n    // stub\n  }\n\n  willTransform(selector: Selector): void {\n    // stub\n  }\n\n  didTransform(selector: Selector, result: Item): void {\n    // stub\n  }\n\n  static of(...objects: AnyItem[]): Interpreter {\n    const n = objects.length;\n    const scopes = new Array(Interpreter.expand(n));\n    for (let i = 0; i < n; i += 1) {\n      const scope = Item.fromAny(objects[i]);\n      scopes[i] = scope;\n    }\n    return new Interpreter(InterpreterSettings.standard(), scopes, n);\n  }\n\n  static fromAny(interpreter: AnyInterpreter, globalScope: Item = Item.globalScope()): Interpreter {\n    if (!(interpreter instanceof Interpreter)) {\n      const scope = interpreter;\n      interpreter = new Interpreter();\n      if (globalScope !== void 0) {\n        interpreter.pushScope(globalScope);\n      }\n      if (scope !== void 0) {\n        interpreter.pushScope(Item.fromAny(scope));\n      }\n    }\n    return interpreter;\n  }\n\n  private static expand(n: number): number {\n    n = Math.max(32, n) - 1;\n    n |= n >> 1; n |= n >> 2; n |= n >> 4; n |= n >> 8; n |= n >> 16;\n    return n + 1;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class OrOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"||\";\n  }\n\n  override get precedence(): number {\n    return 3;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    let result: Item;\n    const argument1 = this.operand1.evaluate(interpreter);\n    if (argument1.isDefinite()) {\n      result = argument1;\n    } else {\n      const argument2 = this.operand2.evaluate(interpreter);\n      result = argument2;\n    }\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.or(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 21;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof OrOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof OrOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof OrOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(OrOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"or\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): OrOperator {\n    return new OrOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class AndOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"&&\";\n  }\n\n  override get precedence(): number {\n    return 4;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    let result: Item;\n    const argument1 = this.operand1.evaluate(interpreter);\n    if (argument1.isDefinite()) {\n      const argument2 = this.operand2.evaluate(interpreter);\n      result = argument2;\n    } else {\n      result = argument1;\n    }\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.and(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 22;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof AndOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof AndOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof AndOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(AndOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"and\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): AndOperator {\n    return new AndOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class BitwiseOrOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"|\";\n  }\n\n  override get precedence(): number {\n    return 5;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.bitwiseOr(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.bitwiseOr(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 23;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof BitwiseOrOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseOrOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseOrOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(BitwiseOrOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"bitwiseOr\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): BitwiseOrOperator {\n    return new BitwiseOrOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class BitwiseXorOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"^\";\n  }\n\n  override get precedence(): number {\n    return 6;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.bitwiseXor(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.bitwiseXor(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 24;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof BitwiseXorOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseXorOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseXorOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(BitwiseXorOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"bitwiseXor\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): BitwiseXorOperator {\n    return new BitwiseXorOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class BitwiseAndOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"&\";\n  }\n\n  override get precedence(): number {\n    return 7;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.bitwiseAnd(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.bitwiseAnd(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 25;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof BitwiseAndOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseAndOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseAndOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(BitwiseAndOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"bitwiseAnd\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): BitwiseAndOperator {\n    return new BitwiseAndOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class LtOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"<\";\n  }\n\n  override get precedence(): number {\n    return 0;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.lt(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.lt(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 26;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof LtOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LtOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LtOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(LtOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    return output.debug(this.operand1).write(46/*'.'*/).write(\"lt\").write(40/*'('*/)\n                 .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): LtOperator {\n    return new LtOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class LeOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"<=\";\n  }\n\n  override get precedence(): number {\n    return 0;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.le(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.le(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 27;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof LeOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LeOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LeOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(LeOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    return output.debug(this.operand1).write(46/*'.'*/).write(\"le\").write(40/*'('*/)\n                 .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): LeOperator {\n    return new LeOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class EqOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"==\";\n  }\n\n  override get precedence(): number {\n    return 0;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.eq(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.eq(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 28;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof EqOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof EqOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof EqOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(EqOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"eq\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): EqOperator {\n    return new EqOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class NeOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"!=\";\n  }\n\n  override get precedence(): number {\n    return 0;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.ne(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.ne(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 29;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof NeOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof NeOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof NeOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(NeOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"ne\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): NeOperator {\n    return new NeOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class GeOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \">=\";\n  }\n\n  override get precedence(): number {\n    return 0;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.ge(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.ge(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 30;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof GeOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(GeOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"ge\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): GeOperator {\n    return new GeOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class GtOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \">\";\n  }\n\n  override get precedence(): number {\n    return 0;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.gt(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.gt(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 31;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof GtOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GtOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GtOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(GtOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"gt\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): GtOperator {\n    return new GtOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class PlusOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"+\";\n  }\n\n  override get precedence(): number {\n    return 8;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.plus(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.plus(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 32;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof PlusOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PlusOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PlusOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(PlusOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"plus\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): PlusOperator {\n    return new PlusOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class MinusOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"-\";\n  }\n\n  override get precedence(): number {\n    return 8;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.minus(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.minus(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 33;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof MinusOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof MinusOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof MinusOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(MinusOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"minus\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): MinusOperator {\n    return new MinusOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class TimesOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"*\";\n  }\n\n  override get precedence(): number {\n    return 9;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.times(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.times(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 34;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof TimesOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TimesOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TimesOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(TimesOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"times\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): TimesOperator {\n    return new TimesOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class DivideOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"/\";\n  }\n\n  override get precedence(): number {\n    return 9;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.divide(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.divide(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 35;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof DivideOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof DivideOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof DivideOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(DivideOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"divide\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): DivideOperator {\n    return new DivideOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {BinaryOperator} from \"./BinaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class ModuloOperator extends BinaryOperator {\n  constructor(operand1: Item, operand2: Item) {\n    super(operand1, operand2);\n  }\n\n  override get operator(): string {\n    return \"%\";\n  }\n\n  override get precedence(): number {\n    return 9;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    interpreter.willOperate(this);\n    const argument1 = this.operand1.evaluate(interpreter);\n    const argument2 = this.operand2.evaluate(interpreter);\n    const result = argument1.modulo(argument2);\n    interpreter.didOperate(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument1 = this.operand1.substitute(interpreter);\n    const argument2 = this.operand2.substitute(interpreter);\n    return argument1.modulo(argument2);\n  }\n\n  override get typeOrder(): number {\n    return 36;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof ModuloOperator) {\n      let order = this.operand1.compareTo(that.operand1);\n      if (order === 0) {\n        order = this.operand2.compareTo(that.operand2);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ModuloOperator) {\n      return this.operand1.equivalentTo(that.operand1, epsilon)\n          && this.operand2.equivalentTo(that.operand2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ModuloOperator) {\n      return this.operand1.equals(that.operand1) && this.operand2.equals(that.operand2);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(ModuloOperator),\n        this.operand1.hashCode()), this.operand2.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand1).write(46/*'.'*/).write(\"modulo\").write(40/*'('*/)\n                   .debug(this.operand2).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): ModuloOperator {\n    return new ModuloOperator(this.operand1.clone(), this.operand2.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport type {Item} from \"../Item\";\nimport {UnaryOperator} from \"./UnaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class NotOperator extends UnaryOperator {\n  constructor(operand: Item) {\n    super(operand);\n  }\n\n  override get operator(): string {\n    return \"!\";\n  }\n\n  override get precedence(): number {\n    return 10;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.evaluate(interpreter);\n    return argument.not();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.substitute(interpreter);\n    return argument.not();\n  }\n\n  override get typeOrder(): number {\n    return 37;\n  }\n\n  override compareTo(that: Item): number {\n    return Numbers.compare(this.typeOrder, that.typeOrder);\n  }\n\n  override equivalentTo(that: Item, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof NotOperator) {\n      return this.operand.equivalentTo(that.operand, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof NotOperator) {\n      return this.operand.equals(that.operand);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(NotOperator), this.operand.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand).write(46/*'.'*/).write(\"not\").write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): NotOperator {\n    return new NotOperator(this.operand.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {UnaryOperator} from \"./UnaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class BitwiseNotOperator extends UnaryOperator {\n  constructor(operand: Item) {\n    super(operand);\n  }\n\n  override get operator(): string {\n    return \"~\";\n  }\n\n  override get precedence(): number {\n    return 10;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.evaluate(interpreter);\n    return argument.bitwiseNot();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.substitute(interpreter);\n    return argument.bitwiseNot();\n  }\n\n  override get typeOrder(): number {\n    return 38;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof BitwiseNotOperator) {\n      return this.operand.compareTo(that.operand);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseNotOperator) {\n      return this.operand.equivalentTo(that.operand, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof BitwiseNotOperator) {\n      return this.operand.equals(that.operand);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(BitwiseNotOperator), this.operand.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand).write(46/*'.'*/).write(\"bitwiseNot\").write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): BitwiseNotOperator {\n    return new BitwiseNotOperator(this.operand.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {UnaryOperator} from \"./UnaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class NegativeOperator extends UnaryOperator {\n  constructor(operand: Item) {\n    super(operand);\n  }\n\n  override get operator(): string {\n    return \"-\";\n  }\n\n  override get precedence(): number {\n    return 10;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.evaluate(interpreter);\n    return argument.negative();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.substitute(interpreter);\n    return argument.negative();\n  }\n\n  override get typeOrder(): number {\n    return 39;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof NegativeOperator) {\n      return this.operand.compareTo(that.operand);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof NegativeOperator) {\n      return this.operand.equivalentTo(that.operand, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof NegativeOperator) {\n      return this.operand.equals(that.operand);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(NegativeOperator), this.operand.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand).write(46/*'.'*/).write(\"negative\").write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): NegativeOperator {\n    return new NegativeOperator(this.operand.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {UnaryOperator} from \"./UnaryOperator\";\nimport {AnyInterpreter, Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport class PositiveOperator extends UnaryOperator {\n  constructor(operand: Item) {\n    super(operand);\n  }\n\n  override get operator(): string {\n    return \"+\";\n  }\n\n  override get precedence(): number {\n    return 10;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.evaluate(interpreter);\n    return argument.positive();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const argument = this.operand.substitute(interpreter);\n    return argument.positive();\n  }\n\n  override get typeOrder(): number {\n    return 40;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof PositiveOperator) {\n      return this.operand.compareTo(that.operand);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PositiveOperator) {\n      return this.operand.equivalentTo(that.operand, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof PositiveOperator) {\n      return this.operand.equals(that.operand);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(PositiveOperator), this.operand.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.operand).write(46/*'.'*/).write(\"positive\").write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): PositiveOperator {\n    return new PositiveOperator(this.operand.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport type {Value} from \"../Value\";\nimport {Operator} from \"./Operator\";\nimport {InvokeOperatorInterpolator} from \"../\"; // forward import\nimport {Func} from \"../\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class InvokeOperator extends Operator {\n  constructor(func: Value, args: Value) {\n    super();\n    this.func = func;\n    this.args = args.commit();\n    this.state = void 0;\n  }\n\n  readonly func: Value;\n\n  readonly args: Value;\n\n  readonly state: unknown;\n\n  setState(state: unknown): void {\n    (this as Mutable<this>).state = state;\n  }\n\n  override isConstant(): boolean {\n    return this.func.isConstant() && this.args.isConstant();\n  }\n\n  override get precedence(): number {\n    return 11;\n  }\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const func = this.func.evaluate(interpreter);\n    if (func instanceof Func) {\n      return func.invoke(this.args, interpreter, this);\n    }\n    return Item.absent();\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const func = this.func.evaluate(interpreter);\n    if (func instanceof Func) {\n      const result = func.expand(this.args, interpreter, this);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    const args = this.args.substitute(interpreter).toValue();\n    return new InvokeOperator(this.func, args);\n  }\n\n  override interpolateTo(that: InvokeOperator): Interpolator<InvokeOperator>;\n  override interpolateTo(that: Item): Interpolator<Item>;\n  override interpolateTo(that: unknown): Interpolator<Item> | null;\n  override interpolateTo(that: unknown): Interpolator<Item> | null {\n    if (that instanceof InvokeOperator) {\n      return InvokeOperatorInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override get typeOrder(): number {\n    return 41;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof InvokeOperator) {\n      let order = this.func.compareTo(that.func);\n      if (order === 0) {\n        order = this.args.compareTo(that.args);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof InvokeOperator) {\n      return this.func.equals(that.func)\n          && this.args.equivalentTo(that.args, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof InvokeOperator) {\n      return this.func.equals(that.func) && this.args.equals(that.args);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(InvokeOperator),\n        this.func.hashCode()), this.args.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.func).write(46/*'.'*/).write(\"invoke\").write(40/*'('*/)\n                   .debug(this.args).write(41/*')'*/);\n    return output;\n  }\n\n  override clone(): InvokeOperator {\n    return new InvokeOperator(this.func.clone(), this.args.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Item} from \"../Item\";\nimport {InvokeOperator} from \"./InvokeOperator\";\n\n/** @internal */\nexport interface InvokeOperatorInterpolator extends Interpolator<InvokeOperator> {\n  /** @internal */\n  readonly funcInterpolator: Interpolator<Item>;\n  /** @internal */\n  readonly argsInterpolator: Interpolator<Item>;\n\n  readonly 0: InvokeOperator;\n\n  readonly 1: InvokeOperator;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const InvokeOperatorInterpolator = (function (_super: typeof Interpolator) {\n  const InvokeOperatorInterpolator = function (y0: InvokeOperator, y1: InvokeOperator): InvokeOperatorInterpolator {\n    const interpolator = function (u: number): InvokeOperator {\n      const func = interpolator.funcInterpolator(u);\n      const args = interpolator.argsInterpolator(u);\n      return new InvokeOperator(func, args);\n    } as InvokeOperatorInterpolator;\n    Object.setPrototypeOf(interpolator, InvokeOperatorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>).funcInterpolator = y0.func.interpolateTo(y1.func);\n    (interpolator as Mutable<typeof interpolator>).argsInterpolator = y0.args.interpolateTo(y1.args);\n    return interpolator;\n  } as {\n    (y0: InvokeOperator, y1: InvokeOperator): InvokeOperatorInterpolator;\n\n    /** @internal */\n    prototype: InvokeOperatorInterpolator;\n  };\n\n  InvokeOperatorInterpolator.prototype = Object.create(_super.prototype);\n  InvokeOperatorInterpolator.prototype.constructor = InvokeOperatorInterpolator;\n\n  Object.defineProperty(InvokeOperatorInterpolator.prototype, 0, {\n    get(this: InvokeOperatorInterpolator): InvokeOperator {\n      const func = this.funcInterpolator[0];\n      const args = this.argsInterpolator[0];\n      return new InvokeOperator(func, args);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(InvokeOperatorInterpolator.prototype, 1, {\n    get(this: InvokeOperatorInterpolator): InvokeOperator {\n      const func = this.funcInterpolator[1];\n      const args = this.argsInterpolator[1];\n      return new InvokeOperator(func, args);\n    },\n    configurable: true,\n  });\n\n  InvokeOperatorInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof InvokeOperatorInterpolator) {\n      return this.funcInterpolator.equals(that.funcInterpolator)\n          && this.argsInterpolator.equals(that.argsInterpolator);\n    }\n    return false;\n  };\n\n  return InvokeOperatorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"../Item\";\nimport {AnyValue, Value} from \"../Value\";\nimport {Record} from \"../Record\";\nimport {AnyText, Text} from \"../Text\";\nimport {AnyNum, Num} from \"../Num\";\nimport {Expression} from \"../Expression\";\nimport type {Operator} from \"../operator/Operator\";\nimport {InvokeOperator} from \"../operator/InvokeOperator\";\nimport {IdentitySelector} from \"../\"; // forward import\nimport {GetSelector} from \"../\"; // forward import\nimport {GetAttrSelector} from \"../\"; // forward import\nimport {GetItemSelector} from \"../\"; // forward import\nimport {KeysSelector} from \"../\"; // forward import\nimport {ValuesSelector} from \"../\"; // forward import\nimport {ChildrenSelector} from \"../\"; // forward import\nimport {DescendantsSelector} from \"../\"; // forward import\nimport {FilterSelector} from \"../\"; // forward import\nimport {LiteralSelector} from \"../\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport abstract class Selector extends Expression {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  override isConstant(): boolean {\n    return false;\n  }\n\n  /**\n   * The `Selector` that this `Selector` uses to match sub-selections.\n   */\n  abstract readonly then: Selector;\n\n  abstract forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  abstract forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n\n  abstract mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  abstract mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n\n  override evaluate(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const selected = Record.create();\n    this.forSelected(interpreter, function (interpreter: Interpreter): void {\n      const scope = interpreter.peekScope();\n      if (scope !== void 0) {\n        selected.push(scope);\n      }\n    }, this);\n    return selected.isEmpty() ? Item.absent() : selected.flattened();\n  }\n\n  abstract override substitute(interpreter: AnyInterpreter): Item;\n\n  abstract andThen(then: Selector): Selector;\n\n  override get(key: AnyValue): Selector {\n    key = Value.fromAny(key);\n    return this.andThen(new GetSelector(key, Selector.identity()));\n  }\n\n  override getAttr(key: AnyText): Selector {\n    key = Text.fromAny(key);\n    return this.andThen(new GetAttrSelector(key, Selector.identity()));\n  }\n\n  override getItem(index: AnyNum): Selector {\n    index = Num.fromAny(index);\n    return this.andThen(new GetItemSelector(index, Selector.identity()));\n  }\n\n  keys(): Selector {\n    return this.andThen(Selector.keys());\n  }\n\n  values(): Selector {\n    return this.andThen(Selector.values());\n  }\n\n  children(): Selector {\n    return this.andThen(Selector.children());\n  }\n\n  descendants(): Selector {\n    return this.andThen(Selector.descendants());\n  }\n\n  override filter(predicate?: AnyItem): Selector {\n    if (arguments.length === 0) {\n      return new FilterSelector(this, Selector.identity());\n    } else {\n      predicate = Item.fromAny(predicate);\n      return this.andThen(predicate.filter());\n    }\n  }\n\n  override invoke(args: Value): Operator {\n    return new InvokeOperator(this, args);\n  }\n\n  override get precedence(): number {\n    return 11;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Selector\").write(46/*'.'*/).write(\"identity\").write(40/*'('*/).write(41/*')'*/);\n    output = this.debugThen(output);\n    return output;\n  }\n\n  abstract debugThen<T>(output: Output<T>): Output<T>;\n\n  abstract override clone(): Selector;\n\n  @Lazy\n  static identity(): Selector {\n    return new IdentitySelector();\n  }\n\n  static get(key: AnyValue): Selector {\n    key = Value.fromAny(key);\n    return new GetSelector(key, Selector.identity());\n  }\n\n  static getAttr(key: AnyText): Selector {\n    key = Text.fromAny(key);\n    return new GetAttrSelector(key, Selector.identity());\n  }\n\n  static getItem(index: AnyNum): Selector {\n    index = Num.fromAny(index);\n    return new GetItemSelector(index, Selector.identity());\n  }\n\n  @Lazy\n  static keys(): Selector {\n    return new KeysSelector(Selector.identity());\n  }\n\n  @Lazy\n  static values(): Selector {\n    return new ValuesSelector(Selector.identity());\n  }\n\n  @Lazy\n  static children(): Selector {\n    return new ChildrenSelector(Selector.identity());\n  }\n\n  @Lazy\n  static descendants(): Selector {\n    return new DescendantsSelector(Selector.identity());\n  }\n\n  static literal(item: AnyItem): Selector {\n    item = Item.fromAny(item);\n    if (!(item instanceof Selector)) {\n      item = new LiteralSelector(item, Selector.identity());\n    }\n    return item as Selector;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"../Item\";\nimport {AnyValue, Value} from \"../Value\";\nimport {AnyText, Text} from \"../Text\";\nimport {AnyNum, Num} from \"../Num\";\nimport {Selector} from \"./Selector\";\nimport {GetSelector} from \"../\"; // forward import\nimport {GetAttrSelector} from \"../\"; // forward import\nimport {GetItemSelector} from \"../\"; // forward import\nimport {FilterSelector} from \"../\"; // forward import\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class IdentitySelector extends Selector {\n  override get then(): Selector {\n    return this;\n  }\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const oldScope = interpreter.popScope();\n      // Evaluate the current selection.\n      const newScope = oldScope.evaluate(interpreter);\n      // Push the evaluated selection onto the scope stack.\n      interpreter.pushScope(newScope);\n      // Visit the evaluated selection.\n      selected = callback.call(thisArg, interpreter);\n      // Restore the original selection to the top of the scope stack.\n      interpreter.swapScope(oldScope);\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    return transform.call(thisArg, interpreter);\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    return interpreter.peekScope().substitute(interpreter);\n  }\n\n  override get(key: AnyValue): Selector {\n    key = Value.fromAny(key);\n    return new GetSelector(key, this);\n  }\n\n  override getAttr(key: AnyText): Selector {\n    key = Text.fromAny(key);\n    return new GetAttrSelector(key, this);\n  }\n\n  override getItem(index: AnyNum): Selector {\n    index = Num.fromAny(index);\n    return new GetItemSelector(index, this);\n  }\n\n  override andThen(then: Selector): Selector {\n    return then;\n  }\n\n  override keys(): Selector {\n    return Selector.keys();\n  }\n\n  override values(): Selector {\n    return Selector.values();\n  }\n\n  override children(): Selector {\n    return Selector.children();\n  }\n\n  override descendants(): Selector {\n    return Selector.descendants();\n  }\n\n  override filter(predicate?: AnyItem): Selector {\n    if (arguments.length === 0) {\n      return new FilterSelector(this, this);\n    } else {\n      predicate = Item.fromAny(predicate);\n      return predicate.filter();\n    }\n  }\n\n  override get typeOrder(): number {\n    return 10;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown): boolean {\n    return this === that;\n  }\n\n  override equals(that: unknown): boolean {\n    return this === that;\n  }\n\n  override hashCode(): number {\n    return Constructors.hash(IdentitySelector);\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    return output; // blank\n  }\n\n  override clone(): Selector {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Field} from \"../Field\";\nimport type {Value} from \"../Value\";\nimport {Record} from \"../Record\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class GetSelector extends Selector {\n  constructor(key: Value, then: Selector) {\n    super();\n    this.item = key.commit();\n    this.then = then;\n  }\n\n  readonly item: Value;\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    interpreter.willSelect(this);\n    // Evaluate the key, in case it's dynamic.\n    const key = this.item.evaluate(interpreter).toValue();\n    const selected = GetSelector.forSelected(key, this.then, interpreter, callback, thisArg);\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  /** @internal */\n  static forSelected<T, S>(key: Value, then: Selector, interpreter: Interpreter,\n                           callback: (this: S | undefined, interpreter: Interpreter) => T,\n                           thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the next selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      let field: Field | undefined;\n      // Only records can have members.\n      if (scope instanceof Record) {\n        field = scope.getField(key);\n        if (field !== void 0) {\n          // Push the field value onto the scope stack.\n          interpreter.pushScope(field.toValue());\n          // Subselect the field value.\n          selected = then.forSelected(interpreter, callback, thisArg);\n          // Pop the field value off of the scope stack.\n          interpreter.popScope();\n        }\n      }\n      if (field === void 0 && selected === void 0) {\n        GetSelector.forSelected(key, then, interpreter, callback, thisArg);\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    // Evaluate the key, if it's dynamic.\n    const key = this.item.evaluate(interpreter).toValue();\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      // Only records can have members.\n      if (scope instanceof Record) {\n        const oldField = scope.getField(key);\n        if (oldField !== void 0) {\n          // Push the field value onto the scope stack.\n          interpreter.pushScope(oldField.toValue());\n          // Transform the field value.\n          const newItem = this.then.mapSelected(interpreter, transform, thisArg);\n          // Pop the field value off the scope stack.\n          interpreter.popScope();\n          if (newItem instanceof Field) {\n            // Replace the original field with the transformed field.\n            if (key.equals(newItem.key)) {\n              scope.set(key, newItem.toValue());\n            } else {\n              scope.delete(key);\n              scope.push(newItem);\n            }\n          } else if (newItem.isDefined()) {\n            // Update the field with the transformed value.\n            scope.set(key, newItem.toValue());\n          } else {\n            // Remove the field.\n            scope.delete(key);\n          }\n        }\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    // Evaluate the key, in case it's dynamic.\n    const key = this.item.evaluate(interpreter).toValue();\n    const value = GetSelector.substitute(key, this.then, interpreter);\n    if (value !== void 0) {\n      return value;\n    }\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new GetSelector(this.item, then as Selector);\n  }\n\n  /** @internal */\n  static substitute(key: Value, then: Selector, interpreter: Interpreter): Item | undefined {\n    let selected: Item | undefined;\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the next selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      let field: Field | undefined;\n      // Only records can have members.\n      if (scope instanceof Record) {\n        field = scope.getField(key);\n        if (field !== void 0) {\n          // Substitute the field value.\n          selected = field.toValue().substitute(interpreter);\n        }\n      }\n      if (field === void 0 && selected === void 0) {\n        GetSelector.substitute(key, then, interpreter);\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    return selected;\n  }\n\n  override andThen(then: Selector): Selector {\n    return new GetSelector(this.item, this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 12;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof GetSelector) {\n      let order = this.item.compareTo(that.item);\n      if (order === 0) {\n        order = this.then.compareTo(that.then);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GetSelector) {\n      return this.item.equals(that.item) && this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GetSelector) {\n      return this.item.equals(that.item) && this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(GetSelector),\n        this.item.hashCode()), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"get\").write(40/*'('*/).debug(this.item).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new GetSelector(this.item.clone(), this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Field} from \"../Field\";\nimport {Attr} from \"../Attr\";\nimport {Record} from \"../Record\";\nimport type {Text} from \"../Text\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class GetAttrSelector extends Selector {\n  constructor(key: Text, then: Selector) {\n    super();\n    this.item = key;\n    this.then = then;\n  }\n\n  readonly item: Text;\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    interpreter.willSelect(this);\n    const key = this.item;\n    const selected = GetAttrSelector.forSelected(key, this.then, interpreter, callback);\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  /** @internal */\n  static forSelected<T, S>(key: Text, then: Selector, interpreter: Interpreter,\n                           callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                           thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the next selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      let field: Field | undefined;\n      // Only records can have members.\n      if (scope instanceof Record) {\n        field = scope.getField(key);\n        if (field instanceof Attr) {\n          // Push the field value onto the scope stack.\n          interpreter.pushScope(field.toValue());\n          // Subselect the field value.\n          selected = then.forSelected(interpreter, callback, thisArg);\n          // Pop the field value off of the scope stack.\n          interpreter.popScope();\n        }\n      }\n      if (field === void 0 && selected === void 0) {\n        GetAttrSelector.forSelected(key, then, interpreter, callback, thisArg);\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    const key = this.item;\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      // Only records can have members.\n      if (scope instanceof Record) {\n        const oldField = scope.getField(key);\n        if (oldField instanceof Attr) {\n          // Push the field value onto the scope stack.\n          interpreter.pushScope(oldField.toValue());\n          // Transform the field value.\n          const newItem = this.then.mapSelected(interpreter, transform, thisArg);\n          // Pop the field value off the scope stack.\n          interpreter.popScope();\n          if (newItem instanceof Field) {\n            // Replace the original field with the transformed field.\n            if (key.equals(newItem.key)) {\n              scope.setAttr(key, newItem.toValue());\n            } else {\n              scope.delete(key);\n              scope.push(newItem);\n            }\n          } else if (newItem.isDefined()) {\n            // Update the field with the transformed value.\n            scope.setAttr(key, newItem.toValue());\n          } else {\n            // Remove the field.\n            scope.delete(key);\n          }\n        }\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const key = this.item;\n    const value = GetAttrSelector.substitute(key, this.then, interpreter);\n    if (value !== void 0) {\n      return value;\n    }\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new GetAttrSelector(this.item, then as Selector);\n  }\n\n  /** @internal */\n  static substitute(key: Text, then: Selector, interpreter: Interpreter): Item | undefined {\n    let selected: Item | undefined;\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the next selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      let field: Field | undefined;\n      // Only records can have members.\n      if (scope instanceof Record) {\n        field = scope.getField(key);\n        if (field instanceof Attr) {\n          // Substitute the field value.\n          selected = field.toValue().substitute(interpreter);\n        }\n      }\n      if (field === void 0 && selected === void 0) {\n        GetAttrSelector.substitute(key, then, interpreter);\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    return selected;\n  }\n\n  override andThen(then: Selector): Selector {\n    return new GetAttrSelector(this.item, this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 13;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof GetAttrSelector) {\n      let order = this.item.compareTo(that.item);\n      if (order === 0) {\n        order = this.then.compareTo(that.then);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GetAttrSelector) {\n      return this.item.equals(that.item) && this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GetAttrSelector) {\n      return this.item.equals(that.item) && this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(GetAttrSelector),\n        this.item.hashCode()), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"getAttr\").write(40/*'('*/)\n                   .debug(this.item).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new GetAttrSelector(this.item.clone(), this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Record} from \"../Record\";\nimport type {Num} from \"../Num\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class GetItemSelector extends Selector {\n  constructor(index: Num, then: Selector) {\n    super();\n    this.item = index;\n    this.then = then;\n  }\n\n  readonly item: Num;\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    const index = this.item.numberValue();\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      if (scope instanceof Record && index < scope.length) {\n        const item = scope.getItem(index);\n        // Push the item onto the scope stack.\n        interpreter.pushScope(item);\n        // Subselect the item.\n        selected = this.then.forSelected(interpreter, callback, thisArg);\n        // Pop the item off of the scope stack.\n        interpreter.popScope();\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      const index = this.item.numberValue();\n      if (scope instanceof Record && index < scope.length) {\n        const oldItem = scope.getItem(index);\n        // Push the item onto the scope stack.\n        interpreter.pushScope(oldItem);\n        // Transform the item.\n        const newItem = this.then.mapSelected(interpreter, transform, thisArg);\n        // Pop the item off the scope stack.\n        interpreter.popScope();\n        if (newItem.isDefined()) {\n          scope.setItem(index, newItem);\n        } else {\n          scope.splice(index, 1);\n        }\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const index = this.item.numberValue();\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      let selected: Item | undefined;\n      if (scope instanceof Record && index < scope.length) {\n        const item = scope.getItem(index);\n        // Substitute the item.\n        selected = item.substitute(interpreter);\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n      if (selected !== void 0) {\n        return selected;\n      }\n    }\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new GetItemSelector(this.item, then as Selector);\n  }\n\n  override andThen(then: Selector): Selector {\n    return new GetItemSelector(this.item, this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 14;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof GetItemSelector) {\n      let order = this.item.compareTo(that.item);\n      if (order === 0) {\n        order = this.then.compareTo(that.then);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GetItemSelector) {\n      return this.item.equals(that.item) && this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GetItemSelector) {\n      return this.item.equals(that.item) && this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(GetItemSelector),\n        this.item.hashCode()), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"getItem\").write(40/*'('*/)\n                   .debug(this.item).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new GetItemSelector(this.item, this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Field} from \"../Field\";\nimport {Attr} from \"../Attr\";\nimport {Slot} from \"../Slot\";\nimport {Record} from \"../Record\";\nimport {Text} from \"../Text\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class KeysSelector extends Selector {\n  constructor(then: Selector) {\n    super();\n    this.then = then;\n  }\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope();\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        // For each child, while none have been selected:\n        while (selected === void 0 && children.hasNext()) {\n          const child = children.next().value!;\n          // Only fields can have keys.\n          if (child instanceof Field) {\n            // Push the child key onto the scope stack.\n            interpreter.pushScope(child.key);\n            // Subselect the child key.\n            selected = this.then.forSelected(interpreter, callback, thisArg);\n            // Pop the child key off of the scope stack.\n            interpreter.popScope();\n          }\n        }\n      } else if (scope instanceof Field) {\n        // Push the key onto the scope stack.\n        interpreter.pushScope(scope.key);\n        // Subselect the key.\n        selected = this.then.forSelected(interpreter, callback, thisArg);\n        // Pop the key off of the scope stack.\n        interpreter.popScope();\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      let scope = interpreter.popScope();\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        while (children.hasNext()) {\n          const child = children.next().value!;\n          if (child instanceof Field) {\n            const oldKey = child.key;\n            // Push the key onto the scope stack.\n            interpreter.pushScope(oldKey);\n            // Subselect the key.\n            const newKey = this.then.mapSelected(interpreter, transform, thisArg).toValue();\n            // Pop the key off of the scope stack.\n            interpreter.popScope();\n            if (newKey.isDefined()) {\n              if (oldKey !== newKey) {\n                if (scope instanceof Attr && newKey instanceof Text) {\n                  children.set(Attr.of(newKey, scope.toValue()));\n                } else {\n                  children.set(Slot.of(newKey, scope.toValue()));\n                }\n              }\n            } else {\n              children.delete();\n            }\n          }\n        }\n      } else if (scope instanceof Field) {\n        const oldKey = scope.key;\n        // Push the key onto the scope stack.\n        interpreter.pushScope(oldKey);\n        // Subselect the key.\n        const newKey = this.then.mapSelected(interpreter, transform, thisArg).toValue();\n        // Pop the key off of the scope stack.\n        interpreter.popScope();\n        if (newKey.isDefined()) {\n          if (oldKey !== newKey) {\n            if (scope instanceof Attr && newKey instanceof Text) {\n              scope = Attr.of(newKey, scope.toValue());\n            } else {\n              scope = Slot.of(newKey, scope.toValue());\n            }\n          }\n        } else {\n          scope = Item.absent();\n        }\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new KeysSelector(then as Selector);\n  }\n\n  override andThen(then: Selector): Selector {\n    return new KeysSelector(this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 15;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof KeysSelector) {\n      return this.then.compareTo(that.then);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof KeysSelector) {\n      return this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof KeysSelector) {\n      return this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(KeysSelector), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"keys\").write(40/*'('*/).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new KeysSelector(this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Field} from \"../Field\";\nimport {Record} from \"../Record\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class ValuesSelector extends Selector {\n  constructor(then: Selector) {\n    super();\n    this.then = then;\n  }\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope();\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        // For each child, while none have been selected:\n        while (selected === void 0 && children.hasNext()) {\n          const child = children.next().value!;\n          // Push the child value onto the scope stack.\n          interpreter.pushScope(child.toValue());\n          // Subselect the child value.\n          selected = this.then.forSelected(interpreter, callback, thisArg);\n          // Pop the child value off of the scope stack.\n          interpreter.popScope();\n        }\n      } else {\n        // Push the value onto the scope stack.\n        interpreter.pushScope(scope.toValue());\n        // Subselect the value.\n        selected = this.then.forSelected(interpreter, callback, thisArg);\n        // Pop the value off of the scope stack.\n        interpreter.popScope();\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      let scope = interpreter.popScope();\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        while (children.hasNext()) {\n          const child = children.next().value!;\n          if (child instanceof Field) {\n            const oldValue = child.toValue();\n            // Push the child value onto the scope stack.\n            interpreter.pushScope(oldValue);\n            // Transform the child value.\n            const newItem = this.then.mapSelected(interpreter, transform, thisArg);\n            // Pop the child value off of the scope stack.\n            interpreter.popScope();\n            if (newItem.isDefined()) {\n              if (newItem instanceof Field) {\n                children.set(newItem);\n              } else if (newItem !== oldValue) {\n                children.set(child.updatedValue(newItem.toValue()));\n              }\n            } else {\n              children.delete();\n            }\n          } else {\n            // Push the child onto the scope stack.\n            interpreter.pushScope(child.toValue());\n            // Transform the child.\n            const newItem = this.then.mapSelected(interpreter, transform, thisArg);\n            // Pop the child off of the scope stack.\n            interpreter.popScope();\n            if (newItem.isDefined()) {\n              if (child !== newItem) {\n                children.set(newItem);\n              }\n            } else {\n              children.delete();\n            }\n          }\n        }\n      } else if (scope instanceof Field) {\n        const oldValue = scope.toValue();\n        // Push the field value onto the scope stack.\n        interpreter.pushScope(oldValue);\n        // Transform the field value.\n        const newItem = this.then.mapSelected(interpreter, transform, thisArg);\n        // Pop the field value off of the scope stack.\n        interpreter.popScope();\n        if (newItem.isDefined()) {\n          if (newItem instanceof Field) {\n            scope = newItem;\n          } else if (newItem !== oldValue) {\n            scope = scope.updatedValue(newItem.toValue());\n          }\n        } else {\n          scope = Item.absent();\n        }\n      } else {\n        // Push the value onto the scope stack.\n        interpreter.pushScope(scope);\n        // Transform the value.\n        scope = this.then.mapSelected(interpreter, transform, thisArg);\n        // Pop the value off of the scope stack.\n        interpreter.popScope();\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new ValuesSelector(then as Selector);\n  }\n\n  override andThen(then: Selector): Selector {\n    return new ValuesSelector(this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 16;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof ValuesSelector) {\n      return this.then.compareTo(that.then);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ValuesSelector) {\n      return this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ValuesSelector) {\n      return this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(ValuesSelector), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"values\").write(40/*'('*/).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new ValuesSelector(this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Record} from \"../Record\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class ChildrenSelector extends Selector {\n  constructor(then: Selector) {\n    super();\n    this.then = then;\n  }\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      // Only records can have children.\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        // For each child, while none have been selected:\n        while (selected === void 0 && children.hasNext()) {\n          const child = children.next().value!;\n          // Push the child onto the scope stack.\n          interpreter.pushScope(child);\n          // Subselect the child.\n          selected = this.then.forSelected(interpreter, callback, thisArg);\n          // Pop the child off of the scope stack.\n          interpreter.popScope();\n        }\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      // Only records can have children.\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        // For each child:\n        while (children.hasNext()) {\n          const oldChild = children.next().value!;\n          // Push the child onto the scope stack.\n          interpreter.pushScope(oldChild);\n          // Transform the child.\n          const newChild = this.then.mapSelected(interpreter, transform);\n          // Pop the child off the scope stack.\n          interpreter.popScope();\n          if (newChild.isDefined()) {\n            // Update the child, if its identity changed.\n            if (newChild !== oldChild) {\n              children.set(newChild);\n            }\n          } else {\n            // Remove the child, if it transformed to Absent.\n            children.delete();\n          }\n        }\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new ChildrenSelector(then as Selector);\n  }\n\n  override andThen(then: Selector): Selector {\n    return new ChildrenSelector(this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 17;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof ChildrenSelector) {\n      return this.then.compareTo(that.then);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ChildrenSelector) {\n      return this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof ChildrenSelector) {\n      return this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(ChildrenSelector), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"children\").write(40/*'('*/).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new ChildrenSelector(this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Record} from \"../Record\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class DescendantsSelector extends Selector {\n  constructor(then: Selector) {\n    super();\n    this.then = then;\n  }\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      // Only records can have descendants.\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        // For each child, while none have selected a result:\n        while (selected === void 0 && children.hasNext()) {\n          const child = children.next().value!;\n          // Push the child onto the scope stack.\n          interpreter.pushScope(child);\n          // Subselect the child.\n          selected = this.then.forSelected(interpreter, callback, thisArg);\n          // If the child was not selected:\n          if (selected === void 0) {\n            // Recursively select the child's children.\n            this.forSelected(interpreter, callback, thisArg);\n          }\n          // Pop the child off of the scope stack.\n          interpreter.popScope();\n        }\n      }\n      // Push the current selection back onto the stack.\n      interpreter.pushScope(scope);\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      // Pop the current selection off of the stack to take it out of scope.\n      const scope = interpreter.popScope().toValue();\n      // Only records can have descendants.\n      if (scope instanceof Record) {\n        const children = scope.iterator();\n        // For each child:\n        while (children.hasNext()) {\n          const oldChild = children.next().value!;\n          // Push the child onto the scope stack.\n          interpreter.pushScope(oldChild);\n          // Transform the child.\n          let newChild = this.then.mapSelected(interpreter, transform, thisArg);\n          // If the child was not removed:\n          if (newChild.isDefined()) {\n            // Recursively transform the child's children.\n            newChild = this.mapSelected(interpreter, transform, thisArg);\n          }\n          // Pop the child off the scope stack.\n          interpreter.popScope();\n          if (newChild.isDefined()) {\n            // Update the child, if its identity changed.\n            if (newChild !== oldChild) {\n              children.set(newChild);\n            }\n          } else {\n            // Remove the child, if it transformed to Absent.\n            children.delete();\n          }\n        }\n      }\n      // Push the transformed selection back onto the stack.\n      interpreter.pushScope(scope);\n      result = scope;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new DescendantsSelector(then as Selector);\n  }\n\n  override andThen(then: Selector): Selector {\n    return new DescendantsSelector(this.then.andThen(then));\n  }\n\n  override get typeOrder(): number {\n    return 18;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof DescendantsSelector) {\n      return this.then.compareTo(that.then);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof DescendantsSelector) {\n      return this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof DescendantsSelector) {\n      return this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(DescendantsSelector), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"descendants\").write(40/*'('*/).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new DescendantsSelector(this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyItem, Item} from \"../Item\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class FilterSelector extends Selector {\n  constructor(predicate: Selector, then: Selector) {\n    super();\n    this.predicate = predicate;\n    this.then = then;\n  }\n\n  readonly predicate: Selector;\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      // If the filter matches the selection scope:\n      if (this.filterSelected(interpreter)) {\n        // Then subselect the selection scope.\n        selected = this.then.forSelected(interpreter, callback, thisArg);\n      }\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      // If the filter matches the selection scope:\n      if (this.filterSelected(interpreter)) {\n        // Then transform the selection scope.\n        result = this.then.mapSelected(interpreter, transform, thisArg);\n      } else {\n        result = interpreter.peekScope().toValue();\n      }\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    let predicate = this.predicate.substitute(interpreter);\n    if (!(predicate instanceof Selector)) {\n      predicate = this.predicate;\n    }\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new FilterSelector(predicate as Selector, then as Selector);\n  }\n\n  protected filterSelected(interpreter: Interpreter): boolean {\n    return this.predicate.forSelected(interpreter, this.selected, this) !== void 0;\n  }\n\n  protected selected(interpreter: Interpreter): null {\n    return null;\n  }\n\n  override andThen(then: Selector): Selector {\n    return new FilterSelector(this.predicate, this.then.andThen(then));\n  }\n\n  override filter(predicate?: AnyItem): Selector {\n    if (arguments.length === 0) {\n      return this;\n    } else {\n      predicate = Item.fromAny(predicate);\n      return this.andThen(predicate.filter());\n    }\n  }\n\n  override get typeOrder(): number {\n    return 19;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof FilterSelector) {\n      let order = this.predicate.compareTo(that.predicate);\n      if (order === 0) {\n        order = this.then.compareTo(that.then);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof FilterSelector) {\n      return this.predicate.equivalentTo(that.predicate, epsilon)\n          && this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof FilterSelector) {\n      return this.predicate.equals(that.predicate) && this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(FilterSelector),\n        this.predicate.hashCode()), this.then.hashCode()));\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    output = output.write(46/*'.'*/).write(\"filter\").write(40/*'('*/)\n                   .debug(this.predicate).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override clone(): Selector {\n    return new FilterSelector(this.predicate.clone(), this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Selector} from \"./Selector\";\nimport {AnyInterpreter, Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class LiteralSelector extends Selector {\n  constructor(item: Item, then: Selector) {\n    super();\n    this.item = item.commit();\n    this.then = then;\n  }\n\n  readonly item: Item;\n\n  override readonly then: Selector;\n\n  override forSelected<T>(interpreter: Interpreter,\n                          callback: (interpreter: Interpreter) => T | undefined): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S, interpreter: Interpreter) => T | undefined,\n                             thisArg: S): T | undefined;\n  override forSelected<T, S>(interpreter: Interpreter,\n                             callback: (this: S | undefined, interpreter: Interpreter) => T | undefined,\n                             thisArg?: S): T | undefined {\n    let selected: T | undefined;\n    interpreter.willSelect(this);\n    if (interpreter.scopeDepth !== 0) {\n      const literal = this.item.evaluate(interpreter);\n      if (literal.isDefined()) {\n        // Push the literal onto the scope stack.\n        interpreter.pushScope(literal);\n        // Subselect the literal.\n        selected = this.then.forSelected(interpreter, callback, thisArg);\n        // Pop the literal off of the scope stack.\n        interpreter.popScope();\n      }\n    }\n    interpreter.didSelect(this, selected);\n    return selected;\n  }\n\n  override mapSelected(interpreter: Interpreter,\n                       transform: (interpreter: Interpreter) => Item): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S, interpreter: Interpreter) => Item,\n                          thisArg: S): Item;\n  override mapSelected<S>(interpreter: Interpreter,\n                          transform: (this: S | undefined, interpreter: Interpreter) => Item,\n                          thisArg?: S): Item {\n    let result: Item;\n    interpreter.willTransform(this);\n    if (interpreter.scopeDepth !== 0) {\n      let literal = this.item.evaluate(interpreter);\n      if (literal.isDefined()) {\n        // Push the literal onto the scope stack.\n        interpreter.pushScope(literal);\n        // Transform the literal.\n        literal = this.then.mapSelected(interpreter, transform, thisArg);\n        // Pop the literal off of the scope stack.\n        interpreter.popScope();\n      }\n      result = literal;\n    } else {\n      result = Item.absent();\n    }\n    interpreter.didTransform(this, result);\n    return result;\n  }\n\n  override substitute(interpreter: AnyInterpreter): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const item = this.item.substitute(interpreter);\n    let then = this.then.substitute(interpreter);\n    if (!(then instanceof Selector)) {\n      then = this.then;\n    }\n    return new LiteralSelector(item, then as Selector);\n  }\n\n  override andThen(then: Selector): Selector {\n    return new LiteralSelector(this.item, this.then.andThen(then));\n  }\n\n  override get precedence(): number {\n    return this.item.precedence;\n  }\n\n  override get typeOrder(): number {\n    return 11;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof LiteralSelector) {\n      let order = this.item.compareTo(that.item);\n      if (order === 0) {\n        order = this.then.compareTo(that.then);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LiteralSelector) {\n      return this.item.equivalentTo(that.item, epsilon)\n          && this.then.equivalentTo(that.then, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LiteralSelector) {\n      return this.item.equals(that.item) && this.then.equals(that.then);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(LiteralSelector),\n        this.item.hashCode()), this.then.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Selector\").write(46/*'.'*/).write(\"literal\").write(40/*'('*/)\n                   .debug(this.item).write(41/*')'*/);\n    output = this.then.debugThen(output);\n    return output;\n  }\n\n  override debugThen<T>(output: Output<T>): Output<T> {\n    return output; // blank\n  }\n\n  override clone(): Selector {\n    return new LiteralSelector(this.item.clone(), this.then.clone());\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport type {Value} from \"../Value\";\nimport {Expression} from \"../Expression\";\nimport type {InvokeOperator} from \"../operator/InvokeOperator\";\nimport type {Interpreter} from \"../interpreter/Interpreter\";\n\n/** @public */\nexport abstract class Func extends Expression {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  override isConstant(): boolean {\n    return false;\n  }\n\n  abstract override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item;\n\n  expand(args: Value, interpreter: Interpreter, operator: InvokeOperator): Item | undefined {\n    return void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Slot} from \"../Slot\";\nimport {Value} from \"../Value\";\nimport {Record} from \"../Record\";\nimport {Text} from \"../Text\";\nimport type {InvokeOperator} from \"../operator/InvokeOperator\";\nimport {Func} from \"./Func\";\nimport {Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport class LambdaFunc extends Func {\n  constructor(bindings: Value, template: Value) {\n    super();\n    this.bindings = bindings;\n    this.template = template;\n  }\n\n  readonly bindings: Value;\n\n  readonly template: Value;\n\n  override get precedence(): number {\n    return 1;\n  }\n\n  override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n    interpreter = Interpreter.fromAny(interpreter);\n    const bindings = this.bindings;\n    const arity = Math.max(1, bindings.length);\n    const params = Record.create(arity);\n    let i = 0;\n    let j = 0;\n    while (i < arity) {\n      const binding = bindings instanceof Record ? bindings.getItem(i) : i === 0 ? bindings : Item.absent();\n      const arg = args instanceof Record ? args.getItem(j).toValue() : j === 0 ? args : Value.absent();\n      if (binding instanceof Text && arg.isDistinct()) {\n        params.push(Slot.of(binding, arg));\n        j += 1;\n      } else if (binding instanceof Slot) {\n        if (arg.isDistinct()) {\n          params.push(binding.updatedValue(arg));\n        } else {\n          params.push(binding);\n        }\n        j += 1;\n      }\n      i += 1;\n    }\n    interpreter.pushScope(params);\n    const result = this.template.evaluate(interpreter);\n    interpreter.popScope();\n    return result;\n  }\n\n  override get typeOrder(): number {\n    return 50;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof LambdaFunc) {\n      let order = this.bindings.compareTo(that.bindings);\n      if (order === 0) {\n        order = this.template.compareTo(that.template);\n      }\n      return order;\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LambdaFunc) {\n      return this.bindings.equivalentTo(that.bindings, epsilon)\n          && this.template.equivalentTo(that.template, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LambdaFunc) {\n      return this.bindings.equals(that.bindings) && this.template.equals(that.template);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(LambdaFunc),\n        this.bindings.hashCode()), this.template.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.debug(this.bindings).write(46/*'.'*/).write(\"lambda\").write(40/*'('*/)\n                   .debug(this.template).write(41/*')'*/);\n    return output;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item} from \"../Item\";\nimport {Func} from \"./Func\";\n\n/** @public */\nexport abstract class BridgeFunc extends Func {\n  override get typeOrder(): number {\n    return 51;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof BridgeFunc) {\n      return Constructors.compare(this.constructor, that.constructor);\n    } else if (that instanceof Item) {\n      return Numbers.compare(this.typeOrder, that.typeOrder);\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown): boolean {\n    return this === that;\n  }\n\n  override equals(that: unknown): boolean {\n    return this === that;\n  }\n\n  override hashCode(): number {\n    return Constructors.hash(this.constructor);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(this.constructor.name);\n    return output;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item} from \"../Item\";\nimport type {Value} from \"../Value\";\nimport {Record} from \"../Record\";\nimport {Num} from \"../Num\";\nimport type {InvokeOperator} from \"../operator/InvokeOperator\";\nimport type {Func} from \"./Func\";\nimport {BridgeFunc} from \"./BridgeFunc\";\nimport {Interpreter} from \"../\"; // forward import\n\n/** @public */\nexport const MathModule = (function () {\n  const MathModule = {} as {\n    readonly max: Func;\n\n    readonly min: Func;\n\n    readonly abs: Func;\n\n    readonly ceil: Func;\n\n    readonly floor: Func;\n\n    readonly round: Func;\n\n    readonly sqrt: Func;\n\n    readonly pow: Func;\n\n    readonly rate: Func;\n\n    readonly random: Func;\n\n    readonly scope: Record;\n  };\n\n  Object.defineProperty(MathModule, \"max\", {\n    get(): Func {\n      const func = new MaxFunc();\n      Object.defineProperty(MathModule, \"max\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"min\", {\n    get(): Func {\n      const func = new MinFunc();\n      Object.defineProperty(MathModule, \"min\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"abs\", {\n    get(): Func {\n      const func = new AbsFunc();\n      Object.defineProperty(MathModule, \"abs\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"ceil\", {\n    get(): Func {\n      const func = new CeilFunc();\n      Object.defineProperty(MathModule, \"ceil\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"floor\", {\n    get(): Func {\n      const func = new FloorFunc();\n      Object.defineProperty(MathModule, \"floor\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"round\", {\n    get(): Func {\n      const func = new RoundFunc();\n      Object.defineProperty(MathModule, \"round\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"sqrt\", {\n    get(): Func {\n      const func = new SqrtFunc();\n      Object.defineProperty(MathModule, \"sqrt\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"pow\", {\n    get(): Func {\n      const func = new PowFunc();\n      Object.defineProperty(MathModule, \"pow\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"rate\", {\n    get(): Func {\n      const func = new RateFunc();\n      Object.defineProperty(MathModule, \"rate\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"random\", {\n    get(): Func {\n      const func = new RandomFunc();\n      Object.defineProperty(MathModule, \"random\", {\n        value: func,\n        enumerable: true,\n        configurable: true,\n      });\n      return func;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(MathModule, \"scope\", {\n    get(): Record {\n      const scope = Record.create(10)\n          .slot(\"max\", MathModule.max)\n          .slot(\"min\", MathModule.min)\n          .slot(\"abs\", MathModule.abs)\n          .slot(\"ceil\", MathModule.ceil)\n          .slot(\"floor\", MathModule.floor)\n          .slot(\"round\", MathModule.round)\n          .slot(\"pow\", MathModule.pow)\n          .slot(\"sqrt\", MathModule.sqrt)\n          .slot(\"rate\", MathModule.rate)\n          .slot(\"random\", MathModule.random)\n          .commit();\n      Object.defineProperty(MathModule, \"scope\", {\n        value: scope,\n        configurable: true,\n        enumerable: true,\n      });\n      return scope;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  class MaxFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      interpreter = Interpreter.fromAny(interpreter);\n      let x: Item;\n      let y: Item | undefined;\n      if (args.length >= 2) {\n        x = args.getItem(0).evaluate(interpreter);\n        y = args.getItem(1).evaluate(interpreter);\n      } else {\n        x = args.evaluate(interpreter);\n      }\n      if (y !== void 0) {\n        return x.max(y);\n      } else if (operator !== void 0) {\n        y = operator.state as Item;\n        const max = y !== void 0 ? x.max(y) : x;\n        operator.setState(max);\n        return max;\n      }\n      return Item.absent();\n    }\n\n    override expand(args: Value, interpreter: Interpreter, operator: InvokeOperator): Item | undefined {\n      if (args.length === 1) {\n        args = args.evaluate(interpreter).toValue();\n        return this.invoke(args, interpreter, operator);\n      }\n      return void 0;\n    }\n  }\n\n  class MinFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      interpreter = Interpreter.fromAny(interpreter);\n      let x: Item;\n      let y: Item | undefined;\n      if (args.length >= 2) {\n        x = args.getItem(0).evaluate(interpreter);\n        y = args.getItem(1).evaluate(interpreter);\n      } else {\n        x = args.evaluate(interpreter);\n      }\n      if (y !== void 0) {\n        return x.min(y);\n      } else if (operator !== void 0) {\n        y = operator.state as Item;\n        const min = y !== void 0 ? x.min(y) : x;\n        operator.setState(min);\n        return min;\n      }\n      return Item.absent();\n    }\n\n    override expand(args: Value, interpreter: Interpreter, operator: InvokeOperator): Item | undefined {\n      if (args.length === 1) {\n        args = args.evaluate(interpreter).toValue();\n        return this.invoke(args, interpreter, operator);\n      }\n      return void 0;\n    }\n  }\n\n  class AbsFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      args = args.evaluate(interpreter).toValue();\n      if (args instanceof Num) {\n        return args.abs();\n      }\n      return Item.absent();\n    }\n  }\n\n  class CeilFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      args = args.evaluate(interpreter).toValue();\n      if (args instanceof Num) {\n        return args.ceil();\n      }\n      return Item.absent();\n    }\n  }\n\n  class FloorFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      args = args.evaluate(interpreter).toValue();\n      if (args instanceof Num) {\n        return args.floor();\n      }\n      return Item.absent();\n    }\n  }\n\n  class RoundFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      args = args.evaluate(interpreter).toValue();\n      if (args instanceof Num) {\n        return args.round();\n      }\n      return Item.absent();\n    }\n  }\n\n  class SqrtFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      args = args.evaluate(interpreter).toValue();\n      if (args instanceof Num) {\n        return args.sqrt();\n      }\n      return Item.absent();\n    }\n  }\n\n  class PowFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      interpreter = Interpreter.fromAny(interpreter);\n      const x = args.getItem(0).evaluate(interpreter);\n      const y = args.getItem(1).evaluate(interpreter);\n      if (x instanceof Num && y instanceof Num) {\n        return x.pow(y);\n      }\n      return Item.absent();\n    }\n  }\n\n  class RateFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      interpreter = Interpreter.fromAny(interpreter);\n      let value: number;\n      let period: number;\n      if (args.length >= 2) {\n        value = args.getItem(0).evaluate(interpreter).numberValue(NaN);\n        period = args.getItem(1).evaluate(interpreter).numberValue(1000);\n      } else {\n        value = args.evaluate(interpreter).numberValue(NaN);\n        period = 1000;\n      }\n      if (isFinite(value) && operator !== void 0) {\n        let state = operator.state as {v0: number, t0: number, dv: number, dt: number} | undefined;\n        if (state === void 0) {\n          state = {v0: value, t0: Date.now(), dv: 0, dt: 0};\n          operator.setState(state);\n        } else {\n          const t1 = Date.now();\n          const dt = t1 - state.t0;\n          if (dt > period && t1 > state.t0 || dt > 2 * period) {\n            const dv = value - state.v0;\n            state.v0 = value;\n            state.t0 = t1;\n            state.dv = dv;\n            state.dt = dt;\n          }\n          operator.setState(state);\n          if (state.dt !== 0) {\n            const rate = period * state.dv / state.dt;\n            return Num.from(rate);\n          }\n        }\n      }\n      return Item.absent();\n    }\n\n    override expand(args: Value, interpreter: Interpreter, operator: InvokeOperator): Item | undefined {\n      args = args.evaluate(interpreter).toValue();\n      return this.invoke(args, interpreter, operator);\n    }\n  }\n\n  class RandomFunc extends BridgeFunc {\n    override invoke(args: Value, interpreter?: Interpreter, operator?: InvokeOperator): Item {\n      args = args.evaluate(interpreter).toValue();\n      const lower = args.length >= 1 ? args.getItem(0).numberValue(0.0) : 0.0;\n      const upper = args.length >= 2 ? args.getItem(1).numberValue(lower + 1.0) : lower + 1.0;\n      const value = lower + Math.random() * (upper - lower);\n      return Num.from(value);\n    }\n  }\n\n  return MathModule;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport class FormException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, FormException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {AnyItem, Item} from \"../Item\";\nimport {AnyValue, Value} from \"../Value\";\nimport {TagForm} from \"../\"; // forward import\nimport {UnitForm} from \"../\"; // forward import\nimport {StringForm} from \"../\"; // forward import\nimport {NumberForm} from \"../\"; // forward import\nimport {BooleanForm} from \"../\"; // forward import\nimport {AnyForm} from \"../\"; // forward import\nimport {ItemForm} from \"../\"; // forward import\nimport {ValueForm} from \"../\"; // forward import\n\n/**\n * Transformation between a structurally typed [Item] and a nominally typed\n * JavaScript object.\n * @public\n */\nexport abstract class Form<T, U = never> {\n  /**\n   * Returns the key of the tag attribute that distinguishes structures of this\n   * `Form`; returns `undefined` if this `Form` has no distinguishing tag\n   * attribute. Used to accelerate distrcrimination of polymorphic structural\n   * types with nominal type hints.\n   */\n  declare readonly tag: string | undefined; // getter defined below to work around useDefineForClassFields lunacy\n\n  /**\n   * Returns a version of this `Form` that requires a head [Attr] with the\n   * given `tag` name.\n   */\n  withTag(tag: string | undefined): Form<T, U> {\n    if (tag !== void 0 && tag !== this.tag) {\n      return new TagForm(this, tag);\n    } else {\n      return this;\n    }\n  }\n\n  /**\n   * Returns a default–possibly `undefined`–value of type `T`. Used as the\n   * fallback return value when [Item.coerce coercing] an invalid structural\n   * value.\n   */\n  declare readonly unit: T | undefined; // getter defined below to work around useDefineForClassFields lunacy\n\n  /**\n   * Returns a version of this `Form` with the given `unit` value.\n   */\n  withUnit(unit: T | undefined): Form<T, U> {\n    if (unit !== this.unit) {\n      return new UnitForm(this, unit);\n    } else {\n      return this;\n    }\n  }\n\n  /**\n   * Converts a nominally typed JavaScript `object` into its structurally typed\n   * equivalent, optionally based on the provided prototype `item`.\n   */\n  abstract mold(object: T | U, item?: Item): Item;\n\n  /**\n   * Converts a structurally typed `item` into a nominally typed JavaScript\n   * object, optionally based on the provided prototype `object`.\n   */\n  abstract cast(item: Item, object?: T): T | undefined;\n\n  @Lazy\n  static forString(): Form<string> {\n    return new StringForm(\"\");\n  }\n\n  @Lazy\n  static forNumber(): Form<number> {\n    return new NumberForm(0);\n  }\n\n  @Lazy\n  static forBoolean(): Form<boolean> {\n    return new BooleanForm(false);\n  }\n\n  @Lazy\n  static forAny(): Form<AnyItem> {\n    return new AnyForm(void 0);\n  }\n\n  @Lazy\n  static forItem(): Form<Item, AnyItem> {\n    return new ItemForm(Item.absent());\n  }\n\n  @Lazy\n  static forValue(): Form<Value, AnyValue> {\n    return new ValueForm(Value.absent());\n  }\n}\nObject.defineProperty(Form.prototype, \"tag\", {\n  get<T, U>(this: Form<T, U>): string | undefined {\n    return void 0;\n  },\n  configurable: true,\n});\nObject.defineProperty(Form.prototype, \"unit\", {\n  get<T, U>(this: Form<T, U>): T | undefined {\n    return void 0;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {Attr} from \"../Attr\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class TagForm<T, U = never> extends Form<T, U> {\n  constructor(form: Form<T, U>, tag: string) {\n    super();\n    this.form = form;\n    this.tag = tag;\n  }\n\n  /** @internal */\n  readonly form: Form<T, U>;\n\n  override readonly tag: string;\n\n  override withTag(tag: string | undefined): Form<T, U> {\n     if (tag !== void 0 && tag !== this.tag) {\n      return new TagForm(this.form, tag);\n    } else if (tag === void 0) {\n      return this.form;\n    } else {\n      return this;\n    }\n  }\n\n  override readonly unit!: T | undefined; // // getter defined below to work around useDefineForClassFields lunacy\n\n  override withUnit(unit: T | undefined): Form<T, U> {\n    if (unit !== this.unit) {\n      return new TagForm(this.form.withUnit(unit), this.tag);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: T | U, item?: Item): Item {\n    item = this.form.mold(object, item);\n    if (!item.header(this.tag).isDefined()) {\n      item = item.prepended(Attr.of(this.tag));\n    }\n    return item;\n  }\n\n  override cast(item: Item, object?: T): T | undefined {\n    if (item.header(this.tag).isDefined()) {\n      return this.form.cast(item, object);\n    } else if (item.keyEquals(this.tag)) {\n      return this.form.cast(item.toValue(), object);\n    }\n    return void 0;\n  }\n}\nObject.defineProperty(TagForm.prototype, \"unit\", {\n  get<T, U>(this: TagForm<T, U>): T | undefined {\n    return this.form.unit;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class UnitForm<T, U = never> extends Form<T, U> {\n  constructor(form: Form<T, U>, unit: T | undefined) {\n    super();\n    this.form = form;\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  /** @internal */\n  readonly form: Form<T, U>;\n\n  override readonly tag: string | undefined; // // getter defined below to work around useDefineForClassFields lunacy\n\n  override withTag(tag: string | undefined): Form<T, U> {\n    if (tag !== this.tag) {\n      return new UnitForm(this.form.withTag(tag), this.unit);\n    } else {\n      return this;\n    }\n  }\n\n  override readonly unit!: T | undefined;\n\n  override withUnit(unit: T | undefined): Form<T, U> {\n    if (unit !== this.unit) {\n      return new UnitForm(this.form, unit);\n    } else if (unit === this.form.unit) {\n      return this.form;\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: T | U, item?: Item): Item {\n    if (arguments.length === 1) {\n      return this.form.mold(object);\n    } else {\n      return this.form.mold(object, item);\n    }\n  }\n\n  override cast(item: Item, object?: T): T | undefined {\n    if (arguments.length === 1) {\n      return this.form.cast(item);\n    } else {\n      return this.form.cast(item, object);\n    }\n  }\n}\nObject.defineProperty(UnitForm.prototype, \"tag\", {\n  get<T, U>(this: UnitForm<T, U>): string | undefined {\n    return this.form.tag;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {Text} from \"../Text\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class StringForm extends Form<string> {\n  constructor(unit?: string) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: string | undefined;\n\n  override withUnit(unit: string | undefined): Form<string> {\n    if (unit !== this.unit) {\n      return new StringForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: string, item?: Item): Item {\n    if (item === void 0) {\n      return Text.from(object);\n    } else {\n      return item.concat(Text.from(object));\n    }\n  }\n\n  override cast(item: Item, object?: string): string | undefined {\n    const value = item.target;\n    try {\n      return value.stringValue();\n    } catch (error) {\n      return void 0;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {Num} from \"../Num\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class NumberForm extends Form<number> {\n  constructor(unit?: number) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: number | undefined;\n\n  override withUnit(unit: number | undefined): Form<number> {\n    if (unit !== this.unit) {\n      return new NumberForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: number, item?: Item): Item {\n    if (item === void 0) {\n      return Num.from(object);\n    } else {\n      return item.concat(Num.from(object));\n    }\n  }\n\n  override cast(item: Item, object?: number): number | undefined {\n    const value = item.target;\n    try {\n      return value.numberValue();\n    } catch (error) {\n      return void 0;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {Bool} from \"../Bool\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class BooleanForm extends Form<boolean> {\n  constructor(unit?: boolean) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: boolean | undefined;\n\n  override withUnit(unit: boolean | undefined): Form<boolean> {\n    if (unit !== this.unit) {\n      return new BooleanForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: boolean, item?: Item): Item {\n    if (item === void 0) {\n      return Bool.from(object);\n    } else {\n      return item.concat(Bool.from(object));\n    }\n  }\n\n  override cast(item: Item, object?: boolean): boolean | undefined {\n    const value = item.target;\n    try {\n      return value.booleanValue();\n    } catch (error) {\n      return void 0;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyItem, Item} from \"../Item\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class AnyForm extends Form<AnyItem> {\n  constructor(unit?: AnyItem) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: AnyItem | undefined;\n\n  override withUnit(unit: AnyItem | undefined): Form<AnyItem> {\n    if (unit !== this.unit) {\n      return new AnyForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: AnyItem, item?: Item): Item {\n    object = Item.fromAny(object);\n    if (item !== void 0) {\n      object = item.concat(object);\n    }\n    return object;\n  }\n\n  override cast(item: Item, object?: AnyItem): AnyItem | undefined {\n    return item.toAny();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyItem, Item} from \"../Item\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class ItemForm extends Form<Item, AnyItem> {\n  constructor(unit?: Item) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit !== void 0 ? unit.commit() : void 0,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: Item | undefined;\n\n  override withUnit(unit: Item | undefined): Form<Item> {\n    if (unit !== this.unit) {\n      return new ItemForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: AnyItem, item?: Item): Item {\n    object = Item.fromAny(object);\n    if (item !== void 0) {\n      object = item.concat(object);\n    }\n    return object;\n  }\n\n  override cast(item: Item, object?: Item): Item | undefined {\n    return item;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"../Item\";\nimport {AnyValue, Value} from \"../Value\";\nimport {Form} from \"./Form\";\n\n/** @internal */\nexport class ValueForm extends Form<Value, AnyValue> {\n  constructor(unit?: Value) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit !== void 0 ? unit.commit() : void 0,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: Value | undefined;\n\n  override withUnit(unit: Value | undefined): Form<Value> {\n    if (unit !== this.unit) {\n      return new ValueForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: AnyValue, item?: Item): Item {\n    object = Value.fromAny(object);\n    if (item !== void 0) {\n      object = item.concat(object);\n    }\n    return object;\n  }\n\n  override cast(item: Item, object?: Value): Value | undefined {\n    return item.toValue();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport type {Value} from \"../Value\";\nimport type {Form} from \"../form/Form\";\n\n/** @internal */\nexport class ValueCursor<V> extends Cursor<V> {\n  constructor(cursor: Cursor<Value>, form: Form<V, unknown>) {\n    super();\n    this.cursor = cursor;\n    this.form = form;\n  }\n\n  /** @internal */\n  readonly cursor: Cursor<Value>;\n\n  /** @internal */\n  readonly form: Form<V, unknown>;\n\n  override isEmpty(): boolean {\n    return this.cursor.isEmpty();\n  }\n\n  override head(): V {\n    const value = this.cursor.head();\n    return value.coerce(this.form);\n  }\n\n  override step(): void {\n    this.cursor.step();\n  }\n\n  override skip(count: number): void {\n    this.cursor.skip(count);\n  }\n\n  override hasNext(): boolean {\n    return this.cursor.hasNext();\n  }\n\n  override nextIndex(): number {\n    return this.cursor.nextIndex();\n  }\n\n  override next(): {value?: V, done: boolean} {\n    const {value, done} = this.cursor.next();\n    if (value !== void 0) {\n      return {value: value.coerce(this.form), done};\n    } else {\n      return {done};\n    }\n  }\n\n  override hasPrevious(): boolean {\n    return this.cursor.hasPrevious();\n  }\n\n  override previousIndex(): number {\n    return this.cursor.previousIndex();\n  }\n\n  override previous(): {value?: V, done: boolean} {\n    const {value, done} = this.cursor.previous();\n    if (value !== void 0) {\n      return {value: value.coerce(this.form), done};\n    } else {\n      return {done};\n    }\n  }\n\n  override delete(): void {\n    this.cursor.delete();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport type {Value} from \"../Value\";\nimport type {Form} from \"../form/Form\";\n\n/** @internal */\nexport class ValueEntryCursor<K, V> extends Cursor<[K, V]> {\n  constructor(cursor: Cursor<[Value, Value]>, keyForm: Form<K, unknown>, valueForm: Form<V, unknown>) {\n    super();\n    this.cursor = cursor;\n    this.keyForm = keyForm;\n    this.valueForm = valueForm;\n  }\n\n  /** @internal */\n  readonly cursor: Cursor<[Value, Value]>;\n\n  /** @internal */\n  readonly keyForm: Form<K, unknown>;\n\n  /** @internal */\n  readonly valueForm: Form<V, unknown>;\n\n  override isEmpty(): boolean {\n    return this.cursor.isEmpty();\n  }\n\n  override head(): [K, V] {\n    const pair = this.cursor.head();\n    return [pair[0].coerce(this.keyForm), pair[1].coerce(this.valueForm)];\n  }\n\n  override step(): void {\n    this.cursor.step();\n  }\n\n  override skip(count: number): void {\n    this.cursor.skip(count);\n  }\n\n  override hasNext(): boolean {\n    return this.cursor.hasNext();\n  }\n\n  override nextIndex(): number {\n    return this.cursor.nextIndex();\n  }\n\n  override next(): {value?: [K, V], done: boolean} {\n    const {value, done} = this.cursor.next();\n    if (value !== void 0) {\n      return {value: [value[0].coerce(this.keyForm), value[1].coerce(this.valueForm)], done};\n    } else {\n      return {done};\n    }\n  }\n\n  override hasPrevious(): boolean {\n    return this.cursor.hasPrevious();\n  }\n\n  override previousIndex(): number {\n    return this.cursor.previousIndex();\n  }\n\n  override previous(): {value?: [K, V], done: boolean} {\n    const {value, done} = this.cursor.previous();\n    if (value !== void 0) {\n      return {value: [value[0].coerce(this.keyForm), value[1].coerce(this.valueForm)], done};\n    } else {\n      return {done};\n    }\n  }\n\n  override delete(): void {\n    this.cursor.delete();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Outlet} from \"./Outlet\";\n\n/** @public */\nexport type InletType = \"value\" | \"map\";\n\n/** @public */\nexport interface InletOptions {\n  name?: string;\n  type?: InletType;\n}\n\n/**\n * Input connector into a [[Streamlet]]. An `Inlet` represents a source from\n * which a `Streamlet` acquires state.\n *\n * In order for an `Inlet` to provide state to its `Streamlet`, it must bind to\n * an [[input]] source. The input source of an `Inlet` is an [[Outlet]] of\n * some other `Streamlet`. The [[bindInput]] method \"plugs\" the `Inlet` into\n * an `Outlet`. The [[unbindInput]] method \"unplugs\" the `Inlet` from its\n * connected `Outlet`.\n *\n * The state of an `Inlet` has an integral _version_. When its version is\n * negative, the state of the `Inlet` is considered _decoherent_. When any\n * state on which an `Inlet` transitively depends changes, the `Inlet` will be\n * [[decohereOutput decohered]]. Decoherence does not immediately cause an\n * `Inlet` to recompute its state. Instead, a separate [[recohereOutput\n * recohere]] step causes all of the decoherent paths in the dataflow graph\n * passing through the `Inlet` to make their states coherent again.\n *\n * @public\n */\nexport interface Inlet<I = unknown> {\n  /**\n   * The `Outlet` from which this `Inlet` acquires its state, or `null` if\n   * this `Inlet` is disconnected.\n   */\n  readonly input: Outlet<I> | null;\n\n  /**\n   * Connects this `Inlet` to an `Outlet` from which it will  acquire its\n   * state. If this `Inlet` is already connected, it will first disconnect\n   * from its existing input. Then, after updating its [[input]] property,\n   * the `Inlet` will invoke [[Outlet.bindOutput]] on its new `input`.\n   */\n  bindInput(input: Outlet<I> | null): void;\n\n  /**\n   * Disconnects this `Inlet` from its input `Outlet`, if connected. After\n   * setting its [[input]] property to `null`, the `Inlet` will invoke\n   * [[Outlet.unbindOutput]] on its old input, if defined.\n   */\n  unbindInput(): void;\n\n  /**\n   * Disconnects all `Inlet`s dominated by this `Inlet` in the dataflow\n   * dependency graph. Used to recursively clean up chains of combinators\n   * terminating at this `Inlet`.\n   */\n  disconnectInputs(): void;\n\n  /**\n   * Disconnects all `Outlet`s dominated by this `Inlet` in the dataflow graph.\n   * Used to recursively clean up chains of combinators passing through this\n   * `Inlet`.\n   */\n  disconnectOutputs(): void;\n\n  /**\n   * Marks this `Inlet`—and the `Streamlet` to which this `Inlet` is attached—as\n   * having decoherent state. Decohering an `Inlet` will recursively decohere\n   * all streamlets that transitively depend on the state of this `Inlet`.\n   * Decohering an `Inlet` does not cause its state to be recomputed. A\n   * subsequent [[recohereOutput]] call will eventually make the state of the\n   * `Inlet` coherent again.\n   */\n  decohereOutput(): void;\n\n  /**\n   * Updates the state of this `Inlet` to make it consistent with the target\n   * `version`. The `Inlet` only needs to update if its current `version`\n   * differs from the target `version`. To update its state, the `Inlet` first\n   * invokes [[Outlet.recohereInput]] on its [[input]], to ensure that its\n   * input is coherent. It then invokes [[Streamlet.recohere]] on the\n   * `Streamlet` to which it's attached, causing the `Streamlet` to make its\n   * own state coherent again.\n   */\n  recohereOutput(version: number): void;\n}\n\n/** @public */\nexport const Inlet = (function () {\n  const Inlet = {} as {\n     is<I>(object: unknown): object is Inlet<I>;\n  };\n\n  Inlet.is = function <I>(object: unknown): object is Inlet<I> {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const inlet = object as Inlet<I>;\n      return \"input\" in inlet\n          && typeof inlet.bindInput === \"function\"\n          && typeof inlet.unbindInput === \"function\";\n    }\n    return false;\n  };\n\n  return Inlet;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Iterator} from \"@swim/util\";\nimport type {Inlet} from \"./Inlet\";\nimport type {OutletCombinators} from \"./OutletCombinators\";\nimport type {MapValueFunction, WatchValueFunction} from \"./function\";\n\n/** @public */\nexport type OutletType = \"value\" | \"map\";\n\n/** @public */\nexport interface OutletOptions {\n  name?: string;\n  type?: OutletType;\n}\n\n/**\n * Output connector from a [[Streamlet]]. An `Outlet` represents a sink to\n * which a `Streamlet` provides state.\n *\n * An `Outlet` has a one-to-many relationship with a set of output sinks.\n * An output sink of an `Outlet` is an `Inlet` of some other `Streamlet`.\n * The [[bindOutput]] method \"plugs\" an `Inlet` into the `Outlet`.\n * The [[unbindOutput]] method \"unplugs\" an `Inlet` from the `Outlet`.\n *\n * @public\n */\nexport interface Outlet<O = unknown> extends OutletCombinators<O> {\n  /**\n   * Returns the current state of this `Outlet`.\n   */\n  get(): O | undefined;\n\n  /**\n   * Returns an `Iterator` over the set of `Inlet`s that depend on the state of\n   * this `Outlet`.\n   */\n  outputIterator(): Iterator<Inlet<O>>;\n\n  /**\n   * Adds an `output` to the set of `Inlet`s that depend on the state of this\n   * `Outlet`. The `output` will be decohered when the state of this\n   * `Outlet` is decohered, and recohered when this `Outlet` is recohered.\n   */\n  bindOutput(output: Inlet<O>): void;\n\n  /**\n   * Removes an `output` from the set of `Inlet`s that depend on the state of\n   * this `Outlet`.\n   */\n  unbindOutput(output: Inlet<O>): void;\n\n  /**\n   * Disconnects all outputs from this `Outlet` by invoking\n   * [[Inlet.unbindInput]] on each `Inelt` that depends on the state of this\n   * `Outlet`.\n   */\n  unbindOutputs(): void;\n\n  /**\n   * Disconnects all `Outlet`s dominated by this `Outlet` in the dataflow\n   * graph. Used to recursively clean up chains of combinators originating\n   * from this `Inlet`.\n   */\n  disconnectOutputs(): void;\n\n  /**\n   * Disconnects all `Inlet`s dominated by this `Outlet` in the dataflow\n   * dependency graph. Used to recursively clean up chains of combinators\n   * passing through this `Outlet`.\n   */\n  disconnectInputs(): void;\n\n  /**\n   * Marks this `Outlet`—and all [[outputIterator outputs]] that depend on the\n   * state of this `Outlet`—as having decoherent state.\n   */\n  decohereInput(): void;\n\n  /**\n   * Updates the state of this `Outlet` to make it consistent with the target\n   * `version`. The `Outlet` only needs to update if its current `version`\n   * differs from the target `version`. To update its state, the `Outlet`\n   * first invokes [[Streamlet.recohere]] on the `Streamlet` to which\n   * it's attached. It then invokes [[Inlet.recohereOutput]] on each of its\n   * dependent [[outputIterator outputs]].\n   */\n  recohereInput(version: number): void;\n\n  memoize(): Outlet<O>;\n\n  map<O2>(func: MapValueFunction<O, O2>): Outlet<O2>;\n\n  watch(func: WatchValueFunction<O>): this;\n}\n\n/** @public */\nexport const Outlet = (function () {\n  const Outlet = {} as {\n    is<O>(object: unknown): object is Outlet<O>;\n  };\n\n  Outlet.is = function <O>(object: unknown): object is Outlet<O> {\n    if (typeof object === \"object\" && object !== null) {\n      const outlet = object as Outlet<O>;\n      return typeof outlet.outputIterator === \"function\"\n          && typeof outlet.bindOutput === \"function\"\n          && typeof outlet.unbindOutput === \"function\";\n    }\n    return false;\n  };\n\n  return Outlet;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Outlet} from \"./Outlet\";\nimport type {MapValueFunction, WatchValueFunction} from \"./function\";\nimport {MemoizeValueCombinator} from \"./\"; // forward import\nimport {MapValueCombinator} from \"./\"; // forward import\nimport {WatchValueCombinator} from \"./\"; // forward import\n\n/** @public */\nexport interface OutletCombinators<O> {\n  memoize(): Outlet<O>;\n\n  map<O2>(func: MapValueFunction<O, O2>): Outlet<O2>;\n\n  watch(func: WatchValueFunction<O>): this;\n}\n\n/** @public */\nexport const OutletCombinators = (function () {\n  const OutletCombinators = {} as {\n    define<O>(prototype: OutletCombinators<O>): void;\n\n    /** @internal */\n    memoize<O>(this: Outlet<O>): Outlet<O>;\n\n    /** @internal */\n    map<O, O2>(this: Outlet<O>, func: MapValueFunction<O, O2>): Outlet<O2>;\n\n    /** @internal */\n    watch<O>(this: Outlet<O>, func: WatchValueFunction<O>): Outlet<O>;\n  };\n\n  OutletCombinators.define = function <O>(prototype: Outlet<O>): void {\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"memoize\")) {\n      prototype.memoize = OutletCombinators.memoize;\n    }\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"map\")) {\n      prototype.map = OutletCombinators.map;\n    }\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"watch\")) {\n      prototype.watch = OutletCombinators.watch;\n    }\n  };\n\n  OutletCombinators.memoize = function <O>(this: Outlet<O>): Outlet<O> {\n    const combinator = new MemoizeValueCombinator<O>();\n    combinator.bindInput(this);\n    return combinator;\n  };\n\n  OutletCombinators.map = function <O, O2>(this: Outlet<O>, func: MapValueFunction<O, O2>): Outlet<O2> {\n    const combinator = new MapValueCombinator<O, O2>(func);\n    combinator.bindInput(this);\n    return combinator;\n  };\n\n  OutletCombinators.watch = function <O>(this: Outlet<O>, func: WatchValueFunction<O>): Outlet<O> {\n    const combinator = new WatchValueCombinator<O>(func);\n    combinator.bindInput(this);\n    return this;\n  };\n\n  return OutletCombinators;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport const enum KeyEffect {\n  Update,\n  Remove,\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Inlet} from \"./Inlet\";\nimport type {KeyEffect} from \"./KeyEffect\";\n\n/**\n * Input connector into a `Streamlet` for a key-value map state.\n * @public\n */\nexport interface MapInlet<K, V, I> extends Inlet<I> {\n  /**\n   * Marks this `MapInlet` as needing an `effect` applied to a given `key`.\n   * Decohering an individual key decoheres the entire state of the `Inlet`.\n   * But only the decoherent keys need to be updated in order to recohere the\n   * overall state of the `Inlet`.\n   */\n  decohereOutputKey(key: K, effect: KeyEffect): void;\n\n  /**\n   * Updates the state of an individual `key` in this `MapInlet` to make it\n   * consistent with the target `version`. The `MapInlet` only needs to update\n   * if the current `version` differs from the target `version`. To update the\n   * state of a key, the `MapInlet` first invokes [[MapOutlet.recohereInputKey]]\n   * on its [[input]], if its input is a `MapOutlet`, or it invokes\n   * [[Outlet.recohereInput]], if its input is not a `MapOutlet`. Then,\n   * if all decoherent keys have been recohered, the `MapInlet` invokes\n   * [[Streamlet.recohere]] on its attached streamlet.\n   */\n  recohereOutputKey(key: K, version: number): void;\n}\n\n/** @public */\nexport const MapInlet = (function () {\n  const MapInlet = {} as {\n    is<K, V, I>(object: unknown): object is MapInlet<K, V, I>;\n  };\n\n  MapInlet.is = function <K, V, I>(object: unknown): object is MapInlet<K, V, I> {\n    if (typeof object === \"object\" && object !== null) {\n      const inlet = object as MapInlet<K, V, I>;\n      return Inlet.is(inlet)\n          && typeof inlet.decohereOutputKey === \"function\"\n          && typeof inlet.recohereOutputKey === \"function\";\n    }\n    return false;\n  };\n\n  return MapInlet;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Iterator, Map} from \"@swim/util\";\nimport {Outlet} from \"./Outlet\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport type {MapOutletCombinators} from \"./MapOutletCombinators\";\nimport type {FilterFieldsFunction} from \"./function\";\nimport type {MapValueFunction, MapFieldValuesFunction} from \"./function\";\nimport type {WatchValueFunction, WatchFieldsFunction} from \"./function\";\n\n/**\n * Output connector from a [[Streamlet]] for a key-value map state.\n * @public\n */\nexport interface MapOutlet<K, V, O> extends Outlet<O>, MapOutletCombinators<K, V, O> {\n  /**\n   * Returns `true` if the current state of this `MapOutlet` contains the given\n   * `key`; otherwise returns `false`.\n   */\n  has(key: K): boolean;\n\n  /**\n   * Returns the current state of this `Outlet`.\n   */\n  get(): O | undefined;\n\n  /**\n   * Returns the value assocaited with the given `key` in the current state of\n   * this `MapOutlet`, if defined; otherwise returns `undefined`.\n   */\n  get(key: K): V | undefined;\n\n  /**\n   * Returns an `Iterator` over the keys in the current state of this `MapOutlet`.\n   */\n  keyIterator(): Iterator<K>;\n\n  /**\n   * Returns an `Outlet` that updates when the specified `key` updates.\n   */\n  outlet(key: K): Outlet<V>;\n\n  /**\n   * Marks this `MapOutlet` as needing an `effect` applied to a given `key`.\n   * Decohering an individual key decoheres the entire state of the `Outlet`.\n   * But only the decoherent keys need to be updated in order to recohere the\n   * overall state of the `Outlet`.\n   */\n  decohereInputKey(key: K, effect: KeyEffect): void;\n\n  /**\n   * Updates the state of an individual `key` in this `MapOutlet` to make it\n   * consistent with the target `version`. The `MapOutlet` only needs to\n   * update if its current `version` differs from the target `version`.\n   * To update the state of a key, the `MapOutlet` first invokes\n   * [[Streamlet.recohere]] on its attached streamlets. Then, for each\n   * dependent output, it invokes [[MapInlet.recohereOutputKey]], if the\n   * dependent output is a [[MapInlet]], or it invokes [[Inlet.recohere]],\n   * if the dependent output is not a `MapInlet`.\n   */\n  recohereInputKey(key: K, version: number): void;\n\n  memoize(): MapOutlet<K, V, O>;\n\n  filter(func: FilterFieldsFunction<K, V>): MapOutlet<K, V, Map<K, V>>;\n\n  map<O2>(func: MapValueFunction<O, O2>): Outlet<O2>;\n  map<V2>(func: MapFieldValuesFunction<K, V, V2>): MapOutlet<K, V2, Map<K, V2>>;\n\n  reduce<U>(identity: U, accumulator: (result: U, element: V) => U, combiner: (result: U, result2: U) => U): Outlet<U>;\n\n  watch(func: WatchValueFunction<O>): this;\n  watch(func: WatchFieldsFunction<K, V>): this;\n}\n\n/** @public */\nexport const MapOutlet = (function () {\n  const MapOutlet = {} as {\n    is<K, V, I>(object: unknown): object is MapOutlet<K, V, I>;\n  };\n\n  MapOutlet.is = function <K, V, I>(object: unknown): object is MapOutlet<K, V, I> {\n    if (typeof object === \"object\" && object !== null) {\n      const outlet = object as MapOutlet<K, V, I>;\n      return Outlet.is(outlet)\n          && typeof outlet.keyIterator === \"function\"\n          && typeof outlet.outlet === \"function\";\n    }\n    return false;\n  };\n\n  return MapOutlet;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Map} from \"@swim/util\";\nimport type {Outlet} from \"./Outlet\";\nimport type {OutletCombinators} from \"./OutletCombinators\";\nimport type {MapOutlet} from \"./MapOutlet\";\nimport type {FilterFieldsFunction} from \"./function\";\nimport type {MapValueFunction, MapFieldValuesFunction} from \"./function\";\nimport type {WatchValueFunction, WatchFieldsFunction} from \"./function\";\nimport {MemoizeMapCombinator} from \"./\"; // forward import\nimport {FilterFieldsCombinator} from \"./\"; // forward import\nimport {MapValueCombinator} from \"./\"; // forward import\nimport {MapFieldValuesCombinator} from \"./\"; // forward import\nimport {ReduceFieldsCombinator} from \"./\"; // forward import\nimport {WatchValueCombinator} from \"./\"; // forward import\nimport {WatchFieldsCombinator} from \"./\"; // forward import\n\n/** @public */\nexport interface MapOutletCombinators<K, V, O> extends OutletCombinators<O> {\n  memoize(): MapOutlet<K, V, O>;\n\n  filter(func: FilterFieldsFunction<K, V>): MapOutlet<K, V, Map<K, V>>;\n\n  map<O2>(func: MapValueFunction<O, O2>): Outlet<O2>;\n  map<V2>(func: MapFieldValuesFunction<K, V, V2>): MapOutlet<K, V2, Map<K, V2>>;\n\n  reduce<U>(identity: U, accumulator: (result: U, element: V) => U, combiner: (result: U, result2: U) => U): Outlet<U>;\n\n  watch(func: WatchValueFunction<O>): this;\n  watch(func: WatchFieldsFunction<K, V>): this;\n}\n\n/** @public */\nexport const MapOutletCombinators = (function () {\n  const MapOutletCombinators = {} as {\n    define<K, V, O>(prototype: MapOutletCombinators<K, V, O>): void;\n\n    /** @internal */\n    memoize<K, V, O>(this: MapOutlet<K, V, O>): MapOutlet<K, V, O>;\n\n    /** @internal */\n    filter<K, V, O>(this: MapOutlet<K, V, O>, func: FilterFieldsFunction<K, V>): MapOutlet<K, V, Map<K, V>>;\n\n    /** @internal */\n    map<K, V, O, O2>(this: MapOutlet<K, V, O>, func: MapValueFunction<O, O2>): Outlet<O2>;\n    /** @internal */\n    map<K, V, O, V2>(this: MapOutlet<K, V, O>, func: MapFieldValuesFunction<K, V, V2>): MapOutlet<K, V2, Map<K, V2>>;\n\n    /** @internal */\n    reduce<K, V, O, U>(this: MapOutlet<K, V, O>, identity: U, accumulator: (result: U, element: V) => U, combiner: (result: U, result2: U) => U): Outlet<U>;\n\n    /** @internal */\n    watch<K, V, O>(this: MapOutlet<K, V, O>, func: WatchValueFunction<O>): MapOutlet<K, V, O>;\n    /** @internal */\n    watch<K, V, O>(this: MapOutlet<K, V, O>, func: WatchFieldsFunction<K, V>): MapOutlet<K, V, O>;\n  };\n\n  MapOutletCombinators.define = function <K, V, O>(prototype: MapOutlet<K, V, O>): void {\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"memoize\")) {\n      prototype.memoize = MapOutletCombinators.memoize;\n    }\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"filterr\")) {\n      prototype.filter = MapOutletCombinators.filter;\n    }\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"map\")) {\n      prototype.map = MapOutletCombinators.map;\n    }\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"reduce\")) {\n      prototype.reduce = MapOutletCombinators.reduce;\n    }\n    if (!Object.prototype.hasOwnProperty.call(prototype, \"watch\")) {\n      prototype.watch = MapOutletCombinators.watch;\n    }\n  };\n\n  MapOutletCombinators.memoize = function <K, V, O>(this: MapOutlet<K, V, O>): MapOutlet<K, V, O> {\n    const combinator = new MemoizeMapCombinator<K, V, O>();\n    combinator.bindInput(this);\n    return combinator;\n  };\n\n  MapOutletCombinators.filter = function <K, V, O>(this: MapOutlet<K, V, O>, func: FilterFieldsFunction<K, V>): MapOutlet<K, V, Map<K, V>> {\n    const combinator = new FilterFieldsCombinator<K, V, O>(func);\n    combinator.bindInput(this);\n    return combinator;\n  };\n\n  MapOutletCombinators.map = function <K, V, O, V2>(this: MapOutlet<K, V, O>, func: MapValueFunction<O, V2> | MapFieldValuesFunction<K, V, V2>): Outlet<V2> | MapOutlet<K, V2, Map<K, V2>> {\n    if (func.length === 1) {\n      const combinator = new MapValueCombinator<O, V2>(func as MapValueFunction<O, V2>);\n      combinator.bindInput(this);\n      return combinator;\n    } else {\n      const combinator = new MapFieldValuesCombinator<K, V, V2, O>(func as MapFieldValuesFunction<K, V, V2>);\n      combinator.bindInput(this);\n      return combinator;\n    }\n  } as typeof MapOutletCombinators.map;\n\n  MapOutletCombinators.reduce = function <K, V, O, U>(this: MapOutlet<K, V, O>, identity: U, accumulator: (result: U, element: V) => U, combiner: (result: U, result2: U) => U): Outlet<U> {\n    const combinator = new ReduceFieldsCombinator<K, V, O, U>(identity, accumulator, combiner);\n    combinator.bindInput(this);\n    return combinator;\n  };\n\n  MapOutletCombinators.watch = function <K, V, O>(this: MapOutlet<K, V, O>, func: WatchValueFunction<O> | WatchFieldsFunction<K, V>): MapOutlet<K, V, O> {\n    if (func.length === 1) {\n      const combinator = new WatchValueCombinator<O>(func as WatchValueFunction<O>);\n      combinator.bindInput(this);\n      return this;\n    } else {\n      const combinator = new WatchFieldsCombinator<K, V, O>(func as WatchFieldsFunction<K, V>);\n      combinator.bindInput(this);\n      return this;\n    }\n  };\n\n  return MapOutletCombinators;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport class StreamletException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, StreamletException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Outlet} from \"./Outlet\";\nimport type {StreamletContext} from \"./StreamletContext\";\n\n/** @public */\nexport interface StreamletScope<O> {\n  /**\n   * The lexically scoped parent of this `StreamletScope`, or `null` if this\n   * `StreamletScope` has no lexical parent.\n   */\n  readonly streamletScope: StreamletScope<O> | null;\n\n  /**\n   * The environment in which this `StreamletScope` operates.\n   */\n  readonly streamletContext: StreamletContext | null;\n\n  /**\n   * Returns an `Outlet` that updates when the specified `key` updates.\n   */\n  outlet(key: string): Outlet<O> | null;\n}\n\n/** @public */\nexport const StreamletScope = (function () {\n  const StreamletScope = {} as {\n    is<O>(object: unknown): object is StreamletScope<O>;\n  };\n\n  StreamletScope.is = function <O>(object: unknown): object is StreamletScope<O> {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const scope = object as StreamletScope<O>;\n      return \"streamletScope\" in scope\n          && \"streamletContext\" in scope\n          && typeof scope.outlet === \"function\";\n    }\n    return false;\n  };\n\n  return StreamletScope;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\nimport type {StreamletContext} from \"./StreamletContext\";\nimport type {StreamletScope} from \"./StreamletScope\";\n\n/**\n * Stateful node in a dataflow graph that uses the state of its [[Inlet\n * inlets]] to compute the state of its [[Outlet Outlets]].\n * @public\n */\nexport interface Streamlet<I = unknown, O = I> extends StreamletScope<O> {\n  /**\n   * The lexically scoped parent of this `Streamlet`, or `null` if this\n   * `Streamlet` has no lexical parent.\n   */\n  readonly streamletScope: StreamletScope<O> | null;\n\n  /**\n   * Sets the lexically scoped parent of this `Streamlet`.\n   */\n  setStreamletScope(scope: StreamletScope<O> | null): void;\n\n  /**\n   * The environment in which this `Streamlet` operates.\n   */\n  readonly streamletContext: StreamletContext | null;\n\n  /**\n   * Sets the environment in which this `Streamlet` operates.\n   */\n  setStreamletContext(context: StreamletContext | null): void;\n\n  /**\n   * Returns the `Inlet` to this `Streamlet` identified by the given `key`;\n   * returns `null` if this `Streamlet` has no such `Inlet`.\n   */\n  inlet(key: string): Inlet<I> | null;\n\n  /**\n   * Connects the `Inlet` of this `Streamlet`, identified by the given `key` to\n   * the `input` from which the `Inlet` should acquire its state. Delegates to\n   * [[Inlet.bindInput]] on the identified `Inlet`.\n   *\n   * @throws `Error` if this `Streamlet` has no `Inlet` with the given `key`.\n   */\n  bindInput(key: string, input: Outlet<I>): void;\n\n  /**\n   * Disconnects the `Inlet` of this `Streamlet`, identified by the given\n   * `key`, from its [[Inlet.input input]] `Outlet`, if connected. Delegates\n   * to [[Inlet.unbindInput]] on the identified `Inlet`.\n   *\n   * @throws `Error` if this `Streamlet` has no `Inlet` with the given `key`.\n   */\n  unbindInput(key: string): void;\n\n  /**\n   * Returns the `Outlet` of this `Streamlet` identified by the given `key`;\n   * returns `null` if this `Streamlet` has no such `Outlet`.\n   */\n  outlet(key: string): Outlet<O> | null;\n\n  /**\n   * Disconnects all `Inlet`s dominated by this `Streamlet` in the dataflow\n   * dependency graph. Used to recursively clean up chains of combinators\n   * terminating at this `Streamlet`.\n   */\n  disconnectInputs(): void;\n\n  /**\n   * Disconnects all `Inlets`s dominated by this `Streamlet` in the dataflow\n   * graph. Used to recursively clean up chains of combinators originating\n   * from this `Streamlet`.\n   */\n  disconnectOutputs(): void;\n\n  /**\n   * Marks this `Streamlet`—and all of its outlets—as having decoherent state.\n   * Decohering a `Streamlet` will recursively decohere all streamlets that\n   * transitively depend on the state of this `Streamlet`. Decohering a\n   * `Streamlet` does not cause its state to be recomputed. A subsequent\n   * [[recohere]] call will eventually make the state of the `Streamlet`\n   * coherent again.\n   */\n  decohere(): void;\n\n  /**\n   * Updates the state of this `Streamlet` to make it consistent with the\n   * target `version`. The `Streamlet` only needs to update if its current\n   * `version` differs from the target `version`. To update its state, the\n   * `Streamlet` first invokes [[Inlet.recohereOutput]] on each of its inlets,\n   * to ensure that its input states are coherent. It then recomputes its own\n   * state in an implementation defined manner. Finally, it invokes\n   * [[Outlet.recohereInput]] on its outlets, causing all transitively\n   * dependent streamlets to make their own states coherent again.\n   */\n  recohere(version: number): void;\n}\n\n/** @public */\nexport const Streamlet = (function () {\n  const Streamlet = {} as {\n    is<I, O>(object: unknown): object is Streamlet<I, O>;\n  };\n\n  Streamlet.is = function <I, O>(object: unknown): object is Streamlet<I, O> {\n    if (typeof object === \"object\" && object !== null || typeof object === \"function\") {\n      const streamlet = object as Streamlet<I, O>;\n      return \"streamletScope\" in streamlet\n          && typeof streamlet.setStreamletScope === \"function\"\n          && \"streamletContext\" in streamlet\n          && typeof streamlet.setStreamletContext === \"function\";\n    }\n    return false;\n  };\n\n  return Streamlet;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\n\n/** @public */\nexport abstract class AbstractInlet<I> implements Inlet<I> {\n  constructor() {\n    this.input = null;\n    this.version = -1;\n  }\n\n  readonly input: Outlet<I> | null;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: Outlet<I> | null): void {\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  disconnectOutputs(): void {\n    // nop\n  }\n\n  decohereOutput(): void {\n    if (this.version >= 0) {\n      this.willDecohereOutput();\n      (this as Mutable<this>).version = -1;\n      this.onDecohereOutput();\n      this.didDecohereOutput();\n    }\n  }\n\n  recohereOutput(version: number): void {\n    if (this.version < 0) {\n      this.willRecohereOutput(version);\n      (this as Mutable<this>).version = version;\n      if (this.input !== null) {\n        this.input.recohereInput(version);\n      }\n      this.onRecohereOutput(version);\n      this.didRecohereOutput(version);\n    }\n  }\n\n  protected willDecohereOutput(): void {\n    // hook\n  }\n\n  protected onDecohereOutput(): void {\n    // hook\n  }\n\n  protected didDecohereOutput(): void {\n    // hook\n  }\n\n  protected willRecohereOutput(version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutput(version: number): void {\n    // hook\n  }\n\n  protected didRecohereOutput(version: number): void {\n    // hook\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Cursor} from \"@swim/util\";\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\nimport {OutletCombinators} from \"./OutletCombinators\";\n\n/** @public */\nexport abstract class AbstractOutlet<O> implements Outlet<O> {\n  constructor() {\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<O>>;\n\n  /** @internal */\n  readonly version: number;\n\n  abstract get(): O | undefined;\n\n  outputIterator(): Cursor<Inlet<O>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  disconnectInputs(): void {\n    // nop\n  }\n\n  decohereInput(): void {\n    if (this.version >= 0) {\n      this.willDecohereInput();\n      (this as Mutable<this>).version = -1;\n      this.onDecohereInput();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        outputs[i]!.decohereOutput();\n      }\n      this.didDecohereInput();\n    }\n  }\n\n  recohereInput(version: number): void {\n    if (this.version < 0) {\n      this.willRecohereInput(version);\n      (this as Mutable<this>).version = version;\n      this.onRecohereInput(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        outputs[i]!.recohereOutput(version);\n      }\n      this.didRecohereInput(version);\n    }\n  }\n\n  protected willDecohereInput(): void {\n    // hook\n  }\n\n  protected onDecohereInput(): void {\n    // hook\n  }\n\n  protected didDecohereInput(): void {\n    // hook\n  }\n\n  protected willRecohereInput(version: number): void {\n    // hook\n  }\n\n  protected onRecohereInput(version: number): void {\n    // hook\n  }\n\n  protected didRecohereInput(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface AbstractOutlet<O> extends OutletCombinators<O> {\n}\nOutletCombinators.define(AbstractOutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Iterator, Cursor} from \"@swim/util\";\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\nimport {OutletCombinators} from \"./OutletCombinators\";\nimport type {Inoutlet} from \"./Inoutlet\";\n\n/** @public */\nexport abstract class AbstractInoutlet<I, O> implements Inoutlet<I, O> {\n  constructor() {\n    this.input = null;\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  readonly input: Outlet<I> | null;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<O>>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: Outlet<I> | null): void {\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  abstract get(): O | undefined;\n\n  outputIterator(): Iterator<Inlet<O>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  decohereOutput(): void {\n    this.decohere();\n  }\n\n  decohereInput(): void {\n    this.decohere();\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        outputs[i]!.decohereOutput();\n      }\n      this.didDecohere();\n    }\n  }\n\n  recohereOutput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohereInput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      (this as Mutable<this>).version = version;\n      if (this.input !== null) {\n        this.input.recohereInput(version);\n      }\n      this.onRecohere(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        outputs[i]!.recohereOutput(version);\n      }\n      this.didRecohere(version);\n    }\n  }\n\n  protected willDecohere(): void {\n    // stub\n  }\n\n  protected onDecohere(): void {\n    // stub\n  }\n\n  protected didDecohere(): void {\n    // stub\n  }\n\n  protected willRecohere(version: number): void {\n    // stub\n  }\n\n  protected onRecohere(version: number): void {\n    // stub\n  }\n\n  protected didRecohere(version: number): void {\n    // stub\n  }\n}\n/** @public */\nexport interface AbstractInoutlet<I, O> extends OutletCombinators<O> {\n}\nOutletCombinators.define(AbstractInoutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {MapOutlet} from \"./MapOutlet\";\nimport {AbstractOutlet} from \"./AbstractOutlet\";\n\n/** @public */\nexport class KeyOutlet<K, V> extends AbstractOutlet<V> {\n  constructor(input: MapOutlet<K, V, unknown>, key: K) {\n    super();\n    this.input = input;\n    this.key = key;\n  }\n\n  readonly input: MapOutlet<K, V, unknown>;\n\n  readonly key: K;\n\n  override get(): V | undefined {\n    return this.input.get(this.key);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport type {MapInlet} from \"./MapInlet\";\nimport {MapOutlet} from \"./MapOutlet\";\n\n/** @public */\nexport abstract class AbstractMapInlet<K, V, O> implements MapInlet<K, V, O> {\n  constructor() {\n    this.input = null;\n    this.effects = new BTree();\n    this.version = -1;\n  }\n\n  readonly input: MapOutlet<K, V, O> | null;\n\n  /** @internal */\n  readonly effects: BTree<K, KeyEffect>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: MapOutlet<K, V, O> | null): void {\n    if (!MapOutlet.is(newInput)) {\n      throw new TypeError(\"\" + newInput);\n    }\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  disconnectOutputs(): void {\n    // nop\n  }\n\n  decohereOutputKey(key: K, effect: KeyEffect): void {\n    const oldEffects = this.effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willDecohereOutputKey(key, effect);\n      (this as Mutable<this>).effects = oldEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereOutputKey(key, effect);\n      this.didDecohereOutputKey(key, effect);\n    }\n  }\n\n  decohereOutput(): void {\n    if (this.version >= 0) {\n      this.willDecohereOutput();\n      (this as Mutable<this>).version = -1;\n      this.onDecohereOutput();\n      this.didDecohereOutput();\n    }\n  }\n\n  recohereOutputKey(key: K, version: number): void {\n    if (this.version < 0) {\n      const oldEffects = this.effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereOutputKey(key, effect, version);\n        (this as Mutable<this>).effects = oldEffects.removed(key);\n        if (this.input !== null) {\n          this.input.recohereInputKey(key, version);\n        }\n        this.onRecohereOutputKey(key, effect, version);\n        this.didRecohereOutputKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereOutput(version: number): void {\n    if (this.version < 0) {\n      this.willRecohereOutput(version);\n      this.effects.forEach(function (key: K): void {\n        this.recohereOutputKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohereOutput(version);\n      this.didRecohereOutput(version);\n    }\n  }\n\n  protected willDecohereOutputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereOutputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereOutputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohereOutput(): void {\n    // hook\n  }\n\n  protected onDecohereOutput(): void {\n    // hook\n  }\n\n  protected didDecohereOutput(): void {\n    // hook\n  }\n\n  protected willRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohereOutput(version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutput(version: number): void {\n    // hook\n  }\n\n  protected didRecohereOutput(version: number): void {\n    // hook\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Iterator, Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport {MapInlet} from \"./MapInlet\";\nimport type {MapOutlet} from \"./MapOutlet\";\nimport {MapOutletCombinators} from \"./MapOutletCombinators\";\nimport {KeyOutlet} from \"./KeyOutlet\";\n\n/** @public */\nexport abstract class AbstractMapOutlet<K, V, O> implements MapOutlet<K, V, O> {\n  constructor() {\n    this.effects = new BTree();\n    this.outlets = new BTree();\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  /** @internal */\n  readonly effects: BTree<K, KeyEffect>;\n\n  /** @internal */\n  readonly outlets: BTree<K, KeyOutlet<K, V>>;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<O>>;\n\n  /** @internal */\n  readonly version: number;\n\n  abstract has(key: K): boolean;\n\n  abstract get(): O | undefined;\n\n  abstract get(key: K): V | undefined;\n\n  abstract keyIterator(): Iterator<K>;\n\n  outlet(key: K): Outlet<V> {\n    const oldOutlets = this.outlets;\n    let outlet = oldOutlets.get(key);\n    if (outlet === void 0) {\n      outlet = new KeyOutlet(this, key);\n      (this as Mutable<this>).outlets = oldOutlets.updated(key, outlet);\n    }\n    return outlet;\n  }\n\n  outputIterator(): Iterator<Inlet<O>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, V>) {\n        keyOutlet.unbindOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, V>) {\n        keyOutlet.disconnectOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  disconnectInputs(): void {\n    // nop\n  }\n\n  decohereInputKey(key: K, effect: KeyEffect): void {\n    const oldEffects = this.effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willDecohereInputKey(key, effect);\n      (this as Mutable<this>).effects = oldEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereInputKey(key, effect);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        if (MapInlet.is(output)) {\n          output.decohereOutputKey(key, effect);\n        } else {\n          output.decohereOutput();\n        }\n      }\n      const outlet = this.outlets.get(key);\n      if (outlet !== void 0) {\n        outlet.decohereInput();\n      }\n      this.didDecohereInputKey(key, effect);\n    }\n  }\n\n  decohereInput(): void {\n    if (this.version >= 0) {\n      this.willDecohereInput();\n      (this as Mutable<this>).version = -1;\n      this.onDecohereInput();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.outlets.forEach(function (key: K, outlet: KeyOutlet<K, V>): void {\n        outlet.decohereInput();\n      }, this);\n      this.didDecohereInput();\n    }\n  }\n\n  recohereInputKey(key: K, version: number): void {\n    if (this.version < 0) {\n      const oldEffects = this.effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereInputKey(key, effect, version);\n        (this as Mutable<this>).effects = oldEffects.removed(key);\n        this.onRecohereInputKey(key, effect, version);\n        const outputs = this.outputs;\n        for (let i = 0, n = outputs.length; i < n; i += 1) {\n          const output = outputs[i];\n          if (MapInlet.is(output)) {\n            output.recohereOutputKey(key, version);\n          }\n        }\n        const outlet = this.outlets.get(key);\n        if (outlet !== void 0) {\n          outlet.recohereInput(version);\n        }\n        this.didRecohereInputKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereInput(version: number): void {\n    if (this.version < 0) {\n      this.willRecohereInput(version);\n      this.effects.forEach(function (key: K): void {\n        this.recohereInputKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohereInput(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.recohereOutput(version);\n      }\n      this.didRecohereInput(version);\n    }\n  }\n\n  protected willDecohereInputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereInputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereInputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohereInput(): void {\n    // hook\n  }\n\n  protected onDecohereInput(): void {\n    // hook\n  }\n\n  protected didDecohereInput(): void {\n    // hook\n  }\n\n  protected willRecohereInputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereInputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereInputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohereInput(version: number): void {\n    // hook\n  }\n\n  protected onRecohereInput(version: number): void {\n    // hook\n  }\n\n  protected didRecohereInput(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface AbstractMapOutlet<K, V, O> extends MapOutletCombinators<K, V, O> {\n}\nMapOutletCombinators.define(AbstractMapOutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Iterator, Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport {MapInlet} from \"./MapInlet\";\nimport {MapOutlet} from \"./MapOutlet\";\nimport {MapOutletCombinators} from \"./MapOutletCombinators\";\nimport {KeyOutlet} from \"./KeyOutlet\";\nimport type {MapInoutlet} from \"./MapInoutlet\";\n\n/** @public */\nexport abstract class AbstractMapInoutlet<K, VI, VO, I, O> implements MapInoutlet<K, VI, VO, I, O> {\n  constructor() {\n    this.input = null;\n    this.effects = new BTree();\n    this.outlets = new BTree();\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  readonly input: MapOutlet<K, VI, I> | null;\n\n  /** @internal */\n  readonly effects: BTree<K, KeyEffect>;\n\n  /** @internal */\n  readonly outlets: BTree<K, KeyOutlet<K, VO>>;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<O>>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: MapOutlet<K, VI, I>): void {\n    if (!MapOutlet.is(newInput)) {\n      throw new TypeError(\"\" + newInput);\n    }\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  abstract has(key: K): boolean;\n\n  abstract get(): O | undefined;\n\n  abstract get(key: K): VO | undefined;\n\n  abstract keyIterator(): Iterator<K>;\n\n  outlet(key: K): Outlet<VO> {\n    const oldOutlets = this.outlets;\n    let outlet = oldOutlets.get(key);\n    if (outlet === void 0) {\n      outlet = new KeyOutlet(this, key);\n      (this as Mutable<this>).outlets = oldOutlets.updated(key, outlet);\n    }\n    return outlet;\n  }\n\n  outputIterator(): Iterator<Inlet<O>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, VO>) {\n        keyOutlet.unbindOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, VO>) {\n        keyOutlet.disconnectOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  decohereOutputKey(key: K, effect: KeyEffect): void {\n    this.decohereKey(key, effect);\n  }\n\n  decohereInputKey(key: K, effect: KeyEffect): void {\n    this.decohereKey(key, effect);\n  }\n\n  decohereKey(key: K, effect: KeyEffect): void {\n    const oldEffects = this.effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willDecohereKey(key, effect);\n      (this as Mutable<this>).effects = oldEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereKey(key, effect);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        if (MapInlet.is(output)) {\n          output.decohereOutputKey(key, effect);\n        } else {\n          output.decohereOutput();\n        }\n      }\n      const outlet = this.outlets.get(key);\n      if (outlet !== void 0) {\n        outlet.decohereInput();\n      }\n      this.didDecohereKey(key, effect);\n    }\n  }\n\n  decohereOutput(): void {\n    this.decohere();\n  }\n\n  decohereInput(): void {\n    this.decohere();\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.outlets.forEach(function (key: K, outlet: KeyOutlet<K, VO>): void {\n        outlet.decohereInput();\n      }, this);\n      this.didDecohere();\n    }\n  }\n\n  recohereOutputKey(key: K, version: number): void {\n    this.recohereKey(key, version);\n  }\n\n  recohereInputKey(key: K, version: number): void {\n    this.recohereKey(key, version);\n  }\n\n  recohereKey(key: K, version: number): void {\n    if (this.version < 0) {\n      const oldEffects = this.effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereKey(key, effect, version);\n        (this as Mutable<this>).effects = oldEffects.removed(key);\n        if (this.input !== null) {\n          this.input.recohereInputKey(key, version);\n        }\n        this.onRecohereKey(key, effect, version);\n        const outputs = this.outputs;\n        for (let i = 0, n = outputs.length; i < n; i += 1) {\n          const output = outputs[i];\n          if (MapInlet.is(output)) {\n            output.recohereOutputKey(key, version);\n          }\n        }\n        const outlet = this.outlets.get(key);\n        if (outlet !== void 0) {\n          outlet.recohereInput(version);\n        }\n        this.didRecohereKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereOutput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohereInput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      this.effects.forEach(function (key: K): void {\n        this.recohereKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohere(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.recohereOutput(version);\n      }\n      this.didRecohere(version);\n    }\n  }\n\n  protected willDecohereKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected willRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohere(version: number): void {\n    // hook\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface AbstractMapInoutlet<K, VI, VO, I, O> extends MapOutletCombinators<K, VO, O> {\n}\nMapOutletCombinators.define(AbstractMapInoutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Iterator, Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport type {Inlet} from \"./Inlet\";\nimport {OutletCombinators} from \"./OutletCombinators\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport {MapOutlet} from \"./MapOutlet\";\nimport type {MapInletOutlet} from \"./MapInletOutlet\";\n\n/** @public */\nexport abstract class AbstractMapInletOutlet<K, V, I, O> implements MapInletOutlet<K, V, I, O> {\n  constructor() {\n    this.input = null;\n    this.effects = new BTree();\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  readonly input: MapOutlet<K, V, I> | null;\n\n  /** @internal */\n  readonly effects: BTree<K, KeyEffect>;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<O>>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: MapOutlet<K, V, I>): void {\n    if (!MapOutlet.is(newInput)) {\n      throw new TypeError(\"\" + newInput);\n    }\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  abstract get(): O | undefined;\n\n  outputIterator(): Iterator<Inlet<O>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  decohereOutputKey(key: K, effect: KeyEffect): void {\n    const oldEffects = this.effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willDecohereOutputKey(key, effect);\n      (this as Mutable<this>).effects = oldEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereOutputKey(key, effect);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.didDecohereOutputKey(key, effect);\n    }\n  }\n\n  decohereOutput(): void {\n    this.decohere();\n  }\n\n  decohereInput(): void {\n    this.decohere();\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.didDecohere();\n    }\n  }\n\n  recohereOutputKey(key: K, version: number): void {\n    if (this.version < 0) {\n      const oldEffects = this.effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereOutputKey(key, effect, version);\n        (this as Mutable<this>).effects = oldEffects.removed(key);\n        if (this.input !== null) {\n          this.input.recohereInputKey(key, version);\n        }\n        this.onRecohereOutputKey(key, effect, version);\n        this.didRecohereOutputKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereOutput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohereInput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      this.effects.forEach(function (key: K): void {\n        this.recohereOutputKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohere(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.recohereOutput(version);\n      }\n      this.didRecohere(version);\n    }\n  }\n\n  protected willDecohereOutputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereOutputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereOutputKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected willRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohere(version: number): void {\n    // hook\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface AbstractMapInletOutlet<K, V, I, O> extends OutletCombinators<O> {\n}\nOutletCombinators.define(AbstractMapInletOutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Iterator, Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport type {Inlet} from \"./Inlet\";\nimport type {Outlet} from \"./Outlet\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport {MapInlet} from \"./MapInlet\";\nimport {MapOutlet} from \"./MapOutlet\";\nimport {MapOutletCombinators} from \"./MapOutletCombinators\";\nimport {KeyOutlet} from \"./KeyOutlet\";\nimport type {MapInletMapOutlet} from \"./MapInletMapOutlet\";\n\n/** @public */\nexport abstract class AbstractMapInletMapOutlet<KI, KO, VI, VO, I, O> implements MapInletMapOutlet<KI, KO, VI, VO, I, O> {\n  constructor() {\n    this.input = null;\n    this.outputEffects = new BTree();\n    this.inputEffects = new BTree();\n    this.outlets = new BTree();\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  readonly input: MapOutlet<KI, VI, I> | null;\n\n  /** @internal */\n  readonly outputEffects: BTree<KI, KeyEffect>;\n\n  /** @internal */\n  readonly inputEffects: BTree<KO, KeyEffect>;\n\n  /** @internal */\n  readonly outlets: BTree<KO, KeyOutlet<KO, VO>>;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<O>>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: MapOutlet<KI, VI, I>): void {\n    if (!MapOutlet.is(newInput)) {\n      throw new TypeError(\"\" + newInput);\n    }\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  abstract has(key: KO): boolean;\n\n  abstract get(): O;\n\n  abstract get(key: KO): VO | undefined;\n\n  abstract keyIterator(): Iterator<KO>;\n\n  outlet(key: KO): Outlet<VO> {\n    const oldOutlets = this.outlets;\n    let outlet = oldOutlets.get(key);\n    if (outlet === void 0) {\n      outlet = new KeyOutlet(this, key);\n      (this as Mutable<this>).outlets = oldOutlets.updated(key, outlet);\n    }\n    return outlet;\n  }\n\n  outputIterator(): Iterator<Inlet<O>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<O>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: KO, keyOutlet: KeyOutlet<KO, VO>) {\n        keyOutlet.unbindOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: KO, keyOutlet: KeyOutlet<KO, VO>) {\n        keyOutlet.disconnectOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  decohereOutputKey(key: KI, effect: KeyEffect): void {\n    const oldOutputEffects = this.outputEffects;\n    if (oldOutputEffects.get(key) !== effect) {\n      this.willDecohereOutputKey(key, effect);\n      (this as Mutable<this>).outputEffects = oldOutputEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereOutputKey(key, effect);\n      this.didDecohereOutputKey(key, effect);\n    }\n  }\n\n  decohereInputKey(key: KO, effect: KeyEffect): void {\n    const oldInputEffects = this.inputEffects;\n    if (oldInputEffects.get(key) !== effect) {\n      this.willDecohereInputKey(key, effect);\n      (this as Mutable<this>).inputEffects = oldInputEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereInputKey(key, effect);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        if (MapInlet.is(output)) {\n          output.decohereOutputKey(key, effect);\n        } else {\n          output.decohereOutput();\n        }\n      }\n      const outlet = this.outlets.get(key);\n      if (outlet !== void 0) {\n        outlet.decohereInput();\n      }\n      this.didDecohereInputKey(key, effect);\n    }\n  }\n\n  decohereOutput(): void {\n    this.decohere();\n  }\n\n  decohereInput(): void {\n    this.decohere();\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.outlets.forEach(function (key: KO, outlet: KeyOutlet<KO, VO>): void {\n        outlet.decohereInput();\n      }, this);\n      this.didDecohere();\n    }\n  }\n\n  recohereOutputKey(key: KI, version: number): void {\n    if (this.version < 0) {\n      const oldOutputEffects = this.outputEffects;\n      const effect = oldOutputEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereOutputKey(key, effect, version);\n        (this as Mutable<this>).outputEffects = oldOutputEffects.removed(key);\n        if (this.input !== null) {\n          this.input.recohereInputKey(key, version);\n        }\n        this.onRecohereOutputKey(key, effect, version);\n        this.didRecohereOutputKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereInputKey(key: KO, version: number): void {\n    if (this.version < 0) {\n      const oldInputEffects = this.inputEffects;\n      const oldEffect = oldInputEffects.get(key);\n      if (oldEffect !== void 0) {\n        const newEffect = this.willRecohereInputKey(key, oldEffect, version);\n        if (oldEffect !== newEffect) {\n          this.decohereInputKey(key, newEffect);\n        }\n        (this as Mutable<this>).inputEffects = oldInputEffects.removed(key);\n        this.onRecohereInputKey(key, newEffect, version);\n        const outputs = this.outputs;\n        for (let i = 0, n = outputs.length; i < n; i += 1) {\n          const output = outputs[i];\n          if (MapInlet.is(output)) {\n            output.recohereOutputKey(key, version);\n          }\n        }\n        const outlet = this.outlets.get(key);\n        if (outlet !== void 0) {\n          outlet.recohereInput(version);\n        }\n        this.didRecohereInputKey(key, newEffect, version);\n      }\n    }\n  }\n\n  recohereOutput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohereInput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      this.outputEffects.forEach(function (key: KI): void {\n        this.recohereOutputKey(key, version);\n      }, this);\n      this.inputEffects.forEach(function (key: KO): void {\n        this.recohereInputKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohere(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.recohereOutput(version);\n      }\n      this.didRecohere(version);\n    }\n  }\n\n  protected willDecohereOutputKey(key: KI, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereOutputKey(key: KI, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereOutputKey(key: KI, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohereInputKey(key: KO, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereInputKey(key: KO, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereInputKey(key: KO, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected willRecohereOutputKey(key: KI, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutputKey(key: KI, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereOutputKey(key: KI, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohereInputKey(key: KO, effect: KeyEffect, version: number): KeyEffect {\n    return effect;\n  }\n\n  protected onRecohereInputKey(key: KO, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereInputKey(key: KO, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohere(version: number): void {\n    // hook\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface AbstractMapInletMapOutlet<KI, KO, VI, VO, I, O> extends MapOutletCombinators<KO, VO, O> {\n}\nMapOutletCombinators.define(AbstractMapInletMapOutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Outlet} from \"./Outlet\";\nimport {AbstractInlet} from \"./AbstractInlet\";\n\n/**\n * An `Inlet` that decoheres a parameterized `Outlet` whenever the `Inlet`\n * decoheres, and that recoheres the parameterized `Outlet` whenever the\n * `Inlet` recoheres.\n * @public\n */\nexport class OutletInlet<I> extends AbstractInlet<I> {\n  constructor(outlet: Outlet<unknown>) {\n    super();\n    this.outlet = outlet;\n  }\n\n  readonly outlet: Outlet<unknown>;\n\n  protected override onDecohereOutput(): void {\n    this.outlet.decohereInput();\n  }\n\n  protected override onRecohereOutput(version: number): void {\n    this.outlet.recohereInput(version);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Outlet} from \"./Outlet\";\nimport type {KeyEffect} from \"./KeyEffect\";\nimport {AbstractMapInlet} from \"./AbstractMapInlet\";\n\n/**\n * A `MapInlet` that decoheres a parameterized `Outlet` whenever the\n * `MapInlet` decoheres, and that recoheres the parameterized `Outlet`\n * whenever the `MapInlet` recoheres.\n * @public\n */\nexport class OutletMapInlet<K, V, O> extends AbstractMapInlet<K, V, O> {\n  constructor(outlet: Outlet<unknown>) {\n    super();\n    this.outlet = outlet;\n  }\n\n  readonly outlet: Outlet<unknown>;\n\n  protected override onDecohereOutputKey(key: K, effect: KeyEffect): void {\n    this.outlet.decohereInput();\n  }\n\n  protected override onDecohereOutput(): void {\n    this.outlet.decohereInput();\n  }\n\n  protected override onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    this.outlet.recohereInput(version);\n  }\n\n  protected override onRecohereOutput(version: number): void {\n    this.outlet.recohereInput(version);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AbstractOutlet} from \"./AbstractOutlet\";\n\n/** @public */\nexport class ValueInput<O> extends AbstractOutlet<O> {\n  constructor(state?: O) {\n    super();\n    this.state = state;\n  }\n\n  /** @internal */\n  readonly state: O | undefined;\n\n  override get(): O | undefined {\n    return this.state;\n  }\n\n  set(newState: O | undefined): O | undefined {\n    const oldState = this.state;\n    if (oldState !== newState) {\n      (this as Mutable<this>).state = newState;\n      this.decohereInput();\n    }\n    return oldState;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Outlet} from \"../Outlet\";\nimport {AbstractInoutlet} from \"../AbstractInoutlet\";\n\n/** @public */\nexport class MemoizeValueCombinator<IO> extends AbstractInoutlet<IO, IO> {\n  constructor() {\n    super();\n    this.state = void 0;\n  }\n\n  /** @internal */\n  readonly state: IO | undefined;\n\n  override get(): IO | undefined {\n    return this.state;\n  }\n\n  protected override onRecohere(version: number): void {\n    const input = this.input;\n    if (input !== null) {\n      (this as Mutable<this>).state = input.get();\n    }\n  }\n\n  override memoize(): Outlet<IO> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Iterator} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {KeyEffect} from \"../KeyEffect\";\nimport type {MapOutlet} from \"../MapOutlet\";\nimport {AbstractMapInoutlet} from \"../AbstractMapInoutlet\";\n\n/** @public */\nexport class MemoizeMapCombinator<K, V, IO> extends AbstractMapInoutlet<K, V, V, IO, IO> {\n  constructor() {\n    super();\n    this.state = void 0;\n    this.cache = new BTree();\n  }\n\n  /** @internal */\n  readonly state: IO | undefined;\n\n  /** @internal */\n  readonly cache: BTree<K, V>;\n\n  override has(key: K): boolean {\n    return this.cache.has(key);\n  }\n\n  override get(): IO | undefined;\n  override get(key: K): V | undefined;\n  override get(key?: K): IO | V | undefined {\n    if (key === void 0) {\n      let state = this.state;\n      const input = this.input;\n      if (state === void 0 && input !== null) {\n        state = input.get();\n        (this as Mutable<this>).state = state;\n      }\n      return state;\n    } else {\n      return this.cache.get(key);\n    }\n  }\n\n  override keyIterator(): Iterator<K> {\n    return this.cache.keys();\n  }\n\n  protected override onRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    if (effect === KeyEffect.Update) {\n      const input = this.input;\n      if (input !== null) {\n        const value = input.get(key);\n        if (value !== void 0) {\n          (this as Mutable<this>).cache = this.cache.updated(key, value);\n        } else {\n          (this as Mutable<this>).cache = this.cache.removed(key);\n        }\n      }\n    } else if (effect === KeyEffect.Remove) {\n      (this as Mutable<this>).cache = this.cache.removed(key);\n    }\n  }\n\n  protected override onRecohere(version: number): void {\n    (this as Mutable<this>).state = void 0;\n  }\n\n  override memoize(): MapOutlet<K, V, IO> {\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Iterator, Cursor, Map} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {KeyEffect} from \"../KeyEffect\";\nimport {AbstractMapInletMapOutlet} from \"../AbstractMapInletMapOutlet\";\n\n/** @public */\nexport abstract class FilterFieldsOperator<K, V, I> extends AbstractMapInletMapOutlet<K, K, V, V, I, Map<K, V>> {\n  override has(key: K): boolean {\n    const input = this.input;\n    if (input !== null) {\n      const value = input.get(key);\n      return value !== void 0 && this.evaluate(key, value);\n    }\n    return false;\n  }\n\n  override get(): Map<K, V>;\n  override get(key: K): V | undefined;\n  override get(key?: K): Map<K, V> | V | undefined {\n    if (key === void 0) {\n      const output = new BTree<K, V>();\n      const keys = this.keyIterator();\n      do {\n        const next = keys.next();\n        if (!next.done) {\n          const key = next.value!;\n          const value = this.input!.get(key);\n          if (value !== void 0 && this.evaluate(key, value)) {\n            output.set(key, value);\n          }\n          continue;\n        }\n        break;\n      } while (true);\n      return output;\n    } else {\n      const input = this.input;\n      if (input !== null) {\n        const value = input.get(key);\n        if (value !== void 0 && this.evaluate(key, value)) {\n          return value;\n        }\n      }\n      return void 0;\n    }\n  }\n\n  override keyIterator(): Iterator<K> {\n    const input = this.input;\n    if (input !== null) {\n      return input.keyIterator(); // TODO: filter keys\n    } else {\n      return Cursor.empty();\n    }\n  }\n\n  protected override onDecohereOutputKey(key: K, effect: KeyEffect): void {\n    this.decohereInputKey(key, effect);\n  }\n\n  protected override onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    this.recohereInputKey(key, version);\n  }\n\n  protected override willRecohereInputKey(key: K, effect: KeyEffect, version: number): KeyEffect {\n    if (effect === KeyEffect.Update) {\n      const input = this.input;\n      if (input !== null) {\n        const value = input.get(key);\n        if (value === void 0 || !this.evaluate(key, value)) {\n          return KeyEffect.Remove;\n        }\n      }\n    }\n    return effect;\n  }\n\n  abstract evaluate(key: K, value: V): boolean;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {FilterFieldsFunction} from \"../function\";\nimport {FilterFieldsOperator} from \"./FilterFieldsOperator\";\n\n/** @public */\nexport class FilterFieldsCombinator<K, V, I> extends FilterFieldsOperator<K, V, I> {\n  constructor(func: FilterFieldsFunction<K, V>) {\n    super();\n    this.func = func;\n  }\n\n  /** @internal */\n  readonly func: FilterFieldsFunction<K, V>;\n\n  override evaluate(key: K, value: V): boolean {\n    const func = this.func;\n    return func(key, value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AbstractInoutlet} from \"../AbstractInoutlet\";\n\n/** @public */\nexport abstract class MapValueOperator<I, O> extends AbstractInoutlet<I, O> {\n  override get(): O | undefined {\n    const input = this.input;\n    if (input !== null) {\n      return this.evaluate(input.get());\n    } else {\n      return void 0;\n    }\n  }\n\n  abstract evaluate(value: I | undefined): O | undefined;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {MapValueFunction} from \"../function\";\nimport {MapValueOperator} from \"./MapValueOperator\";\n\n/** @public */\nexport class MapValueCombinator<I, O> extends MapValueOperator<I, O> {\n  constructor(func: MapValueFunction<I, O>) {\n    super();\n    this.func = func;\n  }\n\n  /** @internal */\n  readonly func: MapValueFunction<I, O>;\n\n  override evaluate(value: I | undefined): O | undefined {\n    if (value !== void 0) {\n      const func = this.func;\n      return func(value);\n    } else {\n      return void 0;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Iterator, Cursor, Map} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {AbstractMapInoutlet} from \"../AbstractMapInoutlet\";\n\n/** @public */\nexport abstract class MapFieldValuesOperator<K, VI, VO, I> extends AbstractMapInoutlet<K, VI, VO, I, Map<K, VO>> {\n  override has(key: K): boolean {\n    const input = this.input;\n    if (input !== null) {\n      return input.has(key);\n    } else {\n      return false;\n    }\n  }\n\n  override get(): Map<K, VO>;\n  override get(key: K): VO | undefined;\n  override get(key?: K): Map<K, VO> | VO | undefined {\n    if (key === void 0) {\n      const output = new BTree<K, VO>();\n      const keys = this.keyIterator();\n      do {\n        const next = keys.next();\n        if (!next.done) {\n          const key = next.value!;\n          const value = this.evaluate(key, this.input!.get(key));\n          if (value !== void 0) {\n            output.set(key, value);\n          }\n          continue;\n        }\n        break;\n      } while (true);\n      return output;\n    } else {\n      const input = this.input;\n      if (input !== null) {\n        return this.evaluate(key, input.get(key));\n      } else {\n        return void 0;\n      }\n    }\n  }\n\n  override keyIterator(): Iterator<K> {\n    const input = this.input;\n    if (input !== null) {\n      return input.keyIterator(); // TODO: filter keys\n    } else {\n      return Cursor.empty();\n    }\n  }\n\n  abstract evaluate(key: K, value: VI | undefined): VO | undefined;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {MapFieldValuesFunction} from \"../function\";\nimport {MapFieldValuesOperator} from \"./MapFieldValuesOperator\";\n\n/** @public */\nexport class MapFieldValuesCombinator<K, VI, VO, I> extends MapFieldValuesOperator<K, VI, VO, I> {\n  constructor(func: MapFieldValuesFunction<K, VI, VO> ) {\n    super();\n    this.func = func;\n  }\n\n  /** @internal */\n  readonly func: MapFieldValuesFunction<K, VI, VO>;\n\n  override evaluate(key: K, value: VI | undefined): VO | undefined {\n    if (value !== void 0) {\n      const func = this.func;\n      return func(key, value);\n    } else {\n      return void 0;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {BTree} from \"@swim/collections\";\nimport {KeyEffect} from \"../KeyEffect\";\nimport {AbstractMapInletOutlet} from \"../AbstractMapInletOutlet\";\n\n/** @public */\nexport abstract class ReduceFieldsOperator<K, V, I, O> extends AbstractMapInletOutlet<K, V, I, O> {\n  constructor() {\n    super();\n    this.state = new BTree();\n  }\n\n  /** @internal */\n  readonly state: BTree<K, V, O>;\n\n  override get(): O | undefined {\n    return this.state.reduced(this.identity, this.accumulate.bind(this), this.combine.bind(this));\n  }\n\n  protected override onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    if (effect === KeyEffect.Update) {\n      const input = this.input;\n      if (input !== null) {\n        const value = input.get(key);\n        if (value !== void 0) {\n          this.state.set(key, value);\n        } else {\n          this.state.delete(key);\n        }\n      }\n    } else if (effect === KeyEffect.Remove) {\n      this.state.delete(key);\n    }\n  }\n\n  abstract readonly identity: O;\n\n  abstract accumulate(result: O, value: V): O;\n\n  abstract combine(result: O, value: O): O;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {ReduceFieldsOperator} from \"./ReduceFieldsOperator\";\n\n/** @public */\nexport class ReduceFieldsCombinator<K, V, I, O> extends ReduceFieldsOperator<K, V, I, O> {\n  constructor(identity: O, accumulator: (result: O, element: V) => O,\n              combiner: (result: O, result2: O) => O) {\n    super();\n    this.identity = identity;\n    this.accumulator = accumulator;\n    this.combiner = combiner;\n  }\n\n  override get(): O {\n    return this.state.reduced(this.identity, this.accumulator, this.combiner);\n  }\n\n  override readonly identity: O;\n\n  /** @internal */\n  readonly accumulator: (result: O, element: V) => O;\n\n  override accumulate(result: O, value: V): O {\n    const accumulator = this.accumulator;\n    return accumulator(result, value);\n  }\n\n  /** @internal */\n  readonly combiner: (result: O, result2: O) => O;\n\n  override combine(result: O, value: O): O {\n    const combiner = this.combiner;\n    return combiner(result, value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AbstractInlet} from \"../AbstractInlet\";\n\n/** @public */\nexport abstract class WatchValueOperator<I> extends AbstractInlet<I> {\n  override onRecohereOutput(version: number): void {\n    const input = this.input;\n    if (input !== null) {\n      this.evaluate(input.get());\n    }\n  }\n\n  abstract evaluate(value: I | undefined): void;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {WatchValueFunction} from \"../function\";\nimport {WatchValueOperator} from \"./WatchValueOperator\";\n\n/** @public */\nexport class WatchValueCombinator<I> extends WatchValueOperator<I> {\n  constructor(func: WatchValueFunction<I>) {\n    super();\n    this.func = func;\n  }\n\n  /** @internal */\n  readonly func: WatchValueFunction<I>;\n\n  override evaluate(value: I | undefined): void {\n    if (value !== void 0) {\n      const func = this.func;\n      return func(value);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {KeyEffect} from \"../KeyEffect\";\nimport {AbstractMapInlet} from \"../AbstractMapInlet\";\n\n/** @public */\nexport abstract class WatchFieldsOperator<K, V, O> extends AbstractMapInlet<K, V, O> {\n  protected override onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    if (effect === KeyEffect.Update) {\n      const input = this.input;\n      if (input !== null) {\n        this.evaluate(key, input.get(key));\n      } else {\n        this.evaluate(key, void 0);\n      }\n    } else if (effect === KeyEffect.Remove) {\n      this.evaluate(key, void 0);\n    }\n  }\n\n  abstract evaluate(key: K, value: V | undefined): void;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {WatchFieldsFunction} from \"../function\";\nimport {WatchFieldsOperator} from \"./WatchFieldsOperator\";\n\n/** @public */\nexport class WatchFieldsCombinator<K, V, O> extends WatchFieldsOperator<K, V, O> {\n  constructor(func: WatchFieldsFunction<K, V>) {\n    super();\n    this.func = func;\n  }\n\n  /** @internal */\n  readonly func: WatchFieldsFunction<K, V>;\n\n  override evaluate(key: K, value: V | undefined): void {\n    if (value !== void 0) {\n      const func = this.func;\n      return func(key, value);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Streamlet} from \"./Streamlet\";\nimport type {GenericStreamlet} from \"./GenericStreamlet\";\nimport {AbstractInlet} from \"./AbstractInlet\";\n\n/**\n * An `Inlet` that decoheres a parameterized `Streamlet` whenever the `Inlet`\n * decoheres, and that recoheres the parameterized `Streamlet` whenever the\n * `Inlet` recoheres.\n * @public\n */\nexport class StreamletInlet<I> extends AbstractInlet<I> {\n  constructor(streamlet: Streamlet<I, unknown>) {\n    super();\n    this.streamlet = streamlet;\n  }\n\n  readonly streamlet: Streamlet<I, unknown>;\n\n  protected override willDecohereOutput(): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, unknown>;\n    if (streamlet.willDecohereInlet !== void 0) {\n      streamlet.willDecohereInlet(this);\n    }\n  }\n\n  protected override didDecohereOutput(): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, unknown>;\n    if (streamlet.didDecohereInlet !== void 0) {\n      streamlet.didDecohereInlet(this);\n    } else {\n      streamlet.decohere();\n    }\n  }\n\n  protected override willRecohereOutput(version: number): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, unknown>;\n    if (streamlet.willRecohereInlet !== void 0) {\n      streamlet.willRecohereInlet(this, version);\n    }\n  }\n\n  protected override didRecohereOutput(version: number): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, unknown>;\n    if (streamlet.didRecohereInlet !== void 0) {\n      streamlet.didRecohereInlet(this, version);\n    } else {\n      streamlet.recohere(version);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Streamlet} from \"./Streamlet\";\nimport type {GenericStreamlet} from \"./GenericStreamlet\";\nimport {AbstractOutlet} from \"./AbstractOutlet\";\n\n/**\n * An `Outlet` that decoheres a parameterized `Streamlet` whenever the\n * `Outlet` decoheres, and which gets its state from the parameterized\n * `Streamlet`.\n * @public\n */\nexport class StreamletOutlet<O> extends AbstractOutlet<O> {\n  constructor(streamlet: Streamlet<unknown, O>) {\n    super();\n    this.streamlet = streamlet;\n  }\n\n  readonly streamlet: Streamlet<unknown, O>;\n\n  override get(): O | undefined {\n    const streamlet = this.streamlet as GenericStreamlet<unknown, O>;\n    if (streamlet.getOutput !== void 0) {\n      return streamlet.getOutput(this);\n    } else {\n      return void 0;\n    }\n  }\n\n  protected override willDecohereInput(): void {\n    const streamlet = this.streamlet as GenericStreamlet<unknown, O>;\n    if (streamlet.willDecohereOutlet !== void 0) {\n      streamlet.willDecohereOutlet(this);\n    }\n  }\n\n  protected override didDecohereInput(): void {\n    const streamlet = this.streamlet as GenericStreamlet<unknown, O>;\n    if (streamlet.didDecohereOutlet !== void 0) {\n      streamlet.didDecohereOutlet(this);\n    } else {\n      streamlet.decohere();\n    }\n  }\n\n  protected override willRecohereInput(version: number): void {\n    const streamlet = this.streamlet as GenericStreamlet<unknown, O>;\n    if (streamlet.willRecohereOutlet !== void 0) {\n      streamlet.willRecohereOutlet(this, version);\n    }\n  }\n\n  protected override didRecohereInput(version: number): void {\n    const streamlet = this.streamlet as GenericStreamlet<unknown, O>;\n    if (streamlet.didRecohereOutlet !== void 0) {\n      streamlet.didRecohereOutlet(this, version);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Streamlet} from \"./Streamlet\";\nimport type {GenericStreamlet} from \"./GenericStreamlet\";\nimport {AbstractInoutlet} from \"./AbstractInoutlet\";\n\n/**\n * An `Inoutlet` that decoheres a parameterized `Streamlet` whenever the\n * `Inoutlet` decoheres, that recoheres the parameterized `Streamlet`\n * whenever the `Inoutlet` recoheres, and which gets its state from the\n * parameterized `Streamlet`.\n * @public\n */\nexport class StreamletInoutlet<I, O> extends AbstractInoutlet<I, O> {\n  constructor(streamlet: Streamlet<I, O>) {\n    super();\n    this.streamlet = streamlet;\n  }\n\n  readonly streamlet: Streamlet<I, O>;\n\n  override get(): O | undefined {\n    const streamlet = this.streamlet as GenericStreamlet<I, O>;\n    if (streamlet.getOutput !== void 0) {\n      const output = streamlet.getOutput(this);\n      if (output !== void 0) {\n        return output;\n      }\n    }\n    const input = this.input;\n    if (input !== null) {\n      return input.get() as O | undefined;\n    } else {\n      return void 0;\n    }\n  }\n\n  protected override willDecohere(): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, O>;\n    if (streamlet.willDecohereOutlet !== void 0) {\n      streamlet.willDecohereOutlet(this);\n    }\n  }\n\n  protected override didDecohere(): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, O>;\n    if (streamlet.didDecohereOutlet !== void 0) {\n      streamlet.didDecohereOutlet(this);\n    } else {\n      streamlet.decohere();\n    }\n  }\n\n  protected override willRecohere(version: number): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, O>;\n    if (streamlet.willRecohereOutlet !== void 0) {\n      streamlet.willRecohereOutlet(this, version);\n    }\n  }\n\n  protected override didRecohere(version: number): void {\n    const streamlet = this.streamlet as GenericStreamlet<I, O>;\n    if (streamlet.didRecohereOutlet !== void 0) {\n      streamlet.didRecohereOutlet(this, version);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {InletType, InletOptions, Inlet} from \"./Inlet\";\nimport type {OutletType, OutletOptions, Outlet} from \"./Outlet\";\nimport type {InoutletType, InoutletOptions, Inoutlet} from \"./Inoutlet\";\nimport type {StreamletContext} from \"./StreamletContext\";\nimport type {StreamletScope} from \"./StreamletScope\";\nimport type {Streamlet} from \"./Streamlet\";\nimport type {GenericStreamlet} from \"./GenericStreamlet\";\nimport {StreamletInlet} from \"./StreamletInlet\";\nimport {StreamletOutlet} from \"./StreamletOutlet\";\nimport {StreamletInoutlet} from \"./StreamletInoutlet\";\n\n/** @internal */\nexport class InletDescriptor {\n  readonly key: string;\n  readonly name: string;\n  readonly type: InletType;\n\n  constructor(key: string, name: string, type: InletType) {\n    this.key = key;\n    this.name = name;\n    this.type = type;\n  }\n}\n\n/** @internal */\nexport class OutletDescriptor {\n  readonly key: string;\n  readonly name: string;\n  readonly type: OutletType;\n\n  constructor(key: string, name: string, type: OutletType) {\n    this.key = key;\n    this.name = name;\n    this.type = type;\n  }\n}\n\n/** @internal */\nexport class InoutletDescriptor {\n  readonly key: string;\n  readonly name: string;\n  readonly type: InoutletType;\n\n  constructor(key: string, name: string, type: InoutletType) {\n    this.key = key;\n    this.name = name;\n    this.type = type;\n  }\n}\n\n/** @internal */\nexport interface StreamletPrototype {\n  inlets?: {[name: string]: InletDescriptor | InoutletDescriptor | undefined};\n  outlets?: {[name: string]: OutletDescriptor | InoutletDescriptor | undefined};\n  inoutlets?: {[name: string]: InoutletDescriptor | undefined};\n}\n\n/** @public */\nexport abstract class AbstractStreamlet<I = unknown, O = I> implements GenericStreamlet<I, O> {\n  constructor(scope: StreamletScope<O> | null = null) {\n    this.streamletScope = scope;\n    this.streamletContext = null;\n    this.version = -1;\n  }\n\n  readonly streamletScope: StreamletScope<O> | null;\n\n  setStreamletScope(scope: StreamletScope<O> | null): void {\n    (this as Mutable<this>).streamletScope = scope;\n  }\n\n  readonly streamletContext: StreamletContext | null;\n\n  setStreamletContext(context: StreamletContext | null): void {\n    (this as Mutable<this>).streamletContext = context;\n  }\n\n  /** @internal */\n  readonly version: number;\n\n  inlet(key: string): Inlet<I> | null;\n  inlet<I2 extends I>(): Inlet<I2>;\n  inlet(key?: string): Inlet<I> | null {\n    if (key === void 0) {\n      return new StreamletInlet<I>(this);\n    } else {\n      return AbstractStreamlet.reflectInletKey<I, O>(key, this, Object.getPrototypeOf(this));\n    }\n  }\n\n  bindInput(key: string, input: Outlet<I>): void {\n    const inlet = this.inlet(key);\n    if (inlet === null) {\n      throw new Error(\"\" + key);\n    }\n    inlet.bindInput(input);\n  }\n\n  unbindInput(key: string): void {\n    const inlet = this.inlet(key);\n    if (inlet === null) {\n      throw new Error(\"\" + key);\n    }\n    inlet.unbindInput();\n  }\n\n  outlet(key: string | Outlet<O>): Outlet<O> | null;\n  outlet<O2>(): Outlet<O2>;\n  outlet(key?: string | Outlet<O>): Outlet<O> | null {\n    if (key === void 0) {\n      return new StreamletOutlet<O>(this);\n    } else if (typeof key === \"string\") {\n      return AbstractStreamlet.reflectOutletKey<I, O>(key, this, Object.getPrototypeOf(this));\n    } else {\n      return key;\n    }\n  }\n\n  inoutlet<I2 extends I, O2>(): Inoutlet<I2, O2> {\n    return new StreamletInoutlet<I2, O2>(this as Streamlet<I2, O2>);\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      this.onDecohereOutlets();\n      this.didDecohere();\n    }\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      (this as Mutable<this>).version = version;\n      this.onRecohereInlets(version);\n      this.onRecohere(version);\n      this.onRecohereOutlets(version);\n      this.didRecohere(version);\n    }\n  }\n\n  getInput<I2 extends I>(inlet: Inlet<I2> | string): I2 | undefined;\n  getInput<I2 extends I, E = I2>(inlet: Inlet<I2> | string, orElse: E): I2 | E;\n  getInput<I2 extends I, E = I2>(inlet: Inlet<I2> | string, orElse?: E): I2 | E | undefined {\n    if (typeof inlet === \"string\") {\n      inlet = this.inlet(inlet) as Inlet<I2>;\n    }\n    let object: I2 | E | undefined;\n    if (inlet !== null) {\n      const input = inlet.input;\n      if (input !== null) {\n        object = input.get();\n      }\n    }\n    if (object === void 0) {\n      object = orElse;\n    }\n    return object;\n  }\n\n  getOutput(outlet: Outlet<O> | string): O | undefined {\n    return void 0;\n  }\n\n  disconnectInputs(): void {\n    AbstractStreamlet.disconnectInputs(this, Object.getPrototypeOf(this));\n  }\n\n  /** @internal */\n  static disconnectInputs<I, O>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): void {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n        for (const name in streamletPrototype.inlets) {\n          const inletDescriptor = streamletPrototype.inlets[name]!;\n          if (inletDescriptor instanceof InletDescriptor) {\n            const inlet = AbstractStreamlet.reflectInletField(streamlet, inletDescriptor);\n            inlet.disconnectInputs();\n          } else if (inletDescriptor instanceof InoutletDescriptor) {\n            const inoutlet = AbstractStreamlet.reflectInoutletField(streamlet, inletDescriptor);\n            inoutlet.disconnectInputs();\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n  }\n\n  disconnectOutputs(): void {\n    AbstractStreamlet.disconnectOutputs(this, Object.getPrototypeOf(this));\n  }\n\n  /** @internal */\n  static disconnectOutputs<I, O>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): void {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        for (const name in streamletPrototype.outlets) {\n          const outletDescriptor = streamletPrototype.outlets[name]!;\n          if (outletDescriptor instanceof OutletDescriptor) {\n            const outlet = AbstractStreamlet.reflectOutletField(streamlet, outletDescriptor);\n            outlet.disconnectOutputs();\n          } else if (outletDescriptor instanceof InoutletDescriptor) {\n            const inoutlet = AbstractStreamlet.reflectInoutletField(streamlet, outletDescriptor);\n            inoutlet.disconnectOutputs();\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n  }\n\n  willDecohereInlet(inlet: Inlet<I>): void {\n    // hook\n  }\n\n  didDecohereInlet(inlet: Inlet<I>): void {\n    this.decohere();\n  }\n\n  willRecohereInlet(inlet: Inlet<I>, version: number): void {\n    // hook\n  }\n\n  didRecohereInlet(inlet: Inlet<I>, version: number): void {\n    this.recohere(version);\n  }\n\n  willDecohereOutlet(outlet: Outlet<O>): void {\n    // hook\n  }\n\n  didDecohereOutlet(outlet: Outlet<O>): void {\n    // hook\n  }\n\n  willRecohereOutlet(outlet: Outlet<O>, version: number): void {\n    // hook\n  }\n\n  didRecohereOutlet(outlet: Outlet<O>, version: number): void {\n    // hook\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected onDecohereOutlets(): void {\n    AbstractStreamlet.decohereOutlets(this, Object.getPrototypeOf(this));\n  }\n\n  /** @internal */\n  static decohereOutlets<I, O>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): void {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        for (const name in streamletPrototype.outlets) {\n          const outletDescriptor = streamletPrototype.outlets[name]!;\n          if (outletDescriptor instanceof OutletDescriptor) {\n            const outlet = AbstractStreamlet.reflectOutletField(streamlet, outletDescriptor);\n            outlet.decohereInput();\n          } else if (outletDescriptor instanceof InoutletDescriptor) {\n            const inoutlet = AbstractStreamlet.reflectInoutletField(streamlet, outletDescriptor);\n            inoutlet.decohereInput();\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohereInlets(version: number): void {\n    AbstractStreamlet.recohereInlets(version, this, Object.getPrototypeOf(this));\n  }\n\n  /** @internal */\n  static recohereInlets<I, O>(version: number, streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): void {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n        for (const name in streamletPrototype.inlets) {\n          const inletDescriptor = streamletPrototype.inlets[name]!;\n          if (inletDescriptor instanceof InletDescriptor) {\n            const inlet = AbstractStreamlet.reflectInletField(streamlet, inletDescriptor);\n            inlet.recohereOutput(version);\n          } else if (inletDescriptor instanceof InoutletDescriptor) {\n            const inoutlet = AbstractStreamlet.reflectInoutletField(streamlet, inletDescriptor);\n            inoutlet.recohereOutput(version);\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n  }\n\n  protected onRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutlets(version: number): void {\n    AbstractStreamlet.recohereOutlets(version, this, Object.getPrototypeOf(this));\n  }\n\n  /** @internal */\n  static recohereOutlets<I, O>(version: number, streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): void {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        for (const name in streamletPrototype.outlets) {\n          const outletDescriptor = streamletPrototype.outlets[name]!;\n          if (outletDescriptor instanceof OutletDescriptor) {\n            const outlet = AbstractStreamlet.reflectOutletField(streamlet, outletDescriptor);\n            outlet.recohereInput(version);\n          } else if (outletDescriptor instanceof InoutletDescriptor) {\n            const inoutlet = AbstractStreamlet.reflectInoutletField(streamlet, outletDescriptor);\n            inoutlet.recohereInput(version);\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n\n  /** @internal */\n  static reflectEachInlet<I, O, T>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null,\n                                   callback: (inlet: Inlet<I>, name: string, index: number) => T | void): T | undefined;\n  /** @internal */\n  static reflectEachInlet<I, O, T, S>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null,\n                                      callback: (this: S, inlet: Inlet<I>, name: string, index: number) => T | void,\n                                      thisArg: S): T | undefined;\n  /** @internal */\n  static reflectEachInlet<I, O, T, S>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null,\n                                      callback: (this: S | undefined, inlet: Inlet<I>, name: string, index: number) => T | void,\n                                      thisArg?: S): T | undefined {\n    let index = 0;\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n        for (const name in streamletPrototype.inlets) {\n          const inletDescriptor = streamletPrototype.inlets[name]!;\n          let inlet: Inlet<I> | null;\n          if (inletDescriptor instanceof InletDescriptor) {\n            inlet = AbstractStreamlet.reflectInletField(streamlet, inletDescriptor);\n          } else if (inletDescriptor instanceof InoutletDescriptor) {\n            inlet = AbstractStreamlet.reflectInoutletField(streamlet, inletDescriptor);\n          } else {\n            inlet = null;\n          }\n          if (inlet !== null) {\n            const result = callback.call(thisArg, inlet, inletDescriptor.name, index);\n            if (result !== void 0) {\n              return result;\n            }\n            index += 1;\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return void 0;\n  }\n\n  /** @internal */\n  static reflectEachOutlet<I, O, T>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null,\n                                       callback: (outlet: Outlet<O>, name: string, index: number) => T | void): T | undefined;\n  /** @internal */\n  static reflectEachOutlet<I, O, T, S>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null,\n                                       callback: (this: S, outlet: Outlet<O>, name: string, index: number) => T | void,\n                                       thisArg: S): T | undefined;\n  /** @internal */\n  static reflectEachOutlet<I, O, T, S>(streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null,\n                                       callback: (this: S | undefined, outlet: Outlet<O>, name: string, index: number) => T | void,\n                                       thisArg?: S): T | undefined {\n    let index = 0;\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        for (const name in streamletPrototype.outlets) {\n          const outletDescriptor = streamletPrototype.outlets[name]!;\n          let outlet: Outlet<O> | null;\n          if (outletDescriptor instanceof OutletDescriptor) {\n            outlet = AbstractStreamlet.reflectOutletField(streamlet, outletDescriptor);\n          } else if (outletDescriptor instanceof InoutletDescriptor) {\n            outlet = AbstractStreamlet.reflectInoutletField(streamlet, outletDescriptor);\n          } else {\n            outlet = null;\n          }\n          if (outlet !== null) {\n            const result = callback.call(thisArg, outlet, outletDescriptor.name, index);\n            if (result !== void 0) {\n              return result;\n            }\n            index += 1;\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return void 0;\n  }\n\n  /** @internal */\n  static reflectInletCount(streamletPrototype: StreamletPrototype | null): number {\n    let count = 0;\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n        for (const _ in streamletPrototype.inlets) {\n          count += 1;\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return count;\n  }\n\n  /** @internal */\n  static reflectOutletCount(streamletPrototype: StreamletPrototype | null): number {\n    let count = 0;\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        for (const _ in streamletPrototype.outlets) {\n          count += 1;\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return count;\n  }\n\n  /** @internal */\n  static reflectInletIndex<I, O>(index: number, streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): [string, Inlet<I>] | null {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n        for (const name in streamletPrototype.inlets) {\n          if (index === 0) {\n            const inletDescriptor = streamletPrototype.inlets[name]!;\n            if (inletDescriptor instanceof InletDescriptor) {\n              return [inletDescriptor.name, AbstractStreamlet.reflectInletField(streamlet, inletDescriptor)];\n            } else if (inletDescriptor instanceof InoutletDescriptor) {\n              return [inletDescriptor.name, AbstractStreamlet.reflectInoutletField(streamlet, inletDescriptor)];\n            } else {\n              return null;\n            }\n          }\n          index -= 1;\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return null;\n  }\n\n  /** @internal */\n  static reflectOutletIndex<I, O>(index: number, streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): [string, Outlet<O>] | null {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        for (const name in streamletPrototype.outlets) {\n          if (index === 0) {\n            const outletDescriptor = streamletPrototype.outlets[name]!;\n            if (outletDescriptor instanceof OutletDescriptor) {\n              return [outletDescriptor.name, AbstractStreamlet.reflectOutletField(streamlet, outletDescriptor)];\n            } else if (outletDescriptor instanceof InoutletDescriptor) {\n              return [outletDescriptor.name, AbstractStreamlet.reflectInoutletField(streamlet, outletDescriptor)];\n            } else {\n              return null;\n            }\n          }\n          index -= 1;\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return null;\n  }\n\n  /** @internal */\n  static reflectInletKey<I, O>(key: string, streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): Inlet<I> | null {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n        const inletDescriptor = streamletPrototype.inlets![key];\n        if (inletDescriptor !== void 0) {\n          if (inletDescriptor instanceof InletDescriptor) {\n            return AbstractStreamlet.reflectInletField(streamlet, inletDescriptor);\n          } else if (inletDescriptor instanceof InoutletDescriptor) {\n            return AbstractStreamlet.reflectInoutletField(streamlet, inletDescriptor);\n          } else {\n            return null;\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return null;\n  }\n\n  /** @internal */\n  static reflectOutletKey<I, O>(key: string, streamlet: Streamlet<I, O>, streamletPrototype: StreamletPrototype | null): Outlet<O> | null {\n    while (streamletPrototype !== null) {\n      if (Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n        const outletDescriptor = streamletPrototype.outlets![key];\n        if (outletDescriptor !== void 0) {\n          if (outletDescriptor instanceof OutletDescriptor) {\n            return AbstractStreamlet.reflectOutletField(streamlet, outletDescriptor);\n          } else if (outletDescriptor instanceof InoutletDescriptor) {\n            return AbstractStreamlet.reflectInoutletField(streamlet, outletDescriptor);\n          } else {\n            return null;\n          }\n        }\n      }\n      streamletPrototype = Object.getPrototypeOf(streamletPrototype);\n    }\n    return null;\n  }\n\n  /** @internal */\n  static reflectInletField<I, O>(streamlet: Streamlet<I, O>, inletDescriptor: InletDescriptor): Inlet<I> {\n    if (inletDescriptor.type === \"value\") {\n      return AbstractStreamlet.reflectValueInletField(streamlet, inletDescriptor.key);\n    } else if (inletDescriptor.type === \"map\") {\n      return AbstractStreamlet.reflectMapInletField(streamlet, inletDescriptor.key);\n    } else {\n      throw new TypeError(inletDescriptor.type);\n    }\n  }\n\n  /** @internal */\n  static reflectValueInletField<I, O>(streamlet: Streamlet<I, O>, key: string): Inlet<I> {\n    let inlet = (streamlet as any)[key] as Inlet<I> | undefined;\n    if (inlet === void 0) {\n      if (streamlet instanceof AbstractStreamlet) {\n        inlet = streamlet.inlet();\n      } else {\n        inlet = new StreamletInlet<I>(streamlet);\n      }\n      (streamlet as any)[key] = inlet;\n    }\n    return inlet;\n  }\n\n  /** @internal */\n  static reflectMapInletField<I, O>(streamlet: Streamlet<I, O>, key: string): Inlet<I> {\n    return null as any; // TODO\n  }\n\n  /** @internal */\n  static reflectOutletField<I, O>(streamlet: Streamlet<I, O>, outletDescriptor: OutletDescriptor): Outlet<O> {\n    if (outletDescriptor.type === \"value\") {\n      return AbstractStreamlet.reflectValueOutletField(streamlet, outletDescriptor.key);\n    } else if (outletDescriptor.type === \"map\") {\n      return AbstractStreamlet.reflectMapOutletField(streamlet, outletDescriptor.key);\n    } else {\n      throw new TypeError(outletDescriptor.type);\n    }\n  }\n\n  /** @internal */\n  static reflectValueOutletField<I, O>(streamlet: Streamlet<I, O>, key: string): Outlet<O> {\n    let outlet = (streamlet as any)[key] as Outlet<O> | undefined;\n    if (outlet === void 0) {\n      if (streamlet instanceof AbstractStreamlet) {\n        outlet = streamlet.outlet();\n      } else {\n        outlet = new StreamletOutlet<O>(streamlet);\n      }\n      (streamlet as any)[key] = outlet;\n    }\n    return outlet;\n  }\n\n  /** @internal */\n  static reflectMapOutletField<I, O>(streamlet: Streamlet<I, O>, key: string): Outlet<O> {\n    return null as any; // TODO\n  }\n\n  /** @internal */\n  static reflectInoutletField<I, O>(streamlet: Streamlet<I, O>, inoutletDescriptor: InoutletDescriptor): Inoutlet<I, O> {\n    if (inoutletDescriptor.type === \"value\") {\n      return AbstractStreamlet.reflectValueInoutletField(streamlet, inoutletDescriptor.key);\n    } else if (inoutletDescriptor.type === \"map\") {\n      return AbstractStreamlet.reflectMapInoutletField(streamlet, inoutletDescriptor.key);\n    } else {\n      throw new TypeError(inoutletDescriptor.type);\n    }\n  }\n\n  /** @internal */\n  static reflectValueInoutletField<I, O>(streamlet: Streamlet<I, O>, key: string): Inoutlet<I, O> {\n    let inoutlet = (streamlet as any)[key] as Inoutlet<I, O> | undefined;\n    if (inoutlet === void 0) {\n      if (streamlet instanceof AbstractStreamlet) {\n        inoutlet = streamlet.inoutlet();\n      } else {\n        inoutlet = new StreamletInoutlet<I, O>(streamlet);\n      }\n      (streamlet as any)[key] = inoutlet;\n    }\n    return inoutlet;\n  }\n\n  /** @internal */\n  static reflectMapInoutletField<I, O>(streamlet: Streamlet<I, O>, key: string): Inoutlet<I, O> {\n    return null as any; // TODO\n  }\n\n  /** @internal */\n  static init(streamletPrototype: StreamletPrototype): void {\n    if (!Object.prototype.hasOwnProperty.call(streamletPrototype, \"inlets\")) {\n      streamletPrototype.inlets = {};\n    }\n    if (!Object.prototype.hasOwnProperty.call(streamletPrototype, \"outlets\")) {\n      streamletPrototype.outlets = {};\n    }\n    if (!Object.prototype.hasOwnProperty.call(streamletPrototype, \"inoutlets\")) {\n      streamletPrototype.inoutlets = {};\n    }\n  }\n\n  /** @internal */\n  static decorateInlet(options: InletOptions, target: StreamletPrototype, propertyKey: string | symbol): void {\n    AbstractStreamlet.init(target);\n    const name = options.name !== void 0 ? options.name : propertyKey.toString();\n    const type = options.type !== void 0 ? options.type : \"value\";\n    const inletDescriptor = new InletDescriptor(propertyKey.toString(), name, type);\n    target.inlets![name] = inletDescriptor;\n  }\n\n  /** @internal */\n  static decorateOutlet(options: OutletOptions, target: StreamletPrototype, propertyKey: string | symbol): void {\n    AbstractStreamlet.init(target);\n    const name = options.name !== void 0 ? options.name : propertyKey.toString();\n    const type = options.type !== void 0 ? options.type : \"value\";\n    const outletDescriptor = new OutletDescriptor(propertyKey.toString(), name, type);\n    target.outlets![name] = outletDescriptor;\n  }\n\n  /** @internal */\n  static decorateInoutlet(options: InoutletOptions, target: StreamletPrototype, propertyKey: string | symbol): void {\n    AbstractStreamlet.init(target);\n    const name = options.name !== void 0 ? options.name : propertyKey.toString();\n    const type = options.type !== void 0 ? options.type : \"value\";\n    const inoutletDescriptor = new InoutletDescriptor(propertyKey.toString(), name, type);\n    target.inlets![name] = inoutletDescriptor;\n    target.outlets![name] = inoutletDescriptor;\n    target.inoutlets![name] = inoutletDescriptor;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {OutletOptions} from \"./Outlet\";\nimport {StreamletPrototype, AbstractStreamlet} from \"./AbstractStreamlet\";\n\n/** @public */\nexport function Out(name: string): PropertyDecorator;\n/** @public */\nexport function Out(options: OutletOptions): PropertyDecorator;\n/** @public */\nexport function Out(target: unknown, key: string): void;\nexport function Out(target: unknown, key?: string): PropertyDecorator | void {\n  if (arguments.length === 1) {\n    if (typeof target === \"string\") {\n      target = {name: target} as OutletOptions;\n    }\n    return AbstractStreamlet.decorateOutlet.bind(void 0, target as OutletOptions);\n  } else {\n    AbstractStreamlet.decorateOutlet({}, target as StreamletPrototype, key!);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {InoutletOptions} from \"./Inoutlet\";\nimport {StreamletPrototype, AbstractStreamlet} from \"./AbstractStreamlet\";\n\n/** @public */\nexport function Inout(name: string): PropertyDecorator;\n/** @public */\nexport function Inout(options: InoutletOptions): PropertyDecorator;\n/** @public */\nexport function Inout(target: unknown, key: string): void;\nexport function Inout(target: unknown, key?: string): PropertyDecorator | void {\n  if (arguments.length === 1) {\n    if (typeof target === \"string\") {\n      target = {name: target} as InoutletOptions;\n    }\n    return AbstractStreamlet.decorateInoutlet.bind(void 0, target as InoutletOptions);\n  } else {\n    AbstractStreamlet.decorateInoutlet({}, target as StreamletPrototype, key!);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Map} from \"@swim/util\";\nimport type {Value, Record} from \"@swim/structure\";\nimport {Outlet, MapOutlet, StreamletScope} from \"@swim/streamlet\";\nimport type {MapValueFunction, MapFieldValuesFunction} from \"@swim/streamlet\";\nimport type {WatchValueFunction, WatchFieldsFunction} from \"@swim/streamlet\";\n\n/** @public */\nexport interface RecordOutlet extends Outlet<Record>, MapOutlet<Value, Value, Record>, StreamletScope<Value> {\n  outlet(key: Value | string): Outlet<Value>;\n\n  get(): Record;\n  get(key: Value): Value;\n\n  memoize(): MapOutlet<Value, Value, Record>;\n\n  map<O2>(func: MapValueFunction<Record, O2>): Outlet<O2>;\n  map<V2>(func: MapFieldValuesFunction<Value, Value, V2>): MapOutlet<Value, V2, Map<Value, V2>>;\n\n  watch(func: WatchValueFunction<Record>): this;\n  watch(func: WatchFieldsFunction<Value, Value>): this;\n}\n\n/** @public */\nexport const RecordOutlet = (function () {\n  const RecordOutlet = {} as {\n    is(object: unknown): object is RecordOutlet;\n  };\n\n  RecordOutlet.is = function (object: unknown): object is RecordOutlet {\n    if (typeof object === \"object\" && object !== null) {\n      const outlet = object as RecordOutlet;\n      return MapOutlet.is(outlet) && StreamletScope.is(outlet);\n    }\n    return false;\n  };\n\n  return RecordOutlet;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Cursor, Map} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {AnyItem, Item, Field, AnyValue, Value, Record, Text, Selector} from \"@swim/structure\";\nimport {\n  Inlet,\n  Outlet,\n  KeyEffect,\n  MapInlet,\n  MapOutlet,\n  MapOutletCombinators,\n  KeyOutlet,\n  StreamletContext,\n  StreamletScope,\n  FilterFieldsFunction,\n  FilterFieldsCombinator,\n} from \"@swim/streamlet\";\nimport {RecordOutlet} from \"./RecordOutlet\";\nimport {RecordStreamlet} from \"./\"; // forward import\n\n/** @public */\nexport abstract class AbstractRecordOutlet extends Record implements RecordOutlet {\n  constructor() {\n    super();\n    this.effects = new BTree();\n    this.outlets = new BTree();\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  /** @internal */\n  readonly effects: BTree<Value, KeyEffect>;\n\n  /** @internal */\n  readonly outlets: BTree<Value, KeyOutlet<Value, Value>>;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<Record>>;\n\n  /** @internal */\n  readonly version: number;\n\n  declare readonly streamletScope: StreamletScope<Value> | null; // getter defined below to work around useDefineForClassFields lunacy\n\n  get streamletContext(): StreamletContext | null {\n    const scope = this.streamletScope;\n    if (scope !== null) {\n      return scope.streamletContext;\n    }\n    return null;\n  }\n\n  hasOwn(key: AnyValue): boolean {\n    return this.has(key);\n  }\n\n  override get(): Record;\n  override get(key: AnyValue): Value;\n  override get(key?: AnyValue): Record | Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      return super.get(key);\n    }\n  }\n\n  abstract keyIterator(): Cursor<Value>;\n\n  outlet(key: Value | string): Outlet<Value> {\n    if (typeof key === \"string\") {\n      key = Text.from(key);\n    }\n    if (!this.hasOwn(key)) {\n      const scope = this.streamletScope;\n      if (RecordOutlet.is(scope) && scope.has(key)) {\n        // TODO: Support dynamic shadowing?\n        return scope.outlet(key);\n      }\n    }\n    const oldOutlets = this.outlets;\n    let outlet = oldOutlets.get(key);\n    if (outlet === void 0) {\n      outlet = new KeyOutlet<Value, Value>(this, key);\n      (this as Mutable<this>).outlets = oldOutlets.updated(key, outlet);\n      this.decohereInputKey(key, KeyEffect.Update);\n    }\n    return outlet;\n  }\n\n  outputIterator(): Cursor<Inlet<Record>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<Record>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<Record>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: Value, keyOutlet: KeyOutlet<Value, Value>) {\n        keyOutlet.unbindOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: Value, keyOutlet: KeyOutlet<Value, Value>) {\n        keyOutlet.disconnectOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n    this.forEach(function (member: Item): void {\n      if (member instanceof Field) {\n        member = member.toValue();\n      }\n      if (member instanceof AbstractRecordOutlet) {\n        member.disconnectOutputs();\n      } else if (member instanceof RecordStreamlet) {\n        member.disconnectOutputs();\n      } else if (RecordOutlet.is(member)) {\n        member.disconnectOutputs();\n      }\n    }, this);\n  }\n\n  disconnectInputs(): void {\n    // nop\n  }\n\n  decohereInputKey(key: Value, effect: KeyEffect): void {\n    const oldEffects = this.effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willDecohereInputKey(key, effect);\n      (this as Mutable<this>).effects = oldEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereInputKey(key, effect);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        if (MapInlet.is(output)) {\n          output.decohereOutputKey(key, effect);\n        } else {\n          output.decohereOutput();\n        }\n      }\n      const outlet = this.outlets.get(key);\n      if (outlet !== void 0) {\n        outlet.decohereInput();\n      }\n      this.didDecohereInputKey(key, effect);\n    }\n  }\n\n  decohereInput(): void {\n    if (this.version >= 0) {\n      this.willDecohereInput();\n      (this as Mutable<this>).version = -1;\n      this.onDecohereInput();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.outlets.forEach(function (key: Value, outlet: KeyOutlet<Value, Value>): void {\n        outlet.decohereInput();\n      }, this);\n      this.didDecohereInput();\n    }\n  }\n\n  recohereInputKey(key: Value, version: number): void {\n    if (this.version < 0) {\n      const oldEffects = this.effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereInputKey(key, effect, version);\n        (this as Mutable<this>).effects = oldEffects.removed(key);\n        this.onRecohereInputKey(key, effect, version);\n        const outputs = this.outputs;\n        for (let i = 0, n = outputs.length; i < n; i += 1) {\n          const output = outputs[i];\n          if (MapInlet.is(output)) {\n            output.recohereOutputKey(key, version);\n          }\n        }\n        const outlet = this.outlets.get(key);\n        if (outlet !== void 0) {\n          outlet.recohereInput(version);\n        }\n        this.didRecohereInputKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereInput(version: number): void {\n    if (this.version < 0) {\n      this.willRecohereInput(version);\n      this.effects.forEach(function (key: Value): void {\n        this.recohereInputKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohereInput(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.recohereOutput(version);\n      }\n      this.forEach(function (member: Item): void {\n        if (member instanceof Field) {\n          member = member.toValue();\n        }\n        if (member instanceof AbstractRecordOutlet) {\n          member.recohereInput(version);\n        } else if (member instanceof RecordStreamlet) {\n          member.recohere(version);\n        } else if (RecordOutlet.is(member)) {\n          member.recohereInput(version);\n        }\n      }, this);\n      this.didRecohereInput(version);\n    }\n  }\n\n  protected willDecohereInputKey(key: Value, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereInputKey(key: Value, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereInputKey(key: Value, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohereInput(): void {\n    // hook\n  }\n\n  protected onDecohereInput(): void {\n    // hook\n  }\n\n  protected didDecohereInput(): void {\n    // hook\n  }\n\n  protected willRecohereInputKey(key: Value, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereInputKey(key: Value, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected didRecohereInputKey(key: Value, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohereInput(version: number): void {\n    // hook\n  }\n\n  protected onRecohereInput(version: number): void {\n    // hook\n  }\n\n  protected didRecohereInput(version: number): void {\n    // hook\n  }\n\n  override filter(predicate?: AnyItem): Selector;\n  override filter(func: FilterFieldsFunction<Value, Value>): MapOutlet<Value, Value, Map<Value, Value>>;\n  override filter(func: AnyItem | FilterFieldsFunction<Value, Value>): Selector | MapOutlet<Value, Value, Map<Value, Value>> {\n    if (typeof func !== \"function\") {\n      return super.filter(func as AnyItem);\n    } else {\n      const combinator = new FilterFieldsCombinator<Value, Value, Record>(func);\n      combinator.bindInput(this);\n      return combinator;\n    }\n  }\n}\nObject.defineProperty(AbstractRecordOutlet.prototype, \"streamletScope\", {\n  get(this: AbstractRecordOutlet): StreamletScope<Value> | null {\n    return null;\n  },\n  configurable: true,\n});\n/** @public */\nexport interface AbstractRecordOutlet extends MapOutletCombinators<Value, Value, Record> {\n}\nMapOutletCombinators.define(AbstractRecordOutlet.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value, Record} from \"@swim/structure\";\nimport {Inlet, Outlet, StreamletContext, StreamletScope, Streamlet, AbstractStreamlet} from \"@swim/streamlet\";\n\n/** @public */\nexport abstract class RecordStreamlet<I extends Value = Value, O extends Value = I> extends Record implements Streamlet<I, O> {\n  override isConstant(): boolean {\n    return false;\n  }\n\n  abstract readonly streamletScope: StreamletScope<O> | null;\n\n  abstract setStreamletScope(parent: StreamletScope<O> | null): void;\n\n  abstract readonly streamletContext: StreamletContext | null;\n\n  abstract setStreamletContext(context: StreamletContext | null): void;\n\n  abstract inlet(key: string): Inlet<I> | null;\n\n  abstract bindInput(key: string, input: Outlet<I>): void;\n\n  abstract unbindInput(key: string): void;\n\n  abstract outlet(key: string): Outlet<O> | null;\n\n  abstract disconnectInputs(): void;\n\n  abstract disconnectOutputs(): void;\n\n  abstract decohere(): void;\n\n  abstract recohere(version: number): void;\n\n  compile(): void {\n    AbstractStreamlet.reflectEachInlet<I, O, void, this>(this, Object.getPrototypeOf(this), function (inlet: Inlet<I>, name: string): void {\n      if (inlet.input === null) {\n        this.compileInlet(inlet, name);\n      }\n    }, this);\n  }\n\n  compileInlet(inlet: Inlet<I>, name: string): void {\n    const scope = this.streamletScope;\n    if (scope !== null) {\n      const input = scope.outlet(name);\n      if (input !== null) {\n        // Assume Outlet<O> conforms to Outlet<I>.\n        inlet.bindInput(input as Outlet<unknown> as Outlet<I>);\n      }\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyItem, Item, Field, Slot, AnyValue, Value, AnyText, Text, AnyNum, Num, Form} from \"@swim/structure\";\nimport {\n  Inlet,\n  Outlet,\n  Inoutlet,\n  StreamletContext,\n  GenericStreamlet,\n  AbstractStreamlet,\n  StreamletScope,\n  StreamletInlet,\n  StreamletOutlet,\n  StreamletInoutlet,\n} from \"@swim/streamlet\";\nimport {RecordStreamlet} from \"./RecordStreamlet\";\n\n/** @public */\nexport abstract class AbstractRecordStreamlet<I extends Value = Value, O extends Value = I> extends RecordStreamlet<I, O> implements GenericStreamlet<I, O> {\n  constructor(scope: StreamletScope<O> | null = null) {\n    super();\n    this.streamletScope = scope;\n    this.streamletContext = null;\n    this.version = -1;\n  }\n\n  override readonly streamletScope: StreamletScope<O> | null;\n\n  override setStreamletScope(scope: StreamletScope<O> | null): void {\n    (this as Mutable<this>).streamletScope = scope;\n  }\n\n  override readonly streamletContext: StreamletContext | null;\n\n  override setStreamletContext(context: StreamletContext | null): void {\n    (this as Mutable<this>).streamletContext = context;\n  }\n\n  /** @internal */\n  readonly version: number;\n\n  override isEmpty(): boolean {\n    return this.length !== 0;\n  }\n\n  override get length(): number {\n    return AbstractStreamlet.reflectOutletCount(Object.getPrototypeOf(this));\n  }\n\n  override has(key: AnyValue): boolean {\n    if (key instanceof Text) {\n      key = key.value;\n    } else if (typeof key !== \"string\") {\n      return false;\n    }\n    const outlet = this.outlet(key);\n    return outlet !== null;\n  }\n\n  override get(key: AnyValue): Value {\n    if (key instanceof Text) {\n      key = key.value;\n    } else if (typeof key !== \"string\") {\n      return Value.absent();\n    }\n    const outlet = this.outlet(key);\n    if (outlet !== null) {\n      const output = outlet.get();\n      if (output !== void 0) {\n        return output;\n      }\n    }\n    return Value.absent();\n  }\n\n  override getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  override getSlot(key: AnyValue): Value {\n    return this.get(key);\n  }\n\n  override getField(key: AnyValue): Field | undefined {\n    if (typeof key === \"string\") {\n      key = Text.from(key);\n    } else if (!(key instanceof Text)) {\n      return void 0;\n    }\n    const value = this.get(key);\n    if (value.isDefined()) {\n      return Slot.of(key, value);\n    }\n    return void 0;\n  }\n\n  override getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const entry = AbstractStreamlet.reflectOutletIndex<I, O>(index, this, Object.getPrototypeOf(this));\n    if (entry !== null) {\n      const name = entry[0];\n      let output = entry[1].get() as Value | undefined;\n      if (output === void 0) {\n        output = Value.extant();\n      }\n      return Slot.of(name, output);\n    }\n    return Item.absent();\n  }\n\n  override set(key: AnyValue, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setAttr(key: AnyText, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setSlot(key: AnyValue, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setItem(index: number, item: AnyItem): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override push(...items: AnyItem[]): number {\n    throw new Error(\"unsupported\");\n  }\n\n  override splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    throw new Error(\"unsupported\");\n  }\n\n  override delete(key: AnyValue): Item {\n    throw new Error(\"unsupported\");\n  }\n\n  override clear(): void {\n    throw new Error(\"unsupported\");\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | unknown, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    return AbstractStreamlet.reflectEachOutlet(this, Object.getPrototypeOf(this), function (outlet: Outlet<O>, name: string, index: number): T | void {\n      const output = outlet.get();\n      if (output !== void 0) {\n        const result = callback.call(thisArg, output, index);\n        if (result !== void 0) {\n          return result;\n        }\n      }\n    }, this);\n  }\n\n  override inlet(key: string): Inlet<I> | null;\n  override inlet<I2 extends I>(): Inlet<I2>;\n  override inlet(key?: string): Inlet<I> | null {\n    if (key === void 0) {\n      return new StreamletInlet<I>(this);\n    } else {\n      return AbstractStreamlet.reflectInletKey<I, O>(key, this, Object.getPrototypeOf(this));\n    }\n  }\n\n  override bindInput(key: string, input: Outlet<I>): void {\n    const inlet = this.inlet(key);\n    if (inlet === null) {\n      throw new Error(key);\n    }\n    inlet.bindInput(input);\n  }\n\n  override unbindInput(key: string): void {\n    const inlet = this.inlet(key);\n    if (inlet === null) {\n      throw new Error(key);\n    }\n    inlet.unbindInput();\n  }\n\n  override outlet(key: string | Outlet<O>): Outlet<O> | null;\n  override outlet<O2 extends Value>(): Outlet<O2>;\n  override outlet(key?: string | Outlet<O>): Outlet<O> | null {\n    if (key === void 0) {\n      return new StreamletOutlet<O>(this);\n    } else if (typeof key === \"string\") {\n      return AbstractStreamlet.reflectOutletKey<I, O>(key, this, Object.getPrototypeOf(this));\n    } else {\n      return key;\n    }\n  }\n\n  inoutlet<I2 extends I, O2 extends Value>(): Inoutlet<I2, O2> {\n    return new StreamletInoutlet<I2, O2>(this as RecordStreamlet<I2, O2>);\n  }\n\n  override decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      this.onDecohereOutlets();\n      this.didDecohere();\n    }\n  }\n\n  override recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      (this as Mutable<this>).version = version;\n      this.onRecohereInlets(version);\n      this.onRecohere(version);\n      this.onRecohereOutlets(version);\n      this.didRecohere(version);\n    }\n  }\n\n  getInput<I2 extends I>(inlet: Inlet<I2> | string): I2 | undefined;\n  getInput<I2 extends I, E = I2>(inlet: Inlet<I2> | string, orElse: E): I2 | E;\n  getInput<I2 extends I, E = I2>(inlet: Inlet<I2> | string, orElse?: E): I2 | E | undefined {\n    if (typeof inlet === \"string\") {\n      inlet = this.inlet(inlet) as Inlet<I2>;\n    }\n    let object: I2 | E | undefined;\n    if (inlet !== null) {\n      const input = inlet.input;\n      if (input !== null) {\n        object = input.get();\n      }\n    }\n    if (object === void 0) {\n      object = orElse;\n    }\n    return object;\n  }\n\n  castInput<T>(inlet: Inlet<I> | string, form: Form<T, unknown>): T | undefined;\n  castInput<T, E = T>(inlet: Inlet<I> | string, form: Form<T, unknown>, orElse: E): T | E;\n  castInput<T, E = T>(inlet: Inlet<I> | string, form: Form<T, unknown>, orElse?: E): T | E | undefined {\n    const input = this.getInput(inlet);\n    let object: T | E | undefined;\n    if (input !== void 0) {\n      object = form.cast(input);\n    }\n    if (object === void 0) {\n      object = orElse;\n    }\n    return object;\n  }\n\n  coerceInput<T>(inlet: Inlet<I> | string, form: Form<T, unknown>): T;\n  coerceInput<T, E = T>(inlet: Inlet<I> | string, form: Form<T, unknown>, orElse: E): T | E;\n  coerceInput<T, E = T>(inlet: Inlet<I> | string, form: Form<T, unknown>, orElse?: E): T | E {\n    const input = this.getInput(inlet);\n    let object: T | E | undefined;\n    if (input !== void 0) {\n      object = form.cast(input);\n    }\n    if (object === void 0) {\n      object = form.unit;\n    }\n    if (object === void 0) {\n      object = orElse;\n    }\n    return object!;\n  }\n\n  getOutput(outlet: Outlet<O> | string): O | undefined {\n    return void 0;\n  }\n\n  override disconnectInputs(): void {\n    AbstractStreamlet.disconnectInputs(this, Object.getPrototypeOf(this));\n  }\n\n  override disconnectOutputs(): void {\n    AbstractStreamlet.disconnectOutputs(this, Object.getPrototypeOf(this));\n  }\n\n  willDecohereInlet(inlet: Inlet<I>): void {\n    // hook\n  }\n\n  didDecohereInlet(inlet: Inlet<I>): void {\n    this.decohere();\n  }\n\n  willRecohereInlet(inlet: Inlet<I>, version: number): void {\n    // hook\n  }\n\n  didRecohereInlet(inlet: Inlet<I>, version: number): void {\n    this.recohere(version);\n  }\n\n  willDecohereOutlet(outlet: Outlet<O>): void {\n    // hook\n  }\n\n  didDecohereOutlet(outlet: Outlet<O>): void {\n    // hook\n  }\n\n  willRecohereOutlet(outlet: Outlet<O>, version: number): void {\n    // hook\n  }\n\n  didRecohereOutlet(outlet: Outlet<O>, version: number): void {\n    // hook\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected onDecohereOutlets(): void {\n    AbstractStreamlet.decohereOutlets(this, Object.getPrototypeOf(this));\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohereInlets(version: number): void {\n    AbstractStreamlet.recohereInlets(version, this, Object.getPrototypeOf(this));\n  }\n\n  protected onRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohereOutlets(version: number): void {\n    AbstractStreamlet.recohereOutlets(version, this, Object.getPrototypeOf(this));\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Value, Record} from \"@swim/structure\";\nimport {KeyEffect, AbstractInlet} from \"@swim/streamlet\";\nimport {RecordOutlet} from \"./RecordOutlet\";\n\n/** @internal */\nexport class RecordFieldUpdater extends AbstractInlet<Value> {\n  constructor(record: Record, key: Value) {\n    super();\n    this.record = record;\n    this.key = key;\n  }\n\n  readonly record: Record;\n\n  readonly key: Value;\n\n  protected override onDecohereOutput(): void {\n    const record = this.record;\n    if (RecordOutlet.is(record)) {\n      record.decohereInputKey(this.key, KeyEffect.Update);\n    }\n  }\n\n  protected override onRecohereOutput(version: number): void {\n    const input = this.input;\n    if (input !== null) {\n      const value = input.get();\n      if (value !== void 0) {\n        this.record.set(this.key, value);\n      } else {\n        this.record.delete(this.key);\n      }\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {AnyItem, Item, Field, Slot, AnyValue, Value, Record, AnyText, Text, AnyNum, MathModule} from \"@swim/structure\";\nimport {KeyEffect, MapOutlet} from \"@swim/streamlet\";\nimport {RecordStreamlet} from \"./RecordStreamlet\";\nimport {AbstractRecordOutlet} from \"./AbstractRecordOutlet\";\nimport {RecordFieldUpdater} from \"./RecordFieldUpdater\";\nimport {RecordScope} from \"./\"; // forward import\nimport {Reifier} from \"./\"; // forward import\nimport {Dataflow} from \"./\"; // forward import\n\n/** @public */\nexport class RecordModel extends AbstractRecordOutlet {\n  constructor(state?: Record) {\n    super();\n    if (state === void 0) {\n      state = Record.create();\n    }\n    this.state = state;\n    this.fieldUpdaters = new BTree();\n  }\n\n  /** @internal */\n  readonly state: Record;\n\n  /** @internal */\n  readonly fieldUpdaters: BTree<Value, RecordFieldUpdater>;\n\n  override isEmpty(): boolean {\n    return this.state.isEmpty();\n  }\n\n  override isArray(): boolean {\n    return this.state.isArray();\n  }\n\n  override isObject(): boolean {\n    return this.state.isObject();\n  }\n\n  override get length(): number {\n    return this.state.length;\n  }\n\n  declare readonly fieldCount: number; // getter defined below to work around useDefineForClassFields lunacy\n\n  override get valueCount(): number {\n    return this.state.valueCount;\n  }\n\n  override has(key: AnyValue): boolean {\n    if (this.state.has(key)) {\n      return true;\n    } else {\n      const scope = this.streamletScope;\n      return scope instanceof Record ? scope.has(key) : false;\n    }\n  }\n\n  override hasOwn(key: AnyValue): boolean {\n    return this.state.has(key);\n  }\n\n  override indexOf(item: AnyItem, index?: number): number {\n    return this.state.indexOf(item, index);\n  }\n\n  override lastIndexOf(item: AnyItem, index: number = 0): number {\n    return this.state.lastIndexOf(item, index);\n  }\n\n  override get(): Record;\n  override get(key: AnyValue): Value;\n  override get(key?: AnyValue): Record | Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      key = Value.fromAny(key);\n      let value = this.state.get(key);\n      if (!value.isDefined()) {\n        const scope = this.streamletScope;\n        if (scope instanceof Record) {\n          value = scope.get(key);\n        }\n      }\n      return value;\n    }\n  }\n\n  override getAttr(key: AnyText): Value {\n    key = Text.fromAny(key);\n    let value = this.state.getAttr(key);\n    if (!value.isDefined()) {\n      const scope = this.streamletScope;\n      if (scope instanceof Record) {\n        value = scope.getAttr(key);\n      }\n    }\n    return value;\n  }\n\n  override getSlot(key: AnyValue): Value {\n    key = Value.fromAny(key);\n    let value = this.state.getSlot(key);\n    if (!value.isDefined()) {\n      const scope = this.streamletScope;\n      if (scope instanceof Record) {\n        value = scope.getSlot(key);\n      }\n    }\n    return value;\n  }\n\n  override getField(key: AnyValue): Field | undefined {\n    key = Value.fromAny(key);\n    let field = this.state.getField(key);\n    if (field === void 0) {\n      const scope = this.streamletScope;\n      if (scope instanceof Record) {\n        field = scope.getField(key);\n      }\n    }\n    return field;\n  }\n\n  override getItem(index: AnyNum): Item {\n    return this.state.getItem(index);\n  }\n\n  bindValue(key: Value, expr: Value): void {\n    const fieldUpdater = new RecordFieldUpdater(this, key);\n    const valueInput = Dataflow.compile(expr, this);\n    fieldUpdater.bindInput(valueInput);\n    // TODO: clean up existing field updater\n    (this as Mutable<this>).fieldUpdaters = this.fieldUpdaters.updated(key, fieldUpdater);\n  }\n\n  override set(key: AnyValue, newValue: AnyValue): this {\n    key = Value.fromAny(key);\n    if (!this.state.has(key)) {\n      const scope = this.streamletScope;\n      if (scope instanceof Record && scope.has(key)) {\n        scope.set(key, newValue);\n      } else {\n        this.state.set(key, newValue);\n      }\n    } else {\n      this.state.set(key, newValue);\n    }\n    this.decohereInputKey(key, KeyEffect.Update);\n    return this;\n  }\n\n  override setAttr(key: AnyText, newValue: AnyValue): this {\n    key = Text.fromAny(key);\n    if (!this.state.has(key)) {\n      const scope = this.streamletScope;\n      if (scope instanceof Record && scope.has(key)) {\n        scope.setAttr(key, newValue);\n      } else {\n        this.state.setAttr(key, newValue);\n      }\n    } else {\n      this.state.setAttr(key, newValue);\n    }\n    this.decohereInputKey(key, KeyEffect.Update);\n    return this;\n  }\n\n  override setSlot(key: AnyValue, newValue: AnyValue): this {\n    key = Value.fromAny(key);\n    if (!this.state.has(key)) {\n      const scope = this.streamletScope;\n      if (scope instanceof Record && scope.has(key)) {\n        scope.setSlot(key, newValue);\n      } else {\n        this.state.setSlot(key, newValue);\n      }\n    } else {\n      this.state.setSlot(key, newValue);\n    }\n    this.decohereInputKey(key, KeyEffect.Update);\n    return this;\n  }\n\n  override setItem(index: number, newItem: AnyItem): this {\n    const oldItem = this.state.getItem(index);\n    newItem = Item.fromAny(newItem);\n    this.state.setItem(index, newItem);\n    if (oldItem instanceof Field && newItem instanceof Field) {\n      if (oldItem.key.equals(newItem.key)) {\n        this.decohereInputKey(oldItem.key, KeyEffect.Update);\n      } else {\n        this.decohereInputKey(oldItem.key, KeyEffect.Remove);\n        this.decohereInputKey(newItem.key, KeyEffect.Update);\n      }\n    } else if (oldItem instanceof Field) {\n      this.decohereInputKey(oldItem.key, KeyEffect.Remove);\n    } else if (newItem instanceof Field) {\n      this.decohereInputKey(newItem.key, KeyEffect.Update);\n    } else {\n      this.decohereInput();\n    }\n    return this;\n  }\n\n  override push(...newItems: AnyItem[]): number {\n    let i = this.state.length;\n    const n = this.state.push(...newItems);\n    while (i < n) {\n      const newItem = this.state.get(i);\n      if (newItem instanceof Field) {\n        this.decohereInputKey(newItem.key, KeyEffect.Update);\n      }\n      i += 1;\n    }\n    return n;\n  }\n\n  override splice(start: number, deleteCount: number = 0, ...newItems: AnyItem[]): Item[] {\n    const n = this.state.length;\n    if (start < 0) {\n      start = n + start;\n    }\n    start = Math.max(0, start);\n    deleteCount = Math.max(0, deleteCount);\n    const deleted = this.state.splice(start, deleteCount, ...newItems);\n    for (let i = 0; i < deleted.length; i += 1) {\n      const oldItem = deleted[i];\n      if (oldItem instanceof Field) {\n        this.decohereInputKey(oldItem.key, KeyEffect.Remove);\n      }\n    }\n    for (let i = start; i < start + newItems.length; i += 1) {\n      const newItem = this.state.get(i);\n      if (newItem instanceof Field) {\n        this.decohereInputKey(newItem.key, KeyEffect.Update);\n      }\n    }\n    return deleted;\n  }\n\n  override delete(key: AnyValue): Item {\n    const oldItem = this.state.delete(key);\n    if (oldItem instanceof Field) {\n      this.decohereInputKey(oldItem.key, KeyEffect.Remove);\n    }\n    return oldItem;\n  }\n\n  override clear(): void {\n    const oldState = this.state.branch();\n    this.state.clear();\n    oldState.forEach(function (oldItem: Item): void {\n      if (oldItem instanceof Field) {\n        this.decohereInputKey(oldItem.key, KeyEffect.Remove);\n      }\n    }, this);\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    return this.state.forEach(callback, thisArg);\n  }\n\n  override keyIterator(): Cursor<Value> {\n    throw new Error(); // TODO\n  }\n\n  override disconnectInputs(): void {\n    const oldFieldUpdaters = this.fieldUpdaters;\n    if (!oldFieldUpdaters.isEmpty()) {\n      (this as Mutable<this>).fieldUpdaters = new BTree();\n      oldFieldUpdaters.forEach(function (key: Value, inlet: RecordFieldUpdater): void {\n        inlet.disconnectInputs();\n      }, this);\n    }\n  }\n\n  override memoize(): MapOutlet<Value, Value, Record> {\n    return this;\n  }\n\n  materialize(record: Record): void {\n    record.forEach(function (item: Item): void {\n      this.materializeItem(item);\n    }, this);\n  }\n\n  materializeItem(item: Item): void {\n    if (item instanceof Field) {\n      this.materializeField(item);\n    } else {\n      this.materializeValue(item);\n    }\n  }\n\n  materializeField(field: Field): void {\n    const value = field.value;\n    if (value instanceof RecordStreamlet) {\n      value.setStreamletScope(this);\n      this.state.push(field);\n    } else if (value instanceof Record) {\n      // Add recursively materialized nested scope.\n      const child = new RecordScope(this);\n      child.materialize(value);\n      this.state.push(field.updatedValue(child));\n    } else {\n      this.state.push(field);\n    }\n  }\n\n  materializeValue(value: Value): void {\n    if (value instanceof RecordStreamlet) {\n      value.setStreamletScope(this);\n      this.state.push(value);\n    } else if (value instanceof Record) {\n      // Add recursively materialized nested scope.\n      const child = new RecordScope(this);\n      child.materialize(value);\n      this.state.push(child);\n    } else {\n      this.state.push(value);\n    }\n  }\n\n  compile(record: Record): void {\n    record.forEach(function (item: Item, index: number): void {\n      this.compileItem(item, index);\n    }, this);\n  }\n\n  compileItem(item: Item, index: number): void {\n    if (item instanceof Field) {\n      this.compileField(item, index);\n    } else {\n      this.compileValue(item, index);\n    }\n  }\n\n  compileField(field: Field, index: number): void {\n    const key = field.key;\n    const value = field.value;\n    if (!key.isConstant()) {\n      // TODO: Add dynamic key updater.\n    } else if (!value.isConstant()) {\n      if (value instanceof RecordStreamlet) {\n        // Lexically bind nested streamlet.\n        value.compile();\n        // Decohere nested scope key.\n        this.decohereInputKey(key, KeyEffect.Update);\n      } else if (value instanceof Record) {\n        // Recursively compile nested scope.\n        (this.state.getItem(index).toValue() as RecordModel).compile(value);\n        // Decohere nested scope key.\n        this.decohereInputKey(key, KeyEffect.Update);\n      } else {\n        // Set placeholder value.\n        field.setValue(Value.extant());\n        // Bind dynamic value updater.\n        this.bindValue(key, value);\n      }\n    } else {\n      // Decohere constant key.\n      this.decohereInputKey(key, KeyEffect.Update);\n    }\n  }\n\n  compileValue(value: Value, index: number): void {\n    if (value instanceof RecordStreamlet) {\n      value.compile();\n    } else if (value instanceof Record) {\n      // Recursively compile nested scope.\n      (this.state.getItem(index) as RecordModel).compile(value);\n    } else if (!value.isConstant()) {\n      // TODO: Bind dynamic item updater.\n    } else {\n      // TODO: Fold constant expressions.\n    }\n  }\n\n  /** @beta */\n  reify(reifier: Reifier | null = Reifier.system()): void {\n    this.forEach(function (oldItem: Item, index: number): void {\n      const newItem = this.reifyItem(oldItem, reifier);\n      if (oldItem !== newItem) {\n        this.setItem(index, newItem);\n      }\n    }, this);\n  }\n\n  /** @beta */\n  reifyItem(item: Item, reifier: Reifier | null): Item {\n    if (reifier !== null) {\n      item = reifier.reify(item);\n    }\n    const scope = this.streamletScope;\n    if (scope instanceof RecordModel) {\n      return scope.reifyItem(item, reifier);\n    } else {\n      return item;\n    }\n  }\n\n  static from(record: Record): RecordModel {\n    const model = new RecordModel();\n    model.materialize(record);\n    model.compile(record);\n    return model;\n  }\n\n  static override of(...items: AnyItem[]): RecordModel {\n    return RecordModel.from(Record.of(...items));\n  }\n\n  static override globalScope(): RecordModel {\n    const model = new RecordModel();\n    model.materializeField(Slot.of(\"math\", MathModule.scope.branch()));\n    return model;\n  }\n}\nObject.defineProperty(RecordModel.prototype, \"fieldCount\", {\n  get(this: RecordModel): number {\n    return this.state.fieldCount;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyItem, Value, Record} from \"@swim/structure\";\nimport type {StreamletScope} from \"@swim/streamlet\";\nimport {RecordModel} from \"./RecordModel\";\n\n/** @public */\nexport class RecordScope extends RecordModel {\n  constructor(scope: StreamletScope<Value> | null, state?: Record) {\n    super(state);\n    Object.defineProperty(this, \"streamletScope\", {\n      value: scope,\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    });\n  }\n\n  override readonly streamletScope!: StreamletScope<Value> | null;\n\n  static override from(record: Record): RecordScope {\n    const scope = new RecordScope(RecordScope.globalScope());\n    scope.materialize(record);\n    scope.compile(record);\n    return scope;\n  }\n\n  static override of(...items: AnyItem[]): RecordScope {\n    return RecordScope.from(Record.of(...items));\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item} from \"@swim/structure\";\n\n/** @beta */\nexport abstract class Reifier {\n  abstract reify(item: Item): Item;\n\n  static system(): Reifier {\n    return null as unknown as Reifier; // TODO\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {AbstractOutlet, OutletInlet, OutletMapInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport class GetOutlet extends AbstractOutlet<Value> {\n  constructor() {\n    super();\n    this.keyInlet = new OutletInlet<Value>(this);\n    this.mapInlet = new OutletMapInlet<Value, Value, unknown>(this);\n  }\n\n  readonly keyInlet: OutletInlet<Value>;\n\n  readonly mapInlet: OutletMapInlet<Value, Value, unknown>;\n\n  override get(): Value {\n    const keyInput = this.keyInlet.input;\n    if (keyInput !== null) {\n      const key = keyInput.get();\n      if (key !== void 0) {\n        const mapInput = this.mapInlet.input;\n        if (mapInput !== null) {\n          const value = mapInput.get(key);\n          if (value !== void 0) {\n            return value;\n          }\n        }\n      }\n    }\n    return Value.absent();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Value} from \"@swim/structure\";\nimport {Inlet, AbstractOutlet, OutletInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport abstract class BinaryOutlet extends AbstractOutlet<Value> {\n  constructor() {\n    super();\n    this.operand1Inlet = new OutletInlet<Value>(this);\n    this.operand2Inlet = new OutletInlet<Value>(this);\n  }\n\n  readonly operand1Inlet: Inlet<Value>;\n\n  readonly operand2Inlet: Inlet<Value>;\n\n  override get(): Value {\n    const operand1Input = this.operand1Inlet.input;\n    const operand2Input = this.operand2Inlet.input;\n    if (operand1Input !== null && operand2Input !== null) {\n      const argument1 = operand1Input.get();\n      const argument2 = operand2Input.get();\n      if (argument1 !== void 0 && argument2 !== void 0) {\n        const result = this.evaluate(argument1, argument2);\n        return result.toValue();\n      }\n    }\n    return Value.absent();\n  }\n\n  protected abstract evaluate(argument1: Value, argument2: Value): Item;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Value} from \"@swim/structure\";\nimport {Inlet, AbstractOutlet, OutletInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport abstract class UnaryOutlet extends AbstractOutlet<Value> {\n  constructor() {\n    super();\n    this.operandInlet = new OutletInlet<Value>(this);\n  }\n\n  readonly operandInlet: Inlet<Value>;\n\n  override get(): Value {\n    const operandInput = this.operandInlet.input;\n    if (operandInput !== null) {\n      const argument = operandInput.get();\n      if (argument !== void 0) {\n        const result = this.evaluate(argument);\n        return result.toValue();\n      }\n    }\n    return Value.absent();\n  }\n\n  protected abstract evaluate(argument: Value): Item;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {Inlet, AbstractOutlet, OutletInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport class ConditionalOutlet extends AbstractOutlet<Value> {\n  constructor() {\n    super();\n    this.ifInlet = new OutletInlet<Value>(this);\n    this.thenInlet = new OutletInlet<Value>(this);\n    this.elseInlet = new OutletInlet<Value>(this);\n  }\n\n  readonly ifInlet: Inlet<Value>;\n\n  readonly thenInlet: Inlet<Value>;\n\n  readonly elseInlet: Inlet<Value>;\n\n  override get(): Value {\n    const ifInput = this.ifInlet.input;\n    if (ifInput !== null) {\n      const ifTerm = ifInput.get();\n      if (ifTerm !== void 0) {\n        if (ifTerm.isDefinite()) {\n          const thenInput = this.thenInlet.input;\n          if (thenInput !== null) {\n            const thenTerm = thenInput.get();\n            if (thenTerm !== void 0) {\n              return thenTerm;\n            }\n          }\n        } else {\n          const elseInput = this.elseInlet.input;\n          if (elseInput !== null) {\n            const elseTerm = elseInput.get();\n            if (elseTerm !== void 0) {\n              return elseTerm;\n            }\n          }\n        }\n      }\n    }\n    return Value.absent();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {Inlet, AbstractOutlet, OutletInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport class OrOutlet extends AbstractOutlet<Value> {\n  constructor() {\n    super();\n    this.operand1Inlet = new OutletInlet<Value>(this);\n    this.operand2Inlet = new OutletInlet<Value>(this);\n  }\n\n  readonly operand1Inlet: Inlet<Value>;\n\n  readonly operand2Inlet: Inlet<Value>;\n\n  override get(): Value {\n    const operand1Input = this.operand1Inlet.input;\n    const argument1 = operand1Input !== null ? operand1Input.get() : void 0;\n    if (argument1 !== void 0 && argument1.isDefinite()) {\n      return argument1;\n    }\n    const operand2Input = this.operand2Inlet.input;\n    const argument2 = operand2Input !== null ? operand2Input.get() : void 0;\n    if (argument2 !== void 0) {\n      return argument2;\n    }\n    return Value.absent();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {Inlet, AbstractOutlet, OutletInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport class AndOutlet extends AbstractOutlet<Value> {\n  constructor() {\n    super();\n    this.operand1Inlet = new OutletInlet<Value>(this);\n    this.operand2Inlet = new OutletInlet<Value>(this);\n  }\n\n  readonly operand1Inlet: Inlet<Value>;\n\n  readonly operand2Inlet: Inlet<Value>;\n\n  override get(): Value {\n    const operand1Input = this.operand1Inlet.input;\n    const argument1 = operand1Input !== null ? operand1Input.get() : void 0;\n    if (argument1 !== void 0) {\n      if (argument1.isDefinite()) {\n        const operand2Input = this.operand2Inlet.input;\n        const argument2 = operand2Input !== null ? operand2Input.get() : void 0;\n        if (argument2 !== void 0) {\n          return argument2;\n        }\n      }\n      return argument1;\n    }\n    return Value.absent();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class BitwiseOrOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.bitwiseOr(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class BitwiseXorOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.bitwiseXor(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class BitwiseAndOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.bitwiseAnd(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class LtOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.lt(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class LeOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.le(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class EqOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.eq(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class NeOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.ne(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class GeOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.ge(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class GtOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.gt(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class PlusOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.plus(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class MinusOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.minus(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class TimesOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.times(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class DivideOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.divide(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {BinaryOutlet} from \"./BinaryOutlet\";\n\n/** @internal */\nexport class ModuloOutlet extends BinaryOutlet {\n  protected override evaluate(argument1: Value, argument2: Value): Item {\n    return argument1.modulo(argument2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {UnaryOutlet} from \"./UnaryOutlet\";\n\n/** @internal */\nexport class NotOutlet extends UnaryOutlet {\n  protected override evaluate(argument: Value): Item {\n    return argument.not();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {UnaryOutlet} from \"./UnaryOutlet\";\n\n/** @internal */\nexport class BitwiseNotOutlet extends UnaryOutlet {\n  protected override evaluate(argument: Value): Item {\n    return argument.bitwiseNot();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {UnaryOutlet} from \"./UnaryOutlet\";\n\n/** @internal */\nexport class NegativeOutlet extends UnaryOutlet {\n  protected override evaluate(argument: Value): Item {\n    return argument.negative();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Item, Value} from \"@swim/structure\";\nimport {UnaryOutlet} from \"./UnaryOutlet\";\n\n/** @internal */\nexport class PositiveOutlet extends UnaryOutlet {\n  protected override evaluate(argument: Value): Item {\n    return argument.positive();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value, Record, Func, Interpreter} from \"@swim/structure\";\nimport {Inlet, AbstractOutlet, OutletInlet} from \"@swim/streamlet\";\n\n/** @internal */\nexport class InvokeOutlet extends AbstractOutlet<Value> {\n  constructor(scope: Record) {\n    super();\n    this.scope = scope;\n    this.funcInlet = new OutletInlet<Value>(this);\n    this.argsInlet = new OutletInlet<Value>(this);\n  }\n\n  /** @internal */\n  readonly scope: Record;\n\n  readonly funcInlet: Inlet<Value>;\n\n  readonly argsInlet: Inlet<Value>;\n\n  override get(): Value {\n    const funcInput = this.funcInlet.input;\n    const argsInput = this.argsInlet.input;\n    if (funcInput !== null && argsInput !== null) {\n      const func = funcInput.get();\n      if (func instanceof Func) {\n        const args = argsInput.get();\n        if (args !== void 0) {\n          const interpreter = new Interpreter();\n          interpreter.pushScope(this.scope);\n          const result = func.invoke(args, interpreter, void 0 /* TODO: generalize InvokeOperator to InvokeContext */);\n          return result.toValue();\n        }\n      }\n    }\n    return Value.absent();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Value,\n  Record,\n  Selector,\n  IdentitySelector,\n  GetSelector,\n  GetAttrSelector,\n  GetItemSelector,\n  KeysSelector,\n  ValuesSelector,\n  ChildrenSelector,\n  DescendantsSelector,\n  FilterSelector,\n  Operator,\n  BinaryOperator,\n  UnaryOperator,\n  ConditionalOperator,\n  OrOperator,\n  AndOperator,\n  BitwiseOrOperator,\n  BitwiseXorOperator,\n  BitwiseAndOperator,\n  LtOperator,\n  LeOperator,\n  EqOperator,\n  NeOperator,\n  GeOperator,\n  GtOperator,\n  PlusOperator,\n  MinusOperator,\n  TimesOperator,\n  DivideOperator,\n  ModuloOperator,\n  NotOperator,\n  BitwiseNotOperator,\n  NegativeOperator,\n  PositiveOperator,\n  InvokeOperator,\n} from \"@swim/structure\";\nimport {Outlet, MapOutlet, KeyOutlet, StreamletScope, ValueInput} from \"@swim/streamlet\";\nimport {RecordOutlet} from \"./RecordOutlet\";\nimport {GetOutlet} from \"./selector/GetOutlet\";\nimport type {BinaryOutlet} from \"./operator/BinaryOutlet\";\nimport type {UnaryOutlet} from \"./operator/UnaryOutlet\";\nimport {ConditionalOutlet} from \"./operator/ConditionalOutlet\";\nimport {OrOutlet} from \"./operator/OrOutlet\";\nimport {AndOutlet} from \"./operator/AndOutlet\";\nimport {BitwiseOrOutlet} from \"./operator/BitwiseOrOutlet\";\nimport {BitwiseXorOutlet} from \"./operator/BitwiseXorOutlet\";\nimport {BitwiseAndOutlet} from \"./operator/BitwiseAndOutlet\";\nimport {LtOutlet} from \"./operator/LtOutlet\";\nimport {LeOutlet} from \"./operator/LeOutlet\";\nimport {EqOutlet} from \"./operator/EqOutlet\";\nimport {NeOutlet} from \"./operator/NeOutlet\";\nimport {GeOutlet} from \"./operator/GeOutlet\";\nimport {GtOutlet} from \"./operator/GtOutlet\";\nimport {PlusOutlet} from \"./operator/PlusOutlet\";\nimport {MinusOutlet} from \"./operator/MinusOutlet\";\nimport {TimesOutlet} from \"./operator/TimesOutlet\";\nimport {DivideOutlet} from \"./operator/DivideOutlet\";\nimport {ModuloOutlet} from \"./operator/ModuloOutlet\";\nimport {NotOutlet} from \"./operator/NotOutlet\";\nimport {BitwiseNotOutlet} from \"./operator/BitwiseNotOutlet\";\nimport {NegativeOutlet} from \"./operator/NegativeOutlet\";\nimport {PositiveOutlet} from \"./operator/PositiveOutlet\";\nimport {InvokeOutlet} from \"./operator/InvokeOutlet\";\n\n/** @public */\nexport const Dataflow = (function () {\n  const Dataflow = {} as {\n    /**\n     * Returns an `Outlet` that evaluates the given `expr` in the context of the\n     * given `scope`, and updates whenever any dependent expression updates.\n     */\n    compile(expr: Value, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileSelector(selector: Selector, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileIdentitySelector(scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileGetSelector(selector: GetSelector, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileGetAttrSelector(selector: GetAttrSelector, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileGetItemSelector(selector: GetItemSelector, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileKeysSelector(scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileValuesSelector(scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileChildrenSelector(scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileDescendantsSelector(scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileFilterSelector(selector: FilterSelector, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileOperator(operator: Operator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileConditionalOperator(operator: ConditionalOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileBinaryOperator(operator: BinaryOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileBinaryOutlet(operator: BinaryOperator, outlet: BinaryOutlet, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileOrOperator(operator: OrOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileAndOperator(operator: AndOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileBitwiseOrOperator(operator: BitwiseOrOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileBitwiseXorOperator(operator: BitwiseXorOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileBitwiseAndOperator(operator: BitwiseAndOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileLtOperator(operator: LtOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileLeOperator(operator: LeOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileEqOperator(operator: EqOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileNeOperator(operator: NeOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileGeOperator(operator: GeOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileGtOperator(operator: GtOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compilePlusOperator(operator: PlusOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileMinusOperator(operator: MinusOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileTimesOperator(operator: TimesOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileDivideOperator(operator: DivideOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileModuloOperator(operator: ModuloOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileUnaryOperator(operator: UnaryOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileUnaryOutlet(operator: UnaryOperator, outlet: UnaryOutlet, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileNotOperator(operator: NotOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileBitwiseNotOperator(operator: BitwiseNotOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileNegativeOperator(operator: NegativeOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compilePositiveOperator(operator: PositiveOperator, scope: Outlet<Value>): Outlet<Value>;\n\n    /** @internal */\n    compileInvokeOperator(operator: InvokeOperator, scope: Outlet<Value>): Outlet<Value>;\n  };\n\n  Dataflow.compile = function (expr: Value, scope: Outlet<Value>): Outlet<Value> {\n    if (scope instanceof KeyOutlet) {\n      const value = scope.get();\n      if (Outlet.is<Value>(value)) {\n        scope = value;\n      }\n    }\n    if (expr.isConstant()) {\n      return new ValueInput<Value>(expr);\n    } else if (expr instanceof Selector) {\n      return Dataflow.compileSelector(expr, scope);\n    } else if (expr instanceof Operator) {\n      return Dataflow.compileOperator(expr, scope);\n    }\n    throw new TypeError(\"\" + expr);\n  };\n\n  Dataflow.compileSelector = function (selector: Selector, scope: Outlet<Value>): Outlet<Value> {\n    if (selector instanceof IdentitySelector) {\n      return Dataflow.compileIdentitySelector(scope);\n    } else if (selector instanceof GetSelector) {\n      return Dataflow.compileGetSelector(selector, scope);\n    } else if (selector instanceof GetAttrSelector) {\n      return Dataflow.compileGetAttrSelector(selector, scope);\n    } else if (selector instanceof GetItemSelector) {\n      return Dataflow.compileGetItemSelector(selector, scope);\n    } else if (selector instanceof KeysSelector) {\n      return Dataflow.compileKeysSelector(scope);\n    } else if (selector instanceof ValuesSelector) {\n      return Dataflow.compileValuesSelector(scope);\n    } else if (selector instanceof ChildrenSelector) {\n      return Dataflow.compileChildrenSelector(scope);\n    } else if (selector instanceof DescendantsSelector) {\n      return Dataflow.compileDescendantsSelector(scope);\n    } else if (selector instanceof FilterSelector) {\n      return Dataflow.compileFilterSelector(selector, scope);\n    }\n    throw new TypeError(\"\" + selector);\n  };\n\n  Dataflow.compileIdentitySelector = function (scope: Outlet<Value>): Outlet<Value> {\n    return scope;\n  };\n\n  Dataflow.compileGetSelector = function (selector: GetSelector, scope: Outlet<Value>): Outlet<Value> {\n    const key = selector.item;\n    if (key.isConstant()) {\n      if (RecordOutlet.is(scope)) {\n        const outlet = scope.outlet(key);\n        if (outlet !== null) {\n          return Dataflow.compile(selector.then, outlet);\n        }\n      } else if (StreamletScope.is<Value>(scope)) {\n        const name = key.stringValue(void 0);\n        if (name !== void 0) {\n          const outlet = scope.outlet(name);\n          if (outlet !== null) {\n            return Dataflow.compile(selector.then, outlet);\n          }\n        }\n      }\n    } else {\n      const getOutlet = new GetOutlet();\n      const outlet = Dataflow.compile(key, scope);\n      getOutlet.keyInlet.bindInput(outlet);\n      getOutlet.mapInlet.bindInput(scope as MapOutlet<Value, Value, unknown>);\n      return getOutlet;\n    }\n    return null as unknown as Outlet<Value>;\n  };\n\n  Dataflow.compileGetAttrSelector = function (selector: GetAttrSelector, scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileGetItemSelector = function (selector: GetItemSelector, scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileKeysSelector = function (scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileValuesSelector = function (scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileChildrenSelector = function (scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileDescendantsSelector = function (scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileFilterSelector = function (selector: FilterSelector, scope: Outlet<Value>): Outlet<Value> {\n    throw new Error(); // TODO\n  };\n\n  Dataflow.compileOperator = function (operator: Operator, scope: Outlet<Value>): Outlet<Value> {\n    if (operator instanceof ConditionalOperator) {\n      return Dataflow.compileConditionalOperator(operator, scope);\n    } else if (operator instanceof BinaryOperator) {\n      return Dataflow.compileBinaryOperator(operator, scope);\n    } else if (operator instanceof UnaryOperator) {\n      return Dataflow.compileUnaryOperator(operator, scope);\n    } else if (operator instanceof InvokeOperator) {\n      return Dataflow.compileInvokeOperator(operator, scope);\n    }\n    throw new TypeError(\"\" + operator);\n  };\n\n  Dataflow.compileConditionalOperator = function (operator: ConditionalOperator, scope: Outlet<Value>): Outlet<Value> {\n    const outlet = new ConditionalOutlet();\n    const ifTerm = operator.ifTerm.toValue();\n    const thenTerm = operator.thenTerm.toValue();\n    const elseTerm = operator.elseTerm.toValue();\n    const ifOutlet = Dataflow.compile(ifTerm, scope);\n    const thenOutlet = Dataflow.compile(thenTerm, scope);\n    const elseOutlet = Dataflow.compile(elseTerm, scope);\n    outlet.ifInlet.bindInput(ifOutlet);\n    outlet.thenInlet.bindInput(thenOutlet);\n    outlet.elseInlet.bindInput(elseOutlet);\n    return outlet;\n  };\n\n  Dataflow.compileBinaryOperator = function (operator: BinaryOperator, scope: Outlet<Value>): Outlet<Value> {\n    if (operator instanceof OrOperator) {\n      return Dataflow.compileOrOperator(operator, scope);\n    } else if (operator instanceof AndOperator) {\n      return Dataflow.compileAndOperator(operator, scope);\n    } else if (operator instanceof BitwiseOrOperator) {\n      return Dataflow.compileBitwiseOrOperator(operator, scope);\n    } else if (operator instanceof BitwiseXorOperator) {\n      return Dataflow.compileBitwiseXorOperator(operator, scope);\n    } else if (operator instanceof BitwiseAndOperator) {\n      return Dataflow.compileBitwiseAndOperator(operator, scope);\n    } else if (operator instanceof LtOperator) {\n      return Dataflow.compileLtOperator(operator, scope);\n    } else if (operator instanceof LeOperator) {\n      return Dataflow.compileLeOperator(operator, scope);\n    } else if (operator instanceof EqOperator) {\n      return Dataflow.compileEqOperator(operator, scope);\n    } else if (operator instanceof NeOperator) {\n      return Dataflow.compileNeOperator(operator, scope);\n    } else if (operator instanceof GeOperator) {\n      return Dataflow.compileGeOperator(operator, scope);\n    } else if (operator instanceof GtOperator) {\n      return Dataflow.compileGtOperator(operator, scope);\n    } else if (operator instanceof PlusOperator) {\n      return Dataflow.compilePlusOperator(operator, scope);\n    } else if (operator instanceof MinusOperator) {\n      return Dataflow.compileMinusOperator(operator, scope);\n    } else if (operator instanceof TimesOperator) {\n      return Dataflow.compileTimesOperator(operator, scope);\n    } else if (operator instanceof DivideOperator) {\n      return Dataflow.compileDivideOperator(operator, scope);\n    } else if (operator instanceof ModuloOperator) {\n      return Dataflow.compileModuloOperator(operator, scope);\n    }\n    throw new TypeError(\"\" + operator);\n  };\n\n  Dataflow.compileBinaryOutlet = function (operator: BinaryOperator, outlet: BinaryOutlet, scope: Outlet<Value>): Outlet<Value> {\n    const operand1 = operator.operand1.toValue();\n    const operand2 = operator.operand2.toValue();\n    const operand1Outlet = Dataflow.compile(operand1, scope);\n    const operand2Outlet = Dataflow.compile(operand2, scope);\n    outlet.operand1Inlet.bindInput(operand1Outlet);\n    outlet.operand2Inlet.bindInput(operand2Outlet);\n    return outlet;\n  };\n\n  Dataflow.compileOrOperator = function (operator: OrOperator, scope: Outlet<Value>): Outlet<Value> {\n    const outlet = new OrOutlet();\n    const operand1 = operator.operand1.toValue();\n    const operand2 = operator.operand2.toValue();\n    const operand1Outlet = Dataflow.compile(operand1, scope);\n    const operand2Outlet = Dataflow.compile(operand2, scope);\n    outlet.operand1Inlet.bindInput(operand1Outlet);\n    outlet.operand2Inlet.bindInput(operand2Outlet);\n    return outlet;\n  };\n\n  Dataflow.compileAndOperator = function (operator: AndOperator, scope: Outlet<Value>): Outlet<Value> {\n    const outlet = new AndOutlet();\n    const operand1 = operator.operand1.toValue();\n    const operand2 = operator.operand2.toValue();\n    const operand1Outlet = Dataflow.compile(operand1, scope);\n    const operand2Outlet = Dataflow.compile(operand2, scope);\n    outlet.operand1Inlet.bindInput(operand1Outlet);\n    outlet.operand2Inlet.bindInput(operand2Outlet);\n    return outlet;\n  };\n\n  Dataflow.compileBitwiseOrOperator = function (operator: BitwiseOrOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new BitwiseOrOutlet(), scope);\n  };\n\n  Dataflow.compileBitwiseXorOperator = function (operator: BitwiseXorOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new BitwiseXorOutlet(), scope);\n  };\n\n  Dataflow.compileBitwiseAndOperator = function (operator: BitwiseAndOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new BitwiseAndOutlet(), scope);\n  };\n\n  Dataflow.compileLtOperator = function (operator: LtOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new LtOutlet(), scope);\n  };\n\n  Dataflow.compileLeOperator = function (operator: LeOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new LeOutlet(), scope);\n  };\n\n  Dataflow.compileEqOperator = function (operator: EqOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new EqOutlet(), scope);\n  };\n\n  Dataflow.compileNeOperator = function (operator: NeOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new NeOutlet(), scope);\n  };\n\n  Dataflow.compileGeOperator = function (operator: GeOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new GeOutlet(), scope);\n  };\n\n  Dataflow.compileGtOperator = function (operator: GtOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new GtOutlet(), scope);\n  };\n\n  Dataflow.compilePlusOperator = function (operator: PlusOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new PlusOutlet(), scope);\n  };\n\n  Dataflow.compileMinusOperator = function (operator: MinusOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new MinusOutlet(), scope);\n  };\n\n  Dataflow.compileTimesOperator = function (operator: TimesOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new TimesOutlet(), scope);\n  };\n\n  Dataflow.compileDivideOperator = function (operator: DivideOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new DivideOutlet(), scope);\n  };\n\n  Dataflow.compileModuloOperator = function (operator: ModuloOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileBinaryOutlet(operator, new ModuloOutlet(), scope);\n  };\n\n  Dataflow.compileUnaryOperator = function (operator: UnaryOperator, scope: Outlet<Value>): Outlet<Value> {\n    if (operator instanceof NotOperator) {\n      return Dataflow.compileNotOperator(operator, scope);\n    } else if (operator instanceof BitwiseNotOperator) {\n      return Dataflow.compileBitwiseNotOperator(operator, scope);\n    } else if (operator instanceof NegativeOperator) {\n      return Dataflow.compileNegativeOperator(operator, scope);\n    } else if (operator instanceof PositiveOperator) {\n      return Dataflow.compilePositiveOperator(operator, scope);\n    }\n    throw new TypeError(\"\" + operator);\n  };\n\n  Dataflow.compileUnaryOutlet = function (operator: UnaryOperator, outlet: UnaryOutlet, scope: Outlet<Value>): Outlet<Value> {\n    const operand = operator.operand.toValue();\n    const operandOutlet = Dataflow.compile(operand, scope);\n    outlet.operandInlet.bindInput(operandOutlet);\n    return outlet;\n  };\n\n  Dataflow.compileNotOperator = function (operator: NotOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileUnaryOutlet(operator, new NotOutlet(), scope);\n  };\n\n  Dataflow.compileBitwiseNotOperator = function (operator: BitwiseNotOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileUnaryOutlet(operator, new BitwiseNotOutlet(), scope);\n  };\n\n  Dataflow.compileNegativeOperator = function (operator: NegativeOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileUnaryOutlet(operator, new NegativeOutlet(), scope);\n  };\n\n  Dataflow.compilePositiveOperator = function (operator: PositiveOperator, scope: Outlet<Value>): Outlet<Value> {\n    return Dataflow.compileUnaryOutlet(operator, new PositiveOutlet(), scope);\n  };\n\n  Dataflow.compileInvokeOperator = function (operator: InvokeOperator, scope: Outlet<Value>): Outlet<Value> {\n    const func = operator.func;\n    const args = operator.args;\n    const invokeOutlet = new InvokeOutlet(scope as unknown as Record);\n    const funcOutlet = Dataflow.compile(func, scope);\n    const argsOutlet = Dataflow.compile(args, scope);\n    invokeOutlet.funcInlet.bindInput(funcOutlet);\n    invokeOutlet.argsInlet.bindInput(argsOutlet);\n    return invokeOutlet;\n  };\n\n  return Dataflow;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, Parser, Writer, Unicode, Utf8} from \"@swim/codec\";\nimport {Item, Value, Data} from \"@swim/structure\";\nimport type {ReconParser} from \"./parser/ReconParser\";\nimport {ReconStructureParser} from \"./\"; // forward import\nimport type {ReconWriter} from \"./writer/ReconWriter\";\nimport {ReconStructureWriter} from \"./\"; // forward import\n\n/**\n * Factory for constructing Recon parsers and writers.\n * @public\n */\nexport const Recon = (function () {\n  const Recon = {} as {\n    structureParser(): ReconParser<Item, Value>;\n\n    structureWriter(): ReconWriter<Item, Value>;\n\n    parse(recon: string): Value;\n\n    parser(): Parser<Value>;\n\n    sizeOf(item: Item): number;\n\n    sizeOfBlock(item: Item): number;\n\n    write(output: Output, item: Item): Writer;\n\n    writeBlock(output: Output, item: Item): Writer;\n\n    toString(item: Item): string;\n\n    toBlockString(item: Item): string;\n\n    toData(item: Item): Data;\n\n    toBlockData(item: Item): Data;\n\n    /** @internal */\n    isSpace(c: number): boolean;\n\n    /** @internal */\n    isNewline(c: number): boolean;\n\n    /** @internal */\n    isWhitespace(c: number): boolean;\n\n    /** @internal */\n    isIdentStartChar(c: number): boolean;\n\n    /** @internal */\n    isIdentChar(c: number): boolean;\n  };\n\n  Object.defineProperty(Recon, \"structureParser\", {\n    value: function (): ReconStructureParser {\n      const structureParser = new ReconStructureParser();\n      Object.defineProperty(Recon, \"structureParser\", {\n        value: function (): ReconStructureParser {\n          return structureParser;\n        },\n        enumerable: true,\n        configurable: true,\n      });\n      return structureParser;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Object.defineProperty(Recon, \"structureWriter\", {\n    value: function (): ReconStructureWriter {\n      const structureWriter = new ReconStructureWriter();\n      Object.defineProperty(Recon, \"structureWriter\", {\n        value: function (): ReconStructureWriter {\n          return structureWriter;\n        },\n        enumerable: true,\n        configurable: true,\n      });\n      return structureWriter;\n    },\n    enumerable: true,\n    configurable: true,\n  });\n\n  Recon.parse = function (recon: string): Value {\n    return Recon.structureParser().parseBlockString(recon);\n  };\n\n  Recon.parser = function (): Parser<Value> {\n    return Recon.structureParser().blockParser();\n  };\n\n  Recon.sizeOf = function (item: Item): number {\n    return Recon.structureWriter().sizeOfItem(item);\n  };\n\n  Recon.sizeOfBlock = function (item: Item): number {\n    return Recon.structureWriter().sizeOfBlockItem(item);\n  };\n\n  Recon.write = function (output: Output, item: Item): Writer {\n    return Recon.structureWriter().writeItem(output, item);\n  };\n\n  Recon.writeBlock = function (output: Output, item: Item): Writer {\n    return Recon.structureWriter().writeBlockItem(output, item);\n  };\n\n  Recon.toString = function (item: Item): string {\n    let output = Unicode.stringOutput();\n    const writer = Recon.write(output, item);\n    if (!writer.isDone()) {\n      output = Output.error(writer.trap());\n    }\n    return output.bind();\n  };\n\n  Recon.toBlockString = function (item: Item): string {\n    let output = Unicode.stringOutput();\n    const writer = Recon.writeBlock(output, item);\n    if (!writer.isDone()) {\n      output = Output.error(writer.trap());\n    }\n    return output.bind();\n  };\n\n  Recon.toData = function (item: Item): Data {\n    let output = Utf8.encodedOutput(Data.output());\n    const writer = Recon.write(output, item);\n    if (!writer.isDone()) {\n      output = Output.error(writer.trap());\n    }\n    return output.bind();\n  };\n\n  Recon.toBlockData = function (item: Item): Data {\n    let output = Utf8.encodedOutput(Data.output());\n    const writer = Recon.writeBlock(output, item);\n    if (!writer.isDone()) {\n      output = Output.error(writer.trap());\n    }\n    return output.bind();\n  };\n\n  Recon.isSpace = function (c: number): boolean {\n    return c === 0x20 || c === 0x9;\n  };\n\n  Recon.isNewline = function (c: number): boolean {\n    return c === 0xa || c === 0xd;\n  };\n\n  Recon.isWhitespace = function (c: number): boolean {\n    return Recon.isSpace(c) || Recon.isNewline(c);\n  };\n\n  Recon.isIdentStartChar = function (c: number): boolean {\n    return c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c === 95/*'_'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c >= 0xc0 && c <= 0xd6\n        || c >= 0xd8 && c <= 0xf6\n        || c >= 0xf8 && c <= 0x2ff\n        || c >= 0x370 && c <= 0x37d\n        || c >= 0x37f && c <= 0x1fff\n        || c >= 0x200c && c <= 0x200d\n        || c >= 0x2070 && c <= 0x218f\n        || c >= 0x2c00 && c <= 0x2fef\n        || c >= 0x3001 && c <= 0xd7ff\n        || c >= 0xf900 && c <= 0xfdcf\n        || c >= 0xfdf0 && c <= 0xfffd\n        || c >= 0x10000 && c <= 0xeffff;\n  };\n\n  Recon.isIdentChar = function (c: number): boolean {\n    return c === 45/*'-'*/\n        || c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c === 95/*'_'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c === 0xb7\n        || c >= 0xc0 && c <= 0xd6\n        || c >= 0xd8 && c <= 0xf6\n        || c >= 0xf8 && c <= 0x37d\n        || c >= 0x37f && c <= 0x1fff\n        || c >= 0x200c && c <= 0x200d\n        || c >= 0x203f && c <= 0x2040\n        || c >= 0x2070 && c <= 0x218f\n        || c >= 0x2c00 && c <= 0x2fef\n        || c >= 0x3001 && c <= 0xd7ff\n        || c >= 0xf900 && c <= 0xfdcf\n        || c >= 0xfdf0 && c <= 0xfffd\n        || c >= 0x10000 && c <= 0xeffff;\n  };\n\n  Item.prototype.toRecon = function (this: Item): string {\n    return Recon.toString(this);\n  };\n\n  Item.prototype.toReconBlock = function (this: Item): string {\n    return Recon.toBlockString(this);\n  };\n\n  return Recon;\n})();\n\nValue.parseRecon = function (recon: string): Value {\n  return Recon.parse(recon);\n};\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class BlockParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly keyParser: Parser<V> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, keyParser?: Parser<V>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.keyParser = keyParser;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return BlockParser.parse(input, this.recon, this.builder, this.keyParser,\n                             this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     keyParser?: Parser<V>, valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    block: do {\n      if (step === 1) {\n        while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 33/*'!'*/ || c === 34/*'\"'*/ || c === 36/*'$'*/ || c === 37/*'%'*/\n              || c === 39/*'\\''*/ || c === 40/*'('*/ || c === 43/*'+'*/ || c === 45/*'-'*/\n              || c >= 48/*'0'*/ && c <= 57/*'9'*/ || c === 64/*'@'*/\n              || c === 91/*'['*/ || c === 96/*'`'*/ || c === 123/*'{'*/ || c === 126/*'~'*/\n              || Recon.isIdentStartChar(c)) {\n            builder = builder || recon.valueBuilder();\n            step = 2;\n          } else if (c === 35/*'#'*/) {\n            input = input.step();\n            step = 7;\n          } else {\n            if (builder !== void 0) {\n              return Parser.done(builder.bind());\n            } else {\n              return Parser.done(recon.absent());\n            }\n          }\n        } else if (input.isDone()) {\n          if (builder !== void 0) {\n            return Parser.done(builder.bind());\n          } else {\n            return Parser.done(recon.absent());\n          }\n        }\n      }\n      if (step === 2) {\n        if (keyParser === void 0) {\n          keyParser = recon.parseBlockExpression(input);\n        }\n        while (keyParser.isCont() && !input.isEmpty()) {\n          keyParser = keyParser.feed(input);\n        }\n        if (keyParser.isDone()) {\n          step = 3;\n        } else if (keyParser.isError()) {\n          return keyParser;\n        }\n      }\n      if (step === 3) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 58/*':'*/) {\n            input = input.step();\n            step = 4;\n          } else {\n            builder!.push(recon.item(keyParser!.bind()));\n            keyParser = void 0;\n            step = 6;\n          }\n        } else if (input.isDone()) {\n          builder!.push(recon.item(keyParser!.bind()));\n          return Parser.done(builder!.bind());\n        }\n      }\n      if (step === 4) {\n        while (input.isCont() && Recon.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          step = 5;\n        } else if (input.isDone()) {\n          builder!.push(recon.slot(keyParser!.bind()));\n          return Parser.done(builder!.bind());\n        }\n      }\n      if (step === 5) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseBlockExpression(input);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          builder!.push(recon.slot(keyParser!.bind(), valueParser.bind()));\n          keyParser = void 0;\n          valueParser = void 0;\n          step = 6;\n        } else if (valueParser.isError()) {\n          return valueParser;\n        }\n      }\n      if (step === 6) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 44/*','*/ || c === 59/*';'*/ || Recon.isNewline(c)) {\n            input = input.step();\n            step = 1;\n            continue;\n          } else if (c === 35/*'#'*/) {\n            input = input.step();\n            step = 7;\n          } else {\n            return Parser.done(builder!.bind());\n          }\n        } else if (input.isDone()) {\n          return Parser.done(builder!.bind());\n        }\n      }\n      if (step === 7) {\n        while (input.isCont()) {\n          c = input.head();\n          if (!Recon.isNewline(c)) {\n            input = input.step();\n          } else {\n            step = 1;\n            continue block;\n          }\n        }\n        if (input.isDone()) {\n          step = 1;\n          continue;\n        }\n      }\n      break;\n    } while (true);\n    return new BlockParser<I, V>(recon, builder, keyParser, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class AttrParser<I, V> extends Parser<I> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly keyParser: Parser<V> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, keyParser?: Parser<V>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.keyParser = keyParser;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<I> {\n    return AttrParser.parse(input, this.recon, this.keyParser,\n                            this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, keyParser?: Parser<V>,\n                     valueParser?: Parser<V>, step: number = 1): Parser<I> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 64/*'@'*/) {\n          input = input.step();\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(64/*'@'*/, input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(64/*'@'*/, input));\n      }\n    }\n    if (step === 2) {\n      if (keyParser === void 0) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 34/*'\"'*/ || c === 39/*'\\''*/) {\n            keyParser = recon.parseString(input);\n          } else if (Recon.isIdentStartChar(c)) {\n            keyParser = recon.parseIdent(input);\n          } else {\n            return Parser.error(Diagnostic.expected(\"attribute name\", input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(\"attribute name\", input));\n        }\n      } else {\n        keyParser = keyParser.feed(input);\n      }\n      if (keyParser !== void 0) {\n        if (keyParser.isDone()) {\n          step = 3;\n        } else if (keyParser.isError()) {\n          return keyParser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      if (input.isCont() && input.head() === 40/*'('*/) {\n        input = input.step();\n        step = 4;\n      } else if (!input.isEmpty()) {\n        return Parser.done(recon.attr(keyParser!.bind()));\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 41/*')'*/) {\n          input = input.step();\n          return Parser.done(recon.attr(keyParser!.bind()));\n        } else {\n          step = 5;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    if (step === 5) {\n      if (valueParser === void 0) {\n        valueParser = recon.parseBlock(input);\n      }\n      while (valueParser.isCont() && !input.isEmpty()) {\n        valueParser = valueParser.feed(input);\n      }\n      if (valueParser.isDone()) {\n        step = 6;\n      } else if (valueParser.isError()) {\n        return valueParser.asError();\n      }\n    }\n    if (step === 6) {\n      while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 41/*')'*/) {\n          input = input.step();\n          return Parser.done(recon.attr(keyParser!.bind(), valueParser!.bind()));\n        } else {\n          return Parser.error(Diagnostic.expected(\")\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new AttrParser<I, V>(recon, keyParser, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class BlockItemParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly fieldParser: Parser<I> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, fieldParser?: Parser<I>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.fieldParser = fieldParser;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return BlockItemParser.parse(input, this.recon, this.builder, this.fieldParser,\n                                 this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     fieldParser?: Parser<I>, valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 64/*'@'*/) {\n            fieldParser = recon.parseAttr(input);\n            step = 2;\n          } else if (c === 123/*'{'*/) {\n            builder = builder || recon.recordBuilder();\n            valueParser = recon.parseRecord(input, builder);\n            step = 5;\n          } else if (c === 91/*'['*/) {\n            builder = builder || recon.recordBuilder();\n            valueParser = recon.parseMarkup(input, builder);\n            step = 5;\n          } else if (Recon.isIdentStartChar(c)) {\n            valueParser = recon.parseIdent(input);\n            step = 4;\n          } else if (c === 34/*'\"'*/ || c === 39/*'\\''*/) {\n            valueParser = recon.parseString(input);\n            step = 4;\n          } else if (c === 96/*'`'*/) {\n            valueParser = recon.parseRawString(input);\n            step = 4;\n          } else if (c === 45/*'-'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n            valueParser = recon.parseNumber(input);\n            step = 4;\n          } else if (c === 37/*'%'*/) {\n            valueParser = recon.parseData(input);\n            step = 4;\n          } else if (c === 36/*'$'*/) {\n            valueParser = recon.parseSelector(input);\n            step = 4;\n          } else if (builder === void 0) {\n            return Parser.done(recon.extant());\n          } else {\n            return Parser.done(builder.bind());\n          }\n        } else if (input.isDone()) {\n          if (builder === void 0) {\n            return Parser.done(recon.extant());\n          } else {\n            return Parser.done(builder.bind());\n          }\n        }\n      }\n      if (step === 2) {\n        while (fieldParser!.isCont() && !input.isEmpty()) {\n          fieldParser = fieldParser!.feed(input);\n        }\n        if (fieldParser!.isDone()) {\n          builder = builder || recon.valueBuilder();\n          builder.push(fieldParser!.bind());\n          fieldParser = void 0;\n          step = 3;\n        } else if (fieldParser!.isError()) {\n          return fieldParser!.asError();\n        }\n      }\n      if (step === 3) {\n        while (input.isCont() && Recon.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          step = 1;\n          continue;\n        } else if (input.isDone()) {\n          return Parser.done(builder!.bind());\n        }\n      }\n      if (step === 4) {\n        while (valueParser!.isCont() && !input.isEmpty()) {\n          valueParser = valueParser!.feed(input);\n        }\n        if (valueParser!.isDone()) {\n          builder = builder || recon.valueBuilder();\n          builder.push(recon.item(valueParser!.bind()));\n          valueParser = void 0;\n          step = 6;\n        } else if (valueParser!.isError()) {\n          return valueParser!;\n        }\n      }\n      if (step === 5) {\n        while (valueParser!.isCont() && !input.isEmpty()) {\n          valueParser = valueParser!.feed(input);\n        }\n        if (valueParser!.isDone()) {\n          valueParser = void 0;\n          step = 6;\n        } else if (valueParser!.isError()) {\n          return valueParser!;\n        }\n      }\n      if (step === 6) {\n        while (input.isCont() && Recon.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (input.head() === 64/*'@'*/) {\n            step = 1;\n          } else {\n            return Parser.done(builder!.bind());\n          }\n        } else if (input.isDone()) {\n          return Parser.done(builder!.bind());\n        }\n      }\n      break;\n    } while (true);\n    return new BlockItemParser<I, V>(recon, builder, fieldParser, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class InlineItemParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly fieldParser: Parser<I> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, fieldParser?: Parser<I>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.fieldParser = fieldParser;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return InlineItemParser.parse(input, this.recon, this.builder, this.fieldParser,\n                                  this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     fieldParser?: Parser<I>,  valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 64/*'@'*/) {\n          fieldParser = recon.parseAttr(input);\n          step = 2;\n        } else if (c === 123/*'{'*/) {\n          if (builder !== void 0) {\n            valueParser = recon.parseRecord(input, builder);\n            step = 5;\n          } else {\n            valueParser = recon.parseRecord(input);\n            step = 4;\n          }\n        } else if (c === 91/*'['*/) {\n          if (builder !== void 0) {\n            valueParser = recon.parseMarkup(input, builder);\n            step = 5;\n          } else {\n            valueParser = recon.parseMarkup(input);\n            step = 4;\n          }\n        } else if (builder === void 0) {\n          return Parser.done(recon.extant());\n        } else {\n          return Parser.done(builder.bind());\n        }\n      } else if (input.isDone()) {\n        if (builder === void 0) {\n          return Parser.done(recon.extant());\n        } else {\n          return Parser.done(builder.bind());\n        }\n      }\n    }\n    if (step === 2) {\n      while (fieldParser!.isCont() && !input.isEmpty()) {\n        fieldParser = fieldParser!.feed(input);\n      }\n      if (fieldParser!.isDone()) {\n        builder = builder || recon.valueBuilder();\n        builder.push(fieldParser!.bind());\n        fieldParser = void 0;\n        step = 3;\n      } else if (fieldParser!.isError()) {\n        return fieldParser!.asError();\n      }\n    }\n    if (step === 3) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 123/*'{'*/) {\n          valueParser = recon.parseRecord(input, builder);\n          step = 5;\n        } else if (c === 91/*'['*/) {\n          valueParser = recon.parseMarkup(input, builder);\n          step = 5;\n        } else {\n          return Parser.done(builder!.bind());\n        }\n      } else if (input.isDone()) {\n        return Parser.done(builder!.bind());\n      }\n    }\n    if (step === 4) {\n      while (valueParser!.isCont() && !input.isEmpty()) {\n        valueParser = valueParser!.feed(input);\n      }\n      if (valueParser!.isDone()) {\n        builder = builder || recon.valueBuilder();\n        builder.push(recon.item(valueParser!.bind()));\n        return Parser.done(builder.bind());\n      } else if (valueParser!.isError()) {\n        return valueParser!;\n      }\n    }\n    if (step === 5) {\n      while (valueParser!.isCont() && !input.isEmpty()) {\n        valueParser = valueParser!.feed(input);\n      }\n      if (valueParser!.isDone()) {\n        return Parser.done(builder!.bind());\n      } else if (valueParser!.isError()) {\n        return valueParser!;\n      }\n    }\n    return new InlineItemParser<I, V>(recon, builder, fieldParser, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class RecordParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly keyParser: Parser<V> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, keyParser?: Parser<V>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.keyParser = keyParser;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return RecordParser.parse(input, this.recon, this.builder, this.keyParser,\n                              this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     keyParser?: Parser<V>, valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 123/*'{'*/) {\n          input = input.step();\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(123/*'{'*/, input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(123/*'{'*/, input));\n      }\n    }\n    block: do {\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          builder = builder || recon.recordBuilder();\n          if (c === 125/*'}'*/) {\n            input = input.step();\n            return Parser.done(builder.bind());\n          } else if (c === 35/*'#'*/) {\n            input = input.step();\n            step = 8;\n          } else {\n            step = 3;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(125/*'}'*/, input));\n        }\n      }\n      if (step === 3) {\n        if (keyParser === void 0) {\n          keyParser = recon.parseBlockExpression(input);\n        }\n        while (keyParser.isCont() && !input.isEmpty()) {\n          keyParser = keyParser.feed(input);\n        }\n        if (keyParser.isDone()) {\n          step = 4;\n        } else if (keyParser.isError()) {\n          return keyParser;\n        }\n      }\n      if (step === 4) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 58/*':'*/) {\n            input = input.step();\n            step = 5;\n          } else {\n            builder!.push(recon.item(keyParser!.bind()));\n            keyParser = void 0;\n            step = 7;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(125/*'}'*/, input));\n        }\n      }\n      if (step === 5) {\n        while (input.isCont() && Recon.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          step = 6;\n        } else if (input.isDone()) {\n          builder!.push(recon.slot(keyParser!.bind()));\n          return Parser.done(builder!.bind());\n        }\n      }\n      if (step === 6) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseBlockExpression(input);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          builder!.push(recon.slot(keyParser!.bind(), valueParser.bind()));\n          keyParser = void 0;\n          valueParser = void 0;\n          step = 7;\n        } else if (valueParser.isError()) {\n          return valueParser;\n        }\n      }\n      if (step === 7) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 44/*','*/ || c === 59/*';'*/ || Recon.isNewline(c)) {\n            input = input.step();\n            step = 2;\n            continue;\n          } else if (c === 35/*'#'*/) {\n            input = input.step();\n            step = 8;\n          } else if (c === 125/*'}'*/) {\n            input = input.step();\n            return Parser.done(builder!.bind());\n          } else {\n            return Parser.error(Diagnostic.expected(\"'}', ';', ',', or newline\", input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(125/*'}'*/, input));\n        }\n      }\n      if (step === 8) {\n        while (input.isCont()) {\n          c = input.head();\n          if (!Recon.isNewline(c)) {\n            input = input.step();\n          } else {\n            step = 2;\n            continue block;\n          }\n        }\n        if (input.isDone()) {\n          step = 2;\n          continue;\n        }\n      }\n      break;\n    } while (true);\n    return new RecordParser<I, V>(recon, builder, keyParser, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class MarkupParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly textOutput: Output<V> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, textOutput?: Output<V>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.textOutput = textOutput;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return MarkupParser.parse(input, this.recon, this.builder, this.textOutput,\n                              this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     textOutput?: Output<V>, valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 91/*'['*/) {\n          input = input.step();\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(91/*'['*/, input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(91/*'['*/, input));\n      }\n    }\n    do {\n      if (step === 2) {\n        while (input.isCont()) {\n          c = input.head();\n          if (c !== 64/*'@'*/ && c !== 91/*'['*/ && c !== 92/*'\\\\'*/ && c !== 93/*']'*/\n              && c !== 123/*'{'*/ && c !== 125/*'}'*/) {\n            input = input.step();\n            textOutput = textOutput || recon.textOutput();\n            textOutput.write(c);\n          } else {\n            break;\n          }\n        }\n        if (input.isCont()) {\n          if (c === 93/*']'*/) {\n            input = input.step();\n            builder = builder || recon.recordBuilder();\n            if (textOutput !== void 0) {\n              builder.push(recon.item(textOutput.bind()));\n            }\n            return Parser.done(builder.bind());\n          } else if (c === 64/*'@'*/) {\n            builder = builder || recon.recordBuilder();\n            if (textOutput !== void 0) {\n              builder.push(recon.item(textOutput.bind()));\n              textOutput = void 0;\n            }\n            valueParser = recon.parseInlineItem(input);\n            step = 3;\n          } else if (c === 123/*'{'*/) {\n            builder = builder || recon.recordBuilder();\n            if (textOutput !== void 0) {\n              builder.push(recon.item(textOutput.bind()));\n              textOutput = void 0;\n            }\n            valueParser = recon.parseRecord(input, builder);\n            step = 4;\n          } else if (c === 91/*'['*/) {\n            builder = builder || recon.recordBuilder();\n            if (textOutput !== void 0) {\n              builder.push(recon.item(textOutput.bind()));\n              textOutput = void 0;\n            }\n            valueParser = recon.parseMarkup(input, builder);\n            step = 4;\n          } else if (c === 92/*'\\\\'*/) {\n            input = input.step();\n            step = 5;\n          } else {\n            return Parser.error(Diagnostic.unexpected(input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 3) {\n        while (valueParser!.isCont() && !input.isEmpty()) {\n          valueParser = valueParser!.feed(input);\n        }\n        if (valueParser!.isDone()) {\n          builder!.push(recon.item(valueParser!.bind()));\n          valueParser = void 0;\n          step = 2;\n          continue;\n        } else if (valueParser!.isError()) {\n          return valueParser!;\n        }\n      }\n      if (step === 4) {\n        while (valueParser!.isCont() && !input.isEmpty()) {\n          valueParser = valueParser!.feed(input);\n        }\n        if (valueParser!.isDone()) {\n          valueParser = void 0;\n          step = 2;\n          continue;\n        } else if (valueParser!.isError()) {\n          return valueParser!;\n        }\n      }\n      if (step === 5) {\n        if (input.isCont()) {\n          c = input.head();\n          textOutput = textOutput || recon.textOutput();\n          if (c === 34/*'\"'*/ || c === 36/*'$'*/ || c === 39/*'\\''*/ || c === 47/*'/'*/\n              || c === 64/*'@'*/ || c === 91/*'['*/ || c === 92/*'\\\\'*/ || c === 93/*']'*/\n              || c === 123/*'{'*/ || c === 125/*'}'*/) {\n            input = input.step();\n            textOutput.write(c);\n            step = 2;\n          } else if (c === 98/*'b'*/) {\n            input = input.step();\n            textOutput.write(8/*'\\b'*/);\n            step = 2;\n          } else if (c === 102/*'f'*/) {\n            input = input.step();\n            textOutput.write(12/*'\\f'*/);\n            step = 2;\n          } else if (c === 110/*'n'*/) {\n            input = input.step();\n            textOutput.write(10/*'\\n'*/);\n            step = 2;\n          } else if (c === 114/*'r'*/) {\n            input = input.step();\n            textOutput.write(13/*'\\r'*/);\n            step = 2;\n          } else if (c === 116/*'t'*/) {\n            input = input.step();\n            textOutput.write(9/*'\\t'*/);\n            step = 2;\n          } else {\n            return Parser.error(Diagnostic.expected(\"escape character\", input));\n          }\n          continue;\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(\"escape character\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new MarkupParser<I, V>(recon, builder, textOutput, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Base64} from \"@swim/codec\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class DataParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly base64Parser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, base64Parser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.base64Parser = base64Parser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return DataParser.parse(input, this.recon, this.base64Parser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>,\n                     base64Parser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 37/*'%'*/) {\n          input = input.step();\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(37/*'%'*/, input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(37/*'%'*/, input));\n      }\n    }\n    if (step === 2) {\n      if (base64Parser === void 0) {\n        base64Parser = Base64.standard().parse(input, recon.dataOutput());\n      }\n      while (base64Parser.isCont() && !input.isEmpty()) {\n        base64Parser = base64Parser.feed(input);\n      }\n      if (base64Parser.isDone()) {\n        return base64Parser;\n      } else if (base64Parser.isError()) {\n        return base64Parser;\n      }\n    }\n    return new DataParser<I, V>(recon, base64Parser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class IdentParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly output: Output<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, output?: Output<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.output = output;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return IdentParser.parse(input, this.recon, this.output, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, output?: Output<V>,\n                     step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (Recon.isIdentStartChar(c)) {\n          input = input.step();\n          output = output || recon.textOutput();\n          output = output.write(c);\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(\"identifier\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"identifier\", input));\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Recon.isIdentChar(c))) {\n        input = input.step();\n        output!.write(c);\n      }\n      if (!input.isEmpty()) {\n        return Parser.done(recon.ident(output!.bind()));\n      }\n    }\n    return new IdentParser<I, V>(recon, output, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Base16} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class StringParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly output: Output<V> | undefined;\n  private readonly quote: number | undefined;\n  private readonly code: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, output?: Output<V>, quote?: number,\n              code?: number, step?: number) {\n    super();\n    this.recon = recon;\n    this.output = output;\n    this.quote = quote;\n    this.code = code;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return StringParser.parse(input, this.recon, this.output, this.quote,\n                              this.code, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, output?: Output<V>,\n                     quote: number = 0, code: number = 0, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if ((c === 34/*'\"'*/ || c === 39/*'\\''*/) && (quote === c || quote === 0)) {\n          input = input.step();\n          output = output || recon.textOutput();\n          quote = c;\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(\"string\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"string\", input));\n      }\n    }\n    string: do {\n      if (step === 2) {\n        while (input.isCont()) {\n          c = input.head();\n          if (c >= 0x20 && c !== quote && c !== 92/*'\\\\'*/) {\n            input = input.step();\n            output = output!.write(c);\n          } else {\n            break;\n          }\n        }\n        if (input.isCont()) {\n          if (c === quote) {\n            input = input.step();\n            return Parser.done(output!.bind());\n          } else if (c === 92/*'\\\\'*/) {\n            input = input.step();\n            step = 3;\n          } else {\n            return Parser.error(Diagnostic.expected(quote, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(quote, input));\n        }\n      }\n      if (step === 3) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 34/*'\"'*/ || c === 36/*'$'*/ || c === 39/*'\\''*/ || c === 47/*'/'*/\n              || c === 64/*'@'*/ || c === 91/*'['*/ || c === 92/*'\\\\'*/ || c === 93/*']'*/\n              || c === 123/*'{'*/ || c === 125/*'}'*/) {\n            input = input.step();\n            output = output!.write(c);\n            step = 2;\n            continue;\n          } else if (c === 98/*'b'*/) {\n            input = input.step();\n            output = output!.write(8/*'\\b'*/);\n            step = 2;\n            continue;\n          } else if (c === 102/*'f'*/) {\n            input = input.step();\n            output = output!.write(12/*'\\f'*/);\n            step = 2;\n            continue;\n          } else if (c === 110/*'n'*/) {\n            input = input.step();\n            output = output!.write(10/*'\\n'*/);\n            step = 2;\n            continue;\n          } else if (c === 114/*'r'*/) {\n            input = input.step();\n            output = output!.write(13/*'\\r'*/);\n            step = 2;\n            continue;\n          } else if (c === 116/*'t'*/) {\n            input = input.step();\n            output = output!.write(9/*'\\t'*/);\n            step = 2;\n            continue;\n          } else if (c === 117/*'u'*/) {\n            input = input.step();\n            step = 4;\n          } else {\n            return Parser.error(Diagnostic.expected(\"escape character\", input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(\"escape character\", input));\n        }\n      }\n      if (step >= 4) {\n        do {\n          if (input.isCont()) {\n            c = input.head();\n            if (Base16.isDigit(c)) {\n              input = input.step();\n              code = 16 * code + Base16.decodeDigit(c);\n              if (step <= 6) {\n                step += 1;\n                continue;\n              } else {\n                output = output!.write(code);\n                code = 0;\n                step = 2;\n                continue string;\n              }\n            } else {\n              return Parser.error(Diagnostic.expected(\"hex digit\", input));\n            }\n          } else if (input.isDone()) {\n            return Parser.error(Diagnostic.expected(\"hex digit\", input));\n          }\n          break;\n        } while (true);\n      }\n      break;\n    } while (true);\n    return new StringParser<I, V>(recon, output, quote, code, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class RawStringParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly output: Output<V> | undefined;\n  private readonly count: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, output?: Output<V>, count?: number, step?: number) {\n    super();\n    this.recon = recon;\n    this.output = output;\n    this.count = count;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return RawStringParser.parse(input, this.recon, this.output, this.count, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, output?: Output<V>,\n                     count: number = 0, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 96/*'`'*/) {\n        input = input.step();\n        count = 1;\n        step = 2;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"raw string\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        if (input.head() === 96/*'`'*/) {\n          input = input.step();\n          count = 2;\n          step = 3;\n        } else {\n          output = output || recon.textOutput();\n          step = 4;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"raw string\", input));\n      }\n    }\n    if (step === 3) {\n      if (input.isCont()) {\n        if (input.head() === 96/*'`'*/) {\n          input = input.step();\n          output = output || recon.textOutput();\n          count = 3;\n          step = 4;\n        } else {\n          output = output || recon.textOutput();\n          return Parser.done(output!.bind());\n        }\n      } else if (input.isDone()) {\n        output = output || recon.textOutput();\n        return Parser.done(output!.bind());\n      }\n    }\n    do {\n      if (step === 4) {\n        while (input.isCont()) {\n          c = input.head();\n          if ((count !== 1 || c >= 0x20) && c !== 96/*'`'*/ && c !== 92/*'\\\\'*/) {\n            input = input.step();\n            output = output!.write(c);\n          } else {\n            break;\n          }\n        }\n        if (input.isCont()) {\n          if (c === 92/*'\\\\'*/) {\n            input = input.step();\n            step = 5;\n          } else if (c === 96/*'`'*/) {\n            input = input.step();\n            if (count === 1) {\n              return Parser.done(output!.bind());\n            } else {\n              step = 6;\n            }\n          } else {\n            return Parser.error(Diagnostic.expected(96/*'`'*/, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(96/*'`'*/, input));\n        }\n      }\n      if (step === 5) {\n        if (input.isCont()) {\n          c = input.head();\n          input = input.step();\n          if (c !== 92/*'\\\\'*/ && c !== 96/*'`'*/) {\n            output = output!.write(92/*'\\\\'*/);\n          }\n          output = output!.write(c);\n          step = 4;\n          continue;\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(\"escape character\", input));\n        }\n      }\n      if (step === 6) {\n        if (input.isCont()) {\n          if (input.head() === 96/*'`'*/) {\n            input = input.step();\n            step = 7;\n          } else {\n            output = output!.write(96/*'`'*/);\n            step = 4;\n            continue;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.message(\"unclosed raw string\", input));\n        }\n      }\n      if (step === 7) {\n        if (input.isCont()) {\n          if (input.head() === 96/*'`'*/) {\n            input = input.step();\n            return Parser.done(output!.bind());\n          } else {\n            output = output!.write(96/*'`'*/);\n            output = output!.write(96/*'`'*/);\n            step = 4;\n            continue;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.message(\"unclosed raw string\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new RawStringParser<I, V>(recon, output, count, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode, Base16} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class NumberParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly sign: number | undefined;\n  private readonly value: number | undefined;\n  private readonly mode: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, sign?: number, value?: number, mode?: number, step?: number) {\n    super();\n    this.recon = recon;\n    this.sign = sign;\n    this.value = value;\n    this.mode = mode;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return NumberParser.parse(input, this.recon, this.sign, this.value, this.mode, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, sign: number = 1, value: number = 0,\n                     mode: number = 2, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 45/*'-'*/) {\n          input = input.step();\n          sign = -1;\n        }\n        step = 2;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"number\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 48/*'0'*/) {\n          input = input.step();\n          step = 4;\n        } else if (c >= 49/*'1'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          value = sign * (c - 48/*'0'*/);\n          step = 3;\n        } else {\n          return Parser.error(Diagnostic.expected(\"digit\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"digit\", input));\n      }\n    }\n    if (step === 3) {\n      while (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          const newValue = 10 * value + sign * (c - 48/*'0'*/);\n          if (-9007199254740991 <= newValue && newValue <= 9007199254740992) {\n            value = newValue;\n            input = input.step();\n          } else {\n            return Parser.error(Diagnostic.message(\"integer overflow\", input));\n          }\n        } else {\n          break;\n        }\n      }\n      if (input.isCont()) {\n        step = 4;\n      } else if (input.isDone()) {\n        return Parser.done(recon.num(value));\n      }\n    }\n    if (step === 4) {\n      if (input.isCont()) {\n        c = input.head();\n        if (mode > 0 && c === 46/*'.'*/ || mode > 1 && (c === 69/*'E'*/ || c === 101/*'e'*/)) {\n          let output = Unicode.stringOutput();\n          if (sign < 0 && value === 0) {\n            output = output.write(45/*'-'*/).write(48/*'0'*/);\n          } else {\n            output = output.write(\"\" + value);\n          }\n          return DecimalParser.parse(input, recon, output, mode);\n        } else if (c === 120/*'x'*/ && sign > 0 && value === 0) {\n          input = input.step();\n          return HexadecimalParser.parse(input, recon);\n        } else {\n          return Parser.done(recon.num(value));\n        }\n      } else if (input.isDone()) {\n        return Parser.done(recon.num(value));\n      }\n    }\n    return new NumberParser<I, V>(recon, sign, value, mode, step);\n  }\n\n  static parseInteger<I, V>(input: Input, recon: ReconParser<I, V>): Parser<V> {\n    return NumberParser.parse(input, recon, void 0, void 0, 0);\n  }\n\n  static parseDecimal<I, V>(input: Input, recon: ReconParser<I, V>): Parser<V> {\n    return NumberParser.parse(input, recon, void 0, void 0, 1);\n  }\n}\n\n/** @internal */\nexport class DecimalParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly output: Output<string>;\n  private readonly mode: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, output: Output<string>, mode?: number, step?: number) {\n    super();\n    this.recon = recon;\n    this.output = output;\n    this.mode = mode;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return DecimalParser.parse(input, this.recon, this.output, this.mode, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, output: Output<string>,\n                     mode: number = 2, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 46/*'.'*/) {\n          input = input.step();\n          output = output.write(c);\n          step = 2;\n        } else if (mode > 1 && (c === 69/*'E'*/ || c === 101/*'e'*/)) {\n          input = input.step();\n          output = output.write(c);\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(\"decimal or exponent\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"decimal or exponent\", input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n          step = 3;\n        } else {\n          return Parser.error(Diagnostic.expected(\"digit\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"digit\", input));\n      }\n    }\n    if (step === 3) {\n      while (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n        } else {\n          break;\n        }\n      }\n      if (input.isCont()) {\n        if (mode > 1) {\n          step = 4;\n        } else {\n          return Parser.done(recon.num(output.bind()));\n        }\n      } else if (input.isDone()) {\n        return Parser.done(recon.num(output.bind()));\n      }\n    }\n    if (step === 4) {\n      c = input.head();\n      if (c === 69/*'E'*/ || c === 101/*'e'*/) {\n        input = input.step();\n        output = output.write(c);\n        step = 5;\n      } else {\n        return Parser.done(recon.num(output.bind()));\n      }\n    }\n    if (step === 5) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 43/*'+'*/ || c === 45/*'-'*/) {\n          input = input.step();\n          output = output.write(c);\n        }\n        step = 6;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 6) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n          step = 7;\n        } else {\n          return Parser.error(Diagnostic.expected(\"digit\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(\"digit\", input));\n      }\n    }\n    if (step === 7) {\n      while (input.isCont()) {\n        c = input.head();\n        if (c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          input = input.step();\n          output = output.write(c);\n        } else {\n          break;\n        }\n      }\n      if (!input.isEmpty()) {\n        return Parser.done(recon.num(output.bind()));\n      }\n    }\n    return new DecimalParser<I, V>(recon, output, mode, step);\n  }\n}\n\n/** @internal */\nclass HexadecimalParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly value: number | undefined;\n  private readonly size: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, value?: number, size?: number) {\n    super();\n    this.recon = recon;\n    this.value = value;\n    this.size = size;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return HexadecimalParser.parse(input, this.recon, this.value, this.size);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>,\n                     value: number = 0, size: number = 0): Parser<V> {\n    let c = 0;\n    while (input.isCont()) {\n      c = input.head();\n      if (Base16.isDigit(c)) {\n        input = input.step();\n        value = 16 * value + Base16.decodeDigit(c);\n        size += 1;\n      } else {\n        break;\n      }\n    }\n    if (!input.isEmpty()) {\n      if (size > 0) {\n        if (size <= 8) {\n          return Parser.done(recon.uint32(value));\n        } else {\n          return Parser.done(recon.uint64(value));\n        }\n      } else {\n        return Parser.error(Diagnostic.expected(\"hex digit\", input));\n      }\n    }\n    return new HexadecimalParser<I, V>(recon, value, size);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class LambdaFuncParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly bindingsParser: Parser<V> | undefined;\n  private readonly templateParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, bindingsParser?: Parser<V>,\n              templateParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.bindingsParser = bindingsParser;\n    this.templateParser = templateParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return LambdaFuncParser.parse(input, this.recon, this.builder, this.bindingsParser,\n                                  this.templateParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     bindingsParser?: Parser<V>, templateParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (bindingsParser === void 0) {\n        bindingsParser = recon.parseConditionalOperator(input, builder);\n      }\n      while (bindingsParser.isCont() && !input.isEmpty()) {\n        bindingsParser = bindingsParser.feed(input);\n      }\n      if (bindingsParser.isDone()) {\n        step = 2;\n      } else if (bindingsParser.isError()) {\n        return bindingsParser.asError();\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 62/*'>'*/) {\n          // leading '=' consumed by ComparisonOperatorParser\n          input = input.step();\n          step = 3;\n        } else {\n          return bindingsParser!;\n        }\n      } else if (input.isDone()) {\n        return bindingsParser!;\n      }\n    }\n    if (step === 3) {\n      if (templateParser === void 0) {\n        templateParser = recon.parseConditionalOperator(input);\n      }\n      while (templateParser.isCont() && !input.isEmpty()) {\n        templateParser = templateParser.feed(input);\n      }\n      if (templateParser.isDone()) {\n        const bindings = bindingsParser!.bind();\n        const template = templateParser.bind();\n        return Parser.done(recon.lambda(bindings, template));\n      } else if (templateParser.isError()) {\n        return templateParser.asError();\n      }\n    }\n    return new LambdaFuncParser<I, V>(recon, builder, bindingsParser, templateParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class ConditionalOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly ifParser: Parser<V> | undefined;\n  private readonly thenParser: Parser<V> | undefined;\n  private readonly elseParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, ifParser?: Parser<V>,\n              thenParser?: Parser<V>, elseParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.ifParser = ifParser;\n    this.thenParser = thenParser;\n    this.elseParser = elseParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return ConditionalOperatorParser.parse(input, this.recon, this.builder, this.ifParser,\n                                           this.thenParser, this.elseParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     ifParser?: Parser<V>, thenParser?: Parser<V>,\n                     elseParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (ifParser === void 0) {\n        ifParser = recon.parseOrOperator(input, builder);\n      }\n      while (ifParser.isCont() && !input.isEmpty()) {\n        ifParser = ifParser.feed(input);\n      }\n      if (ifParser.isDone()) {\n        step = 2;\n      } else if (ifParser.isError()) {\n        return ifParser.asError();\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 63/*'?'*/) {\n          input = input.step();\n          step = 3;\n        } else {\n          return ifParser!;\n        }\n      } else if (input.isDone()) {\n        return ifParser!;\n      }\n    }\n    if (step === 3) {\n      if (thenParser === void 0) {\n        thenParser = recon.parseConditionalOperator(input, builder);\n      }\n      while (thenParser.isCont() && !input.isEmpty()) {\n        thenParser = thenParser.feed(input);\n      }\n      if (thenParser.isDone()) {\n        step = 4;\n      } else if (thenParser.isError()) {\n        return thenParser.asError();\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 58/*':'*/) {\n          input = input.step();\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(58/*':'*/, input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(58/*':'*/, input));\n      }\n    }\n    if (step === 5) {\n      if (elseParser === void 0) {\n        elseParser = recon.parseConditionalOperator(input, builder);\n      }\n      while (elseParser.isCont() && !input.isEmpty()) {\n        elseParser = elseParser.feed(input);\n      }\n      if (elseParser.isDone()) {\n        const ifTerm = ifParser!.bind();\n        const thenTerm = thenParser!.bind();\n        const elseTerm = elseParser.bind();\n        return Parser.done(recon.conditional(ifTerm, thenTerm, elseTerm));\n      } else if (elseParser.isError()) {\n        return elseParser.asError();\n      }\n    }\n    return new ConditionalOperatorParser<I, V>(recon, builder, ifParser, thenParser, elseParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class OrOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              lhsParser?: Parser<V>, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return OrOperatorParser.parse(input, this.recon, this.builder, this.lhsParser,\n                                  this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     lhsParser?: Parser<V>, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parseAndOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 124/*'|'*/) {\n            // first '|' consumed by BitwiseOrOperatorParser\n            input = input.step();\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parseAndOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          lhsParser = Parser.done(recon.or(lhs, rhs));\n          rhsParser = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new OrOperatorParser<I, V>(recon, builder, lhsParser, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class AndOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              lhsParser?: Parser<V>, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return AndOperatorParser.parse(input, this.recon, this.builder, this.lhsParser,\n                                   this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     lhsParser?: Parser<V>, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parseBitwiseOrOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 38/*'&'*/) {\n            // first '&' consumed by BitwiseAndOperatorParser\n            input = input.step();\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parseBitwiseOrOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          lhsParser = Parser.done(recon.and(lhs, rhs));\n          rhsParser = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new AndOperatorParser<I, V>(recon, builder, lhsParser, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class BitwiseOrOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              lhsParser?: Parser<V>, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return BitwiseOrOperatorParser.parse(input, this.recon, this.builder,\n                                         this.lhsParser, this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     lhsParser?: Parser<V>, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parseBitwiseXorOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 124/*'|'*/) {\n            input = input.step();\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 124/*'|'*/) {\n            return lhsParser!;\n          } else {\n            step = 4;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 4) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parseBitwiseXorOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          lhsParser = Parser.done(recon.bitwiseOr(lhs, rhs));\n          rhsParser = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new BitwiseOrOperatorParser<I, V>(recon, builder, lhsParser, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class BitwiseXorOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              lhsParser?: Parser<V>, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return BitwiseXorOperatorParser.parse(input, this.recon, this.builder,\n                                          this.lhsParser, this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     lhsParser?: Parser<V>, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parseBitwiseAndOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 94/*'^'*/) {\n            input = input.step();\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parseBitwiseAndOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          lhsParser = Parser.done(recon.bitwiseXor(lhs, rhs));\n          rhsParser = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new BitwiseXorOperatorParser<I, V>(recon, builder, lhsParser, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class BitwiseAndOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              lhsParser?: Parser<V>, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return BitwiseAndOperatorParser.parse(input, this.recon, this.builder,\n                                          this.lhsParser, this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     lhsParser?: Parser<V>, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parseComparisonOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 38/*'&'*/) {\n            input = input.step();\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 38/*'&'*/) {\n            return lhsParser!;\n          } else {\n            step = 4;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      if (step === 4) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parseComparisonOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          lhsParser = Parser.done(recon.bitwiseAnd(lhs, rhs));\n          rhsParser = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new BitwiseAndOperatorParser<I, V>(recon, builder, lhsParser, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class ComparisonOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly operator: string | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, lhsParser?: Parser<V>,\n              operator?: string, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.operator = operator;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return ComparisonOperatorParser.parse(input, this.recon, this.builder, this.lhsParser,\n                                          this.operator, this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>, lhsParser?: Parser<V>,\n                     operator?: string, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (lhsParser === void 0) {\n        lhsParser = recon.parseAttrExpression(input, builder);\n      }\n      while (lhsParser.isCont() && !input.isEmpty()) {\n        lhsParser = lhsParser.feed(input);\n      }\n      if (lhsParser.isDone()) {\n        step = 2;\n      } else if (lhsParser.isError()) {\n        return lhsParser.asError();\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 33/*'!'*/) {\n          input = input.step();\n          step = 3;\n        } else if (c === 60/*'<'*/) {\n          input = input.step();\n          step = 4;\n        } else if (c === 62/*'>'*/) {\n          input = input.step();\n          step = 5;\n        } else if (c === 61/*'='*/) {\n          input = input.step();\n          step = 6;\n        } else {\n          return lhsParser!;\n        }\n      } else if (input.isDone()) {\n        return lhsParser!;\n      }\n    }\n    if (step === 3) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 61/*'='*/) {\n          input = input.step();\n          operator = \"!=\";\n          step = 7;\n        } else {\n          operator = \"!\";\n          step = 7;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 4) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 61/*'='*/) {\n          input = input.step();\n          operator = \"<=\";\n          step = 7;\n        } else {\n          operator = \"<\";\n          step = 7;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 5) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 61/*'='*/) {\n          input = input.step();\n          operator = \">=\";\n          step = 7;\n        } else {\n          operator = \">\";\n          step = 7;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 6) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 61/*'='*/) {\n          input = input.step();\n          operator = \"==\";\n          step = 7;\n        } else if (c === 62/*'>'*/) {\n          return lhsParser!;\n        } else {\n          operator = \"=\";\n          step = 7;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 7) {\n      if (rhsParser === void 0) {\n        rhsParser = recon.parseAttrExpression(input, builder);\n      }\n      while (rhsParser.isCont() && !input.isEmpty()) {\n        rhsParser = rhsParser.feed(input);\n      }\n      if (rhsParser.isDone()) {\n        const lhs = lhsParser!.bind();\n        const rhs = rhsParser.bind();\n        if (operator === \"<\") {\n          return Parser.done(recon.lt(lhs, rhs));\n        } else if (operator === \"<=\") {\n          return Parser.done(recon.le(lhs, rhs));\n        } else if (operator === \"==\") {\n          return Parser.done(recon.eq(lhs, rhs));\n        } else if (operator === \"!=\") {\n          return Parser.done(recon.ne(lhs, rhs));\n        } else if (operator === \">=\") {\n          return Parser.done(recon.ge(lhs, rhs));\n        } else if (operator === \">\") {\n          return Parser.done(recon.gt(lhs, rhs));\n        } else {\n          return Parser.error(Diagnostic.message(operator!, input));\n        }\n      } else if (rhsParser.isError()) {\n        return rhsParser.asError();\n      }\n    }\n    return new ComparisonOperatorParser<I, V>(recon, builder, lhsParser, operator, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class AttrExpressionParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly fieldParser: Parser<I> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              fieldParser?: Parser<I>, valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.fieldParser = fieldParser;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return AttrExpressionParser.parse(input, this.recon, this.builder,\n                                      this.fieldParser, this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     fieldParser?: Parser<I>, valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 64/*'@'*/) {\n            step = 2;\n          } else if (c === 123/*'{'*/ || c === 91/*'['*/) {\n            builder = builder || recon.recordBuilder();\n            step = 5;\n          } else if (c === 40/*'('*/) {\n            step = 4;\n          } else if (c === 33/*'!'*/ || c === 34/*'\"'*/ || c === 36/*'$'*/ || c === 37/*'%'*/\n                  || c === 39/*'\\''*/ || c === 43/*'+'*/ || c === 45/*'-'*/\n                  || c >= 48/*'0'*/ && c <= 57/*'9'*/ || c === 96/*'`'*/ || c === 126/*'~'*/\n                  || Recon.isIdentStartChar(c)) {\n            step = 3;\n          } else if (builder === void 0) {\n            return Parser.done(recon.extant());\n          } else {\n            return Parser.done(builder.bind());\n          }\n        } else if (input.isDone()) {\n          if (builder === void 0) {\n            return Parser.done(recon.extant());\n          } else {\n            return Parser.done(builder.bind());\n          }\n        }\n      }\n      if (step === 2) {\n        if (fieldParser === void 0) {\n          fieldParser = recon.parseAttr(input);\n        }\n        while (fieldParser.isCont() && !input.isEmpty()) {\n          fieldParser = fieldParser.feed(input);\n        }\n        if (fieldParser.isDone()) {\n          builder = builder || recon.recordBuilder();\n          builder.push(fieldParser.bind());\n          fieldParser = void 0;\n          step = 1;\n          continue;\n        } else if (fieldParser.isError()) {\n          return fieldParser.asError();\n        }\n      }\n      if (step === 3) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseAdditiveOperator(input);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          builder = builder || recon.valueBuilder();\n          builder.push(recon.item(valueParser.bind()));\n          valueParser = void 0;\n          step = 6;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 4) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseAdditiveOperator(input, builder);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          if (builder === void 0) {\n            builder = recon.valueBuilder();\n            builder.push(recon.item(valueParser.bind()));\n          }\n          valueParser = void 0;\n          step = 6;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 5) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseAdditiveOperator(input, builder);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          valueParser = void 0;\n          step = 6;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 6) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 64/*'@'*/) {\n            step = 1;\n            continue;\n          } else {\n            return Parser.done(builder!.bind());\n          }\n        } else if (input.isDone()) {\n          return Parser.done(builder!.bind());\n        }\n      }\n      break;\n    } while (true);\n    return new AttrExpressionParser<I, V>(recon, builder, fieldParser, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class AdditiveOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly operator: string | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, lhsParser?: Parser<V>,\n              operator?: string, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.operator = operator;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return AdditiveOperatorParser.parse(input, this.recon, this.builder, this.lhsParser,\n                                        this.operator, this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>, lhsParser?: Parser<V>,\n                     operator?: string, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parseMultiplicativeOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 43/*'+'*/) {\n            input = input.step();\n            operator = \"+\";\n            step = 3;\n          } else if (c === 45/*'-'*/) {\n            input = input.step();\n            operator = \"-\";\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parseMultiplicativeOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          if (operator === \"+\") {\n            lhsParser = Parser.done(recon.plus(lhs, rhs));\n          } else if (operator === \"-\") {\n            lhsParser = Parser.done(recon.minus(lhs, rhs));\n          } else {\n            return Parser.error(Diagnostic.message(operator!, input));\n          }\n          rhsParser = void 0;\n          operator = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new AdditiveOperatorParser<I, V>(recon, builder, lhsParser, operator, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class MultiplicativeOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly lhsParser: Parser<V> | undefined;\n  private readonly operator: string | undefined;\n  private readonly rhsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>, lhsParser?: Parser<V>,\n              operator?: string, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.lhsParser = lhsParser;\n    this.operator = operator;\n    this.rhsParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return MultiplicativeOperatorParser.parse(input, this.recon, this.builder, this.lhsParser,\n                                              this.operator, this.rhsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>, lhsParser?: Parser<V>,\n                     operator?: string, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (lhsParser === void 0) {\n          lhsParser = recon.parsePrefixOperator(input, builder);\n        }\n        while (lhsParser.isCont() && !input.isEmpty()) {\n          lhsParser = lhsParser.feed(input);\n        }\n        if (lhsParser.isDone()) {\n          step = 2;\n        } else if (lhsParser.isError()) {\n          return lhsParser.asError();\n        }\n      }\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 42/*'*'*/) {\n            input = input.step();\n            operator = \"*\";\n            step = 3;\n          } else if (c === 47/*'/'*/) {\n            input = input.step();\n            operator = \"/\";\n            step = 3;\n          } else if (c === 37/*'%'*/) {\n            input = input.step();\n            operator = \"%\";\n            step = 3;\n          } else {\n            return lhsParser!;\n          }\n        } else if (input.isDone()) {\n          return lhsParser!;\n        }\n      }\n      if (step === 3) {\n        if (rhsParser === void 0) {\n          rhsParser = recon.parsePrefixOperator(input, builder);\n        }\n        while (rhsParser.isCont() && !input.isEmpty()) {\n          rhsParser = rhsParser.feed(input);\n        }\n        if (rhsParser.isDone()) {\n          const lhs = lhsParser!.bind();\n          const rhs = rhsParser.bind();\n          if (operator === \"*\") {\n            lhsParser = Parser.done(recon.times(lhs, rhs));\n          } else if (operator === \"/\") {\n            lhsParser = Parser.done(recon.divide(lhs, rhs));\n          } else if (operator === \"%\") {\n            lhsParser = Parser.done(recon.modulo(lhs, rhs));\n          } else {\n            return Parser.error(Diagnostic.message(operator!, input));\n          }\n          rhsParser = void 0;\n          operator = void 0;\n          step = 2;\n          continue;\n        } else if (rhsParser.isError()) {\n          return rhsParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new MultiplicativeOperatorParser<I, V>(recon, builder, lhsParser, operator, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class PrefixOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly operator: string | undefined;\n  private readonly operandParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              operator?: string, rhsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.operator = operator;\n    this.operandParser = rhsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return PrefixOperatorParser.parse(input, this.recon, this.builder,\n                                      this.operator, this.operandParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     operator?: string, rhsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 33/*'!'*/) {\n          input = input.step();\n          operator = \"!\";\n        } else if (c === 126/*'~'*/) {\n          input = input.step();\n          operator = \"~\";\n        } else if (c === 45/*'-'*/) {\n          input = input.step();\n          operator = \"-\";\n        } else if (c === 43/*'+'*/) {\n          input = input.step();\n          operator = \"+\";\n        } else {\n          return recon.parseInvokeOperator(input, builder);\n        }\n        step = 2;\n      } else if (input.isDone()) {\n        return recon.parseInvokeOperator(input, builder);\n      }\n    }\n    if (step === 2) {\n      if (rhsParser === void 0) {\n        rhsParser = recon.parsePrefixOperator(input, builder);\n      }\n      while (rhsParser.isCont() && !input.isEmpty()) {\n        rhsParser = rhsParser.feed(input);\n      }\n      if (rhsParser.isDone()) {\n        const operand = rhsParser.bind();\n        if (!recon.isDistinct(operand)) {\n          return Parser.error(Diagnostic.expected(\"value\", input));\n        } else if (operator === \"!\") {\n          return Parser.done(recon.not(operand));\n        } else if (operator === \"~\") {\n          return Parser.done(recon.bitwiseNot(operand));\n        } else if (operator === \"-\") {\n          return Parser.done(recon.negative(operand));\n        } else if (operator === \"+\") {\n          return Parser.done(recon.positive(operand));\n        } else {\n          return Parser.error(Diagnostic.message(operator!, input));\n        }\n      } else if (rhsParser.isError()) {\n        return rhsParser.asError();\n      }\n    }\n    return new PrefixOperatorParser<I, V>(recon, builder, operator, rhsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class InvokeOperatorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly exprParser: Parser<V> | undefined;\n  private readonly argsParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              exprParser?: Parser<V>, argsParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.exprParser = exprParser;\n    this.argsParser = argsParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return InvokeOperatorParser.parse(input, this.recon, this.builder,\n                                      this.exprParser, this.argsParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     exprParser?: Parser<V>, argsParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      if (exprParser === void 0) {\n        exprParser = recon.parsePrimary(input, builder);\n      }\n      while (exprParser.isCont() && !input.isEmpty()) {\n        exprParser = exprParser.feed(input);\n      }\n      if (exprParser.isDone()) {\n        step = 2;\n      } else if (exprParser.isError()) {\n        return exprParser.asError();\n      }\n    }\n    do {\n      if (step === 2) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 40/*'('*/) {\n            input = input.step();\n            step = 3;\n          } else {\n            return exprParser!;\n          }\n        } else if (input.isDone()) {\n          return exprParser!;\n        }\n      }\n      if (step === 3) {\n        while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 41/*')'*/) {\n            input = input.step();\n            const expr = exprParser!.bind();\n            exprParser = Parser.done(recon.invoke(expr, recon.extant()));\n            step = 2;\n            continue;\n          } else {\n            step = 4;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(41/*')'*/, input));\n        }\n      }\n      if (step === 4) {\n        if (argsParser === void 0) {\n          argsParser = recon.parseBlock(input);\n        }\n        while (argsParser.isCont() && !input.isEmpty()) {\n          argsParser = argsParser.feed(input);\n        }\n        if (argsParser.isDone()) {\n          step = 5;\n        } else if (argsParser.isError()) {\n          return argsParser.asError();\n        }\n      }\n      if (step === 5) {\n        while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n        if (c === 41/*')'*/) {\n            input = input.step();\n            const expr = exprParser!.bind();\n            const args = argsParser!.bind();\n            exprParser = Parser.done(recon.invoke(expr, args));\n            argsParser = void 0;\n            step = 2;\n            continue;\n          } else {\n            return Parser.error(Diagnostic.expected(41/*')'*/, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(41/*')'*/, input));\n        }\n      }\n      break;\n    } while (true);\n    return new InvokeOperatorParser<I, V>(recon, builder, exprParser, argsParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class PrimaryParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly exprParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              exprParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.exprParser = exprParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return PrimaryParser.parse(input, this.recon, this.builder,\n                               this.exprParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     exprParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 40/*'('*/) {\n          input = input.step();\n          step = 3;\n        } else {\n          step = 2;\n        }\n      } else if (input.isDone()) {\n        step = 2;\n      }\n    }\n    if (step === 2) {\n      if (exprParser === void 0) {\n        exprParser = recon.parseLiteral(input, builder);\n      }\n      while (exprParser.isCont() && !input.isEmpty()) {\n        exprParser = exprParser.feed(input);\n      }\n      if (exprParser.isDone()) {\n        return exprParser;\n      } else if (exprParser.isError()) {\n        return exprParser.asError();\n      }\n    }\n    if (step === 3) {\n      if (exprParser === void 0) {\n        exprParser = recon.parseBlockExpression(input, builder);\n      }\n      while (exprParser.isCont() && !input.isEmpty()) {\n        exprParser = exprParser.feed(input);\n      }\n      if (exprParser.isDone()) {\n        step = 4;\n      } else if (exprParser.isError()) {\n        return exprParser.asError();\n      }\n    }\n    do {\n      if (step === 4) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 44/*','*/) {\n            input = input.step();\n            if (exprParser !== void 0) {\n              if (builder === void 0) {\n                builder = recon.recordBuilder();\n                builder.push(recon.item(exprParser.bind()));\n              }\n              exprParser = void 0;\n            }\n            step = 5;\n          } else if (c === 41/*')'*/) {\n            input = input.step();\n            if (exprParser !== void 0) {\n              return exprParser;\n            } else {\n              return Parser.done(builder!.bind());\n            }\n          } else {\n            return Parser.error(Diagnostic.expected(41/*')'*/, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(41/*')'*/, input));\n        }\n      }\n      if (step === 5) {\n        if (exprParser === void 0) {\n          exprParser = recon.parseBlockExpression(input, builder);\n        }\n        while (exprParser.isCont() && !input.isEmpty()) {\n          exprParser = exprParser.feed(input);\n        }\n        if (exprParser.isDone()) {\n          exprParser = void 0;\n          step = 4;\n          continue;\n        } else if (exprParser.isError()) {\n          return exprParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new PrimaryParser<I, V>(recon, builder, exprParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class LiteralParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return LiteralParser.parse(input, this.recon, this.builder, this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 40/*'('*/) {\n          input = input.step();\n          step = 4;\n        } else if (c === 123/*'{'*/) {\n          builder = builder || recon.recordBuilder();\n          valueParser = recon.parseRecord(input, builder);\n          step = 3;\n        } else if (c === 91/*'['*/) {\n          builder = builder || recon.recordBuilder();\n          valueParser = recon.parseMarkup(input, builder);\n          step = 3;\n        } else if (Recon.isIdentStartChar(c)) {\n          valueParser = recon.parseIdent(input);\n          step = 2;\n        } else if (c === 34/*'\"'*/ || c === 39/*'\\''*/) {\n          valueParser = recon.parseString(input);\n          step = 2;\n        } else if (c === 96/*'`'*/) {\n          valueParser = recon.parseRawString(input);\n          step = 2;\n        } else if (c === 45/*'-'*/ || c >= 48/*'0'*/ && c <= 57/*'9'*/) {\n          valueParser = recon.parseNumber(input);\n          step = 2;\n        } else if (c === 37/*'%'*/) {\n          valueParser = recon.parseData(input);\n          step = 2;\n        } else if (c === 36/*'$'*/) {\n          valueParser = recon.parseSelector(input);\n          step = 2;\n        } else if (builder === void 0) {\n          return Parser.done(recon.extant());\n        } else {\n          return Parser.done(builder.bind());\n        }\n      } else if (input.isDone()) {\n        if (builder === void 0) {\n          return Parser.done(recon.extant());\n        } else {\n          return Parser.done(builder.bind());\n        }\n      }\n    }\n    if (step === 2) {\n      while (valueParser!.isCont() && !input.isEmpty()) {\n        valueParser = valueParser!.feed(input);\n      }\n      if (valueParser!.isDone()) {\n        builder = builder || recon.valueBuilder();\n        builder.push(recon.item(valueParser!.bind()));\n        return Parser.done(builder.bind());\n      } else if (valueParser!.isError()) {\n        return valueParser!.asError();\n      }\n    }\n    if (step === 3) {\n      while (valueParser!.isCont() && !input.isEmpty()) {\n        valueParser = valueParser!.feed(input);\n      }\n      if (valueParser!.isDone()) {\n        return Parser.done(builder!.bind());\n      } else if (valueParser!.isError()) {\n        return valueParser!.asError();\n      }\n    }\n    if (step === 4) {\n      if (valueParser === void 0) {\n        valueParser = recon.parseBlockExpression(input);\n      }\n      while (valueParser.isCont() && !input.isEmpty()) {\n        valueParser = valueParser.feed(input);\n      }\n      if (valueParser.isDone()) {\n        step = 5;\n      } else if (valueParser.isError()) {\n        return valueParser.asError();\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Recon.isWhitespace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 41/*')'*/) {\n          input = input.step();\n          builder = builder || recon.valueBuilder();\n          builder.push(recon.item(valueParser!.bind()));\n          return Parser.done(builder.bind());\n        } else {\n          return Parser.error(Diagnostic.expected(41/*')'*/, input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(41/*')'*/, input));\n      }\n    }\n    return new LiteralParser<I, V>(recon, builder, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport type {ReconParser} from \"./ReconParser\";\n\n/** @internal */\nexport class SelectorParser<I, V> extends Parser<V> {\n  private readonly recon: ReconParser<I, V>;\n  private readonly builder: Builder<I, V> | undefined;\n  private readonly selector: V | undefined;\n  private readonly valueParser: Parser<V> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconParser<I, V>, builder?: Builder<I, V>,\n              selector?: V, valueParser?: Parser<V>, step?: number) {\n    super();\n    this.recon = recon;\n    this.builder = builder;\n    this.selector = selector;\n    this.valueParser = valueParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<V> {\n    return SelectorParser.parse(input, this.recon, this.builder,\n                                this.selector, this.valueParser, this.step);\n  }\n\n  static parse<I, V>(input: Input, recon: ReconParser<I, V>, builder?: Builder<I, V>,\n                     selector?: V, valueParser?: Parser<V>, step: number = 1): Parser<V> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 36/*'$'*/) {\n        input = input.step();\n        selector = selector || recon.selector();\n        step = 2;\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.expected(36/*'$'*/, input));\n      }\n    }\n    if (step === 2) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 91/*'['*/) {\n          input = input.step();\n          step = 8;\n        } else if (c === 64/*'@'*/) {\n          input = input.step();\n          step = 7;\n        } else if (c === 58/*':'*/) {\n          input = input.step();\n          step = 6;\n        } else if (c === 42/*'*'*/) {\n          input = input.step();\n          step = 5;\n        } else if (c === 35/*'#'*/) {\n          input = input.step();\n          step = 4;\n        } else {\n          step = 3;\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    do {\n      if (step === 3) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseLiteral(input, recon.valueBuilder());\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          selector = recon.get(selector!, valueParser.bind());\n          valueParser = void 0;\n          step = 10;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 4) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseInteger(input);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          selector = recon.value(recon.getItem(selector!, valueParser.bind()));\n          valueParser = void 0;\n          step = 10;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 5) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 58/*':'*/) {\n            input = input.step();\n            selector = recon.keys(selector!);\n            step = 10;\n          } else if (c === 42/*'*'*/) {\n            input = input.step();\n            selector = recon.descendants(selector!);\n            step = 10;\n          } else {\n            selector = recon.children(selector!);\n            step = 10;\n          }\n        } else if (input.isDone()) {\n          selector = recon.children(selector!);\n          step = 10;\n        }\n      }\n      if (step === 6) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 42/*'*'*/) {\n            input = input.step();\n            selector = recon.values(selector!);\n            step = 10;\n          } else {\n            return Parser.error(Diagnostic.expected(42/*'*'*/, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(42/*'*'*/, input));\n        }\n      }\n      if (step === 7) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseIdent(input);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          selector = recon.getAttr(selector!, valueParser.bind());\n          valueParser = void 0;\n          step = 10;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 8) {\n        if (valueParser === void 0) {\n          valueParser = recon.parseBlockExpression(input);\n        }\n        while (valueParser.isCont() && !input.isEmpty()) {\n          valueParser = valueParser.feed(input);\n        }\n        if (valueParser.isDone()) {\n          step = 9;\n        } else if (valueParser.isError()) {\n          return valueParser.asError();\n        }\n      }\n      if (step === 9) {\n        while (input.isCont() && (c = input.head(), Recon.isSpace(c))) {\n          input = input.step();\n        }\n        if (input.isCont()) {\n          if (c === 93/*']'*/) {\n            input = input.step();\n            selector = recon.filter(selector!, valueParser!.bind());\n            valueParser = void 0;\n            step = 10;\n          } else {\n            return Parser.error(Diagnostic.expected(93/*']'*/, input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.expected(93/*']'*/, input));\n        }\n      }\n      if (step === 10) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 91/*'['*/) {\n            input = input.step();\n            step = 8;\n            continue;\n          } else if (c === 35/*'#'*/) {\n            input = input.step();\n            step = 4;\n            continue;\n          } else if (c === 46/*'.'*/) {\n            input = input.step();\n            step = 11;\n          } else if (builder !== void 0) {\n            builder.push(recon.item(selector!));\n            return Parser.done(builder.bind());\n          } else {\n            return Parser.done(selector!);\n          }\n        } else if (input.isDone()) {\n          if (builder !== void 0) {\n            builder.push(recon.item(selector!));\n            return Parser.done(builder.bind());\n          } else {\n            return Parser.done(selector!);\n          }\n        }\n      }\n      if (step === 11) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 64/*'@'*/) {\n            input = input.step();\n            step = 7;\n            continue;\n          } else if (c === 58/*':'*/) {\n            input = input.step();\n            step = 6;\n            continue;\n          } else if (c === 42/*'*'*/) {\n            input = input.step();\n            step = 5;\n            continue;\n          } else {\n            step = 3;\n            continue;\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      break;\n    } while (true);\n    return new SelectorParser<I, V>(recon, builder, selector, valueParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {Input, Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport {BlockParser} from \"./BlockParser\";\nimport {AttrParser} from \"./AttrParser\";\nimport {BlockItemParser} from \"./BlockItemParser\";\nimport {InlineItemParser} from \"./InlineItemParser\";\nimport {RecordParser} from \"./RecordParser\";\nimport {MarkupParser} from \"./MarkupParser\";\nimport {DataParser} from \"./DataParser\";\nimport {IdentParser} from \"./IdentParser\";\nimport {StringParser} from \"./StringParser\";\nimport {RawStringParser} from \"./RawStringParser\";\nimport {NumberParser} from \"./NumberParser\";\nimport {LambdaFuncParser} from \"./LambdaFuncParser\";\nimport {ConditionalOperatorParser} from \"./ConditionalOperatorParser\";\nimport {OrOperatorParser} from \"./OrOperatorParser\";\nimport {AndOperatorParser} from \"./AndOperatorParser\";\nimport {BitwiseOrOperatorParser} from \"./BitwiseOrOperatorParser\";\nimport {BitwiseXorOperatorParser} from \"./BitwiseXorOperatorParser\";\nimport {BitwiseAndOperatorParser} from \"./BitwiseAndOperatorParser\";\nimport {ComparisonOperatorParser} from \"./ComparisonOperatorParser\";\nimport {AttrExpressionParser} from \"./AttrExpressionParser\";\nimport {AdditiveOperatorParser} from \"./AdditiveOperatorParser\";\nimport {MultiplicativeOperatorParser} from \"./MultiplicativeOperatorParser\";\nimport {PrefixOperatorParser} from \"./PrefixOperatorParser\";\nimport {InvokeOperatorParser} from \"./InvokeOperatorParser\";\nimport {PrimaryParser} from \"./PrimaryParser\";\nimport {LiteralParser} from \"./LiteralParser\";\nimport {SelectorParser} from \"./SelectorParser\";\n\n/**\n * Factory for constructing Recon parsers and parse trees.\n * @public\n */\nexport abstract class ReconParser<I, V> {\n  abstract isDistinct(value: V): boolean;\n\n  abstract item(value: V): I;\n\n  abstract value(item: I): V;\n\n  abstract attr(key: V, value: V): I;\n\n  abstract attr(key: V): I;\n\n  abstract slot(key: V, value: V): I;\n\n  abstract slot(key: V): I;\n\n  abstract valueBuilder(): Builder<I, V>;\n\n  abstract recordBuilder(): Builder<I, V>;\n\n  abstract dataOutput(): Output<V>;\n\n  abstract textOutput(): Output<V>;\n\n  abstract ident(value: V): V;\n\n  abstract num(value: number | string): V;\n\n  abstract uint32(value: number): V;\n\n  abstract uint64(value: number): V;\n\n  abstract bool(value: boolean): V;\n\n  abstract selector(): V;\n\n  abstract extant(): V;\n\n  abstract absent(): V;\n\n  abstract conditional(ifTerm: V, thenTerm: V, elseTerm: V): V;\n\n  abstract or(lhs: V, rhs: V): V;\n\n  abstract and(lhs: V, rhs: V): V;\n\n  abstract bitwiseOr(lhs: V, rhs: V): V;\n\n  abstract bitwiseXor(lhs: V, rhs: V): V;\n\n  abstract bitwiseAnd(lhs: V, rhs: V): V;\n\n  abstract lt(lhs: V, rhs: V): V;\n\n  abstract le(lhs: V, rhs: V): V;\n\n  abstract eq(lhs: V, rhs: V): V;\n\n  abstract ne(lhs: V, rhs: V): V;\n\n  abstract ge(lhs: V, rhs: V): V;\n\n  abstract gt(lhs: V, rhs: V): V;\n\n  abstract plus(lhs: V, rhs: V): V;\n\n  abstract minus(lhs: V, rhs: V): V;\n\n  abstract times(lhs: V, rhs: V): V;\n\n  abstract divide(lhs: V, rhs: V): V;\n\n  abstract modulo(lhs: V, rhs: V): V;\n\n  abstract not(rhs: V): V;\n\n  abstract bitwiseNot(rhs: V): V;\n\n  abstract negative(rhs: V): V;\n\n  abstract positive(rhs: V): V;\n\n  abstract invoke(func: V, args: V): V;\n\n  abstract lambda(bindings: V, template: V): V;\n\n  abstract get(selector: V, key: V): V;\n\n  abstract getAttr(selector: V, key: V): V;\n\n  abstract getItem(selector: V, index: V): I;\n\n  abstract children(selector: V): V;\n\n  abstract descendants(selector: V): V;\n\n  abstract keys(selector: V): V;\n\n  abstract values(selector: V): V;\n\n  abstract filter(selector: V, predicate: V): V;\n\n  parseBlock(input: Input): Parser<V> {\n    return BlockParser.parse(input, this);\n  }\n\n  parseAttr(input: Input): Parser<I> {\n    return AttrParser.parse(input, this);\n  }\n\n  parseBlockItem(input: Input): Parser<V> {\n    return BlockItemParser.parse(input, this);\n  }\n\n  parseInlineItem(input: Input): Parser<V> {\n    return InlineItemParser.parse(input, this);\n  }\n\n  parseRecord(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return RecordParser.parse(input, this, builder);\n  }\n\n  parseMarkup(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return MarkupParser.parse(input, this, builder);\n  }\n\n  parseData(input: Input): Parser<V> {\n    return DataParser.parse(input, this);\n  }\n\n  parseIdent(input: Input): Parser<V> {\n    return IdentParser.parse(input, this);\n  }\n\n  parseString(input: Input): Parser<V> {\n    return StringParser.parse(input, this);\n  }\n\n  parseRawString(input: Input): Parser<V> {\n    return RawStringParser.parse(input, this);\n  }\n\n  parseNumber(input: Input): Parser<V> {\n    return NumberParser.parse(input, this);\n  }\n\n  parseInteger(input: Input): Parser<V> {\n    return NumberParser.parseInteger(input, this);\n  }\n\n  parseBlockExpression(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return this.parseLambdaFunc(input, builder);\n  }\n\n  parseLambdaFunc(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return LambdaFuncParser.parse(input, this, builder);\n  }\n\n  parseConditionalOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return ConditionalOperatorParser.parse(input, this, builder);\n  }\n\n  parseOrOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return OrOperatorParser.parse(input, this, builder);\n  }\n\n  parseAndOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return AndOperatorParser.parse(input, this, builder);\n  }\n\n  parseBitwiseOrOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return BitwiseOrOperatorParser.parse(input, this, builder);\n  }\n\n  parseBitwiseXorOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return BitwiseXorOperatorParser.parse(input, this, builder);\n  }\n\n  parseBitwiseAndOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return BitwiseAndOperatorParser.parse(input, this, builder);\n  }\n\n  parseComparisonOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return ComparisonOperatorParser.parse(input, this, builder);\n  }\n\n  parseAttrExpression(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return AttrExpressionParser.parse(input, this, builder);\n  }\n\n  parseAdditiveOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return AdditiveOperatorParser.parse(input, this, builder);\n  }\n\n  parseMultiplicativeOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return MultiplicativeOperatorParser.parse(input, this, builder);\n  }\n\n  parsePrefixOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return PrefixOperatorParser.parse(input, this, builder);\n  }\n\n  parseInvokeOperator(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return InvokeOperatorParser.parse(input, this, builder);\n  }\n\n  parsePrimary(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return PrimaryParser.parse(input, this, builder);\n  }\n\n  parseLiteral(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return LiteralParser.parse(input, this, builder);\n  }\n\n  parseSelector(input: Input, builder?: Builder<I, V>): Parser<V> {\n    return SelectorParser.parse(input, this, builder);\n  }\n\n  blockParser(): Parser<V> {\n    return new BlockParser<I, V>(this);\n  }\n\n  parseBlockString(string: string): V {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Recon.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = this.parseBlock(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Recon.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {\n  Item,\n  Attr,\n  Slot,\n  Value,\n  Record,\n  Data,\n  Text,\n  Num,\n  Bool,\n  Selector,\n  AndOperator,\n  BitwiseAndOperator,\n  BitwiseNotOperator,\n  BitwiseOrOperator,\n  BitwiseXorOperator,\n  DivideOperator,\n  EqOperator,\n  GeOperator,\n  GtOperator,\n  InvokeOperator,\n  LeOperator,\n  LtOperator,\n  MinusOperator,\n  ModuloOperator,\n  NeOperator,\n  NegativeOperator,\n  NotOperator,\n  OrOperator,\n  PlusOperator,\n  PositiveOperator,\n  TimesOperator,\n} from \"@swim/structure\";\nimport {ReconParser} from \"./ReconParser\";\n\n/** @public */\nexport class ReconStructureParser extends ReconParser<Item, Value> {\n  override isDistinct(value: Value): boolean {\n    return value.isDistinct();\n  }\n\n  override item(value: Value): Item {\n    return value;\n  }\n\n  override value(item: Item): Value {\n    return item.toValue();\n  }\n\n  override attr(key: Value, value?: Value): Item {\n    if (arguments.length === 1) {\n      return Attr.of(key as Text);\n    } else {\n      return Attr.of(key as Text, value);\n    }\n  }\n\n  override slot(key: Value, value?: Value): Item {\n    if (arguments.length === 1) {\n      return Slot.of(key);\n    } else {\n      return Slot.of(key, value);\n    }\n  }\n\n  override valueBuilder(): Builder<Item, Value> {\n    return Value.builder();\n  }\n\n  override recordBuilder(): Builder<Item, Value> {\n    return Record.create();\n  }\n\n  override dataOutput(): Output<Value> {\n    return Data.output();\n  }\n\n  override textOutput(): Output<Value> {\n    return Text.output();\n  }\n\n  override ident(value: Value): Value {\n    if (value instanceof Text) {\n      const string = value.stringValue();\n      if (string === \"true\") {\n        return Bool.from(true);\n      } else if (string === \"false\") {\n        return Bool.from(false);\n      }\n    }\n    return value;\n  }\n\n  override num(value: number | string): Value {\n    if (typeof value === \"number\") {\n      return Num.from(value);\n    } else if (typeof value === \"string\") {\n      return Num.from(+value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  override uint32(value: number): Value {\n    return Num.uint32(value);\n  }\n\n  override uint64(value: number): Value {\n    return Num.uint64(value);\n  }\n\n  override bool(value: boolean): Value {\n    return Bool.from(value);\n  }\n\n  override selector(): Value {\n    return Selector.identity();\n  }\n\n  override extant(): Value {\n    return Value.extant();\n  }\n\n  override absent(): Value {\n    return Value.absent();\n  }\n\n  override conditional(ifTerm: Value, thenTerm: Value, elseTerm: Value): Value {\n    return ifTerm.conditional(thenTerm, elseTerm);\n  }\n\n  override or(lhs: Value, rhs: Value): Value {\n    return new OrOperator(lhs, rhs);\n  }\n\n  override and(lhs: Value, rhs: Value): Value {\n    return new AndOperator(lhs, rhs);\n  }\n\n  override bitwiseOr(lhs: Value, rhs: Value): Value {\n    return new BitwiseOrOperator(lhs, rhs);\n  }\n\n  override bitwiseXor(lhs: Value, rhs: Value): Value {\n    return new BitwiseXorOperator(lhs, rhs);\n  }\n\n  override bitwiseAnd(lhs: Value, rhs: Value): Value {\n    return new BitwiseAndOperator(lhs, rhs);\n  }\n\n  override lt(lhs: Value, rhs: Value): Value {\n    return new LtOperator(lhs, rhs);\n  }\n\n  override le(lhs: Value, rhs: Value): Value {\n    return new LeOperator(lhs, rhs);\n  }\n\n  override eq(lhs: Value, rhs: Value): Value {\n    return new EqOperator(lhs, rhs);\n  }\n\n  override ne(lhs: Value, rhs: Value): Value {\n    return new NeOperator(lhs, rhs);\n  }\n\n  override ge(lhs: Value, rhs: Value): Value {\n    return new GeOperator(lhs, rhs);\n  }\n\n  override gt(lhs: Value, rhs: Value): Value {\n    return new GtOperator(lhs, rhs);\n  }\n\n  override plus(lhs: Value, rhs: Value): Value {\n    return new PlusOperator(lhs, rhs);\n  }\n\n  override minus(lhs: Value, rhs: Value): Value {\n    return new MinusOperator(lhs, rhs);\n  }\n\n  override times(lhs: Value, rhs: Value): Value {\n    return new TimesOperator(lhs, rhs);\n  }\n\n  override divide(lhs: Value, rhs: Value): Value {\n    return new DivideOperator(lhs, rhs);\n  }\n\n  override modulo(lhs: Value, rhs: Value): Value {\n    return new ModuloOperator(lhs, rhs);\n  }\n\n  override not(rhs: Value): Value {\n    return new NotOperator(rhs);\n  }\n\n  override bitwiseNot(rhs: Value): Value {\n    return new BitwiseNotOperator(rhs);\n  }\n\n  override negative(rhs: Value): Value {\n    if (rhs instanceof Num) {\n      return rhs.negative();\n    } else {\n      return new NegativeOperator(rhs);\n    }\n  }\n\n  override positive(rhs: Value): Value {\n    return new PositiveOperator(rhs);\n  }\n\n  override invoke(func: Value, args: Value): Value {\n    return new InvokeOperator(func, args);\n  }\n\n  override lambda(bindings: Value, template: Value): Value {\n    return bindings.lambda(template);\n  }\n\n  override get(selector: Value, key: Value): Value {\n    return selector.get(key);\n  }\n\n  override getAttr(selector: Value, key: Value): Value {\n    return selector.getAttr(key as Text);\n  }\n\n  override getItem(selector: Value, index: Value): Item {\n    return selector.getItem(index as Num);\n  }\n\n  override children(selector: Value): Value {\n    return Selector.literal(selector).children();\n  }\n\n  override descendants(selector: Value): Value {\n    return Selector.literal(selector).descendants();\n  }\n\n  override keys(selector: Value): Value {\n    return Selector.literal(selector).keys();\n  }\n\n  override values(selector: Value): Value {\n    return Selector.literal(selector).values();\n  }\n\n  override filter(selector: Value, predicate: Value): Value {\n    return selector.filter(predicate);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class AttrWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly key: V;\n  private readonly value: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, key: V, value: V, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.key = key;\n    this.value = value;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return AttrWriter.write(output, this.recon, this.key, this.value, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, key: V, value: V): number {\n    let size = 0;\n    size += 1; // '@'\n    size += recon.sizeOfValue(key);\n    if (!recon.isExtant(recon.item(value))) {\n      size += 1; // '(';\n      size += recon.sizeOfBlockValue(value);\n      size += 1; // ')';\n    }\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, key: V, value: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(64/*'@'*/);\n      step = 2;\n    }\n    if (step === 2) {\n      if (part === void 0) {\n        part = recon.writeValue(output, key);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        if (recon.isExtant(recon.item(value))) {\n          return Writer.end();\n        } else {\n          step = 3;\n        }\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(40/*'('*/);\n      step = 4;\n    }\n    if (step === 4) {\n      if (part === void 0) {\n        part = recon.writeBlockValue(output, value);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 5;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 5 && output.isCont()) {\n      output = output.write(41/*')'*/);\n      return Writer.end();\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new AttrWriter<I, V>(recon, key, value, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class SlotWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly key: V;\n  private readonly value: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, key: V, value: V, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.key = key;\n    this.value = value;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return SlotWriter.write(output, this.recon, this.key, this.value, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, key: V, value: V): number {\n    let size = 0;\n    size += recon.sizeOfValue(key);\n    size += 1; // ':'\n    if (!recon.isExtant(recon.item(value))) {\n      size += recon.sizeOfValue(value);\n    }\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, key: V, value: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (part === void 0) {\n        part = recon.writeValue(output, key);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 2;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 2 && output.isCont()) {\n      output = output.write(58/*':'*/);\n      if (recon.isExtant(recon.item(value))) {\n        return Writer.end();\n      } else {\n        step = 3;\n      }\n    }\n    if (step === 3) {\n      if (part === void 0) {\n        part = recon.writeValue(output, value);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        return Writer.end();\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new SlotWriter<I, V>(recon, key, value, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class BlockWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly items: Cursor<I>;\n  private readonly inBlock: boolean;\n  private readonly inMarkup: boolean;\n  private readonly inBraces: boolean | undefined;\n  private readonly inBrackets: boolean | undefined;\n  private readonly first: boolean | undefined;\n  private readonly markupSafe: boolean | undefined;\n  private readonly item: I | undefined;\n  private readonly next: I | undefined;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, items: Cursor<I>, inBlock: boolean, inMarkup: boolean,\n              inBraces?: boolean, inBrackets?: boolean, first?: boolean, markupSafe?: boolean,\n              item?: I, next?: I, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.items = items;\n    this.inBlock = inBlock;\n    this.inMarkup = inMarkup;\n    this.inBraces = inBraces;\n    this.inBrackets = inBrackets;\n    this.first = first;\n    this.markupSafe = markupSafe;\n    this.item = item;\n    this.next = next;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return BlockWriter.write(output, this.recon, this.items, this.inBlock, this.inMarkup,\n                             this.inBraces, this.inBrackets, this.first, this.markupSafe,\n                             this.item, this.next, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, items: Cursor<I>,\n                      inBlock: boolean, inMarkup: boolean): number {\n    let size = 0;\n    let inBraces = false;\n    let inBrackets = false;\n    let first = true;\n    let markupSafe = true;\n    let next: I | undefined;\n    while (next !== void 0 || items.hasNext()) {\n      let item: I | undefined;\n      if (next === void 0 ) {\n        item = items.next().value!;\n      } else {\n        item = next;\n        next = void 0;\n      }\n      if (items.hasNext()) {\n        next = items.next().value!;\n      }\n      if (recon.isExpression(item)) {\n        markupSafe = false;\n      }\n      if (inBrackets && recon.isAttr(item)) {\n        if (inBraces) {\n          size += 1; // '}'\n          inBraces = false;\n        }\n        size += 1; // ']'\n        inBrackets = false;\n      }\n      if (recon.isAttr(item)) {\n        if (inBraces) {\n          size += 1; // '}'\n          inBraces = false;\n        } else if (inBrackets) { // FIXME: case already covered?\n          size += 1; // ']'\n          inBrackets = false;\n        }\n        size += recon.sizeOfItem(item);\n        first = false;\n      } else if (inBrackets && recon.isText(item)) {\n        if (inBraces) {\n          size += 1; // '}'\n          inBraces = false;\n        }\n        size += recon.sizeOfMarkupText(item);\n      } else if (inBraces) {\n        if (!first) {\n          size += 1; // ','\n        } else {\n          first = false;\n        }\n        size += BlockWriter.sizeOfBlockItem(recon, item);\n      } else if (inBrackets) {\n        if (recon.isRecord(item) && recon.isMarkupSafe(recon.items(item))) {\n          size += recon.sizeOfBlock(recon.items(item), false, true);\n          if (next !== void 0 && recon.isText(next)) {\n            size += recon.sizeOfMarkupText(next);\n            next = void 0;\n          } else if (next !== void 0 && !recon.isAttr(next)) {\n            size += 1; // '{'\n            inBraces = true;\n            first = true;\n          } else {\n            size += 1; // ']'\n            inBrackets = false;\n          }\n        } else {\n          size += 1; // '{'\n          size += recon.sizeOfItem(item);\n          inBraces = true;\n          first = false;\n        }\n      } else if (markupSafe && recon.isText(item) && next !== void 0 && !recon.isField(next)\n              && !recon.isText(next) && !recon.isBool(next)) {\n        size += 1; // '['\n        size += recon.sizeOfMarkupText(item);\n        inBrackets = true;\n      } else if (inBlock && !inBraces) {\n        if (!first) {\n          size += 1; // ','\n        } else {\n          first = false;\n        }\n        size += BlockWriter.sizeOfBlockItem(recon, item);\n      } else if (inMarkup && recon.isText(item) && next === void 0) {\n        size += 1; // '['\n        size += recon.sizeOfMarkupText(item);\n        size += 1; // ']'\n      } else if (!inMarkup && recon.isValue(item) && !recon.isRecord(item)\n             && (!first && next === void 0 || next !== void 0 && recon.isAttr(next))) {\n        if (!first && (recon.isText(item) && recon.isIdent(item)\n                    || recon.isNum(item) || recon.isBool(item))) {\n          size += 1; // ' '\n        }\n        size += recon.sizeOfItem(item);\n      } else {\n        size += 1; // '{'\n        size += recon.sizeOfItem(item);\n        inBraces = true;\n        first = false;\n      }\n    }\n    if (inBraces) {\n      size += 1; // '}'\n    }\n    if (inBrackets) {\n      size += 1; // ']'\n    }\n    return size;\n  }\n\n  static sizeOfBlockItem<I, V>(recon: ReconWriter<I, V>, item: I): number {\n    let size = 0;\n    if (recon.isField(item)) {\n      size += recon.sizeOfSlot(recon.key(item), recon.value(item));\n    } else {\n      size += recon.sizeOfItem(item);\n    }\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, items: Cursor<I>,\n                     inBlock: boolean, inMarkup: boolean, inBraces: boolean = false,\n                     inBrackets: boolean = false, first: boolean = true, markupSafe: boolean = true,\n                     item?: I, next?: I, part?: Writer, step: number = 1): Writer {\n    do {\n      if (step === 1) {\n        if (next === void 0 && !items.hasNext()) {\n          step = 10;\n          break;\n        } else {\n          if (next === void 0) {\n            item = items.next().value!;\n          } else {\n            item = next;\n            next = void 0;\n          }\n          if (items.hasNext()) {\n            next = items.next().value!;\n          }\n          if (recon.isExpression(item)) {\n            markupSafe = false;\n          }\n          step = 2;\n        }\n      }\n      if (step === 2 && output.isCont()) {\n        if (inBrackets && recon.isAttr(item!)) {\n          if (inBraces) {\n            output = output.write(125/*'}'*/);\n            inBraces = false;\n          }\n          step = 3;\n        } else {\n          step = 4;\n        }\n      }\n      if (step === 3 && output.isCont()) {\n        output = output.write(93/*']'*/);\n        inBrackets = false;\n        step = 4;\n      }\n      if (step === 4 && output.isCont()) {\n        if (recon.isAttr(item!)) {\n          if (inBraces) {\n            output = output.write(125/*'}'*/);\n            inBraces = false;\n          } else if (inBrackets) {\n            output = output.write(93/*']'*/);\n            inBrackets = false;\n          }\n          part = recon.writeItem(output, item!);\n          first = false;\n          step = 7;\n        } else if (inBrackets && recon.isText(item!)) {\n          if (inBraces) {\n            output = output.write(125/*'}'*/);\n            inBraces = false;\n          }\n          part = recon.writeMarkupText(output, item!);\n          step = 7;\n        } else if (inBraces) {\n          if (!first) {\n            output = output.write(44/*','*/);\n          } else {\n            first = false;\n          }\n          part = BlockWriter.writeBlockItem(output, recon, item!);\n          step = 7;\n        } else if (inBrackets) {\n          if (recon.isRecord(item!) && recon.isMarkupSafe(recon.items(item!))) {\n            part = recon.writeBlock(output, recon.items(item!), false, true);\n            step = 5;\n          } else {\n            output = output.write(123/*'{'*/);\n            part = recon.writeItem(output, item!);\n            inBraces = true;\n            first = false;\n            step = 7;\n          }\n        } else if (markupSafe && recon.isText(item!) && next !== void 0 && !recon.isField(next)\n                && !recon.isText(next) && !recon.isBool(next)) {\n          output = output.write(91/*'['*/);\n          part = recon.writeMarkupText(output, item!);\n          inBrackets = true;\n          step = 7;\n        } else if (inBlock && !inBraces) {\n          if (!first) {\n            output = output.write(44/*','*/);\n          } else {\n            first = false;\n          }\n          part = BlockWriter.writeBlockItem(output, recon, item!);\n          step = 7;\n        } else if (inMarkup && recon.isText(item!) && next === void 0) {\n          output = output.write(91/*'['*/);\n          part = recon.writeMarkupText(output, item!);\n          step = 8;\n        } else if (!inMarkup && recon.isValue(item!) && !recon.isRecord(item!)\n               && (!first && next === void 0 || next !== void 0 && recon.isAttr(next))) {\n          if (!first && (recon.isText(item!) && recon.isIdent(item!)\n                      || recon.isNum(item!) || recon.isBool(item!))) {\n            output = output.write(32/*' '*/);\n          }\n          part = recon.writeItem(output, item!);\n          step = 7;\n        } else {\n          output = output.write(123/*'{'*/);\n          part = recon.writeItem(output, item!);\n          inBraces = true;\n          first = false;\n          step = 7;\n        }\n      }\n      if (step === 5) {\n        part = part!.pull(output);\n        if (part.isDone()) {\n          part = void 0;\n          step = 6;\n        } else if (part.isError()) {\n          return part.asError();\n        }\n      }\n      if (step === 6 && output.isCont()) {\n        if (next !== void 0 && recon.isText(next)) {\n          part = recon.writeMarkupText(output, next);\n          next = void 0;\n          step = 7;\n        } else if (next !== void 0 && !recon.isAttr(next)) {\n          output = output.write(123/*'{'*/);\n          inBraces = true;\n          first = true;\n          step = 1;\n          continue;\n        } else {\n          output = output.write(93/*']'*/);\n          inBrackets = false;\n          step = 1;\n          continue;\n        }\n      }\n      if (step === 7) {\n        part = part!.pull(output);\n        if (part.isDone()) {\n          part = void 0;\n          step = 1;\n          continue;\n        } else if (part.isError()) {\n          return part.asError();\n        }\n      }\n      if (step === 8) {\n        part = part!.pull(output);\n        if (part.isDone()) {\n          part = void 0;\n          step = 9;\n        } else if (part.isError()) {\n          return part.asError();\n        }\n      }\n      if (step === 9 && output.isCont()) {\n        output = output.write(93/*']'*/);\n        step = 1;\n        continue;\n      }\n      break;\n    } while (true);\n    if (step === 10) {\n      if (inBraces) {\n        if (output.isCont()) {\n          output = output.write(125/*'}'*/);\n          step = 11;\n        }\n      } else {\n        step = 11;\n      }\n    }\n    if (step === 11) {\n      if (inBrackets) {\n        if (output.isCont()) {\n          output = output.write(93/*']'*/);\n          return Writer.end();\n        }\n      } else {\n        return Writer.end();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new BlockWriter<I, V>(recon, items, inBlock, inMarkup, inBraces, inBrackets,\n                                 first, markupSafe, item, next, part, step);\n  }\n\n  static writeBlockItem<I, V>(output: Output, recon: ReconWriter<I, V>, item: I): Writer {\n    if (recon.isField(item)) {\n      return recon.writeSlot(output, recon.key(item), recon.value(item));\n    } else {\n      return recon.writeItem(output, item);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class PrimaryWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly items: Cursor<I>;\n  private readonly inParens: boolean | undefined;\n  private readonly first: boolean | undefined;\n  private readonly item: I | undefined;\n  private readonly next: I | undefined;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, items: Cursor<I>, inParens?: boolean,\n              first?: boolean, item?: I, next?: I, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.items = items;\n    this.inParens = inParens;\n    this.first = first;\n    this.item = item;\n    this.next = next;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return PrimaryWriter.write(output, this.recon, this.items, this.inParens, this.first,\n                               this.item, this.next, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, items: Cursor<I>): number {\n    let size = 0;\n    let inParens = false;\n    let first = true;\n    let next: I | undefined;\n    while (next !== void 0 || items.hasNext()) {\n      let item: I | undefined;\n      if (next === void 0) {\n        item = items.next().value!;\n      } else {\n        item = next;\n        next = void 0;\n      }\n      if (items.hasNext()) {\n        next = items.next().value!;\n      }\n      if (!inParens && !first) {\n        size += 1; // ' '\n      }\n      if (recon.isAttr(item)) {\n        if (inParens) {\n          size += 1; // ')'\n          inParens = false;\n        }\n        size += recon.sizeOfItem(item);\n        first = false;\n      } else if (inParens) {\n        if (!first) {\n          size += 1; // ','\n        } else {\n          first = false;\n        }\n        size += recon.sizeOfBlockItem(item);\n      } else if (recon.isValue(item) && !recon.isRecord(item)\n             && (!first && next === void 0 || next !== void 0 && recon.isAttr(next))) {\n        size += recon.sizeOfItem(item);\n      } else {\n        size += 1; // '('\n        size += recon.sizeOfItem(item);\n        inParens = true;\n        first = false;\n      }\n    }\n    if (inParens) {\n      size += 1; // ')'\n    }\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, items: Cursor<I>,\n                     inParens: boolean = false, first: boolean = true, item?: I,\n                     next?: I, part?: Writer, step: number = 1): Writer {\n    do {\n      if (step === 1) {\n        if (next === void 0 && !items.hasNext()) {\n          step = 5;\n          break;\n        } else {\n          if (next === void 0) {\n            item = items.next().value!;\n          } else {\n            item = next;\n            next = void 0;\n          }\n          if (items.hasNext()) {\n            next = items.next().value!;\n          }\n          step = 2;\n        }\n      }\n      if (step === 2 && output.isCont()) {\n        if (!inParens && !first) {\n          output = output.write(32/*' '*/);\n        }\n        step = 3;\n      }\n      if (step === 3 && output.isCont()) {\n        if (recon.isAttr(item!)) {\n          if (inParens) {\n            output = output.write(41/*')'*/);\n            inParens = false;\n          }\n          part = recon.writeItem(output, item!);\n          first = false;\n          step = 4;\n        } else if (inParens) {\n          if (!first) {\n            output = output.write(44/*','*/);\n          } else {\n            first = false;\n          }\n          part = recon.writeBlockItem(output, item!);\n          step = 4;\n        } else if (recon.isValue(item!) && !recon.isRecord(item!)\n               && (!first && next === void 0 || next !== void 0 && recon.isAttr(next))) {\n          part = recon.writeItem(output, item!);\n          step = 4;\n        } else {\n          output = output.write(40/*'('*/);\n          part = recon.writeItem(output, item!);\n          inParens = true;\n          first = false;\n          step = 4;\n        }\n      }\n      if (step === 4) {\n        part = part!.pull(output);\n        if (part.isDone()) {\n          part = void 0;\n          step = 1;\n          continue;\n        } else if (part.isError()) {\n          return part.asError();\n        }\n      }\n      break;\n    } while (true);\n    if (step === 5) {\n      if (inParens) {\n        if (output.isCont()) {\n          output = output.write(41/*')'*/);\n          return Writer.end();\n        }\n      } else {\n        return Writer.end();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new PrimaryWriter<I, V>(recon, items, inParens, first, item, next, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings} from \"@swim/util\";\nimport {Output, WriterException, Writer, Utf8, Base16} from \"@swim/codec\";\n\n/** @internal */\nexport class MarkupTextWriter extends Writer {\n  private readonly text: string;\n  private readonly index: number | undefined;\n  private readonly escape: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(text: string, index?: number, escape?: number, step?: number) {\n    super();\n    this.text = text;\n    this.index = index;\n    this.escape = escape;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return MarkupTextWriter.write(output, this.text, this.index, this.escape, this.step);\n  }\n\n  static sizeOf(text: string): number {\n    let size = 0;\n    for (let i = 0, n = text.length; i < n; i = Strings.offsetByCodePoints(text, i, 1)) {\n      let c = text.codePointAt(i);\n      if (c === void 0) {\n        c = text.charCodeAt(i);\n      }\n      if (c === 36/*'$'*/ || c === 64/*'@'*/ || c === 91/*'['*/ || c === 92/*'\\\\'*/\n          || c === 93/*']'*/ || c === 123/*'{'*/ || c === 125/*'}'*/ || c === 8/*'\\b'*/\n          || c === 12/*'\\f'*/ || c === 10/*'\\n'*/ || c === 13/*'\\r'*/ || c === 9/*'\\t'*/) {\n        size += 2;\n      } else if (c < 0x20) {\n        size += 6;\n      } else {\n        size += Utf8.sizeOf(c);\n      }\n    }\n    return size;\n  }\n\n  static write(output: Output, text: string, index: number = 0,\n               escape: number = 0, step: number = 1): Writer {\n    const length = text.length;\n    while (output.isCont()) {\n      if (step === 1) {\n        if (index < length) {\n          let c = text.codePointAt(index);\n          if (c === void 0) {\n            c = text.charCodeAt(index);\n          }\n          index = Strings.offsetByCodePoints(text, index, 1);\n          if (c === 36/*'$'*/ || c === 64/*'@'*/ || c === 91/*'['*/ || c === 92/*'\\\\'*/\n              || c === 93/*']'*/ || c === 123/*'{'*/ || c === 125/*'}'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = c;\n            step = 2;\n          } else if (c === 8/*'\\b'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 98/*'b'*/;\n            step = 2;\n          } else if (c === 12/*'\\f'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 102/*'f'*/;\n            step = 2;\n          } else if (c === 10/*'\\n'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 110/*'n'*/;\n            step = 2;\n          } else if (c === 13/*'\\r'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 114/*'r'*/;\n            step = 2;\n          } else if (c === 9/*'\\t'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 116/*'t'*/;\n            step = 2;\n          } else if (c < 0x20) {\n            output = output.write(92/*'\\\\'*/);\n            escape = c;\n            step = 3;\n          } else {\n            output = output.write(c);\n          }\n        } else {\n          return Writer.end();\n        }\n      } else if (step === 2) {\n        output = output.write(escape);\n        escape = 0;\n        step = 1;\n      } else if (step === 3) {\n        output = output.write(117/*'u'*/);\n        step = 4;\n      } else if (step === 4) {\n        output = output.write(Base16.uppercase.encodeDigit((escape >>> 12) & 0xf));\n        step = 5;\n      } else if (step === 5) {\n        output = output.write(Base16.uppercase.encodeDigit((escape >>> 8) & 0xf));\n        step = 6;\n      } else if (step === 6) {\n        output = output.write(Base16.uppercase.encodeDigit((escape >>> 4) & 0xf));\n        step = 7;\n      } else if (step === 7) {\n        output = output.write(Base16.uppercase.encodeDigit(escape & 0xf));\n        escape = 0;\n        step = 1;\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new MarkupTextWriter(text, index, escape, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer, Base64} from \"@swim/codec\";\n\n/** @internal */\nexport class DataWriter extends Writer {\n  private readonly array: Uint8Array;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(array: Uint8Array, part?: Writer, step?: number) {\n    super();\n    this.array = array;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return DataWriter.write(output, this.array, this.part, this.step);\n  }\n\n  static sizeOf(length: number): number {\n    return 1 + ((Math.floor(length * 4 / 3) + 3) & ~3);\n  }\n\n  static write(output: Output, array: Uint8Array, part?: Writer,\n               step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(37/*'%'*/);\n      step = 2;\n    }\n    if (step === 2) {\n      if (part === void 0) {\n        part = Base64.standard().writeUint8Array(output, array);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        return Writer.end();\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new DataWriter(array, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings} from \"@swim/util\";\nimport {Output, WriterException, Writer, Utf8} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\n\n/** @internal */\nexport class IdentWriter extends Writer {\n  private readonly ident: string;\n  private readonly index: number | undefined;\n\n  constructor(ident: string, index?: number) {\n    super();\n    this.ident = ident;\n    this.index = index;\n  }\n\n  override pull(output: Output): Writer {\n    return IdentWriter.write(output, this.ident, this.index);\n  }\n\n  static sizeOf(ident: string): number {\n    return Utf8.sizeOf(ident);\n  }\n\n  static write(output: Output, ident: string, index: number = 0): Writer {\n    let c: number | undefined;\n    const length = ident.length;\n    if (length === 0) {\n      return Writer.error(new WriterException(\"empty identifier\"));\n    }\n    if (index === 0 && output.isCont()) {\n      c = ident.codePointAt(0);\n      if (c === void 0) {\n        c = ident.charCodeAt(0);\n      }\n      if (Recon.isIdentStartChar(c)) {\n        output = output.write(c);\n        index = Strings.offsetByCodePoints(ident, 0, 1);\n      }\n    }\n    while (index < length && output.isCont()) {\n      c = ident.codePointAt(index);\n      if (c === void 0) {\n        c = ident.charCodeAt(index);\n      }\n      if (Recon.isIdentChar(c)) {\n        output = output.write(c);\n        index = Strings.offsetByCodePoints(ident, index, 1);\n      } else {\n        return Writer.error(new WriterException(\"invalid identifier\"));\n      }\n    }\n    if (index >= length) {\n      return Writer.end();\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new IdentWriter(ident, index);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings} from \"@swim/util\";\nimport {Output, WriterException, Writer, Utf8, Base16} from \"@swim/codec\";\n\n/** @internal */\nexport class StringWriter extends Writer {\n  private readonly string: string;\n  private readonly index: number | undefined;\n  private readonly escape: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(string: string, index?: number, escape?: number, step?: number) {\n    super();\n    this.string = string;\n    this.index = index;\n    this.escape = escape;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return StringWriter.write(output, this.string, this.index, this.escape, this.step);\n  }\n\n  static sizeOf(string: string): number {\n    let size = 0;\n    size += 1; // '\"';\n    for (let i = 0, n = string.length; i < n; i = Strings.offsetByCodePoints(string, i, 1)) {\n      let c = string.codePointAt(i);\n      if (c === void 0) {\n        c = string.charCodeAt(i);\n      }\n      if (c === 34/*'\"'*/ || c === 92/*'\\\\'*/ || c === 8/*'\\b'*/ || c === 12/*'\\f'*/\n          || c === 10/*'\\n'*/ || c === 13/*'\\r'*/ || c === 9/*'\\t'*/) {\n        size += 2;\n      } else if (c < 0x20) {\n        size += 6;\n      } else {\n        size += Utf8.sizeOf(c);\n      }\n    }\n    size += 1; // '\"';\n    return size;\n  }\n\n  static write(output: Output, string: string, index: number = 0, escape: number = 0,\n               step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(34/*'\"'*/);\n      step = 2;\n    }\n    const length = string.length;\n    while (step >= 2 && step <= 8 && output.isCont()) {\n      if (step === 2) {\n        if (index < length) {\n          let c = string.codePointAt(index);\n          if (c === void 0) {\n            c = string.charCodeAt(index);\n          }\n          index = Strings.offsetByCodePoints(string, index, 1);\n          if (c === 34/*'\"'*/ || c === 92/*'\\\\'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = c;\n            step = 3;\n          } else if (c === 8/*'\\b'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 98/*'b'*/;\n            step = 3;\n          } else if (c === 12/*'\\f'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 102/*'f'*/;\n            step = 3;\n          } else if (c === 10/*'\\n'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 110/*'n'*/;\n            step = 3;\n          } else if (c === 13/*'\\r'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 114/*'r'*/;\n            step = 3;\n          } else if (c === 9/*'\\t'*/) {\n            output = output.write(92/*'\\\\'*/);\n            escape = 116/*'t'*/;\n            step = 3;\n          } else if (c < 0x20) {\n            output = output.write('\\\\');\n            escape = c;\n            step = 4;\n          } else {\n            output = output.write(c);\n          }\n        } else {\n          step = 9;\n          break;\n        }\n      } else if (step === 3) {\n        output = output.write(escape);\n        escape = 0;\n        step = 2;\n      } else if (step === 4) {\n        output = output.write(117/*'u'*/);\n        step = 5;\n      } else if (step === 5) {\n        output = output.write(Base16.uppercase.encodeDigit((escape >>> 12) & 0xf));\n        step = 6;\n      } else if (step === 6) {\n        output = output.write(Base16.uppercase.encodeDigit((escape >>> 8) & 0xf));\n        step = 7;\n      } else if (step === 7) {\n        output = output.write(Base16.uppercase.encodeDigit((escape >>> 4) & 0xf));\n        step = 8;\n      } else if (step === 8) {\n        output = output.write(Base16.uppercase.encodeDigit(escape & 0xf));\n        escape = 0;\n        step = 2;\n      }\n    }\n    if (step === 9 && output.isCont()) {\n      output = output.write(34/*'\"'*/);\n      return Writer.end();\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new StringWriter(string, index, escape, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class LambdaFuncWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly bindings: V;\n  private readonly template: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, bindings: V, template: V,\n              part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.bindings = bindings;\n    this.template = template;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return LambdaFuncWriter.write(output, this.recon, this.bindings, this.template,\n                                  this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, bindings: V, template: V): number {\n    let size = 0;\n    size += recon.sizeOfPrimary(bindings);\n    size += 4; // \" => \"\n    size += recon.sizeOfValue(template);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, bindings: V, template: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (part === void 0) {\n        part = recon.writePrimary(output, bindings);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 2;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 2 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 3;\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(61/*'='*/);\n      step = 4;\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(62/*'>'*/);\n      step = 5;\n    }\n    if (step === 5 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 6;\n    }\n    if (step === 6) {\n      if (part === void 0) {\n        part = recon.writeValue(output, template);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        return Writer.end();\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new LambdaFuncWriter<I, V>(recon, bindings, template, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class ConditionalOperatorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly ifTerm: I;\n  private readonly thenTerm: I;\n  private readonly elseTerm: I;\n  private readonly precedence: number;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, ifTerm: I, thenTerm: I, elseTerm: I,\n              precedence: number, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.ifTerm = ifTerm;\n    this.thenTerm = thenTerm;\n    this.elseTerm = elseTerm;\n    this.precedence = precedence;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return ConditionalOperatorWriter.write(output, this.recon, this.ifTerm, this.thenTerm,\n                                           this.elseTerm, this.precedence, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, ifTerm: I, thenTerm: I,\n                      elseTerm: I, precedence: number): number {\n    let size = 0;\n    if (recon.precedence(ifTerm) > 0 && recon.precedence(ifTerm) <= precedence) {\n      size += 1; // '('\n      size += recon.sizeOfItem(ifTerm);\n      size += 1; // ')'\n    } else {\n      size += recon.sizeOfItem(ifTerm);\n    }\n    size += 3; // \" ? \"\n    size += recon.sizeOfItem(thenTerm);\n    size += 3; // \" : \"\n    size += recon.sizeOfItem(elseTerm);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, ifTerm: I, thenTerm: I, elseTerm: I,\n                     precedence: number, part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (recon.precedence(ifTerm) > 0 && recon.precedence(ifTerm) <= precedence) {\n        if (output.isCont()) {\n          output = output.write(40/*'('*/);\n          step = 2;\n        }\n      } else {\n        step = 2;\n      }\n    }\n    if (step === 2) {\n      if (part === void 0) {\n        part = recon.writeItem(output, ifTerm);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 3;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 3) {\n      if (recon.precedence(ifTerm) > 0 && recon.precedence(ifTerm) <= precedence) {\n        if (output.isCont()) {\n          output = output.write(41/*')'*/);\n          step = 4;\n        }\n      } else {\n        step = 4;\n      }\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 5;\n    }\n    if (step === 5 && output.isCont()) {\n      output = output.write(63/*'?'*/);\n      step = 6;\n    }\n    if (step === 6 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 7;\n    }\n    if (step === 7) {\n      if (part === void 0) {\n        part = recon.writeItem(output, thenTerm);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 8;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 8 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 9;\n    }\n    if (step === 9 && output.isCont()) {\n      output = output.write(58/*':'*/);\n      step = 10;\n    }\n    if (step === 10 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 11;\n    }\n    if (step === 11) {\n      if (part === void 0) {\n        part = recon.writeItem(output, elseTerm);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        return Writer.end();\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new ConditionalOperatorWriter<I, V>(recon, ifTerm, thenTerm, elseTerm,\n                                               precedence, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer, Unicode, Utf8} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class InfixOperatorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly lhs: I;\n  private readonly operator: string;\n  private readonly rhs: I;\n  private readonly precedence: number;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, lhs: I, operator: string, rhs: I,\n              precedence: number, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.lhs = lhs;\n    this.operator = operator;\n    this.rhs = rhs;\n    this.precedence = precedence;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return InfixOperatorWriter.write(output, this.recon, this.lhs, this.operator, this.rhs,\n                                     this.precedence, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, lhs: I, operator: string, rhs: I, precedence: number): number {\n    let size = 0;\n    if (recon.precedence(lhs) < precedence) {\n      size += 1; // '('\n      size += recon.sizeOfItem(lhs);\n      size += 1; // ')'\n    } else {\n      size += recon.sizeOfItem(lhs);\n    }\n    size += 1; // ' '\n    size += Utf8.sizeOf(operator);\n    size += 1; // ' '\n    if (recon.precedence(rhs) < precedence) {\n      size += 1; // '('\n      size += recon.sizeOfItem(rhs);\n      size += 1; // ')'\n    } else {\n      size += recon.sizeOfItem(rhs);\n    }\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, lhs: I, operator: string, rhs: I,\n                     precedence: number, part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (recon.precedence(lhs) < precedence) {\n        if (output.isCont()) {\n          output = output.write(40/*'('*/);\n          step = 2;\n        }\n      } else {\n        step = 2;\n      }\n    }\n    if (step === 2) {\n      if (part === void 0) {\n        part = recon.writeItem(output, lhs);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 3;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 3) {\n      if (recon.precedence(lhs) < precedence) {\n        if (output.isCont()) {\n          output = output.write(41/*')'*/);\n          step = 4;\n        }\n      } else {\n        step = 4;\n      }\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 5;\n    }\n    if (step === 5) {\n      if (part === void 0) {\n        part = Unicode.writeString(output, operator);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 6;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 6 && output.isCont()) {\n      output = output.write(32/*' '*/);\n      step = 7;\n    }\n    if (step === 7) {\n      if (recon.precedence(rhs) < precedence) {\n        if (output.isCont()) {\n          output = output.write(40/*'('*/);\n          step = 8;\n        }\n      } else {\n        step = 8;\n      }\n    }\n    if (step === 8) {\n      if (part === void 0) {\n        part = recon.writeItem(output, rhs);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 9;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 9) {\n      if (recon.precedence(rhs) < precedence) {\n        if (output.isCont()) {\n          output = output.write(41/*')'*/);\n          return Writer.end();\n        }\n      } else {\n        return Writer.end();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new InfixOperatorWriter<I, V>(recon, lhs, operator, rhs, precedence, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer, Unicode, Utf8} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class PrefixOperatorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly operator: string;\n  private readonly rhs: I;\n  private readonly precedence: number;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, operator: string, rhs: I,\n              precedence: number, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.operator = operator;\n    this.rhs = rhs;\n    this.precedence = precedence;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return PrefixOperatorWriter.write(output, this.recon, this.operator, this.rhs,\n                                      this.precedence, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, operator: string, rhs: I, precedence: number): number {\n    let size = 0;\n    size += Utf8.sizeOf(operator);\n    if (recon.precedence(rhs) < precedence) {\n      size += 1; // '('\n      size += recon.sizeOfItem(rhs);\n      size += 1; // ')'\n    } else {\n      size += recon.sizeOfItem(rhs);\n    }\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, operator: string, rhs: I,\n                     precedence: number, part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (part === void 0) {\n        part = Unicode.writeString(output, operator);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 2;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 2) {\n      if (recon.precedence(rhs) < precedence) {\n        if (output.isCont()) {\n          output = output.write(40/*'('*/);\n          step = 3;\n        }\n      } else {\n        step = 3;\n      }\n    }\n    if (step === 3) {\n      if (part === void 0) {\n        part = recon.writeItem(output, rhs);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 4;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 4) {\n      if (recon.precedence(rhs) < precedence) {\n        if (output.isCont()) {\n          output = output.write(41/*')'*/);\n          return Writer.end();\n        }\n      } else {\n        return Writer.end();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new PrefixOperatorWriter<I, V>(recon, operator, rhs, precedence, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class InvokeOperatorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly func: V;\n  private readonly args: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, func: V, args: V, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.func = func;\n    this.args = args;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return InvokeOperatorWriter.write(output, this.recon, this.func, this.args,\n                                      this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, func: V, args: V): number {\n    let size = 0;\n    size += recon.sizeOfValue(func);\n    size += 1; // '('\n    size += recon.sizeOfBlockValue(args);\n    size += 1; // ')'\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, func: V, args: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (part === void 0) {\n        part = recon.writeValue(output, func);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 2;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 2 && output.isCont()) {\n      output = output.write(40/*'('*/);\n      step = 3;\n    }\n    if (step === 3) {\n      if (part === void 0) {\n        part = recon.writeBlockValue(output, args);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 4;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(41/*')'*/);\n      return Writer.end();\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new InvokeOperatorWriter<I, V>(recon, func, args, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class LiteralSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly item: I;\n  private readonly then: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, item: I, then: V, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.item = item;\n    this.then = then;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return LiteralSelectorWriter.write(output, this.recon, this.item, this.then,\n                                       this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, item: I, then: V): number {\n    let size = 0;\n    if (recon.precedence(item) < recon.precedence(recon.item(then))) {\n      size += 1; // '('\n      size += recon.sizeOfItem(item);\n      size += 1; // ')'\n    } else {\n      size += recon.sizeOfItem(item);\n    }\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, item: I, then: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1) {\n      if (recon.precedence(item) < recon.precedence(recon.item(then))) {\n        if (output.isCont()) {\n          output = output.write(40/*'('*/);\n          step = 2;\n        }\n      } else {\n        step = 2;\n      }\n    }\n    if (step === 2) {\n      if (part === void 0) {\n        part = recon.writeItem(output, item);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 3;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 3) {\n      if (recon.precedence(item) < recon.precedence(recon.item(then))) {\n        if (output.isCont()) {\n          output = output.write(41/*')'*/);\n          step = 4;\n        }\n      } else {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new LiteralSelectorWriter<I, V>(recon, item, then, part, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class GetSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly key: V;\n  private readonly then: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, key: V, then: V, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.key = key;\n    this.then = then;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return GetSelectorWriter.write(output, this.recon, this.key, this.then, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, key: V, then: V): number {\n    let size = 1; // '$' | '.'\n    if (recon.isRecord(recon.item(key))) {\n      size += 1; // '{'\n      size += recon.sizeOfBlockValue(key);\n      size += 1; // '}'\n    } else {\n      size += recon.sizeOfValue(key);\n    }\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, key: V, then: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 3;\n    } else if (step === 2 && output.isCont()) {\n      output = output.write(46/*'.'*/);\n      step = 3;\n    }\n    if (step === 3) {\n      if (recon.isRecord(recon.item(key))) {\n        if (output.isCont()) {\n          output = output.write(123/*'{'*/);\n          step = 4;\n        }\n      } else {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (part === void 0) {\n        if (recon.isRecord(recon.item(key))) {\n          part = recon.writeBlockValue(output, key);\n        } else {\n          part = recon.writeValue(output, key);\n        }\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 5;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 5) {\n      if (recon.isRecord(recon.item(key))) {\n        if (output.isCont()) {\n          output = output.write(125/*'}'*/);\n          step = 6;\n        }\n      } else {\n        step = 6;\n      }\n    }\n    if (step === 6) {\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new GetSelectorWriter<I, V>(recon, key, then, part, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, key: V, then: V): Writer {\n    return GetSelectorWriter.write(output, recon, key, then, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class GetAttrSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly key: V;\n  private readonly then: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, key: V, then: V, part?: Writer, step?: number) {\n    super();\n    this.recon  = recon;\n    this.key = key;\n    this.then = then;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return GetAttrSelectorWriter.write(output, this.recon, this.key, this.then,\n                                       this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, key: V, then: V): number {\n    let size = 2; // ('$' | '.') '@'\n    size += recon.sizeOfValue(key);\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, key: V, then: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 3;\n    } else if (step === 2 && output.isCont()) {\n      output = output.write(46/*'.'*/);\n      step = 3;\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(64/*'@'*/);\n      step = 4;\n    }\n    if (step === 4) {\n      if (part === void 0) {\n        part = recon.writeValue(output, key);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        return recon.writeThen(output, then);\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new GetAttrSelectorWriter<I, V>(recon, key, then, part, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, key: V, then: V): Writer {\n    return GetAttrSelectorWriter.write(output, recon, key, then, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class GetItemSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly index: V;\n  private readonly then: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, index: V, then: V, part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.index = index;\n    this.then = then;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return GetItemSelectorWriter.write(output, this.recon, this.index, this.then,\n                                       this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, index: V, then: V): number {\n    let size = 2; // \"$#\"\n    size += recon.sizeOfValue(index);\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static sizeOfThen<I, V>(recon: ReconWriter<I, V>, index: V, then: V): number {\n    let size = 1; // '#'\n    size += recon.sizeOfValue(index);\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, index: V, then: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 2;\n    }\n    if (step === 2 && output.isCont()) {\n      output = output.write(35/*'#'*/);\n      step = 3;\n    }\n    if (step === 3) {\n      if (part === void 0) {\n        part = recon.writeValue(output, index);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        return recon.writeThen(output, then);\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new GetItemSelectorWriter<I, V>(recon, index, then, part, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, index: V, then: V): Writer {\n    return GetItemSelectorWriter.write(output, recon, index, then, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class KeysSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly then: V;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, then: V, step?: number) {\n    super();\n    this.recon = recon;\n    this.then = then;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return KeysSelectorWriter.write(output, this.recon, this.then, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, then: V): number {\n    let size = 3; // ('$' | '.') '*' ':'\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, then: V,\n                     step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 3;\n    } else if (step === 2 && output.isCont()) {\n      output = output.write(46/*'.'*/);\n      step = 3;\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(42/*'*'*/);\n      step = 4;\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(58/*':'*/);\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new KeysSelectorWriter<I, V>(recon, then, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, then: V): Writer {\n    return KeysSelectorWriter.write(output, recon, then, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class ValuesSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly then: V;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, then: V, step?: number) {\n    super();\n    this.recon = recon;\n    this.then = then;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return ValuesSelectorWriter.write(output, this.recon, this.then, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, then: V): number {\n    let size = 3; // ('$' | '.') ':' '*'\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, then: V,\n                     step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 3;\n    } else if (step === 2 && output.isCont()) {\n      output = output.write(46/*'.'*/);\n      step = 3;\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(58/*':'*/);\n      step = 4;\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(42/*'*'*/);\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new ValuesSelectorWriter<I, V>(recon, then, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, then: V): Writer {\n    return ValuesSelectorWriter.write(output, recon, then, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class ChildrenSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly then: V;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, then: V, step?: number) {\n    super();\n    this.recon = recon;\n    this.then = then;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return ChildrenSelectorWriter.write(output, this.recon, this.then, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, then: V): number {\n    let size = 2; // ('$' | '.') '*'\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, then: V,\n                     step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 3;\n    } else if (step === 2 && output.isCont()) {\n      output = output.write(46/*'.'*/);\n      step = 3;\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(42/*'*'*/);\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new ChildrenSelectorWriter<I, V>(recon, then, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, then: V): Writer {\n    return ChildrenSelectorWriter.write(output, recon, then, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class DescendantsSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly then: V;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, then: V, step?: number) {\n    super();\n    this.recon = recon;\n    this.then = then;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return DescendantsSelectorWriter.write(output, this.recon, this.then, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, then: V): number {\n    let size = 3; // ('$' | '.') '*' '*'\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, then: V,\n                     step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 3;\n    } else if (step === 2 && output.isCont()) {\n      output = output.write(46/*'.'*/);\n      step = 3;\n    }\n    if (step === 3 && output.isCont()) {\n      output = output.write(42/*'*'*/);\n      step = 4;\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(42/*'*'*/);\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new DescendantsSelectorWriter<I, V>(recon, then, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>, then: V): Writer {\n    return DescendantsSelectorWriter.write(output, recon, then, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport type {ReconWriter} from \"./ReconWriter\";\n\n/** @internal */\nexport class FilterSelectorWriter<I, V> extends Writer {\n  private readonly recon: ReconWriter<I, V>;\n  private readonly predicate: V;\n  private readonly then: V;\n  private readonly part: Writer | undefined;\n  private readonly step: number | undefined;\n\n  constructor(recon: ReconWriter<I, V>, predicate: V, then: V,\n              part?: Writer, step?: number) {\n    super();\n    this.recon = recon;\n    this.predicate = predicate;\n    this.then = then;\n    this.part = part;\n    this.step = step;\n  }\n\n  override pull(output: Output): Writer {\n    return FilterSelectorWriter.write(output, this.recon, this.predicate,\n                                      this.then, this.part, this.step);\n  }\n\n  static sizeOf<I, V>(recon: ReconWriter<I, V>, predicate: V, then: V): number {\n    let size = 2; // '$' '['\n    size += recon.sizeOfValue(predicate);\n    size += 1; // ']'\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static sizeOfThen<I, V>(recon: ReconWriter<I, V>, predicate: V, then: V): number {\n    let size = 1; // '['\n    size += recon.sizeOfValue(predicate);\n    size += 1; // ']'\n    size += recon.sizeOfThen(then);\n    return size;\n  }\n\n  static write<I, V>(output: Output, recon: ReconWriter<I, V>, predicate: V, then: V,\n                     part?: Writer, step: number = 1): Writer {\n    if (step === 1 && output.isCont()) {\n      output = output.write(36/*'$'*/);\n      step = 2;\n    }\n    if (step === 2 && output.isCont()) {\n      output = output.write(91/*'['*/);\n      step = 3;\n    }\n    if (step === 3) {\n      if (part === void 0) {\n        part = recon.writeValue(output, predicate);\n      } else {\n        part = part.pull(output);\n      }\n      if (part.isDone()) {\n        part = void 0;\n        step = 4;\n      } else if (part.isError()) {\n        return part.asError();\n      }\n    }\n    if (step === 4 && output.isCont()) {\n      output = output.write(93/*']'*/);\n      return recon.writeThen(output, then);\n    }\n    if (output.isDone()) {\n      return Writer.error(new WriterException(\"truncated\"));\n    } else if (output.isError()) {\n      return Writer.error(output.trap());\n    }\n    return new FilterSelectorWriter<I, V>(recon, predicate, then, part, step);\n  }\n\n  static writeThen<I, V>(output: Output, recon: ReconWriter<I, V>,\n                         predicate: V, then: V): Writer {\n    return FilterSelectorWriter.write(output, recon, predicate, then, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Strings, Cursor} from \"@swim/util\";\nimport {Output, Writer, Unicode, Base10, Base16} from \"@swim/codec\";\nimport {Recon} from \"../Recon\";\nimport {AttrWriter} from \"./AttrWriter\";\nimport {SlotWriter} from \"./SlotWriter\";\nimport {BlockWriter} from \"./BlockWriter\";\nimport {PrimaryWriter} from \"./PrimaryWriter\";\nimport {MarkupTextWriter} from \"./MarkupTextWriter\";\nimport {DataWriter} from \"./DataWriter\";\nimport {IdentWriter} from \"./IdentWriter\";\nimport {StringWriter} from \"./StringWriter\";\nimport {LambdaFuncWriter} from \"./LambdaFuncWriter\";\nimport {ConditionalOperatorWriter} from \"./ConditionalOperatorWriter\";\nimport {InfixOperatorWriter} from \"./InfixOperatorWriter\";\nimport {PrefixOperatorWriter} from \"./PrefixOperatorWriter\";\nimport {InvokeOperatorWriter} from \"./InvokeOperatorWriter\";\nimport {LiteralSelectorWriter} from \"./LiteralSelectorWriter\";\nimport {GetSelectorWriter} from \"./GetSelectorWriter\";\nimport {GetAttrSelectorWriter} from \"./GetAttrSelectorWriter\";\nimport {GetItemSelectorWriter} from \"./GetItemSelectorWriter\";\nimport {KeysSelectorWriter} from \"./KeysSelectorWriter\";\nimport {ValuesSelectorWriter} from \"./ValuesSelectorWriter\";\nimport {ChildrenSelectorWriter} from \"./ChildrenSelectorWriter\";\nimport {DescendantsSelectorWriter} from \"./DescendantsSelectorWriter\";\nimport {FilterSelectorWriter} from \"./FilterSelectorWriter\";\n\n/**\n * Factory for constructing Recon writers.\n * @public\n */\nexport abstract class ReconWriter<I, V> {\n  abstract isField(item: I): boolean;\n\n  abstract isAttr(item: I): boolean;\n\n  abstract isSlot(item: I): boolean;\n\n  abstract isValue(item: I): boolean;\n\n  abstract isRecord(item: I): boolean;\n\n  abstract isText(item: I): boolean;\n\n  abstract isNum(item: I): boolean;\n\n  abstract isBool(item: I): boolean;\n\n  abstract isExpression(item: I): boolean;\n\n  abstract isExtant(item: I): boolean;\n\n  abstract items(item: I): Cursor<I>;\n\n  abstract item(value: V): I;\n\n  abstract key(item: I): V;\n\n  abstract value(item: I): V;\n\n  abstract string(item: I): string;\n\n  abstract precedence(item: I): number;\n\n  abstract sizeOfItem(item: I): number;\n\n  abstract writeItem(output: Output, item: I): Writer;\n\n  abstract sizeOfValue(value: V): number;\n\n  abstract writeValue(output: Output, value: V): Writer;\n\n  abstract sizeOfBlockValue(value: V): number;\n\n  abstract writeBlockValue(output: Output, value: V): Writer;\n\n  sizeOfAttr(key: V, value: V): number {\n    return AttrWriter.sizeOf(this, key, value);\n  }\n\n  writeAttr(output: Output, key: V, value: V): Writer {\n    return AttrWriter.write(output, this, key, value);\n  }\n\n  sizeOfSlot(key: V, value: V): number {\n    return SlotWriter.sizeOf(this, key, value);\n  }\n\n  writeSlot(output: Output, key: V, value: V): Writer {\n    return SlotWriter.write(output, this, key, value);\n  }\n\n  abstract sizeOfBlockItem(item: I): number;\n\n  abstract writeBlockItem(output: Output, item: I): Writer;\n\n  sizeOfBlock(item: I): number;\n  sizeOfBlock(items: Cursor<I>, inBlock: boolean, inMarkup: boolean): number;\n  sizeOfBlock(item: I | Cursor<I>, inBlock?: boolean, inMarkup?: boolean): number {\n    if (arguments.length === 3) {\n      return BlockWriter.sizeOf(this, item as Cursor<I>, inBlock!, inMarkup!);\n    } else {\n      const items = this.items(item as I);\n      if (items.hasNext()) {\n        return BlockWriter.sizeOf(this, items, this.isBlockSafe(this.items(item as I)), false);\n      } else {\n        return 2; // \"{}\"\n      }\n    }\n  }\n\n  writeBlock(output: Output, item: I): Writer;\n  writeBlock(output: Output, items: Cursor<I>, inBlock: boolean, inMarkup: boolean): Writer;\n  writeBlock(output: Output, item: I | Cursor<I>, inBlock?: boolean, inMarkup?: boolean): Writer {\n    if (arguments.length === 4) {\n      return BlockWriter.write(output, this, item as Cursor<I>, inBlock!, inMarkup!);\n    } else {\n      const items = this.items(item as I);\n      if (items.hasNext()) {\n        return BlockWriter.write(output, this, items, this.isBlockSafe(this.items(item as I)), false);\n      } else {\n        return Unicode.writeString(output, \"{}\");\n      }\n    }\n  }\n\n  sizeOfRecord(item: I): number {\n    const items = this.items(item);\n    if (items.hasNext()) {\n      return BlockWriter.sizeOf(this, items, false, false);\n    } else {\n      return 2; // \"{}\"\n    }\n  }\n\n  writeRecord(output: Output, item: I): Writer {\n    const items = this.items(item);\n    if (items.hasNext()) {\n      return BlockWriter.write(output, this, items, false, false);\n    } else {\n      return Unicode.writeString(output, \"{}\");\n    }\n  }\n\n  sizeOfPrimary(value: V): number {\n    if (this.isRecord(this.item(value))) {\n      const items = this.items(this.item(value));\n      if (items.hasNext()) {\n        return PrimaryWriter.sizeOf(this, items);\n      }\n    } else if (!this.isExtant(this.item(value))) {\n      return this.sizeOfValue(value);\n    }\n    return 2; // \"()\"\n  }\n\n  writePrimary(output: Output, value: V): Writer {\n    if (this.isRecord(this.item(value))) {\n      const items = this.items(this.item(value));\n      if (items.hasNext()) {\n        return PrimaryWriter.write(output, this, items);\n      }\n    } else if (!this.isExtant(this.item(value))) {\n      return this.writeValue(output, value);\n    }\n    return Unicode.writeString(output, \"()\");\n  }\n\n  isBlockSafe(items: Cursor<I>): boolean {\n    while (items.hasNext()) {\n      if (this.isAttr(items.next().value!)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  isMarkupSafe(items: Cursor<I>): boolean {\n    if (!items.hasNext() || !this.isAttr(items.next().value!)) {\n      return false;\n    }\n    while (items.hasNext()) {\n      if (this.isAttr(items.next().value!)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  sizeOfMarkupText(item: I | string): number {\n    if (typeof item !== \"string\") {\n      item = this.string(item);\n    }\n    return MarkupTextWriter.sizeOf(item);\n  }\n\n  writeMarkupText(output: Output, item: I | string): Writer {\n    if (typeof item !== \"string\") {\n      item = this.string(item);\n    }\n    return MarkupTextWriter.write(output, item);\n  }\n\n  sizeOfData(length: number): number {\n    return DataWriter.sizeOf(length);\n  }\n\n  writeData(output: Output, value: Uint8Array | undefined): Writer {\n    if (value !== void 0) {\n      return DataWriter.write(output, value);\n    } else {\n      return Unicode.writeString(output, \"%\");\n    }\n  }\n\n  isIdent(value: I | string): boolean {\n    if (typeof value !== \"string\") {\n      value = this.string(value);\n    }\n    const n = value.length;\n    let c: number | undefined;\n    if (n === 0 || (c = value.codePointAt(0), c !== void 0 && !Recon.isIdentStartChar(c))) {\n      return false;\n    }\n    for (let i = Strings.offsetByCodePoints(value, 0, 1); i < n; i = Strings.offsetByCodePoints(value, i, 1)) {\n      c = value.codePointAt(i);\n      if (c === void 0 || !Recon.isIdentChar(c)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  sizeOfText(value: string): number {\n    if (this.isIdent(value)) {\n      return IdentWriter.sizeOf(value);\n    } else {\n      return StringWriter.sizeOf(value);\n    }\n  }\n\n  writeText(output: Output, value: string): Writer {\n    if (this.isIdent(value)) {\n      return IdentWriter.write(output, value);\n    } else {\n      return StringWriter.write(output, value);\n    }\n  }\n\n  sizeOfNum(value: number): number {\n    if (isFinite(value) && Math.floor(value) === value && Math.abs(value) < 2147483648) {\n      let size = Base10.countDigits(value);\n      if (value < 0) {\n        size += 1;\n      }\n      return size;\n    } else {\n      return (\"\" + value).length;\n    }\n  }\n\n  writeNum(output: Output, value: number): Writer {\n    if (isFinite(value) && Math.floor(value) === value && Math.abs(value) < 2147483648) {\n      return Base10.writeInteger(output, value);\n    } else {\n      return Unicode.writeString(output, \"\" + value);\n    }\n  }\n\n  sizeOfUint32(value: number): number {\n    return 10;\n  }\n\n  writeUint32(output: Output, value: number): Writer {\n    return Base16.lowercase.writeIntegerLiteral(output, value, 8);\n  }\n\n  sizeOfUint64(value: number): number {\n    return 18;\n  }\n\n  writeUint64(output: Output, value: number): Writer {\n    return Base16.lowercase.writeIntegerLiteral(output, value, 16);\n  }\n\n  sizeOfBool(value: boolean): number {\n    return value ? 4 : 5;\n  }\n\n  writeBool(output: Output, value: boolean): Writer {\n    return Unicode.writeString(output, value ? \"true\" : \"false\");\n  }\n\n  sizeOfLambdaFunc(bindings: V, template: V): number {\n    return LambdaFuncWriter.sizeOf(this, bindings, template);\n  }\n\n  writeLambdaFunc(output: Output, bindings: V, template: V): Writer {\n    return LambdaFuncWriter.write(output, this, bindings, template);\n  }\n\n  sizeOfConditionalOperator(ifTerm: I, thenTerm: I, elseTerm: I, precedence: number): number {\n    return ConditionalOperatorWriter.sizeOf(this, ifTerm, thenTerm, elseTerm, precedence);\n  }\n\n  writeConditionalOperator(output: Output, ifTerm: I, thenTerm: I, elseTerm: I, precedence: number): Writer {\n    return ConditionalOperatorWriter.write(output, this, ifTerm, thenTerm, elseTerm, precedence);\n  }\n\n  sizeOfInfixOperator(lhs: I, operator: string, rhs: I, precedence: number): number {\n    return InfixOperatorWriter.sizeOf(this, lhs, operator, rhs, precedence);\n  }\n\n  writeInfixOperator(output: Output, lhs: I, operator: string, rhs: I, precedence: number): Writer {\n    return InfixOperatorWriter.write(output, this, lhs, operator, rhs, precedence);\n  }\n\n  sizeOfPrefixOperator(operator: string, rhs: I, precedence: number): number {\n    return PrefixOperatorWriter.sizeOf(this, operator, rhs, precedence);\n  }\n\n  writePrefixOperator(output: Output, operator: string, rhs: I, precedence: number): Writer {\n    return PrefixOperatorWriter.write(output, this, operator, rhs, precedence);\n  }\n\n  sizeOfInvokeOperator(func: V, args: V): number {\n    return InvokeOperatorWriter.sizeOf(this, func, args);\n  }\n\n  writeInvokeOperator(output: Output, func: V, args: V): Writer {\n    return InvokeOperatorWriter.write(output, this, func, args);\n  }\n\n  abstract sizeOfThen(then: V): number;\n\n  abstract writeThen(output: Output, then: V): Writer;\n\n  sizeOfIdentitySelector(): number {\n    return 0;\n  }\n\n  writeIdentitySelector(output: Output): Writer {\n    return Writer.end();\n  }\n\n  sizeOfThenIdentitySelector(): number {\n    return 0;\n  }\n\n  writeThenIdentitySelector(output: Output): Writer {\n    return Writer.end();\n  }\n\n  sizeOfLiteralSelector(item: I, then: V): number {\n    return LiteralSelectorWriter.sizeOf(this, item, then);\n  }\n\n  writeLiteralSelector(output: Output, item: I, then: V): Writer {\n    return LiteralSelectorWriter.write(output, this, item, then);\n  }\n\n  sizeOfThenLiteralSelector(item: I, then: V): number {\n    return 0;\n  }\n\n  writeThenLiteralSelector(output: Output, item: I, then: V): Writer {\n    return Writer.end();\n  }\n\n  sizeOfGetSelector(key: V, then: V): number {\n    return GetSelectorWriter.sizeOf(this, key, then);\n  }\n\n  writeGetSelector(output: Output, key: V, then: V): Writer {\n    return GetSelectorWriter.write(output, this, key, then);\n  }\n\n  sizeOfThenGetSelector(key: V, then: V): number {\n    return GetSelectorWriter.sizeOf(this, key, then);\n  }\n\n  writeThenGetSelector(output: Output, key: V, then: V): Writer {\n    return GetSelectorWriter.writeThen(output, this, key, then);\n  }\n\n  sizeOfGetAttrSelector(key: V, then: V): number {\n    return GetAttrSelectorWriter.sizeOf(this, key, then);\n  }\n\n  writeGetAttrSelector(output: Output, key: V, then: V): Writer {\n    return GetAttrSelectorWriter.write(output, this, key, then);\n  }\n\n  sizeOfThenGetAttrSelector(key: V, then: V): number {\n    return GetAttrSelectorWriter.sizeOf(this, key, then);\n  }\n\n  writeThenGetAttrSelector(output: Output, key: V, then: V): Writer {\n    return GetAttrSelectorWriter.writeThen(output, this, key, then);\n  }\n\n  sizeOfGetItemSelector(index: V, then: V): number {\n    return GetItemSelectorWriter.sizeOf(this, index, then);\n  }\n\n  writeGetItemSelector(output: Output, index: V, then: V): Writer {\n    return GetItemSelectorWriter.write(output, this, index, then);\n  }\n\n  sizeOfThenGetItemSelector(index: V, then: V): number {\n    return GetItemSelectorWriter.sizeOfThen(this, index, then);\n  }\n\n  writeThenGetItemSelector(output: Output, index: V, then: V): Writer {\n    return GetItemSelectorWriter.writeThen(output, this, index, then);\n  }\n\n  sizeOfKeysSelector(then: V): number {\n    return KeysSelectorWriter.sizeOf(this, then);\n  }\n\n  writeKeysSelector(output: Output, then: V): Writer {\n    return KeysSelectorWriter.write(output, this, then);\n  }\n\n  sizeOfThenKeysSelector(then: V): number {\n    return KeysSelectorWriter.sizeOf(this, then);\n  }\n\n  writeThenKeysSelector(output: Output, then: V): Writer {\n    return KeysSelectorWriter.writeThen(output, this, then);\n  }\n\n  sizeOfValuesSelector(then: V): number {\n    return ValuesSelectorWriter.sizeOf(this, then);\n  }\n\n  writeValuesSelector(output: Output, then: V): Writer {\n    return ValuesSelectorWriter.write(output, this, then);\n  }\n\n  sizeOfThenValuesSelector(then: V): number {\n    return ValuesSelectorWriter.sizeOf(this, then);\n  }\n\n  writeThenValuesSelector(output: Output, then: V): Writer {\n    return ValuesSelectorWriter.writeThen(output, this, then);\n  }\n\n  sizeOfChildrenSelector(then: V): number {\n    return ChildrenSelectorWriter.sizeOf(this, then);\n  }\n\n  writeChildrenSelector(output: Output, then: V): Writer {\n    return ChildrenSelectorWriter.write(output, this, then);\n  }\n\n  sizeOfThenChildrenSelector(then: V): number {\n    return ChildrenSelectorWriter.sizeOf(this, then);\n  }\n\n  writeThenChildrenSelector(output: Output, then: V): Writer {\n    return ChildrenSelectorWriter.writeThen(output, this, then);\n  }\n\n  sizeOfDescendantsSelector(then: V): number {\n    return DescendantsSelectorWriter.sizeOf(this, then);\n  }\n\n  writeDescendantsSelector(output: Output, then: V): Writer {\n    return DescendantsSelectorWriter.write(output, this, then);\n  }\n\n  sizeOfThenDescendantsSelector(then: V): number {\n    return DescendantsSelectorWriter.sizeOf(this, then);\n  }\n\n  writeThenDescendantsSelector(output: Output, then: V): Writer {\n    return DescendantsSelectorWriter.writeThen(output, this, then);\n  }\n\n  sizeOfFilterSelector(predicate: V, then: V): number {\n    return FilterSelectorWriter.sizeOf(this, predicate, then);\n  }\n\n  writeFilterSelector(output: Output, predicate: V, then: V): Writer {\n    return FilterSelectorWriter.write(output, this, predicate, then);\n  }\n\n  sizeOfThenFilterSelector(predicate: V, then: V): number {\n    return FilterSelectorWriter.sizeOfThen(this, predicate, then);\n  }\n\n  writeThenFilterSelector(output: Output, predicate: V, then: V): Writer {\n    return FilterSelectorWriter.writeThen(output, this, predicate, then);\n  }\n\n  sizeOfExtant(): number {\n    return 0;\n  }\n\n  writeExtant(output: Output): Writer {\n    return Writer.end();\n  }\n\n  sizeOfAbsent(): number {\n    return 0;\n  }\n\n  writeAbsent(output: Output): Writer {\n    return Writer.end();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {Output, WriterException, Writer} from \"@swim/codec\";\nimport {\n  Item,\n  Field,\n  Attr,\n  Slot,\n  Value,\n  Record,\n  Data,\n  Text,\n  Num,\n  Bool,\n  Expression,\n  Operator,\n  Selector,\n  Func,\n  Extant,\n  Absent,\n  ChildrenSelector,\n  DescendantsSelector,\n  FilterSelector,\n  GetAttrSelector,\n  GetItemSelector,\n  GetSelector,\n  IdentitySelector,\n  KeysSelector,\n  LiteralSelector,\n  ValuesSelector,\n  BinaryOperator,\n  ConditionalOperator,\n  InvokeOperator,\n  UnaryOperator,\n  BridgeFunc,\n  LambdaFunc,\n} from \"@swim/structure\";\nimport {ReconWriter} from \"./ReconWriter\";\n\n/** @public */\nexport class ReconStructureWriter extends ReconWriter<Item, Value> {\n  override isField(item: Item): boolean {\n    return item instanceof Field;\n  }\n\n  override isAttr(item: Item): boolean {\n    return item instanceof Attr;\n  }\n\n  override isSlot(item: Item): boolean {\n    return item instanceof Slot;\n  }\n\n  override isValue(item: Item): boolean {\n    return item instanceof Value;\n  }\n\n  override isRecord(item: Item): boolean {\n    return item instanceof Record;\n  }\n\n  override isText(item: Item): boolean {\n    return item instanceof Text;\n  }\n\n  override isNum(item: Item): boolean {\n    return item instanceof Num;\n  }\n\n  override isBool(item: Item): boolean {\n    return item instanceof Bool;\n  }\n\n  override isExpression(item: Item): boolean {\n    return item instanceof Expression;\n  }\n\n  override isExtant(item: Item): boolean {\n    return item instanceof Extant;\n  }\n\n  override items(item: Item): Cursor<Item> {\n    return item.iterator();\n  }\n\n  override item(value: Value): Item {\n    return value;\n  }\n\n  override key(item: Item): Value {\n    return item.key;\n  }\n\n  override value(item: Item): Value {\n    return item.toValue();\n  }\n\n  override string(item: Item): string {\n    return item.stringValue(\"\");\n  }\n\n  override precedence(item: Item): number {\n    return item.precedence;\n  }\n\n  override sizeOfItem(item: Item): number {\n    if (item instanceof Field) {\n      if (item instanceof Attr) {\n        return this.sizeOfAttr(item.key, item.value);\n      } else if (item instanceof Slot) {\n        return this.sizeOfSlot(item.key, item.value);\n      }\n    } else if (item instanceof Value) {\n      return this.sizeOfValue(item);\n    }\n    throw new WriterException(\"No Recon serialization for \" + item);\n  }\n\n  override writeItem(output: Output, item: Item): Writer {\n    if (item instanceof Field) {\n      if (item instanceof Attr) {\n        return this.writeAttr(output, item.key, item.value);\n      } else if (item instanceof Slot) {\n        return this.writeSlot(output, item.key, item.value);\n      }\n    } else if (item instanceof Value) {\n      return this.writeValue(output, item);\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + item));\n  }\n\n  override sizeOfValue(value: Value): number {\n    if (value instanceof Record) {\n      return this.sizeOfRecord(value);\n    } else if (value instanceof Data) {\n      return this.sizeOfData(value.size);\n    } else if (value instanceof Text) {\n      return this.sizeOfText(value.value);\n    } else if (value instanceof Num) {\n      if (value.isUint32()) {\n        return this.sizeOfUint32(value.value);\n      } else if (value.isUint64()) {\n        return this.sizeOfUint64(value.value);\n      } else {\n        return this.sizeOfNum(value.value);\n      }\n    } else if (value instanceof Bool) {\n      return this.sizeOfBool(value.value);\n    } else if (value instanceof Selector) {\n      return this.sizeOfSelector(value);\n    } else if (value instanceof Operator) {\n      return this.sizeOfOperator(value);\n    } else if (value instanceof Func) {\n      return this.sizeOfFunc(value);\n    } else if (value instanceof Extant) {\n      return this.sizeOfExtant();\n    } else if (value instanceof Absent) {\n      return this.sizeOfAbsent();\n    }\n    throw new WriterException(\"No Recon serialization for \" + value);\n  }\n\n  override writeValue(output: Output, value: Value): Writer {\n    if (value instanceof Record) {\n      return this.writeRecord(output, value);\n    } else if (value instanceof Data) {\n      return this.writeData(output, value.asUint8Array());\n    } else if (value instanceof Text) {\n      return this.writeText(output, value.value);\n    } else if (value instanceof Num) {\n      if (value.isUint32()) {\n        return this.writeUint32(output, value.value);\n      } else if (value.isUint64()) {\n        return this.writeUint64(output, value.value);\n      } else {\n        return this.writeNum(output, value.value);\n      }\n    } else if (value instanceof Bool) {\n      return this.writeBool(output, value.value);\n    } else if (value instanceof Selector) {\n      return this.writeSelector(output, value);\n    } else if (value instanceof Operator) {\n      return this.writeOperator(output, value);\n    } else if (value instanceof Func) {\n      return this.writeFunc(output, value);\n    } else if (value instanceof Extant) {\n      return this.writeExtant(output);\n    } else if (value instanceof Absent) {\n      return this.writeAbsent(output);\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + value));\n  }\n\n  sizeOfSelector(selector: Selector): number {\n    if (selector instanceof IdentitySelector) {\n      return this.sizeOfIdentitySelector();\n    } else if (selector instanceof LiteralSelector) {\n      return this.sizeOfLiteralSelector(selector.item, selector.then);\n    } else if (selector instanceof GetSelector) {\n      return this.sizeOfGetSelector(selector.item, selector.then);\n    } else if (selector instanceof GetAttrSelector) {\n      return this.sizeOfGetAttrSelector(selector.item, selector.then);\n    } else if (selector instanceof GetItemSelector) {\n      return this.sizeOfGetItemSelector(selector.item, selector.then);\n    } else if (selector instanceof KeysSelector) {\n      return this.sizeOfKeysSelector(selector.then);\n    } else if (selector instanceof ValuesSelector) {\n      return this.sizeOfValuesSelector(selector.then);\n    } else if (selector instanceof ChildrenSelector) {\n      return this.sizeOfChildrenSelector(selector.then);\n    } else if (selector instanceof DescendantsSelector) {\n      return this.sizeOfDescendantsSelector(selector.then);\n    } else if (selector instanceof FilterSelector) {\n      return this.sizeOfFilterSelector(selector.predicate, selector.then);\n    }\n    throw new WriterException(\"No Recon serialization for \" + selector);\n  }\n\n  writeSelector(output: Output, selector: Selector): Writer {\n    if (selector instanceof IdentitySelector) {\n      return this.writeIdentitySelector(output);\n    } else if (selector instanceof LiteralSelector) {\n      return this.writeLiteralSelector(output, selector.item, selector.then);\n    } else if (selector instanceof GetSelector) {\n      return this.writeGetSelector(output, selector.item, selector.then);\n    } else if (selector instanceof GetAttrSelector) {\n      return this.writeGetAttrSelector(output, selector.item, selector.then);\n    } else if (selector instanceof GetItemSelector) {\n      return this.writeGetItemSelector(output, selector.item, selector.then);\n    } else if (selector instanceof KeysSelector) {\n      return this.writeKeysSelector(output, selector.then);\n    } else if (selector instanceof ValuesSelector) {\n      return this.writeValuesSelector(output, selector.then);\n    } else if (selector instanceof ChildrenSelector) {\n      return this.writeChildrenSelector(output, selector.then);\n    } else if (selector instanceof DescendantsSelector) {\n      return this.writeDescendantsSelector(output, selector.then);\n    } else if (selector instanceof FilterSelector) {\n      return this.writeFilterSelector(output, selector.predicate, selector.then);\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + selector));\n  }\n\n  sizeOfOperator(operator: Operator): number {\n    if (operator instanceof BinaryOperator) {\n      return this.sizeOfInfixOperator(operator.operand1, operator.operator, operator.operand2, operator.precedence);\n    } else if (operator instanceof UnaryOperator) {\n      return this.sizeOfPrefixOperator(operator.operator, operator.operand, operator.precedence);\n    } else if (operator instanceof InvokeOperator) {\n      return this.sizeOfInvokeOperator(operator.func, operator.args);\n    } else if (operator instanceof ConditionalOperator) {\n      return this.sizeOfConditionalOperator(operator.ifTerm, operator.thenTerm, operator.elseTerm, operator.precedence);\n    }\n    throw new WriterException(\"No Recon serialization for \" + operator);\n  }\n\n  writeOperator(output: Output, operator: Operator): Writer {\n    if (operator instanceof BinaryOperator) {\n      return this.writeInfixOperator(output, operator.operand1, operator.operator, operator.operand2, operator.precedence);\n    } else if (operator instanceof UnaryOperator) {\n      return this.writePrefixOperator(output, operator.operator, operator.operand, operator.precedence);\n    } else if (operator instanceof InvokeOperator) {\n      return this.writeInvokeOperator(output, operator.func, operator.args);\n    } else if (operator instanceof ConditionalOperator) {\n      return this.writeConditionalOperator(output, operator.ifTerm, operator.thenTerm, operator.elseTerm, operator.precedence);\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + operator));\n  }\n\n  sizeOfFunc(func: Func): number {\n    if (func instanceof LambdaFunc) {\n      return this.sizeOfLambdaFunc(func.bindings, func.template);\n    } else if (func instanceof BridgeFunc) {\n      return 0;\n    }\n    throw new WriterException(\"No Recon serialization for \" + func);\n  }\n\n  writeFunc(output: Output, func: Func): Writer {\n    if (func instanceof LambdaFunc) {\n      return this.writeLambdaFunc(output, func.bindings, func.template);\n    } else if (func instanceof BridgeFunc) {\n      return Writer.end();\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + func));\n  }\n\n  override sizeOfBlockItem(item: Item): number {\n    if (item instanceof Field) {\n      return this.sizeOfItem(item);\n    } else if (item instanceof Value) {\n      return this.sizeOfBlockValue(item);\n    }\n    throw new WriterException(\"No Recon serialization for \" + item);\n  }\n\n  override writeBlockItem(output: Output, item: Item): Writer {\n    if (item instanceof Field) {\n      return this.writeItem(output, item);\n    } else if (item instanceof Value) {\n      return this.writeBlockValue(output, item);\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + item));\n  }\n\n  override sizeOfBlockValue(value: Value): number {\n    if (value instanceof Record) {\n      return this.sizeOfBlock(value);\n    }\n    return this.sizeOfValue(value);\n  }\n\n  override writeBlockValue(output: Output, value: Value): Writer {\n    if (value instanceof Record) {\n      return this.writeBlock(output, value);\n    }\n    return this.writeValue(output, value);\n  }\n\n  override sizeOfThen(then: Value): number {\n    if (then instanceof Selector) {\n      if (then instanceof IdentitySelector) {\n        return this.sizeOfThenIdentitySelector();\n      } else if (then instanceof LiteralSelector) {\n        return this.sizeOfThenLiteralSelector(then.item, then.then);\n      } else if (then instanceof GetSelector) {\n        return this.sizeOfThenGetSelector(then.item, then.then);\n      } else if (then instanceof GetAttrSelector) {\n        return this.sizeOfThenGetAttrSelector(then.item, then.then);\n      } else if (then instanceof GetItemSelector) {\n        return this.sizeOfThenGetItemSelector(then.item, then.then);\n      } else if (then instanceof KeysSelector) {\n        return this.sizeOfThenKeysSelector(then.then);\n      } else if (then instanceof ValuesSelector) {\n        return this.sizeOfThenValuesSelector(then.then);\n      } else if (then instanceof ChildrenSelector) {\n        return this.sizeOfThenChildrenSelector(then.then);\n      } else if (then instanceof DescendantsSelector) {\n        return this.sizeOfThenDescendantsSelector(then.then);\n      } else if (then instanceof FilterSelector) {\n        return this.sizeOfThenFilterSelector(then.predicate, then.then);\n      }\n    }\n    throw new WriterException(\"No Recon serialization for \" + then);\n  }\n\n  override writeThen(output: Output, then: Value): Writer {\n    if (then instanceof Selector) {\n      if (then instanceof IdentitySelector) {\n        return this.writeThenIdentitySelector(output);\n      } else if (then instanceof LiteralSelector) {\n        return this.writeThenLiteralSelector(output, then.item, then.then);\n      } else if (then instanceof GetSelector) {\n        return this.writeThenGetSelector(output, then.item, then.then);\n      } else if (then instanceof GetAttrSelector) {\n        return this.writeThenGetAttrSelector(output, then.item, then.then);\n      } else if (then instanceof GetItemSelector) {\n        return this.writeThenGetItemSelector(output, then.item, then.then);\n      } else if (then instanceof KeysSelector) {\n        return this.writeThenKeysSelector(output, then.then);\n      } else if (then instanceof ValuesSelector) {\n        return this.writeThenValuesSelector(output, then.then);\n      } else if (then instanceof ChildrenSelector) {\n        return this.writeThenChildrenSelector(output, then.then);\n      } else if (then instanceof DescendantsSelector) {\n        return this.writeThenDescendantsSelector(output, then.then);\n      } else if (then instanceof FilterSelector) {\n        return this.writeThenFilterSelector(output, then.predicate, then.then);\n      }\n    }\n    return Writer.error(new WriterException(\"No Recon serialization for \" + then));\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Diagnostic} from \"@swim/codec\";\n\n/** @public */\nexport class UriException extends Error {\n  constructor(message?: Diagnostic | string) {\n    super(message instanceof Diagnostic ? message.message : message);\n    Object.setPrototypeOf(this, UriException.prototype);\n    this.diagnostic = message instanceof Diagnostic ? message : null;\n  }\n\n  readonly diagnostic!: Diagnostic | null;\n\n  override toString(): string {\n    if (this.diagnostic !== null) {\n      return this.diagnostic.toString();\n    } else {\n      return super.toString();\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Compare, Mutable, Strings} from \"@swim/util\";\nimport {Output, Format, Debug, Display, Base16} from \"@swim/codec\";\nimport type {Form} from \"@swim/structure\";\nimport {UriException} from \"./UriException\";\nimport {AnyUriScheme, UriScheme} from \"./\"; // forward import\nimport {AnyUriAuthority, UriAuthorityInit, UriAuthority} from \"./\"; // forward import\nimport type {AnyUriUser, UriUser} from \"./UriUser\";\nimport type {AnyUriHost, UriHost} from \"./UriHost\";\nimport type {AnyUriPort, UriPort} from \"./UriPort\";\nimport {AnyUriPath, UriPath} from \"./\"; // forward import\nimport {UriPathBuilder} from \"./\"; // forward import\nimport {AnyUriQuery, UriQuery} from \"./\"; // forward import\nimport {UriQueryBuilder} from \"./\"; // forward import\nimport {AnyUriFragment, UriFragment} from \"./\"; // forward import\nimport {UriForm} from \"./\"; // forward import\nimport {UriParser} from \"./\"; // forward import\n\n/** @public */\nexport type AnyUri = Uri | UriInit | string;\n\n/** @public */\nexport interface UriInit extends UriAuthorityInit {\n  scheme?: AnyUriScheme;\n  authority?: AnyUriAuthority;\n  path?: AnyUriPath;\n  query?: AnyUriQuery;\n  fragment?: AnyUriFragment;\n}\n\n/** @public */\nexport class Uri implements HashCode, Compare, Debug, Display {\n  /** @internal */\n  constructor(scheme: UriScheme, authority: UriAuthority, path: UriPath,\n              query: UriQuery, fragment: UriFragment) {\n    this.scheme = scheme;\n    this.authority = authority;\n    this.path = path;\n    this.query = query;\n    this.fragment = fragment;\n    this.hashValue = void 0;\n    this.stringValue = void 0;\n  }\n\n  isDefined(): boolean {\n    return this.scheme.isDefined() || this.authority.isDefined() || this.path.isDefined()\n        || this.query.isDefined() || this.fragment.isDefined();\n  }\n\n  isEmpty(): boolean {\n    return !this.scheme.isDefined() && !this.authority.isDefined() && this.path.isEmpty()\n        && !this.query.isDefined() && !this.fragment.isDefined();\n  }\n\n  readonly scheme: UriScheme;\n\n  withScheme(scheme: AnyUriScheme): Uri {\n    scheme = UriScheme.fromAny(scheme);\n    if (scheme !== this.scheme) {\n      return this.copy(scheme, this.authority, this.path, this.query, this.fragment);\n    } else {\n      return this;\n    }\n  }\n\n  get schemePart(): string {\n    return this.scheme.toString();\n  }\n\n  withSchemePart(schemePart: string): Uri {\n    return this.withScheme(UriScheme.parse(schemePart));\n  }\n\n  get schemeName(): string {\n    return this.scheme.name;\n  }\n\n  withSchemeName(schemeName: string): Uri {\n    return this.withScheme(UriScheme.create(schemeName));\n  }\n\n  readonly authority: UriAuthority;\n\n  withAuthority(authority: AnyUriAuthority): Uri {\n    authority = UriAuthority.fromAny(authority);\n    if (authority !== this.authority) {\n      return this.copy(this.scheme, authority as UriAuthority, this.path, this.query, this.fragment);\n    } else {\n      return this;\n    }\n  }\n\n  get authorityPart(): string {\n    return this.authority.toString();\n  }\n\n  withAuthorityPart(authorityPart: string): Uri {\n    return this.withAuthority(UriAuthority.parse(authorityPart));\n  }\n\n  get user(): UriUser {\n    return this.authority.user;\n  }\n\n  withUser(user: AnyUriUser): Uri {\n    return this.withAuthority(this.authority.withUser(user));\n  }\n\n  get userPart(): string {\n    return this.authority.userPart;\n  }\n\n  withUserPart(userPart: string): Uri {\n    return this.withAuthority(this.authority.withUserPart(userPart));\n  }\n\n  get username(): string | undefined {\n    return this.authority.username;\n  }\n\n  withUsername(username: string | undefined, password?: string): Uri {\n    if (arguments.length === 1) {\n      return this.withAuthority(this.authority.withUsername(username));\n    } else {\n      return this.withAuthority(this.authority.withUsername(username, password));\n    }\n  }\n\n  get password(): string | undefined {\n    return this.authority.password;\n  }\n\n  withPassword(password: string | undefined): Uri {\n    return this.withAuthority(this.authority.withPassword(password));\n  }\n\n  get host(): UriHost {\n    return this.authority.host;\n  }\n\n  withHost(host: AnyUriHost): Uri {\n    return this.withAuthority(this.authority.withHost(host));\n  }\n\n  get hostPart(): string {\n    return this.authority.hostPart;\n  }\n\n  withHostPart(hostPart: string): Uri {\n    return this.withAuthority(this.authority.withHostPart(hostPart));\n  }\n\n  get hostAddress(): string {\n    return this.authority.hostAddress;\n  }\n\n  get hostName(): string | undefined {\n    return this.authority.hostName;\n  }\n\n  withHostName(hostName: string): Uri {\n    return this.withAuthority(this.authority.withHostName(hostName));\n  }\n\n  get hostIPv4(): string | undefined {\n    return this.authority.hostIPv4;\n  }\n\n  withHostIPv4(hostIPv4: string): Uri {\n    return this.withAuthority(this.authority.withHostIPv4(hostIPv4));\n  }\n\n  get hostIPv6(): string | undefined {\n    return this.authority.hostIPv6;\n  }\n\n  withHostIPv6(hostIPv6: string): Uri {\n    return this.withAuthority(this.authority.withHostIPv6(hostIPv6));\n  }\n\n  get port(): UriPort {\n    return this.authority.port;\n  }\n\n  withPort(port: AnyUriPort): Uri {\n    return this.withAuthority(this.authority.withPort(port));\n  }\n\n  get portPart(): string {\n    return this.authority.portPart;\n  }\n\n  withPortPart(portPart: string): Uri {\n    return this.withAuthority(this.authority.withPortPart(portPart));\n  }\n\n  get portNumber(): number {\n    return this.authority.portNumber;\n  }\n\n  withPortNumber(portNumber: number): Uri {\n    return this.withAuthority(this.authority.withPortNumber(portNumber));\n  }\n\n  readonly path: UriPath;\n\n  withPath(...components: AnyUriPath[]): Uri {\n    const path = UriPath.of(...components);\n    if (path !== this.path) {\n      return this.copy(this.scheme, this.authority, path, this.query, this.fragment);\n    } else {\n      return this;\n    }\n  }\n\n  get pathPart(): string {\n    return this.path.toString();\n  }\n\n  withPathPart(pathPart: string): Uri {\n    return this.withPath(UriPath.parse(pathPart));\n  }\n\n  get pathName(): string {\n    return this.path.name;\n  }\n\n  withPathName(pathName: string): Uri {\n    return this.withPath(this.path.withName(pathName));\n  }\n\n  parentPath(): UriPath {\n    return this.path.parent();\n  }\n\n  basePath(): UriPath {\n    return this.path.base();\n  }\n\n  parent(): Uri {\n    return Uri.create(this.scheme, this.authority, this.path.parent());\n  }\n\n  base(): Uri {\n    return Uri.create(this.scheme, this.authority, this.path.base());\n  }\n\n  appendedPath(...components: AnyUriPath[]): Uri {\n    return this.withPath(this.path.appended(...components));\n  }\n\n  appendedSlash(): Uri {\n    return this.withPath(this.path.appendedSlash());\n  }\n\n  appendedSegment(segment: string): Uri {\n    return this.withPath(this.path.appendedSegment(segment));\n  }\n\n  prependedPath(...components: AnyUriPath[]): Uri {\n    return this.withPath(this.path.prepended(...components));\n  }\n\n  prependedSlash(): Uri {\n    return this.withPath(this.path.prependedSlash());\n  }\n\n  prependedSegment(segment: string): Uri {\n    return this.withPath(this.path.prependedSegment(segment));\n  }\n\n  readonly query: UriQuery;\n\n  withQuery(query: AnyUriQuery): Uri {\n    query = UriQuery.fromAny(query);\n    if (query !== this.query) {\n      return this.copy(this.scheme, this.authority, this.path, query, this.fragment);\n    } else {\n      return this;\n    }\n  }\n\n  get queryPart(): string {\n    return this.query.toString();\n  }\n\n  withQueryPart(query: string): Uri {\n    return this.withQuery(UriQuery.parse(query));\n  }\n\n  updatedQuery(key: string, value: string): Uri {\n    return this.withQuery(this.query.updated(key, value));\n  }\n\n  removedQuery(key: string): Uri {\n    return this.withQuery(this.query.removed(key));\n  }\n\n  appendedQuery(key: string | undefined, value: string): Uri;\n  appendedQuery(params: AnyUriQuery): Uri;\n  appendedQuery(key: AnyUriQuery | undefined, value?: string): Uri {\n    return this.withQuery(this.query.appended(key as any, value as any));\n  }\n\n  prependedQuery(key: string | undefined, value: string): Uri;\n  prependedQuery(params: AnyUriQuery): Uri;\n  prependedQuery(key: AnyUriQuery | undefined, value?: string): Uri {\n    return this.withQuery(this.query.prepended(key as any, value as any));\n  }\n\n  readonly fragment: UriFragment;\n\n  withFragment(fragment: AnyUriFragment): Uri {\n    fragment = UriFragment.fromAny(fragment);\n    if (fragment !== this.fragment) {\n      return Uri.create(this.scheme, this.authority, this.path, this.query, fragment);\n    } else {\n      return this;\n    }\n  }\n\n  get fragmentPart(): string {\n    return this.fragment.toString();\n  }\n\n  withFragmentPart(fragmentPart: string): Uri {\n    return this.withFragment(UriFragment.parse(fragmentPart));\n  }\n\n  get fragmentIdentifier(): string | undefined {\n    return this.fragment.identifier;\n  }\n\n  withFragmentIdentifier(fragmentIdentifier: string | undefined): Uri {\n    return this.withFragment(UriFragment.create(fragmentIdentifier));\n  }\n\n  endpoint(): Uri {\n    if (this.path.isDefined() || this.query.isDefined() || this.fragment.isDefined()) {\n      return Uri.create(this.scheme, this.authority);\n    } else {\n      return this;\n    }\n  }\n\n  resolve(relative: AnyUri): Uri {\n    const that = Uri.fromAny(relative);\n    if (that.scheme.isDefined()) {\n      return this.copy(that.scheme,\n                       that.authority,\n                       that.path.removeDotSegments(),\n                       that.query,\n                       that.fragment);\n    } else if (that.authority.isDefined()) {\n      return this.copy(this.scheme,\n                       that.authority,\n                       that.path.removeDotSegments(),\n                       that.query,\n                       that.fragment);\n    } else if (that.path.isEmpty()) {\n      return this.copy(this.scheme,\n                       this.authority,\n                       this.path,\n                       that.query.isDefined() ? that.query : this.query,\n                       that.fragment);\n    } else if (that.path.isAbsolute()) {\n      return this.copy(this.scheme,\n                       this.authority,\n                       that.path.removeDotSegments(),\n                       that.query,\n                       that.fragment);\n    } else {\n      return this.copy(this.scheme,\n                       this.authority,\n                       this.merge(that.path).removeDotSegments(),\n                       that.query,\n                       that.fragment);\n    }\n  }\n\n  /** @internal */\n  merge(relative: UriPath): UriPath {\n    if (this.authority.isDefined() && this.path.isEmpty()) {\n      return relative.prependedSlash();\n    } else if (this.path.isEmpty()) {\n      return relative;\n    } else {\n      return this.path.merge(relative);\n    }\n  }\n\n  unresolve(absolute: AnyUri): Uri {\n    const that = Uri.fromAny(absolute);\n    if (!this.scheme.equals(that.scheme) || !this.authority.equals(that.authority)) {\n      return that;\n    } else {\n      return Uri.create(UriScheme.undefined(),\n                        UriAuthority.undefined(),\n                        this.path.unmerge(that.path),\n                        that.query,\n                        that.fragment);\n    }\n  }\n\n  protected copy(scheme: UriScheme, authority: UriAuthority, path: UriPath,\n                 query: UriQuery, fragment: UriFragment): Uri {\n    return Uri.create(scheme, authority, path, query, fragment);\n  }\n\n  toAny(): {scheme?: string, username?: string, password?: string, host?: string,\n            port?: number, path: string[], query?: {[key: string]: string},\n            fragment?: string} {\n    const uri = {} as {scheme?: string, username?: string, password?: string, host?: string,\n                       port?: number, path: string[], query?: {[key: string]: string},\n                       fragment?: string};\n    uri.scheme = this.scheme.toAny();\n    this.authority.toAny(uri);\n    uri.path = this.path.toAny();\n    uri.query = this.query.toAny();\n    uri.fragment = this.fragment.toAny();\n    return uri;\n  }\n\n  compareTo(that: Uri): number {\n    if (that instanceof Uri) {\n      return this.toString().localeCompare(that.toString());\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof Uri) {\n      return this.toString() === that.toString();\n    }\n    return false;\n  }\n\n  /** @internal */\n  readonly hashValue: number | undefined;\n\n  hashCode(): number {\n    let hashValue = this.hashValue;\n    if (hashValue === void 0) {\n      hashValue = Strings.hash(this.toString());\n      (this as Mutable<this>).hashValue = hashValue;\n    }\n    return hashValue;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Uri\").write(46/*'.'*/);\n    if (this.isDefined()) {\n      output = output.write(\"parse\").write(40/*'('*/).write(34/*'\"'*/).display(this).write(34/*'\"'*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"empty\").write(40/*'('*/).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  display<T>(output: Output<T>): Output<T> {\n    const stringValue = this.stringValue;\n    if (stringValue !== void 0) {\n      output = output.write(stringValue);\n    } else {\n      if (this.scheme.isDefined()) {\n        output = output.display(this.scheme).write(58/*':'*/);\n      }\n      if (this.authority.isDefined()) {\n        output = output.write(47/*'/'*/).write(47/*'/'*/).display(this.authority);\n      }\n      output = output.display(this.path);\n      if (this.query.isDefined()) {\n        output = output.write(63/*'?'*/).display(this.query);\n      }\n      if (this.fragment.isDefined()) {\n        output = output.write(35/*'#'*/).display(this.fragment);\n      }\n    }\n    return output;\n  }\n\n  toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = Format.display(this);\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  @Lazy\n  static empty(): Uri {\n    return new Uri(UriScheme.undefined(), UriAuthority.undefined(), UriPath.empty(),\n                   UriQuery.undefined(), UriFragment.undefined());\n  }\n\n  static create(scheme: UriScheme = UriScheme.undefined(),\n                authority: UriAuthority = UriAuthority.undefined(),\n                path: UriPath = UriPath.empty(),\n                query: UriQuery = UriQuery.undefined(),\n                fragment: UriFragment = UriFragment.undefined()): Uri {\n    if (scheme.isDefined() || authority.isDefined() || path.isDefined() ||\n        query.isDefined() || fragment.isDefined()) {\n      return new Uri(scheme, authority, path, query, fragment);\n    } else {\n      return Uri.empty();\n    }\n  }\n\n  static fromInit(init: UriInit): Uri {\n    const scheme = UriScheme.fromAny(init.scheme);\n    const authority = UriAuthority.fromAny(init.authority !== void 0 ? init.authority : init);\n    const path = UriPath.fromAny(init.path);\n    const query = UriQuery.fromAny(init.query);\n    const fragment = UriFragment.fromAny(init.fragment);\n    if (scheme.isDefined() || authority.isDefined() || path.isDefined() ||\n        query.isDefined() || fragment.isDefined()) {\n      return new Uri(scheme, authority, path, query, fragment);\n    } else {\n      return Uri.empty();\n    }\n  }\n\n  static fromAny(value: AnyUri | null | undefined): Uri {\n    if (value === void 0 || value === null) {\n      return Uri.empty();\n    } else if (value instanceof Uri) {\n      return value;\n    } else if (typeof value === \"object\") {\n      return Uri.fromInit(value);\n    } else if (typeof value === \"string\") {\n      return Uri.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static scheme(scheme: AnyUriScheme): Uri {\n    scheme = UriScheme.fromAny(scheme);\n    return Uri.create(scheme, void 0, void 0, void 0, void 0);\n  }\n\n  static schemePart(schemePart: string): Uri {\n    const scheme = UriScheme.parse(schemePart);\n    return Uri.create(scheme, void 0, void 0, void 0, void 0);\n  }\n\n  static schemeName(name: string): Uri {\n    const scheme = UriScheme.create(name);\n    return Uri.create(scheme, void 0, void 0, void 0, void 0);\n  }\n\n  static authority(authority: AnyUriAuthority): Uri {\n    authority = UriAuthority.fromAny(authority);\n    return Uri.create(void 0, authority as UriAuthority, void 0, void 0, void 0);\n  }\n\n  static authorityPart(authorityPart: string): Uri {\n    const authority = UriAuthority.parse(authorityPart);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static user(user: AnyUriUser): Uri {\n    const authority = UriAuthority.user(user);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static userPart(userPart: string): Uri {\n    const authority = UriAuthority.userPart(userPart);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static username(username: string, password?: string): Uri {\n    const authority = UriAuthority.username(username, password);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static password(password: string): Uri {\n    const authority = UriAuthority.password(password);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static host(host: AnyUriHost): Uri {\n    const authority = UriAuthority.host(host);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static hostPart(hostPart: string): Uri {\n    const authority = UriAuthority.hostPart(hostPart);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static hostName(hostName: string): Uri {\n    const authority = UriAuthority.hostName(hostName);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static hostIPv4(hostIPv4: string): Uri {\n    const authority = UriAuthority.hostIPv4(hostIPv4);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static hostIPv6(hostIPv6: string): Uri {\n    const authority = UriAuthority.hostIPv6(hostIPv6);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static port(port: AnyUriPort): Uri {\n    const authority = UriAuthority.port(port);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static portPart(portPart: string): Uri {\n    const authority = UriAuthority.portPart(portPart);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static portNumber(portNumber: number): Uri {\n    const authority = UriAuthority.portNumber(portNumber);\n    return Uri.create(void 0, authority, void 0, void 0, void 0);\n  }\n\n  static path(...components: AnyUriPath[]): Uri {\n    const path = UriPath.of(...components);\n    return Uri.create(void 0, void 0, path, void 0, void 0);\n  }\n\n  static pathPart(pathPart: string): Uri {\n    const path = UriPath.parse(pathPart);\n    return Uri.create(void 0, void 0, path, void 0, void 0);\n  }\n\n  static query(query: AnyUriQuery): Uri {\n    query = UriQuery.fromAny(query);\n    return Uri.create(void 0, void 0, void 0, query, void 0);\n  }\n\n  static queryPart(queryPart: string): Uri {\n    const query = UriQuery.parse(queryPart);\n    return Uri.create(void 0, void 0, void 0, query, void 0);\n  }\n\n  static fragment(fragment: AnyUriFragment): Uri {\n    fragment = UriFragment.fromAny(fragment);\n    return Uri.create(void 0, void 0, void 0, void 0, fragment);\n  }\n\n  static fragmentPart(fragmentPart: string): Uri {\n    const fragment = UriFragment.parse(fragmentPart);\n    return Uri.create(void 0, void 0, void 0, void 0, fragment);\n  }\n\n  static fragmentIdentifier(fragmentIdentifier: string | undefined): Uri {\n    const fragment = UriFragment.create(fragmentIdentifier);\n    return Uri.create(void 0, void 0, void 0, void 0, fragment);\n  }\n\n  @Lazy\n  static get standardParser(): UriParser {\n    return new UriParser();\n  }\n\n  static parse(string: string): Uri {\n    return Uri.standardParser.parseAbsoluteString(string);\n  }\n\n  static pathBuilder(): UriPathBuilder {\n    return new UriPathBuilder();\n  }\n\n  static queryBuilder(): UriQueryBuilder {\n    return new UriQueryBuilder();\n  }\n\n  @Lazy\n  static form(): Form<Uri, AnyUri> {\n    return new UriForm(Uri.empty());\n  }\n\n  /** @internal */\n  static isUnreservedChar(c: number): boolean {\n    return c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c === 45/*'-'*/ || c === 46/*'.'*/\n        || c === 95/*'_'*/ || c === 126/*'~'*/;\n  }\n\n  /** @internal */\n  static isSubDelimChar(c: number): boolean {\n    return c === 33/*'!'*/ || c === 36/*'$'*/\n        || c === 38/*'&'*/ || c === 40/*'('*/\n        || c === 41/*')'*/ || c === 42/*'*'*/\n        || c === 43/*'+'*/ || c === 44/*','*/\n        || c === 59/*';'*/ || c === 61/*'='*/\n        || c === 39/*'\\''*/;\n  }\n\n  /** @internal */\n  static isSchemeChar(c: number): boolean {\n    return c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/\n        || c >= 48/*'0'*/ && c <= 57/*'9'*/\n        || c === 43/*'+'*/ || c === 45/*'-'*/\n        || c === 46/*'.'*/;\n  }\n\n  /** @internal */\n  static isUserInfoChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || Uri.isSubDelimChar(c)\n        || c === 58/*':'*/;\n  }\n\n  /** @internal */\n  static isUserChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || Uri.isSubDelimChar(c);\n  }\n\n  /** @internal */\n  static isHostChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || Uri.isSubDelimChar(c);\n  }\n\n  /** @internal */\n  static isPathChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || Uri.isSubDelimChar(c)\n        || c === 58/*':'*/ || c === 64/*'@'*/;\n  }\n\n  /** @internal */\n  static isQueryChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || Uri.isSubDelimChar(c)\n        || c === 47/*'/'*/ || c === 58/*':'*/\n        || c === 63/*'?'*/ || c === 64/*'@'*/;\n  }\n\n  /** @internal */\n  static isParamChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || c === 33/*'!'*/ || c === 36/*'$'*/\n        || c === 40/*'('*/ || c === 41/*')'*/\n        || c === 42/*'*'*/ || c === 43/*'+'*/\n        || c === 44/*','*/ || c === 47/*'/'*/\n        || c === 58/*':'*/ || c === 59/*';'*/\n        || c === 63/*'?'*/ || c === 64/*'@'*/\n        || c === 39/*'\\''*/;\n  }\n\n  /** @internal */\n  static isFragmentChar(c: number): boolean {\n    return Uri.isUnreservedChar(c)\n        || Uri.isSubDelimChar(c)\n        || c === 47/*'/'*/ || c === 58/*':'*/\n        || c === 63/*'?'*/ || c === 64/*'@'*/;\n  }\n\n  /** @internal */\n  static isAlpha(c: number): boolean {\n    return c >= 65/*'A'*/ && c <= 90/*'Z'*/\n        || c >= 97/*'a'*/ && c <= 122/*'z'*/;\n  }\n\n  /** @internal */\n  static toLowerCase(c: number): number {\n    if (c >= 65/*'A'*/ && c <= 90/*'Z'*/) {\n      return c + (97/*'a'*/ - 65/*'A'*/);\n    } else {\n      return c;\n    }\n  }\n\n  /** @internal */\n  static writeScheme<T>(output: Output<T>, scheme: string): Output<T> {\n    for (let i = 0, n = scheme.length; i < n; i += 1) {\n      const c = scheme.charCodeAt(i);\n      if (i > 0 && Uri.isSchemeChar(c) || i === 0 && Uri.isAlpha(c)) {\n        output = output.write(c);\n      } else {\n        output = Output.error(new UriException(\"Invalid scheme: \" + scheme));\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeUserInfo<T>(output: Output<T>, userInfo: string): Output<T> {\n    for (let i = 0, n = userInfo.length; i < n; i += 1) {\n      const c = userInfo.charCodeAt(i);\n      if (Uri.isUserInfoChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeUser<T>(output: Output<T>, user: string): Output<T> {\n    for (let i = 0, n = user.length; i < n; i += 1) {\n      const c = user.charCodeAt(i);\n      if (Uri.isUserChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeHost<T>(output: Output<T>, address: string): Output<T> {\n    for (let i = 0, n = address.length; i < n; i += 1) {\n      const c = address.charCodeAt(i);\n      if (Uri.isHostChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeHostLiteral<T>(output: Output<T>, address: string): Output<T> {\n    for (let i = 0, n = address.length; i < n; i += 1) {\n      const c = address.charCodeAt(i);\n      if (Uri.isHostChar(c) || c === 58/*':'*/) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writePathSegment<T>(output: Output<T>, segment: string): Output<T> {\n    for (let i = 0, n = segment.length; i < n; i += 1) {\n      const c = segment.charCodeAt(i);\n      if (Uri.isPathChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeQuery<T>(output: Output<T>, query: string): Output<T> {\n    for (let i = 0, n = query.length; i < n; i += 1) {\n      const c = query.charCodeAt(i);\n      if (Uri.isQueryChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeParam<T>(output: Output<T>, param: string): Output<T> {\n    for (let i = 0, n = param.length; i < n; i += 1) {\n      const c = param.charCodeAt(i);\n      if (Uri.isParamChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeFragment<T>(output: Output<T>, fragment: string): Output<T> {\n    for (let i = 0, n = fragment.length; i < n; i += 1) {\n      const c = fragment.charCodeAt(i);\n      if (Uri.isFragmentChar(c)) {\n        output = output.write(c);\n      } else {\n        output = Uri.writeEncoded(output, c);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writeEncoded<T>(output: Output<T>, c: number): Output<T> {\n    if (c === 0x00) { // modified UTF-8\n      output = Uri.writePctEncoded(output, 0xC0);\n      output = Uri.writePctEncoded(output, 0x80);\n    } else if (c >= 0x00 && c <= 0x7F) { // U+0000..U+007F\n      output = Uri.writePctEncoded(output, c);\n    } else if (c >= 0x80 && c <= 0x07FF) { // U+0080..U+07FF\n      output = Uri.writePctEncoded(output, 0xC0 | (c >>> 6));\n      output = Uri.writePctEncoded(output, 0x80 | (c & 0x3F));\n    } else if (c >= 0x0800 && c <= 0xFFFF) { // U+0800..U+D7FF, U+E000..U+FFFF, and surrogates\n      output = Uri.writePctEncoded(output, 0xE0 | (c >>> 12));\n      output = Uri.writePctEncoded(output, 0x80 | (c >>> 6 & 0x3F));\n      output = Uri.writePctEncoded(output, 0x80 | (c & 0x3F));\n    } else if (c >= 0x10000 && c <= 0x10FFFF) { // U+10000..U+10FFFF\n      output = Uri.writePctEncoded(output, 0xF0 | (c >>> 18));\n      output = Uri.writePctEncoded(output, 0x80 | (c >>> 12 & 0x3F));\n      output = Uri.writePctEncoded(output, 0x80 | (c >>> 6 & 0x3F));\n      output = Uri.writePctEncoded(output, 0x80 | (c & 0x3F));\n    } else { // surrogate or invalid code point\n      output = Uri.writePctEncoded(output, 0xEF);\n      output = Uri.writePctEncoded(output, 0xBF);\n      output = Uri.writePctEncoded(output, 0xBD);\n    }\n    return output;\n  }\n\n  /** @internal */\n  static writePctEncoded<T>(output: Output<T>, c: number): Output<T> {\n    const base16 = Base16.lowercase;\n    output = output.write(37/*'%'*/)\n                   .write(base16.encodeDigit(c >>> 4 & 0xF))\n                   .write(base16.encodeDigit(c       & 0xF));\n    return output;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Compare, Lazy, Strings, HashGenCacheMap} from \"@swim/util\";\nimport type {Output, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\n\n/** @public */\nexport type AnyUriScheme = UriScheme | string;\n\n/** @public */\nexport class UriScheme implements HashCode, Compare, Debug, Display {\n  /** @internal */\n  constructor(name: string) {\n    this.name = name;\n  }\n\n  isDefined(): boolean {\n    return this.name.length !== 0;\n  }\n\n  readonly name: string;\n\n  toAny(): string | undefined {\n    return this.name.length !== 0 ? this.name : void 0;\n  }\n\n  compareTo(that: unknown): number {\n    if (that instanceof UriScheme) {\n      return this.name.localeCompare(that.name);\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriScheme) {\n      return this.name === that.name;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.name);\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriScheme\").write(46/*'.'*/);\n    if (this.isDefined()) {\n      output = output.write(\"parse\").write(40/*'('*/).write(34/*'\"'*/)\n                     .display(this).write(34/*'\"'*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"undefined\").write(40/*'('*/).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  display<T>(output: Output<T>): Output<T> {\n    output = Uri.writeScheme(output, this.name);\n    return output;\n  }\n\n  toString(): string {\n    return this.name;\n  }\n\n  @Lazy\n  static undefined(): UriScheme {\n    return new UriScheme(\"\");\n  }\n\n  static create(schemeName: string): UriScheme {\n    const cache = UriScheme.cache;\n    const scheme = cache.get(schemeName);\n    if (scheme !== void 0) {\n      return scheme;\n    } else {\n      return cache.put(schemeName, new UriScheme(schemeName));\n    }\n  }\n\n  static fromAny(value: AnyUriScheme | null | undefined): UriScheme {\n    if (value === void 0 || value === null) {\n      return UriScheme.undefined();\n    } else if (value instanceof UriScheme) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return UriScheme.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(schemePart: string): UriScheme {\n    return Uri.standardParser.parseSchemeString(schemePart);\n  }\n\n  /** @internal */\n  @Lazy\n  static get cache(): HashGenCacheMap<string, UriScheme> {\n    const cacheSize = 4;\n    return new HashGenCacheMap<string, UriScheme>(cacheSize);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Compare, Mutable, Strings} from \"@swim/util\";\nimport {Output, Format, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\nimport {AnyUriUser, UriUserInit, UriUser} from \"./\"; // forward import\nimport {AnyUriHost, UriHost} from \"./\"; // forward import\nimport {AnyUriPort, UriPort} from \"./\"; // forward import\n\n/** @public */\nexport type AnyUriAuthority = UriAuthority | UriAuthorityInit | string;\n\n/** @public */\nexport interface UriAuthorityInit extends UriUserInit {\n  user?: AnyUriUser;\n  host?: AnyUriHost;\n  port?: AnyUriPort;\n}\n\n/** @public */\nexport class UriAuthority implements HashCode, Compare, Debug, Display {\n  /** @internal */\n  constructor(user: UriUser, host: UriHost, port: UriPort) {\n    this.user = user;\n    this.host = host;\n    this.port = port;\n    this.hashValue = void 0;\n    this.stringValue = void 0;\n  }\n\n  isDefined(): boolean {\n    return this.user.isDefined() || this.host.isDefined() || this.port.isDefined();\n  }\n\n  readonly user: UriUser;\n\n  withUser(user: AnyUriUser): UriAuthority {\n    user = UriUser.fromAny(user);\n    if (user !== this.user) {\n      return this.copy(user as UriUser, this.host, this.port);\n    } else {\n      return this;\n    }\n  }\n\n  get userPart(): string {\n    return this.user.toString();\n  }\n\n  withUserPart(userPart: string): UriAuthority {\n    return this.withUser(UriUser.parse(userPart));\n  }\n\n  get username(): string | undefined {\n    return this.user.username;\n  }\n\n  withUsername(username: string | undefined, password?: string): UriAuthority {\n    if (arguments.length === 1) {\n      return this.withUser(this.user.withUsername(username));\n    } else {\n      return this.withUser(UriUser.create(username, password));\n    }\n  }\n\n  get password(): string | undefined {\n    return this.user.password;\n  }\n\n  withPassword(password: string | undefined): UriAuthority {\n    return this.withUser(this.user.withPassword(password));\n  }\n\n  readonly host: UriHost;\n\n  withHost(host: AnyUriHost): UriAuthority {\n    host = UriHost.fromAny(host);\n    if (host !== this.host) {\n      return this.copy(this.user, host, this.port);\n    } else {\n      return this;\n    }\n  }\n\n  get hostPart(): string {\n    return this.host.toString();\n  }\n\n  withHostPart(hostPart: string): UriAuthority {\n    return this.withHost(UriHost.parse(hostPart));\n  }\n\n  get hostAddress(): string {\n    return this.host.address;\n  }\n\n  get hostName(): string | undefined {\n    return this.host.name;\n  }\n\n  withHostName(hostName: string): UriAuthority {\n    return this.withHost(UriHost.hostname(hostName));\n  }\n\n  get hostIPv4(): string | undefined {\n    return this.host.ipv4;\n  }\n\n  withHostIPv4(hostIPv4: string): UriAuthority {\n    return this.withHost(UriHost.ipv4(hostIPv4));\n  }\n\n  get hostIPv6(): string | undefined {\n    return this.host.ipv6;\n  }\n\n  withHostIPv6(hostIPv5: string): UriAuthority {\n    return this.withHost(UriHost.ipv6(hostIPv5));\n  }\n\n  readonly port: UriPort;\n\n  withPort(port: AnyUriPort): UriAuthority {\n    port = UriPort.fromAny(port);\n    if (port !== this.port) {\n      return this.copy(this.user, this.host, port);\n    } else {\n      return this;\n    }\n  }\n\n  get portPart(): string {\n    return this.port.toString();\n  }\n\n  withPortPart(portPart: string): UriAuthority {\n    return this.withPort(UriPort.parse(portPart));\n  }\n\n  get portNumber(): number {\n    return this.port.number;\n  }\n\n  withPortNumber(portNumber: number): UriAuthority {\n    return this.withPort(UriPort.create(portNumber));\n  }\n\n  protected copy(user: UriUser, host: UriHost, port: UriPort): UriAuthority {\n    return UriAuthority.create(user, host, port);\n  }\n\n  toAny(authority?: {username?: string, password?: string, host?: string, port?: number}):\n      {username?: string, password?: string, host?: string, port?: number} | undefined {\n    if (this.isDefined()) {\n      if (authority === void 0) {\n        authority = {};\n      }\n      this.user.toAny(authority);\n      if (this.host.isDefined()) {\n        authority.host = this.host.toAny();\n      }\n      if (this.port.isDefined()) {\n        authority.port = this.port.toAny();\n      }\n    }\n    return authority;\n  }\n\n  compareTo(that: unknown): number {\n    if (that instanceof UriAuthority) {\n      return this.toString().localeCompare(that.toString());\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriAuthority) {\n      return this.toString() === that.toString();\n    }\n    return false;\n  }\n\n  /** @internal */\n  readonly hashValue: number | undefined;\n\n  hashCode(): number {\n    let hashValue = this.hashValue;\n    if (hashValue === void 0) {\n      hashValue = Strings.hash(this.toString());\n      (this as Mutable<this>).hashValue = hashValue;\n    }\n    return hashValue;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriAuthority\").write(46/*'.'*/);\n    if (this.isDefined()) {\n      output = output.write(\"parse\").write(40/*'('*/).write(34/*'\"'*/)\n                     .display(this).write(34/*'\"'*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"undefined\").write(40/*'('*/).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  display<T>(output: Output<T>): Output<T> {\n    const stringValue = this.stringValue;\n    if (stringValue !== void 0) {\n      output = output.write(stringValue);\n    } else {\n      const user = this.user;\n      if (user.isDefined()) {\n        output = output.display(user).write(64/*'@'*/);\n      }\n      output = output.display(this.host);\n      const port = this.port;\n      if (port.isDefined()) {\n        output = output.write(58/*':'*/).display(port);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = Format.display(this);\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  @Lazy\n  static undefined(): UriAuthority {\n    return new UriAuthority(UriUser.undefined(), UriHost.undefined(), UriPort.undefined());\n  }\n\n  static create(user: UriUser = UriUser.undefined(),\n                host: UriHost = UriHost.undefined(),\n                port: UriPort = UriPort.undefined()): UriAuthority {\n    if (user.isDefined() || host.isDefined() || port.isDefined()) {\n      return new UriAuthority(user, host, port);\n    } else {\n      return UriAuthority.undefined();\n    }\n  }\n\n  static fromInit(init: UriAuthorityInit): UriAuthority {\n    const user = UriUser.fromAny(init.user !== void 0 ? init.user : init);\n    const host = UriHost.fromAny(init.host);\n    const port = UriPort.fromAny(init.port);\n    return UriAuthority.create(user, host, port);\n  }\n\n  static fromAny(value: AnyUriAuthority | null | undefined): UriAuthority {\n    if (value === void 0 || value === null) {\n      return UriAuthority.undefined();\n    } else if (value instanceof UriAuthority) {\n      return value;\n    } else if (typeof value === \"object\") {\n      return UriAuthority.fromInit(value);\n    } else if (typeof value === \"string\") {\n      return UriAuthority.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static user(user: AnyUriUser): UriAuthority {\n    user = UriUser.fromAny(user);\n    return UriAuthority.create(user as UriUser, void 0, void 0);\n  }\n\n  static userPart(userPart: string): UriAuthority {\n    const user = UriUser.parse(userPart);\n    return UriAuthority.create(user, void 0, void 0);\n  }\n\n  static username(username: string, password?: string | undefined): UriAuthority {\n    const user = UriUser.create(username, password);\n    return UriAuthority.create(user, void 0, void 0);\n  }\n\n  static password(password: string): UriAuthority {\n    const user = UriUser.create(\"\", password);\n    return UriAuthority.create(user, void 0, void 0);\n  }\n\n  static host(host: AnyUriHost): UriAuthority {\n    host = UriHost.fromAny(host);\n    return UriAuthority.create(void 0, host, void 0);\n  }\n\n  static hostPart(hostPart: string): UriAuthority {\n    const host = UriHost.parse(hostPart);\n    return UriAuthority.create(void 0, host, void 0);\n  }\n\n  static hostName(hostName: string): UriAuthority {\n    const host = UriHost.hostname(hostName);\n    return UriAuthority.create(void 0, host, void 0);\n  }\n\n  static hostIPv4(hostIPv4: string): UriAuthority {\n    const host = UriHost.ipv4(hostIPv4);\n    return UriAuthority.create(void 0, host, void 0);\n  }\n\n  static hostIPv6(hostIPv6: string): UriAuthority {\n    const host = UriHost.ipv6(hostIPv6);\n    return UriAuthority.create(void 0, host, void 0);\n  }\n\n  static port(port: AnyUriPort): UriAuthority {\n    port = UriPort.fromAny(port);\n    return UriAuthority.create(void 0, void 0, port);\n  }\n\n  static portPart(portPart: string): UriAuthority {\n    const port = UriPort.parse(portPart);\n    return UriAuthority.create(void 0, void 0, port);\n  }\n\n  static portNumber(portNumber: number): UriAuthority {\n    const port = UriPort.create(portNumber);\n    return UriAuthority.create(void 0, void 0, port);\n  }\n\n  static parse(authorityPart: string): UriAuthority {\n    return Uri.standardParser.parseAuthorityString(authorityPart);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Lazy, Strings} from \"@swim/util\";\nimport {Output, Format, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\n\n/** @public */\nexport type AnyUriUser = UriUser | UriUserInit | string;\n\n/** @public */\nexport interface UriUserInit {\n  username?: string;\n  password?: string;\n}\n\n/** @public */\nexport class UriUser implements HashCode, Debug, Display {\n  /** @internal */\n  constructor(username: string | undefined, password: string | undefined) {\n    this.username = username;\n    this.password = password;\n  }\n\n  isDefined(): boolean {\n    return this.username !== void 0;\n  }\n\n  readonly username: string | undefined;\n\n  withUsername(username: string | undefined): UriUser {\n    if (username !== this.username) {\n      return this.copy(username, this.password);\n    } else {\n      return this;\n    }\n  }\n\n  readonly password: string | undefined;\n\n  withPassword(password: string | undefined): UriUser {\n    if (password !== this.password) {\n      return this.copy(this.username, password);\n    } else {\n      return this;\n    }\n  }\n\n  protected copy(username: string | undefined, password: string | undefined): UriUser {\n    return UriUser.create(username, password);\n  }\n\n  toAny(user?: {username?: string, password?: string}): {username?: string, password?: string} | undefined {\n    if (this.username !== void 0) {\n      if (user === void 0) {\n        user = {};\n      }\n      user.username = this.username;\n      if (this.password !== void 0) {\n        user.password = this.password;\n      }\n    }\n    return user;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriUser) {\n      return this.username === that.username && this.password === that.password;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.toString());\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriUser\").write(46/*'.'*/);\n    if (this.isDefined()) {\n      output = output.write(\"parse\").write(40/*'('*/).write(34/*'\"'*/)\n                     .display(this).write(34/*'\"'*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"undefined\").write(40/*'('*/).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  display<T>(output: Output<T>): Output<T> {\n    if (this.username !== void 0) {\n      output = Uri.writeUser(output, this.username);\n      if (this.password !== void 0) {\n        output = output.write(58/*':'*/);\n        output = Uri.writeUser(output, this.password);\n      }\n    }\n    return output;\n  }\n\n  toString(): string {\n    return Format.display(this);\n  }\n\n  @Lazy\n  static undefined(): UriUser {\n    return new UriUser(void 0, void 0);\n  }\n\n  static create(username: string | undefined, password?: string | undefined): UriUser {\n    if (username !== void 0 || password !== void 0) {\n      return new UriUser(username, password);\n    } else {\n      return UriUser.undefined();\n    }\n  }\n\n  static fromInit(init: UriUserInit): UriUser {\n    return UriUser.create(init.username, init.password);\n  }\n\n  static fromAny(value: AnyUriUser | null | undefined): UriUser {\n    if (value === void 0 || value === null) {\n      return UriUser.undefined();\n    } else if (value instanceof UriUser) {\n      return value;\n    } else if (typeof value === \"object\") {\n      return UriUser.fromInit(value);\n    } else if (typeof value === \"string\") {\n      return UriUser.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(userPart: string): UriUser {\n    return Uri.standardParser.parseUserString(userPart);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Compare, Lazy, Strings, HashGenCacheMap} from \"@swim/util\";\nimport type {Output, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\nimport {UriHostName} from \"./\" // forward import\nimport {UriHostIPv4} from \"./\" // forward import\nimport {UriHostIPv6} from \"./\" // forward import\nimport {UriHostUndefined} from \"./\" // forward import\n\n/** @public */\nexport type AnyUriHost = UriHost | string;\n\n/** @public */\nexport abstract class UriHost implements HashCode, Compare, Debug, Display {\n  protected constructor() {\n    // stub\n  }\n\n  isDefined(): boolean {\n    return true;\n  }\n\n  abstract readonly address: string;\n\n  get name(): string | undefined {\n    return void 0;\n  }\n\n  get ipv4(): string | undefined {\n    return void 0;\n  }\n\n  get ipv6(): string | undefined {\n    return void 0;\n  }\n\n  toAny(): string {\n    return this.toString();\n  }\n\n  compareTo(that: unknown): number {\n    if (that instanceof UriHost) {\n      return this.toString().localeCompare(that.toString());\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriHost) {\n      return this.toString() === that.toString();\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.toString());\n  }\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  abstract display<T>(output: Output<T>): Output<T>;\n\n  abstract toString(): string;\n\n  @Lazy\n  static undefined(): UriHost {\n    return new UriHostUndefined();\n  }\n\n  static hostname(name: string): UriHost {\n    const cache = UriHost.cache;\n    const host = cache.get(name);\n    if (host instanceof UriHostName) {\n      return host;\n    } else {\n      return cache.put(name, new UriHostName(name));\n    }\n  }\n\n  static ipv4(ipv4: string): UriHost {\n    const cache = UriHost.cache;\n    const host = cache.get(ipv4);\n    if (host instanceof UriHostIPv4) {\n      return host;\n    } else {\n      return cache.put(ipv4, new UriHostIPv4(ipv4));\n    }\n  }\n\n  static ipv6(ipv6: string): UriHost {\n    const cache = UriHost.cache;\n    const host = cache.get(ipv6);\n    if (host instanceof UriHostIPv6) {\n      return host;\n    } else {\n      return cache.put(ipv6, new UriHostIPv6(ipv6));\n    }\n  }\n\n  static fromAny(value: AnyUriHost | null | undefined): UriHost {\n    if (value === void 0 || value === null) {\n      return UriHost.undefined();\n    } else if (value instanceof UriHost) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return UriHost.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(hostPart: string): UriHost {\n    return Uri.standardParser.parseHostString(hostPart);\n  }\n\n  /** @internal */\n  @Lazy\n  static get cache(): HashGenCacheMap<string, UriHost> {\n    const cacheSize = 16;\n    return new HashGenCacheMap<string, UriHost>(cacheSize);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\nimport {UriHost} from \"./UriHost\";\n\n/** @internal */\nexport class UriHostName extends UriHost {\n  /** @internal */\n  constructor(address: string) {\n    super();\n    this.address = address;\n  }\n\n  override readonly address: string;\n\n  override get name(): string {\n    return this.address;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriHost\").write(46/*'.'*/).write(\"hostname\")\n                   .write(40/*'('*/).debug(this.address).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = Uri.writeHost(output, this.address);\n    return output;\n  }\n\n  override toString(): string {\n    return this.address;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\nimport {UriHost} from \"./UriHost\";\n\n/** @internal */\nexport class UriHostIPv4 extends UriHost {\n  /** @internal */\n  constructor(address: string) {\n    super();\n    this.address = address;\n  }\n\n  override readonly address: string;\n\n  override get ipv4(): string {\n    return this.address;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriHost\").write(46/*'.'*/).write(\"ipv4\")\n                   .write(40/*'('*/).debug(this.address).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = Uri.writeHost(output, this.address);\n    return output;\n  }\n\n  override toString(): string {\n    return this.address;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\nimport {UriHost} from \"./UriHost\";\n\n/** @internal */\nexport class UriHostIPv6 extends UriHost {\n  /** @internal */\n  constructor(address: string) {\n    super();\n    this.address = address;\n  }\n\n  override readonly address: string;\n\n  override get ipv6(): string {\n    return this.address;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriHost\").write(46/*'.'*/).write(\"ipv6\")\n                   .write(40/*'('*/).debug(this.address).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    output = output.write(91/*'['*/);\n    output = Uri.writeHostLiteral(output, this.address);\n    output = output.write(93/*']'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return \"[\" + this.address + \"]\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"@swim/codec\";\nimport {UriHost} from \"./UriHost\";\n\n/** @internal */\nexport class UriHostUndefined extends UriHost {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  override isDefined(): boolean {\n    return false;\n  }\n\n  override get address(): string {\n    return \"\";\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriHost\").write(46/*'.'*/).write(\"undefined\")\n                   .write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    return output; // blank\n  }\n\n  override toString(): string {\n    return \"\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Lazy, Compare, Strings, HashGenCacheMap} from \"@swim/util\";\nimport {Output, Format, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\n\n/** @public */\nexport type AnyUriPort = UriPort | number | string;\n\n/** @public */\nexport class UriPort implements HashCode, Compare, Debug, Display {\n  /** @internal */\n  constructor(portNumber: number) {\n    this.number = portNumber;\n  }\n\n  isDefined(): boolean {\n    return this.number !== 0;\n  }\n\n  readonly number!: number;\n\n  valueOf(): number {\n    return this.number;\n  }\n\n  toAny(): number {\n    return this.number;\n  }\n\n  compareTo(that: unknown): number {\n    if (that instanceof UriPort) {\n      return this.number < that.number ? -1 : this.number > that.number ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriPort) {\n      return this.number === that.number;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.toString());\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriPort\").write(46/*'.'*/);\n    if (this.isDefined()) {\n      output = output.write(\"create\").write(40/*'('*/);\n      output = Format.displayNumber(output, this.number);\n    } else {\n      output = output.write(\"undefined\").write(40/*'('*/);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  display<T>(output: Output<T>): Output<T> {\n    output = Format.displayNumber(output, this.number);\n    return output;\n  }\n\n  toString(): string {\n    return \"\" + this.number;\n  }\n\n  @Lazy\n  static undefined(): UriPort {\n    return new UriPort(0);\n  }\n\n  static create(number: number): UriPort {\n    if (number === 0) {\n      return UriPort.undefined();\n    } else if (number > 0) {\n      const cache = UriPort.cache;\n      const port = cache.get(number);\n      if (port !== void 0) {\n        return port;\n      } else {\n        return cache.put(number, new UriPort(number));\n      }\n    } else {\n      throw new TypeError(\"\" + number);\n    }\n  }\n\n  static fromAny(value: AnyUriPort | null | undefined): UriPort {\n    if (value === void 0 || value === null) {\n      return UriPort.undefined();\n    } else if (value instanceof UriPort) {\n      return value;\n    } else if (typeof value === \"number\") {\n      return UriPort.create(value);\n    } else if (typeof value === \"string\") {\n      return UriPort.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(portPart: string): UriPort {\n    return Uri.standardParser.parsePortString(portPart);\n  }\n\n  /** @internal */\n  @Lazy\n  static get cache(): HashGenCacheMap<number, UriPort> {\n    const cacheSize = 16;\n    return new HashGenCacheMap<number, UriPort>(cacheSize);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Compare, Lazy, Strings, HashGenCacheSet} from \"@swim/util\";\nimport type {Output, Debug, Display} from \"@swim/codec\";\nimport type {Form} from \"@swim/structure\";\nimport {Uri} from \"./Uri\";\nimport {UriPathSegment} from \"./\"; // forward import\nimport {UriPathSlash} from \"./\"; // forward import\nimport {UriPathEmpty} from \"./\"; // forward import\nimport {UriPathBuilder} from \"./\"; // forward import\nimport {UriPathForm} from \"./\"; // forward import\n\n/** @public */\nexport type AnyUriPath = UriPath | string[] | string;\n\n/** @public */\nexport abstract class UriPath implements HashCode, Compare, Debug, Display {\n  /** @internal */\n  protected constructor() {\n    // sealed\n  }\n\n  abstract isDefined(): boolean;\n\n  abstract isAbsolute(): boolean;\n\n  abstract isRelative(): boolean;\n\n  abstract isEmpty(): boolean;\n\n  get length(): number {\n    let n = 0;\n    let path: UriPath = this;\n    while (!path.isEmpty()) {\n      n += 1;\n      path = path.tail();\n    }\n    return n;\n  }\n\n  get(index: number): string | undefined {\n    let i = 0;\n    let path: UriPath = this;\n    while (!path.isEmpty()) {\n      if (i < index) {\n        i += 1;\n        path = path.tail();\n      } else {\n        return path.head();\n      }\n    }\n    return void 0;\n  }\n\n  abstract head(): string;\n\n  abstract tail(): UriPath;\n\n  /** @internal */\n  abstract setTail(tail: UriPath): void;\n\n  /** @internal */\n  abstract dealias(): UriPath;\n\n  abstract parent(): UriPath;\n\n  abstract base(): UriPath;\n\n  get name(): string {\n    if (this.isEmpty()) {\n      return \"\";\n    }\n    let path: UriPath = this;\n    do {\n      const tail = path.tail();\n      if (tail.isEmpty()) {\n        return path.isRelative() ? path.head() : \"\";\n      } else {\n        path = tail;\n      }\n    } while (true);\n  }\n\n  withName(name: string): UriPath {\n    const builder = new UriPathBuilder();\n    builder.addPath(this.base());\n    builder.addSegment(name);\n    return builder.bind();\n  }\n\n  foot(): UriPath {\n    if (this.isEmpty()) {\n      return this;\n    }\n    let path: UriPath = this;\n    do {\n      const tail = path.tail();\n      if (tail.isEmpty()) {\n        return path;\n      } else {\n        path = tail;\n      }\n    } while (true);\n  }\n\n  isSubpathOf(b: AnyUriPath): boolean {\n    b = UriPath.fromAny(b);\n    let a: UriPath = this;\n    while (!a.isEmpty() && !b.isEmpty()) {\n      if (a.head() !== b.head()) {\n        return false;\n      }\n      a = a.tail();\n      b = b.tail();\n    }\n    return b.isEmpty();\n  }\n\n  appended(...components: AnyUriPath[]): UriPath {\n    if (arguments.length > 0) {\n      const builder = new UriPathBuilder();\n      builder.addPath(this);\n      builder.push(...components);\n      return builder.bind();\n    } else {\n      return this;\n    }\n  }\n\n  appendedSlash(): UriPath {\n    const builder = new UriPathBuilder();\n    builder.addPath(this);\n    builder.addSlash();\n    return builder.bind();\n  }\n\n  appendedSegment(segment: string): UriPath {\n    const builder = new UriPathBuilder();\n    builder.addPath(this);\n    builder.addSegment(segment);\n    return builder.bind();\n  }\n\n  prepended(...components: AnyUriPath[]): UriPath {\n    if (arguments.length > 0) {\n      const builder = new UriPathBuilder();\n      builder.push(...components);\n      builder.addPath(this);\n      return builder.bind();\n    } else {\n      return this;\n    }\n  }\n\n  prependedSlash(): UriPath {\n    return new UriPathSlash(this);\n  }\n\n  prependedSegment(segment: string): UriPath {\n    if (this.isEmpty() || this.isAbsolute()) {\n      return UriPath.segment(segment, this);\n    } else {\n      return UriPath.segment(segment, this.prependedSlash());\n    }\n  }\n\n  resolve(that: UriPath): UriPath {\n    if (that.isEmpty()) {\n      return this;\n    } else if (that.isAbsolute() || this.isEmpty()) {\n      return that.removeDotSegments();\n    } else {\n      return this.merge(that).removeDotSegments();\n    }\n  }\n\n  removeDotSegments(): UriPath {\n    let path: UriPath = this;\n    const builder = new UriPathBuilder();\n    while (!path.isEmpty()) {\n      const head = path.head();\n      if (head === \".\" || head === \"..\") {\n        path = path.tail();\n        if (!path.isEmpty()) {\n          path = path.tail();\n        }\n      } else if (path.isAbsolute()) {\n        const rest = path.tail();\n        if (!rest.isEmpty()) {\n          const next = rest.head();\n          if (next === \".\") {\n            path = rest.tail();\n            if (path.isEmpty()) {\n              path = UriPath.slash();\n            }\n          } else if (next === \"..\") {\n            path = rest.tail();\n            if (path.isEmpty()) {\n              path = UriPath.slash();\n            }\n            if (!builder.isEmpty() && !builder.pop().isAbsolute()) {\n              if (!builder.isEmpty()) {\n                builder.pop();\n              }\n            }\n          } else {\n            builder.push(head, next);\n            path = rest.tail();\n          }\n        } else {\n          builder.push(path.head());\n          path = path.tail();\n        }\n      } else {\n        builder.push(path.head());\n        path = path.tail();\n      }\n    }\n    return builder.bind();\n  }\n\n  merge(that: UriPath): UriPath {\n    if (!this.isEmpty()) {\n      const builder = new UriPathBuilder();\n      let prev: UriPath = this;\n      do {\n        const next = prev.tail();\n        if (!next.isEmpty()) {\n          if (prev.isAbsolute()) {\n            builder.addSlash();\n          } else {\n            builder.addSegment(prev.head());\n          }\n          prev = next;\n        } else {\n          if (prev.isAbsolute()) {\n            builder.addSlash();\n          }\n          break;\n        }\n      } while (true);\n      builder.addPath(that);\n      return builder.bind();\n    } else {\n      return that;\n    }\n  }\n\n  unmerge(relative: UriPath, root: UriPath = relative): UriPath {\n    let base: UriPath = this;\n    do {\n      if (base.isEmpty()) {\n        if (!relative.isEmpty() && !relative.tail().isEmpty()) {\n          return relative.tail();\n        } else {\n          return relative;\n        }\n      } else if (base.isRelative()) {\n        return relative;\n      } else if (relative.isRelative()) {\n        return relative.prependedSlash();\n      } else {\n        let a = base.tail();\n        let b = relative.tail();\n        if (!a.isEmpty() && b.isEmpty()) {\n          return UriPath.slash();\n        } else if (a.isEmpty() || b.isEmpty() || a.head() !== b.head()) {\n          return b;\n        } else {\n          a = a.tail();\n          b = b.tail();\n          if (!a.isEmpty() && b.isEmpty()) {\n            return root;\n          } else {\n            base = a;\n            relative = b;\n          }\n        }\n      }\n    } while (true);\n  }\n\n  toAny(): string[] {\n    const components = [];\n    let path: UriPath = this;\n    while (!path.isEmpty()) {\n      components.push(path.head());\n      path = path.tail();\n    }\n    return components;\n  }\n\n  compareTo(that: unknown): number {\n    if (that instanceof UriPath) {\n      return this.toString().localeCompare(that.toString());\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriPath) {\n      return this.toString() === that.toString();\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.toString());\n  }\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  display<T>(output: Output<T>): Output<T> {\n    let path: UriPath = this;\n    while (!path.isEmpty()) {\n      if (path.isAbsolute()) {\n        output = output.write(47/*'/'*/);\n      } else {\n        output = Uri.writePathSegment(output, path.head());\n      }\n      path = path.tail();\n    }\n    return output;\n  }\n\n  abstract toString(): string;\n\n  @Lazy\n  static empty(): UriPath {\n    return new UriPathEmpty();\n  }\n\n  @Lazy\n  static slash(): UriPath {\n    return new UriPathSlash(UriPath.empty());\n  }\n\n  static segment(segment: string, tail?: UriPath): UriPath {\n    if (tail === void 0) {\n      tail = UriPath.empty();\n    }\n    segment = this.cacheSegment(segment);\n    return new UriPathSegment(segment, tail);\n  }\n\n  static of(...components: AnyUriPath[]): UriPath {\n    const builder = new UriPathBuilder();\n    builder.push(...components);\n    return builder.bind();\n  }\n\n  static fromAny(value: AnyUriPath | null | undefined): UriPath {\n    if (value === void 0 || value === null) {\n      return UriPath.empty();\n    } else if (value instanceof UriPath) {\n      return value;\n    } else if (Array.isArray(value)) {\n      return UriPath.of(...value);\n    } else if (typeof value === \"string\") {\n      return UriPath.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(pathPart: string): UriPath {\n    return Uri.standardParser.parsePathString(pathPart);\n  }\n\n  static builder(): UriPathBuilder {\n    return new UriPathBuilder();\n  }\n\n  @Lazy\n  static pathForm(): Form<UriPath, AnyUriPath> {\n    return new UriPathForm(UriPath.empty());\n  }\n\n  /** @internal */\n  @Lazy\n  static get segmentCache(): HashGenCacheSet<string> {\n    const segmentCacheSize = 64;\n    return new HashGenCacheSet<string>(segmentCacheSize);\n  }\n\n  /** @internal */\n  static cacheSegment(segment: string): string {\n    if (segment.length <= 32) {\n      return this.segmentCache.put(segment);\n    } else {\n      return segment;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Output, Format} from \"@swim/codec\";\nimport {UriPath} from \"./UriPath\";\n\n/** @internal */\nexport class UriPathSegment extends UriPath {\n  /** @internal */\n  constructor(head: string, tail: UriPath) {\n    super();\n    this.segment = head;\n    this.rest = tail;\n    this.stringValue = void 0;\n  }\n\n  /** @internal */\n  readonly segment: string;\n\n  /** @internal */\n  readonly rest: UriPath;\n\n  override isDefined(): boolean {\n    return true;\n  }\n\n  override isAbsolute(): boolean {\n    return false;\n  }\n\n  override isRelative(): boolean {\n    return true;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override head(): string {\n    return this.segment;\n  }\n\n  override tail(): UriPath {\n    return this.rest;\n  }\n\n  /** @internal */\n  override setTail(tail: UriPath): void {\n    if (tail instanceof UriPathSegment) {\n      throw new Error(\"adjacent path segments\");\n    }\n    (this as Mutable<this>).rest = tail;\n  }\n\n  /** @internal */\n  override dealias(): UriPath {\n    return new UriPathSegment(this.segment, this.rest);\n  }\n\n  override parent(): UriPath {\n    const tail = this.rest;\n    if (tail.isEmpty()) {\n      return UriPath.empty();\n    } else {\n      const rest = tail.tail();\n      if (rest.isEmpty()) {\n        return UriPath.empty();\n      } else {\n        return new UriPathSegment(this.segment, tail.parent());\n      }\n    }\n  }\n\n  override base(): UriPath {\n    const tail = this.rest;\n    if (tail.isEmpty()) {\n      return UriPath.empty();\n    } else {\n      return new UriPathSegment(this.segment, tail.base());\n    }\n  }\n\n  override prependedSegment(segment: string): UriPath {\n    return UriPath.segment(segment, this.prependedSlash());\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriPath\").write(46/*'.'*/).write(\"parse\").write(40/*'('*/)\n                   .write(34/*'\"'*/).display(this).write(34/*'\"'*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    const stringValue = this.stringValue;\n    if (stringValue !== void 0) {\n      output = output.write(stringValue);\n    } else {\n      output = super.display(output);\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = Format.display(this);\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Output, Format} from \"@swim/codec\";\nimport {UriPath} from \"./UriPath\";\n\n/** @internal */\nexport class UriPathSlash extends UriPath {\n  /** @internal */\n  constructor(tail: UriPath) {\n    super();\n    this.rest = tail;\n    this.stringValue = void 0;\n  }\n\n  /** @internal */\n  readonly rest: UriPath;\n\n  override isDefined(): boolean {\n    return true;\n  }\n\n  override isAbsolute(): boolean {\n    return true;\n  }\n\n  override isRelative(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override head(): string {\n    return \"/\";\n  }\n\n  override tail(): UriPath {\n    return this.rest;\n  }\n\n  /** @internal */\n  override setTail(tail: UriPath): void {\n    (this as Mutable<this>).rest = tail;\n  }\n\n  /** @internal */\n  override dealias(): UriPath {\n    return new UriPathSlash(this.rest);\n  }\n\n  override parent(): UriPath {\n    const tail = this.rest;\n    if (tail.isEmpty()) {\n      return UriPath.empty();\n    } else {\n      const rest = tail.tail();\n      if (rest.isEmpty()) {\n        return UriPath.slash();\n      } else {\n        return new UriPathSlash(tail.parent());\n      }\n    }\n  }\n\n  override base(): UriPath {\n    const tail = this.rest;\n    if (tail.isEmpty()) {\n      return this;\n    } else {\n      return new UriPathSlash(tail.base());\n    }\n  }\n\n  override prependedSegment(segment: string): UriPath {\n    return UriPath.segment(segment, this);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriPath\").write(46/*'.'*/).write(\"parse\").write(40/*'('*/)\n                   .write(34/*'\"'*/) .display(this).write(34/*'\"'*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    const stringValue = this.stringValue;\n    if (stringValue !== void 0) {\n      output = output.write(stringValue);\n    } else {\n      output = super.display(output);\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = Format.display(this);\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"@swim/codec\";\nimport {AnyUriPath, UriPath} from \"./UriPath\";\n\n/** @internal */\nexport class UriPathEmpty extends UriPath {\n  /** @internal */\n  constructor() {\n    super();\n  }\n\n  override isDefined(): boolean {\n    return false;\n  }\n\n  override isAbsolute(): boolean {\n    return false;\n  }\n\n  override isRelative(): boolean {\n    return true;\n  }\n\n  override isEmpty(): boolean {\n    return true;\n  }\n\n  override head(): string {\n    throw new Error(\"empty path\");\n  }\n\n  override tail(): UriPath {\n    throw new Error(\"empty path\");\n  }\n\n  /** @internal */\n  override setTail(tail: UriPath): void {\n    throw new Error(\"empty path\");\n  }\n\n  /** @internal */\n  override dealias(): UriPath {\n    return this;\n  }\n\n  override parent(): UriPath {\n    return this;\n  }\n\n  override base(): UriPath {\n    return this;\n  }\n\n  override appended(...components: AnyUriPath[]): UriPath {\n    return UriPath.of(...components);\n  }\n\n  override appendedSlash(): UriPath {\n    return UriPath.slash();\n  }\n\n  override appendedSegment(segment: string): UriPath {\n    return UriPath.segment(segment);\n  }\n\n  override prepended(...components: AnyUriPath[]): UriPath {\n    return UriPath.of(...components);\n  }\n\n  override prependedSlash(): UriPath {\n    return UriPath.slash();\n  }\n\n  override prependedSegment(segment: string): UriPath {\n    return UriPath.segment(segment);\n  }\n\n  override merge(that: UriPath): UriPath {\n    return that;\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriPath\").write(46/*'.'*/).write(\"empty\")\n                   .write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    return output; // blank\n  }\n\n  override toString(): string {\n    return \"\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Builder} from \"@swim/util\";\nimport {AnyUriPath, UriPath} from \"./UriPath\";\n\n/** @public */\nexport class UriPathBuilder implements Builder<string, UriPath> {\n  /** @internal */\n  first: UriPath;\n  /** @internal */\n  last: UriPath | null;\n  /** @internal */\n  size: number;\n  /** @internal */\n  aliased: number;\n\n  constructor() {\n    this.first = UriPath.empty();\n    this.last = null;\n    this.size = 0;\n    this.aliased = 0;\n  }\n\n  isEmpty(): boolean {\n    return this.size === 0;\n  }\n\n  push(...components: AnyUriPath[]): void {\n    for (let i = 0; i < components.length; i += 1) {\n      const component = components[i]!;\n      if (component instanceof UriPath) {\n        this.addPath(component);\n      } else if (Array.isArray(component)) {\n        this.push(...component);\n      } else if (component === \"/\") {\n        this.addSlash();\n      } else {\n        this.addSegment(component);\n      }\n    }\n  }\n\n  bind(): UriPath {\n    this.aliased = 0;\n    return this.first;\n  }\n\n  addSlash(): void {\n    const tail = UriPath.slash().dealias();\n    const size = this.size;\n    if (size === 0) {\n      this.first = tail;\n    } else {\n      this.dealias(size - 1).setTail(tail);\n    }\n    this.last = tail;\n    this.size = size + 1;\n    this.aliased += 1;\n  }\n\n  addSegment(segment: string): void {\n    const tail = UriPath.segment(segment, UriPath.empty());\n    let size = this.size;\n    if (size === 0) {\n      this.first = tail;\n    } else {\n      const last = this.dealias(size - 1);\n      if (last.isAbsolute()) {\n        last.setTail(tail);\n      } else {\n        last.setTail(tail.prependedSlash());\n        size += 1;\n        this.aliased += 1;\n      }\n    }\n    this.last = tail;\n    this.size = size + 1;\n    this.aliased += 1;\n  }\n\n  addPath(path: UriPath): void {\n    if (!path.isEmpty()) {\n      let size = this.size;\n      if (size === 0) {\n        this.first = path;\n      } else {\n        const last = this.dealias(size - 1);\n        if (last.isAbsolute() || path.isAbsolute()) {\n          last.setTail(path);\n        } else {\n          last.setTail(path.prependedSlash());\n          size += 1;\n          this.aliased += 1;\n        }\n      }\n      size += 1;\n      do {\n        const tail = path.tail();\n        if (!tail.isEmpty()) {\n          path = tail;\n          size += 1;\n        } else {\n          break;\n        }\n      } while (true);\n      this.last = path;\n      this.size = size;\n    }\n  }\n\n  pop(): UriPath {\n    const size = this.size;\n    const aliased = this.aliased;\n    if (size === 0) {\n      throw new Error(\"Empty UriPath\");\n    } else if (size === 1) {\n      const first = this.first;\n      this.first = first.tail();\n      if (first.tail().isEmpty()) {\n        this.last = null;\n      }\n      this.size = size - 1;\n      if (aliased > 0) {\n        this.aliased = aliased - 1;\n      }\n      return first;\n    } else {\n      const last = this.dealias(size - 2);\n      last.setTail(UriPath.empty());\n      this.last = last;\n      this.size = size - 1;\n      this.aliased = aliased - 1;\n      return last.tail();\n    }\n  }\n\n  /** @internal */\n  dealias(n: number): UriPath {\n    let i = 0;\n    let xi: UriPath | null = null;\n    let xs = this.first;\n    if (this.aliased <= n) {\n      while (i < this.aliased) {\n        xi = xs;\n        xs = xs.tail();\n        i += 1;\n      }\n      while (i <= n) {\n        const xn = xs.dealias();\n        if (i === 0) {\n          this.first = xn;\n        } else {\n          xi!.setTail(xn);\n        }\n        xi = xn;\n        xs = xs.tail();\n        i += 1;\n      }\n      if (i === this.size) {\n        this.last = xi;\n      }\n      this.aliased = i;\n    } else if (n === 0) {\n      xi = this.first;\n    } else if (n === this.size - 1) {\n      xi = this.last;\n    } else {\n      while (i <= n) {\n        xi = xs;\n        xs = xs.tail();\n        i += 1;\n      }\n    }\n    return xi!;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Text, Form} from \"@swim/structure\";\nimport {AnyUriPath, UriPath} from \"./UriPath\";\n\n/** @internal */\nexport class UriPathForm extends Form<UriPath, AnyUriPath> {\n  constructor(unit: UriPath | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: UriPath | undefined;\n\n  override withUnit(unit: UriPath | undefined): Form<UriPath, AnyUriPath> {\n    if (unit !== this.unit) {\n      return new UriPathForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: AnyUriPath, item?: Item): Item {\n    object = UriPath.fromAny(object);\n    if (item === void 0) {\n      return Text.from(object.toString());\n    } else {\n      return item.concat(Text.from(object.toString()));\n    }\n  }\n\n  override cast(item: Item, object?: UriPath): UriPath | undefined {\n    const value = item.target;\n    try {\n      const string = value.stringValue();\n      if (typeof string === \"string\") {\n        return UriPath.parse(string);\n      }\n    } catch (error) {\n      // swallow\n    }\n    return void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Compare, Lazy, Strings, HashGenCacheSet} from \"@swim/util\";\nimport type {Output, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\nimport {UriQueryParam} from \"./\"; // forward import\nimport {UriQueryUndefined} from \"./\"; // forward import\nimport {UriQueryBuilder} from \"./\"; // forward import\n\n/** @public */\nexport type AnyUriQuery = UriQuery | {[key: string]: string} | string;\n\n/** @public */\nexport abstract class UriQuery implements HashCode, Compare, Debug, Display {\n  abstract isDefined(): boolean;\n\n  abstract isEmpty(): boolean;\n\n  get length(): number {\n    let n = 0;\n    let query: UriQuery = this;\n    while (!query.isEmpty()) {\n      n += 1;\n      query = query.tail();\n    }\n    return n;\n  }\n\n  abstract head(): [string | undefined, string];\n\n  abstract readonly key: string | undefined;\n\n  abstract readonly value: string;\n\n  abstract tail(): UriQuery;\n\n  /** @internal */\n  abstract setTail(tail: UriQuery): void;\n\n  /** @internal */\n  abstract dealias(): UriQuery;\n\n  has(key: string): boolean {\n    let query: UriQuery = this;\n    while (!query.isEmpty()) {\n      if (key === query.key) {\n        return true;\n      }\n      query = query.tail();\n    }\n    return false;\n  }\n\n  get(key: string): string | undefined {\n    let query: UriQuery = this;\n    while (!query.isEmpty()) {\n      if (key === query.key) {\n        return query.value;\n      }\n      query = query.tail();\n    }\n    return void 0;\n  }\n\n  updated(key: string, value: string): UriQuery {\n    let query: UriQuery = this;\n    const builder = new UriQueryBuilder();\n    let updated = false;\n    while (!query.isEmpty()) {\n      if (key === query.key) {\n        builder.addParam(key, value);\n        updated = true;\n      } else {\n        builder.addParam(query.key, query.value);\n      }\n      query = query.tail();\n    }\n    if (!updated) {\n      builder.addParam(key, value);\n    }\n    return builder.bind();\n  }\n\n  removed(key: string): UriQuery {\n    let query: UriQuery = this;\n    const builder = new UriQueryBuilder();\n    let updated = false;\n    while (!query.isEmpty()) {\n      if (key === query.key) {\n        updated = true;\n      } else {\n        builder.addParam(query.key, query.value);\n      }\n      query = query.tail();\n    }\n    if (updated) {\n      return builder.bind();\n    } else {\n      return this;\n    }\n  }\n\n  appended(key: string | undefined, value: string): UriQuery;\n  appended(params: AnyUriQuery): UriQuery;\n  appended(key: AnyUriQuery | undefined, value?: string): UriQuery {\n    const builder = new UriQueryBuilder();\n    builder.addQuery(this);\n    builder.add(key as any, value as any);\n    return builder.bind();\n  }\n\n  prepended(key: string | undefined, value: string): UriQuery;\n  prepended(params: AnyUriQuery): UriQuery;\n  prepended(key: AnyUriQuery | undefined, value?: string): UriQuery {\n    const builder = new UriQueryBuilder();\n    builder.add(key as any, value as any);\n    builder.addQuery(this);\n    return builder.bind();\n  }\n\n  toAny(params?: {[key: string]: string}): {[key: string]: string} | undefined {\n    if (this.isDefined()) {\n      params = params || {};\n      let query: UriQuery = this;\n      let i = 0;\n      while (!query.isEmpty()) {\n        const key = query.key;\n        if (key !== void 0) {\n          params[key] = query.value;\n        } else {\n          params[\"$\" + i] = query.value;\n        }\n        query = query.tail();\n        i += 1;\n      }\n    }\n    return params;\n  }\n\n  compareTo(that: UriQuery): number {\n    if (that instanceof UriQuery) {\n      return this.toString().localeCompare(that.toString());\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriQuery) {\n      return this.toString() === that.toString();\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.toString());\n  }\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  display<T>(output: Output<T>): Output<T> {\n    let query: UriQuery = this;\n    let first = true;\n    while (!query.isEmpty()) {\n      if (!first) {\n        output = output.write(38/*'&'*/);\n      } else {\n        first = false;\n      }\n      const key = query.key;\n      if (key !== void 0) {\n        output = Uri.writeParam(output, key);\n        output = output.write(61/*'='*/);\n      }\n      output = Uri.writeQuery(output, query.value);\n      query = query.tail();\n    }\n    return output;\n  }\n\n  abstract toString(): string;\n\n  @Lazy\n  static undefined(): UriQuery {\n    return new UriQueryUndefined();\n  }\n\n  static param(value: string, tail?: UriQuery): UriQuery;\n  static param(key: string | undefined, value: string, tail?: UriQuery): UriQuery;\n  static param(key: string | undefined, value?: UriQuery | string, tail?: UriQuery): UriQuery {\n    if (tail === void 0) {\n      tail = value as UriQuery | undefined;\n      value = key!;\n      key = void 0;\n    } else if (key !== void 0) {\n      key = this.cacheKey(key);\n    }\n    if (tail === void 0) {\n      tail = UriQuery.undefined();\n    }\n    return new UriQueryParam(key, value as string, tail);\n  }\n\n  static fromAny(value: AnyUriQuery | null | undefined): UriQuery {\n    if (value === void 0 || value === null) {\n      return UriQuery.undefined();\n    } else if (value instanceof UriQuery) {\n      return value;\n    } else if (typeof value === \"object\") {\n      const builder = new UriQueryBuilder();\n      builder.add(value);\n      return builder.bind();\n    } else if (typeof value === \"string\") {\n      return UriQuery.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(queryPart: string): UriQuery {\n    return Uri.standardParser.parseQueryString(queryPart);\n  }\n\n  static builder(): UriQueryBuilder {\n    return new UriQueryBuilder();\n  }\n\n  /** @internal */\n  @Lazy\n  static get keyCache(): HashGenCacheSet<string> {\n    const keyCacheSize = 64;\n    return new HashGenCacheSet<string>(keyCacheSize);\n  }\n\n  /** @internal */\n  static cacheKey(key: string): string {\n    if (key.length <= 32) {\n      return UriQuery.keyCache.put(key);\n    } else {\n      return key;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Output, Format} from \"@swim/codec\";\nimport {UriQuery} from \"./UriQuery\";\n\n/** @internal */\nexport class UriQueryParam extends UriQuery {\n  constructor(key: string | undefined, value: string, tail: UriQuery) {\n    super();\n    this.key = key;\n    this.value = value;\n    this.rest = tail;\n    this.stringValue = void 0;\n  }\n\n  override readonly key: string | undefined;\n\n  override readonly value: string;\n\n  /** @internal */\n  readonly rest: UriQuery;\n\n  override isDefined(): boolean {\n    return true;\n  }\n\n  override isEmpty(): boolean {\n    return false;\n  }\n\n  override head(): [string | undefined, string] {\n    return [this.key, this.value];\n  }\n\n  override tail(): UriQuery {\n    return this.rest;\n  }\n\n  /** @internal */\n  override setTail(tail: UriQuery): void {\n    (this as Mutable<this>).rest = tail;\n  }\n\n  /** @internal */\n  override dealias(): UriQuery {\n    return new UriQueryParam(this.key, this.value, this.rest);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriQuery\").write(46/*'.'*/).write(\"parse\").write(40/*'('*/)\n                   .write(34/*'\"'*/).display(this).write(34/*'\"'*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    const stringValue = this.stringValue;\n    if (stringValue !== void 0) {\n      output = output.write(stringValue);\n    } else {\n      output = super.display(output);\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = Format.display(this);\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Output} from \"@swim/codec\";\nimport {AnyUriQuery, UriQuery} from \"./UriQuery\";\nimport {UriQueryBuilder} from \"./\"; // forward import\n\n/** @internal */\nexport class UriQueryUndefined extends UriQuery {\n  override isDefined(): boolean {\n    return false;\n  }\n\n  override isEmpty(): boolean {\n    return true;\n  }\n\n  override head(): [string | undefined, string] {\n    throw new Error(\"undefined query\");\n  }\n\n  override get key(): string | undefined {\n    throw new Error(\"undefined query\");\n  }\n\n  override get value(): string {\n    throw new Error(\"undefined query\");\n  }\n\n  override tail(): UriQuery {\n    throw new Error(\"undefined query\");\n  }\n\n  /** @internal */\n  override setTail(tail: UriQuery): void {\n    throw new Error(\"undefined query\");\n  }\n\n  /** @internal */\n  override dealias(): UriQuery {\n    return this;\n  }\n\n  override updated(key: string, value: string): UriQuery {\n    return UriQuery.param(key, value, this);\n  }\n\n  override removed(key: string): UriQuery {\n    return this;\n  }\n\n  override appended(key: string | undefined, value: string): UriQuery;\n  override appended(params: AnyUriQuery): UriQuery;\n  override appended(key: AnyUriQuery | undefined, value?: string): UriQuery {\n    const builder = new UriQueryBuilder();\n    builder.add(key as any, value as any);\n    return builder.bind();\n  }\n\n  override prepended(key: string | undefined, value: string): UriQuery;\n  override prepended(params: AnyUriQuery): UriQuery;\n  override prepended(key: AnyUriQuery | undefined, value?: string): UriQuery {\n    const builder = new UriQueryBuilder();\n    builder.add(key as any, value as any);\n    return builder.bind();\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriQuery\").write(46/*'.'*/).write(\"undefined\")\n                   .write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override display<T>(output: Output<T>): Output<T> {\n    return output; // blank\n  }\n\n  override toString(): string {\n    return \"\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {PairBuilder} from \"@swim/util\";\nimport {AnyUriQuery, UriQuery} from \"./UriQuery\";\n\n/** @public */\nexport class UriQueryBuilder implements PairBuilder<string | undefined, string, UriQuery> {\n  /** @internal */\n  first: UriQuery;\n  /** @internal */\n  last: UriQuery | null;\n  /** @internal */\n  size: number;\n  /** @internal */\n  aliased: number;\n\n  constructor() {\n    this.first = UriQuery.undefined();\n    this.last = null;\n    this.size = 0;\n    this.aliased = 0;\n  }\n\n  isEmpty(): boolean {\n    return this.size === 0;\n  }\n\n  add(key: string | undefined, value: string): void;\n  add(params: AnyUriQuery): void;\n  add(key: AnyUriQuery | undefined, value?: string): void {\n    if (value !== void 0) {\n      this.addParam(key as string | undefined, value);\n    } else if (typeof key === \"string\") {\n      this.addParam(void 0, key);\n    } else if (key instanceof UriQuery) {\n      this.addQuery(key);\n    } else {\n      const params = key!;\n      for (const k in params) {\n        let key = k as string | undefined;\n        const value = params[k]!;\n        if (k.charCodeAt(0) === 36/*'$'*/) {\n          key = void 0;\n        }\n        this.addParam(key, value);\n      }\n    }\n  }\n\n  bind(): UriQuery {\n    this.aliased = 0;\n    return this.first;\n  }\n\n  addParam(value: string): void;\n  addParam(key: string | undefined, value: string): void;\n  addParam(key: string | undefined, value?: string): void {\n    if (value === void 0) {\n      value = key!;\n      key = void 0;\n    }\n    const tail = UriQuery.param(key, value, UriQuery.undefined());\n    const size = this.size;\n    if (size === 0) {\n      this.first = tail;\n    } else {\n      this.dealias(size - 1).setTail(tail);\n    }\n    this.last = tail;\n    this.size = size + 1;\n    this.aliased += 1;\n  }\n\n  addQuery(query: UriQuery): void {\n    if (!query.isEmpty()) {\n      let size = this.size;\n      if (size === 0) {\n        this.first = query;\n      } else {\n        this.dealias(size - 1).setTail(query);\n      }\n      size += 1;\n      do {\n        const tail = query.tail();\n        if (!tail.isEmpty()) {\n          query = tail;\n          size += 1;\n        } else {\n          break;\n        }\n      } while (true);\n      this.last = query;\n      this.size = size;\n    }\n  }\n\n  /** @internal */\n  dealias(n: number): UriQuery {\n    let i = 0;\n    let xi: UriQuery | null = null;\n    let xs = this.first;\n    if (this.aliased <= n) {\n      while (i < this.aliased) {\n        xi = xs;\n        xs = xs.tail();\n        i += 1;\n      }\n      while (i <= n) {\n        const xn = xs.dealias();\n        if (i === 0) {\n          this.first = xn;\n        } else {\n          xi!.setTail(xn);\n        }\n        xi = xn;\n        xs = xs.tail();\n        i += 1;\n      }\n      if (i === this.size) {\n        this.last = xi;\n      }\n      this.aliased = i;\n    } else if (n === 0) {\n      xi = this.first;\n    } else if (n === this.size - 1) {\n      xi = this.last;\n    } else {\n      while (i <= n) {\n        xi = xs;\n        xs = xs.tail();\n        i += 1;\n      }\n    }\n    return xi!;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Compare, Mutable, Strings, HashGenCacheMap} from \"@swim/util\";\nimport {Output, Format, Debug, Display} from \"@swim/codec\";\nimport {Uri} from \"./Uri\";\n\n/** @public */\nexport type AnyUriFragment = UriFragment | string;\n\n/** @public */\nexport class UriFragment implements HashCode, Compare, Debug, Display {\n  /** @internal */\n  constructor(identifier: string | undefined) {\n    this.identifier = identifier;\n    this.stringValue = void 0;\n  }\n\n  isDefined(): boolean {\n    return this.identifier !== void 0;\n  }\n\n  readonly identifier: string | undefined;\n\n  toAny(): string | undefined {\n    return this.identifier;\n  }\n\n  compareTo(that: UriFragment): number {\n    if (that instanceof UriFragment) {\n      return this.toString().localeCompare(that.toString());\n    }\n    return NaN;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof UriFragment) {\n      return this.identifier === that.identifier;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Strings.hash(this.identifier);\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"UriFragment\").write(46/*'.'*/);\n    if (this.isDefined()) {\n      output = output.write(\"parse\").write(40/*'('*/).write(34/*'\"'*/)\n                     .display(this).write(34/*'\"'*/).write(41/*')'*/);\n    } else {\n      output = output.write(\"undefined\").write(40/*'('*/).write(41/*')'*/);\n    }\n    return output;\n  }\n\n  display<T>(output: Output<T>): Output<T> {\n    const stringValue = this.stringValue;\n    if (stringValue !== void 0) {\n      output = output.write(stringValue);\n    } else if (this.identifier !== void 0) {\n      output = Uri.writeFragment(output, this.identifier);\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = Format.display(this);\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  @Lazy\n  static undefined(): UriFragment {\n    return new UriFragment(void 0);\n  }\n\n  static create(identifier: string | undefined): UriFragment {\n    if (identifier !== void 0) {\n      const cache = UriFragment.cache;\n      const fragment = cache.get(identifier);\n      if (fragment !== void 0) {\n        return fragment;\n      } else {\n        return cache.put(identifier, new UriFragment(identifier));\n      }\n    } else {\n      return UriFragment.undefined();\n    }\n  }\n\n  static fromAny(value: AnyUriFragment | null | undefined): UriFragment {\n    if (value === void 0 || value === null) {\n      return UriFragment.undefined();\n    } else if (value instanceof UriFragment) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return UriFragment.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static parse(fragmentPart: string): UriFragment {\n    return Uri.standardParser.parseFragmentString(fragmentPart);\n  }\n\n  /** @internal */\n  @Lazy\n  static get cache(): HashGenCacheMap<string, UriFragment> {\n    const cacheSize = 32;\n    return new HashGenCacheMap<string, UriFragment>(cacheSize);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Text, Form} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"./Uri\";\n\n/** @internal */\nexport class UriForm extends Form<Uri, AnyUri> {\n  constructor(unit: Uri | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: Uri | undefined;\n\n  override withUnit(unit: Uri | undefined): Form<Uri, AnyUri> {\n    if (unit !== this.unit) {\n      return new UriForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(object: AnyUri, item?: Item): Item {\n    object = Uri.fromAny(object);\n    if (item === void 0) {\n      return Text.from(object.toString());\n    } else {\n      return item.concat(Text.from(object.toString()));\n    }\n  }\n\n  override cast(item: Item, object?: Uri): Uri | undefined {\n    const value = item.target;\n    try {\n      const string = value.stringValue();\n      if (typeof string === \"string\") {\n        return Uri.parse(string);\n      }\n    } catch (error) {\n      // swallow\n    }\n    return void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashGenCacheMap} from \"@swim/util\";\nimport {AnyUri, Uri} from \"./Uri\";\n\n/** @public */\nexport class UriCache {\n  constructor(base: Uri, size: number = 32) {\n    this.base = base;\n    this.resolveCache = new HashGenCacheMap(size);\n    this.unresolveCache = new HashGenCacheMap(size);\n  }\n\n  readonly base: Uri;\n\n  /** @internal */\n  readonly resolveCache: HashGenCacheMap<Uri, Uri>;\n\n  /** @internal */\n  readonly unresolveCache: HashGenCacheMap<Uri, Uri>;\n\n  resolve(relative: AnyUri): Uri {\n    relative = Uri.fromAny(relative);\n    let absolute = this.resolveCache.get(relative as Uri);\n    if (absolute === void 0) {\n      absolute = this.base.resolve(relative);\n      this.resolveCache.put(relative as Uri, absolute);\n    }\n    return absolute;\n  }\n\n  unresolve(absolute: AnyUri): Uri {\n    absolute = Uri.fromAny(absolute);\n    let relative = this.unresolveCache.get(absolute as Uri);\n    if (relative === void 0) {\n      relative = this.base.unresolve(absolute);\n      this.unresolveCache.put(absolute as Uri, relative);\n    }\n    return relative;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport {UriScheme} from \"../UriScheme\";\nimport {UriAuthority} from \"../UriAuthority\";\nimport {UriUser} from \"../UriUser\";\nimport {UriHost} from \"../UriHost\";\nimport {UriPort} from \"../UriPort\";\nimport {UriPath} from \"../UriPath\";\nimport {UriPathBuilder} from \"../UriPathBuilder\";\nimport type {UriQuery} from \"../UriQuery\";\nimport {UriQueryBuilder} from \"../UriQueryBuilder\";\nimport {UriFragment} from \"../UriFragment\";\nimport {UriAbsoluteParser} from \"../\"; // forward import\nimport {UriSchemeParser} from \"../\"; // forward import\nimport {UriAuthorityParser} from \"../\"; // forward import\nimport {UriUserParser} from \"../\"; // forward import\nimport {UriHostParser} from \"../\"; // forward import\nimport {UriHostAddressParser} from \"../\"; // forward import\nimport {UriHostLiteralParser} from \"../\"; // forward import\nimport {UriPortParser} from \"../\"; // forward import\nimport {UriPathParser} from \"../\"; // forward import\nimport {UriQueryParser} from \"../\"; // forward import\nimport {UriFragmentParser} from \"../\"; // forward import\n\n/** @public */\nexport class UriParser {\n  absolute(scheme?: UriScheme, authority?: UriAuthority, path?: UriPath,\n           query?: UriQuery, fragment?: UriFragment): Uri {\n    return Uri.create(scheme, authority, path, query, fragment);\n  }\n\n  scheme(name: string): UriScheme {\n    return UriScheme.create(name);\n  }\n\n  authority(user?: UriUser, host?: UriHost, port?: UriPort): UriAuthority {\n    return UriAuthority.create(user, host, port);\n  }\n\n  user(username: string | undefined, password?: string | undefined): UriUser {\n    return UriUser.create(username, password);\n  }\n\n  hostName(address: string): UriHost {\n    return UriHost.hostname(address);\n  }\n\n  hostIPv4(address: string): UriHost {\n    return UriHost.ipv4(address);\n  }\n\n  hostIPv6(address: string): UriHost {\n    return UriHost.ipv6(address);\n  }\n\n  port(number: number): UriPort {\n    return UriPort.create(number);\n  }\n\n  pathEmpty(): UriPath {\n    return UriPath.empty();\n  }\n\n  pathBuilder(): UriPathBuilder {\n    return new UriPathBuilder();\n  }\n\n  queryBuilder(): UriQueryBuilder {\n    return new UriQueryBuilder();\n  }\n\n  fragment(identifier: string | undefined): UriFragment {\n    return UriFragment.create(identifier);\n  }\n\n  absoluteParser(): Parser<Uri> {\n    return new UriAbsoluteParser(this);\n  }\n\n  parseAbsolute(input: Input): Parser<Uri> {\n    return UriAbsoluteParser.parse(input, this);\n  }\n\n  parseAbsoluteString(string: string): Uri {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseAbsolute(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  schemeParser(): Parser<UriScheme> {\n    return new UriSchemeParser(this);\n  }\n\n  parseScheme(input: Input): Parser<UriScheme> {\n    return UriSchemeParser.parse(input, this);\n  }\n\n  parseSchemeString(string: string): UriScheme {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseScheme(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  authorityParser(): Parser<UriAuthority> {\n    return new UriAuthorityParser(this);\n  }\n\n  parseAuthority(input: Input): Parser<UriAuthority> {\n    return UriAuthorityParser.parse(input, this);\n  }\n\n  parseAuthorityString(string: string): UriAuthority {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseAuthority(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  userParser(): Parser<UriUser> {\n    return new UriUserParser(this);\n  }\n\n  parseUser(input: Input): Parser<UriUser> {\n    return UriUserParser.parse(input, this);\n  }\n\n  parseUserString(string: string): UriUser {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseUser(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  hostParser(): Parser<UriHost> {\n    return new UriHostParser(this);\n  }\n\n  parseHost(input: Input): Parser<UriHost> {\n    return UriHostParser.parse(input, this);\n  }\n\n  parseHostString(string: string): UriHost {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseHost(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  hostAddressParser(): Parser<UriHost> {\n    return new UriHostAddressParser(this);\n  }\n\n  parseHostAddress(input: Input): Parser<UriHost> {\n    return UriHostAddressParser.parse(input, this);\n  }\n\n  hostLiteralParser(): Parser<UriHost> {\n    return new UriHostLiteralParser(this);\n  }\n\n  parseHostLiteral(input: Input): Parser<UriHost> {\n    return UriHostLiteralParser.parse(input, this);\n  }\n\n  portParser(): Parser<UriPort> {\n    return new UriPortParser(this);\n  }\n\n  parsePort(input: Input): Parser<UriPort> {\n    return UriPortParser.parse(input, this);\n  }\n\n  parsePortString(string: string): UriPort {\n    const input = Unicode.stringInput(string);\n    let parser = this.parsePort(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  pathParser(builder?: UriPathBuilder): Parser<UriPath> {\n    return new UriPathParser(this, builder);\n  }\n\n  parsePath(input: Input, builder?: UriPathBuilder): Parser<UriPath> {\n    return UriPathParser.parse(input, this, builder);\n  }\n\n  parsePathString(string: string): UriPath {\n    const input = Unicode.stringInput(string);\n    let parser = this.parsePath(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  queryParser(builder?: UriQueryBuilder): Parser<UriQuery> {\n    return new UriQueryParser(this, builder);\n  }\n\n  parseQuery(input: Input, builder?: UriQueryBuilder): Parser<UriQuery> {\n    return UriQueryParser.parse(input, this, builder);\n  }\n\n  parseQueryString(string: string): UriQuery {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseQuery(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  fragmentParser(): Parser<UriFragment> {\n    return new UriFragmentParser(this);\n  }\n\n  parseFragment(input: Input): Parser<UriFragment> {\n    return UriFragmentParser.parse(input, this);\n  }\n\n  parseFragmentString(string: string): UriFragment {\n    const input = Unicode.stringInput(string);\n    let parser = this.parseFragment(input);\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriScheme} from \"../UriScheme\";\nimport type {UriAuthority} from \"../UriAuthority\";\nimport {UriPath} from \"../UriPath\";\nimport type {UriQuery} from \"../UriQuery\";\nimport type {UriFragment} from \"../UriFragment\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriAbsoluteParser extends Parser<Uri> {\n  private readonly uri: UriParser;\n  private readonly schemeParser: Parser<UriScheme> | undefined;\n  private readonly authorityParser: Parser<UriAuthority> | undefined;\n  private readonly pathParser: Parser<UriPath> | undefined;\n  private readonly queryParser: Parser<UriQuery> | undefined;\n  private readonly fragmentParser: Parser<UriFragment> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, schemeParser?: Parser<UriScheme>,\n              authorityParser?: Parser<UriAuthority>, pathParser?: Parser<UriPath>,\n              queryParser?: Parser<UriQuery>, fragmentParser?: Parser<UriFragment>, step?: number) {\n    super();\n    this.uri = uri;\n    this.schemeParser = schemeParser;\n    this.authorityParser = authorityParser;\n    this.pathParser = pathParser;\n    this.queryParser = queryParser;\n    this.fragmentParser = fragmentParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<Uri> {\n    return UriAbsoluteParser.parse(input, this.uri, this.schemeParser, this.authorityParser,\n                                   this.pathParser, this.queryParser, this.fragmentParser, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, schemeParser?: Parser<UriScheme>,\n               authorityParser?: Parser<UriAuthority>, pathParser?: Parser<UriPath>,\n               queryParser?: Parser<UriQuery>, fragmentParser?: Parser<UriFragment>,\n               step: number = 1): Parser<Uri> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        const look = input.clone();\n        while (look.isCont() && (c = look.head(), Uri.isSchemeChar(c))) {\n          look.step();\n        }\n        if (look.isCont() && c === 58/*':'*/) {\n          step = 2;\n        } else {\n          step = 3;\n        }\n      } else if (input.isDone()) {\n        step = 3;\n      }\n    }\n    if (step === 2) {\n      if (schemeParser === void 0) {\n        schemeParser = uri.parseScheme(input);\n      } else {\n        schemeParser = schemeParser.feed(input);\n      }\n      if (schemeParser.isDone()) {\n        if (input.isCont() && input.head() === 58/*':'*/) {\n          input = input.step();\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(58/*':'*/, input));\n        }\n      } else if (schemeParser.isError()) {\n        return schemeParser.asError();\n      }\n    }\n    if (step === 3) {\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 47/*'/'*/) {\n          input = input.step();\n          step = 4;\n        } else if (c === 63/*'?'*/) {\n          input = input.step();\n          step = 7;\n        } else if (c === 35/*'#'*/) {\n          input = input.step();\n          step = 8;\n        } else {\n          step = 6;\n        }\n      } else if (input.isDone()) {\n        return Parser.done(uri.absolute(schemeParser !== void 0 ? schemeParser.bind() : void 0));\n      }\n    }\n    if (step === 4) {\n      if (input.isCont() && input.head() === 47/*'/'*/) {\n        input = input.step();\n        step = 5;\n      } else if (input.isCont()) {\n        const pathBuilder = uri.pathBuilder();\n        pathBuilder.addSlash();\n        pathParser = uri.parsePath(input, pathBuilder);\n        step = 6;\n      } else if (input.isDone()) {\n        return Parser.done(uri.absolute(schemeParser !== void 0 ? schemeParser.bind() : void 0,\n                                        void 0,\n                                        UriPath.slash()));\n      }\n    }\n    if (step === 5) {\n      if (authorityParser === void 0) {\n        authorityParser = uri.parseAuthority(input);\n      } else {\n        authorityParser = authorityParser.feed(input);\n      }\n      if (authorityParser.isDone()) {\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 63/*'?'*/) {\n            input = input.step();\n            step = 7;\n          } else if (c === 35/*'#'*/) {\n            input = input.step();\n            step = 8;\n          } else {\n            step = 6;\n          }\n        } else if (input.isDone()) {\n          return Parser.done(uri.absolute(schemeParser !== void 0 ? schemeParser.bind() : void 0,\n                                          authorityParser !== void 0 ? authorityParser.bind() : void 0));\n        }\n      } else if (authorityParser.isError()) {\n        return authorityParser.asError();\n      }\n    }\n    if (step === 6) {\n      if (pathParser === void 0) {\n        pathParser = uri.parsePath(input);\n      } else {\n        pathParser = pathParser.feed(input);\n      }\n      if (pathParser.isDone()) {\n        if (input.isCont() && input.head() === 63/*'?'*/) {\n          input = input.step();\n          step = 7;\n        } else if (input.isCont() && input.head() === 35/*'#'*/) {\n          input = input.step();\n          step = 8;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.absolute(schemeParser !== void 0 ? schemeParser.bind() : void 0,\n                                          authorityParser !== void 0 ? authorityParser.bind() : void 0,\n                                          pathParser.bind()));\n        }\n      } else if (pathParser.isError()) {\n        return pathParser.asError();\n      }\n    }\n    if (step === 7) {\n      if (queryParser === void 0) {\n        queryParser = uri.parseQuery(input);\n      } else {\n        queryParser = queryParser.feed(input);\n      }\n      if (queryParser.isDone()) {\n        if (input.isCont() && input.head() === 35/*'#'*/) {\n          input = input.step();\n          step = 8;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.absolute(schemeParser !== void 0 ? schemeParser.bind() : void 0,\n                                          authorityParser !== void 0 ? authorityParser.bind() : void 0,\n                                          pathParser !== void 0 ? pathParser.bind() : void 0,\n                                          queryParser.bind()));\n        }\n      } else if (queryParser.isError()) {\n        return queryParser.asError();\n      }\n    }\n    if (step === 8) {\n      if (fragmentParser === void 0) {\n        fragmentParser = uri.parseFragment(input);\n      } else {\n        fragmentParser = fragmentParser.feed(input);\n      }\n      if (fragmentParser.isDone()) {\n        return Parser.done(uri.absolute(schemeParser !== void 0 ? schemeParser.bind() : void 0,\n                                        authorityParser !== void 0 ? authorityParser.bind() : void 0,\n                                        pathParser !== void 0 ? pathParser.bind() : void 0,\n                                        queryParser !== void 0 ? queryParser.bind() : void 0,\n                                        fragmentParser.bind()));\n      } else if (fragmentParser.isError()) {\n        return fragmentParser.asError();\n      }\n    }\n    return new UriAbsoluteParser(uri, schemeParser, authorityParser, pathParser,\n                                 queryParser, fragmentParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriScheme} from \"../UriScheme\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriSchemeParser extends Parser<UriScheme> {\n  private readonly uri: UriParser;\n  private readonly output: Output<string> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, output?: Output<string>, step?: number) {\n    super();\n    this.uri = uri;\n    this.output = output;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriScheme> {\n    return UriSchemeParser.parse(input, this.uri, this.output, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, output?: Output<string>, step: number = 1): Parser<UriScheme> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont() && (c = input.head(), Uri.isAlpha(c))) {\n        input = input.step();\n        output = output || Utf8.decodedString();\n        output = output.write(Uri.toLowerCase(c));\n        step = 2;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"scheme\", input));\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Uri.isSchemeChar(c))) {\n        input = input.step();\n        output!.write(Uri.toLowerCase(c));\n      }\n      if (!input.isEmpty()) {\n        return Parser.done(uri.scheme(output!.bind()));\n      }\n    }\n    return new UriSchemeParser(uri, output, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Diagnostic, Parser} from \"@swim/codec\";\nimport type {UriAuthority} from \"../UriAuthority\";\nimport type {UriUser} from \"../UriUser\";\nimport type {UriHost} from \"../UriHost\";\nimport type {UriPort} from \"../UriPort\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriAuthorityParser extends Parser<UriAuthority> {\n  private readonly uri: UriParser;\n  private readonly userParser: Parser<UriUser> | undefined;\n  private readonly hostParser: Parser<UriHost> | undefined;\n  private readonly portParser: Parser<UriPort> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, userParser?: Parser<UriUser>, hostParser?: Parser<UriHost>,\n              portParser?: Parser<UriPort>, step?: number) {\n    super();\n    this.uri = uri;\n    this.userParser = userParser;\n    this.hostParser = hostParser;\n    this.portParser = portParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriAuthority> {\n    return UriAuthorityParser.parse(input, this.uri, this.userParser, this.hostParser,\n                                    this.portParser, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, userParser?: Parser<UriUser>, hostParser?: Parser<UriHost>,\n               portParser?: Parser<UriPort>, step: number = 1): Parser<UriAuthority> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont()) {\n        const look = input.clone();\n        while (look.isCont() && (c = look.head(), c !== 64/*'@'*/ && c !== 47/*'/'*/)) {\n          look.step();\n        }\n        if (look.isCont() && c === 64/*'@'*/) {\n          step = 2;\n        } else {\n          step = 3;\n        }\n      } else if (input.isDone()) {\n        step = 3;\n      }\n    }\n    if (step === 2) {\n      if (userParser === void 0) {\n        userParser = uri.parseUser(input);\n      } else {\n        userParser = userParser.feed(input);\n      }\n      if (userParser.isDone()) {\n        if (input.isCont() && input.head() === 64/*'@'*/) {\n          input = input.step();\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(64/*'@'*/, input));\n        }\n      } else if (userParser.isError()) {\n        return userParser.asError();\n      }\n    }\n    if (step === 3) {\n      if (hostParser === void 0) {\n        hostParser = uri.parseHost(input);\n      } else {\n        hostParser = hostParser.feed(input);\n      }\n      if (hostParser.isDone()) {\n        if (input.isCont() && input.head() === 58/*':'*/) {\n          input = input.step();\n          step = 4;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.authority(userParser !== void 0 ? userParser.bind() : void 0,\n                                           hostParser.bind()));\n        }\n      } else if (hostParser.isError()) {\n        return hostParser.asError();\n      }\n    }\n    if (step === 4) {\n      if (portParser === void 0) {\n        portParser = uri.parsePort(input);\n      } else {\n        portParser = portParser.feed(input);\n      }\n      if (portParser.isDone()) {\n        return Parser.done(uri.authority(userParser !== void 0 ? userParser.bind() : void 0,\n                                         hostParser!.bind(),\n                                         portParser.bind()));\n      } else if (portParser.isError()) {\n        return portParser.asError();\n      }\n    }\n    return new UriAuthorityParser(uri, userParser, hostParser, portParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Base16, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriUser} from \"../UriUser\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriUserParser extends Parser<UriUser> {\n  private readonly uri: UriParser;\n  private readonly usernameOutput: Output<string> | undefined;\n  private readonly passwordOutput: Output<string> | undefined;\n  private readonly c1: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, usernameOutput?: Output<string>,\n              passwordOutput?: Output<string>, c1?: number, step?: number) {\n    super();\n    this.uri = uri;\n    this.usernameOutput = usernameOutput;\n    this.passwordOutput = passwordOutput;\n    this.c1 = c1;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriUser> {\n    return UriUserParser.parse(input, this.uri, this.usernameOutput,\n                               this.passwordOutput, this.c1, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, usernameOutput?: Output<string>,\n               passwordOutput?: Output<string>, c1: number = 0, step: number = 1): Parser<UriUser> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        usernameOutput = usernameOutput || Utf8.decodedString();\n        while (input.isCont() && (c = input.head(), Uri.isUserChar(c))) {\n          input = input.step();\n          usernameOutput!.write(c);\n        }\n        if (input.isCont() && c === 58/*':'*/) {\n          input = input.step();\n          step = 4;\n        } else if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 2;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.user(usernameOutput.bind()));\n        }\n      }\n      if (step === 2) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 3) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          usernameOutput!.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 1;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 4) {\n        passwordOutput = passwordOutput || Utf8.decodedString();\n        while (input.isCont() && (c = input.head(), Uri.isUserInfoChar(c))) {\n          input = input.step();\n          passwordOutput.write(c);\n        }\n        if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 5;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.user(usernameOutput!.bind(), passwordOutput.bind()));\n        }\n      }\n      if (step === 5) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 6;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 6) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          passwordOutput!.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 4;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new UriUserParser(uri, usernameOutput, passwordOutput, c1, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {UriHost} from \"../UriHost\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriHostParser extends Parser<UriHost> {\n  private readonly uri: UriParser;\n\n  constructor(uri: UriParser) {\n    super();\n    this.uri = uri;\n  }\n\n  override feed(input: Input): Parser<UriHost> {\n    return UriHostParser.parse(input, this.uri);\n  }\n\n  static parse(input: Input, uri: UriParser): Parser<UriHost> {\n    if (input.isCont()) {\n      const c = input.head();\n      if (c === 91/*'['*/) {\n        return uri.parseHostLiteral(input);\n      } else {\n        return uri.parseHostAddress(input);\n      }\n    } else if (input.isDone()) {\n      return Parser.done(uri.hostName(\"\"));\n    }\n    return new UriHostParser(uri);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Base10, Base16, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriHost} from \"../UriHost\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriHostAddressParser extends Parser<UriHost> {\n  private readonly uri: UriParser;\n  private readonly output: Output<string> | undefined;\n  private readonly c1: number | undefined;\n  private readonly x: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, output?: Output<string>, c1?: number, x?: number, step?: number) {\n    super();\n    this.uri = uri;\n    this.output = output;\n    this.c1 = c1;\n    this.x = x;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriHost> {\n    return UriHostAddressParser.parse(input, this.uri, this.output, this.c1, this.x, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, output?: Output<string>,\n               c1: number = 0, x: number = 0, step: number = 1): Parser<UriHost> {\n    let c = 0;\n    output = output || Utf8.decodedString();\n    while (step <= 4) {\n      while (input.isCont() && (c = input.head(), Base10.isDigit(c))) {\n        input = input.step();\n        output = output.write(c);\n        x = 10 * x + Base10.decodeDigit(c);\n      }\n      if (input.isCont()) {\n        if (c === 46/*'.'*/ && step < 4 && x <= 255) {\n          input = input.step();\n          output = output.write(c);\n          x = 0;\n          step += 1;\n        } else if (!Uri.isHostChar(c) && c !== 37/*'%'*/ && step === 4 && x <= 255) {\n          return Parser.done(uri.hostIPv4(output.bind()));\n        } else {\n          x = 0;\n          step = 5;\n          break;\n        }\n      } else if (!input.isEmpty()) {\n        if (step === 4 && x <= 255) {\n          return Parser.done(uri.hostIPv4(output.bind()));\n        } else {\n          return Parser.done(uri.hostName(output.bind()));\n        }\n      } else {\n        break;\n      }\n    }\n    do {\n      if (step === 5) {\n        while (input.isCont() && (c = input.head(), Uri.isHostChar(c))) {\n          input = input.step();\n          output!.write(Uri.toLowerCase(c));\n        }\n        if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 6;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.hostName(output!.bind()));\n        }\n      }\n      if (step === 6) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 7;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 7) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          output!.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 5;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new UriHostAddressParser(uri, output, c1, x, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriHost} from \"../UriHost\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriHostLiteralParser extends Parser<UriHost> {\n  private readonly uri: UriParser;\n  private readonly output: Output<string> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, output?: Output<string>, step?: number) {\n    super();\n    this.uri = uri;\n    this.output = output;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriHost> {\n    return UriHostLiteralParser.parse(input, this.uri, this.output, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, output?: Output<string>, step: number = 1): Parser<UriHost> {\n    let c = 0;\n    if (step === 1) {\n      if (input.isCont() && input.head() === 91/*'['*/) {\n        input = input.step();\n        step = 2;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(91/*'['*/, input));\n      }\n    }\n    if (step === 2) {\n      output = output || Utf8.decodedString();\n      while (input.isCont() && (c = input.head(), Uri.isHostChar(c) || c === 58/*':'*/)) {\n        input = input.step();\n        output = output.write(Uri.toLowerCase(c));\n      }\n      if (input.isCont() && c === 93/*']'*/) {\n        input = input.step();\n        return Parser.done(uri.hostIPv6(output.bind()));\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(93/*']'*/, input));\n      }\n    }\n    return new UriHostLiteralParser(uri, output, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Base10} from \"@swim/codec\";\nimport type {UriPort} from \"../UriPort\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriPortParser extends Parser<UriPort> {\n  private readonly uri: UriParser;\n  private readonly number: number | undefined;\n\n  constructor(uri: UriParser, number?: number) {\n    super();\n    this.uri = uri;\n    this.number = number;\n  }\n\n  override feed(input: Input): Parser<UriPort> {\n    return UriPortParser.parse(input, this.uri, this.number);\n  }\n\n  static parse(input: Input, uri: UriParser, number: number = 0): Parser<UriPort> {\n    let c = 0;\n    while (input.isCont() && (c = input.head(), Base10.isDigit(c))) {\n      input = input.step();\n      number = 10 * number + Base10.decodeDigit(c);\n    }\n    if (!input.isEmpty()) {\n      return Parser.done(uri.port(number));\n    }\n    return new UriPortParser(uri, number);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Base16, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriPath} from \"../UriPath\";\nimport type {UriPathBuilder} from \"../UriPathBuilder\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriPathParser extends Parser<UriPath> {\n  private readonly uri: UriParser;\n  private readonly builder: UriPathBuilder | undefined;\n  private readonly output: Output<string> | undefined;\n  private readonly c1: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, builder?: UriPathBuilder, output?: Output<string>,\n              c1?: number, step?: number) {\n    super();\n    this.uri = uri;\n    this.builder = builder;\n    this.output = output;\n    this.c1 = c1;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriPath> {\n    return UriPathParser.parse(input, this.uri, this.builder, this.output, this.c1, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, builder?: UriPathBuilder, output?: Output<string>,\n               c1: number = 0, step: number = 1): Parser<UriPath> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        while (input.isCont() && (c = input.head(), Uri.isPathChar(c))) {\n          output = output || Utf8.decodedString();\n          input = input.step();\n          output = output.write(c);\n        }\n        if (input.isCont() && c === 47/*'/'*/) {\n          input = input.step();\n          builder = builder || uri.pathBuilder();\n          if (output !== void 0) {\n            builder.addSegment(output.bind());\n            output = void 0;\n          }\n          builder.addSlash();\n          continue;\n        } else if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 2;\n        } else if (!input.isEmpty()) {\n          if (output !== void 0) {\n            builder = builder || uri.pathBuilder();\n            builder.addSegment(output.bind());\n          }\n          if (builder !== void 0) {\n            return Parser.done(builder.bind());\n          } else {\n            return Parser.done(uri.pathEmpty());\n          }\n        }\n      }\n      if (step === 2) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 3) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          output = output || Utf8.decodedString();\n          input = input.step();\n          output = output.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 1;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new UriPathParser(uri, builder, output, c1, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Base16, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriQuery} from \"../UriQuery\";\nimport type {UriQueryBuilder} from \"../UriQueryBuilder\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriQueryParser extends Parser<UriQuery> {\n  private readonly uri: UriParser;\n  private readonly builder: UriQueryBuilder | undefined;\n  private readonly keyOutput: Output<string> | undefined;\n  private readonly valueOutput: Output<string> | undefined;\n  private readonly c1: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, builder?: UriQueryBuilder, keyOutput?: Output<string>,\n              valueOutput?: Output<string>, c1?: number, step?: number) {\n    super();\n    this.uri = uri;\n    this.builder = builder;\n    this.keyOutput = keyOutput;\n    this.valueOutput = valueOutput;\n    this.c1 = c1;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriQuery> {\n    return UriQueryParser.parse(input, this.uri, this.builder, this.keyOutput,\n                                this.valueOutput, this.c1, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, builder?: UriQueryBuilder, keyOutput?: Output<string>,\n               valueOutput?: Output<string>, c1: number = 0, step: number = 1): Parser<UriQuery> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        keyOutput = keyOutput || Utf8.decodedString();\n        while (input.isCont() && (c = input.head(), Uri.isParamChar(c))) {\n          input = input.step();\n          keyOutput.write(c);\n        }\n        if (input.isCont() && c === 61/*'='*/) {\n          input = input.step();\n          step = 4;\n        } else if (input.isCont() && c === 38/*'&'*/) {\n          input = input.step();\n          builder = builder || uri.queryBuilder();\n          builder.addParam(keyOutput.bind());\n          keyOutput = void 0;\n          continue;\n        } else if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 2;\n        } else if (!input.isEmpty()) {\n          builder = builder || uri.queryBuilder();\n          builder.addParam(keyOutput.bind());\n          return Parser.done(builder.bind());\n        }\n      }\n      if (step === 2) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 3) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          keyOutput!.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 1;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 4) {\n        valueOutput = valueOutput || Utf8.decodedString();\n        while (input.isCont() && (c = input.head(), Uri.isParamChar(c) || c === 61/*'='*/)) {\n          input = input.step();\n          valueOutput.write(c);\n        }\n        if (input.isCont() && c === 38/*'&'*/) {\n          input = input.step();\n          builder = builder || uri.queryBuilder();\n          builder.addParam(keyOutput!.bind(), valueOutput.bind());\n          keyOutput = void 0;\n          valueOutput = void 0;\n          step = 1;\n          continue;\n        } else if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 5;\n        } else if (!input.isEmpty()) {\n          builder = builder || uri.queryBuilder();\n          builder.addParam(keyOutput!.bind(), valueOutput.bind());\n          return Parser.done(builder.bind());\n        }\n      }\n      if (step === 5) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 6;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 6) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          valueOutput!.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 4;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new UriQueryParser(uri, builder, keyOutput, valueOutput, c1, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Base16, Utf8} from \"@swim/codec\";\nimport {Uri} from \"../Uri\";\nimport type {UriFragment} from \"../UriFragment\";\nimport type {UriParser} from \"./UriParser\";\n\n/** @internal */\nexport class UriFragmentParser extends Parser<UriFragment> {\n  private readonly uri: UriParser;\n  private readonly output: Output<string> | undefined;\n  private readonly c1: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(uri: UriParser, output?: Output<string>, c1?: number, step?: number) {\n    super();\n    this.uri = uri;\n    this.output = output;\n    this.c1 = c1;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<UriFragment> {\n    return UriFragmentParser.parse(input, this.uri, this.output, this.c1, this.step);\n  }\n\n  static parse(input: Input, uri: UriParser, output?: Output<string>,\n               c1: number = 0, step: number = 1): Parser<UriFragment> {\n    let c = 0;\n    output = output || Utf8.decodedString();\n    do {\n      if (step === 1) {\n        while (input.isCont() && (c = input.head(), Uri.isFragmentChar(c))) {\n          input = input.step();\n          output = output.write(c);\n        }\n        if (input.isCont() && c === 37/*'%'*/) {\n          input = input.step();\n          step = 2;\n        } else if (!input.isEmpty()) {\n          return Parser.done(uri.fragment(output.bind()));\n        }\n      }\n      if (step === 2) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          c1 = c;\n          step = 3;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      if (step === 3) {\n        if (input.isCont() && (c = input.head(), Base16.isDigit(c))) {\n          input = input.step();\n          output = output.write((Base16.decodeDigit(c1) << 4) | Base16.decodeDigit(c));\n          c1 = 0;\n          step = 1;\n          continue;\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.expected(\"hex digit\", input));\n        }\n      }\n      break;\n    } while (true);\n    return new UriFragmentParser(uri, output, c1, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/** @public */\nexport class LengthException extends Error {\n  constructor(message?: string) {\n    super(message);\n    Object.setPrototypeOf(this, LengthException.prototype);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Equivalent, Compare, Interpolate, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Debug, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Attr, Value, Text, Form} from \"@swim/structure\";\nimport {LengthException} from \"./LengthException\";\nimport {PxLength} from \"../\"; // forward import\nimport {EmLength} from \"../\"; // forward import\nimport {RemLength} from \"../\"; // forward import\nimport {PctLength} from \"../\"; // forward import\nimport {UnitlessLength} from \"../\"; // forward import\nimport {LengthInterpolator} from \"../\"; // forward import\nimport {LengthForm} from \"../\"; // forward import\nimport {LengthParser} from \"../\"; // forward import\n\n/** @public */\nexport type LengthUnits = \"px\" | \"em\" | \"rem\" | \"%\" | \"\";\n\n/** @public */\nexport interface LengthBasis {\n  emUnit?: Node | number;\n  remUnit?: number;\n  pctUnit?: number;\n}\n\n/** @public */\nexport type AnyLength = Length | string | number;\n\n/** @public */\nexport abstract class Length implements Interpolate<Length>, HashCode, Equivalent, Compare, Debug {\n  isDefined(): boolean {\n    return isFinite(this.value);\n  }\n\n  abstract readonly value: number;\n\n  abstract readonly units: LengthUnits;\n\n  plus(that: AnyLength, units: LengthUnits = this.units, basis?: LengthBasis | number): Length {\n    that = Length.fromAny(that);\n    return Length.create(this.toValue(units, basis) + that.toValue(units, basis), units);\n  }\n\n  negative(units: LengthUnits = this.units, basis?: LengthBasis | number): Length {\n    return Length.create(-this.toValue(units, basis), units);\n  }\n\n  minus(that: AnyLength, units: LengthUnits = this.units, basis?: LengthBasis | number): Length {\n    that = Length.fromAny(that);\n    return Length.create(this.toValue(units, basis) - that.toValue(units, basis), units);\n  }\n\n  times(scalar: number, units: LengthUnits = this.units, basis?: LengthBasis | number): Length {\n    return Length.create(this.toValue(units, basis) * scalar, units);\n  }\n\n  divide(scalar: number, units: LengthUnits = this.units, basis?: LengthBasis | number): Length {\n    return Length.create(this.toValue(units, basis) / scalar, units);\n  }\n\n  combine(that: AnyLength, scalar: number = 1, units: LengthUnits = this.units, basis?: LengthBasis | number): Length {\n    that = Length.fromAny(that);\n    return Length.create(this.toValue(units, basis) + that.toValue(units, basis) * scalar, units);\n  }\n\n  abstract pxValue(basis?: LengthBasis | number): number;\n\n  emValue(basis?: LengthBasis | number): number {\n    return this.value !== 0 ? this.pxValue(basis) / Length.emUnit(basis) : 0;\n  }\n\n  remValue(basis?: LengthBasis | number): number {\n    return this.value !== 0 ? this.pxValue(basis) / Length.remUnit(basis) : 0;\n  }\n\n  pctValue(basis?: LengthBasis | number): number {\n    return this.value !== 0 ? this.pxValue(basis) / Length.pctUnit(basis) : 0;\n  }\n\n  px(basis?: LengthBasis | number): PxLength {\n    return Length.px(this.pxValue(basis));\n  }\n\n  em(basis?: LengthBasis | number): EmLength {\n    return Length.em(this.emValue(basis));\n  }\n\n  rem(basis?: LengthBasis | number): RemLength {\n    return Length.rem(this.remValue(basis));\n  }\n\n  pct(basis?: LengthBasis | number): PctLength {\n    return Length.pct(this.pctValue(basis));\n  }\n\n  toValue(): Value;\n  toValue(units: LengthUnits, basis?: LengthBasis | number): number;\n  toValue(units?: LengthUnits, basis?: LengthBasis | number): Value | number {\n    if (units === void 0) {\n      return Text.from(this.toString());\n    } else {\n      switch (units) {\n        case \"px\": return this.pxValue(basis);\n        case \"em\": return this.emValue(basis);\n        case \"rem\": return this.remValue(basis);\n        case \"%\": return this.pctValue(basis);\n        default: throw new LengthException(\"unknown length units: \" + units);\n      }\n    }\n  }\n\n  to(units: LengthUnits, basis?: LengthBasis | number): Length {\n    switch (units) {\n      case \"px\": return this.px(basis);\n      case \"em\": return this.em(basis);\n      case \"rem\": return this.rem(basis);\n      case \"%\": return this.pct(basis);\n      default: throw new LengthException(\"unknown length units: \" + units);\n    }\n  }\n\n  abstract toCssValue(): CSSUnitValue | null;\n\n  interpolateTo(that: Length): Interpolator<Length>;\n  interpolateTo(that: unknown): Interpolator<Length> | null;\n  interpolateTo(that: unknown): Interpolator<Length> | null {\n    if (that instanceof Length) {\n      return LengthInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  abstract compareTo(that: unknown): number;\n\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  abstract toString(): string;\n\n  static zero(units?: LengthUnits): Length {\n    switch (units) {\n      case void 0:\n      case \"px\": return PxLength.zero();\n      case \"em\": return EmLength.zero();\n      case \"rem\": return RemLength.zero();\n      case \"%\": return PctLength.zero();\n      case \"\": return UnitlessLength.zero();\n      default: throw new LengthException(\"unknown length units: \" + units);\n    }\n  }\n\n  static px(value: number): PxLength {\n    return new PxLength(value);\n  }\n\n  static em(value: number): EmLength {\n    return new EmLength(value);\n  }\n\n  static rem(value: number): RemLength {\n    return new RemLength(value);\n  }\n\n  static pct(value: number): PctLength {\n    return new PctLength(value);\n  }\n\n  static unitless(value: number): UnitlessLength {\n    return new UnitlessLength(value);\n  }\n\n  static create(value: number, units?: LengthUnits): Length {\n    switch (units) {\n      case void 0:\n      case \"px\": return Length.px(value);\n      case \"em\": return Length.em(value);\n      case \"rem\": return Length.rem(value);\n      case \"%\": return Length.pct(value);\n      case \"\": return Length.unitless(value);\n      default: throw new LengthException(\"unknown length units: \" + units);\n    }\n  }\n\n  static fromCssValue(value: CSSStyleValue): Length {\n    if (value instanceof CSSUnitValue) {\n      return Length.create(value.value, value.unit as LengthUnits);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static fromAny(value: AnyLength, defaultUnits?: LengthUnits): Length {\n    if (value === void 0 || value === null || value instanceof Length) {\n      return value;\n    } else if (typeof value === \"number\") {\n      return Length.create(value, defaultUnits);\n    } else if (typeof value === \"string\") {\n      return Length.parse(value, defaultUnits);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromValue(value: Value): Length | null {\n    if (value.length === 2) {\n      const num = value.getItem(0).numberValue(void 0);\n      const units = value.getItem(1);\n      if (num !== void 0 && isFinite(num) && units instanceof Attr && units.value === Value.extant()) {\n        switch (units.key.value) {\n          case \"px\": return Length.px(num);\n          case \"em\": return Length.em(num);\n          case \"rem\": return Length.rem(num);\n          case \"pct\": return Length.pct(num);\n          default:\n        }\n      }\n    }\n    return null;\n  }\n\n  static parse(string: string, defaultUnits?: LengthUnits): Length {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = LengthParser.parse(input, defaultUnits);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  @Lazy\n  static form(): Form<Length, AnyLength> {\n    return new LengthForm(void 0, Length.zero());\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyLength {\n    return value instanceof Length\n        || typeof value === \"number\"\n        || typeof value === \"string\";\n  }\n\n  /** @internal */\n  static emUnit(basis?: LengthBasis | number): number {\n    if (typeof basis === \"object\" && typeof basis.emUnit === \"number\") {\n      return basis.emUnit;\n    } else if (typeof basis === \"object\" && basis.emUnit instanceof Node) {\n      let node: Node | null = basis.emUnit;\n      while (node !== null) {\n        if (node instanceof Element) {\n          const fontSize = getComputedStyle(node).fontSize;\n          if (typeof fontSize === \"string\") {\n            return parseFloat(fontSize);\n          }\n        }\n        node = node.parentNode;\n      }\n    }\n    throw new LengthException(\"unknown em unit\");\n  }\n\n  /** @internal */\n  static remUnit(basis?: LengthBasis | number): number {\n    if (typeof basis === \"object\" && typeof basis.remUnit === \"number\") {\n      return basis.remUnit;\n    } else {\n      const fontSize = getComputedStyle(document.documentElement).fontSize;\n      if (typeof fontSize === \"string\") {\n        return parseFloat(fontSize);\n      }\n    }\n    throw new LengthException(\"unknown rem unit\");\n  }\n\n  /** @internal */\n  static pctUnit(basis?: LengthBasis | number): number {\n    if (typeof basis === \"number\") {\n      return basis;\n    } else if (typeof basis === \"object\" && typeof basis.pctUnit === \"number\") {\n      return basis.pctUnit;\n    }\n    throw new LengthException(\"unknown percentage unit\");\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {LengthUnits, LengthBasis, Length} from \"./Length\";\n\n/** @public */\nexport class PxLength extends Length {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): LengthUnits {\n    return \"px\";\n  }\n\n  override pxValue(basis?: LengthBasis | number): number {\n    return this.value;\n  }\n\n  override px(basis?: LengthBasis | number): PxLength {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"px\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Length) {\n      const x = this.value;\n      const y = that.pxValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Length) {\n      return Numbers.equivalent(this.value, that.pxValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof PxLength) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(PxLength), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Length\").write(46/*'.'*/).write(\"px\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"px\";\n  }\n\n  @Lazy\n  static override zero(): PxLength {\n    return new PxLength(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {LengthUnits, LengthBasis, Length} from \"./Length\";\n\n/** @public */\nexport class EmLength extends Length {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): LengthUnits {\n    return \"em\";\n  }\n\n  override pxValue(basis?: LengthBasis | number): number {\n    return this.value !== 0 ? this.value * Length.emUnit(basis) : 0;\n  }\n\n  override emValue(basis?: LengthBasis | number): number {\n    return this.value;\n  }\n\n  override em(basis?: LengthBasis | number): EmLength {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"em\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Length) {\n      const x = this.value;\n      const y = that.emValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Length) {\n      return Numbers.equivalent(this.value, that.emValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof EmLength) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(EmLength), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Length\").write(46/*'.'*/).write(\"em\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"em\";\n  }\n\n  @Lazy\n  static override zero(): EmLength {\n    return new EmLength(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {LengthUnits, LengthBasis, Length} from \"./Length\";\n\n/** @public */\nexport class RemLength extends Length {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): LengthUnits {\n    return \"rem\";\n  }\n\n  override pxValue(basis?: LengthBasis | number): number {\n    return this.value !== 0 ? this.value * Length.remUnit(basis) : 0;\n  }\n\n  override remValue(basis?: LengthBasis | number): number {\n    return this.value;\n  }\n\n  override rem(basis?: LengthBasis | number): RemLength {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"rem\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof RemLength) {\n      const x = this.value;\n      const y = that.remValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof RemLength) {\n      return Numbers.equivalent(this.value, that.remValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof RemLength) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(RemLength), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Length\").write(46/*'.'*/).write(\"rem\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"rem\";\n  }\n\n  @Lazy\n  static override zero(): RemLength {\n    return new RemLength(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {LengthUnits, LengthBasis, Length} from \"./Length\";\n\n/** @public */\nexport class PctLength extends Length {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): LengthUnits {\n    return \"%\";\n  }\n\n  override pxValue(basis?: LengthBasis | number): number {\n    return this.value !== 0 ? this.value * Length.pctUnit(basis) / 100 : 0;\n  }\n\n  override pctValue(basis?: LengthBasis | number): number {\n    return this.value;\n  }\n\n  override pct(basis?: LengthBasis | number): PctLength {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"percent\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Length) {\n      const x = this.value;\n      const y = that.pctValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Length) {\n      return Numbers.equivalent(this.value, that.pctValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof PctLength) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(PctLength), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Length\").write(46/*'.'*/).write(\"pct\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"%\";\n  }\n\n  @Lazy\n  static override zero(): PctLength {\n    return new PctLength(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {LengthException} from \"./LengthException\";\nimport {LengthUnits, LengthBasis, Length} from \"./Length\";\n\n/** @public */\nexport class UnitlessLength extends Length {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): LengthUnits {\n    return \"\";\n  }\n\n  override pxValue(basis?: LengthBasis | number): number {\n    throw new LengthException(\"unitless length\");\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    return null;\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Length) {\n      const x = this.value;\n      const y = that.value;\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Length) {\n      return Numbers.equivalent(this.value, that.value);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof UnitlessLength) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(UnitlessLength), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Length\").write(46/*'.'*/).write(\"unitless\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"\";\n  }\n\n  @Lazy\n  static override zero(): UnitlessLength {\n    return new UnitlessLength(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Length} from \"./Length\";\n\n/** @internal */\nexport const LengthInterpolator = (function (_super: typeof Interpolator) {\n  const LengthInterpolator = function (l0: Length, l1: Length): Interpolator<Length> {\n    const interpolator = function (u: number): Length {\n      const l0 = interpolator[0];\n      const l1 = interpolator[1];\n      return Length.create(l0.value + u * (l1.value - l0.value), l1.units);\n    } as Interpolator<Length>;\n    Object.setPrototypeOf(interpolator, LengthInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = l0.to(l1.units);\n    (interpolator as Mutable<typeof interpolator>)[1] = l1;\n    return interpolator;\n  } as {\n    (l0: Length, l1: Length): Interpolator<Length>;\n\n    /** @internal */\n    prototype: Interpolator<Length>;\n  };\n\n  LengthInterpolator.prototype = Object.create(_super.prototype);\n  LengthInterpolator.prototype.constructor = LengthInterpolator;\n\n  return LengthInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Text, Form} from \"@swim/structure\";\nimport {LengthUnits, AnyLength, Length} from \"./Length\";\n\n/** @internal */\nexport class LengthForm extends Form<Length, AnyLength> {\n  constructor(defaultUnits: LengthUnits | undefined, unit: Length | undefined) {\n    super();\n    this.defaultUnits = defaultUnits;\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  readonly defaultUnits: LengthUnits | undefined;\n\n  override readonly unit!: Length | undefined;\n\n  override withUnit(unit: Length | undefined): Form<Length, AnyLength> {\n    if (unit !== this.unit) {\n      return new LengthForm(this.defaultUnits, unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(length: AnyLength): Item {\n    length = Length.fromAny(length, this.defaultUnits);\n    return Text.from(length.toString());\n  }\n\n  override cast(item: Item): Length | undefined {\n    const value = item.toValue();\n    let length: Length | null = null;\n    try {\n      length = Length.fromValue(value);\n      if (length !== void 0) {\n        const string = value.stringValue(void 0);\n        if (string !== void 0) {\n          length = Length.parse(string, this.defaultUnits);\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return length !== null ? length : void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {LengthUnits, Length} from \"./Length\";\n\n/** @internal */\nexport class LengthParser extends Parser<Length> {\n  private readonly defaultUnits: LengthUnits | undefined;\n  private readonly valueParser: Parser<number> | undefined;\n  private readonly unitsOutput: Output<string> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(defaultUnits?: LengthUnits, valueParser?: Parser<number>,\n              unitsOutput?: Output<string>, step?: number) {\n    super();\n    this.defaultUnits = defaultUnits;\n    this.valueParser = valueParser;\n    this.unitsOutput = unitsOutput;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<Length> {\n    return LengthParser.parse(input, this.defaultUnits, this.valueParser,\n                              this.unitsOutput, this.step);\n  }\n\n  static parse(input: Input, defaultUnits?: LengthUnits, valueParser?: Parser<number>,\n               unitsOutput?: Output<string>, step: number = 1): Parser<Length> {\n    let c = 0;\n    if (step === 1) {\n      if (valueParser === void 0) {\n        valueParser = Base10.parseDecimal(input);\n      } else {\n        valueParser = valueParser.feed(input);\n      }\n      if (valueParser.isDone()) {\n        step = 2;\n      } else if (valueParser.isError()) {\n        return valueParser.asError();\n      }\n    }\n    if (step === 2) {\n      unitsOutput = unitsOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || c === 37/*'%'*/)) {\n        input = input.step();\n        unitsOutput.push(c);\n      }\n      if (!input.isEmpty()) {\n        const value = valueParser!.bind();\n        const units = unitsOutput.bind() || defaultUnits;\n        switch (units) {\n          case \"px\": return Parser.done(Length.px(value));\n          case \"em\": return Parser.done(Length.em(value));\n          case \"rem\": return Parser.done(Length.rem(value));\n          case \"%\": return Parser.done(Length.pct(value));\n          case \"\":\n          case void 0: return Parser.done(Length.unitless(value));\n          default: return Parser.error(Diagnostic.message(\"unknown length units: \" + units, input));\n        }\n      }\n    }\n    return new LengthParser(defaultUnits, valueParser, unitsOutput, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Equivalent, Compare, Interpolate, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Debug, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Attr, Value, Text, Form} from \"@swim/structure\";\nimport {DegAngle} from \"../\"; // forward import\nimport {RadAngle} from \"../\"; // forward import\nimport {GradAngle} from \"../\"; // forward import\nimport {TurnAngle} from \"../\"; // forward import\nimport {AngleInterpolator} from \"../\"; // forward import\nimport {AngleForm} from \"../\"; // forward import\nimport {AngleParser} from \"../\"; // forward import\n\n/** @public */\nexport type AngleUnits = \"deg\" | \"rad\" | \"grad\" | \"turn\";\n\n/** @public */\nexport type AnyAngle = Angle | string | number;\n\n/** @public */\nexport abstract class Angle implements Interpolate<Angle>, HashCode, Equivalent, Compare, Debug {\n  isDefined(): boolean {\n    return isFinite(this.value);\n  }\n\n  abstract readonly value: number;\n\n  abstract readonly units: AngleUnits;\n\n  plus(that: AnyAngle, units: AngleUnits = this.units): Angle {\n    that = Angle.fromAny(that);\n    return Angle.create(this.toValue(units) + that.toValue(units), units);\n  }\n\n  negative(units: AngleUnits = this.units): Angle {\n    return Angle.create(-this.toValue(units), units);\n  }\n\n  minus(that: AnyAngle, units: AngleUnits = this.units): Angle {\n    that = Angle.fromAny(that);\n    return Angle.create(this.toValue(units) - that.toValue(units), units);\n  }\n\n  times(scalar: number, units: AngleUnits = this.units): Angle {\n    return Angle.create(this.toValue(units) * scalar, units);\n  }\n\n  divide(scalar: number, units: AngleUnits = this.units): Angle {\n    return Angle.create(this.toValue(units) / scalar, units);\n  }\n\n  combine(that: AnyAngle, scalar: number = 1, units: AngleUnits = this.units): Angle {\n    that = Angle.fromAny(that);\n    return Angle.create(this.toValue(units) + that.toValue(units) * scalar, units);\n  }\n\n  norm(total: AnyAngle, units: AngleUnits = this.units): Angle {\n    total = Angle.fromAny(total);\n    return Angle.create(this.toValue(units) / total.toValue(units), units);\n  }\n\n  abstract degValue(): number;\n\n  abstract gradValue(): number;\n\n  abstract radValue(): number;\n\n  abstract turnValue(): number;\n\n  deg(): DegAngle {\n    return Angle.deg(this.degValue());\n  }\n\n  rad(): RadAngle {\n    return Angle.rad(this.radValue());\n  }\n\n  grad(): GradAngle {\n    return Angle.grad(this.gradValue());\n  }\n\n  turn(): TurnAngle {\n    return Angle.turn(this.turnValue());\n  }\n\n  toValue(): Value;\n  toValue(units: AngleUnits): number;\n  toValue(units?: AngleUnits): Value | number {\n    if (units === void 0) {\n      return Text.from(this.toString());\n    } else {\n      switch (units) {\n        case \"deg\": return this.degValue();\n        case \"rad\": return this.radValue();\n        case \"grad\": return this.gradValue();\n        case \"turn\": return this.turnValue();\n        default: throw new Error(\"unknown angle units: \" + units);\n      }\n    }\n  }\n\n  to(units: AngleUnits): Angle {\n    switch (units) {\n      case \"deg\": return this.deg();\n      case \"rad\": return this.rad();\n      case \"grad\": return this.grad();\n      case \"turn\": return this.turn();\n      default: throw new Error(\"unknown angle units: \" + units);\n    }\n  }\n\n  abstract toCssValue(): CSSUnitValue | null;\n\n  interpolateTo(that: Angle): Interpolator<Angle>;\n  interpolateTo(that: unknown): Interpolator<Angle> | null;\n  interpolateTo(that: unknown): Interpolator<Angle> | null {\n    if (that instanceof Angle) {\n      return AngleInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  abstract compareTo(that: unknown): number;\n\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  abstract toString(): string;\n\n  static zero(units?: AngleUnits): Angle {\n    switch (units) {\n      case \"deg\": return DegAngle.zero();\n      case void 0:\n      case \"rad\": return RadAngle.zero();\n      case \"grad\": return GradAngle.zero();\n      case \"turn\": return TurnAngle.zero();\n      default: throw new Error(\"unknown angle units: \" + units);\n    }\n  }\n\n  static deg(value: number): DegAngle {\n    return new DegAngle(value);\n  }\n\n  static rad(value: number): RadAngle {\n    return new RadAngle(value);\n  }\n\n  static grad(value: number): GradAngle {\n    return new GradAngle(value);\n  }\n\n  static turn(value: number): TurnAngle {\n    return new TurnAngle(value);\n  }\n\n  static create(value: number, units?: AngleUnits): Angle {\n    switch (units) {\n      case \"deg\": return Angle.deg(value);\n      case void 0:\n      case \"rad\": return Angle.rad(value);\n      case \"grad\": return Angle.grad(value);\n      case \"turn\": return Angle.turn(value);\n      default: throw new Error(\"unknown angle units: \" + units);\n    }\n  }\n\n  static fromCssValue(value: CSSStyleValue): Angle {\n    if (value instanceof CSSUnitValue) {\n      return Angle.create(value.value, value.unit as AngleUnits);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static fromAny(value: AnyAngle, defaultUnits?: AngleUnits): Angle {\n    if (value === void 0 || value === null || value instanceof Angle) {\n      return value;\n    } else if (typeof value === \"number\") {\n      return Angle.create(value, defaultUnits);\n    } else if (typeof value === \"string\") {\n      return Angle.parse(value, defaultUnits);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromValue(value: Value): Angle | null {\n    if (value.length === 2) {\n      const num = value.getItem(0).numberValue();\n      const units = value.getItem(1);\n      if (num !== void 0 && isFinite(num) && units instanceof Attr && units.toValue() === Value.extant()) {\n        switch (units.key.value) {\n          case \"deg\": return Angle.deg(num);\n          case \"rad\": return Angle.rad(num);\n          case \"grad\": return Angle.grad(num);\n          case \"turn\": return Angle.turn(num);\n          default:\n        }\n      }\n    }\n    return null;\n  }\n\n  static parse(string: string, defaultUnits?: AngleUnits): Angle {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = AngleParser.parse(input, defaultUnits);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  @Lazy\n  static form(): Form<Angle, AnyAngle> {\n    return new AngleForm(void 0, Angle.zero());\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyAngle {\n    return value instanceof Angle\n        || typeof value === \"number\"\n        || typeof value === \"string\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AngleUnits, Angle} from \"./Angle\";\n\n/** @public */\nexport class DegAngle extends Angle {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): AngleUnits {\n    return \"deg\";\n  }\n\n  override degValue(): number {\n    return this.value;\n  }\n\n  override gradValue(): number {\n    return this.value * 10 / 9;\n  }\n\n  override radValue(): number {\n    return this.value * Math.PI / 180;\n  }\n\n  override turnValue(): number {\n    return this.value / 360;\n  }\n\n  override deg(): DegAngle {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"deg\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Angle) {\n      const x = this.value;\n      const y = that.degValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Angle) {\n      return Numbers.equivalent(this.value, that.degValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof DegAngle) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(DegAngle), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Angle\").write(46/*'.'*/).write(\"deg\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"deg\";\n  }\n\n  @Lazy\n  static override zero(): DegAngle {\n    return new DegAngle(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AngleUnits, Angle} from \"./Angle\";\n\n/** @public */\nexport class RadAngle extends Angle {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): AngleUnits {\n    return \"rad\";\n  }\n\n  override degValue(): number {\n    return this.value * 180 / Math.PI;\n  }\n\n  override gradValue(): number {\n    return this.value * 200 / Math.PI;\n  }\n\n  override radValue(): number {\n    return this.value;\n  }\n\n  override turnValue(): number {\n    return this.value / (2 * Math.PI);\n  }\n\n  override rad(): RadAngle {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"rad\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Angle) {\n      const x = this.value;\n      const y = that.radValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Angle) {\n      return Numbers.equivalent(this.value, that.radValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof RadAngle) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(RadAngle), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Angle\").write(46/*'.'*/).write(\"rad\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"rad\";\n  }\n\n  @Lazy\n  static override zero(): RadAngle {\n    return new RadAngle(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AngleUnits, Angle} from \"./Angle\";\n\n/** @public */\nexport class GradAngle extends Angle {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  override readonly value: number;\n\n  override get units(): AngleUnits {\n    return \"grad\";\n  }\n\n  override degValue(): number {\n    return this.value * 0.9;\n  }\n\n  override gradValue(): number {\n    return this.value;\n  }\n\n  override radValue(): number {\n    return this.value * Math.PI / 200;\n  }\n\n  override turnValue(): number {\n    return this.value / 400;\n  }\n\n  override grad(): GradAngle {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"grad\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Angle) {\n      const x = this.value;\n      const y = that.gradValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Angle) {\n      return Numbers.equivalent(this.value, that.gradValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof GradAngle) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(GradAngle), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Angle\").write(46/*'.'*/).write(\"grad\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"grad\";\n  }\n\n  @Lazy\n  static override zero(): GradAngle {\n    return new GradAngle(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AngleUnits, Angle} from \"./Angle\";\n\n/** @public */\nexport class TurnAngle extends Angle {\n  constructor(value: number) {\n    super();\n    this.value = value;\n  }\n\n  readonly value: number;\n\n  override get units(): AngleUnits {\n    return \"turn\";\n  }\n\n  override degValue(): number {\n    return this.value * 360;\n  }\n\n  override gradValue(): number {\n    return this.value * 400;\n  }\n\n  override radValue(): number {\n    return this.value * (2 * Math.PI);\n  }\n\n  override turnValue(): number {\n    return this.value;\n  }\n\n  override turn(): TurnAngle {\n    return this;\n  }\n\n  override toCssValue(): CSSUnitValue | null {\n    if (typeof CSSUnitValue !== \"undefined\") {\n      return new CSSUnitValue(this.value, \"turn\");\n    } else {\n      return null;\n    }\n  }\n\n  override compareTo(that: unknown): number {\n    if (that instanceof Angle) {\n      const x = this.value;\n      const y = that.turnValue();\n      return x < y ? -1 : x > y ? 1 : isNaN(y) ? (isNaN(x) ? 0 : -1) : isNaN(x) ? 1 : 0;\n    }\n    return NaN;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof Angle) {\n      return Numbers.equivalent(this.value, that.turnValue());\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof TurnAngle) {\n      return this.value === that.value;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(TurnAngle), Numbers.hash(this.value)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Angle\").write(46/*'.'*/).write(\"turn\")\n                   .write(40/*'('*/).debug(this.value).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return this.value + \"turn\";\n  }\n\n  @Lazy\n  static override zero(): TurnAngle {\n    return new TurnAngle(0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Angle} from \"./Angle\";\n\n/** @internal */\nexport const AngleInterpolator = (function (_super: typeof Interpolator) {\n  const AngleInterpolator = function (a0: Angle, a1: Angle): Interpolator<Angle> {\n    const interpolator = function (u: number): Angle {\n      const a0 = interpolator[0];\n      const a1 = interpolator[1];\n      return Angle.create(a0.value + u * (a1.value - a0.value), a1.units);\n    } as Interpolator<Angle>;\n    Object.setPrototypeOf(interpolator, AngleInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = a0.to(a1.units);\n    (interpolator as Mutable<typeof interpolator>)[1] = a1;\n    return interpolator;\n  } as {\n    (a0: Angle, a1: Angle): Interpolator<Angle>;\n\n    /** @internal */\n    prototype: Interpolator<Angle>;\n  };\n\n  AngleInterpolator.prototype = Object.create(_super.prototype);\n  AngleInterpolator.prototype.constructor = AngleInterpolator;\n\n  return AngleInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Text, Form} from \"@swim/structure\";\nimport {AngleUnits, AnyAngle, Angle} from \"./Angle\";\n\n/** @internal */\nexport class AngleForm extends Form<Angle, AnyAngle> {\n  constructor(defaultUnits: AngleUnits | undefined, unit: Angle | undefined) {\n    super();\n    this.defaultUnits = defaultUnits;\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  readonly defaultUnits: AngleUnits | undefined;\n\n  override readonly unit!: Angle | undefined;\n\n  override withUnit(unit: Angle | undefined): Form<Angle, AnyAngle> {\n    if (unit !== this.unit) {\n      return new AngleForm(this.defaultUnits, unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(angle: AnyAngle): Item {\n    angle = Angle.fromAny(angle, this.defaultUnits);\n    return Text.from(angle.toString());\n  }\n\n  override cast(item: Item): Angle | undefined {\n    const value = item.toValue();\n    let angle: Angle | null = null;\n    try {\n      angle = Angle.fromValue(value);\n      if (angle === void 0) {\n        const string = value.stringValue(void 0);\n        if (string !== void 0) {\n          angle = Angle.parse(string, this.defaultUnits);\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return angle !== null ? angle : void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {AngleUnits, Angle} from \"./Angle\";\n\n/** @internal */\nexport class AngleParser extends Parser<Angle> {\n  private readonly defaultUnits: AngleUnits | undefined;\n  private readonly valueParser: Parser<number> | undefined;\n  private readonly unitsOutput: Output<string> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(defaultUnits?: AngleUnits, valueParser?: Parser<number>,\n              unitsOutput?: Output<string>, step?: number) {\n    super();\n    this.defaultUnits = defaultUnits;\n    this.valueParser = valueParser;\n    this.unitsOutput = unitsOutput;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<Angle> {\n    return AngleParser.parse(input, this.defaultUnits, this.valueParser,\n                             this.unitsOutput, this.step);\n  }\n\n  static parse(input: Input, defaultUnits?: AngleUnits, valueParser?: Parser<number>,\n               unitsOutput?: Output<string>, step: number = 1): Parser<Angle> {\n    let c = 0;\n    if (step === 1) {\n      if (valueParser === void 0) {\n        valueParser = Base10.parseDecimal(input);\n      } else {\n        valueParser = valueParser.feed(input);\n      }\n      if (valueParser.isDone()) {\n        step = 2;\n      } else if (valueParser.isError()) {\n        return valueParser.asError();\n      }\n    }\n    if (step === 2) {\n      unitsOutput = unitsOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        unitsOutput.push(c);\n      }\n      if (!input.isEmpty()) {\n        const value = valueParser!.bind();\n        const units = unitsOutput.bind() || defaultUnits;\n        switch (units) {\n          case \"deg\": return Parser.done(Angle.deg(value));\n          case \"\":\n          case \"rad\": return Parser.done(Angle.rad(value));\n          case \"grad\": return Parser.done(Angle.grad(value));\n          case \"turn\": return Parser.done(Angle.turn(value));\n          default: return Parser.error(Diagnostic.message(\"unknown units: \" + units, input));\n        }\n      }\n    }\n    return new AngleParser(defaultUnits, valueParser, unitsOutput, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Lazy,\n  Equivalent,\n  HashCode,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport {R2VectorInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport type AnyR2Vector = R2Vector | R2VectorInit;\n\n/** @public */\nexport interface R2VectorInit {\n  x: number;\n  y: number;\n}\n\n/** @public */\nexport class R2Vector implements Interpolate<R2Vector>, HashCode, Equivalent, Debug {\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.x) && isFinite(this.y);\n  }\n\n  readonly x: number;\n\n  readonly y: number;\n\n  plus(that: AnyR2Vector): R2Vector {\n    return new R2Vector(this.x + that.x, this.y + that.y);\n  }\n\n  negative(): R2Vector {\n    return new R2Vector(-this.x, -this.y);\n  }\n\n  minus(that: AnyR2Vector): R2Vector {\n    return new R2Vector(this.x - that.x, this.y - that.y);\n  }\n\n  times(scalar: number): R2Vector {\n    return new R2Vector(this.x * scalar, this.y * scalar);\n  }\n\n  toAny(): R2VectorInit {\n    return {\n      x: this.x,\n      y: this.y,\n    };\n  }\n\n  interpolateTo(that: R2Vector): Interpolator<R2Vector>;\n  interpolateTo(that: unknown): Interpolator<R2Vector> | null;\n  interpolateTo(that: unknown): Interpolator<R2Vector> | null {\n    if (that instanceof R2Vector) {\n      return R2VectorInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Vector) {\n      return Numbers.equivalent(this.x, that.x, epsilon)\n          && Numbers.equivalent(this.y, that.y, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Vector) {\n      return this.x === that.x && this.y === that.y;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(R2Vector),\n        Numbers.hash(this.x)), Numbers.hash(this.y)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Vector\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.x).write(\", \").debug(this.y).write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static zero(): R2Vector {\n    return new R2Vector(0, 0);\n  }\n\n  static of(x: number, y: number): R2Vector {\n    return new R2Vector(x, y);\n  }\n\n  static fromInit(init: R2VectorInit): R2Vector {\n    return new R2Vector(init.x, init.y);\n  }\n\n  static fromAny(value: AnyR2Vector): R2Vector {\n    if (value === void 0 || value === null || value instanceof R2Vector) {\n      return value;\n    } else if (R2Vector.isInit(value)) {\n      return R2Vector.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is R2VectorInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as R2VectorInit;\n      return typeof init.x === \"number\"\n          && typeof init.y === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyR2Vector {\n    return value instanceof R2Vector\n        || R2Vector.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {R2Vector} from \"./R2Vector\";\n\n/** @internal */\nexport const R2VectorInterpolator = (function (_super: typeof Interpolator) {\n  const R2VectorInterpolator = function (v0: R2Vector, v1: R2Vector): Interpolator<R2Vector> {\n    const interpolator = function (u: number): R2Vector {\n      const v0 = interpolator[0];\n      const v1 = interpolator[1];\n      const x = v0.x + u * (v1.x - v0.x);\n      const y = v0.y + u * (v1.y - v0.y);\n      return new R2Vector(x, y);\n    } as Interpolator<R2Vector>;\n    Object.setPrototypeOf(interpolator, R2VectorInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = v0;\n    (interpolator as Mutable<typeof interpolator>)[1] = v1;\n    return interpolator;\n  } as {\n    (v0: R2Vector, v1: R2Vector): Interpolator<R2Vector>;\n\n    /** @internal */\n    prototype: Interpolator<R2Vector>;\n  };\n\n  R2VectorInterpolator.prototype = Object.create(_super.prototype);\n  R2VectorInterpolator.prototype.constructor = R2VectorInterpolator;\n\n  return R2VectorInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Function} from \"./R2Function\";\nimport {R2PointInit, R2PointTuple, R2Point} from \"../\"; // forward import\nimport {R2SegmentInit, R2Segment} from \"../\"; // forward import\nimport {R2BoxInit, R2Box} from \"../\"; // forward import\nimport {R2CircleInit, R2Circle} from \"../\"; // forward import\n\n/** @public */\nexport type AnyR2Shape = R2Shape | R2PointInit | R2PointTuple | R2SegmentInit | R2BoxInit | R2CircleInit;\n\n/** @public */\nexport abstract class R2Shape {\n  abstract readonly xMin: number;\n\n  abstract readonly yMin: number;\n\n  abstract readonly xMax: number;\n\n  abstract readonly yMax: number;\n\n  abstract contains(that: AnyR2Shape): boolean;\n\n  abstract contains(x: number, y: number): boolean;\n\n  abstract intersects(that: AnyR2Shape): boolean;\n\n  union(that: AnyR2Shape): R2Shape {\n    that = R2Shape.fromAny(that);\n    return new R2Box(Math.min(this.xMin, that.xMin),\n                     Math.min(this.yMin, that.yMin),\n                     Math.max(this.xMax, that.xMax),\n                     Math.max(this.yMax, that.yMax));\n  }\n\n  abstract transform(f: R2Function): R2Shape;\n\n  get bounds(): R2Box {\n    return new R2Box(this.xMin, this.yMin, this.xMax, this.yMax);\n  }\n\n  static fromAny(value: AnyR2Shape): R2Shape {\n    if (value === void 0 || value === null || value instanceof R2Shape) {\n      return value;\n    } else if (R2Point.isInit(value)) {\n      return R2Point.fromInit(value);\n    } else if (R2Point.isTuple(value)) {\n      return R2Point.fromTuple(value);\n    } else if (R2Segment.isInit(value)) {\n      return R2Segment.fromInit(value);\n    } else if (R2Box.isInit(value)) {\n      return R2Box.fromInit(value);\n    } else if (R2Circle.isInit(value)) {\n      return R2Circle.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyR2Shape {\n    return value instanceof R2Shape\n        || R2Point.isInit(value)\n        || R2Point.isTuple(value)\n        || R2Segment.isInit(value)\n        || R2Box.isInit(value)\n        || R2Circle.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Lazy,\n  Equivalent,\n  HashCode,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {AnyR2Vector, R2Vector} from \"./R2Vector\";\nimport {AnyR2Shape, R2Shape} from \"./R2Shape\";\nimport {R2PointInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport type AnyR2Point = R2Point | R2PointInit | R2PointTuple;\n\n/** @public */\nexport interface R2PointInit {\n  x: number;\n  y: number;\n}\n\n/** @public */\nexport type R2PointTuple = [number, number];\n\n/** @public */\nexport class R2Point extends R2Shape implements Interpolate<R2Point>, HashCode, Equivalent, Debug {\n  constructor(x: number, y: number) {\n    super();\n    this.x = x;\n    this.y = y;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.x) && isFinite(this.y);\n  }\n\n  readonly x: number;\n\n  readonly y: number;\n\n  override get xMin(): number {\n    return this.x;\n  }\n\n  override get yMin(): number {\n    return this.y;\n  }\n\n  override get xMax(): number {\n    return this.x;\n  }\n\n  override get yMax(): number {\n    return this.y;\n  }\n\n  plus(vector: AnyR2Vector): R2Point {\n    return new R2Point(this.x + vector.x, this.y + vector.y);\n  }\n\n  minus(vector: R2Vector): R2Point;\n  minus(that: R2Point): R2Vector;\n  minus(that: R2Vector | R2Point): R2Point | R2Vector {\n    if (that instanceof R2Vector) {\n      return new R2Point(this.x - that.x, this.y - that.y);\n    } else {\n      return new R2Vector(this.x - that.x, this.y - that.y);\n    }\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    if (typeof that === \"number\") {\n      return this.x === that && this.y === y!;\n    } else {\n      that = R2Shape.fromAny(that);\n      if (that instanceof R2Point) {\n        return this.x === that.x && this.y === that.y;\n      } else if (that instanceof R2Shape) {\n        return this.x <= that.xMin && that.xMax <= this.x\n            && this.y <= that.yMin && that.yMax <= this.y;\n      }\n      return false;\n    }\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    that = R2Shape.fromAny(that);\n    return (that as R2Shape).intersects(this);\n  }\n\n  override transform(f: R2Function): R2Point {\n    return new R2Point(f.transformX(this.x, this.y), f.transformY(this.x, this.y));\n  }\n\n  toAny(): R2PointInit {\n    return {\n      x: this.x,\n      y: this.y,\n    };\n  }\n\n  interpolateTo(that: R2Point): Interpolator<R2Point>;\n  interpolateTo(that: unknown): Interpolator<R2Point> | null;\n  interpolateTo(that: unknown): Interpolator<R2Point> | null {\n    if (that instanceof R2Point) {\n      return R2PointInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Point) {\n      return Numbers.equivalent(this.x, that.x, epsilon)\n          && Numbers.equivalent(this.y, that.y, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Point) {\n      return this.x === that.x && this.y === that.y;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(R2Point),\n        Numbers.hash(this.x)), Numbers.hash(this.y)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Point\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.x).write(\", \").debug(this.y).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static origin(): R2Point {\n    return new R2Point(0, 0);\n  }\n\n  @Lazy\n  static undefined(): R2Point {\n    return new R2Point(NaN, NaN);\n  }\n\n  static of(x: number, y: number): R2Point {\n    return new R2Point(x, y);\n  }\n\n  static fromInit(value: R2PointInit): R2Point {\n    return new R2Point(value.x, value.y);\n  }\n\n  static fromTuple(value: R2PointTuple): R2Point {\n    return new R2Point(value[0], value[1]);\n  }\n\n  static override fromAny(value: AnyR2Point): R2Point {\n    if (value === void 0 || value === null || value instanceof R2Point) {\n      return value;\n    } else if (R2Point.isInit(value)) {\n      return R2Point.fromInit(value);\n    } else if (R2Point.isTuple(value)) {\n      return R2Point.fromTuple(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is R2PointInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as R2PointInit;\n      return typeof init.x === \"number\"\n          && typeof init.y === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static isTuple(value: unknown): value is R2PointTuple {\n    return Array.isArray(value)\n        && value.length === 2\n        && typeof value[0] === \"number\"\n        && typeof value[1] === \"number\";\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyR2Point {\n    return value instanceof R2Point\n        || R2Point.isInit(value)\n        || R2Point.isTuple(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {R2Point} from \"./R2Point\";\n\n/** @internal */\nexport const R2PointInterpolator = (function (_super: typeof Interpolator) {\n  const R2PointInterpolator = function (p0: R2Point, p1: R2Point): Interpolator<R2Point> {\n    const interpolator = function (u: number): R2Point {\n      const p0 = interpolator[0];\n      const p1 = interpolator[1];\n      const x = p0.x + u * (p1.x - p0.x);\n      const y = p0.y + u * (p1.y - p0.y);\n      return new R2Point(x, y);\n    } as Interpolator<R2Point>;\n    Object.setPrototypeOf(interpolator, R2PointInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = p0;\n    (interpolator as Mutable<typeof interpolator>)[1] = p1;\n    return interpolator;\n  } as {\n    (p0: R2Point, p1: R2Point): Interpolator<R2Point>;\n\n    /** @internal */\n    prototype: Interpolator<R2Point>;\n  };\n\n  R2PointInterpolator.prototype = Object.create(_super.prototype);\n  R2PointInterpolator.prototype.constructor = R2PointInterpolator;\n\n  return R2PointInterpolator;\n})(Interpolator);\n"," // Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Equivalent, Equals} from \"@swim/util\";\nimport {AnyOutputSettings, Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {R2Shape} from \"./R2Shape\";\nimport type {R2Point} from \"./R2Point\";\nimport type {R2CurveContext} from \"./R2CurveContext\";\nimport {R2CurveParser} from \"../\"; // forward import\nimport {R2Segment} from \"../\"; // forward import\nimport {R2QuadraticCurve} from \"../\"; // forward import\nimport {R2CubicCurve} from \"../\"; // forward import\nimport {R2EllipticCurve} from \"../\"; // forward import\n\n/** @public */\nexport abstract class R2Curve extends R2Shape implements Equals, Equivalent {\n  abstract interpolateX(u: number): number;\n\n  abstract interpolateY(u: number): number;\n\n  abstract interpolate(u: number): R2Point;\n\n  abstract split(u: number): [R2Curve, R2Curve];\n\n  abstract override transform(f: R2Function): R2Curve;\n\n  abstract drawMove(context: R2CurveContext): void;\n\n  abstract drawRest(context: R2CurveContext): void;\n\n  draw(context: R2CurveContext): void {\n    this.drawMove(context);\n    this.drawRest(context);\n  }\n\n  abstract transformDrawMove(context: R2CurveContext, f: R2Function): void;\n\n  abstract transformDrawRest(context: R2CurveContext, f: R2Function): void;\n\n  transformDraw(context: R2CurveContext, f: R2Function): void {\n    this.transformDrawMove(context, f);\n    this.transformDrawRest(context, f);\n  }\n\n  abstract writeMove<T>(output: Output<T>): Output<T>;\n\n  abstract writeRest<T>(output: Output<T>): Output<T>;\n\n  writePath<T>(output: Output<T>): Output<T> {\n    output = this.writeMove(output);\n    output = this.writeRest(output);\n    return output;\n  }\n\n  toPathString(outputSettings?: AnyOutputSettings): string {\n    let output = Unicode.stringOutput(outputSettings);\n    output = this.writePath(output);\n    return output.toString();\n  }\n\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  abstract equals(that: unknown): boolean;\n\n  static linear(x0: number, y0: number, x1: number, y1: number): R2Curve {\n    return new R2Segment(x0, y0, x1, y1);\n  }\n\n  static quadratic(x0: number, y0: number, x1: number, y1: number, x2: number, y2: number): R2Curve {\n    return new R2QuadraticCurve(x0, y0, x1, y1, x2, y2);\n  }\n\n  static cubic(x0: number, y0: number, x1: number, y1: number,\n               x2: number, y2: number, x3: number, y3: number): R2Curve {\n    return new R2CubicCurve(x0, y0, x1, y1, x2, y2, x3, y3);\n  }\n\n  static elliptic(cx: number, cy: number, rx: number, ry: number,\n                  phi: number, a0: number, da: number): R2Curve {\n    return new R2EllipticCurve(cx, cy, rx, ry, phi, a0, da);\n  }\n\n  static parse(string: string): R2Curve {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = R2CurveParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport type {R2Curve} from \"./R2Curve\";\nimport {R2SegmentParser} from \"../\"; // forward import\nimport {R2QuadraticCurveParser} from \"../\"; // forward import\nimport {R2CubicCurveParser} from \"../\"; // forward import\nimport {R2EllipticCurveParser} from \"../\"; // forward import\n\n/** @internal */\nexport class R2CurveParser extends Parser<R2Curve> {\n  private readonly x0Parser: Parser<number> | undefined;\n  private readonly y0Parser: Parser<number> | undefined;\n  private readonly command: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n              command?: number, step?: number) {\n    super();\n    this.x0Parser = x0Parser;\n    this.y0Parser = y0Parser;\n    this.command = command;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2Curve> {\n    return R2CurveParser.parse(input, this.x0Parser, this.y0Parser,\n                               this.command, this.step);\n  }\n\n  static parse(input: Input, x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n               command?: number, step: number = 1): Parser<R2Curve> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 77/*'M'*/ || c === 109/*'m'*/) {\n          input = input.step();\n          command = c;\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(\"moveto\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (x0Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x0Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x0Parser = x0Parser.feed(input);\n      }\n      if (x0Parser !== void 0) {\n        if (x0Parser.isDone()) {\n          step = 3;\n        } else if (x0Parser.isError()) {\n          return x0Parser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 4;\n      } else if (!input.isEmpty()) {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (y0Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y0Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y0Parser = y0Parser.feed(input);\n      }\n      if (y0Parser !== void 0) {\n        if (y0Parser.isDone()) {\n          step = 5;\n        } else if (y0Parser.isError()) {\n          return y0Parser.asError();\n        }\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        switch (c) {\n          case 76/*'L'*/:\n          case 108/*'l'*/:\n          case 72/*'H'*/:\n          case 104/*'h'*/:\n          case 86/*'V'*/:\n          case 118/*'v'*/:\n            return R2SegmentParser.parse(input, x0Parser, y0Parser);\n          case 81/*'Q'*/:\n          case 113/*'q'*/:\n            return R2QuadraticCurveParser.parse(input, x0Parser, y0Parser);\n          case 84/*'T'*/:\n            return R2QuadraticCurveParser.parse(input, x0Parser, y0Parser,\n                                                x0Parser, y0Parser);\n          case 116/*'t'*/:\n            return R2QuadraticCurveParser.parse(input, x0Parser, y0Parser,\n                                                Parser.done(0), Parser.done(0));\n          case 67/*'C'*/:\n          case 99/*'c'*/:\n            return R2CubicCurveParser.parse(input, x0Parser, y0Parser);\n          case 83/*'S'*/:\n            return R2CubicCurveParser.parse(input, x0Parser, y0Parser,\n                                             x0Parser, y0Parser);\n          case 115/*'s'*/:\n            return R2CubicCurveParser.parse(input, x0Parser, y0Parser,\n                                             Parser.done(0), Parser.done(0));\n          case 65/*'A'*/:\n          case 97/*'a'*/:\n            return R2EllipticCurveParser.parse(input, x0Parser, y0Parser);\n          case 44/*','*/:\n            input = input.step();\n          case 43/*'+'*/:\n          case 45/*'-'*/:\n          case 46/*'.'*/:\n          case 48/*'0'*/:\n          case 49/*'1'*/:\n          case 50/*'2'*/:\n          case 51/*'3'*/:\n          case 52/*'4'*/:\n          case 53/*'5'*/:\n          case 54/*'6'*/:\n          case 55/*'7'*/:\n          case 56/*'8'*/:\n          case 57/*'9'*/:\n            switch (command) {\n              case 77/*'M'*/:\n              case 109/*'m'*/:\n                return R2SegmentParser.parseRest(input, command, x0Parser, y0Parser);\n            }\n          default:\n            return Parser.error(Diagnostic.expected(\"draw command\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    return new R2CurveParser(x0Parser, y0Parser, command, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Function} from \"./R2Function\";\nimport {R2Curve} from \"./R2Curve\";\n\n/** @public */\nexport abstract class R2BezierCurve extends R2Curve {\n  abstract override transform(f: R2Function): R2BezierCurve;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Murmur3, Numbers, Constructors, Interpolate, Interpolator} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {AnyR2Shape, R2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport type {R2CurveContext} from \"./R2CurveContext\";\nimport {R2BezierCurve} from \"./R2BezierCurve\";\nimport {R2SegmentInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport type AnyR2Segment = R2Segment | R2SegmentInit;\n\n/** @public */\nexport interface R2SegmentInit {\n  x0: number;\n  y0: number;\n  x1: number;\n  y1: number;\n}\n\n/** @public */\nexport class R2Segment extends R2BezierCurve implements Interpolate<R2Segment>, HashCode, Debug {\n  constructor(x0: number, y0: number, x1: number, y1: number) {\n    super();\n    this.x0 = x0;\n    this.y0 = y0;\n    this.x1 = x1;\n    this.y1 = y1;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.x0) && isFinite(this.y0)\n        && isFinite(this.x1) && isFinite(this.y1);\n  }\n\n  readonly x0: number;\n\n  readonly y0: number;\n\n  readonly x1: number;\n\n  readonly y1: number;\n\n  override get xMin(): number {\n    return Math.min(this.x0, this.x1);\n  }\n\n  override get yMin(): number {\n    return Math.min(this.y0, this.y1);\n  }\n\n  override get xMax(): number {\n    return Math.max(this.x0, this.x1);\n  }\n\n  override get yMax(): number {\n    return Math.max(this.y0, this.y1);\n  }\n\n  override interpolateX(u: number): number {\n    return (1.0 - u) * this.x0 + u * this.x1;\n  }\n\n  override interpolateY(u: number): number {\n    return (1.0 - u) * this.y0 + u * this.y1;\n  }\n\n  override interpolate(u: number): R2Point {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const y01 = v * this.y0 + u * this.y1;\n    return new R2Point(x01, y01);\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    if (typeof that === \"number\") {\n      return R2Segment.contains(this.x0, this.y0, this.x1, this.y1, that, y!);\n    } else {\n      that = R2Shape.fromAny(that);\n      if (that instanceof R2Point) {\n        return this.containsPoint(that);\n      } else if (that instanceof R2Segment) {\n        return this.containsSegment(that);\n      }\n      return false;\n    }\n  }\n\n  /** @internal */\n  containsPoint(that: R2Point): boolean {\n    return R2Segment.contains(this.x0, this.y0, this.x1, this.y1, that.x, that.y);\n  }\n\n  /** @internal */\n  containsSegment(that: R2Segment): boolean {\n    return R2Segment.contains(this.x0, this.y0, this.x1, this.y1, that.x0, that.y0)\n        && R2Segment.contains(this.x0, this.y0, this.x1, this.y1, that.x1, that.y1);\n  }\n\n  /** @internal */\n  static contains(ax: number, ay: number, bx: number, by: number, cx: number, cy: number): boolean {\n    return (ax <= cx && cx <= bx || bx <= cx && cx <= ax)\n        && (ay <= cy && cy <= by || by <= cy && cy <= ay)\n        && (bx - ax) * (cy - ay) === (cx - ax) * (by - ay);\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    that = R2Shape.fromAny(that);\n    if (that instanceof R2Point) {\n      return this.intersectsPoint(that);\n    } else if (that instanceof R2Segment) {\n      return this.intersectsSegment(that);\n    } else {\n      return (that as R2Shape).intersects(this);\n    }\n    return false;\n  }\n\n  /** @internal */\n  intersectsPoint(that: R2Point): boolean {\n    return R2Segment.contains(this.x0, this.y0, this.x1, this.y1, that.x, that.y);\n  }\n\n  /** @internal */\n  intersectsSegment(that: R2Segment): boolean {\n    return R2Segment.intersects(this.x0, this.y0, this.x1 - this.x0, this.y1 - this.y0,\n                                that.x0, that.y0, that.x1 - that.x0, that.y1 - that.y0);\n  }\n\n  /** @internal */\n  static intersects(px: number, py: number, rx: number, ry: number,\n                    qx: number, qy: number, sx: number, sy: number): boolean {\n    const pqx = qx - px;\n    const pqy = qy - py;\n    const pqr = pqx * ry - pqy * rx;\n    const rs = rx * sy - ry * sx;\n    if (pqr === 0 && rs === 0) { // collinear\n      const rr = rx * rx + ry * ry;\n      const sr = sx * rx + sy * ry;\n      const t0 = (pqx * rx + pqy * ry) / rr;\n      const t1 = t0 + sr / rr;\n      return sr >= 0 ? 0 < t1 && t0 < 1 : 0 < t0 && t1 < 1;\n    } else if (rs === 0) { // parallel\n      return false;\n    } else {\n      const pqs = pqx * sy - pqy * sx;\n      const t = pqs / rs; // (q − p) × s / (r × s)\n      const u = pqr / rs; // (q − p) × r / (r × s)\n      return 0 <= t && t <= 1 && 0 <= u && u <= 1;\n    }\n  }\n\n  override split(u: number): [R2Segment, R2Segment] {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const y01 = v * this.y0 + u * this.y1;\n    const c0 = new R2Segment(this.x0, this.y0, x01, y01);\n    const c1 = new R2Segment(x01, y01, this.x1, this.y1);\n    return [c0, c1];\n  }\n\n  override transform(f: R2Function): R2Segment {\n    return new R2Segment(f.transformX(this.x0, this.y0), f.transformY(this.x0, this.y0),\n                         f.transformX(this.x1, this.y1), f.transformY(this.x1, this.y1));\n  }\n\n  toAny(): R2SegmentInit {\n    return {\n      x0: this.x0,\n      y0: this.y0,\n      x1: this.x1,\n      y1: this.y1,\n    };\n  }\n\n  override drawMove(context: R2CurveContext): void {\n    context.moveTo(this.x0, this.y0);\n  }\n\n  override drawRest(context: R2CurveContext): void {\n    context.lineTo(this.x1, this.y1);\n  }\n\n  override transformDrawMove(context: R2CurveContext, f: R2Function): void {\n    context.moveTo(f.transformX(this.x0, this.y0), f.transformY(this.x0, this.y0));\n  }\n\n  override transformDrawRest(context: R2CurveContext, f: R2Function): void {\n    context.lineTo(f.transformX(this.x1, this.y1), f.transformY(this.x1, this.y1));\n  }\n\n  override writeMove<T>(output: Output<T>): Output<T> {\n    output = output.write(77/*'M'*/);\n    output = Format.displayNumber(output, this.x0);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.y0);\n    return output;\n  }\n\n  override writeRest<T>(output: Output<T>): Output<T> {\n    output = output.write(76/*'L'*/);\n    output = Format.displayNumber(output, this.x1);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.y1);\n    return output;\n  }\n\n  interpolateTo(that: R2Segment): Interpolator<R2Segment>;\n  interpolateTo(that: unknown): Interpolator<R2Segment> | null;\n  interpolateTo(that: unknown): Interpolator<R2Segment> | null {\n    if (that instanceof R2Segment) {\n      return R2SegmentInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Segment) {\n      return Numbers.equivalent(this.x0, that.x0, epsilon)\n          && Numbers.equivalent(this.y0, that.y0, epsilon)\n          && Numbers.equivalent(this.x1, that.x1, epsilon)\n          && Numbers.equivalent(this.y1, that.y1, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Segment) {\n      return this.x0 === that.x0 && this.y0 === that.y0\n          && this.x1 === that.x1 && this.y1 === that.y1;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(R2Segment), Numbers.hash(this.x0)), Numbers.hash(this.y0)),\n        Numbers.hash(this.x1)), Numbers.hash(this.y1)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Segment\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.x0).write(\", \").debug(this.y0).write(\", \")\n                   .debug(this.x1).write(\", \").debug(this.y1).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static of(x0: number, y0: number, x1: number, y1: number): R2Segment {\n    return new R2Segment(x0, y0, x1, y1);\n  }\n\n  static fromInit(value: R2SegmentInit): R2Segment {\n    return new R2Segment(value.x0, value.y0, value.x1, value.y1);\n  }\n\n  static override fromAny(value: AnyR2Segment): R2Segment {\n    if (value === void 0 || value === null || value instanceof R2Segment) {\n      return value;\n    } else if (R2Segment.isInit(value)) {\n      return R2Segment.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is R2SegmentInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as R2SegmentInit;\n      return typeof init.x0 === \"number\"\n          && typeof init.y0 === \"number\"\n          && typeof init.x1 === \"number\"\n          && typeof init.y1 === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyR2Segment {\n    return value instanceof R2Segment\n        || R2Segment.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {R2Segment} from \"./R2Segment\";\n\n/** @internal */\nexport const R2SegmentInterpolator = (function (_super: typeof Interpolator) {\n  const R2SegmentInterpolator = function (s0: R2Segment, s1: R2Segment): Interpolator<R2Segment> {\n    const interpolator = function (u: number): R2Segment {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const x0 = s0.x0 + u * (s1.x0 - s0.x0);\n      const y0 = s0.y0 + u * (s1.y0 - s0.y0);\n      const x1 = s0.x1 + u * (s1.x1 - s0.x1);\n      const y1 = s0.y1 + u * (s1.y1 - s0.y1);\n      return new R2Segment(x0, y0, x1, y1);\n    } as Interpolator<R2Segment>;\n    Object.setPrototypeOf(interpolator, R2SegmentInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: R2Segment, s1: R2Segment): Interpolator<R2Segment>;\n\n    /** @internal */\n    prototype: Interpolator<R2Segment>;\n  };\n\n  R2SegmentInterpolator.prototype = Object.create(_super.prototype);\n  R2SegmentInterpolator.prototype.constructor = R2SegmentInterpolator;\n\n  return R2SegmentInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {R2Segment} from \"./R2Segment\";\n\n/** @internal */\nexport class R2SegmentParser extends Parser<R2Segment> {\n  private readonly x0Parser: Parser<number> | undefined;\n  private readonly y0Parser: Parser<number> | undefined;\n  private readonly x1Parser: Parser<number> | undefined;\n  private readonly y1Parser: Parser<number> | undefined;\n  private readonly command: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n              x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n              command?: number, step?: number) {\n    super();\n    this.x0Parser = x0Parser;\n    this.y0Parser = y0Parser;\n    this.x1Parser = x1Parser;\n    this.y1Parser = y1Parser;\n    this.command = command;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2Segment> {\n    return R2SegmentParser.parse(input, this.x0Parser, this.y0Parser,\n                                 this.x1Parser, this.y1Parser,\n                                 this.command, this.step);\n  }\n\n  static parse(input: Input, x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n               x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n               command?: number, step: number = 1): Parser<R2Segment> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        switch (c) {\n          case 77/*'M'*/:\n          case 109/*'m'*/:\n          case 76/*'L'*/:\n          case 108/*'l'*/:\n            input = input.step();\n            command = c;\n            step = 2;\n            break;\n          case 72/*'H'*/:\n            input = input.step();\n            y1Parser = y0Parser;\n            command = c;\n            step = 2;\n            break;\n          case 104/*'h'*/:\n            input = input.step();\n            y1Parser = Parser.done(0);\n            command = c;\n            step = 2;\n            break;\n          case 86/*'V'*/:\n            input = input.step();\n            x1Parser = x0Parser;\n            command = c;\n            step = 4;\n            break;\n          case 118/*'v'*/:\n            input = input.step();\n            x1Parser = Parser.done(0);\n            command = c;\n            step = 4;\n            break;\n          default:\n            return Parser.error(Diagnostic.expected(\"lineto\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (x1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x1Parser = x1Parser.feed(input);\n      }\n      if (x1Parser !== void 0) {\n        if (x1Parser.isDone()) {\n          if (y1Parser === void 0 || !y1Parser.isDone()) {\n            step = 3;\n          } else { // H or h\n            step = 4;\n          }\n        } else if (x1Parser.isError()) {\n          return x1Parser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 4;\n      } else if (!input.isEmpty()) {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (y1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y1Parser = y1Parser.feed(input);\n      }\n      if (y1Parser !== void 0) {\n        if (y1Parser.isDone()) {\n          const x0 = x0Parser!.bind();\n          const y0 = y0Parser!.bind();\n          let x1 = x1Parser!.bind();\n          let y1 = y1Parser.bind();\n          if (command === 109/*'m'*/ || command === 108/*'l'*/ ||\n              command === 104/*'h'*/ || command === 118/*'v'*/) {\n            x1 += x0;\n            y1 += y0;\n          }\n          return Parser.done(new R2Segment(x0, y0, x1, y1));\n        } else if (y1Parser.isError()) {\n          return y1Parser.asError();\n        }\n      }\n    }\n    return new R2SegmentParser(x0Parser, y0Parser, x1Parser, y1Parser, command, step);\n  }\n\n  static parseRest(input: Input, command?: number, x0Parser?: Parser<number>,\n                   y0Parser?: Parser<number>): Parser<R2Segment> {\n    let x1Parser: Parser<number> | undefined;\n    let y1Parser: Parser<number> | undefined;\n    let step: number;\n    switch (command) {\n      case 72/*'H'*/:\n        y1Parser = y0Parser;\n        step = 2;\n        break;\n      case 104/*'h'*/:\n        y1Parser = Parser.done(0);\n        step = 2;\n        break;\n      case 86/*'V'*/:\n        x1Parser = x0Parser;\n        step = 4;\n        break;\n      case 118/*'v'*/:\n        x1Parser = Parser.done(0);\n        step = 4;\n        break;\n      default:\n        step = 2;\n    }\n    return this.parse(input, x0Parser, y0Parser, x1Parser, y1Parser, command, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Numbers} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport type {AnyR2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport type {R2CurveContext} from \"./R2CurveContext\";\nimport {R2BezierCurve} from \"./R2BezierCurve\";\n\n/** @public */\nexport class R2QuadraticCurve extends R2BezierCurve implements Debug {\n  constructor(x0: number, y0: number, x1: number, y1: number, x2: number, y2: number) {\n    super();\n    this.x0 = x0;\n    this.y0 = y0;\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.x0) && isFinite(this.y0)\n        && isFinite(this.x1) && isFinite(this.y1)\n        && isFinite(this.x2) && isFinite(this.y2);\n  }\n\n  readonly x0: number;\n\n  readonly y0: number;\n\n  readonly x1: number;\n\n  readonly y1: number;\n\n  readonly x2: number;\n\n  readonly y2: number;\n\n  override get xMin(): number {\n    return Math.min(this.x0, this.x1, this.x2);\n  }\n\n  override get yMin(): number {\n    return Math.min(this.y0, this.y1, this.y2);\n  }\n\n  override get xMax(): number {\n    return Math.max(this.x0, this.x1, this.x2);\n  }\n\n  override get yMax(): number {\n    return Math.max(this.y0, this.y1, this.y2);\n  }\n\n  override interpolateX(u: number): number {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const x12 = v * this.x1 + u * this.x2;\n    return v * x01 + u * x12;\n  }\n\n  override interpolateY(u: number): number {\n    const v = 1.0 - u;\n    const y01 = v * this.y0 + u * this.y1;\n    const y12 = v * this.y1 + u * this.y2;\n    return v * y01 + u * y12;\n  }\n\n  override interpolate(u: number): R2Point {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const y01 = v * this.y0 + u * this.y1;\n    const x12 = v * this.x1 + u * this.x2;\n    const y12 = v * this.y1 + u * this.y2;\n    const x02 = v * x01 + u * x12;\n    const y02 = v * y01 + u * y12;\n    return new R2Point(x02, y02);\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    return false; // TODO\n  }\n\n  override split(u: number): [R2QuadraticCurve, R2QuadraticCurve] {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const y01 = v * this.y0 + u * this.y1;\n    const x12 = v * this.x1 + u * this.x2;\n    const y12 = v * this.y1 + u * this.y2;\n    const x02 = v * x01 + u * x12;\n    const y02 = v * y01 + u * y12;\n    const c0 = new R2QuadraticCurve(this.x0, this.y0, x01, y01, x02, y02);\n    const c1 = new R2QuadraticCurve(x02, y02, x12, y12, this.x2, this.y2);\n    return [c0, c1];\n  }\n\n  override transform(f: R2Function): R2QuadraticCurve {\n    return new R2QuadraticCurve(f.transformX(this.x0, this.y0), f.transformY(this.x0, this.y0),\n                                f.transformX(this.x1, this.y1), f.transformY(this.x1, this.y1),\n                                f.transformX(this.x2, this.y2), f.transformY(this.x2, this.y2));\n  }\n\n  override drawMove(context: R2CurveContext): void {\n    context.moveTo(this.x0, this.y0);\n  }\n\n  override drawRest(context: R2CurveContext): void {\n    context.quadraticCurveTo(this.x1, this.y1, this.x2, this.y2);\n  }\n\n  override transformDrawMove(context: R2CurveContext, f: R2Function): void {\n    context.moveTo(f.transformX(this.x0, this.y0), f.transformY(this.x0, this.y0));\n  }\n\n  override transformDrawRest(context: R2CurveContext, f: R2Function): void {\n    context.quadraticCurveTo(f.transformX(this.x1, this.y1), f.transformY(this.x1, this.y1),\n                             f.transformX(this.x2, this.y2), f.transformY(this.x2, this.y2));\n  }\n\n  override writeMove<T>(output: Output<T>): Output<T> {\n    output = output.write(77/*'M'*/);\n    output = Format.displayNumber(output, this.x0);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.y0);\n    return output;\n  }\n\n  override writeRest<T>(output: Output<T>): Output<T> {\n    output = output.write(81/*'Q'*/);\n    output = Format.displayNumber(output, this.x1);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.y1);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.x2);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.y2);\n    return output;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2QuadraticCurve) {\n      return Numbers.equivalent(this.x0, that.x0, epsilon)\n          && Numbers.equivalent(this.y0, that.y0, epsilon)\n          && Numbers.equivalent(this.x1, that.x1, epsilon)\n          && Numbers.equivalent(this.y1, that.y1, epsilon)\n          && Numbers.equivalent(this.x2, that.x2, epsilon)\n          && Numbers.equivalent(this.y2, that.y2, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2QuadraticCurve) {\n      return this.x0 === that.x0 && this.y0 === that.y0\n          && this.x1 === that.x1 && this.y1 === that.y1\n          && this.x2 === that.x2 && this.y2 === that.y2;\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Curve\").write(46/*'.'*/).write(\"quadratic\").write(40/*'('*/)\n                   .debug(this.x0).write(\", \").debug(this.y0).write(\", \")\n                   .debug(this.x1).write(\", \").debug(this.y1).write(\", \")\n                   .debug(this.x2).write(\", \").debug(this.y2).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {R2QuadraticCurve} from \"./R2QuadraticCurve\";\n\n/** @internal */\nexport class R2QuadraticCurveParser extends Parser<R2QuadraticCurve> {\n  private readonly x0Parser: Parser<number> | undefined;\n  private readonly y0Parser: Parser<number> | undefined;\n  private readonly x1Parser: Parser<number> | undefined;\n  private readonly y1Parser: Parser<number> | undefined;\n  private readonly x2Parser: Parser<number> | undefined;\n  private readonly y2Parser: Parser<number> | undefined;\n  private readonly command: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n              x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n              x2Parser?: Parser<number>, y2Parser?: Parser<number>,\n              command?: number, step?: number) {\n    super();\n    this.x0Parser = x0Parser;\n    this.y0Parser = y0Parser;\n    this.x1Parser = x1Parser;\n    this.y1Parser = y1Parser;\n    this.x2Parser = x2Parser;\n    this.y2Parser = y2Parser;\n    this.command = command;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2QuadraticCurve> {\n    return R2QuadraticCurveParser.parse(input, this.x0Parser, this.y0Parser,\n                                        this.x1Parser, this.y1Parser,\n                                        this.x2Parser, this.y2Parser,\n                                        this.command, this.step);\n  }\n\n  static parse(input: Input, x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n               x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n               x2Parser?: Parser<number>, y2Parser?: Parser<number>,\n               command?: number, step: number = 1): Parser<R2QuadraticCurve> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        switch (c) {\n          case 81/*'Q'*/:\n          case 113/*'q'*/:\n            input = input.step();\n            command = c;\n            step = 2;\n            break;\n          case 84/*'T'*/:\n          case 116/*'t'*/:\n            input = input.step();\n            command = c;\n            step = 6;\n            break;\n          default:\n            return Parser.error(Diagnostic.expected(\"curveto\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (x1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x1Parser = x1Parser.feed(input);\n      }\n      if (x1Parser !== void 0) {\n        if (x1Parser.isDone()) {\n          step = 3;\n        } else if (x1Parser.isError()) {\n          return x1Parser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 4;\n      } else if (!input.isEmpty()) {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (y1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y1Parser = y1Parser.feed(input);\n      }\n      if (y1Parser !== void 0) {\n        if (y1Parser.isDone()) {\n          step = 5;\n        } else if (y1Parser.isError()) {\n          return y1Parser.asError();\n        }\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 6;\n      } else if (!input.isEmpty()) {\n        step = 6;\n      }\n    }\n    if (step === 6) {\n      if (x2Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x2Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x2Parser = x2Parser.feed(input);\n      }\n      if (x2Parser !== void 0) {\n        if (x2Parser.isDone()) {\n          step = 7;\n        } else if (x2Parser.isError()) {\n          return x2Parser.asError();\n        }\n      }\n    }\n    if (step === 7) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 8;\n      } else if (!input.isEmpty()) {\n        step = 8;\n      }\n    }\n    if (step === 8) {\n      if (y2Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y2Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y2Parser = y2Parser.feed(input);\n      }\n      if (y2Parser !== void 0) {\n        if (y2Parser.isDone()) {\n          const x0 = x0Parser!.bind();\n          const y0 = y0Parser!.bind();\n          let x1 = x1Parser!.bind();\n          let y1 = y1Parser!.bind();\n          let x2 = x2Parser!.bind();\n          let y2 = y2Parser.bind();\n          if (command === 113/*'q'*/ || command === 116/*'t'*/) {\n            x1 += x0;\n            y1 += y0;\n            x2 += x0;\n            y2 += y0;\n          }\n          return Parser.done(new R2QuadraticCurve(x0, y0, x1, y1, x2, y2));\n        } else if (y2Parser.isError()) {\n          return y2Parser.asError();\n        }\n      }\n    }\n    return new R2QuadraticCurveParser(x0Parser, y0Parser, x1Parser, y1Parser,\n                                      x2Parser, y2Parser, command, step);\n  }\n\n  static parseRest(input: Input, command?: number, x0Parser?: Parser<number>,\n                   y0Parser?: Parser<number>, x1Parser?: Parser<number>,\n                   y1Parser?: Parser<number>): Parser<R2QuadraticCurve> {\n    const step = command === 84/*'T'*/ || command === 116/*'t'*/ ? 6 : 2;\n    return R2QuadraticCurveParser.parse(input, x0Parser, y0Parser, x1Parser, y1Parser,\n                                        void 0, void 0, command, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Numbers} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport type {AnyR2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport type {R2CurveContext} from \"./R2CurveContext\";\nimport {R2BezierCurve} from \"./R2BezierCurve\";\n\n/** @public */\nexport class R2CubicCurve extends R2BezierCurve implements Debug {\n  constructor(x0: number, y0: number, x1: number, y1: number,\n              x2: number, y2: number, x3: number, y3: number) {\n    super();\n    this.x0 = x0;\n    this.y0 = y0;\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n    this.x3 = x3;\n    this.y3 = y3;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.x0) && isFinite(this.y0)\n        && isFinite(this.x1) && isFinite(this.y1)\n        && isFinite(this.x2) && isFinite(this.y2)\n        && isFinite(this.x3) && isFinite(this.y3);\n  }\n\n  readonly x0: number;\n\n  readonly y0: number;\n\n  readonly x1: number;\n\n  readonly y1: number;\n\n  readonly x2: number;\n\n  readonly y2: number;\n\n  readonly x3: number;\n\n  readonly y3: number;\n\n  override get xMin(): number {\n    return Math.min(this.x0, this.x1, this.x2, this.x3);\n  }\n\n  override get yMin(): number {\n    return Math.min(this.y0, this.y1, this.y2, this.y3);\n  }\n\n  override get xMax(): number {\n    return Math.max(this.x0, this.x1, this.x2, this.x3);\n  }\n\n  override get yMax(): number {\n    return Math.max(this.y0, this.y1, this.y2, this.y3);\n  }\n\n  override interpolateX(u: number): number {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const x12 = v * this.x1 + u * this.x2;\n    const x23 = v * this.x2 + u * this.x3;\n    const x02 = v * x01 + u * x12;\n    const x13 = v * x12 + u * x23;\n    return v * x02 + u * x13;\n  }\n\n  override interpolateY(u: number): number {\n    const v = 1.0 - u;\n    const y01 = v * this.y0 + u * this.y1;\n    const y12 = v * this.y1 + u * this.y2;\n    const y23 = v * this.y2 + u * this.y3;\n    const y02 = v * y01 + u * y12;\n    const y13 = v * y12 + u * y23;\n    return v * y02 + u * y13;\n  }\n\n  override interpolate(u: number): R2Point {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const y01 = v * this.y0 + u * this.y1;\n    const x12 = v * this.x1 + u * this.x2;\n    const y12 = v * this.y1 + u * this.y2;\n    const x23 = v * this.x2 + u * this.x3;\n    const y23 = v * this.y2 + u * this.y3;\n    const x02 = v * x01 + u * x12;\n    const y02 = v * y01 + u * y12;\n    const x13 = v * x12 + u * x23;\n    const y13 = v * y12 + u * y23;\n    const x03 = v * x02 + u * x13;\n    const y03 = v * y02 + u * y13;\n    return new R2Point(x03, y03);\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    return false; // TODO\n  }\n\n  override split(u: number): [R2CubicCurve, R2CubicCurve] {\n    const v = 1.0 - u;\n    const x01 = v * this.x0 + u * this.x1;\n    const y01 = v * this.y0 + u * this.y1;\n    const x12 = v * this.x1 + u * this.x2;\n    const y12 = v * this.y1 + u * this.y2;\n    const x23 = v * this.x2 + u * this.x3;\n    const y23 = v * this.y2 + u * this.y3;\n    const x02 = v * x01 + u * x12;\n    const y02 = v * y01 + u * y12;\n    const x13 = v * x12 + u * x23;\n    const y13 = v * y12 + u * y23;\n    const x03 = v * x02 + u * x13;\n    const y03 = v * y02 + u * y13;\n    const c0 = new R2CubicCurve(this.x0, this.y0, x01, y01, x02, y02, x03, y03);\n    const c1 = new R2CubicCurve(x03, y03, x13, y13, x23, y23, this.x3, this.y3);\n    return [c0, c1];\n  }\n\n  override transform(f: R2Function): R2CubicCurve {\n    return new R2CubicCurve(f.transformX(this.x0, this.y0), f.transformY(this.x0, this.y0),\n                            f.transformX(this.x1, this.y1), f.transformY(this.x1, this.y1),\n                            f.transformX(this.x2, this.y2), f.transformY(this.x2, this.y2),\n                            f.transformX(this.x3, this.y3), f.transformY(this.x3, this.y3));\n  }\n\n  override drawMove(context: R2CurveContext): void {\n    context.moveTo(this.x0, this.y0);\n  }\n\n  override drawRest(context: R2CurveContext): void {\n    context.bezierCurveTo(this.x1, this.y1, this.x2, this.y2, this.x3, this.y3);\n  }\n\n  override transformDrawMove(context: R2CurveContext, f: R2Function): void {\n    context.moveTo(f.transformX(this.x0, this.y0), f.transformY(this.x0, this.y0));\n  }\n\n  override transformDrawRest(context: R2CurveContext, f: R2Function): void {\n    context.bezierCurveTo(f.transformX(this.x1, this.y1), f.transformY(this.x1, this.y1),\n                          f.transformX(this.x2, this.y2), f.transformY(this.x2, this.y2),\n                          f.transformX(this.x3, this.y3), f.transformY(this.x3, this.y3));\n  }\n\n  override writeMove<T>(output: Output<T>): Output<T> {\n    output = output.write(77/*'M'*/);\n    output = Format.displayNumber(output, this.x0);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, this.y0);\n    return output;\n  }\n\n  override writeRest<T>(output: Output<T>): Output<T> {\n    output = output.write(67/*'C'*/);\n    output = Format.displayNumber(output, this.x1);\n    output = output.write(44/*','*/)\n    output = Format.displayNumber(output, this.y1);\n    output = output.write(44/*','*/)\n    output = Format.displayNumber(output, this.x2);\n    output = output.write(44/*','*/)\n    output = Format.displayNumber(output, this.y2);\n    output = output.write(44/*','*/)\n    output = Format.displayNumber(output, this.x3);\n    output = output.write(44/*','*/)\n    output = Format.displayNumber(output, this.y3);\n    return output;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2CubicCurve) {\n      return Numbers.equivalent(this.x0, that.x0, epsilon)\n          && Numbers.equivalent(this.y0, that.y0, epsilon)\n          && Numbers.equivalent(this.x1, that.x1, epsilon)\n          && Numbers.equivalent(this.y1, that.y1, epsilon)\n          && Numbers.equivalent(this.x2, that.x2, epsilon)\n          && Numbers.equivalent(this.y2, that.y2, epsilon)\n          && Numbers.equivalent(this.x3, that.x3, epsilon)\n          && Numbers.equivalent(this.y3, that.y3, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2CubicCurve) {\n      return this.x0 === that.x0 && this.y0 === that.y0\n          && this.x1 === that.x1 && this.y1 === that.y1\n          && this.x2 === that.x2 && this.y2 === that.y2\n          && this.x3 === that.x3 && this.y3 === that.y3;\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Curve\").write(46/*'.'*/).write(\"cubic\").write(40/*'('*/)\n                   .debug(this.x0).write(\", \").debug(this.y0).write(\", \")\n                   .debug(this.x1).write(\", \").debug(this.y1).write(\", \")\n                   .debug(this.x2).write(\", \").debug(this.y2).write(\", \")\n                   .debug(this.x3).write(\", \").debug(this.y3).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {R2CubicCurve} from \"./R2CubicCurve\";\n\n/** @internal */\nexport class R2CubicCurveParser extends Parser<R2CubicCurve> {\n  private readonly x0Parser: Parser<number> | undefined;\n  private readonly y0Parser: Parser<number> | undefined;\n  private readonly x1Parser: Parser<number> | undefined;\n  private readonly y1Parser: Parser<number> | undefined;\n  private readonly x2Parser: Parser<number> | undefined;\n  private readonly y2Parser: Parser<number> | undefined;\n  private readonly x3Parser: Parser<number> | undefined;\n  private readonly y3Parser: Parser<number> | undefined;\n  private readonly command: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n              x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n              x2Parser?: Parser<number>, y2Parser?: Parser<number>,\n              x3Parser?: Parser<number>, y3Parser?: Parser<number>,\n              command?: number, step?: number) {\n    super();\n    this.x0Parser = x0Parser;\n    this.y0Parser = y0Parser;\n    this.x1Parser = x1Parser;\n    this.y1Parser = y1Parser;\n    this.x2Parser = x2Parser;\n    this.y2Parser = y2Parser;\n    this.x3Parser = x3Parser;\n    this.y3Parser = y3Parser;\n    this.command = command;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2CubicCurve> {\n    return R2CubicCurveParser.parse(input, this.x0Parser, this.y0Parser,\n                                    this.x1Parser, this.y1Parser,\n                                    this.x2Parser, this.y2Parser,\n                                    this.x3Parser, this.y3Parser,\n                                    this.command, this.step);\n  }\n\n  static parse(input: Input, x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n               x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n               x2Parser?: Parser<number>, y2Parser?: Parser<number>,\n               x3Parser?: Parser<number>, y3Parser?: Parser<number>,\n               command?: number, step: number = 1): Parser<R2CubicCurve> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        switch (c) {\n          case 67/*'C'*/:\n          case 99/*'c'*/:\n            input = input.step();\n            command = c;\n            step = 2;\n            break;\n          case 83/*'S'*/:\n          case 115/*'s'*/:\n            input = input.step();\n            command = c;\n            step = 6;\n            break;\n          default:\n            return Parser.error(Diagnostic.expected(\"curveto\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (x1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x1Parser = x1Parser.feed(input);\n      }\n      if (x1Parser !== void 0) {\n        if (x1Parser.isDone()) {\n          step = 3;\n        } else if (x1Parser.isError()) {\n          return x1Parser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 4;\n      } else if (!input.isEmpty()) {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (y1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y1Parser = y1Parser.feed(input);\n      }\n      if (y1Parser !== void 0) {\n        if (y1Parser.isDone()) {\n          step = 5;\n        } else if (y1Parser.isError()) {\n          return y1Parser.asError();\n        }\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 6;\n      } else if (!input.isEmpty()) {\n        step = 6;\n      }\n    }\n    if (step === 6) {\n      if (x2Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x2Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x2Parser = x2Parser.feed(input);\n      }\n      if (x2Parser !== void 0) {\n        if (x2Parser.isDone()) {\n          step = 7;\n        } else if (x2Parser.isError()) {\n          return x2Parser.asError();\n        }\n      }\n    }\n    if (step === 7) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 8;\n      } else if (!input.isEmpty()) {\n        step = 8;\n      }\n    }\n    if (step === 8) {\n      if (y2Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y2Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y2Parser = y2Parser.feed(input);\n      }\n      if (y2Parser !== void 0) {\n        if (y2Parser.isDone()) {\n          step = 9;\n        } else if (y2Parser.isError()) {\n          return y2Parser.asError();\n        }\n      }\n    }\n    if (step === 9) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 10;\n      } else if (!input.isEmpty()) {\n        step = 10;\n      }\n    }\n    if (step === 10) {\n      if (x3Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x3Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x3Parser = x3Parser.feed(input);\n      }\n      if (x3Parser !== void 0) {\n        if (x3Parser.isDone()) {\n          step = 11;\n        } else if (x3Parser.isError()) {\n          return x3Parser.asError();\n        }\n      }\n    }\n    if (step === 11) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 12;\n      } else if (!input.isEmpty()) {\n        step = 12;\n      }\n    }\n    if (step === 12) {\n      if (y3Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y3Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y3Parser = y3Parser.feed(input);\n      }\n      if (y3Parser !== void 0) {\n        if (y3Parser.isDone()) {\n          const x0 = x0Parser!.bind();\n          const y0 = y0Parser!.bind();\n          let x1 = x1Parser!.bind();\n          let y1 = y1Parser!.bind();\n          let x2 = x2Parser!.bind();\n          let y2 = y2Parser!.bind();\n          let x3 = x3Parser!.bind();\n          let y3 = y3Parser.bind();\n          if (command === 99/*'c'*/ || command === 115/*'s'*/) {\n            x1 += x0;\n            y1 += y0;\n            x2 += x0;\n            y2 += y0;\n            x3 += x0;\n            y3 += y0;\n          }\n          return Parser.done(new R2CubicCurve(x0, y0, x1, y1, x2, y2, x3, y3));\n        } else if (y3Parser.isError()) {\n          return y3Parser.asError();\n        }\n      }\n    }\n    return new R2CubicCurveParser(x0Parser, y0Parser, x1Parser, y1Parser,\n                                  x2Parser, y2Parser, x3Parser, y3Parser,\n                                  command, step);\n  }\n\n  static parseRest(input: Input, command?: number, x0Parser?: Parser<number>,\n                   y0Parser?: Parser<number>, x1Parser?: Parser<number>,\n                   y1Parser?: Parser<number>): Parser<R2CubicCurve> {\n    const step = command === 83/*'S'*/ || command === 115/*'s'*/ ? 6 : 2;\n    return R2CubicCurveParser.parse(input, x0Parser, y0Parser, x1Parser, y1Parser,\n                                    void 0, void 0, void 0, void 0, command, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Numbers} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport type {AnyR2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport type {R2CurveContext} from \"./R2CurveContext\";\nimport {R2Curve} from \"./R2Curve\";\n\n/** @public */\nexport class R2EllipticCurve extends R2Curve implements Debug {\n  constructor(cx: number, cy: number, rx: number, ry: number,\n              phi: number, a0: number, da: number) {\n    super();\n    this.cx = cx;\n    this.cy = cy;\n    this.rx = rx;\n    this.ry = ry;\n    this.phi = phi;\n    this.a0 = a0;\n    this.da = da;\n  }\n\n  readonly cx: number;\n\n  readonly cy: number;\n\n  readonly rx: number;\n\n  readonly ry: number;\n\n  readonly phi: number;\n\n  readonly a0: number;\n\n  readonly da: number;\n\n  override get xMin(): number {\n    return this.cx - Math.max(this.rx, this.ry);\n  }\n\n  override get yMin(): number {\n    return this.cy - Math.max(this.rx, this.ry);\n  }\n\n  override get xMax(): number {\n    return this.cx + Math.max(this.rx, this.ry);\n  }\n\n  override get yMax(): number {\n    return this.cy + Math.max(this.rx, this.ry);\n  }\n\n  override interpolateX(u: number): number {\n    const a0 = this.a0;\n    const da = this.da;\n    const a = a0 + u * da;\n    const dx = this.rx * Math.cos(a);\n    const dy = this.ry * Math.sin(a);\n    const phi = this.phi;\n    if (phi === 0) {\n      return this.cx + dx;\n    } else {\n      return this.cx + dx * Math.cos(phi) - dy * Math.sin(phi);\n    }\n  }\n\n  override interpolateY(u: number): number {\n    const a0 = this.a0;\n    const da = this.da;\n    const a = a0 + u * da;\n    const dx = this.rx * Math.cos(a);\n    const dy = this.ry * Math.sin(a);\n    const phi = this.phi;\n    if (phi === 0) {\n      return this.cy + dy;\n    } else {\n      return this.cy + dx * Math.sin(phi) + dy * Math.cos(phi);\n    }\n  }\n\n  override interpolate(u: number): R2Point {\n    const a0 = this.a0;\n    const da = this.da;\n    const a = a0 + u * da;\n    const dx = this.rx * Math.cos(a);\n    const dy = this.ry * Math.sin(a);\n    const phi = this.phi;\n    if (phi === 0) {\n      return new R2Point(this.cx + dx, this.cy + dy);\n    } else {\n      return new R2Point(this.cx + dx * Math.cos(phi) - dy * Math.sin(phi),\n                         this.cy + dx * Math.sin(phi) + dy * Math.cos(phi));\n    }\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    return false; // TODO\n  }\n\n  override split(u: number): [R2EllipticCurve, R2EllipticCurve] {\n    const a0 = this.a0;\n    const da = this.da;\n    const a = a0 + u * da;\n    const c0 = new R2EllipticCurve(this.cx, this.cy, this.rx, this.ry,\n                                   this.phi, a0, a - a0);\n    const c1 = new R2EllipticCurve(this.cx, this.cy, this.rx, this.ry,\n                                   this.phi, a, a0 + da - a);\n    return [c0, c1];\n  }\n\n  override transform(f: R2Function): R2EllipticCurve {\n    const cx = f.transformX(this.cx, this.cy);\n    const cy = f.transformY(this.cx, this.cy);\n    const rx = f.transformX(this.cx + this.rx, this.cy + this.ry) - cx;\n    const ry = f.transformY(this.cx + this.rx, this.cy + this.ry) - cy;\n    const a0 = this.a0;\n    const da = this.da;\n    const a1 = a0 + da;\n    const a0x = Math.cos(a0);\n    const a0y = Math.sin(a0);\n    const a1x = Math.cos(a1);\n    const a1y = Math.sin(a1);\n    const b0x = f.transformX(this.cx + a0x, this.cy - a0y) - cx;\n    const b0y = f.transformY(this.cx + a0x, this.cy - a0y) - cy;\n    const b1x = f.transformX(this.cx + a1x, this.cy - a1y) - cx;\n    const b1y = f.transformY(this.cx + a1x, this.cy - a1y) - cy;\n    const b0 = Math.atan2(b0y, b0x);\n    let b1 = Math.atan2(b1y, b1x);\n    if (Math.abs(da) > Math.PI) {\n      if (b1 > 0) {\n        b1 = -2 * Math.PI + b1;\n      } else if (b1 < 0) {\n        b1 = 2 * Math.PI - b1\n      }\n    }\n    const db = b1 - b0;\n    return new R2EllipticCurve(cx, cy, rx, ry, this.phi, b0, db);\n  }\n\n  override drawMove(context: R2CurveContext): void {\n    const {x0, y0} = this.toEndpoints();\n    context.moveTo(x0, y0);\n  }\n\n  override drawRest(context: R2CurveContext): void {\n    context.ellipse(this.cx, this.cy, this.rx, this.ry, this.phi,\n                    this.a0, this.a0 + this.da, this.da < 0);\n  }\n\n  override transformDrawMove(context: R2CurveContext, f: R2Function): void {\n    const {x0, y0} = this.toEndpoints();\n    context.moveTo(f.transformX(x0, y0), f.transformY(x0, y0));\n  }\n\n  override transformDrawRest(context: R2CurveContext, f: R2Function): void {\n    const cx = f.transformX(this.cx, this.cy);\n    const cy = f.transformY(this.cx, this.cy);\n    const rx = f.transformX(this.cx + this.rx, this.cy + this.ry) - cx;\n    const ry = f.transformY(this.cx + this.rx, this.cy + this.ry) - cy;\n    const a0 = this.a0;\n    const da = this.da;\n    const a1 = a0 + da;\n    const a0x = Math.cos(a0);\n    const a0y = Math.sin(a0);\n    const a1x = Math.cos(a1);\n    const a1y = Math.sin(a1);\n    const b0x = f.transformX(this.cx + a0x, this.cy - a0y) - cx;\n    const b0y = f.transformY(this.cx + a0x, this.cy - a0y) - cy;\n    const b1x = f.transformX(this.cx + a1x, this.cy - a1y) - cx;\n    const b1y = f.transformY(this.cx + a1x, this.cy - a1y) - cy;\n    const b0 = Math.atan2(b0y, b0x);\n    let b1 = Math.atan2(b1y, b1x);\n    if (Math.abs(da) > Math.PI) {\n      if (b1 > 0) {\n        b1 = -2 * Math.PI + b1;\n      } else if (b1 < 0) {\n        b1 = 2 * Math.PI - b1\n      }\n    }\n    const ccw = b1 < b0;\n    context.ellipse(cx, cy, rx, ry, this.phi, b0, b1, ccw);\n  }\n\n  override writeMove<T>(output: Output<T>): Output<T> {\n    const {x0, y0} = this.toEndpoints();\n    output = output.write(77/*'M'*/);\n    output = Format.displayNumber(output, x0);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, y0);\n    return output;\n  }\n\n  override writeRest<T>(output: Output<T>): Output<T> {\n    const {rx, ry, phi, large, sweep, x1, y1} = this.toEndpoints();\n    output = output.write(65/*'A'*/);\n    output = Format.displayNumber(output, rx);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, ry);\n    output = output.write(32/*' '*/);\n    output = Format.displayNumber(output, phi);\n    output = output.write(32/*' '*/);\n    output = output.write(large ? 49/*'1'*/ : 48/*'0'*/);\n    output = output.write(44/*','*/);\n    output = output.write(sweep ? 49/*'1'*/ : 48/*'0'*/);\n    output = output.write(32/*' '*/);\n    output = Format.displayNumber(output, x1);\n    output = output.write(44/*','*/);\n    output = Format.displayNumber(output, y1);\n    return output;\n  }\n\n  toEndpoints(): {x0: number, y0: number, rx: number, ry: number, phi: number,\n                  large: boolean, sweep: boolean, x1: number, y1: number} {\n    const cx = this.cx;\n    const cy = this.cy;\n    const rx = this.rx;\n    const ry = this.ry;\n    const phi = this.phi;\n    const a0 = this.a0;\n    const da = this.da;\n    const a1 = a0 + da;\n\n    const cosPhi = Math.cos(phi);\n    const sinPhi = Math.sin(phi);\n    const cosA0 = Math.cos(a0);\n    const sinA0 = Math.sin(a0);\n    const cosA1 = Math.cos(a1);\n    const sinA1 = Math.sin(a1);\n    const x0 = cosPhi * rx * cosA0 - sinPhi * ry * sinA0 + cx;\n    const y0 = sinPhi * rx * cosA0 + cosPhi * ry * sinA0 + cy;\n    const x1 = cosPhi * rx * cosA1 - sinPhi * ry * sinA1 + cx;\n    const y1 = sinPhi * rx * cosA1 + cosPhi * ry * sinA1 + cy;\n    const large = Math.abs(da) > Math.PI;\n    const sweep = da > 0;\n    return {x0, y0, rx, ry, phi, large, sweep, x1, y1};\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2EllipticCurve) {\n      return Numbers.equivalent(this.cx, that.cx, epsilon)\n          && Numbers.equivalent(this.cy, that.cy, epsilon)\n          && Numbers.equivalent(this.rx, that.rx, epsilon)\n          && Numbers.equivalent(this.ry, that.ry, epsilon)\n          && Numbers.equivalent(this.phi, that.phi, epsilon)\n          && Numbers.equivalent(this.a0, that.a0, epsilon)\n          && Numbers.equivalent(this.da, that.da, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2EllipticCurve) {\n      return this.cx === that.cx && this.cy === that.cy\n          && this.rx === that.rx && this.ry === that.ry\n          && this.phi === that.phi && this.a0 === that.a0\n          && this.da === that.da;\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Curve\").write(46/*'.'*/).write(\"elliptic\").write(40/*'('*/)\n                   .debug(this.cx).write(\", \").debug(this.cy).write(\", \")\n                   .debug(this.rx).write(\", \").debug(this.ry).write(\", \")\n                   .debug(this.phi).write(\", \").debug(this.a0).write(\", \")\n                   .debug(this.da).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static fromEndpoints(x0: number, y0: number, rx: number, ry: number, phi: number,\n                       large: boolean, sweep: boolean, x1: number, y1: number): R2EllipticCurve {\n    const cosPhi = Math.cos(phi);\n    const sinPhi = Math.sin(phi);\n    const x0p =  cosPhi * ((x0 - x1) / 2) + sinPhi * ((y0 - y1) / 2);\n    const y0p = -sinPhi * ((x0 - x1) / 2) + cosPhi * ((y0 - y1) / 2);\n\n    const rx2 = rx * rx;\n    const ry2 = ry * ry;\n    const x0p2 = x0p * x0p;\n    const y0p2 = y0p * y0p;\n    let sp = Math.sqrt((rx2 * ry2 - rx2 * y0p2 - ry2 * x0p2) / (rx2 * y0p2 + ry2 * x0p2));\n    if (large === sweep) {\n      sp = -sp;\n    }\n    const cxp =  sp * rx * y0p / ry;\n    const cyp = -sp * ry * x0p / rx;\n    const cx = cosPhi * cxp - sinPhi * cyp + (x0 + x1) / 2;\n    const cy = sinPhi * cxp + cosPhi * cyp + (y0 + y1) / 2;\n\n    function angle(ux: number, uy: number, vx: number, vy: number): number {\n      const uv = ux * vx + uy * vy;\n      const uu = ux * ux + uy * uy;\n      const vv = vx * vx + vy * vy;\n      let a = Math.acos(uv / (Math.sqrt(uu) * Math.sqrt(vv)));\n      if (ux * vy - uy * vx < 0) {\n        a = -a;\n      }\n      return a;\n    }\n    const a0 = angle(1, 0, (x0p - cxp) / rx, (y0p - cyp) / ry);\n    let da = angle((x0p - cxp) / rx, (y0p - cyp) / ry, (-x0p - cxp) / rx, (-y0p - cyp) / ry) % (2 * Math.PI);\n    if (sweep && da < 0) {\n      da += 2 * Math.PI;\n    } else if (!sweep && da > 0) {\n      da -= 2 * Math.PI;\n    }\n\n    return new R2EllipticCurve(cx, cy, rx, ry, phi, a0, da);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {R2EllipticCurve} from \"./R2EllipticCurve\";\n\n/** @internal */\nexport class R2EllipticCurveParser extends Parser<R2EllipticCurve> {\n  private readonly x0Parser: Parser<number> | undefined;\n  private readonly y0Parser: Parser<number> | undefined;\n  private readonly rxParser: Parser<number> | undefined;\n  private readonly ryParser: Parser<number> | undefined;\n  private readonly phiParser: Parser<number> | undefined;\n  private readonly large: boolean | undefined;\n  private readonly sweep: boolean | undefined;\n  private readonly x1Parser: Parser<number> | undefined;\n  private readonly y1Parser: Parser<number> | undefined;\n  private readonly command: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n              rxParser?: Parser<number>, ryParser?: Parser<number>,\n              phiParser?: Parser<number>, large?: boolean, sweep?: boolean,\n              x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n              command?: number, step?: number) {\n    super();\n    this.x0Parser = x0Parser;\n    this.y0Parser = y0Parser;\n    this.rxParser = rxParser;\n    this.ryParser = ryParser;\n    this.phiParser = phiParser;\n    this.large = large;\n    this.sweep = sweep;\n    this.x1Parser = x1Parser;\n    this.y1Parser = y1Parser;\n    this.command = command;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2EllipticCurve> {\n    return R2EllipticCurveParser.parse(input, this.x0Parser, this.y0Parser,\n                                       this.rxParser, this.ryParser,\n                                       this.phiParser, this.large, this.sweep,\n                                       this.x1Parser, this.y1Parser,\n                                       this.command, this.step);\n  }\n\n  static parse(input: Input, x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n               rxParser?: Parser<number>, ryParser?: Parser<number>,\n               phiParser?: Parser<number>, large?: boolean, sweep?: boolean,\n               x1Parser?: Parser<number>, y1Parser?: Parser<number>,\n               command?: number, step: number = 1): Parser<R2EllipticCurve> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        switch (c) {\n          case 65/*'A'*/:\n          case 97/*'a'*/:\n            input = input.step();\n            command  = c;\n            step = 2;\n            break;\n          default:\n            return Parser.error(Diagnostic.expected(\"arcto\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (rxParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          rxParser = Base10.parseDecimal(input);\n        }\n      } else {\n        rxParser = rxParser.feed(input);\n      }\n      if (rxParser !== void 0) {\n        if (rxParser.isDone()) {\n          step = 3;\n        } else if (rxParser.isError()) {\n          return rxParser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 4;\n      } else if (!input.isEmpty()) {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (ryParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          ryParser = Base10.parseDecimal(input);\n        }\n      } else {\n        ryParser = ryParser.feed(input);\n      }\n      if (ryParser !== void 0) {\n        if (ryParser.isDone()) {\n          step = 5;\n        } else if (ryParser.isError()) {\n          return ryParser.asError();\n        }\n      }\n    }\n    if (step === 5) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 6;\n      } else if (!input.isEmpty()) {\n        step = 6;\n      }\n    }\n    if (step === 6) {\n      if (phiParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          phiParser = Base10.parseDecimal(input);\n        }\n      } else {\n        phiParser = phiParser.feed(input);\n      }\n      if (phiParser !== void 0) {\n        if (phiParser.isDone()) {\n          step = 7;\n        } else if (phiParser.isError()) {\n          return phiParser.asError();\n        }\n      }\n    }\n    if (step === 7) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 8;\n      } else if (!input.isEmpty()) {\n        step = 8;\n      }\n    }\n    if (step === 8) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 48/*'0'*/) {\n          input = input.step();\n          large = false;\n          step = 9;\n        } else if (c === 49/*'1'*/) {\n          input = input.step();\n          large = true;\n          step = 9;\n        } else {\n          return Parser.error(Diagnostic.expected(\"flag\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 9) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 10;\n      } else if (!input.isEmpty()) {\n        step = 10;\n      }\n    }\n    if (step === 10) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 48/*'0'*/) {\n          input = input.step();\n          sweep = false;\n          step = 11;\n        } else if (c === 49/*'1'*/) {\n          input = input.step();\n          sweep = true;\n          step = 11;\n        } else {\n          return Parser.error(Diagnostic.expected(\"flag\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 11) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 12;\n      } else if (!input.isEmpty()) {\n        step = 12;\n      }\n    }\n    if (step === 12) {\n      if (x1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x1Parser = x1Parser.feed(input);\n      }\n      if (x1Parser !== void 0) {\n        if (x1Parser.isDone()) {\n          step = 13;\n        } else if (x1Parser.isError()) {\n          return x1Parser.asError();\n        }\n      }\n    }\n    if (step === 13) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 14;\n      } else if (!input.isEmpty()) {\n        step = 14;\n      }\n    }\n    if (step === 14) {\n      if (y1Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y1Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y1Parser = y1Parser.feed(input);\n      }\n      if (y1Parser !== void 0) {\n        if (y1Parser.isDone()) {\n          const x0 = x0Parser!.bind();\n          const y0 = y0Parser!.bind();\n          const rx = rxParser!.bind();\n          const ry = ryParser!.bind();\n          const phi = phiParser!.bind() * Math.PI / 180;\n          let x1 = x1Parser!.bind();\n          let y1 = y1Parser.bind();\n          if (command === 97/*'a'*/) {\n            x1 += x0;\n            y1 += y0;\n          }\n          return Parser.done(R2EllipticCurve.fromEndpoints(x0, y0, rx, ry, phi, large!, sweep!, x1, y1));\n        } else if (y1Parser.isError()) {\n          return y1Parser.asError();\n        }\n      }\n    }\n    return new R2EllipticCurveParser(x0Parser, y0Parser, rxParser, ryParser,\n                                     phiParser, large, sweep, x1Parser, y1Parser,\n                                     command, step);\n  }\n\n  static parseRest(input: Input, command?: number, x0Parser?: Parser<number>,\n                   y0Parser?: Parser<number>): Parser<R2EllipticCurve> {\n    return R2EllipticCurveParser.parse(input, x0Parser, y0Parser, void 0, void 0, void 0,\n                                       void 0, void 0, void 0, void 0, command, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays} from \"@swim/util\";\nimport {\n  Debug,\n  Format,\n  AnyOutputSettings,\n  Output,\n  Parser,\n  Diagnostic,\n  Unicode,\n} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport type {AnyR2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport {R2Curve} from \"./R2Curve\";\nimport type {R2SplineContext} from \"./R2SplineContext\";\nimport {R2SplineBuilder} from \"../\"; // forward import\nimport {R2SplineParser} from \"../\"; // forward import\nimport {R2Box} from \"../\"; // forward import\n\n/** @public */\nexport class R2Spline extends R2Curve implements Debug {\n  constructor(curves: ReadonlyArray<R2Curve>, closed: boolean) {\n    super();\n    this.curves = curves;\n    this.closed = closed;\n    this.boundingBox = null;\n    this.pathString = void 0;\n  }\n\n  readonly curves: ReadonlyArray<R2Curve>;\n\n  /** @internal */\n  readonly closed: boolean;\n\n  isDefined(): boolean {\n    return this.curves.length !== 0;\n  }\n\n  isClosed(): boolean {\n    return this.closed;\n  }\n\n  override get xMin(): number {\n    return this.bounds.xMin;\n  }\n\n  override get yMin(): number {\n    return this.bounds.yMin;\n  }\n\n  override get xMax(): number {\n    return this.bounds.xMax;\n  }\n\n  override get yMax(): number {\n    return this.bounds.yMax;\n  }\n\n  override interpolateX(u: number): number {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n - 1);\n      const v = n * (u - k * l);\n      return curves[k]!.interpolateX(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  override interpolateY(u: number): number {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n - 1);\n      const v = n * (u - k * l);\n      return curves[k]!.interpolateY(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  override interpolate(u: number): R2Point {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n - 1);\n      const v = n * (u - k * l);\n      return curves[k]!.interpolate(v);\n    } else {\n      return new R2Point(NaN, NaN);\n    }\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    return false; // TODO\n  }\n\n  override split(u: number): [R2Spline, R2Spline] {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n - 1);\n      const v = n * (u - k * l);\n      const [c0, c1] = curves[k]!.split(v);\n      const curves0 = new Array<R2Curve>(k + 1);\n      const curves1 = new Array<R2Curve>(n - k);\n      for (let i = 0; i < k; i += 1) {\n        curves0[i] = curves[i]!;\n      }\n      curves0[k] = c0;\n      curves1[0] = c1;\n      for (let i = k + 1; i < n; i += 1) {\n        curves1[i - k] = curves[i]!;\n      }\n      return [new R2Spline(curves0, false), new R2Spline(curves1, false)];\n    } else {\n      return [R2Spline.empty(), R2Spline.empty()];\n    }\n  }\n\n  subdivide(u: number): R2Spline {\n    const oldCurves = this.curves;\n    const n = oldCurves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n - 1);\n      const v = n * (u - k * l);\n      const [c0, c1] = oldCurves[k]!.split(v);\n      const newCurves = new Array<R2Curve>(n + 1);\n      for (let i = 0; i < k; i += 1) {\n        newCurves[i] = oldCurves[i]!;\n      }\n      newCurves[k] = c0;\n      newCurves[k + 1] = c1;\n      for (let i = k + 1; i < n; i += 1) {\n        newCurves[i + 1] = oldCurves[i]!;\n      }\n      return new R2Spline(newCurves, this.closed);\n    } else {\n      return R2Spline.empty();\n    }\n  }\n\n  override transform(f: R2Function): R2Spline {\n    const oldCurves = this.curves;\n    const n = oldCurves.length;\n    if (n > 0) {\n      const newCurves = new Array<R2Curve>(n);\n      for (let i = 0; i < n; i += 1) {\n        newCurves[i] = oldCurves[i]!.transform(f);\n      }\n      return new R2Spline(newCurves, this.closed);\n    } else {\n      return R2Spline.empty();\n    }\n  }\n\n  /** @internal */\n  readonly boundingBox: R2Box | null;\n\n  override get bounds(): R2Box {\n    let boundingBox = this.boundingBox;\n    if (boundingBox === null) {\n      let xMin = Infinity;\n      let yMin = Infinity;\n      let xMax = -Infinity;\n      let yMax = -Infinity;\n      const curves = this.curves;\n      for (let i = 0, n = curves.length; i < n; i += 1) {\n        const curve = curves[i]!;\n        xMin = Math.min(xMin, curve.xMin);\n        yMin = Math.min(yMin, curve.yMin);\n        xMax = Math.max(curve.xMax, xMax);\n        yMax = Math.max(curve.yMax, yMax);\n      }\n      boundingBox = new R2Box(xMin, yMin, xMax, yMax);\n      (this as Mutable<this>).boundingBox = boundingBox;\n    }\n    return boundingBox;\n  }\n\n  override drawMove(context: R2SplineContext): void {\n    const curves = this.curves;\n    if (curves.length !== 0) {\n      curves[0]!.drawMove(context);\n    }\n  }\n\n  override drawRest(context: R2SplineContext): void {\n    const curves = this.curves;\n    const closed = this.closed;\n    const n = curves.length - (closed && context.closePath !== void 0 ? 1 : 0);\n    for (let i = 0; i < n; i += 1) {\n      curves[i]!.drawRest(context);\n    }\n    if (closed && context.closePath !== void 0) {\n      context.closePath();\n    }\n  }\n\n  override transformDrawMove(context: R2SplineContext, f: R2Function): void {\n    const curves = this.curves;\n    if (curves.length !== 0) {\n      curves[0]!.transformDrawMove(context, f);\n    }\n  }\n\n  override transformDrawRest(context: R2SplineContext, f: R2Function): void {\n    const curves = this.curves;\n    const closed = this.closed;\n    const n = curves.length - (closed && context.closePath !== void 0 ? 1 : 0);\n    for (let i = 0; i < n; i += 1) {\n      curves[i]!.transformDrawRest(context, f);\n    }\n    if (closed && context.closePath !== void 0) {\n      context.closePath();\n    }\n  }\n\n  override writeMove<T>(output: Output<T>): Output<T> {\n    const curves = this.curves;\n    if (curves.length !== 0) {\n      output = curves[0]!.writeMove(output);\n    }\n    return output;\n  }\n\n  override writeRest<T>(output: Output<T>): Output<T> {\n    const curves = this.curves;\n    const closed = this.closed;\n    const n = curves.length - (closed ? 1 : 0);\n    for (let i = 0; i < n; i += 1) {\n      output = curves[i]!.writeRest(output);\n    }\n    if (closed) {\n      output = output.write(90/*'Z'*/);\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly pathString: string | undefined;\n\n  override toPathString(outputSettings?: AnyOutputSettings): string {\n    let pathString: string | undefined;\n    if (outputSettings !== void 0 || (pathString = this.pathString, pathString === void 0)) {\n      const output = Unicode.stringOutput(outputSettings);\n      this.writePath(output);\n      pathString = output.bind();\n      if (outputSettings === void 0) {\n        (this as Mutable<this>).pathString = pathString;\n      }\n    }\n    return pathString;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Spline) {\n      return Arrays.equivalent(this.curves, that.curves, epsilon)\n          && this.closed === that.closed;\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Spline) {\n      return Arrays.equal(this.curves, that.curves)\n          && this.closed === that.closed;\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    const curves = this.curves;\n    const n = curves.length;\n    output = output.write(\"R2Spline\").write(46/*'.'*/);\n    if (n === 0) {\n      output = output.write(\"empty\").write(40/*'('*/);\n    } else if (n !== 0) {\n      output = output.write(this.closed ? \"closed\" : \"open\").write(40/*'('*/);\n      output = output.debug(curves[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(curves[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static empty(): R2Spline {\n    return new R2Spline([], false);\n  }\n\n  static open(...curves: R2Curve[]): R2Spline {\n    return new R2Spline(curves, false);\n  }\n\n  static closed(...curves: R2Curve[]): R2Spline {\n    return new R2Spline(curves, true);\n  }\n\n  static builder(): R2SplineBuilder {\n    return new R2SplineBuilder();\n  }\n\n  static override parse(string: string): R2Spline {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = R2SplineParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Curve} from \"./R2Curve\";\nimport {R2Segment} from \"./R2Segment\";\nimport {R2QuadraticCurve} from \"./R2QuadraticCurve\";\nimport {R2CubicCurve} from \"./R2CubicCurve\";\nimport {R2EllipticCurve} from \"./R2EllipticCurve\";\nimport type {R2SplineContext} from \"./R2SplineContext\";\nimport {R2Spline} from \"./R2Spline\";\n\n/** @public */\nexport class R2SplineBuilder implements R2SplineContext {\n  /** @internal */\n  curves: R2Curve[];\n  /** @internal */\n  closed: boolean;\n  /** @internal */\n  aliased: boolean;\n  /** @internal */\n  x0: number;\n  /** @internal */\n  y0: number;\n  /** @internal */\n  x: number;\n  /** @internal */\n  y: number;\n\n  constructor() {\n    this.curves = [];\n    this.closed = false;\n    this.aliased = false;\n    this.x0 = 0;\n    this.y0 = 0;\n    this.x = 0;\n    this.y = 0;\n  }\n\n  private dealias(): void {\n    if (this.aliased) {\n      this.curves = this.curves.slice(0);\n      this.aliased = false;\n    }\n  }\n\n  moveTo(x: number, y: number): void {\n    if (this.aliased) {\n      this.curves = [];\n      this.aliased = false;\n    } else {\n      this.curves.length = 0;\n    }\n    this.closed = false;\n    this.x0 = x;\n    this.y0 = y;\n    this.x = x;\n    this.y = y;\n  }\n\n  closePath(): void {\n    this.dealias();\n    this.curves.push(new R2Segment(this.x, this.y, this.x0, this.y0));\n    this.closed = true;\n    this.x = this.x0;\n    this.y = this.y0;\n  }\n\n  lineTo(x: number, y: number): void {\n    this.dealias();\n    this.curves.push(new R2Segment(this.x, this.y, x, y));\n    this.x = x;\n    this.y = y;\n  }\n\n  quadraticCurveTo(x1: number, y1: number, x: number, y: number): void {\n    this.dealias();\n    this.curves.push(new R2QuadraticCurve(this.x, this.y, x1, y1, x, y));\n    this.x = x;\n    this.y = y;\n  }\n\n  bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x: number, y: number): void {\n    this.dealias();\n    this.curves.push(new R2CubicCurve(this.x, this.y, x1, y1, x2, y2, x, y));\n    this.x = x;\n    this.y = y;\n  }\n\n  arcTo(x1: number, y1: number, x2: number, y2: number, r: number): void {\n    this.dealias();\n    const x0 = this.x;\n    const y0 = this.y;\n    const dx01 = x1 - x0;\n    const dy01 = y1 - y0;\n    const dx12 = x2 - x1;\n    const dy12 = y2 - y1;\n    const a0 = Math.atan2(dy01, dx01) - Math.PI / 2;\n    const a1 = Math.atan2(dy12, dx12) - Math.PI / 2;\n    const da = a1 - a0;\n    const r0x = Math.cos(a0);\n    const r0y = Math.sin(a0);\n    const r1x = Math.cos(a1);\n    const r1y = Math.sin(a1);\n    const r0x0 = x0 - r0x;\n    const r0y0 = y0 - r0y;\n    const r0x1 = x1 - r0x;\n    const r0y1 = y1 - r0y;\n    const r1x1 = x1 - r1x;\n    const r1y1 = y1 - r1y;\n    const r1x2 = x2 - r1x;\n    const r1y2 = y2 - r1y;\n    const u = R2SplineBuilder.intersection(r0x0, r0y0, r0x1 - r0x0, r0y1 - r0y0,\n                                           r1x1, r1y1, r1x2 - r1x1, r1y2 - r1y1);\n    const cx = r0x0 + u * (r0x1 - r0x0);\n    const cy = r0y0 + u * (r0y1 - r0y0);\n    this.curves.push(new R2EllipticCurve(cx, cy, r, r, 0, a0, da));\n    this.x = x2;\n    this.y = y2;\n  }\n\n  private static intersection(px: number, py: number, rx: number, ry: number,\n                              qx: number, qy: number, sx: number, sy: number): number {\n    const pqx = qx - px;\n    const pqy = qy - py;\n    const pqr = pqx * ry - pqy * rx;\n    const rs = rx * sy - ry * sx;\n    if (pqr === 0 && rs === 0) { // collinear\n      const rr = rx * rx + ry * ry;\n      const sr = sx * rx + sy * ry;\n      const t0 = (pqx * rx + pqy * ry) / rr;\n      const t1 = t0 + sr / rr;\n      if (sr >= 0 ? 0 < t1 && t0 < 1 : 0 < t0 && t1 < 1) {\n        return t0;\n      } else {\n        return NaN;\n      }\n    } else if (rs === 0) { // parallel\n      return NaN;\n    } else {\n      const pqs = pqx * sy - pqy * sx;\n      const t = pqs / rs; // (q − p) × s / (r × s)\n      const u = pqr / rs; // (q − p) × r / (r × s)\n      if (0 <= t && t <= 1 && 0 <= u && u <= 1) {\n        return t;\n      } else {\n        return NaN;\n      }\n    }\n  }\n\n  arc(cx: number, cy: number, r: number, a0: number, a1: number, ccw: boolean = false): void {\n    this.dealias();\n    let da = a1 - a0;\n    if (ccw === true && da > 0) {\n      da -= 2 * Math.PI;\n    } else if (ccw === false && da < 0) {\n      da += 2 * Math.PI;\n    }\n    const curve = new R2EllipticCurve(cx, cy, r, r, 0, a0, da);\n    this.curves.push(curve);\n    const {x, y} = curve.interpolate(1);\n    this.x = x;\n    this.y = y;\n  }\n\n  ellipse(cx: number, cy: number, rx: number, ry: number, phi: number, a0: number, a1: number, ccw?: boolean): void {\n    this.dealias();\n    let da = a1 - a0;\n    if (ccw === true && da > 0) {\n      da -= 2 * Math.PI;\n    } else if (ccw === false && da < 0) {\n      da += 2 * Math.PI;\n    }\n    const curve = new R2EllipticCurve(cx, cy, rx, ry, phi, a0, da);\n    this.curves.push(curve);\n    const {x, y} = curve.interpolate(1);\n    this.x = x;\n    this.y = y;\n  }\n\n  rect(x: number, y: number, w: number, h: number): void {\n    this.dealias();\n    this.curves.push(new R2Segment(x, y, x + w, y),\n                     new R2Segment(x + w, y, x + w, y + h),\n                     new R2Segment(x + w, y + h, x, y + h),\n                     new R2Segment(x, y + h, x, y));\n    this.x = x;\n    this.y = y;\n  }\n\n  bind(): R2Spline {\n    this.aliased = true;\n    return new R2Spline(this.curves, this.closed);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport type {R2Curve} from \"./R2Curve\";\nimport {R2Segment} from \"./R2Segment\";\nimport {R2SegmentParser} from \"./R2SegmentParser\";\nimport {R2QuadraticCurve} from \"./R2QuadraticCurve\";\nimport {R2QuadraticCurveParser} from \"./R2QuadraticCurveParser\";\nimport {R2CubicCurve} from \"./R2CubicCurve\";\nimport {R2CubicCurveParser} from \"./R2CubicCurveParser\";\nimport {R2EllipticCurveParser} from \"./R2EllipticCurveParser\";\nimport {R2Spline} from \"./R2Spline\";\n\n/** @internal */\nexport class R2SplineParser extends Parser<R2Spline> {\n  private readonly xParser: Parser<number> | undefined;\n  private readonly yParser: Parser<number> | undefined;\n  private readonly x0Parser: Parser<number> | undefined;\n  private readonly y0Parser: Parser<number> | undefined;\n  private readonly curveParser: Parser<R2Curve> | undefined;\n  private readonly curves: R2Curve[] | undefined;\n  private readonly command: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(xParser?: Parser<number>, yParser?: Parser<number>,\n              x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n              curveParser?: Parser<R2Curve>, curves?: R2Curve[],\n              command?: number, step?: number) {\n    super();\n    this.xParser = xParser;\n    this.yParser = yParser;\n    this.x0Parser = x0Parser;\n    this.y0Parser = y0Parser;\n    this.curveParser = curveParser;\n    this.curves = curves;\n    this.command = command;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2Spline> {\n    return R2SplineParser.parse(input, this.xParser, this.yParser,\n                                this.x0Parser, this.y0Parser,\n                                this.curveParser, this.curves,\n                                this.command, this.step);\n  }\n\n  static parse(input: Input, xParser?: Parser<number>, yParser?: Parser<number>,\n               x0Parser?: Parser<number>, y0Parser?: Parser<number>,\n               curveParser?: Parser<R2Curve>, curves?: R2Curve[],\n               command?: number, step: number = 1): Parser<R2Spline> {\n    let c = 0;\n    if (step === 1) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 77/*'M'*/ || c === 109/*'m'*/) {\n          input = input.step();\n          command = c;\n          step = 2;\n        } else {\n          return Parser.error(Diagnostic.expected(\"moveto\", input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 2) {\n      if (x0Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          x0Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        x0Parser = x0Parser.feed(input);\n      }\n      if (x0Parser !== void 0) {\n        if (x0Parser.isDone()) {\n          if (command === 109/*'m'*/ && xParser !== void 0) {\n            x0Parser = Parser.done(xParser.bind() + x0Parser.bind());\n          }\n          xParser = x0Parser;\n          step = 3;\n        } else if (x0Parser.isError()) {\n          return x0Parser.asError();\n        }\n      }\n    }\n    if (step === 3) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont()) {\n        if (c === 44/*','*/) {\n          input = input.step();\n        }\n        step = 4;\n      } else if (!input.isEmpty()) {\n        step = 4;\n      }\n    }\n    if (step === 4) {\n      if (y0Parser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input = input.step();\n        }\n        if (!input.isEmpty()) {\n          y0Parser = Base10.parseDecimal(input);\n        }\n      } else {\n        y0Parser = y0Parser.feed(input);\n      }\n      if (y0Parser !== void 0) {\n        if (y0Parser.isDone()) {\n          if (command === 109/*'m'*/ && yParser !== void 0) {\n            y0Parser = Parser.done(yParser.bind() + y0Parser.bind());\n          }\n          yParser = y0Parser;\n          step = 5;\n        } else if (y0Parser.isError()) {\n          return y0Parser.asError();\n        }\n      }\n    }\n    do {\n      if (step === 5) {\n        if (curveParser === void 0) {\n          while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n            input = input.step();\n          }\n          if (input.isCont()) {\n            const prevCurve = curves !== void 0 && curves.length !== 0 ? curves[curves.length - 1] : null;\n            switch (c) {\n              case 76/*'L'*/:\n              case 108/*'l'*/:\n              case 72/*'H'*/:\n              case 104/*'h'*/:\n              case 86/*'V'*/:\n              case 118/*'v'*/:\n                curveParser = R2SegmentParser.parse(input, xParser, yParser);\n                command = c;\n                break;\n              case 81/*'Q'*/:\n              case 113/*'q'*/:\n                curveParser = R2QuadraticCurveParser.parse(input, xParser, yParser);\n                command = c;\n                break;\n              case 84/*'T'*/:\n                if (prevCurve instanceof R2QuadraticCurve) {\n                  const dx = prevCurve.x2 - prevCurve.x1;\n                  const dy = prevCurve.y2 - prevCurve.y1;\n                  const x1 = xParser!.bind() + dx;\n                  const y1 = yParser!.bind() + dy;\n                  curveParser = R2QuadraticCurveParser.parse(input, xParser, yParser,\n                                                             Parser.done(x1), Parser.done(y1));\n                } else {\n                  curveParser = R2QuadraticCurveParser.parse(input, xParser, yParser,\n                                                             xParser, yParser);\n                }\n                command = c;\n                break;\n              case 116/*'t'*/:\n                if (prevCurve instanceof R2QuadraticCurve) {\n                  const dx = prevCurve.x2 - prevCurve.x1;\n                  const dy = prevCurve.y2 - prevCurve.y1;\n                  curveParser = R2QuadraticCurveParser.parse(input, xParser, yParser,\n                                                             Parser.done(dx), Parser.done(dy));\n                } else {\n                  curveParser = R2QuadraticCurveParser.parse(input, xParser, yParser,\n                                                             Parser.done(0), Parser.done(0));\n                }\n                command = c;\n                break;\n              case 67/*'C'*/:\n              case 99/*'c'*/:\n                curveParser = R2CubicCurveParser.parse(input, xParser, yParser);\n                command = c;\n                break;\n              case 83/*'S'*/:\n                if (prevCurve instanceof R2CubicCurve) {\n                  const dx = prevCurve.x3 - prevCurve.x2;\n                  const dy = prevCurve.y3 - prevCurve.y2;\n                  const x1 = xParser!.bind() + dx;\n                  const y1 = yParser!.bind() + dy;\n                  curveParser = R2CubicCurveParser.parse(input, xParser, yParser,\n                                                         Parser.done(x1), Parser.done(y1));\n                } else {\n                  curveParser = R2CubicCurveParser.parse(input, xParser, yParser,\n                                                         xParser, yParser);\n                }\n                command = c;\n                break;\n              case 115/*'s'*/:\n                if (prevCurve instanceof R2CubicCurve) {\n                  const dx = prevCurve.x3 - prevCurve.x2;\n                  const dy = prevCurve.y3 - prevCurve.y2;\n                  curveParser = R2CubicCurveParser.parse(input, xParser, yParser,\n                                                         Parser.done(dx), Parser.done(dy));\n                } else {\n                  curveParser = R2CubicCurveParser.parse(input, xParser, yParser,\n                                                         Parser.done(0), Parser.done(0));\n                }\n                command = c;\n                break;\n              case 65/*'A'*/:\n              case 97/*'a'*/:\n                curveParser = R2EllipticCurveParser.parse(input, xParser, yParser);\n                command = c;\n                break;\n              case 90/*'Z'*/:\n              case 122/*'z'*/:\n                input = input.step();\n                if (curves === void 0) {\n                  curves = [];\n                }\n                curves.push(new R2Segment(xParser!.bind(), yParser!.bind(),\n                                          x0Parser!.bind(), y0Parser!.bind()));\n                return Parser.done(new R2Spline(curves, true));\n              case 44/*','*/:\n                input = input.step();\n              case 43/*'+'*/:\n              case 45/*'-'*/:\n              case 46/*'.'*/:\n              case 48/*'0'*/:\n              case 49/*'1'*/:\n              case 50/*'2'*/:\n              case 51/*'3'*/:\n              case 52/*'4'*/:\n              case 53/*'5'*/:\n              case 54/*'6'*/:\n              case 55/*'7'*/:\n              case 56/*'8'*/:\n              case 57/*'9'*/:\n                switch (command) {\n                  case 77/*'M'*/:\n                  case 109/*'m'*/:\n                  case 76/*'L'*/:\n                  case 108/*'l'*/:\n                  case 72/*'H'*/:\n                  case 104/*'h'*/:\n                  case 86/*'V'*/:\n                  case 118/*'v'*/:\n                    curveParser = R2SegmentParser.parseRest(input, command, xParser, yParser);\n                    break;\n                  case 81/*'Q'*/:\n                  case 113/*'q'*/:\n                    curveParser = R2QuadraticCurveParser.parseRest(input, command, xParser, yParser);\n                    break;\n                  case 84/*'T'*/:\n                    if (prevCurve instanceof R2QuadraticCurve) {\n                      const dx = prevCurve.x2 - prevCurve.x1;\n                      const dy = prevCurve.y2 - prevCurve.y1;\n                      const x1 = xParser!.bind() + dx;\n                      const y1 = yParser!.bind() + dy;\n                      curveParser = R2QuadraticCurveParser.parseRest(input, command, xParser, yParser,\n                                                                     Parser.done(x1), Parser.done(y1));\n                    } else {\n                      curveParser = R2QuadraticCurveParser.parseRest(input, command, xParser, yParser,\n                                                                     xParser, yParser);\n                    }\n                    break;\n                  case 116/*'t'*/:\n                    if (prevCurve instanceof R2QuadraticCurve) {\n                      const dx = prevCurve.x2 - prevCurve.x1;\n                      const dy = prevCurve.y2 - prevCurve.y1;\n                      curveParser = R2QuadraticCurveParser.parseRest(input, command, xParser, yParser,\n                                                                     Parser.done(dx), Parser.done(dy));\n                    } else {\n                      curveParser = R2QuadraticCurveParser.parseRest(input, command, xParser, yParser,\n                                                                     Parser.done(0), Parser.done(0));\n                    }\n                    break;\n                  case 67/*'C'*/:\n                  case 99/*'c'*/:\n                    curveParser = R2CubicCurveParser.parseRest(input, command, xParser, yParser);\n                    break;\n                  case 83/*'S'*/:\n                    if (prevCurve instanceof R2CubicCurve) {\n                      const dx = prevCurve.x3 - prevCurve.x2;\n                      const dy = prevCurve.y3 - prevCurve.y2;\n                      const x1 = xParser!.bind() + dx;\n                      const y1 = yParser!.bind() + dy;\n                      curveParser = R2CubicCurveParser.parseRest(input, command, xParser, yParser,\n                                                                 Parser.done(x1), Parser.done(y1));\n                    } else {\n                      curveParser = R2CubicCurveParser.parseRest(input, command, xParser, yParser,\n                                                                 xParser, yParser);\n                    }\n                    break;\n                  case 115/*'s'*/:\n                    if (prevCurve instanceof R2CubicCurve) {\n                      const dx = prevCurve.x3 - prevCurve.x2;\n                      const dy = prevCurve.y3 - prevCurve.y2;\n                      curveParser = R2CubicCurveParser.parseRest(input, command, xParser, yParser,\n                                                                 Parser.done(dx), Parser.done(dy));\n                    } else {\n                      curveParser = R2CubicCurveParser.parseRest(input, command, xParser, yParser,\n                                                                 Parser.done(0), Parser.done(0));\n                    }\n                    break;\n                  case 65/*'A'*/:\n                  case 97/*'a'*/:\n                    curveParser = R2EllipticCurveParser.parseRest(input, command, xParser, yParser);\n                    break;\n                  default:\n                    if (curves !== void 0) {\n                      return Parser.done(new R2Spline(curves, false));\n                    } else {\n                      return Parser.done(R2Spline.empty());\n                    }\n                }\n                break;\n              default:\n                if (curves !== void 0) {\n                  return Parser.done(new R2Spline(curves, false));\n                } else {\n                  return Parser.done(R2Spline.empty());\n                }\n            }\n          } else if (!input.isEmpty()) {\n            if (curves !== void 0) {\n              return Parser.done(new R2Spline(curves, false));\n            } else {\n              return Parser.done(R2Spline.empty());\n            }\n          }\n        } else {\n          curveParser = curveParser.feed(input);\n        }\n        if (curveParser !== void 0) {\n          if (curveParser.isDone()) {\n            const curve = curveParser.bind();\n            curveParser = void 0;\n            if (curves === void 0) {\n              curves = [];\n            }\n            curves.push(curve);\n            xParser = Parser.done(curve.interpolateX(1));\n            yParser = Parser.done(curve.interpolateY(1));\n            continue;\n          } else if (curveParser.isError()) {\n            return curveParser.asError();\n          }\n        }\n      }\n      break;\n    } while (true);\n    return new R2SplineParser(xParser, yParser, x0Parser, y0Parser,\n                              curveParser, curves, command, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equals, Equivalent, Mutable, Arrays} from \"@swim/util\";\nimport {\n  Debug,\n  Format,\n  AnyOutputSettings,\n  OutputSettings,\n  Output,\n  Parser,\n  Diagnostic,\n  Unicode,\n} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {AnyR2Shape, R2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport type {R2Curve} from \"./R2Curve\";\nimport {R2Spline} from \"./R2Spline\";\nimport type {R2PathContext} from \"./R2PathContext\";\nimport {R2PathBuilder} from \"../\"; // forward import\nimport {R2PathParser} from \"../\"; // forward import\nimport {R2Box} from \"../\"; // forward import\n\n/** @public */\nexport type AnyR2Path = R2Path | string;\n\n/** @public */\nexport class R2Path extends R2Shape implements Equals, Equivalent, Debug {\n  constructor(splines: ReadonlyArray<R2Spline>) {\n    super();\n    this.splines = splines;\n    this.boundingBox = null;\n    this.pathString = void 0;\n  }\n\n  readonly splines: ReadonlyArray<R2Spline>;\n\n  isDefined(): boolean {\n    return this.splines.length !== 0;\n  }\n\n  override get xMin(): number {\n    return this.bounds.xMin;\n  }\n\n  override get yMin(): number {\n    return this.bounds.yMin;\n  }\n\n  override get xMax(): number {\n    return this.bounds.xMax;\n  }\n\n  override get yMax(): number {\n    return this.bounds.yMax;\n  }\n\n  interpolateX(u: number): number {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return splines[k]!.interpolateX(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  interpolateY(u: number): number {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return splines[k]!.interpolateY(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  interpolate(u: number): R2Point {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return splines[k]!.interpolate(v);\n    } else {\n      return new R2Point(NaN, NaN);\n    }\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    return false; // TODO\n  }\n\n  split(u: number): [R2Path, R2Path] {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      const [s0, s1] = splines[k]!.split(v);\n      const splines0 = new Array<R2Spline>(k + 1);\n      const splines1 = new Array<R2Spline>(n - k);\n      for (let i = 0; i < k; i += 1) {\n        splines0[i] = splines[i]!;\n      }\n      splines0[k] = s0;\n      splines1[0] = s1;\n      for (let i = k + 1; i < n; i += 1) {\n        splines1[i - k] = splines[i]!;\n      }\n      return [new R2Path(splines0), new R2Path(splines1)];\n    } else {\n      return [R2Path.empty(), R2Path.empty()];\n    }\n  }\n\n  subdivide(u: number): R2Path {\n    const oldSplines = this.splines;\n    const n = oldSplines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      const newSplines = new Array<R2Spline>(n);\n      for (let i = 0; i < k; i += 1) {\n        newSplines[i] = oldSplines[i]!;\n      }\n      newSplines[k] = oldSplines[k]!.subdivide(v);\n      for (let i = k + 1; i < n; i += 1) {\n        newSplines[i] = oldSplines[i]!;\n      }\n      return new R2Path(newSplines);\n    } else {\n      return R2Path.empty();\n    }\n  }\n\n  override transform(f: R2Function): R2Path {\n    const oldSplines = this.splines;\n    const n = oldSplines.length;\n    if (n > 0) {\n      const newSplines = new Array<R2Spline>(n);\n      for (let i = 0; i < n; i += 1) {\n        newSplines[i] = oldSplines[i]!.transform(f);\n      }\n      return new R2Path(newSplines);\n    } else {\n      return R2Path.empty();\n    }\n  }\n\n  /** @internal */\n  readonly boundingBox: R2Box | null;\n\n  override get bounds(): R2Box {\n    let boundingBox = this.boundingBox;\n    if (boundingBox === null) {\n      let xMin = Infinity;\n      let yMin = Infinity;\n      let xMax = -Infinity;\n      let yMax = -Infinity;\n      const splines = this.splines;\n      for (let i = 0, n = splines.length; i < n; i += 1) {\n        const spline = splines[i]!;\n        xMin = Math.min(xMin, spline.xMin);\n        yMin = Math.min(yMin, spline.yMin);\n        xMax = Math.max(spline.xMax, xMax);\n        yMax = Math.max(spline.yMax, yMax);\n      }\n      boundingBox = new R2Box(xMin, yMin, xMax, yMax);\n      (this as Mutable<this>).boundingBox = boundingBox;\n    }\n    return boundingBox;\n  }\n\n  draw(context: R2PathContext): void {\n    const splines = this.splines;\n    for (let i = 0, n = splines.length; i < n; i += 1) {\n      splines[i]!.draw(context);\n    }\n  }\n\n  transformDraw(context: R2PathContext, f: R2Function): void {\n    const splines = this.splines;\n    for (let i = 0, n = splines.length; i < n; i += 1) {\n      splines[i]!.transformDraw(context, f);\n    }\n  }\n\n  writePath<T>(output: Output<T>): Output<T> {\n    const splines = this.splines;\n    const n = splines.length;\n    if (output.settings === OutputSettings.standard()) {\n      for (let i = 0; i < n; i += 1) {\n        output = output.write(splines[i]!.toPathString()); // write memoized subpath strings\n      }\n    } else {\n      for (let i = 0; i < n; i += 1) {\n        output = splines[i]!.writePath(output);\n      }\n    }\n    return output;\n  }\n\n  /** @internal */\n  readonly pathString: string | undefined;\n\n  toPathString(outputSettings?: AnyOutputSettings): string {\n    let pathString: string | undefined;\n    if (outputSettings !== void 0 || (pathString = this.pathString, pathString === void 0)) {\n      const output = Unicode.stringOutput(outputSettings);\n      this.writePath(output);\n      pathString = output.bind();\n      if (outputSettings === void 0) {\n        (this as Mutable<this>).pathString = pathString;\n      }\n    }\n    return pathString;\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Path) {\n      return Arrays.equivalent(this.splines, that.splines, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Path) {\n      return Arrays.equal(this.splines, that.splines);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    const splines = this.splines;\n    const n = splines.length;\n    output = output.write(\"R2Path\").write(46/*'.'*/);\n    if (n === 0) {\n      output = output.write(\"empty\").write(40/*'('*/);\n    } else if (n === 1) {\n      const spline = splines[0]!;\n      output = output.write(spline.closed ? \"closed\" : \"open\").write(40/*'('*/);\n      const curves = spline.curves;\n      const m = curves.length;\n      if (m !== 0) {\n        output = output.debug(curves[0]!);\n        for (let i = 1; i < m; i += 1) {\n          output = output.write(\", \").debug(curves[i]!);\n        }\n      }\n    } else {\n      output = output.write(\"of\").write(40/*'('*/);\n      output = output.debug(splines[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(splines[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  toAttributeString(): string {\n    return this.toPathString();\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static empty(): R2Path {\n    return new R2Path([]);\n  }\n\n  static of(...splines: R2Spline[]): R2Path {\n    return new R2Path(splines);\n  }\n\n  static open(...curves: R2Curve[]): R2Path {\n    return new R2Path([new R2Spline(curves, false)]);\n  }\n\n  static closed(...curves: R2Curve[]): R2Path {\n    return new R2Path([new R2Spline(curves, true)]);\n  }\n\n  static override fromAny(value: AnyR2Path | AnyR2Shape): R2Path {\n    if (value === void 0 || value === null || value instanceof R2Path) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return R2Path.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static builder(): R2PathBuilder {\n    return new R2PathBuilder();\n  }\n\n  static parse(string: string): R2Path {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = R2PathParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {R2Spline} from \"./R2Spline\";\nimport {R2SplineBuilder} from \"./R2SplineBuilder\";\nimport type {R2PathContext} from \"./R2PathContext\";\nimport {R2Path} from \"./R2Path\";\n\n/** @public */\nexport class R2PathBuilder implements R2PathContext {\n  /** @internal */\n  splines: R2Spline[];\n  /** @internal */\n  builder: R2SplineBuilder | null;\n\n  constructor() {\n    this.splines = [];\n    this.builder = null;\n  }\n\n  moveTo(x: number, y: number): void {\n    let builder = this.builder;\n    if (builder !== null) {\n      const spline = builder.bind();\n      if (spline.isDefined()) {\n        this.splines.push(spline);\n      }\n    }\n    builder = new R2SplineBuilder();\n    this.builder = builder;\n    builder.moveTo(x, y);\n  }\n\n  closePath(): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.closePath();\n    } else {\n      throw new Error();\n    }\n  }\n\n  lineTo(x: number, y: number): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.lineTo(x, y);\n    } else {\n      throw new Error();\n    }\n  }\n\n  quadraticCurveTo(x1: number, y1: number, x: number, y: number): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.quadraticCurveTo(x1, y1, x, y);\n    } else {\n      throw new Error();\n    }\n  }\n\n  bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x: number, y: number): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.bezierCurveTo(x1, y1, x2, y2, x, y);\n    } else {\n      throw new Error();\n    }\n  }\n\n  arcTo(x1: number, y1: number, x2: number, y2: number, r: number): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.arcTo(x1, y1, x2, y2, r);\n    } else {\n      throw new Error();\n    }\n  }\n\n  arc(cx: number, cy: number, r: number, a0: number, a1: number, ccw?: boolean): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.arc(cx, cy, r, a0, a1, ccw);\n    } else {\n      throw new Error();\n    }\n  }\n\n  ellipse(cx: number, cy: number, rx: number, ry: number, phi: number, a0: number, a1: number, ccw?: boolean): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.ellipse(cx, cy, rx, ry, phi, a0, a1, ccw);\n    } else {\n      throw new Error();\n    }\n  }\n\n  rect(x: number, y: number, w: number, h: number): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.rect(x, y, w, h);\n    } else {\n      throw new Error();\n    }\n  }\n\n  bind(): R2Path {\n    const splines = this.splines.slice(0);\n    const builder = this.builder;\n    if (builder !== null) {\n      const spline = builder.bind();\n      if (spline.isDefined()) {\n        splines.push(spline);\n      }\n    }\n    return new R2Path(splines);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport type {R2Spline} from \"./R2Spline\";\nimport {R2SplineParser} from \"./R2SplineParser\";\nimport {R2Path} from \"./R2Path\";\n\n/** @internal */\nexport class R2PathParser extends Parser<R2Path> {\n  private readonly splineParser: Parser<R2Spline> | undefined;\n  private readonly splines: R2Spline[] | undefined;\n  private readonly step: number | undefined;\n\n  constructor(splineParser?: Parser<R2Spline>, splines?: R2Spline[], step?: number) {\n    super();\n    this.splineParser = splineParser;\n    this.splines = splines;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<R2Path> {\n    return R2PathParser.parse(input, this.splineParser, this.splines, this.step);\n  }\n\n  static parse(input: Input, splineParser?: Parser<R2Spline>,\n               splines?: R2Spline[], step: number = 1): Parser<R2Path> {\n    let c = 0;\n    do {\n      if (step === 1) {\n        if (splineParser === void 0) {\n          while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n            input = input.step();\n          }\n          if (input.isCont()) {\n            switch (c) {\n              case 77/*'M'*/:\n                splineParser = R2SplineParser.parse(input);\n                break;\n              case 109/*'m'*/: {\n                let xParser: Parser<number> | undefined;\n                let yParser: Parser<number> | undefined;\n                if (splines !== void 0 && splines.length !== 0) {\n                  const spline = splines[splines.length - 1]!;\n                  xParser = Parser.done(spline.interpolateX(1));\n                  yParser = Parser.done(spline.interpolateY(1));\n                }\n                splineParser = R2SplineParser.parse(input, xParser, yParser);\n                break;\n              }\n              case 110/*'n'*/:\n                step = 2;\n                break;\n              default:\n                if (splines !== void 0) {\n                  return Parser.done(new R2Path(splines));\n                } else {\n                  return Parser.done(R2Path.empty());\n                }\n            }\n          } else if (!input.isEmpty()) {\n            if (splines !== void 0) {\n              return Parser.done(new R2Path(splines));\n            } else {\n              return Parser.done(R2Path.empty());\n            }\n          }\n        } else {\n          splineParser = splineParser.feed(input);\n        }\n        if (splineParser !== void 0) {\n          if (splineParser.isDone()) {\n            const spline = splineParser.bind();\n            splineParser = void 0;\n            if (spline.isDefined()) {\n              if (splines === void 0) {\n                splines = [];\n              }\n              splines.push(spline);\n            }\n            continue;\n          } else if (splineParser.isError()) {\n            return splineParser.asError();\n          }\n        }\n      }\n      break;\n    } while (true);\n    if (step >= 2 && step <= 5) {\n      do {\n        if (input.isCont()) {\n          if (input.head() === \"none\".charCodeAt(step - 2)) {\n            input = input.step();\n            if (step < 5) {\n              step += 1;\n              continue;\n            } else {\n              return Parser.done(R2Path.empty());\n            }\n          } else {\n            return Parser.error(Diagnostic.expected(\"none\", input));\n          }\n        } else if (!input.isEmpty()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n        break;\n      } while (true);\n    }\n    return new R2PathParser(splineParser, splines, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Equivalent,\n  HashCode,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {AnyR2Shape, R2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport {R2Segment} from \"./R2Segment\";\nimport {R2Box} from \"./R2Box\";\nimport {R2CircleInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport type AnyR2Circle = R2Circle | R2CircleInit;\n\n/** @public */\nexport interface R2CircleInit {\n  cx: number;\n  cy: number;\n  r: number;\n}\n\n/** @public */\nexport class R2Circle extends R2Shape implements Interpolate<R2Circle>, HashCode, Equivalent, Debug {\n  constructor(cx: number, cy: number, r: number) {\n    super();\n    this.cx = cx;\n    this.cy = cy;\n    this.r = r;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.cx) && isFinite(this.cy) && isFinite(this.r);\n  }\n\n  readonly cx: number;\n\n  readonly cy: number;\n\n  readonly r: number;\n\n  override get xMin(): number {\n    return this.cx - this.r;\n  }\n\n  override get yMin(): number {\n    return this.cy - this.r;\n  }\n\n  override get xMax(): number {\n    return this.cx + this.r;\n  }\n\n  override get yMax(): number {\n    return this.cy + this.r;\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    if (typeof that === \"number\") {\n      const dx = that - this.cx;\n      const dy = y! - this.cy;\n      return dx * dx + dy * dy <= this.r * this.r;\n    } else {\n      that = R2Shape.fromAny(that);\n      if (that instanceof R2Point) {\n        return this.containsPoint(that);\n      } else if (that instanceof R2Segment) {\n        return this.containsSegment(that);\n      } else if (that instanceof R2Box) {\n        return this.containsBox(that);\n      } else if (that instanceof R2Circle) {\n        return this.containsCircle(that);\n      }\n      return false;\n    }\n  }\n\n  /** @internal */\n  containsPoint(that: R2Point): boolean {\n    const dx = that.x - this.cx;\n    const dy = that.y - this.cy;\n    return dx * dx + dy * dy <= this.r * this.r;\n  }\n\n  /** @internal */\n  containsSegment(that: R2Segment): boolean {\n    const dx0 = that.x0 - this.cx;\n    const dy0 = that.y0 - this.cy;\n    const dx1 = that.x1 - this.cx;\n    const dy1 = that.y1 - this.cy;\n    const r2 = this.r * this.r;\n    return dx0 * dx0 + dy0 * dy0 <= r2\n        && dx1 * dx1 + dy1 * dy1 <= r2;\n  }\n\n  /** @internal */\n  containsBox(that: R2Box): boolean {\n    const dxMin = that.xMin - this.cx;\n    const dyMin = that.yMin - this.cy;\n    const dxMax = that.xMax - this.cx;\n    const dyMax = that.yMax - this.cy;\n    const r2 = this.r * this.r;\n    return dxMin * dxMin + dyMin * dyMin <= r2\n        && dxMin * dxMin + dyMax * dyMax <= r2\n        && dxMax * dxMax + dyMin * dyMin <= r2\n        && dxMax * dxMax + dyMax * dyMax <= r2;\n  }\n\n  /** @internal */\n  containsCircle(that: R2Circle): boolean {\n    const dx = that.cx - this.cx;\n    const dy = that.cy - this.cy;\n    return dx * dx + dy * dy + that.r * that.r <= this.r * this.r;\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    that = R2Shape.fromAny(that);\n    if (that instanceof R2Point) {\n      return this.intersectsPoint(that);\n    } else if (that instanceof R2Segment) {\n      return this.intersectsSegment(that);\n    } else if (that instanceof R2Box) {\n      return this.intersectsBox(that);\n    } else if (that instanceof R2Circle) {\n      return this.intersectsCircle(that);\n    } else {\n      return (that as R2Shape).intersects(this);\n    }\n    return false;\n  }\n\n  /** @internal */\n  intersectsPoint(that: R2Point): boolean {\n    const dx = that.x - this.cx;\n    const dy = that.y - this.cy;\n    return dx * dx + dy * dy <= this.r * this.r;\n  }\n\n  /** @internal */\n  intersectsSegment(that: R2Segment): boolean {\n    const cx = this.cx;\n    const cy = this.cy;\n    const r = this.r;\n    const x0 = that.x0;\n    const y0 = that.y0;\n    const x1 = that.x1;\n    const y1 = that.y1;\n    const dx = x1 - x0;\n    const dy = y1 - y0;\n    const l = Math.sqrt(dx * dx + dy * dy);\n    const unitX = dx / l;\n    const unitY = dy / l;\n    const d = (cx - x0) * unitY - (cy - y0) * unitX;\n    if (d < -r || r < d) {\n      return false;\n    } else {\n      const dcx0 = x0 - cx;\n      const dcy0 = y0 - cy;\n      const dcx1 = x1 - cx;\n      const dcy1 = y1 - cy;\n      const r2 = r * r;\n      if (dcx0 * dcx0 + dcy0 * dcy0 <= r2 || dcx1 * dcx1 + dcy1 * dcy1 <= r2) {\n        return true;\n      } else {\n        const uc = unitX * cx + unitY * cy;\n        const u0 = unitX * x0 + unitY * y0;\n        const u1 = unitX * x1 + unitY * y1;\n        return u0 < uc && uc <= u1 || u1 < uc && uc <= u0;\n      }\n    }\n  }\n\n  /** @internal */\n  intersectsBox(that: R2Box): boolean {\n    const dx = (this.cx < that.xMin ? that.xMin : that.xMax < this.cx ? that.xMax : this.cx) - this.cx;\n    const dy = (this.cy < that.yMin ? that.yMin : that.yMax < this.cy ? that.yMax : this.cy) - this.cy;\n    return dx * dx + dy * dy <= this.r * this.r;\n  }\n\n  /** @internal */\n  intersectsCircle(that: R2Circle): boolean {\n    const dx = that.cx - this.cx;\n    const dy = that.cy - this.cy;\n    const rr = this.r + that.r;\n    return dx * dx + dy * dy <= rr * rr;\n  }\n\n  override transform(f: R2Function): R2Circle {\n    const cx = f.transformX(this.cx, this.cy);\n    const cy = f.transformY(this.cx, this.cy);\n    const rx = f.transformX(this.cx + this.r, this.cy);\n    const ry = f.transformY(this.cx + this.r, this.cy);\n    const dx = rx - cx;\n    const dy = ry - cy;\n    const r = Math.sqrt(dx * dx + dy * dy);\n    return new R2Circle(cx, cy, r);\n  }\n\n  toAny(): R2CircleInit {\n    return {\n      cx: this.cx,\n      cy: this.cy,\n      r: this.r,\n    };\n  }\n\n  interpolateTo(that: R2Circle): Interpolator<R2Circle>;\n  interpolateTo(that: unknown): Interpolator<R2Circle> | null;\n  interpolateTo(that: unknown): Interpolator<R2Circle> | null {\n    if (that instanceof R2Circle) {\n      return R2CircleInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Circle) {\n      return Numbers.equivalent(this.cx, that.cx, epsilon)\n          && Numbers.equivalent(this.cy, that.cy, epsilon)\n          && Numbers.equivalent(this.r, that.r, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Circle) {\n      return this.cx === that.cx && this.cy === that.cy && this.r === that.r;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Constructors.hash(R2Circle),\n        Numbers.hash(this.cx)), Numbers.hash(this.cy)), Numbers.hash(this.r)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Circle\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.cx).write(\", \").debug(this.cy).write(\", \")\n                   .debug(this.r).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static of(cx: number, cy: number, r: number): R2Circle {\n    return new R2Circle(cx, cy, r);\n  }\n\n  static fromInit(value: R2CircleInit): R2Circle {\n    return new R2Circle(value.cx, value.cy, value.r);\n  }\n\n  static override fromAny(value: AnyR2Circle): R2Circle {\n    if (value === void 0 || value === null || value instanceof R2Circle) {\n      return value;\n    } else if (R2Circle.isInit(value)) {\n      return R2Circle.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is R2CircleInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as R2CircleInit;\n      return typeof init.cx === \"number\"\n          && typeof init.cy === \"number\"\n          && typeof init.r === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyR2Circle {\n    return value instanceof R2Circle\n        || R2Circle.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Lazy,\n  Equivalent,\n  HashCode,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {AnyR2Shape, R2Shape} from \"./R2Shape\";\nimport {R2Point} from \"./R2Point\";\nimport {R2Segment} from \"./R2Segment\";\nimport {R2BoxInterpolator} from \"../\"; // forward import\nimport {R2Circle} from \"./R2Circle\";\n\n/** @public */\nexport type AnyR2Box = R2Box | R2BoxInit;\n\n/** @public */\nexport interface R2BoxInit {\n  xMin: number;\n  yMin: number;\n  xMax: number;\n  yMax: number;\n}\n\n/** @public */\nexport class R2Box extends R2Shape implements Interpolate<R2Box>, HashCode, Equivalent, Debug {\n  constructor(xMin: number, yMin: number, xMax: number, yMax: number) {\n    super();\n    this.xMin = xMin;\n    this.yMin = yMin;\n    this.xMax = xMax;\n    this.yMax = yMax;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.xMin) && isFinite(this.yMin)\n        && isFinite(this.xMax) && isFinite(this.yMax);\n  }\n\n  override readonly xMin: number;\n\n  override readonly yMin: number;\n\n  override readonly xMax: number;\n\n  override readonly yMax: number;\n\n  get x(): number {\n    return this.xMin;\n  }\n\n  get y(): number {\n    return this.yMin;\n  }\n\n  get width(): number {\n    return this.xMax - this.xMin;\n  }\n\n  get height(): number {\n    return this.yMax - this.yMin;\n  }\n\n  get top(): number {\n    return this.yMin;\n  }\n\n  get right(): number {\n    return this.xMax;\n  }\n\n  get bottom(): number {\n    return this.yMax;\n  }\n\n  get left(): number {\n    return this.xMin;\n  }\n\n  get center(): R2Point {\n    return new R2Point((this.xMin + this.xMax) / 2, (this.yMin + this.yMax) / 2);\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    if (typeof that === \"number\") {\n      return this.xMin <= that && that <= this.xMax\n          && this.yMin <= y! && y! <= this.yMax;\n    } else {\n      that = R2Shape.fromAny(that);\n      if (that instanceof R2Shape) {\n        if (that instanceof R2Point) {\n          return this.containsPoint(that);\n        } else if (that instanceof R2Segment) {\n          return this.containsSegment(that);\n        } else if (that instanceof R2Box) {\n          return this.containsBox(that);\n        } else if (that instanceof R2Circle) {\n          return this.containsCircle(that);\n        } else {\n          return this.xMin <= that.xMin && that.xMax <= this.xMax\n              && this.yMin <= that.yMin && that.yMax <= this.yMax;\n        }\n      }\n      return false;\n    }\n  }\n\n  /** @internal */\n  containsPoint(that: R2Point): boolean {\n    return this.xMin <= that.x && that.x <= this.xMax\n        && this.yMin <= that.y && that.y <= this.yMax;\n  }\n\n  /** @internal */\n  containsSegment(that: R2Segment): boolean {\n    return this.xMin <= that.x0 && that.x0 <= this.xMax\n        && this.yMin <= that.y0 && that.y0 <= this.yMax\n        && this.xMin <= that.x1 && that.x1 <= this.xMax\n        && this.yMin <= that.y1 && that.y1 <= this.yMax;\n  }\n\n  /** @internal */\n  containsBox(that: R2Box): boolean {\n    return this.xMin <= that.xMin && that.xMax <= this.xMax\n        && this.yMin <= that.yMin && that.yMax <= this.yMax;\n  }\n\n  /** @internal */\n  containsCircle(that: R2Circle): boolean {\n    return this.xMin <= that.cx - that.r && that.cx + that.r <= this.xMax\n        && this.yMin <= that.cy - that.r && that.cy + that.r <= this.yMax;\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    that = R2Shape.fromAny(that);\n    if (that instanceof R2Point) {\n      return this.intersectsPoint(that);\n    } else if (that instanceof R2Segment) {\n      return this.intersectsSegment(that);\n    } else if (that instanceof R2Box) {\n      return this.intersectsBox(that);\n    } else if (that instanceof R2Circle) {\n      return this.intersectsCircle(that);\n    } else {\n      return (that as R2Shape).intersects(this);\n    }\n    return false;\n  }\n\n  /** @internal */\n  intersectsPoint(that: R2Point): boolean {\n    return this.xMin <= that.x && that.x <= this.xMax\n        && this.yMin <= that.y && that.y <= this.yMax;\n  }\n\n  /** @internal */\n  intersectsSegment(that: R2Segment): boolean {\n    const xMin = this.xMin;\n    const yMin = this.yMin;\n    const xMax = this.xMax;\n    const yMax = this.yMax;\n    const x0 = that.x0;\n    const y0 = that.y0;\n    const x1 = that.x1;\n    const y1 = that.y1;\n    if (x0 < xMin && x1 < xMin || x0 > xMax && x1 > xMax ||\n        y0 < yMin && y1 < yMin || y0 > yMax && y1 > yMax) {\n      return false;\n    } else if (x0 > xMin && x0 < xMax && y0 > yMin && y0 < yMax) {\n      return true;\n    } else if ((R2Box.intersectsSegment(x0 - xMin, x1 - xMin, x0, y0, x1, y1) && R2Box.hitY > yMin && R2Box.hitY < yMax)\n            || (R2Box.intersectsSegment(y0 - yMin, y1 - yMin, x0, y0, x1, y1) && R2Box.hitX > xMin && R2Box.hitX < xMax)\n            || (R2Box.intersectsSegment(x0 - xMax, x1 - xMax, x0, y0, x1, y1) && R2Box.hitY > yMin && R2Box.hitY < yMax)\n            || (R2Box.intersectsSegment(y0 - yMax, y1 - yMax, x0, y0, x1, y1) && R2Box.hitX > xMin && R2Box.hitX < xMax)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @internal */\n  static hitX: number = 0; // stack local hit register\n  /** @internal */\n  static hitY: number = 0; // stack local hit register\n  static intersectsSegment(d0: number, d1: number, x0: number, y0: number, x1: number, y1: number): boolean {\n    if (d0 !== d1 || d0 * d1 < 0) {\n      const scale = -d0 / (d1 - d0);\n      R2Box.hitX = x0 + (x1 - x0) * scale;\n      R2Box.hitY = y0 + (y1 - y0) * scale;\n      return true;\n    }\n    return false;\n  }\n\n  /** @internal */\n  intersectsBox(that: R2Box): boolean {\n    return this.xMin <= that.xMax && that.xMin <= this.xMax\n        && this.yMin <= that.yMax && that.yMin <= this.yMax;\n  }\n\n  /** @internal */\n  intersectsCircle(that: R2Circle): boolean {\n    const dx = (that.cx < this.xMin ? this.xMin : this.xMax < that.cx ? this.xMax : that.cx) - that.cx;\n    const dy = (that.cy < this.yMin ? this.yMin : this.yMax < that.cy ? this.yMax : that.cy) - that.cy;\n    return dx * dx + dy * dy <= that.r * that.r;\n  }\n\n  override union(that: AnyR2Shape): R2Box {\n    return super.union(that) as R2Box;\n  }\n\n  override transform(f: R2Function): R2Box {\n    return new R2Box(f.transformX(this.xMin, this.yMin), f.transformY(this.xMin, this.yMin),\n                     f.transformX(this.xMax, this.yMax), f.transformY(this.xMax, this.yMax));\n  }\n\n  override get bounds(): R2Box {\n    return this;\n  }\n\n  toAny(): R2BoxInit {\n    return {\n      xMin: this.xMin,\n      yMin: this.yMin,\n      xMax: this.xMax,\n      yMax: this.yMax,\n    };\n  }\n\n  interpolateTo(that: R2Box): Interpolator<R2Box>;\n  interpolateTo(that: unknown): Interpolator<R2Box> | null;\n  interpolateTo(that: unknown): Interpolator<R2Box> | null {\n    if (that instanceof R2Box) {\n      return R2BoxInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Box) {\n      return Numbers.equivalent(this.xMin, that.xMin, epsilon)\n          && Numbers.equivalent(this.yMin, that.yMin, epsilon)\n          && Numbers.equivalent(this.xMax, that.xMax, epsilon)\n          && Numbers.equivalent(this.yMax, that.yMax, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Box) {\n      return this.xMin === that.xMin && this.yMin === that.yMin\n          && this.xMax === that.xMax && this.yMax === that.yMax;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(R2Box), Numbers.hash(this.xMin)), Numbers.hash(this.yMin)),\n        Numbers.hash(this.xMax)), Numbers.hash(this.yMax)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"R2Box\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.xMin).write(\", \").debug(this.yMin).write(\", \")\n                   .debug(this.xMax).write(\", \").debug(this.yMax).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static undefined(): R2Box {\n    return new R2Box(Infinity, Infinity, -Infinity, -Infinity);\n  }\n\n  static of(xMin: number, yMin: number, xMax?: number, yMax?: number): R2Box {\n    if (xMax === void 0) {\n      xMax = xMin;\n    }\n    if (yMax === void 0) {\n      yMax = yMin;\n    }\n    return new R2Box(xMin, yMin, xMax, yMax);\n  }\n\n  static fromInit(value: R2BoxInit): R2Box {\n    return new R2Box(value.xMin, value.yMin, value.xMax, value.yMax);\n  }\n\n  static override fromAny(value: AnyR2Box): R2Box {\n    if (value === void 0 || value === null || value instanceof R2Box) {\n      return value;\n    } else if (R2Box.isInit(value)) {\n      return R2Box.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is R2BoxInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as R2BoxInit;\n      return typeof init.xMin === \"number\"\n          && typeof init.yMin === \"number\"\n          && typeof init.xMax === \"number\"\n          && typeof init.yMax === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyR2Box {\n    return value instanceof R2Box\n        || R2Box.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {R2Box} from \"./R2Box\";\n\n/** @internal */\nexport const R2BoxInterpolator = (function (_super: typeof Interpolator) {\n  const R2BoxInterpolator = function (s0: R2Box, s1: R2Box): Interpolator<R2Box> {\n    const interpolator = function (u: number): R2Box {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const xMin = s0.xMin + u * (s1.xMin - s0.xMin);\n      const yMin = s0.yMin + u * (s1.yMin - s0.yMin);\n      const xMax = s0.xMax + u * (s1.xMax - s0.xMax);\n      const yMax = s0.yMax + u * (s1.yMax - s0.yMax);\n      return new R2Box(xMin, yMin, xMax, yMax);\n    } as Interpolator<R2Box>;\n    Object.setPrototypeOf(interpolator, R2BoxInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: R2Box, s1: R2Box): Interpolator<R2Box>;\n\n    /** @internal */\n    prototype: Interpolator<R2Box>;\n  };\n\n  R2BoxInterpolator.prototype = Object.create(_super.prototype);\n  R2BoxInterpolator.prototype.constructor = R2BoxInterpolator;\n\n  return R2BoxInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {R2Circle} from \"./R2Circle\";\n\n/** @internal */\nexport const R2CircleInterpolator = (function (_super: typeof Interpolator) {\n  const R2CircleInterpolator = function (s0: R2Circle, s1: R2Circle): Interpolator<R2Circle> {\n    const interpolator = function (u: number): R2Circle {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const cx = s0.cx + u * (s1.cx - s0.cx);\n      const cy = s0.cy + u * (s1.cy - s0.cy);\n      const r = s0.r + u * (s1.r - s0.r);\n      return new R2Circle(cx, cy, r);\n    } as Interpolator<R2Circle>;\n    Object.setPrototypeOf(interpolator, R2CircleInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: R2Circle, s1: R2Circle): Interpolator<R2Circle>;\n\n    /** @internal */\n    prototype: Interpolator<R2Circle>;\n  };\n\n  R2CircleInterpolator.prototype = Object.create(_super.prototype);\n  R2CircleInterpolator.prototype.constructor = R2CircleInterpolator;\n\n  return R2CircleInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Equals, Equivalent, Mutable, Arrays} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {R2Function} from \"./R2Function\";\nimport {AnyR2Shape, R2Shape} from \"./R2Shape\";\nimport {R2Box} from \"./R2Box\";\n\n/** @public */\nexport class R2Group<S extends R2Shape = R2Shape> extends R2Shape implements Equals, Equivalent, Debug {\n  constructor(shapes: ReadonlyArray<S>) {\n    super();\n    this.shapes = shapes;\n    this.boundingBox = null;\n  }\n\n  readonly shapes: ReadonlyArray<S>;\n\n  isDefined(): boolean {\n    return this.shapes.length !== 0;\n  }\n\n  override get xMin(): number {\n    return this.bounds.xMin;\n  }\n\n  override get yMin(): number {\n    return this.bounds.yMin;\n  }\n\n  override get xMax(): number {\n    return this.bounds.xMax;\n  }\n\n  override get yMax(): number {\n    return this.bounds.yMax;\n  }\n\n  override contains(that: AnyR2Shape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyR2Shape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyR2Shape): boolean {\n    return false; // TODO\n  }\n\n  override transform(f: R2Function): R2Group {\n    const oldShapes = this.shapes;\n    const n = oldShapes.length;\n    if (n > 0) {\n      const newShapes = new Array<R2Shape>(n);\n      for (let i = 0; i < n; i += 1) {\n        newShapes[i] = oldShapes[i]!.transform(f);\n      }\n      return new R2Group(newShapes);\n    } else {\n      return R2Group.empty();\n    }\n  }\n\n  /** @internal */\n  readonly boundingBox: R2Box | null;\n\n  override get bounds(): R2Box {\n    let boundingBox = this.boundingBox;\n    if (boundingBox === null) {\n      let xMin = Infinity;\n      let yMin = Infinity;\n      let xMax = -Infinity;\n      let yMax = -Infinity;\n      const shapes = this.shapes;\n      for (let i = 0, n = shapes.length; i < n; i += 1) {\n        const shape = shapes[i]!;\n        xMin = Math.min(xMin, shape.xMin);\n        yMin = Math.min(yMin, shape.yMin);\n        xMax = Math.max(shape.xMax, xMax);\n        yMax = Math.max(shape.yMax, yMax);\n      }\n      boundingBox = new R2Box(xMin, yMin, xMax, yMax);\n      (this as Mutable<this>).boundingBox = boundingBox;\n    }\n    return boundingBox;\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Group) {\n      return Arrays.equivalent(this.shapes, that.shapes, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof R2Group) {\n      return Arrays.equal(this.shapes, that.shapes);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    const shapes = this.shapes;\n    const n = shapes.length;\n    output = output.write(\"R2Group\").write(46/*'.'*/);\n    if (n === 0) {\n      output = output.write(\"empty\").write(40/*'('*/);\n    } else {\n      output = output.write(\"of\").write(40/*'('*/);\n      output = output.debug(shapes[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(shapes[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty<S extends R2Shape>(): R2Group<S> {\n    return new R2Group(Arrays.empty);\n  }\n\n  static of<S extends R2Shape>(...shapes: S[]): R2Group<S> {\n    return new R2Group(shapes);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, HashCode, Equivalent, Interpolate, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Debug, Diagnostic, Unicode} from \"@swim/codec\";\nimport type {Value, Form} from \"@swim/structure\";\nimport {AnyLength, Length} from \"../length/Length\";\nimport {PxLength} from \"../length/PxLength\";\nimport {AnyAngle, Angle} from \"../angle/Angle\";\nimport {DegAngle} from \"../angle/DegAngle\";\nimport type {R2Operator} from \"../r2/R2Operator\";\nimport type {R2Point} from \"../r2/R2Point\";\nimport {TransformForm} from \"../\"; // forward import\nimport {IdentityTransform} from \"../\"; // forward import\nimport {TranslateTransform} from \"../\"; // forward import\nimport {ScaleTransform} from \"../\"; // forward import\nimport {RotateTransform} from \"../\"; // forward import\nimport {SkewTransform} from \"../\"; // forward import\nimport {AffineTransform} from \"../\"; // forward import\nimport {AffineTransformInterpolator} from \"../\"; // forward import\nimport {TransformList} from \"../\"; // forward import\nimport {TransformListParser} from \"../\"; // forward import\n\n/** @public */\nexport type AnyTransform = Transform | string;\n\n/** @public */\nexport abstract class Transform implements R2Operator, Interpolate<Transform>, HashCode, Equivalent, Debug {\n  abstract transform(that: Transform): Transform;\n  abstract transform(x: number, y: number): R2Point;\n\n  abstract transformX(x: number, y: number): number;\n\n  abstract transformY(x: number, y: number): number;\n\n  abstract inverse(): Transform;\n\n  translate(x: AnyLength, y: AnyLength): Transform {\n    return this.transform(Transform.translate(x, y));\n  }\n\n  translateX(x: AnyLength): Transform {\n    return this.transform(Transform.translateX(x));\n  }\n\n  translateY(y: AnyLength): Transform {\n    return this.transform(Transform.translateY(y));\n  }\n\n  scale(x: number, y: number): Transform {\n    return this.transform(Transform.scale(x, y));\n  }\n\n  scaleX(x: number): Transform {\n    return this.transform(Transform.scaleX(x));\n  }\n\n  scaleY(y: number): Transform {\n    return this.transform(Transform.scaleY(y));\n  }\n\n  rotate(a: AnyAngle): Transform {\n    return this.transform(Transform.rotate(a));\n  }\n\n  skew(x: AnyAngle, y: AnyAngle): Transform {\n    return this.transform(Transform.skew(x, y));\n  }\n\n  skewX(x: AnyAngle): Transform {\n    return this.transform(Transform.skewX(x));\n  }\n\n  skewY(y: AnyAngle): Transform {\n    return this.transform(Transform.skewY(y));\n  }\n\n  abstract toAffine(): AffineTransform;\n\n  toMatrix(): DOMMatrix {\n    return this.toAffine().toMatrix();\n  }\n\n  toCssTransformComponent(): CSSTransformComponent | null {\n    return null;\n  }\n\n  toCssValue(): CSSStyleValue | null {\n    if (typeof CSSTransformValue !== \"undefined\") {\n      const component = this.toCssTransformComponent();\n      if (component !== null) {\n        return new CSSTransformValue([component]);\n      }\n    }\n    return null;\n  }\n\n  abstract toValue(): Value;\n\n  interpolateTo(that: Transform): Interpolator<Transform>;\n  interpolateTo(that: unknown): Interpolator<Transform> | null;\n  interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof Transform) {\n      return AffineTransformInterpolator(this.toAffine(), that.toAffine());\n    } else {\n      return null;\n    }\n  }\n\n  abstract conformsTo(that: Transform): boolean;\n\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  abstract toString(): string;\n\n  toAttributeString(): string {\n    return this.toString();\n  }\n\n  @Lazy\n  static identity(): Transform {\n    return new IdentityTransform();\n  }\n\n  static translate(x: AnyLength, y: AnyLength): TranslateTransform {\n    x = Length.fromAny(x);\n    y = Length.fromAny(y);\n    return new TranslateTransform(x, y);\n  }\n\n  static translateX(x: AnyLength): TranslateTransform {\n    x = Length.fromAny(x);\n    return new TranslateTransform(x, PxLength.zero());\n  }\n\n  static translateY(y: AnyLength): TranslateTransform {\n    y = Length.fromAny(y);\n    return new TranslateTransform(PxLength.zero(), y);\n  }\n\n  static scale(x: number, y: number): ScaleTransform {\n    return new ScaleTransform(x, y);\n  }\n\n  static scaleX(x: number): ScaleTransform {\n    return new ScaleTransform(x, 1);\n  }\n\n  static scaleY(y: number): ScaleTransform {\n    return new ScaleTransform(1, y);\n  }\n\n  static rotate(a: AnyAngle): RotateTransform {\n    a = Angle.fromAny(a, \"deg\");\n    return new RotateTransform(a);\n  }\n\n  static skew(x: AnyAngle, y: AnyAngle): SkewTransform {\n    x = Angle.fromAny(x, \"deg\");\n    y = Angle.fromAny(y, \"deg\");\n    return new SkewTransform(x, y);\n  }\n\n  static skewX(x: AnyAngle): SkewTransform {\n    x = Angle.fromAny(x, \"deg\");\n    return new SkewTransform(x, DegAngle.zero());\n  }\n\n  static skewY(y: AnyAngle): SkewTransform {\n    y = Angle.fromAny(y, \"deg\");\n    return new SkewTransform(DegAngle.zero(), y);\n  }\n\n  static affine(x0: number = 1, y0: number = 0,\n                x1: number = 0, y1: number = 1,\n                tx: number = 0, ty: number = 0): AffineTransform {\n    return new AffineTransform(x0, y0, x1, y1, tx, ty);\n  }\n\n  static list(...transforms: AnyTransform[]): TransformList {\n    const list: Transform[] = [];\n    for (let i = 0; i < transforms.length; i += 1) {\n      const transform = Transform.fromAny(transforms[i]!);\n      if (transform instanceof TransformList) {\n        list.push(...transform.transforms);\n      } else if (!(transform instanceof IdentityTransform)) {\n        list.push(transform);\n      }\n    }\n    return new TransformList(list);\n  }\n\n  static fromCssValue(value: CSSStyleValue): Transform {\n    if (value instanceof CSSTransformValue) {\n      return Transform.fromCssTransform(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  /** @internal */\n  static fromCssTransform(value: CSSTransformValue): Transform {\n    const n = value.length;\n    if (n === 1) {\n      return Transform.fromCssTransformComponent(value[0]!);\n    } else {\n      const transforms = new Array<Transform>(n);\n      for (let i = 0; i < n; i += 1) {\n        transforms[i] = Transform.fromCssTransformComponent(value[i]!);\n      }\n      return new TransformList(transforms);\n    }\n  }\n\n  static fromCssTransformComponent(component: CSSTransformComponent): Transform {\n    if (component instanceof CSSTranslate) {\n      return TranslateTransform.fromCssTransformComponent(component);\n    } else if (component instanceof CSSRotate) {\n      return RotateTransform.fromCssTransformComponent(component);\n    } else if (component instanceof CSSScale) {\n      return ScaleTransform.fromCssTransformComponent(component);\n    } else if (component instanceof CSSSkew) {\n      return SkewTransform.fromCssTransformComponent(component);\n    } else if (component instanceof CSSMatrixComponent) {\n      return AffineTransform.fromCssTransformComponent(component);\n    } else {\n      throw new TypeError(\"\" + component);\n    }\n  }\n\n  static fromAny(value: AnyTransform): Transform {\n    if (value === void 0 || value === null || value instanceof Transform) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return Transform.parse(value);\n    } else {\n      throw new TypeError(\"\" + value);\n    }\n  }\n\n  static fromValue(value: Value): Transform | null {\n    const tag = value.tag;\n    switch (tag) {\n      case \"identity\": return IdentityTransform.fromValue(value);\n      case \"translate\": return TranslateTransform.fromValue(value);\n      case \"scale\": return ScaleTransform.fromValue(value);\n      case \"rotate\": return RotateTransform.fromValue(value);\n      case \"skew\": return SkewTransform.fromValue(value);\n      case \"matrix\": return AffineTransform.fromValue(value);\n      default: return TransformList.fromValue(value);\n    }\n  }\n\n  static parse(string: string): Transform {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = TransformListParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  @Lazy\n  static form(): Form<Transform, AnyTransform> {\n    return new TransformForm(Transform.identity());\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyTransform {\n    return value instanceof Transform\n        || typeof value === \"string\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Record, Form} from \"@swim/structure\";\nimport {AnyTransform, Transform} from \"./Transform\";\n\n/** @internal */\nexport class TransformForm extends Form<Transform, AnyTransform> {\n  constructor(unit: Transform | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: Transform | undefined;\n\n  override withUnit(unit: Transform | undefined): Form<Transform, AnyTransform> {\n    if (unit !== this.unit) {\n      return new TransformForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(transform: AnyTransform): Item {\n    transform = Transform.fromAny(transform);\n    return transform.toValue();\n  }\n\n  override cast(item: Item): Transform | undefined {\n    const value = item.toValue();\n    try {\n      if (value instanceof Record) {\n        const transform = Transform.fromValue(value);\n        return transform !== null ? transform : void 0;\n      } else {\n        const string = value.stringValue(void 0);\n        if (string !== void 0) {\n          return Transform.parse(string);\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Transform} from \"./Transform\";\nimport {TranslateTransformParser} from \"../\"; // forward import\nimport {ScaleTransformParser} from \"../\"; // forward import\nimport {RotateTransformParser} from \"../\"; // forward import\nimport {SkewTransformParser} from \"../\"; // forward import\nimport {AffineTransformParser} from \"../\"; // forward import\n\n/** @internal */\nexport class TransformParser extends Parser<Transform> {\n  private readonly identOutput: Output<string> | undefined;\n\n  constructor(identOutput?: Output<string>) {\n    super();\n    this.identOutput = identOutput;\n  }\n\n  override feed(input: Input): Parser<Transform> {\n    return TransformParser.parse(input, this.identOutput);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>): Parser<Transform> {\n    let c = 0;\n    identOutput = identOutput || Unicode.stringOutput();\n    while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || Unicode.isDigit(c) || c === 45/*'-'*/)) {\n      input = input.step();\n      identOutput.write(c);\n    }\n    if (!input.isEmpty()) {\n      const ident = identOutput.bind();\n      switch (ident) {\n        case \"translate3d\":\n        case \"translateX\":\n        case \"translateY\":\n        case \"translate\": return TranslateTransformParser.parseRest(input, identOutput);\n        case \"scaleX\":\n        case \"scaleY\":\n        case \"scale\": return ScaleTransformParser.parseRest(input, identOutput);\n        case \"rotate\": return RotateTransformParser.parseRest(input, identOutput);\n        case \"skewX\":\n        case \"skewY\":\n        case \"skew\": return SkewTransformParser.parseRest(input, identOutput);\n        case \"matrix\": return AffineTransformParser.parseRest(input, identOutput);\n        case \"none\": return Parser.done(Transform.identity());\n        default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n      }\n    }\n    return new TransformParser(identOutput);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Constructors, Interpolator, IdentityInterpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Value, Record} from \"@swim/structure\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {AffineTransform} from \"../\"; // forward import\n\n/** @public */\nexport class IdentityTransform extends Transform {\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      return x as Transform;\n    } else {\n      return new R2Point(x as number, y!);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    return x;\n  }\n\n  override transformY(x: number, y: number): number {\n    return y;\n  }\n\n  override inverse(): Transform {\n    return this;\n  }\n\n  override toAffine(): AffineTransform {\n    return new AffineTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  override toCssValue(): CSSStyleValue | null {\n    return new CSSKeywordValue(\"identity\");\n  }\n\n  override toValue(): Value {\n    return Record.create(1).attr(\"identity\");\n  }\n\n  override interpolateTo(that: IdentityTransform): Interpolator<IdentityTransform>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof IdentityTransform) {\n      return IdentityInterpolator(this);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    return that instanceof IdentityTransform;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    return that instanceof IdentityTransform;\n  }\n\n  override equals(that: unknown): boolean {\n    return that instanceof IdentityTransform;\n  }\n\n  override hashCode(): number {\n    return Constructors.hash(IdentityTransform);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"identity\")\n                   .write(40/*'('*/).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return \"none\";\n  }\n\n  static override fromValue(value: Value): IdentityTransform | null {\n    if (value.tag === \"identity\") {\n      return Transform.identity();\n    }\n    return null;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Constructors, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Item, Value, Record} from \"@swim/structure\";\nimport {Length} from \"../length/Length\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {IdentityTransform} from \"./IdentityTransform\";\nimport {TranslateTransformInterpolator} from \"../\"; // forward import\nimport {TranslateTransformParser} from \"../\"; // forward import\nimport {AffineTransform} from \"../\"; // forward import\n\n/** @public */\nexport class TranslateTransform extends Transform {\n  constructor(x: Length, y: Length) {\n    super();\n    this.x = x;\n    this.y = y;\n    this.stringValue = void 0;\n  }\n\n  readonly x: Length;\n\n  readonly y: Length;\n\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      if (x instanceof IdentityTransform) {\n        return this;\n      } else if (x instanceof TranslateTransform) {\n        return new TranslateTransform(this.x.plus(x.x), this.y.plus(x.y));\n      } else {\n        return Transform.list(this, x as Transform);\n      }\n    } else {\n      return new R2Point(this.x.pxValue() + (x as number), this.y.pxValue() + y!);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    return this.x.pxValue() + x;\n  }\n\n  override transformY(x: number, y: number): number {\n    return this.y.pxValue() + y;\n  }\n\n  override inverse(): Transform {\n    return new TranslateTransform(this.x.negative(), this.y.negative());\n  }\n\n  override toAffine(): AffineTransform {\n    return new AffineTransform(1, 0, 0, 1, this.x.pxValue(), this.y.pxValue());\n  }\n\n  override toCssTransformComponent(): CSSTransformComponent | null {\n    if (typeof CSSTranslate !== \"undefined\") {\n      const x = this.x.toCssValue();\n      const y = this.y.toCssValue();\n      return new CSSTranslate(x!, y!);\n    }\n    return null;\n  }\n\n  override toValue(): Value {\n    return Record.create(1)\n                 .attr(\"translate\", Record.create(2).slot(\"x\", this.x.toValue())\n                                                    .slot(\"y\", this.y.toValue()));\n  }\n\n  override interpolateTo(that: TranslateTransform): Interpolator<TranslateTransform>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof TranslateTransform) {\n      return TranslateTransformInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    return that instanceof TranslateTransform;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof TranslateTransform) {\n      return this.x.equivalentTo(that.x, epsilon)\n          && this.y.equivalentTo(that.y, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof TranslateTransform) {\n      return this.x.equals(that.x) && this.y.equals(that.y);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(TranslateTransform),\n        this.x.hashCode()), this.y.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"translate\");\n    if (this.x.isDefined() && !this.y.isDefined()) {\n      output = output.write(\"X\").write(40/*'('*/).debug(this.x);\n    } else if (!this.x.isDefined() && this.y.isDefined()) {\n      output = output.write(\"Y\").write(40/*'('*/).debug(this.y);\n    } else {\n      output = output.write(40/*'('*/).debug(this.x).write(\", \").debug(this.y);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      if (this.x.isDefined() && !this.y.isDefined()) {\n        stringValue = \"translate(\" + this.x + \",0)\";\n      } else if (!this.x.isDefined() && this.y.isDefined()) {\n        stringValue = \"translate(0,\" + this.y + \")\";\n      } else {\n        stringValue = \"translate(\" + this.x + \",\" + this.y + \")\";\n      }\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  override toAttributeString(): string {\n    if (this.x.isDefined() && !this.y.isDefined()) {\n      return \"translate(\" + this.x.pxValue() + \",0)\";\n    } else if (!this.x.isDefined() && this.y.isDefined()) {\n      return \"translate(0,\" + this.y.pxValue() + \")\";\n    } else {\n      return \"translate(\" + this.x.pxValue() + \",\" + this.y.pxValue() + \")\";\n    }\n  }\n\n  static override fromCssTransformComponent(component: CSSTranslate): TranslateTransform {\n    const x = typeof component.x === \"number\"\n            ? Length.px(component.x)\n            : Length.fromCssValue(component.x);\n    const y = typeof component.y === \"number\"\n            ? Length.px(component.y)\n            : Length.fromCssValue(component.y);\n    return new TranslateTransform(x, y);\n  }\n\n  static override fromAny(value: TranslateTransform | string): TranslateTransform {\n    if (value === void 0 || value === null || value instanceof TranslateTransform) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return TranslateTransform.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromValue(value: Value): TranslateTransform | null {\n    const header = value.header(\"translate\");\n    if (header.isDefined()) {\n      let x = Length.zero();\n      let y = Length.zero();\n      header.forEach(function (item: Item, index: number) {\n        const key = item.key.stringValue();\n        if (key !== void 0) {\n          if (key === \"x\") {\n            x = item.toValue().cast(Length.form(), x);\n          } else if (key === \"y\") {\n            y = item.toValue().cast(Length.form(), y);\n          }\n        } else if (item instanceof Value) {\n          if (index === 0) {\n            x = item.cast(Length.form(), x);\n          } else if (index === 1) {\n            y = item.cast(Length.form(), y);\n          }\n        }\n      }, this);\n      return new TranslateTransform(x, y);\n    }\n    return null;\n  }\n\n  static override parse(string: string): TranslateTransform {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = TranslateTransformParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Length} from \"../length/Length\";\nimport {TranslateTransform} from \"./TranslateTransform\";\n\n/** @internal */\nexport const TranslateTransformInterpolator = (function (_super: typeof Interpolator) {\n  const TranslateTransformInterpolator = function (f0: TranslateTransform, f1: TranslateTransform): Interpolator<TranslateTransform> {\n    const interpolator = function (u: number): TranslateTransform {\n      const f0 = interpolator[0];\n      const f1 = interpolator[1];\n      const x = Length.create(f0.x.value + u * (f1.x.value - f0.x.value), f1.x.units);\n      const y = Length.create(f0.y.value + u * (f1.y.value - f0.y.value), f1.y.units);\n      return new TranslateTransform(x, y);\n    } as Interpolator<TranslateTransform>;\n    Object.setPrototypeOf(interpolator, TranslateTransformInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = f0.x.units === f1.x.units && f0.y.units === f1.y.units\n                                                      ? f0 : new TranslateTransform(f0.x.to(f1.x.units), f0.y.to(f1.y.units));\n    (interpolator as Mutable<typeof interpolator>)[1] = f1;\n    return interpolator;\n  } as {\n    (f0: TranslateTransform, f1: TranslateTransform): Interpolator<TranslateTransform>;\n\n    /** @internal */\n    prototype: Interpolator<TranslateTransform>;\n  };\n\n  TranslateTransformInterpolator.prototype = Object.create(_super.prototype);\n  TranslateTransformInterpolator.prototype.constructor = TranslateTransformInterpolator;\n\n  return TranslateTransformInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport type {Length} from \"../length/Length\";\nimport {PxLength} from \"../length/PxLength\";\nimport {LengthParser} from \"../length/LengthParser\";\nimport {TranslateTransform} from \"./TranslateTransform\";\n\n/** @internal */\nexport class TranslateTransformParser extends Parser<TranslateTransform> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly xParser: Parser<Length> | undefined;\n  private readonly yParser: Parser<Length> | undefined;\n  private readonly zParser: Parser<Length> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, xParser?: Parser<Length>,\n              yParser?: Parser<Length>, zParser?: Parser<Length>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.xParser = xParser;\n    this.yParser = yParser;\n    this.zParser = zParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<TranslateTransform> {\n    return TranslateTransformParser.parse(input, this.identOutput, this.xParser,\n                                          this.yParser, this.zParser, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, xParser?: Parser<Length>,\n               yParser?: Parser<Length>, zParser?: Parser<Length>,\n               step: number = 1): Parser<TranslateTransform> {\n    let c = 0;\n    if (step === 1) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c) || Unicode.isDigit(c) || c === 45/*'-'*/)) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"translate3d\":\n          case \"translateX\":\n          case \"translateY\":\n          case \"translate\": step = 2; break;\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 3) {\n      if (xParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          xParser = LengthParser.parse(input, \"px\");\n        }\n      } else {\n        xParser = xParser.feed(input);\n      }\n      if (xParser !== void 0) {\n        if (xParser.isDone()) {\n          step = 4;\n        } else if (xParser.isError()) {\n          return xParser.asError();\n        }\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 41/*')'*/) {\n          input.step();\n          const ident = identOutput!.bind();\n          switch (ident) {\n            case \"translateX\": return Parser.done(new TranslateTransform(xParser!.bind(), PxLength.zero()));\n            case \"translateY\": return Parser.done(new TranslateTransform(PxLength.zero(), xParser!.bind()));\n            default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n          }\n        } else if (c === 44/*','*/) {\n          input.step();\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(\",\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 5) {\n      if (yParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          yParser = LengthParser.parse(input, \"px\");\n        }\n      } else {\n        yParser = yParser.feed(input);\n      }\n      if (yParser !== void 0) {\n        if (yParser.isDone()) {\n          step = 6;\n        } else if (yParser.isError()) {\n          return yParser.asError();\n        }\n      }\n    }\n    if (step === 6) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 41/*')'*/) {\n          input.step();\n          const ident = identOutput!.bind();\n          switch (ident) {\n            case \"translate\": return Parser.done(new TranslateTransform(xParser!.bind(), yParser!.bind()));\n            default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n          }\n        } else if (c === 44/*','*/) {\n          input.step();\n          step = 7;\n        } else {\n          return Parser.error(Diagnostic.expected(\",\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 7) {\n      if (zParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          zParser = LengthParser.parse(input, \"px\");\n        }\n      } else {\n        zParser = zParser.feed(input);\n      }\n      if (zParser !== void 0) {\n        if (zParser.isDone()) {\n          step = 8;\n        } else if (zParser.isError()) {\n          return zParser.asError();\n        }\n      }\n    }\n    if (step === 8) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont() && input.head() === 41/*')'*/) {\n        input.step();\n        const ident = identOutput!.bind();\n        switch (ident) {\n          case \"translate3d\":\n            if (zParser!.bind().value === 0) {\n              return Parser.done(new TranslateTransform(xParser!.bind(), yParser!.bind()));\n            }\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new TranslateTransformParser(identOutput, xParser, yParser, zParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input, identOutput?: Output<string>): Parser<TranslateTransform> {\n    return TranslateTransformParser.parse(input, identOutput, void 0, void 0, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Item, Value, Record} from \"@swim/structure\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {IdentityTransform} from \"./IdentityTransform\";\nimport {ScaleTransformInterpolator} from \"../\"; // forward import\nimport {ScaleTransformParser} from \"../\"; // forward import\nimport {AffineTransform} from \"../\"; // forward import\n\n/** @public */\nexport class ScaleTransform extends Transform {\n  constructor(x: number, y: number) {\n    super();\n    this.x = x;\n    this.y = y;\n    this.stringValue = void 0;\n  }\n\n  readonly x: number;\n\n  readonly y: number;\n\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      if (x instanceof IdentityTransform) {\n        return this;\n      } else {\n        return Transform.list(this, x as Transform);\n      }\n    } else {\n      return new R2Point(this.x * (x as number), this.y * y!);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    return this.x * x;\n  }\n\n  override transformY(x: number, y: number): number {\n    return this.y * y;\n  }\n\n  override inverse(): Transform {\n    return new ScaleTransform(1 / (this.x || 1), 1 / (this.y || 1));\n  }\n\n  toAffine(): AffineTransform {\n    return new AffineTransform(this.x, 0, 0, this.y, 0, 0);\n  }\n\n  override toCssTransformComponent(): CSSTransformComponent | null {\n    if (typeof CSSTranslate !== \"undefined\") {\n      return new CSSScale(this.x, this.y);\n    }\n    return null;\n  }\n\n  override toValue(): Value {\n    return Record.create(1)\n                 .attr(\"scale\", Record.create(2).slot(\"x\", this.x)\n                                                .slot(\"y\", this.y));\n  }\n\n  override interpolateTo(that: ScaleTransform): Interpolator<ScaleTransform>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof ScaleTransform) {\n      return ScaleTransformInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    return that instanceof ScaleTransform;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof ScaleTransform) {\n      return Numbers.equivalent(this.x, that.x, epsilon)\n          && Numbers.equivalent(this.y, that.y, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof ScaleTransform) {\n      return this.x === that.x && this.y === that.y;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(ScaleTransform),\n        Numbers.hash(this.x)), Numbers.hash(this.y)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"scale\");\n    if (this.x !== 0 && this.y === 0) {\n      output = output.write(\"X\").write(40/*'('*/).debug(this.x);\n    } else if (this.x === 0 && this.y !== 0) {\n      output = output.write(\"Y\").write(40/*'('*/).debug(this.y);\n    } else {\n      output = output.write(40/*'('*/).debug(this.x).write(\", \").debug(this.y);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      if (this.x !== 0 && this.y === 0) {\n        stringValue = \"scaleX(\" + this.x + \")\";\n      } else if (this.x === 0 && this.y !== 0) {\n        stringValue = \"scaleY(\" + this.y + \")\";\n      } else {\n        stringValue = \"scale(\" + this.x + \",\" + this.y + \")\";\n      }\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  static override fromCssTransformComponent(component: CSSScale): ScaleTransform {\n    const x = typeof component.x === \"number\"\n            ? component.x\n            : component.x.to(\"number\").value;\n    const y = typeof component.y === \"number\"\n            ? component.y\n            : component.y.to(\"number\").value;\n    return new ScaleTransform(x, y);\n  }\n\n  static override fromAny(value: ScaleTransform | string): ScaleTransform {\n    if (value === void 0 || value === null || value instanceof ScaleTransform) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return ScaleTransform.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromValue(value: Value): ScaleTransform | null {\n    const header = value.header(\"scale\");\n    if (header.isDefined()) {\n      let x = 0;\n      let y = 0;\n      header.forEach(function (item: Item, index: number) {\n        const key = item.key.stringValue();\n        if (key !== void 0) {\n          if (key === \"x\") {\n            x = item.toValue().numberValue(x);\n          } else if (key === \"y\") {\n            y = item.toValue().numberValue(y);\n          }\n        } else if (item instanceof Value) {\n          if (index === 0) {\n            x = item.numberValue(x);\n          } else if (index === 1) {\n            y = item.numberValue(y);\n          }\n        }\n      }, this);\n      return new ScaleTransform(x, y);\n    }\n    return null;\n  }\n\n  static override parse(string: string): ScaleTransform {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = ScaleTransformParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {ScaleTransform} from \"./ScaleTransform\";\n\n/** @internal */\nexport const ScaleTransformInterpolator = (function (_super: typeof Interpolator) {\n  const ScaleTransformInterpolator = function (f0: ScaleTransform, f1: ScaleTransform): Interpolator<ScaleTransform> {\n    const interpolator = function (u: number): ScaleTransform {\n      const f0 = interpolator[0];\n      const f1 = interpolator[1];\n      const x = f0.x + u * (f1.x - f0.x);\n      const y = f0.y + u * (f1.y - f0.y);\n      return new ScaleTransform(x, y);\n    } as Interpolator<ScaleTransform>;\n    Object.setPrototypeOf(interpolator, ScaleTransformInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = f0;\n    (interpolator as Mutable<typeof interpolator>)[1] = f1;\n    return interpolator;\n  } as {\n    (f0: ScaleTransform, f1: ScaleTransform): Interpolator<ScaleTransform>;\n\n    /** @internal */\n    prototype: Interpolator<ScaleTransform>;\n  };\n\n  ScaleTransformInterpolator.prototype = Object.create(_super.prototype);\n  ScaleTransformInterpolator.prototype.constructor = Interpolator;\n\n  return ScaleTransformInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {ScaleTransform} from \"./ScaleTransform\";\n\n/** @internal */\nexport class ScaleTransformParser extends Parser<ScaleTransform> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly xParser: Parser<number> | undefined;\n  private readonly yParser: Parser<number> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, xParser?: Parser<number>,\n              yParser?: Parser<number>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.xParser = xParser;\n    this.yParser = yParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<ScaleTransform> {\n    return ScaleTransformParser.parse(input, this.identOutput, this.xParser, this.yParser, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, xParser?: Parser<number>,\n               yParser?: Parser<number>, step: number = 1): Parser<ScaleTransform> {\n    let c = 0;\n    if (step === 1) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"scaleX\":\n          case \"scaleY\":\n          case \"scale\": step = 2; break;\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 3) {\n      if (xParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          xParser = Base10.parseNumber(input);\n        }\n      } else {\n        xParser = xParser.feed(input);\n      }\n      if (xParser !== void 0) {\n        if (xParser!.isDone()) {\n          step = 4;\n        } else if (xParser.isError()) {\n          return xParser.asError();\n        }\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 41/*')'*/) {\n          input.step();\n          const ident = identOutput!.bind();\n          switch (ident) {\n            case \"scaleX\": return Parser.done(new ScaleTransform(xParser!.bind(), 1));\n            case \"scaleY\": return Parser.done(new ScaleTransform(1, xParser!.bind()));\n            default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n          }\n        } else if (c === 44/*','*/) {\n          input.step();\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(\",\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 5) {\n      if (yParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          yParser = Base10.parseNumber(input);\n        }\n      } else {\n        yParser = yParser.feed(input);\n      }\n      if (yParser !== void 0) {\n        if (yParser.isDone()) {\n          step = 6;\n        } else if (yParser.isError()) {\n          return yParser.asError();\n        }\n      }\n    }\n    if (step === 6) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont() && input.head() === 41/*')'*/) {\n        input.step();\n        const ident = identOutput!.bind();\n        switch (ident) {\n          case \"scale\": return Parser.done(new ScaleTransform(xParser!.bind(), yParser!.bind()));\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new ScaleTransformParser(identOutput, xParser, yParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input, identOutput?: Output<string>): Parser<ScaleTransform> {\n    return ScaleTransformParser.parse(input, identOutput, void 0, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Constructors, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Item, Value, Record} from \"@swim/structure\";\nimport {Angle} from \"../angle/Angle\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {IdentityTransform} from \"./IdentityTransform\";\nimport {RotateTransformInterpolator} from \"../\"; // forward import\nimport {RotateTransformParser} from \"../\"; // forward import\nimport {AffineTransform} from \"../\"; // forward import\n\n/** @public */\nexport class RotateTransform extends Transform {\n  constructor(angle: Angle) {\n    super();\n    this.angle = angle;\n    this.stringValue = void 0;\n  }\n\n  readonly angle: Angle;\n\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      if (x instanceof IdentityTransform) {\n        return this;\n      } else {\n        return Transform.list(this, x as Transform);\n      }\n    } else {\n      const angle = this.angle.radValue();\n      const cosA = Math.cos(angle);\n      const sinA = Math.sin(angle);\n      return new R2Point((x as number) * cosA - y! * sinA,\n                         (x as number) * sinA + y! * cosA);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    const angle = this.angle.radValue();\n    return x * Math.cos(angle) - y * Math.sin(angle);\n  }\n\n  override transformY(x: number, y: number): number {\n    const angle = this.angle.radValue();\n    return x * Math.sin(angle) + y * Math.cos(angle);\n  }\n\n  override inverse(): Transform {\n    return new RotateTransform(this.angle.negative());\n  }\n\n  override toAffine(): AffineTransform {\n    const angle = this.angle.radValue();\n    return new AffineTransform(Math.cos(angle), Math.sin(angle),\n                              -Math.sin(angle), Math.cos(angle),\n                               0, 0);\n  }\n\n  override toCssTransformComponent(): CSSTransformComponent | null {\n    if (typeof CSSTranslate !== \"undefined\") {\n      const angle = this.angle.toCssValue();\n      return new CSSRotate(angle!);\n    }\n    return null;\n  }\n\n  override toValue(): Value {\n    return Record.create(1).attr(\"rotate\", this.angle.toString());\n  }\n\n  override interpolateTo(that: RotateTransform): Interpolator<RotateTransform>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof RotateTransform) {\n      return RotateTransformInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    return that instanceof RotateTransform;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof RotateTransform) {\n      return this.angle.equivalentTo(that.angle, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof RotateTransform) {\n      return this.angle.equals(that.angle);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(RotateTransform), this.angle.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"rotate\")\n                   .write(40/*'('*/).debug(this.angle).write(41/*')'*/);\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = \"rotate(\" + this.angle + \")\";\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  override toAttributeString(): string {\n    return \"rotate(\" + this.angle.degValue() + \")\";\n  }\n\n  static override fromCssTransformComponent(component: CSSRotate): RotateTransform {\n    const angle = Angle.fromCssValue(component.angle);\n    return new RotateTransform(angle);\n  }\n\n  static override fromAny(value: RotateTransform | string): RotateTransform {\n    if (value === void 0 || value === null || value instanceof RotateTransform) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return RotateTransform.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromValue(value: Value): RotateTransform | null {\n    const header = value.header(\"rotate\");\n    if (header.isDefined()) {\n      let angle = Angle.zero();\n      header.forEach(function (item: Item, index: number) {\n        const key = item.key.stringValue();\n        if (key === \"angle\") {\n          angle = item.toValue().cast(Angle.form(), angle);\n        } else if (item instanceof Value && index === 0) {\n          angle = item.cast(Angle.form(), angle);\n        }\n      }, this);\n      return new RotateTransform(angle);\n    }\n    return null;\n  }\n\n  static override parse(string: string): RotateTransform {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = RotateTransformParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Angle} from \"../angle/Angle\";\nimport {RotateTransform} from \"./RotateTransform\";\n\n/** @internal */\nexport const RotateTransformInterpolator = (function (_super: typeof Interpolator) {\n  const RotateTransformInterpolator = function (f0: RotateTransform, f1: RotateTransform): Interpolator<RotateTransform> {\n    const interpolator = function (u: number): RotateTransform {\n      const f0 = interpolator[0];\n      const f1 = interpolator[1];\n      const a = Angle.create(f0.angle.value + u * (f1.angle.value - f0.angle.value), f1.angle.units);\n      return new RotateTransform(a);\n    } as Interpolator<RotateTransform>;\n    Object.setPrototypeOf(interpolator, RotateTransformInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = f0.angle.units === f1.angle.units\n                                                      ? f0 : new RotateTransform(f0.angle.to(f1.angle.units));\n    (interpolator as Mutable<typeof interpolator>)[1] = f1;\n    return interpolator;\n  } as {\n    (f0: RotateTransform, f1: RotateTransform): Interpolator<RotateTransform>;\n\n    /** @internal */\n    prototype: Interpolator<RotateTransform>;\n  };\n\n  RotateTransformInterpolator.prototype = Object.create(_super.prototype);\n  RotateTransformInterpolator.prototype.constructor = RotateTransformInterpolator;\n\n  return RotateTransformInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport type {Angle} from \"../angle/Angle\";\nimport {AngleParser} from \"../angle/AngleParser\";\nimport {RotateTransform} from \"./RotateTransform\";\n\n/** @internal */\nexport class RotateTransformParser extends Parser<RotateTransform> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly angleParser: Parser<Angle> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, angleParser?: Parser<Angle>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.angleParser = angleParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<RotateTransform> {\n    return RotateTransformParser.parse(input, this.identOutput, this.angleParser, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, angleParser?: Parser<Angle>,\n               step: number = 1): Parser<RotateTransform> {\n    let c = 0;\n    if (step === 1) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"rotate\": step = 2; break;\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 3) {\n      if (angleParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          angleParser = AngleParser.parse(input, \"deg\");\n        }\n      } else {\n        angleParser = angleParser.feed(input);\n      }\n      if (angleParser !== void 0) {\n        if (angleParser.isDone()) {\n          step = 4;\n        } else if (angleParser.isError()) {\n          return angleParser.asError();\n        }\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont() && input.head() === 41/*')'*/) {\n        input.step();\n        const ident = identOutput!.bind();\n        switch (ident) {\n          case \"rotate\": return Parser.done(new RotateTransform(angleParser!.bind()));\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new RotateTransformParser(identOutput, angleParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input, identOutput?: Output<string>): Parser<RotateTransform> {\n    return RotateTransformParser.parse(input, identOutput, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Constructors, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Item, Value, Record} from \"@swim/structure\";\nimport {Angle} from \"../angle/Angle\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {IdentityTransform} from \"./IdentityTransform\";\nimport {SkewTransformInterpolator} from \"../\"; // forward import\nimport {SkewTransformParser} from \"../\"; // forward import\nimport {AffineTransform} from \"../\"; // forward import\n\n/** @public */\nexport class SkewTransform extends Transform {\n  constructor(x: Angle, y: Angle) {\n    super();\n    this.x = x;\n    this.y = y;\n    this.stringValue = void 0;\n  }\n\n  readonly x: Angle;\n\n  readonly y: Angle;\n\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      if (x instanceof IdentityTransform) {\n        return this;\n      } else {\n        return Transform.list(this, x as Transform);\n      }\n    } else {\n      return new R2Point(Math.tan(this.x.radValue()) * y! + (x as number),\n                         Math.tan(this.y.radValue()) * (x as number) + y!);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    return Math.tan(this.x.radValue()) * y + x;\n  }\n\n  override transformY(x: number, y: number): number {\n    return Math.tan(this.y.radValue()) * x + y;\n  }\n\n  override inverse(): Transform {\n    return new SkewTransform(this.x.negative(), this.y.negative());\n  }\n\n  override toAffine(): AffineTransform {\n    const x = this.x.radValue();\n    const y = this.y.radValue();\n    return new AffineTransform(1, Math.tan(y), Math.tan(x), 1, 0, 0);\n  }\n\n  override toCssTransformComponent(): CSSTransformComponent | null {\n    if (typeof CSSTranslate !== \"undefined\") {\n      const x = this.x.toCssValue();\n      const y = this.y.toCssValue();\n      return new CSSSkew(x!, y!);\n    }\n    return null;\n  }\n\n  override toValue(): Value {\n    return Record.create(1)\n                 .attr(\"skew\", Record.create(2).slot(\"x\", this.x.toValue())\n                                               .slot(\"y\", this.y.toValue()));\n  }\n\n  override interpolateTo(that: SkewTransform): Interpolator<SkewTransform>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof SkewTransform) {\n      return SkewTransformInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    return that instanceof SkewTransform;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof SkewTransform) {\n      return this.x.equivalentTo(that.x, epsilon)\n          && this.y.equivalentTo(that.y, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof SkewTransform) {\n      return this.x.equals(that.x) && this.y.equals(that.y);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(SkewTransform),\n        this.x.hashCode()), this.y.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"skew\");\n    if (this.x.isDefined() && !this.y.isDefined()) {\n      output = output.write(\"X\").write(40/*'('*/).debug(this.x);\n    } else if (!this.x.isDefined() && this.y.isDefined()) {\n      output = output.write(\"Y\").write(40/*'('*/).debug(this.y);\n    } else {\n      output = output.write(40/*'('*/).debug(this.x).write(\", \").debug(this.y);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      if (this.x.isDefined() && !this.y.isDefined()) {\n        stringValue = \"skewX(\" + this.x + \")\";\n      } else if (!this.x.isDefined() && this.y.isDefined()) {\n        stringValue = \"skewY(\" + this.y + \")\";\n      } else {\n        stringValue = \"skew(\" + this.x + \",\" + this.y + \")\";\n      }\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  override toAttributeString(): string {\n    if (this.x.isDefined() && !this.y.isDefined()) {\n      return \"skewX(\" + this.x.degValue() + \")\";\n    } else if (!this.x.isDefined() && this.y.isDefined()) {\n      return \"skewY(\" + this.y.degValue() + \")\";\n    } else {\n      return \"skew(\" + this.x.degValue() + \",\" + this.y.degValue() + \")\";\n    }\n  }\n\n  static override fromCssTransformComponent(component: CSSSkew): SkewTransform {\n    const x = typeof component.ax === \"number\"\n            ? Angle.rad(component.ax)\n            : Angle.fromCssValue(component.ax);\n    const y = typeof component.ay === \"number\"\n            ? Angle.rad(component.ay)\n            : Angle.fromCssValue(component.ay);\n    return new SkewTransform(x, y);\n  }\n\n  static override fromAny(value: SkewTransform | string): SkewTransform {\n    if (value === void 0 || value === null || value instanceof SkewTransform) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return SkewTransform.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromValue(value: Value): SkewTransform | null {\n    const header = value.header(\"skew\");\n    if (header.isDefined()) {\n      let x = Angle.zero();\n      let y = Angle.zero();\n      header.forEach(function (item: Item, index: number) {\n        const key = item.key.stringValue();\n        if (key !== void 0) {\n          if (key === \"x\") {\n            x = item.toValue().cast(Angle.form(), x);\n          } else if (key === \"y\") {\n            y = item.toValue().cast(Angle.form(), y);\n          }\n        } else if (item instanceof Value) {\n          if (index === 0) {\n            x = item.cast(Angle.form(), x);\n          } else if (index === 1) {\n            y = item.cast(Angle.form(), y);\n          }\n        }\n      }, this);\n      return new SkewTransform(x, y);\n    }\n    return null;\n  }\n\n  static override parse(string: string): SkewTransform {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = SkewTransformParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {Angle} from \"../angle/Angle\";\nimport {SkewTransform} from \"./SkewTransform\";\n\n/** @internal */\nexport const SkewTransformInterpolator = (function (_super: typeof Interpolator) {\n  const SkewTransformInterpolator = function (f0: SkewTransform, f1: SkewTransform): Interpolator<SkewTransform> {\n    const interpolator = function (u: number): SkewTransform {\n      const f0 = interpolator[0];\n      const f1 = interpolator[1];\n      const x = Angle.create(f0.x.value + u * (f1.x.value - f0.x.value), f1.x.units);\n      const y = Angle.create(f0.y.value + u * (f1.y.value - f0.y.value), f1.y.units);\n      return new SkewTransform(x, y);\n    } as Interpolator<SkewTransform>;\n    Object.setPrototypeOf(interpolator, SkewTransformInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = f0.x.units === f1.x.units && f0.y.units === f1.y.units\n                                                      ? f0 : new SkewTransform(f0.x.to(f1.x.units), f0.y.to(f1.y.units));\n    (interpolator as Mutable<typeof interpolator>)[1] = f1;\n    return interpolator;\n  } as {\n    (f0: SkewTransform, f1: SkewTransform): Interpolator<SkewTransform>;\n\n    /** @internal */\n    prototype: Interpolator<SkewTransform>;\n  };\n\n  SkewTransformInterpolator.prototype = Object.create(_super.prototype);\n  SkewTransformInterpolator.prototype.constructor = SkewTransformInterpolator;\n\n  return SkewTransformInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport type {Angle} from \"../angle/Angle\";\nimport {DegAngle} from \"../angle/DegAngle\";\nimport {AngleParser} from \"../angle/AngleParser\";\nimport {SkewTransform} from \"./SkewTransform\";\n\n/** @internal */\nexport class SkewTransformParser extends Parser<SkewTransform> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly xParser: Parser<Angle> | undefined;\n  private readonly yParser: Parser<Angle> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, xParser?: Parser<Angle>,\n              yParser?: Parser<Angle>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.xParser = xParser;\n    this.yParser = yParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<SkewTransform> {\n    return SkewTransformParser.parse(input, this.identOutput, this.xParser, this.yParser, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, xParser?: Parser<Angle>,\n               yParser?: Parser<Angle>, step: number = 1): Parser<SkewTransform> {\n    let c = 0;\n    if (step === 1) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"skewX\":\n          case \"skewY\":\n          case \"skew\": step = 2; break;\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    if (step === 3) {\n      if (xParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          xParser = AngleParser.parse(input, \"deg\");\n        }\n      } else {\n        xParser = xParser.feed(input);\n      }\n      if (xParser !== void 0) {\n        if (xParser.isDone()) {\n          step = 4;\n        } else if (xParser.isError()) {\n          return xParser.asError();\n        }\n      }\n    }\n    if (step === 4) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont()) {\n        c = input.head();\n        if (c === 41/*')'*/) {\n          input.step();\n          const ident = identOutput!.bind();\n          switch (ident) {\n            case \"skewX\": return Parser.done(new SkewTransform(xParser!.bind(), DegAngle.zero()));\n            case \"skewY\": return Parser.done(new SkewTransform(DegAngle.zero(), xParser!.bind()));\n            default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n          }\n        } else if (c === 44/*','*/) {\n          input.step();\n          step = 5;\n        } else {\n          return Parser.error(Diagnostic.expected(\",\", input));\n        }\n      } else if (input.isDone()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n    }\n    if (step === 5) {\n      if (yParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (!input.isEmpty()) {\n          yParser = AngleParser.parse(input, \"deg\");\n        }\n      } else {\n        yParser = yParser.feed(input);\n      }\n      if (yParser !== void 0) {\n        if (yParser.isDone()) {\n          step = 6;\n        } else if (yParser.isError()) {\n          return yParser.asError();\n        }\n      }\n    }\n    if (step === 6) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input.step();\n      }\n      if (input.isCont() && input.head() === 41/*')'*/) {\n        input.step();\n        const ident = identOutput!.bind();\n        switch (ident) {\n          case \"skew\": return Parser.done(new SkewTransform(xParser!.bind(), yParser!.bind()));\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\")\", input));\n      }\n    }\n    return new SkewTransformParser(identOutput, xParser, yParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input, identOutput?: Output<string>): Parser<SkewTransform> {\n    return SkewTransformParser.parse(input, identOutput, void 0, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Mutable, Murmur3, Numbers, Constructors, Interpolator} from \"@swim/util\";\nimport {Output, Parser, Diagnostic, Unicode} from \"@swim/codec\";\nimport {Item, Value, Record} from \"@swim/structure\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {IdentityTransform} from \"./IdentityTransform\";\nimport {AffineTransformInterpolator} from \"../\"; // forward import\nimport {AffineTransformParser} from \"../\"; // forward import\n\n/** @public */\nexport class AffineTransform extends Transform {\n  constructor(x0: number, y0: number, x1: number, y1: number, tx: number, ty: number) {\n    super();\n    this.x0 = x0;\n    this.y0 = y0;\n    this.x1 = x1;\n    this.y1 = y1;\n    this.tx = tx;\n    this.ty = ty;\n    this.stringValue = void 0;\n  }\n\n  readonly x0: number;\n\n  readonly y0: number;\n\n  readonly x1: number;\n\n  readonly y1: number;\n\n  readonly tx: number;\n\n  readonly ty: number;\n\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      if (x instanceof IdentityTransform) {\n        return this;\n      } else {\n        return this.multiply((x as Transform).toAffine());\n      }\n    } else {\n      return new R2Point(this.x0 * (x as number) + this.x1 * y! + this.tx,\n                         this.y0 * (x as number) + this.y1 * y! + this.ty);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    return this.x0 * x + this.x1 * y + this.tx;\n  }\n\n  override transformY(x: number, y: number): number {\n    return this.y0 * x + this.y1 * y + this.ty;\n  }\n\n  override inverse(): Transform {\n    const m00 = this.x0;\n    const m10 = this.y0;\n    const m01 = this.x1;\n    const m11 = this.y1;\n    const m02 = this.tx;\n    const m12 = this.ty;\n    const det = m00 * m11 - m01 * m10;\n    if (Math.abs(det) >= Number.MIN_VALUE) {\n      return new AffineTransform( m11 / det, -m10 / det,\n                                 -m01 / det,  m00 / det,\n                                 (m01 * m12 - m11 * m02) / det,\n                                 (m10 * m02 - m00 * m12) / det);\n    } else {\n      throw new Error(\"non-invertible affine transform with determinant \" + det);\n    }\n  }\n\n  multiply(that: AffineTransform): AffineTransform {\n    const x0 = this.x0 * that.x0 + this.x1 * that.y0;\n    const y0 = this.y0 * that.x0 + this.y1 * that.y0;\n    const x1 = this.x0 * that.x1 + this.x1 * that.y1;\n    const y1 = this.y0 * that.x1 + this.y1 * that.y1;\n    const tx = this.x0 * that.tx + this.x1 * that.ty;\n    const ty = this.y0 * that.tx + this.y1 * that.ty;\n    return new AffineTransform(x0, y0, x1, y1, tx, ty);\n  }\n\n  override toAffine(): AffineTransform {\n    return this;\n  }\n\n  override toMatrix(): DOMMatrix {\n    return new DOMMatrix([this.x0, this.y0, this.x1, this.y1, this.tx, this.ty]);\n  }\n\n  override toCssTransformComponent(): CSSTransformComponent | null {\n    if (typeof CSSTranslate !== \"undefined\") {\n      return new CSSMatrixComponent(this.toMatrix());\n    }\n    return null;\n  }\n\n  override toValue(): Value {\n    return Record.create(1)\n                 .attr(\"matrix\", Record.create(6).item(this.x0).item(this.y0)\n                                                 .item(this.x1).item(this.y1)\n                                                 .item(this.tx).item(this.ty));\n  }\n\n  override interpolateTo(that: AffineTransform): Interpolator<AffineTransform>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof AffineTransform) {\n      return AffineTransformInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    return that instanceof AffineTransform;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof AffineTransform) {\n      return Numbers.equivalent(this.x0, that.x0, epsilon)\n          && Numbers.equivalent(this.y0, that.y0, epsilon)\n          && Numbers.equivalent(this.x1, that.x1, epsilon)\n          && Numbers.equivalent(this.y1, that.y1, epsilon)\n          && Numbers.equivalent(this.tx, that.tx, epsilon)\n          && Numbers.equivalent(this.ty, that.ty, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof AffineTransform) {\n      return this.x0 === that.x0 && this.y0 === that.y0\n          && this.x1 === that.x1 && this.y1 === that.y1\n          && this.tx === that.tx && this.ty === that.ty;\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Murmur3.mix(Murmur3.mix(Constructors.hash(AffineTransform),\n        Numbers.hash(this.x0)), Numbers.hash(this.y0)),\n        Numbers.hash(this.x1)), Numbers.hash(this.y1)),\n        Numbers.hash(this.tx)), Numbers.hash(this.ty)));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"affine\").write(40/*'('*/)\n                   .debug(this.x0).write(\", \").debug(this.y0).write(\", \")\n                   .debug(this.x1).write(\", \").debug(this.y1).write(\", \")\n                   .debug(this.tx).write(\", \").debug(this.ty).write(41/*')'*/);\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      stringValue = \"matrix(\" + this.x0 + \",\" + this.y0 + \",\"\n                              + this.x1 + \",\" + this.y1 + \",\"\n                              + this.tx + \",\" + this.ty + \")\";\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  @Lazy\n  static override identity(): AffineTransform {\n    return new AffineTransform(1, 0, 0, 1, 0, 0);\n  }\n\n  static override fromAny(value: AffineTransform | string): AffineTransform {\n    if (value === void 0 || value === null || value instanceof AffineTransform) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return AffineTransform.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromMatrix(matrix: DOMMatrixReadOnly): AffineTransform {\n    return new AffineTransform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.e, matrix.f);\n  }\n\n  static override fromCssTransformComponent(component: CSSMatrixComponent): AffineTransform {\n    return AffineTransform.fromMatrix(component.matrix);\n  }\n\n  static override fromValue(value: Value): AffineTransform | null {\n    const header = value.header(\"matrix\");\n    if (header.isDefined()) {\n      let x0 = 0;\n      let y0 = 0;\n      let x1 = 0;\n      let y1 = 0;\n      let tx = 0;\n      let ty = 0;\n      header.forEach(function (item: Item, index: number) {\n        const key = item.key.stringValue();\n        if (key !== void 0) {\n          if (key === \"x0\") {\n            x0 = item.toValue().numberValue(x0);\n          } else if (key === \"y0\") {\n            y0 = item.toValue().numberValue(y0);\n          } else if (key === \"x1\") {\n            x1 = item.toValue().numberValue(x1);\n          } else if (key === \"y1\") {\n            y1 = item.toValue().numberValue(y1);\n          } else if (key === \"tx\") {\n            tx = item.toValue().numberValue(tx);\n          } else if (key === \"ty\") {\n            ty = item.toValue().numberValue(ty);\n          }\n        } else if (item instanceof Value) {\n          switch (index) {\n            case 0: x0 = item.numberValue(x0); break;\n            case 1: y0 = item.numberValue(y0); break;\n            case 2: x1 = item.numberValue(x1); break;\n            case 3: y1 = item.numberValue(y1); break;\n            case 4: tx = item.numberValue(tx); break;\n            case 5: ty = item.numberValue(ty); break;\n            default:\n          }\n        }\n      }, this);\n      return new AffineTransform(x0, y0, x1, y1, tx, ty);\n    }\n    return null;\n  }\n\n  static override parse(string: string): AffineTransform {\n    let input = Unicode.stringInput(string);\n    while (input.isCont() && Unicode.isWhitespace(input.head())) {\n      input = input.step();\n    }\n    let parser = AffineTransformParser.parse(input);\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isWhitespace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {AffineTransform} from \"./AffineTransform\";\n\n/** @internal */\nexport const AffineTransformInterpolator = (function (_super: typeof Interpolator) {\n  const AffineTransformInterpolator = function (f0: AffineTransform, f1: AffineTransform): Interpolator<AffineTransform> {\n    const interpolator = function (u: number): AffineTransform {\n      // TODO: interpolate and recompose matrices\n      const f0 = interpolator[0];\n      const f1 = interpolator[1];\n      const x0 = f0.x0 + u * (f1.x0 - f0.x0);\n      const y0 = f0.y0 + u * (f1.y0 - f0.y0);\n      const x1 = f0.x1 + u * (f1.x1 - f0.x1);\n      const y1 = f0.y1 + u * (f1.y1 - f0.y1);\n      const tx = f0.tx + u * (f1.tx - f0.tx);\n      const ty = f0.ty + u * (f1.ty - f0.ty);\n      return new AffineTransform(x0, y0, x1, y1, tx, ty);\n    } as Interpolator<AffineTransform>;\n    Object.setPrototypeOf(interpolator, AffineTransformInterpolator.prototype);\n    // TODO: decompose matrices\n    (interpolator as Mutable<typeof interpolator>)[0] = f0;\n    (interpolator as Mutable<typeof interpolator>)[1] = f1;\n    return interpolator;\n  } as {\n    (f0: AffineTransform, f1: AffineTransform): Interpolator<AffineTransform>;\n\n    /** @internal */\n    prototype: Interpolator<AffineTransform>;\n  };\n\n  AffineTransformInterpolator.prototype = Object.create(_super.prototype);\n  AffineTransformInterpolator.prototype.constructor = AffineTransformInterpolator;\n\n  return AffineTransformInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {Transform} from \"./Transform\";\nimport type {AffineTransform} from \"./AffineTransform\";\n\n/** @internal */\nexport class AffineTransformParser extends Parser<AffineTransform> {\n  private readonly identOutput: Output<string> | undefined;\n  private readonly entries: number[] | undefined;\n  private readonly entryParser: Parser<number> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(identOutput?: Output<string>, entries?: number[],\n              entryParser?: Parser<number>, step?: number) {\n    super();\n    this.identOutput = identOutput;\n    this.entries = entries;\n    this.entryParser = entryParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<AffineTransform> {\n    return AffineTransformParser.parse(input, this.identOutput, this.entries, this.entryParser, this.step);\n  }\n\n  static parse(input: Input, identOutput?: Output<string>, entries: number[] = [],\n               entryParser?: Parser<number>, step: number = 1): Parser<AffineTransform> {\n    let c = 0;\n    if (step === 1) {\n      identOutput = identOutput || Unicode.stringOutput();\n      while (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input = input.step();\n        identOutput.write(c);\n      }\n      if (!input.isEmpty()) {\n        const ident = identOutput.bind();\n        switch (ident) {\n          case \"matrix\": step = 2; break;\n          default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n        }\n      }\n    }\n    if (step === 2) {\n      while (input.isCont() && (c = input.head(), Unicode.isSpace(c))) {\n        input = input.step();\n      }\n      if (input.isCont() && c === 40/*'('*/) {\n        input.step();\n        step = 3;\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.expected(\"(\", input));\n      }\n    }\n    do {\n      if (step === 3) {\n        if (entryParser === void 0) {\n          while (input.isCont() && Unicode.isSpace(input.head())) {\n            input.step();\n          }\n          if (!input.isEmpty()) {\n            entryParser = Base10.parseNumber(input);\n          }\n        } else {\n          entryParser = entryParser.feed(input);\n        }\n        if (entryParser !== void 0) {\n          if (entryParser.isDone()) {\n            entries.push(entryParser.bind());\n            entryParser = void 0;\n            step = 4;\n          } else if (entryParser.isError()) {\n            return entryParser.asError();\n          }\n        }\n      }\n      if (step === 4) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (input.isCont()) {\n          c = input.head();\n          if (c === 41/*')'*/) {\n            input.step();\n            const ident = identOutput!.bind();\n            switch (ident) {\n              case \"matrix\": return Parser.done(Transform.affine(...entries));\n              default: return Parser.error(Diagnostic.message(\"unknown transform function: \" + ident, input));\n            }\n          } else if (entries.length >= 6) {\n            return Parser.error(Diagnostic.expected(\")\", input));\n          } else if (c === 44/*','*/) {\n            input.step();\n            step = 3;\n            continue;\n          } else {\n            return Parser.error(Diagnostic.expected(\",\", input));\n          }\n        } else if (input.isDone()) {\n          return Parser.error(Diagnostic.unexpected(input));\n        }\n      }\n      break;\n    } while (true);\n    return new AffineTransformParser(identOutput, entries, entryParser, step);\n  }\n\n  /** @internal */\n  static parseRest(input: Input, identOutput?: Output<string>): Parser<AffineTransform> {\n    return AffineTransformParser.parse(input, identOutput, void 0, void 0, 2);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Murmur3, Constructors, Interpolator} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item, Value, Record} from \"@swim/structure\";\nimport {R2Point} from \"../r2/R2Point\";\nimport {Transform} from \"./Transform\";\nimport {AffineTransform} from \"./AffineTransform\";\nimport {IdentityTransform} from \"./IdentityTransform\";\nimport {TransformListInterpolator} from \"../\"; // forward import\n\n/** @public */\nexport class TransformList extends Transform {\n  constructor(transforms: ReadonlyArray<Transform>) {\n    super();\n    this.transforms = transforms;\n    this.stringValue = void 0;\n  }\n\n  readonly transforms: ReadonlyArray<Transform>;\n\n  override transform(that: Transform): Transform;\n  override transform(x: number, y: number): R2Point;\n  override transform(x: Transform | number, y?: number): Transform | R2Point {\n    if (arguments.length === 1) {\n      if (x instanceof IdentityTransform) {\n        return this;\n      } else {\n        return Transform.list(this, x as Transform);\n      }\n    } else {\n      const transforms = this.transforms;\n      for (let i = 0, n = transforms.length; i < n; i += 1) {\n        const transform = transforms[i]!;\n        const xi = transform.transformX(x as number, y!);\n        const yi = transform.transformY(x as number, y!);\n        x = xi;\n        y = yi;\n      }\n      return new R2Point(x as number, y!);\n    }\n  }\n\n  override transformX(x: number, y: number): number {\n    const transforms = this.transforms;\n    for (let i = 0, n = transforms.length; i < n; i += 1) {\n      const transform = transforms[i]!;\n      const xi = transform.transformX(x, y);\n      const yi = transform.transformY(x, y);\n      x = xi;\n      y = yi;\n    }\n    return x;\n  }\n\n  override transformY(x: number, y: number): number {\n    const transforms = this.transforms;\n    for (let i = 0, n = transforms.length; i < n; i += 1) {\n      const transform = transforms[i]!;\n      const xi = transform.transformX(x, y);\n      const yi = transform.transformY(x, y);\n      x = xi;\n      y = yi;\n    }\n    return y;\n  }\n\n  override inverse(): Transform {\n    const transforms = this.transforms;\n    const n = transforms.length;\n    const inverseTransforms = new Array<Transform>(n);\n    for (let i = 0; i < n; i += 1) {\n      inverseTransforms[i] = transforms[n - i - 1]!.inverse();\n    }\n    return new TransformList(inverseTransforms);\n  }\n\n  override toAffine(): AffineTransform {\n    let matrix = AffineTransform.identity();\n    const transforms = this.transforms;\n    for (let i = 0, n = transforms.length; i < n; i += 1) {\n      matrix = matrix.multiply(transforms[i]!.toAffine());\n    }\n    return matrix;\n  }\n\n  override toCssTransformComponent(): CSSTransformComponent | null {\n    if (typeof CSSTranslate !== \"undefined\") {\n      return new CSSMatrixComponent(this.toMatrix());\n    }\n    return null;\n  }\n\n  override toCssValue(): CSSStyleValue | null {\n    if (typeof CSSTransformValue !== \"undefined\") {\n      const transforms = this.transforms;\n      const n = transforms.length;\n      const components = new Array<CSSTransformComponent>(n);\n      for (let i = 0, n = transforms.length; i < n; i += 1) {\n        const transform = transforms[i]!;\n        const component = transform.toCssTransformComponent();\n        if (component !== null) {\n          components[i] = component;\n        } else {\n          return null;\n        }\n      }\n      return new CSSTransformValue(components);\n    }\n    return null;\n  }\n\n  override toValue(): Value {\n    const transforms = this.transforms;\n    const n = transforms.length;\n    const record = Record.create(n);\n    for (let i = 0; i < n; i += 1) {\n      record.push(transforms[i]!.toValue());\n    }\n    return record;\n  }\n\n  override interpolateTo(that: TransformList): Interpolator<TransformList>;\n  override interpolateTo(that: Transform): Interpolator<Transform>;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null;\n  override interpolateTo(that: unknown): Interpolator<Transform> | null {\n    if (that instanceof TransformList) {\n      return TransformListInterpolator(this, that);\n    } else {\n      return super.interpolateTo(that);\n    }\n  }\n\n  override conformsTo(that: Transform): boolean {\n    if (that instanceof TransformList) {\n      const n = this.transforms.length;\n      if (n === that.transforms.length) {\n        for (let i = 0; i < n; i += 1) {\n          if (!this.transforms[i]!.conformsTo(that.transforms[i]!)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (that instanceof TransformList) {\n      const n = this.transforms.length;\n      if (n === that.transforms.length) {\n        for (let i = 0; i < n; i += 1) {\n          if (!this.transforms[i]!.equivalentTo(that.transforms[i]!, epsilon)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (that instanceof TransformList) {\n      const n = this.transforms.length;\n      if (n === that.transforms.length) {\n        for (let i = 0; i < n; i += 1) {\n          if (!this.transforms[i]!.equals(that.transforms[i]!)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    let hashValue = Constructors.hash(TransformList);\n    const transforms = this.transforms;\n    for (let i = 0, n = transforms.length; i < n; i += 1) {\n      hashValue = Murmur3.mix(hashValue, transforms[i]!.hashCode());\n    }\n    return Murmur3.mash(hashValue);\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"Transform\").write(46/*'.'*/).write(\"list\").write(40/*'('*/);\n    const transforms = this.transforms;\n    const n = transforms.length;\n    if (n > 0) {\n      output = output.debug(transforms[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(transforms[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  /** @internal */\n  readonly stringValue: string | undefined;\n\n  override toString(): string {\n    let stringValue = this.stringValue;\n    if (stringValue === void 0) {\n      const transforms = this.transforms;\n      const n = transforms.length;\n      if (n > 0) {\n        stringValue = transforms[0]!.toString();\n        for (let i = 1; i < n; i += 1) {\n          stringValue += \" \";\n          stringValue += transforms[i]!.toString();\n        }\n      } else {\n        stringValue = \"none\";\n      }\n      (this as Mutable<this>).stringValue = stringValue;\n    }\n    return stringValue;\n  }\n\n  override toAttributeString(): string {\n    const transforms = this.transforms;\n    const n = transforms.length;\n    if (n > 0) {\n      let s = transforms[0]!.toAttributeString();\n      for (let i = 1; i < n; i += 1) {\n        s += \" \";\n        s += transforms[i]!.toAttributeString();\n      }\n      return s;\n    } else {\n      return \"\";\n    }\n  }\n\n  static override fromAny(value: TransformList | string): TransformList {\n    if (value === void 0 || value === null || value instanceof TransformList) {\n      return value;\n    } else if (typeof value === \"string\") {\n      return TransformList.parse(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static override fromValue(value: Value): TransformList | null {\n    const transforms: Transform[] = [];\n    value.forEach(function (item: Item) {\n      const transform = Transform.fromValue(item.toValue());\n      if (transform !== null) {\n        transforms.push(transform);\n      }\n    }, this);\n    if (transforms.length !== 0) {\n      return new TransformList(transforms);\n    }\n    return null;\n  }\n\n  static override parse(string: string): TransformList {\n    const transform = Transform.parse(string);\n    if (transform instanceof TransformList) {\n      return transform;\n    } else {\n      return new TransformList([transform]);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport type {Transform} from \"./Transform\";\nimport {TransformList} from \"./TransformList\";\n\n/** @internal */\nexport interface TransformListInterpolator extends Interpolator<TransformList> {\n  /** @internal */\n  readonly interpolators: ReadonlyArray<Interpolator<Transform>>;\n\n  readonly 0: TransformList;\n\n  readonly 1: TransformList;\n\n  equals(that: unknown): boolean;\n}\n\n/** @internal */\nexport const TransformListInterpolator = (function (_super: typeof Interpolator) {\n  const TransformListInterpolator = function (f0: TransformList, f1: TransformList): TransformListInterpolator {\n    const interpolator = function (u: number): TransformList {\n      const interpolators = interpolator.interpolators;\n      const interpolatorCount = interpolators.length;\n      const transforms = new Array<Transform>(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        transforms[i] = interpolators[i]!(u);\n      }\n      return new TransformList(transforms);\n    } as TransformListInterpolator;\n    Object.setPrototypeOf(interpolator, TransformListInterpolator.prototype);\n    const transforms0 = f0.transforms;\n    const transforms1 = f1.transforms;\n    const interpolatorCount = Math.min(transforms0.length, transforms1.length);\n    const interpolators = new Array<Interpolator<Transform>>(interpolatorCount);\n    for (let i = 0; i < interpolatorCount; i += 1) {\n      interpolators[i] = transforms0[i]!.interpolateTo(transforms1[i]!);\n    }\n    (interpolator as Mutable<typeof interpolator>).interpolators = interpolators;\n    return interpolator;\n  } as {\n    (f0: TransformList, f1: TransformList): TransformListInterpolator;\n\n    /** @internal */\n    prototype: TransformListInterpolator;\n  };\n\n  TransformListInterpolator.prototype = Object.create(_super.prototype);\n  TransformListInterpolator.prototype.constructor = TransformListInterpolator;\n\n  Object.defineProperty(TransformListInterpolator.prototype, 0, {\n    get(this: TransformListInterpolator): TransformList {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const transforms = new Array<Transform>(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        transforms[i] = interpolators[i]![0];\n      }\n      return new TransformList(transforms);\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(TransformListInterpolator.prototype, 1, {\n    get(this: TransformListInterpolator): TransformList {\n      const interpolators = this.interpolators;\n      const interpolatorCount = interpolators.length;\n      const transforms = new Array<Transform>(interpolatorCount);\n      for (let i = 0; i < interpolatorCount; i += 1) {\n        transforms[i] = interpolators[i]![1];\n      }\n      return new TransformList(transforms);\n    },\n    configurable: true,\n  });\n\n  TransformListInterpolator.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TransformListInterpolator) {\n      const n = this.interpolators.length;\n      if (n === that.interpolators.length) {\n        for (let i = 0; i < n; i += 1) {\n          if (!this.interpolators[i]!.equals(that.interpolators[i]!)) {\n            return false;\n          }\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n\n  return TransformListInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Unicode} from \"@swim/codec\";\nimport {Transform} from \"./Transform\";\nimport {TransformParser} from \"./TransformParser\";\n\n/** @internal */\nexport class TransformListParser extends Parser<Transform> {\n  private readonly transform: Transform | undefined;\n  private readonly transformParser: Parser<Transform> | undefined;\n\n  constructor(transform?: Transform, transformParser?: Parser<Transform>) {\n    super();\n    this.transform = transform;\n    this.transformParser = transformParser;\n  }\n\n  override feed(input: Input): Parser<Transform> {\n    return TransformListParser.parse(input, this.transform, this.transformParser);\n  }\n\n  static parse(input: Input, transform: Transform = Transform.identity(),\n               transformParser?: Parser<Transform>): Parser<Transform> {\n    do {\n      if (transformParser === void 0) {\n        while (input.isCont() && Unicode.isSpace(input.head())) {\n          input.step();\n        }\n        if (input.isCont()) {\n          transformParser = TransformParser.parse(input);\n        } else if (input.isDone()) {\n          return Parser.done(transform);\n        }\n      }\n      if (transformParser !== void 0) {\n        transformParser = transformParser.feed(input);\n        if (transformParser.isDone()) {\n          transform = transform.transform(transformParser.bind());\n          transformParser = void 0;\n          continue;\n        } else if (transformParser.isError()) {\n          return transformParser.asError();\n        }\n      }\n      break;\n    } while (true);\n    return new TransformListParser(transform, transformParser);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {AnyR2Point, R2Point} from \"@swim/math\";\nimport type {AnyGeoPoint, GeoPoint} from \"./GeoPoint\";\n\n/** @public */\nexport interface GeoProjection {\n  project(lnglat: AnyGeoPoint): R2Point;\n  project(lng: number, lat: number): R2Point;\n\n  unproject(point: AnyR2Point): GeoPoint;\n  unproject(x: number, y: number): GeoPoint;\n}\n\n/** @public */\nexport const GeoProjection = (function () {\n  const GeoProjection = {} as {\n    is(object: unknown): object is GeoProjection;\n  };\n\n  GeoProjection.is = function (object: unknown): object is GeoProjection {\n    if (object !== void 0 && object !== null) {\n      const projection = object as GeoProjection;\n      return typeof projection.project === \"function\"\n          && typeof projection.unproject === \"function\";\n    }\n    return false;\n  };\n\n  return GeoProjection;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Equals} from \"@swim/util\";\nimport type {R2Shape} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {GeoPointInit, GeoPointTuple, GeoPoint} from \"./\"; // forward import\nimport {GeoSegmentInit, GeoSegment} from \"./\"; // forward import\nimport {GeoBoxInit, GeoBox} from \"./\"; // forward import\nimport {GeoTileInit, GeoTileTuple, GeoTile} from \"./\"; // forward import\n\n/** @public */\nexport type AnyGeoShape = GeoShape | GeoPointInit | GeoPointTuple | GeoSegmentInit | GeoTileInit | GeoTileTuple | GeoBoxInit;\n\n/** @public */\nexport abstract class GeoShape implements Equals {\n  abstract readonly lngMin: number;\n\n  abstract readonly latMin: number;\n\n  abstract readonly lngMax: number;\n\n  abstract readonly latMax: number;\n\n  abstract contains(that: AnyGeoShape): boolean;\n\n  abstract contains(lng: number, lat: number): boolean;\n\n  abstract intersects(that: AnyGeoShape): boolean;\n\n  union(that: AnyGeoShape): GeoShape {\n    that = GeoShape.fromAny(that);\n    return new GeoBox(Math.min(this.lngMin, that.lngMin),\n                      Math.min(this.latMin, that.latMin),\n                      Math.max(this.lngMax, that.lngMax),\n                      Math.max(this.latMax, that.latMax));\n  }\n\n  abstract project(f: GeoProjection): R2Shape;\n\n  get bounds(): GeoBox {\n    return new GeoBox(this.lngMin, this.latMin, this.lngMax, this.latMax);\n  }\n\n  abstract equals(that: unknown): boolean;\n\n  static fromAny(value: AnyGeoShape): GeoShape {\n    if (value === void 0 || value === null || value instanceof GeoShape) {\n      return value;\n    } else if (GeoPoint.isInit(value)) {\n      return GeoPoint.fromInit(value);\n    } else if (GeoPoint.isTuple(value)) {\n      return GeoPoint.fromTuple(value);\n    } else if (GeoSegment.isInit(value)) {\n      return GeoSegment.fromInit(value);\n    } else if (GeoTile.isInit(value)) {\n      return GeoTile.fromInit(value);\n    } else if (GeoTile.isTuple(value)) {\n      return GeoTile.fromTuple(value);\n    } else if (GeoBox.isInit(value)) {\n      return GeoBox.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyGeoShape {\n    return value instanceof GeoShape\n        || GeoPoint.isInit(value)\n        || GeoPoint.isTuple(value)\n        || GeoSegment.isInit(value)\n        || GeoTile.isInit(value)\n        || GeoBox.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Lazy,\n  Equivalent,\n  HashCode,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport type {R2Point} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {GeoPointInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport type AnyGeoPoint = GeoPoint | GeoPointInit | GeoPointTuple;\n\n/** @public */\nexport interface GeoPointInit {\n  lng: number;\n  lat: number;\n}\n\n/** @public */\nexport type GeoPointTuple = [number, number];\n\n/**\n * A geographic point represented by a WGS84 longitude and latitude.\n * @public\n */\nexport class GeoPoint extends GeoShape implements Interpolate<GeoPoint>, HashCode, Equivalent, Debug {\n  constructor(lng: number, lat: number) {\n    super();\n    this.lng = lng;\n    this.lat = lat;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.lng) && isFinite(this.lat);\n  }\n\n  readonly lng: number;\n\n  readonly lat: number;\n\n  override get lngMin(): number {\n    return this.lng;\n  }\n\n  override get latMin(): number {\n    return this.lat;\n  }\n\n  override get lngMax(): number {\n    return this.lng;\n  }\n\n  override get latMax(): number {\n    return this.lat;\n  }\n\n  override contains(that: AnyGeoShape): boolean;\n  override contains(lng: number, lat: number): boolean;\n  override contains(that: AnyGeoShape | number, lat?: number): boolean {\n    if (typeof that === \"number\") {\n      return this.lng === that && this.lat === lat!;\n    } else {\n      that = GeoShape.fromAny(that);\n      if (that instanceof GeoPoint) {\n        return this.lng === that.lng && this.lat === that.lat;\n      } else if (that instanceof GeoShape) {\n        return this.lng <= that.lngMin && that.lngMax <= this.lng\n            && this.lat <= that.latMin && that.latMax <= this.lat;\n      }\n      return false;\n    }\n  }\n\n  override intersects(that: AnyGeoShape): boolean {\n    that = GeoShape.fromAny(that);\n    return (that as GeoShape).intersects(this);\n  }\n\n  override project(f: GeoProjection): R2Point {\n    return f.project(this);\n  }\n\n  normalized(): GeoPoint {\n    const oldLng = this.lng;\n    const oldLat = this.lat;\n    const newLng = GeoPoint.normalizeLng(oldLng);\n    const newLat = GeoPoint.normalizeLat(oldLat);\n    if (oldLng === newLng && oldLat === newLat) {\n      return this;\n    } else {\n      return new GeoPoint(newLng, newLat);\n    }\n  }\n\n  toAny(): GeoPointInit {\n    return {\n      lng: this.lng,\n      lat: this.lat,\n    };\n  }\n\n  interpolateTo(that: GeoPoint): Interpolator<GeoPoint>;\n  interpolateTo(that: unknown): Interpolator<GeoPoint> | null;\n  interpolateTo(that: unknown): Interpolator<GeoPoint> | null {\n    if (that instanceof GeoPoint) {\n      return GeoPointInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoPoint) {\n      return Numbers.equivalent(this.lng, that.lng, epsilon)\n          && Numbers.equivalent(this.lat, that.lat, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoPoint) {\n      return this.lng === that.lng && this.lat === that.lat;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(GeoPoint),\n        Numbers.hash(this.lng)), Numbers.hash(this.lat)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"GeoPoint\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.lng).write(\", \").debug(this.lat).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static origin(): GeoPoint {\n    return new GeoPoint(0, 0);\n  }\n\n  @Lazy\n  static undefined(): GeoPoint {\n    return new GeoPoint(NaN, NaN);\n  }\n\n  static of(lng: number, lat: number): GeoPoint {\n    return new GeoPoint(lng, lat);\n  }\n\n  static fromInit(value: GeoPointInit): GeoPoint {\n    return new GeoPoint(value.lng, value.lat);\n  }\n\n  static fromTuple(value: GeoPointTuple): GeoPoint {\n    return new GeoPoint(value[0], value[1]);\n  }\n\n  static override fromAny(value: AnyGeoPoint): GeoPoint {\n    if (value === void 0 || value === null || value instanceof GeoPoint) {\n      return value;\n    } else if (GeoPoint.isInit(value)) {\n      return GeoPoint.fromInit(value);\n    } else if (GeoPoint.isTuple(value)) {\n      return GeoPoint.fromTuple(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static normalized(lng: number, lat: number): GeoPoint {\n    lng = GeoPoint.normalizeLng(lng);\n    lat = GeoPoint.normalizeLat(lat);\n    return new GeoPoint(lng, lat);\n  }\n\n  /** @internal */\n  static normalizeLng(lng: number): number {\n    if (lng < -180) {\n      lng = 180 - (-lng + 180) % 360;\n    } else if (lng > 180) {\n      lng = -180 + (lng - 180) % 360;\n    }\n    return lng;\n  }\n\n  /** @internal */\n  static normalizeLat(lat: number): number {\n    lat = Math.min(Math.max(-90 + Equivalent.Epsilon, lat), 90 - Equivalent.Epsilon);\n    return lat;\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is GeoPointInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as GeoPointInit;\n      return typeof init.lng === \"number\"\n          && typeof init.lat === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static isTuple(value: unknown): value is GeoPointTuple {\n    return Array.isArray(value)\n        && value.length === 2\n        && typeof value[0] === \"number\"\n        && typeof value[1] === \"number\";\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyGeoPoint {\n    return value instanceof GeoPoint\n        || GeoPoint.isInit(value)\n        || GeoPoint.isTuple(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {GeoPoint} from \"./GeoPoint\";\n\n/** @internal */\nexport const GeoPointInterpolator = (function (_super: typeof Interpolator) {\n  const GeoPointInterpolator = function (p0: GeoPoint, p1: GeoPoint): Interpolator<GeoPoint> {\n    const interpolator = function (u: number): GeoPoint {\n      const p0 = interpolator[0];\n      const lng0 = p0.lng;\n      const lat0 = p0.lat;\n      const p1 = interpolator[1];\n      const lng1 = p1.lng;\n      const lat1 = p1.lat;\n      let lng: number;\n      if (lng0 > 0 && lng1 < 0 && lng0 - lng1 > 180) {\n        // east across anti-meridian\n        const w = 180 - lng0;\n        const e = 180 + lng1;\n        const uw = w / (w + e);\n        if (u < uw) {\n          lng = lng0 + (u / uw) * w;\n        } else {\n          const ue = 1 - uw;\n          lng = -180 + ((u - uw) / ue) * e;\n        }\n      } else if (lng0 < 0 && lng1 > 0 && lng1 - lng0 > 180) {\n        // west across anti-meridian\n        const e = 180 + lng0;\n        const w = 180 - lng1;\n        const ue = e / (e + w);\n        if (u < ue) {\n          lng = lng0 - (u / ue) * e;\n        } else {\n          const uw = 1 - ue;\n          lng = 180 - ((u - ue) / uw) * w;\n        }\n      } else {\n        lng = lng0 + u * (lng1 - lng0);\n      }\n      const lat = lat0 + u * (lat1 - lat0);\n      return new GeoPoint(lng, lat);\n    } as Interpolator<GeoPoint>;\n    Object.setPrototypeOf(interpolator, GeoPointInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = p0.normalized();\n    (interpolator as Mutable<typeof interpolator>)[1] = p1.normalized();\n    return interpolator;\n  } as {\n    (p0: GeoPoint, p1: GeoPoint): Interpolator<GeoPoint>;\n\n    /** @internal */\n    prototype: Interpolator<GeoPoint>;\n  };\n\n  GeoPointInterpolator.prototype = Object.create(_super.prototype);\n  GeoPointInterpolator.prototype.constructor = GeoPointInterpolator;\n\n  return GeoPointInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Equivalent, Equals} from \"@swim/util\";\nimport type {R2Curve} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {GeoShape} from \"./GeoShape\";\nimport type {GeoPoint} from \"./GeoPoint\";\n\n/** @public */\nexport abstract class GeoCurve extends GeoShape implements Equals, Equivalent {\n  abstract interpolateLng(u: number): number;\n\n  abstract interpolateLat(u: number): number;\n\n  abstract interpolate(u: number): GeoPoint;\n\n  abstract split(u: number): [GeoCurve, GeoCurve];\n\n  abstract override project(f: GeoProjection): R2Curve;\n\n  abstract forEachCoord<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  abstract forEachCoord<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                              thisArg: S): R | undefined;\n\n  abstract forEachCoordRest<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  abstract forEachCoordRest<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                                  thisArg: S): R | undefined;\n\n  abstract equivalentTo(that: unknown, epsilon?: number): boolean;\n\n  abstract override equals(that: unknown): boolean;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Murmur3, Numbers, Constructors, Interpolate, Interpolator} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport {R2Segment} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {GeoPoint} from \"./GeoPoint\";\nimport {GeoCurve} from \"./GeoCurve\";\nimport {GeoSegmentInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport type AnyGeoSegment = GeoSegment | GeoSegmentInit;\n\n/** @public */\nexport interface GeoSegmentInit {\n  lng0: number;\n  lat0: number;\n  lng1: number;\n  lat1: number;\n}\n\n/** @public */\nexport class GeoSegment extends GeoCurve implements Interpolate<GeoSegment>, HashCode, Debug {\n  constructor(lng0: number, lat0: number, lng1: number, lat1: number) {\n    super();\n    this.lng0 = lng0;\n    this.lat0 = lat0;\n    this.lng1 = lng1;\n    this.lat1 = lat1;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.lng0) && isFinite(this.lat0)\n        && isFinite(this.lng1) && isFinite(this.lat1);\n  }\n\n  readonly lng0: number;\n\n  readonly lat0: number;\n\n  readonly lng1: number;\n\n  readonly lat1: number;\n\n  override get lngMin(): number {\n    return Math.min(this.lng0, this.lng1);\n  }\n\n  override get latMin(): number {\n    return Math.min(this.lat0, this.lat1);\n  }\n\n  override get lngMax(): number {\n    return Math.max(this.lng0, this.lng1);\n  }\n\n  override get latMax(): number {\n    return Math.max(this.lat0, this.lat1);\n  }\n\n  override interpolateLng(u: number): number {\n    return (1.0 - u) * this.lng0 + u * this.lng1;\n  }\n\n  override interpolateLat(u: number): number {\n   return (1.0 - u) * this.lat0 + u * this.lat1;\n  }\n\n  override interpolate(u: number): GeoPoint {\n    const v = 1.0 - u;\n    const lng01 = v * this.lng0 + u * this.lng1;\n    const lat01 = v * this.lat0 + u * this.lat1;\n    return new GeoPoint(lng01, lat01);\n  }\n\n  override contains(that: AnyGeoShape): boolean;\n  override contains(lng: number, lat: number): boolean;\n  override contains(that: AnyGeoShape | number, lat?: number): boolean {\n    if (typeof that === \"number\") {\n      return R2Segment.contains(this.lng0, this.lat0, this.lng1, this.lat1, that, lat!);\n    } else {\n      that = GeoShape.fromAny(that);\n      if (that instanceof GeoPoint) {\n        return this.containsPoint(that);\n      } else if (that instanceof GeoSegment) {\n        return this.containsSegment(that);\n      }\n      return false;\n    }\n  }\n\n  /** @internal */\n  containsPoint(that: GeoPoint): boolean {\n    return R2Segment.contains(this.lng0, this.lat0, this.lng1, this.lat1, that.lng, that.lat);\n  }\n\n  /** @internal */\n  containsSegment(that: GeoSegment): boolean {\n    return R2Segment.contains(this.lng0, this.lat0, this.lng1, this.lat1, that.lng0, that.lat0)\n        && R2Segment.contains(this.lng0, this.lat0, this.lng1, this.lat1, that.lng1, that.lat1);\n  }\n\n  override intersects(that: AnyGeoShape): boolean {\n    that = GeoShape.fromAny(that);\n    if (that instanceof GeoPoint) {\n      return this.intersectsPoint(that);\n    } else if (that instanceof GeoSegment) {\n      return this.intersectsSegment(that);\n    } else {\n      return (that as GeoShape).intersects(this);\n    }\n    return false;\n  }\n\n  /** @internal */\n  intersectsPoint(that: GeoPoint): boolean {\n    return R2Segment.contains(this.lng0, this.lat0, this.lng1, this.lat1, that.lng, that.lat);\n  }\n\n  /** @internal */\n  intersectsSegment(that: GeoSegment): boolean {\n    return R2Segment.intersects(this.lng0, this.lat0, this.lng1 - this.lat0, this.lng1 - this.lat0,\n                                that.lng0, that.lat0, that.lng1 - that.lat0, that.lng1 - that.lat0);\n  }\n\n  override split(u: number): [GeoSegment, GeoSegment] {\n    const v = 1.0 - u;\n    const lng01 = v * this.lng0 + u * this.lng1;\n    const lat01 = v * this.lat0 + u * this.lat1;\n    const c0 = new GeoSegment(this.lng0, this.lat0, lng01, lat01);\n    const c1 = new GeoSegment(lng01, lat01, this.lng1, this.lat1);\n    return [c0, c1];\n  }\n\n  override project(f: GeoProjection): R2Segment {\n    const p0 = f.project(this.lng0, this.lat0);\n    const p1 = f.project(this.lng1, this.lat1);\n    return new R2Segment(p0.x, p0.y, p1.x, p1.y);\n  }\n\n  override forEachCoord<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  override forEachCoord<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                              thisArg: S): R | undefined;\n  override forEachCoord<R, S>(callback: (this: S | undefined, lng: number, lat: number) => R | undefined,\n                              thisArg?: S): R | undefined {\n    let result: R | void;\n    result = callback.call(thisArg, this.lng0, this.lat0);\n    if (result !== void 0) {\n      return result;\n    }\n    result = callback.call(thisArg, this.lng1, this.lat1);\n    if (result !== void 0) {\n      return result;\n    }\n    return void 0;\n  }\n\n  override forEachCoordRest<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  override forEachCoordRest<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                                  thisArg: S): R | undefined;\n  override forEachCoordRest<R, S>(callback: (this: S | undefined, lng: number, lat: number) => R | void,\n                                  thisArg?: S): R | undefined {\n    const result = callback.call(thisArg, this.lng1, this.lat1);\n    if (result !== void 0) {\n      return result;\n    }\n    return void 0;\n  }\n\n  toAny(): GeoSegmentInit {\n    return {\n      lng0: this.lng0,\n      lat0: this.lat0,\n      lng1: this.lng1,\n      lat1: this.lat1,\n    };\n  }\n\n  interpolateTo(that: GeoSegment): Interpolator<GeoSegment>;\n  interpolateTo(that: unknown): Interpolator<GeoSegment> | null;\n  interpolateTo(that: unknown): Interpolator<GeoSegment> | null {\n    if (that instanceof GeoSegment) {\n      return GeoSegmentInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoSegment) {\n      return Numbers.equivalent(this.lng0, that.lng0, epsilon)\n          && Numbers.equivalent(this.lat0, that.lat0, epsilon)\n          && Numbers.equivalent(this.lng1, that.lng1, epsilon)\n          && Numbers.equivalent(this.lat1, that.lat1, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoSegment) {\n      return this.lng0 === that.lng0 && this.lat0 === that.lat0\n          && this.lng1 === that.lng1 && this.lat1 === that.lat1;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(GeoSegment), Numbers.hash(this.lng0)), Numbers.hash(this.lat0)),\n        Numbers.hash(this.lng1)), Numbers.hash(this.lat1)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"GeoSegment\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.lng0).write(\", \").debug(this.lat0).write(\", \")\n                   .debug(this.lng1).write(\", \").debug(this.lat1).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static of(lng0: number, lat0: number, lng1: number, lat1: number): GeoSegment {\n    return new GeoSegment(lng0, lat0, lng1, lat1);\n  }\n\n  static fromInit(value: GeoSegmentInit): GeoSegment {\n    return new GeoSegment(value.lng0, value.lat0, value.lng1, value.lat1);\n  }\n\n  static override fromAny(value: AnyGeoSegment): GeoSegment {\n    if (value === void 0 || value === null || value instanceof GeoSegment) {\n      return value;\n    } else if (GeoSegment.isInit(value)) {\n      return GeoSegment.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is GeoSegmentInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as GeoSegmentInit;\n      return typeof init.lng0 === \"number\"\n          && typeof init.lat0 === \"number\"\n          && typeof init.lng1 === \"number\"\n          && typeof init.lat1 === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyGeoSegment {\n    return value instanceof GeoSegment\n        || GeoSegment.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {GeoSegment} from \"./GeoSegment\";\n\n/** @internal */\nexport const GeoSegmentInterpolator = (function (_super: typeof Interpolator) {\n  const GeoSegmentInterpolator = function (s0: GeoSegment, s1: GeoSegment): Interpolator<GeoSegment> {\n    const interpolator = function (u: number): GeoSegment {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const lng0 = s0.lng0 + u * (s1.lng0 - s0.lng0);\n      const lat0 = s0.lat0 + u * (s1.lat0 - s0.lat0);\n      const lng1 = s0.lng1 + u * (s1.lng1 - s0.lng1);\n      const lat1 = s0.lat1 + u * (s1.lat1 - s0.lat1);\n      return new GeoSegment(lng0, lat0, lng1, lat1);\n    } as Interpolator<GeoSegment>;\n    Object.setPrototypeOf(interpolator, GeoSegmentInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: GeoSegment, s1: GeoSegment): Interpolator<GeoSegment>;\n\n    /** @internal */\n    prototype: Interpolator<GeoSegment>;\n  };\n\n  GeoSegmentInterpolator.prototype = Object.create(_super.prototype);\n  GeoSegmentInterpolator.prototype.constructor = GeoSegmentInterpolator;\n\n  return GeoSegmentInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport {R2Curve, R2Segment, R2Spline} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {AnyGeoPoint, GeoPoint} from \"./GeoPoint\";\nimport {GeoCurve} from \"./GeoCurve\";\nimport {GeoSegment} from \"./GeoSegment\";\nimport {GeoSplineBuilder} from \"./\"; // forward import\nimport {GeoBox} from \"./\"; // forward import\n\n/** @public */\nexport type AnyGeoSpline = GeoSpline | GeoSplinePoints;\n\n/** @public */\nexport type GeoSplinePoints = ReadonlyArray<AnyGeoPoint>;\n\n/** @public */\nexport class GeoSpline extends GeoCurve implements Debug {\n  constructor(curves: ReadonlyArray<GeoCurve>, closed: boolean) {\n    super();\n    this.curves = curves;\n    this.closed = closed;\n    this.boundingBox = null;\n  }\n\n  readonly curves: ReadonlyArray<GeoCurve>;\n\n  /** @internal */\n  readonly closed: boolean;\n\n  isDefined(): boolean {\n    return this.curves.length !== 0;\n  }\n\n  isClosed(): boolean {\n    return this.closed;\n  }\n\n  override get lngMin(): number {\n    return this.bounds.lngMin;\n  }\n\n  override get latMin(): number {\n    return this.bounds.latMin;\n  }\n\n  override get lngMax(): number {\n    return this.bounds.lngMax;\n  }\n\n  override get latMax(): number {\n    return this.bounds.latMax;\n  }\n\n  override interpolateLng(u: number): number {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return curves[k]!.interpolateLng(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  override interpolateLat(u: number): number {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return curves[k]!.interpolateLat(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  override interpolate(u: number): GeoPoint {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return curves[k]!.interpolate(v);\n    } else {\n      return new GeoPoint(NaN, NaN);\n    }\n  }\n\n  override contains(that: AnyGeoShape): boolean;\n  override contains(lng: number, lat: number): boolean;\n  override contains(that: AnyGeoShape | number, lat?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyGeoShape): boolean {\n    return false; // TODO\n  }\n\n  override split(u: number): [GeoSpline, GeoSpline] {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      const [c0, c1] = curves[k]!.split(v);\n      const curves0 = new Array<GeoCurve>(k + 1);\n      const curves1 = new Array<GeoCurve>(n - k);\n      for (let i = 0; i < k; i += 1) {\n        curves0[i] = curves[i]!;\n      }\n      curves0[k] = c0;\n      curves1[0] = c1;\n      for (let i = k + 1; i < n; i += 1) {\n        curves1[i - k] = curves[i]!;\n      }\n      return [new GeoSpline(curves0, false), new GeoSpline(curves1, false)];\n    } else {\n      return [GeoSpline.empty(), GeoSpline.empty()];\n    }\n  }\n\n  subdivide(u: number): GeoSpline {\n    const oldCurves = this.curves;\n    const n = oldCurves.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      const [c0, c1] = oldCurves[k]!.split(v);\n      const newCurves = new Array<GeoCurve>(n + 1);\n      for (let i = 0; i < k; i += 1) {\n        newCurves[i] = oldCurves[i]!;\n      }\n      newCurves[k] = c0;\n      newCurves[k + 1] = c1;\n      for (let i = k + 1; i < n; i += 1) {\n        newCurves[i + 1] = oldCurves[i]!;\n      }\n      return new GeoSpline(newCurves, this.closed);\n    } else {\n      return GeoSpline.empty();\n    }\n  }\n\n  override project(f: GeoProjection): R2Spline {\n    const oldCurves = this.curves;\n    const n = oldCurves.length;\n    if (n > 0) {\n      let i = 0;\n      const newCurves = new Array<R2Curve>(n);\n\n      // project leading adjacent segments\n      let curve = oldCurves[0]!;\n      if (curve instanceof GeoSegment) {\n        // project first point\n        let p0 = f.project(curve.lng0, curve.lat0);\n        while (i < n) {\n          curve = oldCurves[i]!;\n          if (curve instanceof GeoSegment) {\n            // project next point\n            const p1 = f.project(curve.lng1, curve.lat1);\n            newCurves[i] = new R2Segment(p0.x, p0.y, p1.x, p1.y);\n            p0 = p1;\n            i += 1;\n          } else {\n            break;\n          }\n        }\n      }\n\n      // project any remaining curves\n      while (i < n) {\n        curve = oldCurves[i]!;\n        newCurves[i] = curve.project(f);\n        i += 1;\n      }\n\n      return new R2Spline(newCurves, this.closed);\n    } else {\n      return R2Spline.empty();\n    }\n  }\n\n  /** @internal */\n  readonly boundingBox: GeoBox | null;\n\n  override get bounds(): GeoBox {\n    let boundingBox = this.boundingBox;\n    if (boundingBox === null) {\n      let lngMin = Infinity;\n      let latMin = Infinity;\n      let lngMax = -Infinity;\n      let latMax = -Infinity;\n      const curves = this.curves;\n      for (let i = 0, n = curves.length; i < n; i += 1) {\n        const curve = curves[i]!;\n        lngMin = Math.min(lngMin, curve.lngMin);\n        latMin = Math.min(latMin, curve.latMin);\n        lngMax = Math.max(curve.lngMax, lngMax);\n        latMax = Math.max(curve.latMax, latMax);\n      }\n      boundingBox = new GeoBox(lngMin, latMin, lngMax, latMax);\n      (this as Mutable<this>).boundingBox = boundingBox;\n    }\n    return boundingBox;\n  }\n\n  override forEachCoord<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  override forEachCoord<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                              thisArg: S): R | undefined;\n  override forEachCoord<R, S>(callback: (this: S | undefined, lng: number, lat: number) => R | void,\n                              thisArg?: S): R | undefined {\n    const curves = this.curves;\n    const n = curves.length;\n    if (n > 0) {\n      let curve = curves[0]!;\n      let result = curve.forEachCoord(callback, thisArg);\n      if (result !== void 0) {\n        return result;\n      }\n      for (let i = 1; i < n; i += 1) {\n        curve = curves[i]!;\n        result = curve.forEachCoordRest(callback, thisArg);\n        if (result !== void 0) {\n          return result;\n        }\n      }\n    }\n    return void 0;\n  }\n\n  override forEachCoordRest<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  override forEachCoordRest<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                                  thisArg: S): R | undefined;\n  override forEachCoordRest<R, S>(callback: (this: S | undefined, lng: number, lat: number) => R | void,\n                                  thisArg?: S): R | undefined {\n    const curves = this.curves;\n    for (let i = 0, n = curves.length; i < n; i += 1) {\n      const curve = curves[i]!;\n      const result = curve.forEachCoordRest(callback, thisArg);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  override equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoSpline) {\n      return Arrays.equivalent(this.curves, that.curves, epsilon)\n          && this.closed === that.closed;\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoSpline) {\n      return Arrays.equal(this.curves, that.curves)\n          && this.closed === that.closed;\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    const curves = this.curves;\n    const n = curves.length;\n    output = output.write(\"GeoSpline\").write(46/*'.'*/);\n    if (n === 0) {\n      output = output.write(\"empty\").write(40/*'('*/);\n    } else if (n !== 0) {\n      output = output.write(this.closed ? \"closed\" : \"open\").write(40/*'('*/);\n      output = output.debug(curves[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(curves[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static empty(): GeoSpline {\n    return new GeoSpline([], false);\n  }\n\n  static open(...curves: GeoCurve[]): GeoSpline {\n    return new GeoSpline(curves, false);\n  }\n\n  static closed(...curves: GeoCurve[]): GeoSpline {\n    return new GeoSpline(curves, true);\n  }\n\n  static fromPoints(points: GeoSplinePoints): GeoSpline {\n    const n = points.length;\n    if (n > 1) {\n      const curves = new Array<GeoCurve>(n - 1);\n      const p0 = GeoPoint.fromAny(points[0]!);\n      let p1 = p0;\n      for (let i = 1; i < n; i += 1) {\n        const p2 = GeoPoint.fromAny(points[i]!);\n        curves[i - 1] = new GeoSegment(p1.lng, p1.lat, p2.lng, p2.lat);\n        p1 = p2;\n      }\n      const closed = p0.equals(p1);\n      return new GeoSpline(curves, closed);\n    } else {\n      return GeoSpline.empty();\n    }\n  }\n\n  static override fromAny(value: AnyGeoSpline): GeoSpline;\n  static override fromAny(value: AnyGeoShape): GeoShape;\n  static override fromAny(value: AnyGeoSpline | AnyGeoShape): GeoShape {\n    if (value === void 0 || value === null || value instanceof GeoSpline) {\n      return value;\n    } else if (GeoSpline.isPoints(value)) {\n      return GeoSpline.fromPoints(value);\n    } else {\n      return GeoShape.fromAny(value);\n    }\n  }\n\n  static builder(): GeoSplineBuilder {\n    return new GeoSplineBuilder();\n  }\n\n  /** @internal */\n  static isPoints(value: unknown): value is GeoSplinePoints {\n    return Array.isArray(value)\n        && value.length >= 2\n        && GeoPoint.isAny(value[0]!);\n  }\n\n  /** @internal */\n  static isAnySpline(value: unknown): value is AnyGeoSpline {\n    return value instanceof GeoSpline\n        || GeoSpline.isPoints(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoCurve} from \"./GeoCurve\";\nimport {GeoSegment} from \"./GeoSegment\";\nimport type {GeoSplineContext} from \"./GeoSplineContext\";\nimport {GeoSpline} from \"./GeoSpline\";\n\n/** @public */\nexport class GeoSplineBuilder implements GeoSplineContext {\n  /** @internal */\n  curves: GeoCurve[];\n  /** @internal */\n  closed: boolean;\n  /** @internal */\n  aliased: boolean;\n  /** @internal */\n  lng0: number;\n  /** @internal */\n  lat0: number;\n  /** @internal */\n  lng: number;\n  /** @internal */\n  lat: number;\n\n  constructor() {\n    this.curves = [];\n    this.closed = false;\n    this.aliased = false;\n    this.lng0 = 0;\n    this.lat0 = 0;\n    this.lng = 0;\n    this.lat = 0;\n  }\n\n  private dealias(): void {\n    if (this.aliased) {\n      this.curves = this.curves.slice(0);\n      this.aliased = false;\n    }\n  }\n\n  moveTo(lng: number, lat: number): void {\n    if (this.aliased) {\n      this.curves = [];\n      this.aliased = false;\n    } else {\n      this.curves.length = 0;\n    }\n    this.closed = false;\n    this.lng0 = lng;\n    this.lat0 = lat;\n    this.lng = lng;\n    this.lat = lat;\n  }\n\n  closePath(): void {\n    this.dealias();\n    this.curves.push(new GeoSegment(this.lng, this.lat, this.lng0, this.lat0));\n    this.closed = true;\n    this.lng = this.lng0;\n    this.lat = this.lat0;\n  }\n\n  lineTo(lng: number, lat: number): void {\n    this.dealias();\n    this.curves.push(new GeoSegment(this.lng, this.lat, lng, lat));\n    this.lng = lng;\n    this.lat = lat;\n  }\n\n  bind(): GeoSpline {\n    this.aliased = true;\n    return new GeoSpline(this.curves, this.closed);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equivalent, Equals, Mutable, Arrays} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport {R2Spline, R2Path} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {GeoPoint} from \"./GeoPoint\";\nimport type {GeoCurve} from \"./GeoCurve\";\nimport {AnyGeoSpline, GeoSplinePoints, GeoSpline} from \"./GeoSpline\";\nimport {GeoPathBuilder} from \"./\"; // forward import\nimport {GeoBox} from \"./\"; // forward import\n\n/** @public */\nexport type AnyGeoPath = GeoPath | GeoPathSplines | AnyGeoSpline;\n\n/** @public */\nexport type GeoPathSplines = ReadonlyArray<AnyGeoSpline>;\n\n/** @public */\nexport class GeoPath extends GeoShape implements Equals, Equivalent, Debug {\n  constructor(splines: ReadonlyArray<GeoSpline>) {\n    super();\n    this.splines = splines;\n    this.boundingBox = null;\n  }\n\n  isDefined(): boolean {\n    return this.splines.length !== 0;\n  }\n\n  readonly splines: ReadonlyArray<GeoSpline>;\n\n  override get lngMin(): number {\n    return this.bounds.lngMin;\n  }\n\n  override get latMin(): number {\n    return this.bounds.latMin;\n  }\n\n  override get lngMax(): number {\n    return this.bounds.lngMax;\n  }\n\n  override get latMax(): number {\n    return this.bounds.latMax;\n  }\n\n  interpolateLng(u: number): number {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return splines[k]!.interpolateLng(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  interpolateLat(u: number): number {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return splines[k]!.interpolateLat(v);\n    } else {\n      return NaN;\n    }\n  }\n\n  interpolate(u: number): GeoPoint {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      return splines[k]!.interpolate(v);\n    } else {\n      return new GeoPoint(NaN, NaN);\n    }\n  }\n\n  override contains(that: AnyGeoShape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyGeoShape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyGeoShape): boolean {\n    return false; // TODO\n  }\n\n  split(u: number): [GeoPath, GeoPath] {\n    const splines = this.splines;\n    const n = splines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      const [s0, s1] = splines[k]!.split(v);\n      const splines0 = new Array<GeoSpline>(k + 1);\n      const splines1 = new Array<GeoSpline>(n - k);\n      for (let i = 0; i < k; i += 1) {\n        splines0[i] = splines[i]!;\n      }\n      splines0[k] = s0;\n      splines1[0] = s1;\n      for (let i = k + 1; i < n; i += 1) {\n        splines1[i - k] = splines[i]!;\n      }\n      return [new GeoPath(splines0), new GeoPath(splines1)];\n    } else {\n      return [GeoPath.empty(), GeoPath.empty()];\n    }\n  }\n\n  subdivide(u: number): GeoPath {\n    const oldSplines = this.splines;\n    const n = oldSplines.length;\n    if (n > 0) {\n      const l = 1 / n;\n      const k = Math.min(Math.max(0, Math.floor(u / l)), n);\n      const v = u * n - k * l;\n      const newSplines = new Array<GeoSpline>(n);\n      for (let i = 0; i < k; i += 1) {\n        newSplines[i] = oldSplines[i]!;\n      }\n      newSplines[k] = oldSplines[k]!.subdivide(v);\n      for (let i = k + 1; i < n; i += 1) {\n        newSplines[i] = oldSplines[i]!;\n      }\n      return new GeoPath(newSplines);\n    } else {\n      return GeoPath.empty();\n    }\n  }\n\n  override project(f: GeoProjection): R2Path {\n    const oldSplines = this.splines;\n    const n = oldSplines.length;\n    if (n > 0) {\n      const newSplines = new Array<R2Spline>(n);\n      for (let i = 0; i < n; i += 1) {\n        newSplines[i] = oldSplines[i]!.project(f);\n      }\n      return new R2Path(newSplines);\n    } else {\n      return R2Path.empty();\n    }\n  }\n\n  /** @internal */\n  readonly boundingBox: GeoBox | null;\n\n  override get bounds(): GeoBox {\n    let boundingBox = this.boundingBox;\n    if (boundingBox === null) {\n      let lngMin = Infinity;\n      let latMin = Infinity;\n      let lngMax = -Infinity;\n      let latMax = -Infinity;\n      const splines = this.splines;\n      for (let i = 0, n = splines.length; i < n; i += 1) {\n        const spline = splines[i]!;\n        lngMin = Math.min(lngMin, spline.lngMin);\n        latMin = Math.min(latMin, spline.latMin);\n        lngMax = Math.max(spline.lngMax, lngMax);\n        latMax = Math.max(spline.latMax, latMax);\n      }\n      boundingBox = new GeoBox(lngMin, latMin, lngMax, latMax);\n      (this as Mutable<this>).boundingBox = boundingBox;\n    }\n    return boundingBox;\n  }\n\n  centroid(): GeoPoint {\n    let lngSum = 0;\n    let latSum = 0;\n    let n = 0;\n    this.forEachCoord(function (lng: number, lat: number): void {\n      lngSum += lng;\n      latSum += lat;\n      n += 1;\n    }, this);\n    if (n !== 0) {\n      return new GeoPoint(lngSum / n, latSum / n);\n    } else {\n      return GeoPoint.undefined();\n    }\n  }\n\n  forEachCoord<R>(callback: (lng: number, lat: number) => R | void): R | undefined;\n  forEachCoord<R, S>(callback: (this: S, lng: number, lat: number) => R | void,\n                     thisArg: S): R | undefined;\n  forEachCoord<R, S>(callback: (this: S | undefined, lng: number, lat: number) => R | void,\n                     thisArg?: S): R | undefined {\n    const splines = this.splines;\n    for (let i = 0, n = splines.length; i < n; i += 1) {\n      const spline = splines[i]!;\n      const result = spline.forEachCoord(callback, thisArg);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n    return void 0;\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoPath) {\n      return Arrays.equivalent(this.splines, that.splines, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoPath) {\n      return Arrays.equal(this.splines, that.splines);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    const splines = this.splines;\n    const n = splines.length;\n    output = output.write(\"GeoPath\").write(46/*'.'*/);\n    if (n === 0) {\n      output = output.write(\"empty\").write(40/*'('*/);\n    } else if (n === 1) {\n      const spline = splines[0]!;\n      output = output.write(spline.closed ? \"closed\" : \"open\").write(40/*'('*/);\n      const curves = spline.curves;\n      const m = curves.length;\n      if (m !== 0) {\n        output = output.debug(curves[0]!);\n        for (let i = 1; i < m; i += 1) {\n          output = output.write(\", \").debug(curves[i]!);\n        }\n      }\n    } else {\n      output = output.write(\"of\").write(40/*'('*/);\n      output = output.debug(splines[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(splines[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  static empty(): GeoPath {\n    return new GeoPath([]);\n  }\n\n  static of(...splines: GeoSpline[]): GeoPath {\n    return new GeoPath(splines);\n  }\n\n  static open(...curves: GeoCurve[]): GeoPath {\n    return new GeoPath([new GeoSpline(curves, false)]);\n  }\n\n  static closed(...curves: GeoCurve[]): GeoPath {\n    return new GeoPath([new GeoSpline(curves, true)]);\n  }\n\n  static fromPoints(points: GeoSplinePoints): GeoPath {\n    return new GeoPath([GeoSpline.fromPoints(points)]);\n  }\n\n  static fromSplines(values: GeoPathSplines): GeoPath {\n    const n = values.length;\n    const splines = new Array<GeoSpline>(n);\n    for (let i = 0; i < n; i += 1) {\n      splines[i] = GeoSpline.fromAny(values[i]!);\n    }\n    return new GeoPath(splines);\n  }\n\n  static override fromAny(value: AnyGeoPath): GeoPath;\n  static override fromAny(value: AnyGeoShape): GeoShape;\n  static override fromAny(value: AnyGeoPath | AnyGeoShape): GeoShape {\n    if (value === void 0 || value === null || value instanceof GeoPath) {\n      return value;\n    } else if (GeoPath.isSplines(value)) {\n      return GeoPath.fromSplines(value);\n    } else if (GeoSpline.isAnySpline(value)) {\n      return GeoPath.of(GeoSpline.fromAny(value));\n    } else {\n      return GeoShape.fromAny(value);\n    }\n  }\n\n  static builder(): GeoPathBuilder {\n    return new GeoPathBuilder();\n  }\n\n  /** @internal */\n  static isSplines(value: unknown): value is GeoPathSplines {\n    return Array.isArray(value)\n        && value.length > 0\n        && GeoSpline.isAnySpline(value[0]!);\n  }\n\n  /** @internal */\n  static isAnyPath(value: unknown): value is AnyGeoPath {\n    return value instanceof GeoPath\n        || GeoPath.isSplines(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoSpline} from \"./GeoSpline\";\nimport {GeoSplineBuilder} from \"./GeoSplineBuilder\";\nimport type {GeoPathContext} from \"./GeoPathContext\";\nimport {GeoPath} from \"./GeoPath\";\n\n/** @public */\nexport class GeoPathBuilder implements GeoPathContext {\n  /** @internal */\n  splines: GeoSpline[];\n  /** @internal */\n  builder: GeoSplineBuilder | null;\n\n  constructor() {\n    this.splines = [];\n    this.builder = null;\n  }\n\n  moveTo(lng: number, lat: number): void {\n    let builder = this.builder;\n    if (builder !== null) {\n      const spline = builder.bind();\n      if (spline.isDefined()) {\n        this.splines.push(spline);\n      }\n    }\n    builder = new GeoSplineBuilder();\n    this.builder = builder;\n    builder.moveTo(lng, lat);\n  }\n\n  closePath(): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.closePath();\n    } else {\n      throw new Error();\n    }\n  }\n\n  lineTo(lng: number, lat: number): void {\n    const builder = this.builder;\n    if (builder !== null) {\n      builder.lineTo(lng, lat);\n    } else {\n      throw new Error();\n    }\n  }\n\n  bind(): GeoPath {\n    const splines = this.splines.slice(0);\n    const builder = this.builder;\n    if (builder !== null) {\n      const spline = builder.bind();\n      if (spline.isDefined()) {\n        splines.push(spline);\n      }\n    }\n    return new GeoPath(splines);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Lazy,\n  Equivalent,\n  HashCode,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport {R2Box} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {AnyGeoPoint, GeoPoint} from \"./GeoPoint\";\nimport {GeoSegment} from \"./GeoSegment\";\nimport {GeoTile} from \"./GeoTile\";\nimport {GeoBoxInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport type AnyGeoBox = GeoBox | GeoBoxInit;\n\n/** @public */\nexport interface GeoBoxInit {\n  lngMin: number;\n  latMin: number;\n  lngMax: number;\n  latMax: number;\n}\n\n/** @public */\nexport class GeoBox extends GeoShape implements Interpolate<GeoBox>, HashCode, Equivalent, Debug {\n  constructor(lngMin: number, latMin: number, lngMax: number, latMax: number) {\n    super();\n    this.lngMin = lngMin;\n    this.latMin = latMin;\n    this.lngMax = lngMax;\n    this.latMax = latMax;\n  }\n\n  isDefined(): boolean {\n    return isFinite(this.lngMin) && isFinite(this.latMin)\n        && isFinite(this.lngMax) && isFinite(this.latMax);\n  }\n\n  readonly lngMin: number;\n\n  readonly latMin: number;\n\n  readonly lngMax: number;\n\n  readonly latMax: number;\n\n  get west(): number {\n    return this.lngMin;\n  }\n\n  get south(): number {\n    return this.latMin;\n  }\n\n  get east(): number {\n    return this.lngMax;\n  }\n\n  get north(): number {\n    return this.latMax;\n  }\n\n  get southWest(): GeoPoint {\n    return new GeoPoint(this.lngMin, this.latMin);\n  }\n\n  get northWest(): GeoPoint {\n    return new GeoPoint(this.lngMin, this.latMax);\n  }\n\n  get southEast(): GeoPoint {\n    return new GeoPoint(this.lngMax, this.latMin);\n  }\n\n  get northEast(): GeoPoint {\n    return new GeoPoint(this.lngMax, this.latMax);\n  }\n\n  get center(): GeoPoint {\n    return new GeoPoint((this.lngMin + this.lngMax) / 2,\n                        (this.latMin + this.latMax) / 2);\n  }\n\n  override contains(that: AnyGeoPoint | AnyGeoBox): boolean;\n  override contains(lng: number, lat: number): boolean;\n  override contains(that: AnyGeoPoint | AnyGeoBox | number, y?: number): boolean {\n    if (typeof that === \"number\") {\n      return this.lngMin <= that && that <= this.lngMax\n          && this.latMin <= y! && y! <= this.latMax;\n    } else if (GeoPoint.isAny(that)) {\n      return this.containsPoint(GeoPoint.fromAny(that));\n    } else if (GeoSegment.isAny(that)) {\n      return this.containsSegment(GeoSegment.fromAny(that));\n    } else if (GeoTile.isAny(that)) {\n      return this.containsTile(GeoTile.fromAny(that));\n    } else if (GeoBox.isAny(that)) {\n      return this.containsBox(GeoBox.fromAny(that));\n    } else {\n      throw new TypeError(\"\" + that);\n    }\n  }\n\n  /** @internal */\n  containsPoint(that: GeoPoint): boolean {\n    return this.lngMin <= that.lng && that.lng <= this.lngMax\n        && this.latMin <= that.lat && that.lat <= this.latMax;\n  }\n\n  /** @internal */\n  containsSegment(that: GeoSegment): boolean {\n    return this.lngMin <= that.lng0 && that.lng0 <= this.lngMax\n        && this.latMin <= that.lat0 && that.lat0 <= this.latMax\n        && this.lngMin <= that.lng1 && that.lng1 <= this.lngMax\n        && this.latMin <= that.lat1 && that.lat1 <= this.latMax;\n  }\n\n  /** @internal */\n  containsTile(that: GeoTile): boolean {\n    return this.lngMin <= that.lngMin && that.lngMax <= this.lngMax\n        && this.latMin <= that.latMin && that.latMax <= this.latMax;\n  }\n\n  /** @internal */\n  containsBox(that: GeoBox): boolean {\n    return this.lngMin <= that.lngMin && that.lngMax <= this.lngMax\n        && this.latMin <= that.latMin && that.latMax <= this.latMax;\n  }\n\n  override intersects(that: AnyGeoPoint | AnyGeoBox): boolean {\n    if (GeoPoint.isAny(that)) {\n      return this.intersectsPoint(GeoPoint.fromAny(that));\n    } else if (GeoSegment.isAny(that)) {\n      return this.intersectsSegment(GeoSegment.fromAny(that));\n    } else if (GeoTile.isAny(that)) {\n      return this.intersectsTile(GeoTile.fromAny(that));\n    } else if (GeoBox.isAny(that)) {\n      return this.intersectsBox(GeoBox.fromAny(that));\n    } else {\n      throw new TypeError(\"\" + that);\n    }\n  }\n\n  /** @internal */\n  intersectsPoint(that: GeoPoint): boolean {\n    return this.lngMin <= that.lng && that.lng <= this.lngMax\n        && this.latMin <= that.lat && that.lat <= this.latMax;\n  }\n\n  /** @internal */\n  intersectsSegment(that: GeoSegment): boolean {\n    const lngMin = this.lngMin;\n    const latMin = this.latMin;\n    const lngMax = this.lngMax;\n    const latMax = this.latMax;\n    const lng0 = that.lng0;\n    const lat0 = that.lat0;\n    const lng1 = that.lng1;\n    const lat1 = that.lat1;\n    if (lng0 < lngMin && lng1 < lngMin || lng0 > lngMax && lng1 > lngMax ||\n        lat0 < latMin && lat1 < latMin || lat0 > latMax && lat1 > latMax) {\n      return false;\n    } else if (lng0 > lngMin && lng0 < lngMax && lat0 > latMin && lat0 < latMax) {\n      return true;\n    } else if ((R2Box.intersectsSegment(lng0 - lngMin, lng1 - lngMin, lng0, lat0, lng1, lat1) && R2Box.hitY > latMin && R2Box.hitY < latMax)\n            || (R2Box.intersectsSegment(lat0 - latMin, lat1 - latMin, lng0, lat0, lng1, lat1) && R2Box.hitX > lngMin && R2Box.hitX < lngMax)\n            || (R2Box.intersectsSegment(lng0 - lngMax, lng1 - lngMax, lng0, lat0, lng1, lat1) && R2Box.hitY > latMin && R2Box.hitY < latMax)\n            || (R2Box.intersectsSegment(lat0 - latMax, lat1 - latMax, lng0, lat0, lng1, lat1) && R2Box.hitX > lngMin && R2Box.hitX < lngMax)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @internal */\n  intersectsTile(that: GeoTile): boolean {\n    return this.lngMin <= that.lngMax && that.lngMin <= this.lngMax\n        && this.latMin <= that.latMax && that.latMin <= this.latMax;\n  }\n\n  /** @internal */\n  intersectsBox(that: GeoBox): boolean {\n    return this.lngMin <= that.lngMax && that.lngMin <= this.lngMax\n        && this.latMin <= that.latMax && that.latMin <= this.latMax;\n  }\n\n  override union(that: AnyGeoShape): GeoBox {\n    return super.union(that) as GeoBox;\n  }\n\n  override project(f: GeoProjection): R2Box {\n    const bottomLeft = f.project(this.lngMin, this.latMin);\n    const topRight = f.project(this.lngMax, this.latMax);\n    let xMin = bottomLeft.x;\n    let yMin = bottomLeft.y;\n    let xMax = topRight.x;\n    let yMax = topRight.y;\n    if (xMin > xMax) {\n      const x = xMin;\n      xMin = xMax;\n      xMax = x;\n    }\n    if (yMin > yMax) {\n      const y = yMin;\n      yMin = yMax;\n      yMax = y;\n    }\n    if (!isFinite(xMin)) {\n      xMin = -Infinity;\n    }\n    if (!isFinite(yMin)) {\n      yMin = -Infinity;\n    }\n    if (!isFinite(xMax)) {\n      xMax = Infinity;\n    }\n    if (!isFinite(yMax)) {\n      yMax = Infinity;\n    }\n    return new R2Box(xMin, yMin, xMax, yMax);\n  }\n\n  override get bounds(): GeoBox {\n    return this;\n  }\n\n  toAny(): GeoBoxInit {\n    return {\n      lngMin: this.lngMin,\n      latMin: this.latMin,\n      lngMax: this.lngMax,\n      latMax: this.latMax,\n    };\n  }\n\n  interpolateTo(that: GeoBox): Interpolator<GeoBox>;\n  interpolateTo(that: unknown): Interpolator<GeoBox> | null;\n  interpolateTo(that: unknown): Interpolator<GeoBox> | null {\n    if (that instanceof GeoBox) {\n      return GeoBoxInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoBox) {\n      return Numbers.equivalent(this.lngMin, that.lngMin, epsilon)\n          && Numbers.equivalent(this.latMin, that.latMin, epsilon)\n          && Numbers.equivalent(this.lngMax, that.lngMax, epsilon)\n          && Numbers.equivalent(this.latMax, that.latMax, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoBox) {\n      return this.lngMin === that.lngMin && this.latMin === that.latMin\n          && this.lngMax === that.lngMax && this.latMax === that.latMax;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(GeoBox), Numbers.hash(this.lngMin)), Numbers.hash(this.latMin)),\n        Numbers.hash(this.lngMax)), Numbers.hash(this.latMax)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"GeoBox\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.lngMin).write(\", \").debug(this.latMin).write(\", \")\n                   .debug(this.lngMax).write(\", \").debug(this.latMax).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static undefined(): GeoBox {\n    return new GeoBox(Infinity, Infinity, -Infinity, -Infinity);\n  }\n\n  @Lazy\n  static globe(): GeoBox {\n    return new GeoBox(-180, -90, 180, 90);\n  }\n\n  static of(lngMin: number, latMin: number, lngMax?: number, latMax?: number): GeoBox {\n    if (lngMax === void 0) {\n      lngMax = lngMin;\n    }\n    if (latMax === void 0) {\n      latMax = latMin;\n    }\n    return new GeoBox(lngMin, latMin, lngMax, latMax);\n  }\n\n  static fromInit(value: GeoBoxInit): GeoBox {\n    return new GeoBox(value.lngMin, value.latMin, value.lngMax, value.latMax);\n  }\n\n  static override fromAny(value: AnyGeoBox): GeoBox {\n    if (value === void 0 || value === null || value instanceof GeoBox) {\n      return value;\n    } else if (GeoBox.isInit(value)) {\n      return GeoBox.fromInit(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is GeoBoxInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as GeoBoxInit;\n      return typeof init.lngMin === \"number\"\n          && typeof init.latMin === \"number\"\n          && typeof init.lngMax === \"number\"\n          && typeof init.latMax === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyGeoBox {\n    return value instanceof GeoBox\n        || GeoBox.isInit(value);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equivalent, HashCode, Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport {R2Box} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {GeoPoint} from \"./GeoPoint\";\nimport {GeoBox} from \"./GeoBox\";\nimport {GeoSegment} from \"./GeoSegment\";\n\n/** @public */\nexport type AnyGeoTile = GeoTile | GeoTileInit | GeoTileTuple;\n\n/** @public */\nexport interface GeoTileInit {\n  x: number;\n  y: number;\n  z: number;\n}\n\n/** @public */\nexport type GeoTileTuple = [number, number, number];\n\n/** @public */\nexport class GeoTile extends GeoShape implements HashCode, Equivalent, Debug {\n  constructor(x: number, y: number, z: number) {\n    super();\n    this.x = x;\n    this.y = y;\n    this.z = z;\n  }\n\n  readonly x: number;\n\n  readonly y: number;\n\n  readonly z: number;\n\n  override get lngMin(): number {\n    return GeoTile.unprojectX(this.x / (1 << this.z));\n  }\n\n  override get latMin(): number {\n    return GeoTile.unprojectY(this.y / (1 << this.z));\n  }\n\n  override get lngMax(): number {\n    return GeoTile.unprojectX((this.x + 1) / (1 << this.z));\n  }\n\n  override get latMax(): number {\n    return GeoTile.unprojectY((this.y + 1) / (1 << this.z));\n  }\n\n  get west(): number {\n    return this.lngMin;\n  }\n\n  get south(): number {\n    return this.latMin;\n  }\n\n  get east(): number {\n    return this.lngMax;\n  }\n\n  get north(): number {\n    return this.latMax;\n  }\n\n  get southWest(): GeoPoint {\n    return new GeoPoint(this.lngMin, this.latMin);\n  }\n\n  get northWest(): GeoPoint {\n    return new GeoPoint(this.lngMin, this.latMax);\n  }\n\n  get southEast(): GeoPoint {\n    return new GeoPoint(this.lngMax, this.latMin);\n  }\n\n  get northEast(): GeoPoint {\n    return new GeoPoint(this.lngMax, this.latMax);\n  }\n\n  get center(): GeoPoint {\n    return new GeoPoint((this.lngMin + this.lngMax) / 2,\n                        (this.latMin + this.latMax) / 2);\n  }\n\n  get southWestTile(): GeoTile {\n    return new GeoTile(this.x * 2, this.y * 2, this.z + 1);\n  }\n\n  get northWestTile(): GeoTile {\n    return new GeoTile(this.x * 2, this.y * 2 + 1, this.z + 1);\n  }\n\n  get southEastTile(): GeoTile {\n    return new GeoTile(this.x * 2 + 1, this.y * 2, this.z + 1);\n  }\n\n  get northEastTile(): GeoTile {\n    return new GeoTile(this.x * 2 + 1, this.y * 2 + 1, this.z + 1);\n  }\n\n  get parentTile(): GeoTile {\n    return new GeoTile(this.x >> 1, this.y >> 1, this.z - 1);\n  }\n\n  override contains(that: AnyGeoShape): boolean;\n  override contains(lng: number, lat: number): boolean;\n  override contains(that: AnyGeoShape | number, lat?: number): boolean {\n    if (typeof that === \"number\") {\n      return this.lngMin <= that && that <= this.lngMax\n          && this.latMin <= lat! && lat! <= this.latMax;\n    } else if (GeoPoint.isAny(that)) {\n      return this.containsPoint(GeoPoint.fromAny(that));\n    } else if (GeoSegment.isAny(that)) {\n      return this.containsSegment(GeoSegment.fromAny(that));\n    } else if (GeoTile.isAny(that)) {\n      return this.containsTile(GeoTile.fromAny(that));\n    } else if (GeoBox.isAny(that)) {\n      return this.containsBox(GeoBox.fromAny(that));\n    } else {\n      throw new TypeError(\"\" + that);\n    }\n  }\n\n  /** @internal */\n  containsPoint(that: GeoPoint): boolean {\n    return this.lngMin <= that.lng && that.lng <= this.lngMax\n        && this.latMin <= that.lat && that.lat <= this.latMax;\n  }\n\n  /** @internal */\n  containsSegment(that: GeoSegment): boolean {\n    return this.lngMin <= that.lng0 && that.lng0 <= this.lngMax\n        && this.latMin <= that.lat0 && that.lat0 <= this.latMax\n        && this.lngMin <= that.lng1 && that.lng1 <= this.lngMax\n        && this.latMin <= that.lat1 && that.lat1 <= this.latMax;\n  }\n\n  /** @internal */\n  containsTile(that: GeoTile): boolean {\n    return this.lngMin <= that.lngMin && that.lngMax <= this.lngMax\n        && this.latMin <= that.latMin && that.latMax <= this.latMax;\n  }\n\n  /** @internal */\n  containsBox(that: GeoBox): boolean {\n    return this.lngMin <= that.lngMin && that.lngMax <= this.lngMax\n        && this.latMin <= that.latMin && that.latMax <= this.latMax;\n  }\n\n  override intersects(that: AnyGeoShape): boolean {\n    if (GeoPoint.isAny(that)) {\n      return this.intersectsPoint(GeoPoint.fromAny(that));\n    } else if (GeoSegment.isAny(that)) {\n      return this.intersectsSegment(GeoSegment.fromAny(that));\n    } else if (GeoTile.isAny(that)) {\n      return this.intersectsTile(GeoTile.fromAny(that));\n    } else if (GeoBox.isAny(that)) {\n      return this.intersectsBox(GeoBox.fromAny(that));\n    } else {\n      throw new TypeError(\"\" + that);\n    }\n  }\n\n  /** @internal */\n  intersectsPoint(that: GeoPoint): boolean {\n    return this.lngMin <= that.lng && that.lng <= this.lngMax\n        && this.latMin <= that.lat && that.lat <= this.latMax;\n  }\n\n  /** @internal */\n  intersectsSegment(that: GeoSegment): boolean {\n    const lngMin = this.lngMin;\n    const latMin = this.latMin;\n    const lngMax = this.lngMax;\n    const latMax = this.latMax;\n    const lng0 = that.lng0;\n    const lat0 = that.lat0;\n    const lng1 = that.lng1;\n    const lat1 = that.lat1;\n    if (lng0 < lngMin && lng1 < lngMin || lng0 > lngMax && lng1 > lngMax ||\n        lat0 < latMin && lat1 < latMin || lat0 > latMax && lat1 > latMax) {\n      return false;\n    } else if (lng0 > lngMin && lng0 < lngMax && lat0 > latMin && lat0 < latMax) {\n      return true;\n    } else if ((R2Box.intersectsSegment(lng0 - lngMin, lng1 - lngMin, lng0, lat0, lng1, lat1) && R2Box.hitY > latMin && R2Box.hitY < latMax)\n            || (R2Box.intersectsSegment(lat0 - latMin, lat1 - latMin, lng0, lat0, lng1, lat1) && R2Box.hitX > lngMin && R2Box.hitX < lngMax)\n            || (R2Box.intersectsSegment(lng0 - lngMax, lng1 - lngMax, lng0, lat0, lng1, lat1) && R2Box.hitY > latMin && R2Box.hitY < latMax)\n            || (R2Box.intersectsSegment(lat0 - latMax, lat1 - latMax, lng0, lat0, lng1, lat1) && R2Box.hitX > lngMin && R2Box.hitX < lngMax)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /** @internal */\n  intersectsTile(that: GeoTile): boolean {\n    return this.lngMin <= that.lngMax && that.lngMin <= this.lngMax\n        && this.latMin <= that.latMax && that.latMin <= this.latMax;\n  }\n\n  /** @internal */\n  intersectsBox(that: GeoBox): boolean {\n    return this.lngMin <= that.lngMax && that.lngMin <= this.lngMax\n        && this.latMin <= that.latMax && that.latMin <= this.latMax;\n  }\n\n  override project(f: GeoProjection): R2Box {\n    const bottomLeft = f.project(this.lngMin, this.latMin);\n    const topRight = f.project(this.lngMax, this.latMax);\n    let xMin = bottomLeft.x;\n    let yMin = bottomLeft.y;\n    let xMax = topRight.x;\n    let yMax = topRight.y;\n    if (xMin > xMax) {\n      const x = xMin;\n      xMin = xMax;\n      xMax = x;\n    }\n    if (yMin > yMax) {\n      const y = yMin;\n      yMin = yMax;\n      yMax = y;\n    }\n    if (!isFinite(xMin)) {\n      xMin = -Infinity;\n    }\n    if (!isFinite(yMin)) {\n      yMin = -Infinity;\n    }\n    if (!isFinite(xMax)) {\n      xMax = Infinity;\n    }\n    if (!isFinite(yMax)) {\n      yMax = Infinity;\n    }\n    return new R2Box(xMin, yMin, xMax, yMax);\n  }\n\n  toAny(): GeoTileInit {\n    return {\n      x: this.x,\n      y: this.y,\n      z: this.z,\n    };\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoTile) {\n      return Numbers.equivalent(this.x, that.x, epsilon)\n          && Numbers.equivalent(this.y, that.y, epsilon)\n          && Numbers.equivalent(this.z, that.z, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoTile) {\n      return this.x === that.x && this.y === that.y && this.z === that.z;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Constructors.hash(GeoTile),\n        Numbers.hash(this.x)), Numbers.hash(this.y)), Numbers.hash(this.z)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"GeoTile\").write(46/*'.'*/).write(\"of\").write(40/*'('*/)\n                   .debug(this.x).write(\", \").debug(this.y).write(\", \")\n                   .debug(this.z).write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static root(): GeoTile {\n    return new GeoTile(0, 0, 0);\n  }\n\n  static of(x: number, y: number, z: number): GeoTile {\n    return new GeoTile(x, y, z);\n  }\n\n  static fromInit(value: GeoTileInit): GeoTile {\n    return new GeoTile(value.x, value.y, value.z);\n  }\n\n  static fromTuple(value: GeoTileTuple): GeoTile {\n    return new GeoTile(value[0], value[1], value[2]);\n  }\n\n  static override fromAny(value: AnyGeoTile): GeoTile {\n    if (value === void 0 || value === null || value instanceof GeoTile) {\n      return value;\n    } else if (GeoTile.isInit(value)) {\n      return GeoTile.fromInit(value);\n    } else if (GeoTile.isTuple(value)) {\n      return GeoTile.fromTuple(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is GeoTileInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as GeoTileInit;\n      return typeof init.x === \"number\"\n          && typeof init.y === \"number\"\n          && typeof init.z === \"number\";\n    }\n    return false;\n  }\n\n  /** @internal */\n  static isTuple(value: unknown): value is GeoTileTuple {\n    return Array.isArray(value)\n        && value.length === 3\n        && typeof value[0] === \"number\"\n        && typeof value[1] === \"number\"\n        && typeof value[2] === \"number\";\n  }\n\n  /** @internal */\n  static override isAny(value: unknown): value is AnyGeoTile {\n    return value instanceof GeoTile\n        || GeoTile.isInit(value)\n        || GeoTile.isTuple(value);\n  }\n\n  /** @internal */\n  static unprojectX(x: number): number {\n    return (x * Math.PI * 2 - Math.PI) * (180 / Math.PI);\n  }\n\n  /** @internal */\n  static unprojectY(y: number): number {\n    return (Math.atan(Math.exp(y * Math.PI * 2 - Math.PI)) * 2 - Math.PI / 2) * (180 / Math.PI);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {GeoBox} from \"./GeoBox\";\n\n/** @internal */\nexport const GeoBoxInterpolator = (function (_super: typeof Interpolator) {\n  const GeoBoxInterpolator = function (s0: GeoBox, s1: GeoBox): Interpolator<GeoBox> {\n    const interpolator = function (u: number): GeoBox {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const lngMin = s0.lngMin + u * (s1.lngMin - s0.lngMin);\n      const latMin = s0.latMin + u * (s1.latMin - s0.latMin);\n      const lngMax = s0.lngMax + u * (s1.lngMax - s0.lngMax);\n      const latMax = s0.latMax + u * (s1.latMax - s0.latMax);\n      return new GeoBox(lngMin, latMin, lngMax, latMax);\n    } as Interpolator<GeoBox>;\n    Object.setPrototypeOf(interpolator, GeoBoxInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: GeoBox, s1: GeoBox): Interpolator<GeoBox>;\n\n    /** @internal */\n    prototype: Interpolator<GeoBox>;\n  };\n\n  GeoBoxInterpolator.prototype = Object.create(_super.prototype);\n  GeoBoxInterpolator.prototype.constructor = GeoBoxInterpolator;\n\n  return GeoBoxInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Equivalent, Equals, Mutable, Arrays} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport {R2Shape, R2Group} from \"@swim/math\";\nimport type {GeoProjection} from \"./GeoProjection\";\nimport {AnyGeoShape, GeoShape} from \"./GeoShape\";\nimport {GeoBox} from \"./GeoBox\";\n\n/** @public */\nexport class GeoGroup<S extends GeoShape = GeoShape> extends GeoShape implements Equals, Equivalent, Debug {\n  constructor(shapes: ReadonlyArray<S>) {\n    super();\n    this.shapes = shapes;\n    this.boundingBox = null;\n  }\n\n  isDefined(): boolean {\n    return this.shapes.length !== 0;\n  }\n\n  readonly shapes: ReadonlyArray<S>;\n\n  override get lngMin(): number {\n    return this.bounds.lngMin;\n  }\n\n  override get latMin(): number {\n    return this.bounds.latMin;\n  }\n\n  override get lngMax(): number {\n    return this.bounds.lngMax;\n  }\n\n  override get latMax(): number {\n    return this.bounds.latMax;\n  }\n\n  override contains(that: AnyGeoShape): boolean;\n  override contains(x: number, y: number): boolean;\n  override contains(that: AnyGeoShape | number, y?: number): boolean {\n    return false; // TODO\n  }\n\n  override intersects(that: AnyGeoShape): boolean {\n    return false; // TODO\n  }\n\n  override project(f: GeoProjection): R2Group {\n    const oldShapes = this.shapes;\n    const n = oldShapes.length;\n    if (n > 0) {\n      const newShapes = new Array<R2Shape>(n);\n      for (let i = 0; i < n; i += 1) {\n        newShapes[i] = oldShapes[i]!.project(f);\n      }\n      return new R2Group(newShapes);\n    } else {\n      return R2Group.empty();\n    }\n  }\n\n  /** @internal */\n  readonly boundingBox: GeoBox | null;\n\n  override get bounds(): GeoBox {\n    let boundingBox = this.boundingBox;\n    if (boundingBox === null) {\n      let lngMin = Infinity;\n      let latMin = Infinity;\n      let lngMax = -Infinity;\n      let latMax = -Infinity;\n      const shapes = this.shapes;\n      for (let i = 0, n = shapes.length; i < n; i += 1) {\n        const shape = shapes[i]!;\n        lngMin = Math.min(lngMin, shape.lngMin);\n        latMin = Math.min(latMin, shape.latMin);\n        lngMax = Math.max(shape.lngMax, lngMax);\n        latMax = Math.max(shape.latMax, latMax);\n      }\n      boundingBox = new GeoBox(lngMin, latMin, lngMax, latMax);\n      (this as Mutable<this>).boundingBox = boundingBox;\n    }\n    return boundingBox;\n  }\n\n  equivalentTo(that: unknown, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoGroup) {\n      return Arrays.equivalent(this.shapes, that.shapes, epsilon);\n    }\n    return false;\n  }\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof GeoGroup) {\n      return Arrays.equal(this.shapes, that.shapes);\n    }\n    return false;\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    const shapes = this.shapes;\n    const n = shapes.length;\n    output = output.write(\"GeoGroup\").write(46/*'.'*/);\n    if (n === 0) {\n      output = output.write(\"empty\").write(40/*'('*/);\n    } else {\n      output = output.write(\"of\").write(40/*'('*/);\n      output = output.debug(shapes[0]!);\n      for (let i = 1; i < n; i += 1) {\n        output = output.write(\", \").debug(shapes[i]!);\n      }\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static empty<S extends GeoShape>(): GeoGroup<S> {\n    return new GeoGroup(Arrays.empty);\n  }\n\n  static of<S extends GeoShape>(...shapes: S[]): GeoGroup<S> {\n    return new GeoGroup(shapes);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoShape} from \"../GeoShape\";\nimport type {GeoJsonBbox} from \"./GeoJsonBbox\";\nimport type {GeoJsonGeometryType} from \"./GeoJsonGeometry\";\nimport {GeoJsonGeometry} from \"./\"; // forward import\nimport {GeoJsonFeature} from \"./\"; // forward import\nimport {GeoJsonFeatureCollection} from \"./\"; // forward import\n\n/** @public */\nexport type GeoJsonType = GeoJsonGeometryType\n                        | \"Feature\"\n                        | \"FeatureCollection\";\n\n/** @public */\nexport interface GeoJsonObject {\n  type: GeoJsonType;\n  bbox?: GeoJsonBbox;\n}\n\n/** @public */\nexport type GeoJson = GeoJsonGeometry\n                    | GeoJsonFeature\n                    | GeoJsonFeatureCollection;\n\n/** @public */\nexport const GeoJson = (function () {\n  const GeoJson = {} as {\n    is(value: unknown): value is GeoJson;\n    toShape(geometry: GeoJsonGeometry): GeoShape;\n    toShape(feature: GeoJsonFeature): GeoShape | null;\n    toShape(collection: GeoJsonFeatureCollection): Array<GeoShape | null>;\n    toShape(object: GeoJson): GeoShape | null | Array<GeoShape | null>;\n  };\n\n  GeoJson.is = function (value: unknown): value is GeoJson {\n    return GeoJsonGeometry.is(value)\n        || GeoJsonFeature.is(value)\n        || GeoJsonFeatureCollection.is(value);\n  };\n\n  GeoJson.toShape = function (object: GeoJson): GeoShape | null | Array<GeoShape | null> {\n    if (object.type === \"Feature\") {\n      return GeoJsonFeature.toShape(object);\n    } else if (object.type === \"FeatureCollection\") {\n      return GeoJsonFeatureCollection.toShapes(object);\n    } else {\n      return GeoJsonGeometry.toShape(object);\n    }\n  } as typeof GeoJson.toShape;\n\n  return GeoJson;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoShape} from \"../GeoShape\";\nimport type {GeoJsonObject} from \"./GeoJson\";\nimport {GeoJsonPoint} from \"./\"; // forward import\nimport {GeoJsonMultiPoint} from \"./\"; // forward import\nimport {GeoJsonLineString} from \"./\"; // forward import\nimport {GeoJsonMultiLineString} from \"./\"; // forward import\nimport {GeoJsonPolygon} from \"./\"; // forward import\nimport {GeoJsonMultiPolygon} from \"./\"; // forward import\nimport {GeoJsonGeometryCollection} from \"./\"; // forward import\n\n/** @public */\nexport type GeoJsonGeometryType = \"Point\"\n                                | \"MultiPoint\"\n                                | \"LineString\"\n                                | \"MultiLineString\"\n                                | \"Polygon\"\n                                | \"MultiPolygon\"\n                                | \"GeometryCollection\";\n\n/** @public */\nexport interface GeoJsonGeometryObject extends GeoJsonObject {\n  type: GeoJsonGeometryType;\n}\n\n/** @public */\nexport type GeoJsonGeometry = GeoJsonPoint\n                            | GeoJsonMultiPoint\n                            | GeoJsonLineString\n                            | GeoJsonMultiLineString\n                            | GeoJsonPolygon\n                            | GeoJsonMultiPolygon\n                            | GeoJsonGeometryCollection;\n\n/** @public */\nexport const GeoJsonGeometry = (function () {\n  const GeoJsonGeometry = {} as {\n    is(value: unknown): value is GeoJsonGeometry;\n    toShape(object: GeoJsonGeometry): GeoShape;\n  };\n\n  GeoJsonGeometry.is = function (value: unknown): value is GeoJsonGeometry {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonGeometry;\n      return (object.type === \"Point\"\n           || object.type === \"MultiPoint\"\n           || object.type === \"LineString\"\n           || object.type === \"MultiLineString\"\n           || object.type === \"Polygon\"\n           || object.type === \"MultiPolygon\")\n          && Array.isArray(object.coordinates)\n          || object.type === \"GeometryCollection\"\n          && Array.isArray(object.geometries);\n    }\n    return false;\n  };\n\n  GeoJsonGeometry.toShape = function (object: GeoJsonGeometry): GeoShape {\n    if (object.type === \"Point\") {\n      return GeoJsonPoint.toShape(object);\n    } else if (object.type === \"MultiPoint\") {\n      return GeoJsonMultiPoint.toShape(object);\n    } else if (object.type === \"LineString\") {\n      return GeoJsonLineString.toShape(object);\n    } else if (object.type === \"MultiLineString\") {\n      return GeoJsonMultiLineString.toShape(object);\n    } else if (object.type === \"Polygon\") {\n      return GeoJsonPolygon.toShape(object);\n    } else if (object.type === \"MultiPolygon\") {\n      return GeoJsonMultiPolygon.toShape(object);\n    } else if (object.type === \"GeometryCollection\") {\n      return GeoJsonGeometryCollection.toShape(object);\n    } else {\n      throw new TypeError(\"\" + object);\n    }\n  };\n\n  return GeoJsonGeometry;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {GeoPoint} from \"../GeoPoint\";\nimport type {GeoJsonPosition} from \"./GeoJsonPosition\";\nimport type {GeoJsonGeometryObject} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonPoint extends GeoJsonGeometryObject {\n  readonly type: \"Point\";\n  coordinates: GeoJsonPosition;\n}\n\n/** @public */\nexport const GeoJsonPoint = (function () {\n  const GeoJsonPoint = {} as {\n    is(value: unknown): value is GeoJsonPoint;\n    toShape(object: GeoJsonPoint): GeoPoint;\n  };\n\n  GeoJsonPoint.is = function (value: unknown): value is GeoJsonPoint {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonPoint;\n      return object.type === \"Point\"\n          && Array.isArray(object.coordinates);\n    }\n    return false;\n  };\n\n  GeoJsonPoint.toShape = function (object: GeoJsonPoint): GeoPoint {\n    const position = object.coordinates;\n    return new GeoPoint(position[0], position[1]);\n  };\n\n  return GeoJsonPoint;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {GeoPoint} from \"../GeoPoint\";\nimport {GeoGroup} from \"../GeoGroup\";\nimport type {GeoJsonPosition} from \"./GeoJsonPosition\";\nimport type {GeoJsonGeometryObject} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonMultiPoint extends GeoJsonGeometryObject {\n  readonly type: \"MultiPoint\";\n  coordinates: GeoJsonPosition[];\n}\n\n/** @public */\nexport const GeoJsonMultiPoint = (function () {\n  const GeoJsonMultiPoint = {} as {\n    is(value: unknown): value is GeoJsonMultiPoint;\n    toShape(object: GeoJsonMultiPoint): GeoGroup<GeoPoint>;\n  };\n\n  GeoJsonMultiPoint.is = function (value: unknown): value is GeoJsonMultiPoint {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonMultiPoint;\n      return object.type === \"MultiPoint\"\n          && Array.isArray(object.coordinates);\n    }\n    return false;\n  };\n\n  GeoJsonMultiPoint.toShape = function (object: GeoJsonMultiPoint): GeoGroup<GeoPoint> {\n    const positions = object.coordinates;\n    const n = positions.length;\n    const shapes = new Array<GeoPoint>(n);\n    for (let i = 0; i < n; i += 1) {\n      const position = positions[i]!;\n      shapes[i] = new GeoPoint(position[0], position[1]);\n    }\n    return new GeoGroup(shapes);\n  };\n\n  return GeoJsonMultiPoint;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoCurve} from \"../GeoCurve\";\nimport {GeoSegment} from \"../GeoSegment\";\nimport {GeoSpline} from \"../GeoSpline\";\nimport type {GeoJsonPosition} from \"./GeoJsonPosition\";\nimport type {GeoJsonGeometryObject} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonLineString extends GeoJsonGeometryObject {\n  readonly type: \"LineString\";\n  coordinates: GeoJsonPosition[];\n}\n\n/** @public */\nexport const GeoJsonLineString = (function () {\n  const GeoJsonLineString = {} as {\n    is(value: unknown): value is GeoJsonLineString;\n    toShape(object: GeoJsonLineString): GeoSpline;\n  };\n\n  GeoJsonLineString.is = function (value: unknown): value is GeoJsonLineString {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonLineString;\n      return object.type === \"LineString\"\n          && Array.isArray(object.coordinates);\n    }\n    return false;\n  };\n\n  GeoJsonLineString.toShape = function (object: GeoJsonLineString): GeoSpline {\n    const lineString = object.coordinates;\n    const n = lineString.length;\n    if (n > 0) {\n      const curves = new Array<GeoCurve>(n - 1);\n      let position = lineString[0]!;\n      let lng = position[0];\n      let lat = position[1];\n      for (let i = 1; i < n; i += 1) {\n        position = lineString[i]!;\n        curves[i - 1] = new GeoSegment(lng, lat, (lng = position[0], lng), (lat = position[1], lat));\n      }\n      return new GeoSpline(curves, false);\n    } else {\n      return GeoSpline.empty();\n    }\n  };\n\n  return GeoJsonLineString;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoCurve} from \"../GeoCurve\";\nimport {GeoSegment} from \"../GeoSegment\";\nimport {GeoSpline} from \"../GeoSpline\";\nimport {GeoGroup} from \"../GeoGroup\";\nimport type {GeoJsonPosition} from \"./GeoJsonPosition\";\nimport type {GeoJsonGeometryObject} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonMultiLineString extends GeoJsonGeometryObject {\n  readonly type: \"MultiLineString\";\n  coordinates: GeoJsonPosition[][];\n}\n\n/** @public */\nexport const GeoJsonMultiLineString = (function () {\n  const GeoJsonMultiLineString = {} as {\n    is(value: unknown): value is GeoJsonMultiLineString;\n    toShape(object: GeoJsonMultiLineString): GeoGroup<GeoSpline>;\n  };\n\n  GeoJsonMultiLineString.is = function (value: unknown): value is GeoJsonMultiLineString {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonMultiLineString;\n      return object.type === \"MultiLineString\"\n          && Array.isArray(object.coordinates);\n    }\n    return false;\n  };\n\n  GeoJsonMultiLineString.toShape = function (object: GeoJsonMultiLineString): GeoGroup<GeoSpline> {\n    const multiLineString = object.coordinates;\n    const n = multiLineString.length;\n    const shapes = new Array<GeoSpline>(n);\n    for (let i = 0; i < n; i += 1) {\n      const lineString = multiLineString[i]!;\n      const m = lineString.length;\n      if (m > 0) {\n        const curves = new Array<GeoCurve>(m - 1);\n        let position = lineString[0]!;\n        let lng = position[0];\n        let lat = position[1];\n        for (let j = 1; j < m; j += 1) {\n          position = lineString[j]!;\n          curves[j - 1] = new GeoSegment(lng, lat, (lng = position[0], lng), (lat = position[1], lat));\n        }\n        shapes[i] = new GeoSpline(curves, false);\n      } else {\n        shapes[i] = GeoSpline.empty();\n      }\n    }\n    return new GeoGroup(shapes);\n  };\n\n  return GeoJsonMultiLineString;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoCurve} from \"../GeoCurve\";\nimport {GeoSegment} from \"../GeoSegment\";\nimport {GeoSpline} from \"../GeoSpline\";\nimport {GeoPath} from \"../GeoPath\";\nimport type {GeoJsonPosition} from \"./GeoJsonPosition\";\nimport type {GeoJsonGeometryObject} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonPolygon extends GeoJsonGeometryObject {\n  readonly type: \"Polygon\";\n  coordinates: GeoJsonPosition[][];\n}\n\n/** @public */\nexport const GeoJsonPolygon = (function () {\n  const GeoJsonPolygon = {} as {\n    is(value: unknown): value is GeoJsonPolygon;\n    toShape(object: GeoJsonPolygon): GeoPath;\n  };\n\n  GeoJsonPolygon.is = function (value: unknown): value is GeoJsonPolygon {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonPolygon;\n      return object.type === \"Polygon\"\n          && Array.isArray(object.coordinates);\n    }\n    return false;\n  };\n\n  GeoJsonPolygon.toShape = function (object: GeoJsonPolygon): GeoPath {\n    const polygons = object.coordinates;\n    const n = polygons.length;\n    const splines = new Array<GeoSpline>(n);\n    for (let i = 0; i < n; i += 1) {\n      const polygon = polygons[i]!;\n      const m = polygon.length;\n      if (m > 0) {\n        const curves = new Array<GeoCurve>(m - 1);\n        let position = polygon[0]!;\n        let lng = position[0];\n        let lat = position[1];\n        for (let j = 1; j < m; j += 1) {\n          position = polygon[j]!;\n          curves[j - 1] = new GeoSegment(lng, lat, (lng = position[0], lng), (lat = position[1], lat));\n        }\n        splines[i] = new GeoSpline(curves, true);\n      } else {\n        splines[i] = GeoSpline.empty();\n      }\n    }\n    return new GeoPath(splines);\n  };\n\n  return GeoJsonPolygon;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoCurve} from \"../GeoCurve\";\nimport {GeoSegment} from \"../GeoSegment\";\nimport {GeoSpline} from \"../GeoSpline\";\nimport {GeoPath} from \"../GeoPath\";\nimport {GeoGroup} from \"../GeoGroup\";\nimport type {GeoJsonPosition} from \"./GeoJsonPosition\";\nimport type {GeoJsonGeometryObject} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonMultiPolygon extends GeoJsonGeometryObject {\n  readonly type: \"MultiPolygon\";\n  coordinates: GeoJsonPosition[][][];\n}\n\n/** @public */\nexport const GeoJsonMultiPolygon = (function () {\n  const GeoJsonMultiPolygon = {} as {\n    is(value: unknown): value is GeoJsonMultiPolygon;\n    toShape(object: GeoJsonMultiPolygon): GeoGroup<GeoPath>;\n  };\n\n  GeoJsonMultiPolygon.is = function (value: unknown): value is GeoJsonMultiPolygon {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonMultiPolygon;\n      return object.type === \"MultiPolygon\"\n          && Array.isArray(object.coordinates);\n    }\n    return false;\n  };\n\n  GeoJsonMultiPolygon.toShape = function (object: GeoJsonMultiPolygon): GeoGroup<GeoPath> {\n    const multiPolygon = object.coordinates;\n    const n = multiPolygon.length;\n    const shapes = new Array<GeoPath>(n);\n    for (let i = 0; i < n; i += 1) {\n      const polygons = multiPolygon[i]!;\n      const m = polygons.length;\n      const splines = new Array<GeoSpline>(m);\n      for (let j = 0; j < m; j += 1) {\n        const polygon = polygons[j]!;\n        const o = polygon.length;\n        if (o > 0) {\n          const curves = new Array<GeoCurve>(o - 1);\n          let position = polygon[0]!;\n          let lng = position[0];\n          let lat = position[1];\n          for (let k = 1; k < o; k += 1) {\n            position = polygon[k]!;\n            curves[k - 1] = new GeoSegment(lng, lat, (lng = position[0], lng), (lat = position[1], lat));\n          }\n          splines[j] = new GeoSpline(curves, true);\n        } else {\n          splines[j] = GeoSpline.empty();\n        }\n      }\n      shapes[i] = new GeoPath(splines);\n    }\n    return new GeoGroup(shapes);\n  };\n\n  return GeoJsonMultiPolygon;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoShape} from \"../GeoShape\";\nimport {GeoGroup} from \"../GeoGroup\";\nimport {GeoJsonGeometryObject, GeoJsonGeometry} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport interface GeoJsonGeometryCollection extends GeoJsonGeometryObject {\n  readonly type: \"GeometryCollection\";\n  geometries: GeoJsonGeometry[];\n}\n\n/** @public */\nexport const GeoJsonGeometryCollection = (function () {\n  const GeoJsonGeometryCollection = {} as {\n    is(value: unknown): value is GeoJsonGeometryCollection;\n    toShape(object: GeoJsonGeometryCollection): GeoGroup;\n  };\n\n  GeoJsonGeometryCollection.is = function (value: unknown): value is GeoJsonGeometryCollection {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonGeometryCollection;\n      return object.type === \"GeometryCollection\"\n          && Array.isArray(object.geometries);\n    }\n    return false;\n  };\n\n  GeoJsonGeometryCollection.toShape = function (object: GeoJsonGeometryCollection): GeoGroup {\n    const geometries = object.geometries;\n    const n = geometries.length;\n    const shapes = new Array<GeoShape>(n);\n    for (let i = 0; i < n; i += 1) {\n      shapes[i] = GeoJsonGeometry.toShape(geometries[i]!);\n    }\n    return new GeoGroup(shapes);\n  };\n\n  return GeoJsonGeometryCollection;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoShape} from \"../GeoShape\";\nimport type {GeoJsonObject} from \"./GeoJson\";\nimport {GeoJsonGeometry} from \"./GeoJsonGeometry\";\n\n/** @public */\nexport type GeoJsonProperties = {[name: string]: unknown};\n\n/** @public */\nexport interface GeoJsonFeature<G extends GeoJsonGeometry = GeoJsonGeometry, P = GeoJsonProperties> extends GeoJsonObject {\n  type: \"Feature\";\n  geometry: G | null;\n  properties: P | null;\n  id?: string | number;\n}\n\n/** @public */\nexport const GeoJsonFeature = (function () {\n  const GeoJsonFeature = {} as {\n    is(value: unknown): value is GeoJsonFeature;\n    toShape(feature: GeoJsonFeature): GeoShape | null;\n  };\n\n  GeoJsonFeature.is = function (value: unknown): value is GeoJsonFeature {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonFeature;\n      return object.type === \"Feature\"\n          && GeoJsonGeometry.is(object.geometry)\n          && typeof object.properties === \"object\";\n    }\n    return false;\n  };\n\n  GeoJsonFeature.toShape = function (feature: GeoJsonFeature): GeoShape | null {\n    const geometry = feature.geometry;\n    return geometry !== null ? GeoJsonGeometry.toShape(geometry) : null;\n  };\n\n  return GeoJsonFeature;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {GeoShape} from \"../GeoShape\";\nimport type {GeoJsonObject} from \"./GeoJson\";\nimport type {GeoJsonGeometry} from \"./GeoJsonGeometry\";\nimport {GeoJsonProperties, GeoJsonFeature} from \"./GeoJsonFeature\";\n\n/** @public */\nexport interface GeoJsonFeatureCollection<G extends GeoJsonGeometry = GeoJsonGeometry, P = GeoJsonProperties> extends GeoJsonObject {\n  type: \"FeatureCollection\";\n  features: GeoJsonFeature<G, P>[];\n}\n\n/** @public */\nexport const GeoJsonFeatureCollection = (function () {\n  const GeoJsonFeatureCollection = {} as {\n    is(value: unknown): value is GeoJsonFeatureCollection;\n    toShapes(object: GeoJsonFeatureCollection): Array<GeoShape | null>;\n  };\n\n  GeoJsonFeatureCollection.is = function (value: unknown): value is GeoJsonFeatureCollection {\n    if (typeof value === \"object\" && value !== null) {\n      const object = value as GeoJsonFeatureCollection;\n      return object.type === \"FeatureCollection\"\n          && Array.isArray(object.features);\n    }\n    return false;\n  };\n\n  GeoJsonFeatureCollection.toShapes = function (object: GeoJsonFeatureCollection): Array<GeoShape | null> {\n    const features = object.features;\n    const n = features.length;\n    const shapes = new Array<GeoShape | null>(n);\n    for (let i = 0; i < n; i += 1) {\n      shapes[i] = GeoJsonFeature.toShape(features[i]!);\n    }\n    return shapes;\n  };\n\n  return GeoJsonFeatureCollection;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {HashCode, Lazy, Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport {Debug, Format, Output} from \"@swim/codec\";\nimport type {Value, Form} from \"@swim/structure\";\nimport {TimeZoneForm} from \"./\"; // forward import\n\n/** @public */\nexport type AnyTimeZone = TimeZone | string | number;\n\n/** @public */\nexport class TimeZone implements HashCode, Debug {\n  /** @internal */\n  private constructor(name: string | undefined, offset: number) {\n    this.name = name;\n    this.offset = offset;\n  }\n\n  readonly name: string | undefined;\n\n  readonly offset: number;\n\n  isUTC(): boolean {\n    return this.offset === 0;\n  }\n\n  isLocal(): boolean {\n    return this.offset === -new Date().getTimezoneOffset();\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TimeZone) {\n      return this.offset === that.offset;\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(TimeZone), Numbers.hash(this.offset)));\n  }\n\n  debug<T>(output: Output<T>): Output<T> {\n    output = output.write(\"TimeZone\").write(46/*'.'*/);\n    if (this.name === \"UTC\" && this.offset === 0) {\n      output = output.write(\"utc\").write(40/*'('*/);\n    } else if (this.name === void 0) {\n      output = output.write(\"forOffset\").write(40/*'('*/).debug(this.offset);\n    } else {\n      output = output.write(\"create\").write(40/*'('*/)\n                     .debug(this.name).write(\", \").debug(this.offset);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  @Lazy\n  static get utc(): TimeZone {\n    return new TimeZone(\"UTC\", 0);\n  }\n\n  @Lazy\n  static get local(): TimeZone {\n    return TimeZone.forOffset(-new Date().getTimezoneOffset());\n  }\n\n  static create(name: string | undefined, offset: number): TimeZone {\n    if (name === \"UTC\" && offset === 0) {\n      return TimeZone.utc;\n    } else {\n      return new TimeZone(name, offset);\n    }\n  }\n\n  static forName(name: string): TimeZone | null {\n    switch (name) {\n      case \"UTC\": return TimeZone.utc;\n      default: return null;\n    }\n  }\n\n  static forOffset(offset: number): TimeZone {\n    switch (offset) {\n      case 0: return TimeZone.utc;\n      default: return new TimeZone(void 0, offset);\n    }\n  }\n\n  static fromAny(value: AnyTimeZone): TimeZone {\n    if (value === void 0 || value === null || value instanceof TimeZone) {\n      return value;\n    } else if (typeof value === \"string\") {\n      const zone = TimeZone.forName(value);\n      if (zone !== null) {\n        return zone;\n      }\n    } else if (typeof value === \"number\") {\n      return TimeZone.forOffset(value);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromValue(value: Value): TimeZone | null {\n    const name = value.stringValue(void 0);\n    if (name !== void 0) {\n      return TimeZone.forName(name);\n    }\n    const offset = value.numberValue(void 0);\n    if (offset !== void 0) {\n      return TimeZone.forOffset(offset);\n    }\n    return null;\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyTimeZone {\n    return value instanceof TimeZone\n        || typeof value === \"string\"\n        || typeof value === \"number\";\n  }\n\n  @Lazy\n  static form(): Form<TimeZone, AnyTimeZone> {\n    return new TimeZoneForm(TimeZone.utc);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Text, Num, Form} from \"@swim/structure\";\nimport {AnyTimeZone, TimeZone} from \"./TimeZone\";\n\n/** @internal */\nexport class TimeZoneForm extends Form<TimeZone, AnyTimeZone> {\n  constructor(unit: TimeZone | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: TimeZone | undefined;\n\n  override withUnit(unit: TimeZone | undefined): Form<TimeZone, AnyTimeZone> {\n    if (unit !== this.unit) {\n      return new TimeZoneForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(zone: AnyTimeZone): Item {\n    zone = TimeZone.fromAny(zone);\n    const name = zone.name;\n    if (name !== void 0) {\n      return Text.from(name);\n    } else {\n      return Num.from(zone.offset);\n    }\n  }\n\n  override cast(item: Item): TimeZone | undefined {\n    const value = item.toValue();\n    const zone = TimeZone.fromValue(value);\n    return zone !== null ? zone : void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Lazy,\n  HashCode,\n  Equivalent,\n  Compare,\n  Murmur3,\n  Numbers,\n  Constructors,\n  Interpolate,\n  Interpolator,\n} from \"@swim/util\";\nimport type {Display, Output} from \"@swim/codec\";\nimport {Item, Value, Form} from \"@swim/structure\";\nimport {AnyTimeZone, TimeZone} from \"./TimeZone\";\nimport {DateTimeInterpolator} from \"./\"; // forward import\nimport {DateTimeForm} from \"./\"; // forward import\nimport {DateTimeFormat} from \"./\"; // forward import\n\n/** @public */\nexport type AnyDateTime = DateTime | DateTimeInit | Date | string | number;\n\n/** @public */\nexport interface DateTimeInit {\n  year?: number;\n  month?: number;\n  day?: number;\n  hour?: number;\n  minute?: number;\n  second?: number;\n  millisecond?: number;\n  zone?: AnyTimeZone;\n}\n\n/** @public */\nexport class DateTime implements Interpolate<DateTime>, HashCode, Equivalent, Compare, Display {\n  constructor(time: number, zone: TimeZone = TimeZone.utc) {\n    this.time = time;\n    this.zone = zone;\n  }\n\n  isDefined(): boolean {\n    return isFinite(new Date(this.time).getTime());\n  }\n\n  readonly time: number;\n\n  readonly zone: TimeZone;\n\n  get year(): number {\n    return this.toUTCLocalDate().getUTCFullYear();\n  }\n\n  withYear(year: number, month?: number, day?: number, hour?: number, minute?: number,\n           second?: number, millisecond?: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCFullYear(year);\n    if (month !== void 0) {\n      date.setUTCMonth(month);\n    }\n    if (day !== void 0) {\n      date.setUTCDate(day);\n    }\n    if (hour !== void 0) {\n      date.setUTCHours(hour);\n    }\n    if (minute !== void 0) {\n      date.setUTCMinutes(minute);\n    }\n    if (second !== void 0) {\n      date.setUTCSeconds(second);\n    }\n    if (millisecond !== void 0) {\n      date.setUTCMilliseconds(millisecond);\n    }\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get month(): number {\n    return this.toUTCLocalDate().getUTCMonth();\n  }\n\n  withMonth(month: number, day?: number, hour?: number, minute?: number,\n            second?: number, millisecond?: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCMonth(month);\n    if (day !== void 0) {\n      date.setUTCDate(day);\n    }\n    if (hour !== void 0) {\n      date.setUTCHours(hour);\n    }\n    if (minute !== void 0) {\n      date.setUTCMinutes(minute);\n    }\n    if (second !== void 0) {\n      date.setUTCSeconds(second);\n    }\n    if (millisecond !== void 0) {\n      date.setUTCMilliseconds(millisecond);\n    }\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get day(): number {\n    return this.toUTCLocalDate().getUTCDate();\n  }\n\n  withDay(day: number, hour?: number, minute?: number, second?: number,\n          millisecond?: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCDate(day);\n    if (hour !== void 0) {\n      date.setUTCHours(hour);\n    }\n    if (minute !== void 0) {\n      date.setUTCMinutes(minute);\n    }\n    if (second !== void 0) {\n      date.setUTCSeconds(second);\n    }\n    if (millisecond !== void 0) {\n      date.setUTCMilliseconds(millisecond);\n    }\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get hour(): number {\n    return this.toUTCLocalDate().getUTCHours();\n  }\n\n  withHour(hour: number, minute?: number, second?: number, millisecond?: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCHours(hour);\n    if (minute !== void 0) {\n      date.setUTCMinutes(minute);\n    }\n    if (second !== void 0) {\n      date.setUTCSeconds(second);\n    }\n    if (millisecond !== void 0) {\n      date.setUTCMilliseconds(millisecond);\n    }\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get minute(): number {\n    return this.toUTCLocalDate().getUTCMinutes();\n  }\n\n  withMinute(minute: number, second?: number, millisecond?: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCMinutes(minute);\n    if (second !== void 0) {\n      date.setUTCSeconds(second);\n    }\n    if (millisecond !== void 0) {\n      date.setUTCMilliseconds(millisecond);\n    }\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get second(): number {\n    return this.toUTCLocalDate().getUTCSeconds();\n  }\n\n  withSecond(second: number, millisecond?: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCSeconds(second);\n    if (millisecond !== void 0) {\n      date.setUTCMilliseconds(millisecond);\n    }\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get millisecond(): number {\n    return this.toUTCLocalDate().getUTCMilliseconds();\n  }\n\n  withMillisecond(millisecond: number): DateTime {\n    const date = this.toUTCLocalDate();\n    date.setUTCMilliseconds(millisecond);\n    return DateTime.fromUTCLocalDate(date, this.zone);\n  }\n\n  get weekday(): number {\n    return this.toUTCLocalDate().getUTCDay();\n  }\n\n  /**\n   * Returns this date time shifted by the time zone offset.\n   * @internal\n   */\n  toUTCLocalDate(): Date {\n    return new Date(this.time + 60000 * this.zone.offset);\n  }\n\n  toDate(): Date {\n    return new Date(this.time);\n  }\n\n  valueOf(): number {\n    return this.time;\n  }\n\n  interpolateTo(that: DateTime): Interpolator<DateTime>;\n  interpolateTo(that: unknown): Interpolator<DateTime> | null;\n  interpolateTo(that: unknown): Interpolator<DateTime> | null {\n    if (that instanceof DateTime) {\n      return DateTimeInterpolator(this, that);\n    } else {\n      return null;\n    }\n  }\n\n  compareTo(that: unknown): number {\n    if (that instanceof DateTime) {\n      const x = this.time;\n      const y = that.time;\n      return x < y ? -1 : x > y ? 1 : x === y ? 0 : NaN;\n    }\n    return NaN;\n  }\n\n  equivalentTo(that: AnyDateTime, epsilon?: number): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof DateTime) {\n      return Numbers.equivalent(this.time, that.time, epsilon);\n    }\n    return false;\n  }\n\n  equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof DateTime) {\n      return this.time === that.time && this.zone.equals(that.zone);\n    }\n    return false;\n  }\n\n  hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Constructors.hash(DateTime),\n        Numbers.hash(this.time)), this.zone.hashCode()));\n  }\n\n  display<T>(output: Output<T>, format: DateTimeFormat = DateTimeFormat.iso8601): Output<T> {\n    output = format.writeDate(output, this);\n    return output;\n  }\n\n  toString(format: DateTimeFormat = DateTimeFormat.iso8601): string {\n    return format.format(this);\n  }\n\n  static current(zone?: AnyTimeZone): DateTime {\n    zone = zone !== void 0 ? TimeZone.fromAny(zone) : TimeZone.local;\n    return new DateTime(Date.now(), zone);\n  }\n\n  /**\n   * Returns this date time shifted back by the time zone offset.\n   * @internal\n   */\n  static fromUTCLocalDate(date: Date, zone: TimeZone): DateTime {\n    return new DateTime(date.getTime() - 60000 * zone.offset, zone);\n  }\n\n  static fromInit(init: DateTimeInit, zone?: AnyTimeZone): DateTime {\n    let time = Date.UTC(init.year !== void 0 ? init.year : 1970,\n                        init.month !== void 0 ? init.month : 0,\n                        init.day !== void 0 ? init.day : 1,\n                        init.hour !== void 0 ? init.hour : 0,\n                        init.minute !== void 0 ? init.minute : 0,\n                        init.second !== void 0 ? init.second : 0,\n                        init.millisecond !== void 0 ? init.millisecond : 0);\n    if (init.zone !== void 0) {\n      zone = TimeZone.fromAny(init.zone);\n    }\n    if (zone !== void 0) {\n      zone = TimeZone.fromAny(zone);\n      time += 60000 * zone.offset;\n    } else {\n      zone = TimeZone.utc;\n    }\n    return new DateTime(time, zone);\n  }\n\n  static fromAny(value: AnyDateTime, zone?: AnyTimeZone): DateTime {\n    if (value === void 0 || value === null || value instanceof DateTime) {\n      return value;\n    } else if (value instanceof Date) {\n      zone = zone !== void 0 ? TimeZone.fromAny(zone) : TimeZone.utc;\n      return new DateTime(value.getTime(), zone);\n    } else if (typeof value === \"number\") {\n      zone = zone !== void 0 ? TimeZone.fromAny(zone) : TimeZone.utc;\n      return new DateTime(value, zone);\n    } else if (typeof value === \"string\") {\n      return DateTime.parse(value, zone);\n    } else if (DateTime.isInit(value)) {\n      return DateTime.fromInit(value, zone);\n    }\n    throw new TypeError(\"\" + value);\n  }\n\n  static fromValue(value: Value): DateTime | null {\n    let positional: boolean;\n    const header = value.header(\"date\");\n    if (header.isDefined()) {\n      value = header;\n      positional = true;\n    } else {\n      positional = false;\n    }\n    const init: DateTimeInit = {};\n    value.forEach(function (item: Item, index: number) {\n      const key = item.key.stringValue(void 0);\n      if (key !== void 0) {\n        if (key === \"year\") {\n          init.year = item.toValue().numberValue(init.year);\n        } else if (key === \"month\") {\n          init.month = item.toValue().numberValue(init.month);\n        } else if (key === \"day\") {\n          init.day = item.toValue().numberValue(init.day);\n        } else if (key === \"hour\") {\n          init.hour = item.toValue().numberValue(init.hour);\n        } else if (key === \"minute\") {\n          init.minute = item.toValue().numberValue(init.minute);\n        } else if (key === \"second\") {\n          init.second = item.toValue().numberValue(init.second);\n        } else if (key === \"millisecond\") {\n          init.millisecond = item.toValue().numberValue(init.millisecond);\n        } else if (key === \"zone\") {\n          init.zone = item.toValue().cast(TimeZone.form(), init.zone);\n        }\n      } else if (item instanceof Value && positional) {\n        if (index === 0) {\n          init.year = item.numberValue(init.year);\n        } else if (index === 1) {\n          init.month = item.numberValue(init.month);\n        } else if (index === 2) {\n          init.day = item.numberValue(init.day);\n        } else if (index === 3) {\n          init.hour = item.numberValue(init.hour);\n        } else if (index === 4) {\n          init.minute = item.numberValue(init.minute);\n        } else if (index === 5) {\n          init.second = item.numberValue(init.second);\n        } else if (index === 6) {\n          init.millisecond = item.numberValue(init.millisecond);\n        } else if (index === 7) {\n          init.zone = item.cast(TimeZone.form(), init.zone);\n        }\n      }\n    });\n    if (DateTime.isInit(init)) {\n      return DateTime.fromInit(init);\n    }\n    return null;\n  }\n\n  static parse(date: string, zone?: AnyTimeZone): DateTime {\n    return DateTimeFormat.iso8601.parse(date);\n  }\n\n  static time(date: AnyDateTime): number {\n    if (date instanceof DateTime) {\n      return date.time;\n    } else if (date instanceof Date) {\n      return date.getTime();\n    } else if (typeof date === \"number\") {\n      return date;\n    } else if (typeof date === \"string\") {\n      return DateTime.parse(date).time;\n    } else if (DateTime.isInit(date)) {\n      return DateTime.fromInit(date).time;\n    }\n    throw new TypeError(\"\" + date);\n  }\n\n  static zone(date: AnyDateTime): TimeZone {\n    if (date instanceof DateTime) {\n      return date.zone;\n    } else {\n      return TimeZone.utc;\n    }\n  }\n\n  /** @internal */\n  static isInit(value: unknown): value is DateTimeInit {\n    if (typeof value === \"object\" && value !== null) {\n      const init = value as DateTimeInit;\n      return (typeof init.year === \"undefined\" || typeof init.year === \"number\")\n          && (typeof init.month === \"undefined\" || typeof init.month === \"number\")\n          && (typeof init.day === \"undefined\" || typeof init.day === \"number\")\n          && (typeof init.hour === \"undefined\" || typeof init.hour === \"number\")\n          && (typeof init.minute === \"undefined\" || typeof init.minute === \"number\")\n          && (typeof init.second === \"undefined\" || typeof init.second === \"number\")\n          && (typeof init.millisecond === \"undefined\" || typeof init.millisecond === \"number\")\n          && (typeof init.zone === \"undefined\" || TimeZone.isAny(init.zone))\n          && (typeof init.year === \"number\"\n           || typeof init.month === \"number\"\n           || typeof init.day === \"number\"\n           || typeof init.hour === \"number\"\n           || typeof init.minute === \"number\"\n           || typeof init.second === \"number\"\n           || typeof init.millisecond === \"number\");\n    }\n    return false;\n  }\n\n  /** @internal */\n  static isAny(value: unknown): value is AnyDateTime {\n    return value instanceof DateTime\n        || value instanceof Date\n        || typeof value === \"number\"\n        || typeof value === \"string\"\n        || DateTime.isInit(value);\n  }\n\n  @Lazy\n  static form(): Form<DateTime, AnyDateTime> {\n    return new DateTimeForm(new DateTime(0));\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {DateTime} from \"./DateTime\";\n\n/** @internal */\nexport const DateTimeInterpolator = (function (_super: typeof Interpolator) {\n  const DateTimeInterpolator = function (d0: DateTime, d1: DateTime): Interpolator<DateTime> {\n    const interpolator = function (u: number): DateTime {\n      const d0 = interpolator[0];\n      const d1 = interpolator[1];\n      return new DateTime(d0.time + u * (d1.time - d0.time), d1.zone);\n    } as Interpolator<DateTime>;\n    Object.setPrototypeOf(interpolator, DateTimeInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = d0;\n    (interpolator as Mutable<typeof interpolator>)[1] = d1;\n    return interpolator;\n  } as {\n    (d0: DateTime, d1: DateTime): Interpolator<DateTime>;\n\n    /** @internal */\n    prototype: Interpolator<DateTime>;\n  };\n\n  DateTimeInterpolator.prototype = Object.create(_super.prototype);\n  DateTimeInterpolator.prototype.constructor = DateTimeInterpolator;\n\n  return DateTimeInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"./DateTime\";\nimport {Item, Value, Text, Form} from \"@swim/structure\";\n\n/** @internal */\nexport class DateTimeForm extends Form<DateTime, AnyDateTime> {\n  constructor(unit: DateTime | undefined) {\n    super();\n    Object.defineProperty(this, \"unit\", {\n      value: unit,\n      enumerable: true,\n    });\n  }\n\n  override readonly unit!: DateTime | undefined;\n\n  override withUnit(unit: DateTime | undefined): Form<DateTime, AnyDateTime> {\n    if (unit !== this.unit) {\n      return new DateTimeForm(unit);\n    } else {\n      return this;\n    }\n  }\n\n  override mold(date: AnyDateTime): Item {\n    date = DateTime.fromAny(date);\n    return Text.from(date.toString());\n  }\n\n  override cast(value: Value): DateTime | undefined {\n    let date: DateTime | null = null;\n    try {\n      date = DateTime.fromValue(value);\n      if (date === void 0) {\n        const millis = value.numberValue(void 0);\n        if (millis !== void 0) {\n          date = new DateTime(millis);\n        } else {\n          const string = value.stringValue(void 0);\n          if (string !== void 0) {\n            date = DateTime.parse(string);\n          }\n        }\n      }\n    } catch (e) {\n      // swallow\n    }\n    return date !== null ? date : void 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport {DateTimeInit, DateTime} from \"./DateTime\";\n\n/** @internal */\nexport class DateTimeParser extends Parser<DateTime> {\n  private readonly dateParser: Parser<DateTimeInit>;\n\n  constructor(dateParser: Parser<DateTimeInit>) {\n    super();\n    this.dateParser = dateParser;\n  }\n\n  override feed(input: Input): Parser<DateTime> {\n    return DateTimeParser.parse(input, this.dateParser);\n  }\n\n  static parse(input: Input, dateParser: Parser<DateTimeInit>): Parser<DateTime> {\n    dateParser = dateParser.feed(input);\n    if (dateParser.isDone()) {\n      return Parser.done(DateTime.fromAny(dateParser.bind()));\n    } else if (dateParser.isError()) {\n      return dateParser.asError();\n    }\n    return new DateTimeParser(dateParser);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\n\n/** @public */\nexport class DateTimeLocale {\n  readonly periods: ReadonlyArray<string>;\n  readonly weekdays: ReadonlyArray<string>;\n  readonly shortWeekdays: ReadonlyArray<string>;\n  readonly months: ReadonlyArray<string>;\n  readonly shortMonths: ReadonlyArray<string>;\n\n  constructor(periods: ReadonlyArray<string> = DateTimeLocale.Periods,\n              weekdays: ReadonlyArray<string> = DateTimeLocale.Weekdays,\n              shortWeekdays: ReadonlyArray<string> = DateTimeLocale.ShortWeekdays,\n              months: ReadonlyArray<string> = DateTimeLocale.Months,\n              shortMonths: ReadonlyArray<string> = DateTimeLocale.ShortMonths) {\n    this.periods = periods;\n    this.weekdays = weekdays;\n    this.shortWeekdays = shortWeekdays;\n    this.months = months;\n    this.shortMonths = shortMonths;\n  }\n\n  @Lazy\n  static standard(): DateTimeLocale {\n    return new DateTimeLocale();\n  }\n\n  private static readonly Periods: ReadonlyArray<string> = [\n    \"AM\",\n    \"PM\",\n  ];\n  private static readonly Weekdays: ReadonlyArray<string> = [\n    \"Sunday\",\n    \"Monday\",\n    \"Tuesday\",\n    \"Wednesday\",\n    \"Thursday\",\n    \"Friday\",\n    \"Saturday\",\n  ];\n  private static readonly ShortWeekdays: ReadonlyArray<string> = [\n    \"Sun\",\n    \"Mon\",\n    \"Tue\",\n    \"Wed\",\n    \"Thu\",\n    \"Fri\",\n    \"Sat\",\n  ];\n  private static readonly Months: ReadonlyArray<string> = [\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n  ];\n  private static readonly ShortMonths: ReadonlyArray<string> = [\n    \"Jan\",\n    \"Feb\",\n    \"Mar\",\n    \"Apr\",\n    \"May\",\n    \"Jun\",\n    \"Jul\",\n    \"Aug\",\n    \"Sep\",\n    \"Oct\",\n    \"Nov\",\n    \"Dec\",\n  ];\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"../\"; // forward import\n\n/** @public */\nexport interface DateTimeSpecifiers {\n  [symbol: string]: DateTimeFormat | undefined;\n  Y: DateTimeFormat;\n  m: DateTimeFormat;\n  B: DateTimeFormat;\n  b: DateTimeFormat;\n  d: DateTimeFormat;\n  A: DateTimeFormat;\n  a: DateTimeFormat;\n  H: DateTimeFormat;\n  I: DateTimeFormat;\n  p: DateTimeFormat;\n  M: DateTimeFormat;\n  S: DateTimeFormat;\n  L: DateTimeFormat;\n}\n\n/** @public */\nexport const DateTimeSpecifiers = (function () {\n  const DateTimeSpecifiers = {} as {\n    standard(locale?: DateTimeLocale): DateTimeSpecifiers;\n  };\n\n  let standard: DateTimeSpecifiers | null = null;\n\n  DateTimeSpecifiers.standard = function (locale?: DateTimeLocale): DateTimeSpecifiers {\n    let specifiers: DateTimeSpecifiers | null = null;\n    if (locale === void 0) {\n      locale = DateTimeLocale.standard();\n    }\n    if (locale === DateTimeLocale.standard()) {\n      specifiers = standard;\n    }\n    if (specifiers === null) {\n      specifiers = {\n        Y: DateTimeFormat.year,\n        m: DateTimeFormat.monthOfYear,\n        B: DateTimeFormat.month.withLocale(locale),\n        b: DateTimeFormat.shortMonth.withLocale(locale),\n        d: DateTimeFormat.dayOfMonth,\n        A: DateTimeFormat.weekday.withLocale(locale),\n        a: DateTimeFormat.shortWeekday.withLocale(locale),\n        H: DateTimeFormat.hour24,\n        I: DateTimeFormat.hour12,\n        p: DateTimeFormat.period.withLocale(locale),\n        M: DateTimeFormat.minute,\n        S: DateTimeFormat.second,\n        L: DateTimeFormat.millisecond,\n      };\n      if (locale === DateTimeLocale.standard()) {\n        standard = specifiers;\n      }\n    }\n    return specifiers;\n  };\n\n  return DateTimeSpecifiers;\n})();\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {Input, Output, Parser, Diagnostic, Unicode, Base10} from \"@swim/codec\";\nimport {AnyDateTime, DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeParser} from \"../DateTimeParser\";\nimport {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeSpecifiers} from \"./DateTimeSpecifiers\";\nimport {YearFormat} from \"../\"; // forward import\nimport {MonthOfYearFormat} from \"../\"; // forward import\nimport {MonthFormat} from \"../\"; // forward import\nimport {ShortMonthFormat} from \"../\"; // forward import\nimport {DayOfMonthFormat} from \"../\"; // forward import\nimport {WeekdayFormat} from \"../\"; // forward import\nimport {ShortWeekdayFormat} from \"../\"; // forward import\nimport {Hour24Format} from \"../\"; // forward import\nimport {Hour12Format} from \"../\"; // forward import\nimport {PeriodFormat} from \"../\"; // forward import\nimport {MinuteFormat} from \"../\"; // forward import\nimport {SecondFormat} from \"../\"; // forward import\nimport {MillisecondFormat} from \"../\"; // forward import\nimport {PatternFormat} from \"../\"; // forward import\n\n/** @internal */\nexport interface DateNumberFactory {\n  term(value: number, date: DateTimeInit, input: Input): Parser<DateTimeInit>;\n  cont(date: DateTimeInit, value: number, step: number, input: Input): Parser<DateTimeInit>;\n}\n\n/** @internal */\nexport interface DateStringFactory {\n  term(locale: DateTimeLocale, value: string, date: DateTimeInit, input: Input): Parser<DateTimeInit>;\n  cont(locale: DateTimeLocale, date: DateTimeInit, output: Output, input: Input): Parser<DateTimeInit>;\n}\n\n/** @public */\nexport abstract class DateTimeFormat {\n  withLocale(locale: DateTimeLocale): DateTimeFormat {\n    return this;\n  }\n\n  format(date: AnyDateTime): string {\n    date = DateTime.fromAny(date);\n    let output = Unicode.stringOutput();\n    output = this.writeDate(output, date as DateTime);\n    return output.bind();\n  }\n\n  abstract writeDate<T>(output: Output<T>, date: DateTime): Output<T>;\n\n  parse(input: Input | string): DateTime {\n    if (typeof input === \"string\") {\n      input = Unicode.stringInput(input);\n    }\n    while (input.isCont() && Unicode.isSpace(input.head())) {\n      input = input.step();\n    }\n    let parser = this.parseDate(input, {});\n    if (parser.isDone()) {\n      while (input.isCont() && Unicode.isSpace(input.head())) {\n        input = input.step();\n      }\n    }\n    if (input.isCont() && !parser.isError()) {\n      parser = Parser.error(Diagnostic.unexpected(input));\n    }\n    return parser.bind();\n  }\n\n  /** @internal */\n  parseDate(input: Input, date: DateTimeInit): Parser<DateTime> {\n    const dateParser = this.parseDateTime(input, date);\n    if (dateParser.isDone()) {\n      return Parser.done(DateTime.fromAny(dateParser.bind()));\n    } else if (dateParser.isError()) {\n      return dateParser.asError();\n    }\n    return new DateTimeParser(dateParser);\n  }\n\n  /** @internal */\n  abstract parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit>;\n\n  @Lazy\n  static get year(): DateTimeFormat {\n    return new YearFormat();\n  }\n\n  @Lazy\n  static get monthOfYear(): DateTimeFormat {\n    return new MonthOfYearFormat();\n  }\n\n  @Lazy\n  static get month(): DateTimeFormat {\n    return new MonthFormat(DateTimeLocale.standard());\n  }\n\n  @Lazy\n  static get shortMonth(): DateTimeFormat {\n    return new ShortMonthFormat(DateTimeLocale.standard());\n  }\n\n  @Lazy\n  static get dayOfMonth(): DateTimeFormat {\n    return new DayOfMonthFormat();\n  }\n\n  @Lazy\n  static get weekday(): DateTimeFormat {\n    return new WeekdayFormat(DateTimeLocale.standard());\n  }\n\n  @Lazy\n  static get shortWeekday(): DateTimeFormat {\n    return new ShortWeekdayFormat(DateTimeLocale.standard());\n  }\n\n  @Lazy\n  static get hour24(): DateTimeFormat {\n    return new Hour24Format();\n  }\n\n  @Lazy\n  static get hour12(): DateTimeFormat {\n    return new Hour12Format();\n  }\n\n  @Lazy\n  static get period(): DateTimeFormat {\n    return new PeriodFormat(DateTimeLocale.standard());\n  }\n\n  @Lazy\n  static get minute(): DateTimeFormat {\n    return new MinuteFormat();\n  }\n\n  @Lazy\n  static get second(): DateTimeFormat {\n    return new SecondFormat();\n  }\n\n  @Lazy\n  static get millisecond(): DateTimeFormat {\n    return new MillisecondFormat();\n  }\n\n  static pattern(pattern: string, specifiers?: DateTimeSpecifiers | DateTimeLocale): DateTimeFormat {\n    if (specifiers === void 0 || specifiers instanceof DateTimeLocale) {\n      specifiers = DateTimeSpecifiers.standard(specifiers);\n    }\n    return new PatternFormat(pattern, specifiers);\n  }\n\n  @Lazy\n  static get iso8601(): DateTimeFormat {\n    return new PatternFormat(\"%Y-%m-%dT%H:%M:%S.%LZ\", DateTimeSpecifiers.standard());\n  }\n\n  /** @internal */\n  static parseDateNumber(input: Input, factory: DateNumberFactory, desc: string,\n                         minDigits: number, maxDigits: number, date: DateTimeInit | undefined,\n                         value: number = 0, step: number = 0): Parser<DateTimeInit> {\n    let c = 0;\n    while (step < maxDigits) {\n      if (input.isCont() && (c = input.head(), Base10.isDigit(c))) {\n        input.step();\n        value = 10 * value + Base10.decodeDigit(c);\n        step += 1;\n        continue;\n      }\n      break;\n    }\n    if (!input.isEmpty()) {\n      if (step >= minDigits) {\n        return factory.term(value, date || {}, input);\n      } else {\n        return Parser.error(Diagnostic.expected(desc, input));\n      }\n    }\n    return factory.cont(date !== void 0 ? date : {}, value, step, input);\n  }\n\n  /** @internal */\n  static parseDateString(input: Input, factory: DateStringFactory, locale: DateTimeLocale,\n                         date?: DateTimeInit, output?: Output<string>): Parser<DateTimeInit> {\n    let c = 0;\n    output = output !== void 0 ? output : Unicode.stringOutput();\n    do {\n      if (input.isCont() && (c = input.head(), Unicode.isAlpha(c))) {\n        input.step();\n        output.write(c);\n        continue;\n      } else if (!input.isEmpty()) {\n        return factory.term(locale, output.bind(), date !== void 0 ? date : {}, input);\n      }\n      break;\n    } while (true);\n    return factory.cont(locale, date !== void 0 ? date : {}, output, input);\n  }\n\n  /** @internal */\n  static writeDateNumber2<T>(output: Output<T>, value: number): Output<T> {\n    const c1 = 48/*'0'*/ + value % 10;\n    value /= 10;\n    const c0 = 48/*'0'*/ + value % 10;\n    output = output.write(c0).write(c1);\n    return output;\n  }\n\n  /** @internal */\n  static writeDateNumber3<T>(output: Output<T>, value: number): Output<T> {\n    const c2 = 48/*'0'*/ + value % 10;\n    value /= 10;\n    const c1 = 48/*'0'*/ + value % 10;\n    value /= 10;\n    const c0 = 48/*'0'*/ + value % 10;\n    output = output.write(c0).write(c1).write(c2);\n    return output;\n  }\n\n  /** @internal */\n  static writeDateNumber4<T>(output: Output<T>, value: number): Output<T> {\n    const c3 = 48/*'0'*/ + value % 10;\n    value /= 10;\n    const c2 = 48/*'0'*/ + value % 10;\n    value /= 10;\n    const c1 = 48/*'0'*/ + value % 10;\n    value /= 10;\n    const c0 = 48/*'0'*/ + value % 10;\n    output = output.write(c0).write(c1).write(c2).write(c3);\n    return output;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {YearParser} from \"../\"; // forward import\n\n/** @internal */\nexport class YearFormat extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber4(output, date.year);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return YearParser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {MonthOfYearParser} from \"../\"; // forward import\n\n/** @internal */\nexport class MonthOfYearFormat extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber2(output, date.month + 1);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return MonthOfYearParser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {MonthParser} from \"../\"; // forward import\n\n/** @internal */\nexport class MonthFormat extends DateTimeFormat {\n  private readonly locale: DateTimeLocale;\n\n  constructor(locale: DateTimeLocale) {\n    super();\n    this.locale = locale;\n  }\n\n  override withLocale(locale: DateTimeLocale): DateTimeFormat {\n    if (locale !== this.locale) {\n      return new MonthFormat(locale);\n    } else {\n      return this;\n    }\n  }\n\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = output.write(this.locale.months[date.month]!);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return MonthParser.parse(input, this.locale, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {ShortMonthParser} from \"../\"; // forward import\n\n/** @internal */\nexport class ShortMonthFormat extends DateTimeFormat {\n  private readonly locale: DateTimeLocale;\n\n  constructor(locale: DateTimeLocale) {\n    super();\n    this.locale = locale;\n  }\n\n  override withLocale(locale: DateTimeLocale): DateTimeFormat {\n    if (locale !== this.locale) {\n      return new ShortMonthFormat(locale);\n    } else {\n      return this;\n    }\n  }\n\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = output.write(this.locale.shortMonths[date.month]!);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return ShortMonthParser.parse(input, this.locale, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {DayOfMonthParser} from \"../\"; // forward import\n\n/** @internal */\nexport class DayOfMonthFormat extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber2(output, date.day);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return DayOfMonthParser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {WeekdayParser} from \"../\"; // forward import\n\n/** @internal */\nexport class WeekdayFormat extends DateTimeFormat {\n  private readonly locale: DateTimeLocale;\n\n  constructor(locale: DateTimeLocale) {\n    super();\n    this.locale = locale;\n  }\n\n  override withLocale(locale: DateTimeLocale): DateTimeFormat {\n    if (locale !== this.locale) {\n      return new WeekdayFormat(locale);\n    } else {\n      return this;\n    }\n  }\n\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = output.write(this.locale.weekdays[date.weekday]!);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return WeekdayParser.parse(input, this.locale, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {ShortWeekdayParser} from \"../\"; // forward import\n\n/** @internal */\nexport class ShortWeekdayFormat extends DateTimeFormat {\n  private readonly locale: DateTimeLocale;\n\n  constructor(locale: DateTimeLocale) {\n    super();\n    this.locale = locale;\n  }\n\n  override withLocale(locale: DateTimeLocale): DateTimeFormat {\n    if (locale !== this.locale) {\n      return new ShortWeekdayFormat(locale);\n    } else {\n      return this;\n    }\n  }\n\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = output.write(this.locale.shortWeekdays[date.weekday]!);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return ShortWeekdayParser.parse(input, this.locale, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {Hour24Parser} from \"../\"; // forward import\n\n/** @internal */\nexport class Hour24Format extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber2(output, date.hour);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return Hour24Parser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {Hour12Parser} from \"../\"; // forward import\n\n/** @internal */\nexport class Hour12Format extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    let hour = date.hour % 12;\n    if (hour === 0) {\n      hour = 12;\n    }\n    output = DateTimeFormat.writeDateNumber2(output, hour);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return Hour12Parser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {PeriodParser} from \"../\"; // forward import\n\n/** @internal */\nexport class PeriodFormat extends DateTimeFormat {\n  private readonly locale: DateTimeLocale;\n\n  constructor(locale: DateTimeLocale) {\n    super();\n    this.locale = locale;\n  }\n\n  override withLocale(locale: DateTimeLocale): DateTimeFormat {\n    if (locale !== this.locale) {\n      return new PeriodFormat(locale);\n    } else {\n      return this;\n    }\n  }\n\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = output.write(this.locale.periods[date.hour >= 12 ? 1 : 0]!);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return PeriodParser.parse(input, this.locale, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {MinuteParser} from \"../\"; // forward import\n\n/** @internal */\nexport class MinuteFormat extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber2(output, date.minute);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return MinuteParser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {SecondParser} from \"../\"; // forward import\n\n/** @internal */\nexport class SecondFormat extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber2(output, date.second);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return SecondParser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {MillisecondParser} from \"../\"; // forward import\n\n/** @internal */\nexport class MillisecondFormat extends DateTimeFormat {\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    output = DateTimeFormat.writeDateNumber3(output, date.millisecond);\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return MillisecondParser.parse(input, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Input, Output, Parser} from \"@swim/codec\";\nimport type {DateTimeInit, DateTime} from \"../DateTime\";\nimport type {DateTimeSpecifiers} from \"./DateTimeSpecifiers\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\nimport {PatternParser} from \"../\"; // forward import\n\n/** @internal */\nexport class PatternFormat extends DateTimeFormat {\n  private readonly pattern: string;\n  private readonly specifiers: DateTimeSpecifiers;\n\n  constructor(pattern: string, specifiers: DateTimeSpecifiers) {\n    super();\n    this.pattern = pattern;\n    this.specifiers = specifiers;\n  }\n\n  override writeDate<T>(output: Output<T>, date: DateTime): Output<T> {\n    const pattern = this.pattern;\n    const specifiers = this.specifiers;\n    let i = 0;\n    let j = 0;\n    const n = pattern.length;\n    while (j < n) {\n      if (pattern.charCodeAt(j) === 37/*'%'*/) {\n        if (i !== j) {\n          output = output.write(pattern.slice(i, j));\n        }\n        const s = pattern.charAt(j + 1);\n        const f = specifiers[s];\n        if (f !== void 0) {\n          output = f.writeDate(output, date);\n        }\n        j += 2;\n        i = j;\n      } else {\n        j += 1;\n      }\n    }\n    if (i !== j) {\n      output = output.write(pattern.slice(i, j));\n    }\n    return output;\n  }\n\n  override parseDateTime(input: Input, date: DateTimeInit): Parser<DateTimeInit> {\n    return PatternParser.parse(input, this.pattern, this.specifiers, date);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class YearParser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly year: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, year?: number, step?: number) {\n    super();\n    this.date = date;\n    this.year = year;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return YearParser.parse(input, this.date, this.year, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, year?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, YearParser, \"full year\", 4, 4, date, year, step);\n  }\n\n  static term(year: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.year = year;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, year: number, step: number): Parser<DateTimeInit> {\n    return new YearParser(date, year, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class MonthOfYearParser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly month: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, month?: number, step?: number) {\n    super();\n    this.date = date;\n    this.month = month;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return MonthOfYearParser.parse(input, this.date, this.month, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, month?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, MonthOfYearParser, \"month number\", 2, 2, date, month, step);\n  }\n\n  static term(month: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.month = month - 1;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, month: number, step: number): Parser<DateTimeInit> {\n    return new MonthOfYearParser(date, month, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class MonthParser extends Parser<DateTimeInit> {\n  private readonly locale: DateTimeLocale;\n  private readonly date: DateTimeInit | undefined;\n  private readonly output: Output<string> | undefined;\n\n  constructor(locale: DateTimeLocale, date?: DateTimeInit, output?: Output<string>) {\n    super();\n    this.locale = locale;\n    this.date = date;\n    this.output = output;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return MonthParser.parse(input, this.locale, this.date, this.output);\n  }\n\n  static parse(input: Input, locale: DateTimeLocale, date?: DateTimeInit,\n               output?: Output<string>): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateString(input, MonthParser, locale, date, output);\n  }\n\n  static term(locale: DateTimeLocale, value: string, date: DateTimeInit, input: Input): Parser<DateTimeInit> {\n    const month = locale.months.indexOf(value);\n    if (month >= 0) {\n      date.month = month;\n      return Parser.done(date);\n    } else {\n      return Parser.error(Diagnostic.message(\"expected month, but found \" + value, input));\n    }\n  }\n\n  static cont(locale: DateTimeLocale, date: DateTimeInit, output: Output<string>): Parser<DateTimeInit> {\n    return new MonthParser(locale, date, output);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class ShortMonthParser extends Parser<DateTimeInit> {\n  private readonly locale: DateTimeLocale;\n  private readonly date: DateTimeInit | undefined;\n  private readonly output: Output<string> | undefined;\n\n  constructor(locale: DateTimeLocale, date?: DateTimeInit, output?: Output<string>) {\n    super();\n    this.locale = locale;\n    this.date = date;\n    this.output = output;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return ShortMonthParser.parse(input, this.locale, this.date, this.output);\n  }\n\n  static parse(input: Input, locale: DateTimeLocale, date?: DateTimeInit,\n               output?: Output<string>): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateString(input, ShortMonthParser, locale, date, output);\n  }\n\n  static term(locale: DateTimeLocale, value: string, date: DateTimeInit, input: Input): Parser<DateTimeInit> {\n    const month = locale.shortMonths.indexOf(value);\n    if (month >= 0) {\n      date.month = month;\n      return Parser.done(date);\n    } else {\n      return Parser.error(Diagnostic.message(\"expected short month, but found \" + value, input));\n    }\n  }\n\n  static cont(locale: DateTimeLocale, date: DateTimeInit, output: Output<string>): Parser<DateTimeInit> {\n    return new ShortMonthParser(locale, date, output);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class DayOfMonthParser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly day: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, day?: number, step?: number) {\n    super();\n    this.date = date;\n    this.day = day;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return DayOfMonthParser.parse(input, this.date, this.day, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, day?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, DayOfMonthParser, \"day of month\", 2, 2, date, day, step);\n  }\n\n  static term(day: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.day = day;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, month: number, step: number): Parser<DateTimeInit> {\n    return new DayOfMonthParser(date, month, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class WeekdayParser extends Parser<DateTimeInit> {\n  private readonly locale: DateTimeLocale;\n  private readonly date: DateTimeInit | undefined;\n  private readonly output: Output<string> | undefined;\n\n  constructor(locale: DateTimeLocale, date?: DateTimeInit, output?: Output<string>) {\n    super();\n    this.locale = locale;\n    this.date = date;\n    this.output = output;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return WeekdayParser.parse(input, this.locale, this.date, this.output);\n  }\n\n  static parse(input: Input, locale: DateTimeLocale, date?: DateTimeInit,\n               output?: Output<string>): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateString(input, WeekdayParser, locale, date, output);\n  }\n\n  static term(locale: DateTimeLocale, value: string, date: DateTimeInit, input: Input): Parser<DateTimeInit> {\n    const day = locale.weekdays.indexOf(value);\n    if (day >= 0) {\n      return Parser.done(date);\n    } else {\n      return Parser.error(Diagnostic.message(\"expected weekday, but found \" + value, input));\n    }\n  }\n\n  static cont(locale: DateTimeLocale, date: DateTimeInit, output: Output<string>): Parser<DateTimeInit> {\n    return new WeekdayParser(locale, date, output);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class ShortWeekdayParser extends Parser<DateTimeInit> {\n  private readonly locale: DateTimeLocale;\n  private readonly date: DateTimeInit | undefined;\n  private readonly output: Output<string> | undefined;\n\n  constructor(locale: DateTimeLocale, date?: DateTimeInit, output?: Output<string>) {\n    super();\n    this.locale = locale;\n    this.date = date;\n    this.output = output;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return ShortWeekdayParser.parse(input, this.locale, this.date, this.output);\n  }\n\n  static parse(input: Input, locale: DateTimeLocale, date?: DateTimeInit,\n               output?: Output<string>): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateString(input, ShortWeekdayParser, locale, date, output);\n  }\n\n  static term(locale: DateTimeLocale, value: string, date: DateTimeInit, input: Input): Parser<DateTimeInit> {\n    const day = locale.shortWeekdays.indexOf(value);\n    if (day >= 0) {\n      // nop\n      return Parser.done(date);\n    } else {\n      return Parser.error(Diagnostic.message(\"expected short weekday, but found \" + value, input));\n    }\n  }\n\n  static cont(locale: DateTimeLocale, date: DateTimeInit, output: Output<string>): Parser<DateTimeInit> {\n    return new ShortWeekdayParser(locale, date, output);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class Hour24Parser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly hour: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, hour?: number, step?: number) {\n    super();\n    this.date = date;\n    this.hour = hour;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return Hour24Parser.parse(input, this.date, this.hour, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, hour?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, Hour24Parser, \"hour (24)\", 2, 2, date, hour, step);\n  }\n\n  static term(hour: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.hour = hour;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, hour: number, step: number): Parser<DateTimeInit> {\n    return new Hour24Parser(date, hour, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class Hour12Parser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly hour: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, hour?: number, step?: number) {\n    super();\n    this.date = date;\n    this.hour = hour;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return Hour12Parser.parse(input, this.date, this.hour, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, hour?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, Hour12Parser, \"hour (12)\", 2, 2, date, hour, step);\n  }\n\n  static term(hour: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.hour = (date.hour !== void 0 ? date.hour : 0) + hour;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, hour: number, step: number): Parser<DateTimeInit> {\n    return new Hour12Parser(date, hour, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Output, Parser, Diagnostic} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport type {DateTimeLocale} from \"./DateTimeLocale\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class PeriodParser extends Parser<DateTimeInit> {\n  private readonly locale: DateTimeLocale;\n  private readonly date: DateTimeInit | undefined;\n  private readonly output: Output<string> | undefined;\n\n  constructor(locale: DateTimeLocale, date?: DateTimeInit, output?: Output<string>) {\n    super();\n    this.locale = locale;\n    this.date = date;\n    this.output = output;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return PeriodParser.parse(input, this.locale, this.date, this.output);\n  }\n\n  static parse(input: Input, locale: DateTimeLocale, date?: DateTimeInit,\n               output?: Output<string>): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateString(input, PeriodParser, locale, date, output);\n  }\n\n  static term(locale: DateTimeLocale, value: string, date: DateTimeInit, input: Input): Parser<DateTimeInit> {\n    const period = locale.months.indexOf(value);\n    if (period >= 0) {\n      date.hour = (date.hour || 0) + 12 * period;\n      return Parser.done(date);\n    } else {\n      return Parser.error(Diagnostic.message(\"expected period of day, but found \" + value, input));\n    }\n  }\n\n  static cont(locale: DateTimeLocale, date: DateTimeInit, output: Output<string>): Parser<DateTimeInit> {\n    return new PeriodParser(locale, date, output);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class MinuteParser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly minute: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, minute?: number, step?: number) {\n    super();\n    this.date = date;\n    this.minute = minute;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return MinuteParser.parse(input, this.date, this.minute, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, minute?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, MinuteParser, \"minute\", 2, 2, date, minute, step);\n  }\n\n  static term(minute: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.minute = minute;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, minute: number, step: number): Parser<DateTimeInit> {\n    return new MinuteParser(date, minute, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class SecondParser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly second: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, second?: number, step?: number) {\n    super();\n    this.date = date;\n    this.second = second;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return SecondParser.parse(input, this.date, this.second, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, second?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, SecondParser, \"second\", 2, 2, date, second, step);\n  }\n\n  static term(second: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.second = second;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, second: number, step: number): Parser<DateTimeInit> {\n    return new SecondParser(date, second, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport {DateTimeFormat} from \"./DateTimeFormat\";\n\n/** @internal */\nexport class MillisecondParser extends Parser<DateTimeInit> {\n  private readonly date: DateTimeInit | undefined;\n  private readonly millisecond: number | undefined;\n  private readonly step: number | undefined;\n\n  constructor(date?: DateTimeInit, millisecond?: number, step?: number) {\n    super();\n    this.date = date;\n    this.millisecond = millisecond;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return MillisecondParser.parse(input, this.date, this.millisecond, this.step);\n  }\n\n  static parse(input: Input, date?: DateTimeInit, millisecond?: number, step?: number): Parser<DateTimeInit> {\n    return DateTimeFormat.parseDateNumber(input, MillisecondParser, \"millisecond\", 1, 3, date, millisecond, step);\n  }\n\n  static term(millisecond: number, date: DateTimeInit): Parser<DateTimeInit> {\n    date.millisecond = millisecond;\n    return Parser.done(date);\n  }\n\n  static cont(date: DateTimeInit, millisecond: number, step: number): Parser<DateTimeInit> {\n    return new MillisecondParser(date, millisecond, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Input, Parser, Diagnostic} from \"@swim/codec\";\nimport type {DateTimeInit} from \"../DateTime\";\nimport type {DateTimeSpecifiers} from \"./DateTimeSpecifiers\";\n\n/** @internal */\nexport class PatternParser extends Parser<DateTimeInit> {\n  private readonly pattern: string;\n  private readonly specifiers: DateTimeSpecifiers;\n  private readonly date: DateTimeInit | undefined;\n  private readonly dateParser: Parser<DateTimeInit> | undefined;\n  private readonly step: number | undefined;\n\n  constructor(pattern: string, specifiers: DateTimeSpecifiers, date?: DateTimeInit,\n              dateParser?: Parser<DateTimeInit>, step?: number) {\n    super();\n    this.pattern = pattern;\n    this.specifiers = specifiers;\n    this.date = date;\n    this.dateParser = dateParser;\n    this.step = step;\n  }\n\n  override feed(input: Input): Parser<DateTimeInit> {\n    return PatternParser.parse(input, this.pattern, this.specifiers, this.date,\n                                     this.dateParser, this.step);\n  }\n\n  static parse(input: Input, pattern: string, specifiers: DateTimeSpecifiers,\n               date: DateTimeInit = {}, dateParser?: Parser<DateTimeInit>,\n               step: number = 0): Parser<DateTimeInit> {\n    let c = 0;\n    const n = pattern.length;\n    while (step < n) {\n      const p = pattern.charCodeAt(step);\n      if (p === 37/*'%'*/) {\n        if (dateParser === void 0) {\n          const s = pattern.charAt(step + 1);\n          const format = specifiers[s];\n          if (format !== void 0) {\n            dateParser = format.parseDateTime(input, date);\n          } else {\n            return Parser.error(Diagnostic.message(\"unknown format specifier: \" + s, input));\n          }\n        } else {\n          dateParser = dateParser.feed(input);\n        }\n        if (dateParser.isDone()) {\n          date = dateParser.bind();\n          dateParser = void 0;\n          step += 2;\n          continue;\n        } else if (dateParser.isError()) {\n          return dateParser.asError();\n        }\n      } else if (input.isCont()) {\n        c = input.head();\n        if (c === p) {\n          input.step();\n          step += 1;\n          continue;\n        } else {\n          return Parser.error(Diagnostic.expected(p, input));\n        }\n      } else if (!input.isEmpty()) {\n        return Parser.error(Diagnostic.unexpected(input));\n      }\n      break;\n    }\n    if (step === n) {\n      return Parser.done(date);\n    }\n    return new PatternParser(pattern, specifiers, date, dateParser, step);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy} from \"@swim/util\";\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {FilterTimeInterval} from \"../\"; // forward import\nimport {YearInterval} from \"../\"; // forward import\nimport {MonthInterval} from \"../\"; // forward import\nimport {WeekInterval} from \"../\"; // forward import\nimport {DayInterval} from \"../\"; // forward import\nimport {HourInterval} from \"../\"; // forward import\nimport {MinuteInterval} from \"../\"; // forward import\nimport {SecondInterval} from \"../\"; // forward import\nimport {MillisecondInterval} from \"../\"; // forward import\n\n/** @public */\nexport abstract class TimeInterval {\n  abstract offset(d: AnyDateTime, k?: number): DateTime;\n\n  next(d: AnyDateTime, k?: number): DateTime {\n    return this.floor(this.offset(d, k));\n  }\n\n  abstract floor(d: AnyDateTime): DateTime;\n\n  ceil(d: AnyDateTime): DateTime {\n    if (d instanceof DateTime) {\n      d = new DateTime(d.time - 1, d.zone);\n    } else {\n      d = DateTime.time(d) - 1;\n    }\n    return this.next(this.floor(d), 1);\n  }\n\n  round(t: AnyDateTime): DateTime {\n    const d = DateTime.fromAny(t);\n    const d0 = this.floor(d);\n    const d1 = this.ceil(d);\n    return d.time - d0.time < d1.time - d.time ? d0 : d1;\n  }\n\n  range(t0: AnyDateTime, t1: AnyDateTime, step?: number): DateTime[] {\n    let d0 = this.ceil(t0);\n    const d1 = DateTime.time(t1);\n    const ds: DateTime[] = [];\n    step = typeof step === \"number\" ? Math.floor(step) : 1;\n    if (step > 0) {\n      while (d0.isDefined() && d0.time < d1) {\n        ds.push(d0);\n        d0 = this.next(d0, step);\n      }\n    }\n    return ds;\n  }\n\n  filter(predicate: (d: DateTime) => boolean): TimeInterval {\n    return new FilterTimeInterval(this, predicate);\n  }\n\n  @Lazy\n  static get year(): UnitTimeInterval {\n    return new YearInterval();\n  }\n\n  @Lazy\n  static get month(): UnitTimeInterval {\n    return new MonthInterval();\n  }\n\n  @Lazy\n  static get week(): TimeInterval {\n    return new WeekInterval();\n  }\n\n  @Lazy\n  static get day(): UnitTimeInterval {\n    return new DayInterval();\n  }\n\n  @Lazy\n  static get hour(): UnitTimeInterval {\n    return new HourInterval();\n  }\n\n  @Lazy\n  static get minute(): UnitTimeInterval {\n    return new MinuteInterval();\n  }\n\n  @Lazy\n  static get second(): UnitTimeInterval {\n    return new SecondInterval();\n  }\n\n  @Lazy\n  static get millisecond(): UnitTimeInterval {\n    return new MillisecondInterval();\n  }\n\n  static years(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.year.range(d0, d1, step);\n  }\n\n  static months(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.month.range(d0, d1, step);\n  }\n\n  static weeks(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.week.range(d0, d1, step);\n  }\n\n  static days(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.day.range(d0, d1, step);\n  }\n\n  static hours(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.hour.range(d0, d1, step);\n  }\n\n  static minutes(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.minute.range(d0, d1, step);\n  }\n\n  static seconds(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.second.range(d0, d1, step);\n  }\n\n  static milliseconds(d0: AnyDateTime, d1: AnyDateTime, step?: number): DateTime[] {\n    return TimeInterval.millisecond.range(d0, d1, step);\n  }\n\n  /** @internal */\n  static readonly MillisPerSecond: number = 1000;\n  /** @internal */\n  static readonly MillisPerMinute: number = 60 * TimeInterval.MillisPerSecond;\n  /** @internal */\n  static readonly MillisPerHour: number = 60 * TimeInterval.MillisPerMinute;\n}\n\n/** @public */\nexport abstract class UnitTimeInterval extends TimeInterval {\n  abstract every(k: number): TimeInterval;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {TimeInterval} from \"./TimeInterval\";\n\n/** @internal */\nexport class FilterTimeInterval extends TimeInterval {\n  private readonly unit: TimeInterval;\n  private readonly predicate: (d: DateTime) => boolean;\n\n  constructor(unit: TimeInterval, predicate: (d: DateTime) => boolean) {\n    super();\n    this.unit = unit;\n    this.predicate = predicate;\n  }\n\n  override offset(t: AnyDateTime, k?: number): DateTime {\n    let d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    while (k < 0) {\n      do {\n        d = this.unit.offset(d, -1);\n      } while (d.isDefined() && !this.predicate(d));\n      k += 1;\n    }\n    while (k > 0) {\n      do {\n        d = this.unit.offset(d, 1);\n      } while (d.isDefined() && !this.predicate(d));\n      k -= 1;\n    }\n    return d;\n  }\n\n  override floor(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    while (d = this.unit.floor(d), d.isDefined() && !this.predicate(d)) {\n      d = new DateTime(d.time - 1, d.zone);\n    }\n    return d;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {YearsInterval} from \"../\"; // forward import\n\n/** @internal */\nexport class YearInterval extends UnitTimeInterval {\n  override offset(t: AnyDateTime, k?: number): DateTime {\n    let d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d = d.withYear(d.year + k);\n    return d;\n  }\n\n  override next(t: AnyDateTime, k?: number): DateTime {\n    const d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    return d.withYear(d.year + k).withMonth(0, 1).withHour(0, 0, 0, 0);\n  }\n\n  override floor(t: AnyDateTime): DateTime {\n    const d = DateTime.fromAny(t);\n    return d.withMonth(0, 1).withHour(0, 0, 0, 0);\n  }\n\n  override ceil(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = new DateTime(d.time - 1, d.zone);\n    d = d.withMonth(0, 1).withHour(0, 0, 0, 0);\n    d = d.withYear(d.year + 1);\n    return d.withMonth(0, 1).withHour(0, 0, 0, 0);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new YearsInterval(k);\n    } else {\n      throw new Error(\"\" + k);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {TimeInterval} from \"./TimeInterval\";\n\n/** @internal */\nexport class YearsInterval extends TimeInterval {\n  private readonly stride: number;\n\n  constructor(stride: number) {\n    super();\n    this.stride = stride;\n  }\n\n  override offset(t: AnyDateTime, k?: number): DateTime {\n    const d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    return d.withYear(d.year + k * this.stride);\n  }\n\n  override next(t: AnyDateTime, k?: number): DateTime {\n    let d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d = d.withYear(Math.floor((d.year + k * this.stride) / this.stride) * this.stride);\n    return d.withMonth(0, 1).withHour(0, 0, 0, 0);\n  }\n\n  override floor(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = d.withYear(Math.floor(d.year / this.stride) * this.stride);\n    return d.withMonth(0, 1).withHour(0, 0, 0, 0);\n  }\n\n  override ceil(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = new DateTime(d.time - 1, d.zone);\n    d = d.withYear(Math.floor(d.year / this.stride) * this.stride);\n    d = d.withMonth(0, 1).withHour(0, 0, 0, 0);\n    d = d.withYear(Math.floor((d.year + this.stride) / this.stride) * this.stride);\n    return d.withMonth(0, 1).withHour(0, 0, 0, 0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {FilterTimeInterval} from \"./FilterTimeInterval\";\n\n/** @internal */\nexport class MonthInterval extends UnitTimeInterval {\n  override offset(t: AnyDateTime, k?: number): DateTime {\n    const d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    return d.withMonth(d.month + k);\n  }\n\n  override next(t: AnyDateTime, k?: number): DateTime {\n    let d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d = d.withMonth(d.month + k);\n    return d.withDay(1).withHour(0, 0, 0, 0);\n  }\n\n  override floor(t: AnyDateTime): DateTime {\n    const d = DateTime.fromAny(t);\n    return d.withDay(1).withHour(0, 0, 0, 0);\n  }\n\n  override ceil(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = new DateTime(d.time - 1, d.zone);\n    d = d.withDay(1).withHour(0, 0, 0, 0);\n    d = d.withMonth(d.month + 1);\n    return d.withDay(1).withHour(0, 0, 0, 0);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new FilterTimeInterval(this, MonthInterval.modulo.bind(void 0, k));\n    } else {\n      throw new Error(\"\" + k);\n    }\n  }\n\n  /** @internal */\n  static modulo(k: number, d: DateTime): boolean {\n    const month = d.month;\n    return isFinite(month) && month % k === 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {TimeInterval} from \"./TimeInterval\";\n\n/** @internal */\nexport class WeekInterval extends TimeInterval {\n  readonly day: number;\n\n  constructor(day: number = 0) {\n    super();\n    this.day = day;\n  }\n\n  override offset(t: AnyDateTime, k?: number): DateTime {\n    const d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    return d.withDay(d.day + 7 * k);\n  }\n\n  override next(t: AnyDateTime, k?: number): DateTime {\n    let d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d = d.withDay(d.day + 7 * k);\n    d = d.withDay(d.day - (d.weekday + 7 - this.day) % 7);\n    return d.withHour(0, 0, 0, 0);\n  }\n\n  override floor(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = d.withDay(d.day - (d.weekday + 7 - this.day) % 7);\n    return d.withHour(0, 0, 0, 0);\n  }\n\n  override ceil(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = new DateTime(d.time - 1, d.zone);\n    d = d.withDay(d.day - (d.weekday + 7 - this.day) % 7);\n    d = d.withHour(0, 0, 0, 0);\n    d = d.withDay(d.day + 7);\n    return d.withHour(0, 0, 0, 0);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {FilterTimeInterval} from \"./FilterTimeInterval\";\n\n/** @internal */\nexport class DayInterval extends UnitTimeInterval {\n  override offset(t: AnyDateTime, k?: number): DateTime {\n    const d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    return d.withDay(d.day + k);\n  }\n\n  override next(t: AnyDateTime, k?: number): DateTime {\n    let d = DateTime.fromAny(t);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d = d.withDay(d.day + k);\n    return d.withHour(0, 0, 0, 0);\n  }\n\n  override floor(t: AnyDateTime): DateTime {\n    const d = DateTime.fromAny(t);\n    return d.withHour(0, 0, 0, 0);\n  }\n\n  override ceil(t: AnyDateTime): DateTime {\n    let d = DateTime.fromAny(t);\n    d = new DateTime(d.time - 1, d.zone);\n    d = d.withHour(0, 0, 0, 0);\n    d = d.withDay(d.day + 1);\n    return d.withHour(0, 0, 0, 0);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new FilterTimeInterval(this, DayInterval.modulo.bind(void 0, k));\n    } else {\n      throw new Error(\"\" + k);\n    }\n  }\n\n  /** @internal */\n  static modulo(k: number, d: DateTime): boolean {\n    const day = d.day;\n    return isFinite(day) && day % k === 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {FilterTimeInterval} from \"./FilterTimeInterval\";\n\n/** @internal */\nexport class HourInterval extends UnitTimeInterval {\n  override offset(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k * TimeInterval.MillisPerHour;\n    return new DateTime(d, z);\n  }\n\n  override next(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k * TimeInterval.MillisPerHour;\n    let dtz = z.offset * TimeInterval.MillisPerMinute % TimeInterval.MillisPerHour;\n    if (dtz < 0) {\n      dtz += TimeInterval.MillisPerHour;\n    }\n    d = Math.floor((d - dtz) / TimeInterval.MillisPerHour) * TimeInterval.MillisPerHour + dtz;\n    return new DateTime(d, z);\n  }\n\n  override floor(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    let dtz = z.offset * TimeInterval.MillisPerMinute % TimeInterval.MillisPerHour;\n    if (dtz < 0) {\n      dtz += TimeInterval.MillisPerHour;\n    }\n    d = Math.floor((d - dtz) / TimeInterval.MillisPerHour) * TimeInterval.MillisPerHour + dtz;\n    return new DateTime(d, z);\n  }\n\n  override ceil(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    d -= 1;\n    let dtz = z.offset * TimeInterval.MillisPerMinute % TimeInterval.MillisPerHour;\n    if (dtz < 0) {\n      dtz += TimeInterval.MillisPerHour;\n    }\n    d = (Math.floor((d - dtz) / TimeInterval.MillisPerHour) * TimeInterval.MillisPerHour + dtz) + TimeInterval.MillisPerHour;\n    d = Math.floor((d - dtz) / TimeInterval.MillisPerHour) * TimeInterval.MillisPerHour + dtz;\n    return new DateTime(d, z);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new FilterTimeInterval(this, HourInterval.modulo.bind(void 0, k));\n    } else {\n      throw new Error(\"\" + k);\n    }\n  }\n\n  /** @internal */\n  static modulo(k: number, d: DateTime): boolean {\n    const hour = d.hour;\n    return isFinite(hour) && hour % k === 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {FilterTimeInterval} from \"./FilterTimeInterval\";\n\n/** @internal */\nexport class MinuteInterval extends UnitTimeInterval {\n  override offset(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k * TimeInterval.MillisPerMinute;\n    return new DateTime(d, z);\n  }\n\n  override next(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d = Math.floor((d + k * TimeInterval.MillisPerMinute) / TimeInterval.MillisPerMinute) * TimeInterval.MillisPerMinute;\n    return new DateTime(d, z);\n  }\n\n  override floor(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    d = Math.floor(d / TimeInterval.MillisPerMinute) * TimeInterval.MillisPerMinute;\n    return new DateTime(d, z);\n  }\n\n  override ceil(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    d = Math.floor(((Math.floor((d - 1) / TimeInterval.MillisPerMinute) * TimeInterval.MillisPerMinute) + TimeInterval.MillisPerMinute) / TimeInterval.MillisPerMinute) * TimeInterval.MillisPerMinute;\n    return new DateTime(d, z);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new FilterTimeInterval(this, MinuteInterval.modulo.bind(void 0, k));\n    } else {\n      throw new Error(\"\" + k);\n    }\n  }\n\n  /** @internal */\n  static modulo(k: number, d: DateTime): boolean {\n    const minute = d.minute;\n    return isFinite(minute) && minute % k === 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {FilterTimeInterval} from \"./FilterTimeInterval\";\n\n/** @internal */\nexport class SecondInterval extends UnitTimeInterval {\n  override offset(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k * TimeInterval.MillisPerSecond;\n    return new DateTime(d, z);\n  }\n\n  override next(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k * TimeInterval.MillisPerSecond;\n    d = Math.floor(d / TimeInterval.MillisPerSecond) * TimeInterval.MillisPerSecond;\n    return new DateTime(d, z);\n  }\n\n  override floor(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    d = Math.floor(d / TimeInterval.MillisPerSecond) * TimeInterval.MillisPerSecond;\n    return new DateTime(d, z);\n  }\n\n  override ceil(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    d = Math.floor(((Math.floor((d - 1) / TimeInterval.MillisPerSecond) * TimeInterval.MillisPerSecond) + TimeInterval.MillisPerSecond) / TimeInterval.MillisPerSecond) * TimeInterval.MillisPerSecond;\n    return new DateTime(d, z);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new FilterTimeInterval(this, SecondInterval.modulo.bind(void 0, k));\n    } else {\n      throw new Error('' + k);\n    }\n  }\n\n  /** @internal */\n  static modulo(k: number, d: DateTime): boolean {\n    const second = d.second;\n    return isFinite(second) && second % k === 0;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {UnitTimeInterval, TimeInterval} from \"./TimeInterval\";\nimport {MillisecondsInterval} from \"../\"; // forward import\n\n/** @internal */\nexport class MillisecondInterval extends UnitTimeInterval {\n  override offset(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k;\n    return new DateTime(d, z);\n  }\n\n  override next(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k;\n    return new DateTime(d, z);\n  }\n\n  override floor(d: AnyDateTime): DateTime {\n    return DateTime.fromAny(d);\n  }\n\n  override ceil(d: AnyDateTime): DateTime {\n    return DateTime.fromAny(d);\n  }\n\n  override every(k: number): TimeInterval {\n    if (k === 1) {\n      return this;\n    } else if (isFinite(k) && k >= 1) {\n      return new MillisecondsInterval(k);\n    } else {\n      throw new Error(\"\" + k);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {TimeInterval} from \"./TimeInterval\";\n\n/** @internal */\nexport class MillisecondsInterval extends TimeInterval {\n  private readonly stride: number;\n\n  constructor(stride: number) {\n    super();\n    if (!isFinite(stride)) {\n      stride = 1;\n    }\n    this.stride = stride;\n  }\n\n  override offset(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    d += k * this.stride;\n    return new DateTime(d, z);\n  }\n\n  override next(d: AnyDateTime, k?: number): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    k = Math.max(1, typeof k === \"number\" ? Math.floor(k) : 1);\n    const stride = this.stride;\n    d = Math.floor((d + k * stride) / stride) * stride;\n    return new DateTime(d, z);\n  }\n\n  override floor(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    const stride = this.stride;\n    d = Math.floor(d / stride) * stride;\n    return new DateTime(d, z);\n  }\n\n  override ceil(d: AnyDateTime): DateTime {\n    const z = DateTime.zone(d);\n    d = DateTime.time(d);\n    const stride = this.stride;\n    d = Math.floor(((Math.floor((d - 1) / stride) * stride) + stride) / stride) * stride;\n    return new DateTime(d, z);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Domain, Interpolate, Interpolator} from \"@swim/util\";\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {TimeDomainInterpolator} from \"./\"; // forward import\nimport {TimeRange} from \"./\"; // forward import\n\n/** @public */\nexport interface TimeDomain extends Domain<DateTime>, Interpolate<TimeDomain> {\n  readonly 0: DateTime;\n\n  readonly 1: DateTime;\n\n  readonly inverse: TimeRange;\n\n  contains(t: AnyDateTime): boolean;\n\n  interpolateTo(that: TimeDomain): Interpolator<TimeDomain>;\n  interpolateTo(that: unknown): Interpolator<TimeDomain> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const TimeDomain = (function (_super: typeof Domain) {\n  const TimeDomain = function (x0: DateTime, x1: DateTime): TimeDomain {\n    const domain = function (t: DateTime): number {\n      const t0 = domain[0].time;\n      const t1 = domain[1].time;\n      const dt = t1 - t0;\n      return dt !== 0 ? (t.time - t0) / dt : 0;\n    } as TimeDomain;\n    Object.setPrototypeOf(domain, TimeDomain.prototype);\n    (domain as Mutable<typeof domain>)[0] = x0;\n    (domain as Mutable<typeof domain>)[1] = x1;\n    return domain;\n  } as {\n    (x0: DateTime, x1: DateTime): TimeDomain;\n\n    /** @internal */\n    prototype: TimeDomain;\n  }\n\n  TimeDomain.prototype = Object.create(_super.prototype);\n  TimeDomain.prototype.constructor = TimeDomain;\n\n  Object.defineProperty(TimeDomain.prototype, \"inverse\", {\n    get(this: TimeDomain): TimeRange {\n      return TimeRange(this[0], this[1]);\n    },\n    configurable: true,\n  });\n\n  TimeDomain.prototype.contains = function (t: AnyDateTime): boolean {\n    t = DateTime.time(t);\n    return this[0].time <= t && t <= this[1].time;\n  };\n\n  TimeDomain.prototype.interpolateTo = function (this: TimeDomain, that: unknown): Interpolator<TimeDomain> | null {\n    if (that instanceof TimeDomain) {\n      return TimeDomainInterpolator(this, that);\n    }\n    return null;\n  } as typeof TimeDomain.prototype.interpolateTo;\n\n  TimeDomain.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof TimeDomain;\n  };\n\n  TimeDomain.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TimeDomain) {\n      return that.canEqual(this) && this[0].equals(that[0]) && this[1].equals(that[1]);\n    }\n    return false;\n  };\n\n  TimeDomain.prototype.toString = function (): string {\n    return \"TimeDomain(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  return TimeDomain;\n})(Domain);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {DateTime} from \"../DateTime\";\nimport {TimeDomain} from \"./TimeDomain\";\n\n/** @internal */\nexport const TimeDomainInterpolator = (function (_super: typeof Interpolator) {\n  const TimeDomainInterpolator = function (x0: TimeDomain, x1: TimeDomain): Interpolator<TimeDomain> {\n    const interpolator = function (u: number): TimeDomain {\n      const x0 = interpolator[0];\n      const x00 = x0[0];\n      const x01 = x0[1];\n      const x1 = interpolator[1];\n      const x10 = x1[0];\n      const x11 = x1[1];\n      return TimeDomain(new DateTime(x00.time + u * (x10.time - x00.time), u === 0 ? x00.zone : x10.zone),\n                        new DateTime(x01.time + u * (x11.time - x01.time), u === 0 ? x01.zone : x11.zone));\n    } as Interpolator<TimeDomain>;\n    Object.setPrototypeOf(interpolator, TimeDomainInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = x0;\n    (interpolator as Mutable<typeof interpolator>)[1] = x1;\n    return interpolator;\n  } as {\n    (x0: TimeDomain, x1: TimeDomain): Interpolator<TimeDomain>;\n\n    /** @internal */\n    prototype: Interpolator<TimeDomain>;\n  };\n\n  TimeDomainInterpolator.prototype = Object.create(_super.prototype);\n  TimeDomainInterpolator.prototype.constructor = TimeDomainInterpolator;\n\n  return TimeDomainInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Range, Interpolate, Interpolator} from \"@swim/util\";\nimport {DateTime} from \"../DateTime\";\nimport {TimeDomain} from \"./\"; // forward import\nimport {TimeRangeInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport interface TimeRange extends Range<DateTime>, Interpolate<TimeRange> {\n  readonly 0: DateTime;\n\n  readonly 1: DateTime;\n\n  readonly inverse: TimeDomain;\n\n  interpolateTo(that: TimeRange): Interpolator<TimeRange>;\n  interpolateTo(that: unknown): Interpolator<TimeRange> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const TimeRange = (function (_super: typeof Range) {\n  const TimeRange = function (y0: DateTime, y1: DateTime): TimeRange {\n    const range = function (u: number): DateTime {\n      const t0 = range[0].time;\n      const t1 = range[1].time;\n      return new DateTime(t0 + u * (t1 - t0), u === 0 ? range[0].zone : range[1].zone);\n    } as TimeRange;\n    Object.setPrototypeOf(range, TimeRange.prototype);\n    (range as Mutable<typeof range>)[0] = y0;\n    (range as Mutable<typeof range>)[1] = y1;\n    return range;\n  } as {\n    (y0: DateTime, y1: DateTime): TimeRange;\n\n    /** @internal */\n    prototype: TimeRange;\n  };\n\n  TimeRange.prototype = Object.create(_super.prototype);\n  TimeRange.prototype.constructor = TimeRange;\n\n  Object.defineProperty(TimeRange.prototype, \"inverse\", {\n    get(this: TimeRange): TimeDomain {\n      return TimeDomain(this[0], this[1]);\n    },\n    configurable: true,\n  });\n\n  TimeRange.prototype.interpolateTo = function (this: TimeRange, that: unknown): Interpolator<TimeRange> | null {\n    if (that instanceof TimeRange) {\n      return TimeRangeInterpolator(this, that);\n    }\n    return null;\n  } as typeof TimeRange.prototype.interpolateTo;\n\n  TimeRange.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof TimeRange;\n  };\n\n  TimeRange.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TimeRange) {\n      return that.canEqual(this) && this[0].equals(that[0]) && this[1].equals(that[1]);\n    }\n    return false;\n  };\n\n  TimeRange.prototype.toString = function (): string {\n    return \"TimeRange(\" + this[0] + \", \" + this[1] + \")\";\n  };\n\n  return TimeRange;\n})(Range);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator} from \"@swim/util\";\nimport {DateTime} from \"../DateTime\";\nimport {TimeRange} from \"./TimeRange\";\n\n/** @internal */\nexport const TimeRangeInterpolator = (function (_super: typeof Interpolator) {\n  const TimeRangeInterpolator = function (y0: TimeRange, y1: TimeRange): Interpolator<TimeRange> {\n    const interpolator = function (u: number): TimeRange {\n      const y0 = interpolator[0];\n      const y00 = y0[0];\n      const y01 = y0[1];\n      const y1 = interpolator[1];\n      const y10 = y1[0];\n      const y11 = y1[1];\n      return TimeRange(new DateTime(y00.time + u * (y10.time - y00.time), u === 0 ? y00.zone : y10.zone),\n                       new DateTime(y01.time + u * (y11.time - y01.time), u === 0 ? y01.zone : y11.zone));\n    } as Interpolator<TimeRange>;\n    Object.setPrototypeOf(interpolator, TimeRangeInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = y0;\n    (interpolator as Mutable<typeof interpolator>)[1] = y1;\n    return interpolator;\n  } as {\n    (y0: TimeRange, y1: TimeRange): Interpolator<TimeRange>;\n\n    /** @internal */\n    prototype: Interpolator<TimeRange>;\n  };\n\n  TimeRangeInterpolator.prototype = Object.create(_super.prototype);\n  TimeRangeInterpolator.prototype.constructor = TimeRangeInterpolator;\n\n  return TimeRangeInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {\n  Equivalent,\n  Mutable,\n  Mapping,\n  Interpolate,\n  Interpolator,\n  LinearRange,\n  ContinuousScale,\n} from \"@swim/util\";\nimport {AnyDateTime, DateTime} from \"../DateTime\";\nimport {TimeDomain} from \"./TimeDomain\";\nimport {TimeScaleInterpolator} from \"./\"; // forward import\n\n/** @public */\nexport interface TimeScale extends ContinuousScale<DateTime, number>, Interpolate<TimeScale> {\n  readonly domain: TimeDomain;\n\n  readonly range: LinearRange;\n\n  readonly inverse: Mapping<number, DateTime>;\n\n  withDomain(domain: TimeDomain): TimeScale;\n  withDomain(x0: AnyDateTime, x1: AnyDateTime): TimeScale;\n\n  overRange(range: LinearRange): TimeScale;\n  overRange(y0: number, y1: number): TimeScale;\n\n  clampDomain(xMin: DateTime | undefined, xMax: DateTime | undefined,\n              zMin: number | undefined, zMax: number | undefined,\n              epsilon?: number): TimeScale;\n\n  solveDomain(x1: DateTime, y1: number, x2?: DateTime, y2?: number,\n              reflect?: boolean, epsilon?: number): TimeScale;\n\n  interpolateTo(that: TimeScale): Interpolator<TimeScale>;\n  interpolateTo(that: unknown): Interpolator<TimeScale> | null;\n\n  canEqual(that: unknown): boolean;\n\n  equals(that: unknown): boolean;\n\n  toString(): string;\n}\n\n/** @public */\nexport const TimeScale = (function (_super: typeof ContinuousScale) {\n  const TimeScale = function (domain: TimeDomain, range: LinearRange): TimeScale {\n    const scale = function (x: DateTime): number {\n      return scale.range(scale.domain(x));\n    } as TimeScale;\n    Object.setPrototypeOf(scale, TimeScale.prototype);\n    (scale as Mutable<typeof scale>).domain = domain;\n    (scale as Mutable<typeof scale>).range = range;\n    return scale;\n  } as {\n    (domain: TimeDomain, range: LinearRange): TimeScale;\n\n    /** @internal */\n    prototype: TimeScale;\n  };\n\n  TimeScale.prototype = Object.create(_super.prototype);\n  TimeScale.prototype.constructor = TimeScale;\n\n  Object.defineProperty(TimeScale.prototype, \"inverse\", {\n    get(this: TimeScale): Mapping<number, DateTime> {\n      return Mapping(this.range.inverse, this.domain.inverse);\n    },\n    configurable: true,\n  });\n\n  TimeScale.prototype.withDomain = function (x0: TimeDomain | AnyDateTime, x1?: AnyDateTime): TimeScale {\n    let domain: TimeDomain;\n    if (arguments.length === 1) {\n      domain = x0 as TimeDomain;\n    } else {\n      x0 = DateTime.fromAny(x0 as AnyDateTime);\n      x1 = DateTime.fromAny(x1!);\n      domain = TimeDomain(x0 as DateTime, x1 as DateTime);\n    }\n    return TimeScale(domain, this.range);\n  };\n\n  TimeScale.prototype.overRange = function (y0: LinearRange | number, y1?: number): TimeScale {\n    let range: LinearRange;\n    if (arguments.length === 1) {\n      range = y0 as LinearRange;\n    } else {\n      range = LinearRange(y0 as number, y1!);\n    }\n    return TimeScale(this.domain, range);\n  };\n\n  TimeScale.prototype.clampDomain = function (xMin: DateTime | undefined, xMax: DateTime | undefined,\n                                              zMin: number | undefined, zMax: number | undefined,\n                                              epsilon?: number): TimeScale {\n    if (epsilon === void 0) {\n      epsilon = Equivalent.Epsilon;\n    }\n    const x0 = this.domain[0];\n    const x1 = this.domain[1];\n    let t0 = x0.time;\n    let t1 = x1.time;\n    const tMin = xMin !== void 0 ? xMin.time : void 0;\n    const tMax = xMax !== void 0 ? xMax.time : void 0;\n    if (tMin !== void 0 && tMax !== void 0 && Math.abs(t1 - t0) > tMax - tMin) {\n      if (t0 < t1) {\n        t0 = tMin;\n        t1 = tMax;\n      } else {\n        t1 = tMin;\n        t0 = tMax;\n      }\n    } else {\n      if (tMin !== void 0) {\n        if (t0 < t1 && t0 < tMin) {\n          t1 += tMin - t0;\n          t0 = tMin;\n        } else if (t1 < t0 && t1 < tMin) {\n          t0 += tMin - t1;\n          t1 = tMin;\n        }\n      }\n      if (tMax !== void 0) {\n        if (t0 < t1 && t1 > tMax) {\n          t0 -= t1 - tMax;\n          t1 = tMax;\n        } else if (t1 < t0 && t0 > tMax) {\n          t1 -= t0 - tMax;\n          t0 = tMax;\n        }\n      }\n    }\n\n    const y0 = this(x0);\n    const y1 = this(x1);\n    const dy = y0 < y1 ? y1 - y0 : y0 - y1;\n    const z = Math.abs(dy / (t1 - t0));\n    if (zMin !== void 0 && z < 1 / zMin) {\n      const dz = dy * zMin;\n      const tSum = t0 + t1;\n      t0 = (tSum - dz) / 2;\n      t1 = (tSum + dz) / 2;\n    } else if (zMax !== void 0 && z > 1 / zMax) {\n      const dz = dy * zMax;\n      const tSum = t0 + t1;\n      t0 = (tSum - dz) / 2;\n      t1 = (tSum + dz) / 2;\n    }\n\n    if (Math.abs(t0 - x0.time) < epsilon && Math.abs(t1 - x1.time) < epsilon) {\n      return this;\n    } else {\n      return TimeScale(TimeDomain(new DateTime(t0, x0.zone), new DateTime(t1, x1.zone)), this.range);\n    }\n  };\n\n  TimeScale.prototype.solveDomain = function (x1: DateTime, y1: number, x2?: DateTime, y2?: number,\n                                              reflect?: boolean, epsilon?: number): TimeScale {\n    if (epsilon === void 0) {\n      epsilon = Equivalent.Epsilon;\n    }\n    const dt = this.domain[1].time - this.domain[0].time;\n    const y0 = this.range[0];\n    const y3 = this.range[1];\n    const t1 = x1.time;\n    const t2 = x2 !== void 0 ? x2.time : void 0;\n    let m: number;\n    if (t2 === void 0 || y2 === void 0 || Math.abs(t2 - t1) < epsilon || Math.abs(y2 - y1) < epsilon) {\n      m = (y3 - y0) / (dt !== 0 ? dt : epsilon);\n    } else {\n      m = (y2 - y1) / (t2 - t1);\n      if ((reflect === void 0 || !reflect) && (m < 0 !== (y3 - y0) / dt < 0)) {\n        m = -m;\n      }\n    }\n    const b = y1 - m * t1;\n    const t0 = (y0 - b) / m;\n    const t3 = (y3 - b) / m;\n\n    if (Math.abs(t0 - this.domain[0].time) < epsilon && Math.abs(t3 - this.domain[1].time) < epsilon) {\n      return this;\n    } else {\n      return TimeScale(TimeDomain(new DateTime(t0, this.domain[0].zone), new DateTime(t3, this.domain[1].zone)), this.range);\n    }\n  };\n\n  TimeScale.prototype.interpolateTo = function (this: TimeScale, that: unknown): Interpolator<TimeScale> | null {\n    if (that instanceof TimeScale) {\n      return TimeScaleInterpolator(this, that);\n    }\n    return null;\n  } as typeof TimeScale.prototype.interpolateTo;\n\n  TimeScale.prototype.canEqual = function (that: unknown): boolean {\n    return that instanceof TimeScale;\n  };\n\n  TimeScale.prototype.equals = function (that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof TimeScale) {\n      return this.domain.equals(that.domain) && this.range.equals(that.range);\n    }\n    return false;\n  };\n\n  TimeScale.prototype.toString = function (): string {\n    return \"TimeScale(\" + this.domain + \", \" + this.range + \")\";\n  };\n\n  return TimeScale;\n})(ContinuousScale);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Interpolator, LinearRange} from \"@swim/util\";\nimport {DateTime} from \"../DateTime\";\nimport {TimeDomain} from \"./TimeDomain\";\nimport {TimeScale} from \"./TimeScale\";\n\n/** @internal */\nexport const TimeScaleInterpolator = (function (_super: typeof Interpolator) {\n  const TimeScaleInterpolator = function (s0: TimeScale, s1: TimeScale): Interpolator<TimeScale> {\n    const interpolator = function (u: number): TimeScale {\n      const s0 = interpolator[0];\n      const s1 = interpolator[1];\n      const x0 = s0.domain;\n      const x00 = x0[0].time;\n      const x01 = x0[1].time;\n      const x1 = s1.domain;\n      const x10 = x1[0].time;\n      const x11 = x1[1].time;\n      const domain = TimeDomain(new DateTime(x00 + u * (x10 - x00), u === 0 ? x0[0].zone : x1[0].zone),\n                                new DateTime(x01 + u * (x11 - x01), u === 0 ? x0[1].zone : x1[1].zone));\n      const y0 = s0.range;\n      const y00 = y0[0];\n      const y01 = y0[1];\n      const y1 = s1.range;\n      const y10 = y1[0];\n      const y11 = y1[1];\n      const range = LinearRange(y00 + u * (y10 - y00), y01 + u * (y11 - y01));\n      return TimeScale(domain, range);\n    } as Interpolator<TimeScale>;\n    Object.setPrototypeOf(interpolator, TimeScaleInterpolator.prototype);\n    (interpolator as Mutable<typeof interpolator>)[0] = s0;\n    (interpolator as Mutable<typeof interpolator>)[1] = s1;\n    return interpolator;\n  } as {\n    (s0: TimeScale, s1: TimeScale): Interpolator<TimeScale>;\n\n    /** @internal */\n    prototype: Interpolator<TimeScale>;\n  };\n\n  TimeScaleInterpolator.prototype = Object.create(_super.prototype);\n  TimeScaleInterpolator.prototype.constructor = TimeScaleInterpolator;\n\n  return TimeScaleInterpolator;\n})(Interpolator);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {HashCode} from \"@swim/util\";\nimport {Output, Debug, Format} from \"@swim/codec\";\nimport type {AnyValue, Value} from \"@swim/structure\";\nimport {Recon} from \"@swim/recon\";\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport {EventMessage} from \"./\"; // forward import\nimport {CommandMessage} from \"./\"; // forward import\nimport {LinkRequest} from \"./\"; // forward import\nimport {LinkedResponse} from \"./\"; // forward import\nimport {SyncRequest} from \"./\"; // forward import\nimport {SyncedResponse} from \"./\"; // forward import\nimport {UnlinkRequest} from \"./\"; // forward import\nimport {UnlinkedResponse} from \"./\"; // forward import\nimport {AuthRequest} from \"./\"; // forward import\nimport {AuthedResponse} from \"./\"; // forward import\nimport {DeauthRequest} from \"./\"; // forward import\nimport {DeauthedResponse} from \"./\"; // forward import\n\n/** @public */\nexport abstract class Envelope implements HashCode, Debug {\n  get tag(): string {\n    return (this.constructor as unknown as {readonly tag: string}).tag;\n  }\n\n  abstract readonly node: Uri;\n\n  abstract withNode(node: AnyUri): Envelope;\n\n  abstract readonly lane: Uri;\n\n  abstract withLane(lane: AnyUri): Envelope;\n\n  declare readonly prio: number; // getter defined below to work around useDefineForClassFields lunacy\n\n  withPrio(prio: number): Envelope {\n    return this;\n  }\n\n  declare readonly rate: number; // getter defined below to work around useDefineForClassFields lunacy\n\n  withRate(rate: number): Envelope {\n    return this;\n  }\n\n  abstract readonly body: Value;\n\n  abstract withBody(body: AnyValue): Envelope;\n\n  abstract toValue(): Value;\n\n  toRecon(): string {\n    return Recon.toString(this.toValue());\n  }\n\n  abstract equals(that: unknown): boolean;\n\n  abstract hashCode(): number;\n\n  abstract debug<T>(output: Output<T>): Output<T>;\n\n  toString(): string {\n    return Format.debug(this);\n  }\n\n  static fromValue(value: Value): Envelope | null {\n    switch (value.tag) {\n      case \"event\": return EventMessage.fromValue(value);\n      case \"command\": return CommandMessage.fromValue(value);\n      case \"link\": return LinkRequest.fromValue(value);\n      case \"linked\": return LinkedResponse.fromValue(value);\n      case \"sync\": return SyncRequest.fromValue(value);\n      case \"synced\": return SyncedResponse.fromValue(value);\n      case \"unlink\": return UnlinkRequest.fromValue(value);\n      case \"unlinked\": return UnlinkedResponse.fromValue(value);\n      case \"auth\": return AuthRequest.fromValue(value);\n      case \"authed\": return AuthedResponse.fromValue(value);\n      case \"deauth\": return DeauthRequest.fromValue(value);\n      case \"deauthed\": return DeauthedResponse.fromValue(value);\n      default: return null;\n    }\n  }\n\n  static parseRecon(input: string): Envelope | null {\n    return Envelope.fromValue(Recon.parse(input));\n  }\n}\nObject.defineProperty(Envelope.prototype, \"prio\", {\n  get(this: Envelope): number {\n    return 0;\n  },\n  configurable: true,\n});\nObject.defineProperty(Envelope.prototype, \"rate\", {\n  get(this: Envelope): number {\n    return 0;\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {AnyValue, Value, Attr} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {Envelope} from \"./Envelope\";\n\n/** @public */\nexport interface HostAddressedConstructor<E extends HostAddressed<E>> {\n  new(body: Value): E;\n\n  readonly tag: string;\n}\n\n/** @public */\nexport abstract class HostAddressed<E extends HostAddressed<E>> extends Envelope {\n  constructor(body: Value) {\n    super();\n    this.body = body;\n  }\n\n  override get node(): Uri {\n    return Uri.empty();\n  }\n\n  override withNode(node: AnyUri): E {\n    return this as unknown as E;\n  }\n\n  override get lane(): Uri {\n    return Uri.empty();\n  }\n\n  override withLane(lane: AnyUri): E {\n    return this as unknown as E;\n  }\n\n  override readonly body: Value;\n\n  override withBody(body: AnyValue): E {\n    body = Value.fromAny(body);\n    return this.copy(body);\n  }\n\n  protected abstract copy(body: Value): E;\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof HostAddressed) {\n      return this.constructor === that.constructor\n          && this.body.equals(that.body);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Constructors.hash(this.constructor),\n          this.body.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(this.constructor.name).write(46/*'.'*/)\n                   .write(\"create\").write(40/*'('*/);\n    if (this.body.isDefined()) {\n      output = output.debug(this.body);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toValue(): Value {\n    return Attr.of(this.tag).concat(this.body);\n  }\n\n  static override fromValue<E extends HostAddressed<E>>(this: HostAddressedConstructor<E>,\n                                                        value: Value): E | null {\n    const header = value.header(this.tag);\n    if (header.isDefined()) {\n      const body = value.body();\n      return new this(body);\n    }\n    return null;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item, Attr, AnyValue, Value, Record} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {Envelope} from \"./Envelope\";\n\n/** @public */\nexport interface LaneAddressedConstructor<E extends LaneAddressed<E>> {\n  new(node: Uri, lane: Uri, body: Value): E;\n\n  readonly tag: string;\n}\n\n/** @public */\nexport abstract class LaneAddressed<E extends LaneAddressed<E>> extends Envelope {\n  constructor(node: Uri, lane: Uri, body: Value) {\n    super();\n    this.node = node;\n    this.lane = lane;\n    this.body = body;\n  }\n\n  override readonly node: Uri;\n\n  override withNode(node: AnyUri): E {\n    node = Uri.fromAny(node);\n    return this.copy(node as Uri, this.lane, this.body);\n  }\n\n  override readonly lane: Uri;\n\n  override withLane(lane: AnyUri): E {\n    lane = Uri.fromAny(lane);\n    return this.copy(this.node, lane as Uri, this.body);\n  }\n\n  override readonly body: Value;\n\n  override withBody(body: AnyValue): E {\n    body = Value.fromAny(body);\n    return this.copy(this.node, this.lane, body);\n  }\n\n  protected abstract copy(node: Uri, lane: Uri, body: Value): E;\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LaneAddressed) {\n      return this.constructor === that.constructor\n          && this.node.equals(that.node) && this.lane.equals(that.lane)\n          && this.body.equals(that.body);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(this.constructor), this.node.hashCode()),\n        this.lane.hashCode()), this.body.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(this.constructor.name).write(46/*'.'*/)\n                   .write(\"create\").write(40/*'('*/)\n                   .debug(this.node.toString()).write(\", \").debug(this.lane.toString());\n    if (this.body.isDefined()) {\n      output = output.write(\", \").debug(this.body);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toValue(): Value {\n    const header = Record.create(2)\n        .slot(\"node\", this.node.toString())\n        .slot(\"lane\", this.lane.toString());\n    return Attr.of(this.tag, header).concat(this.body);\n  }\n\n  static override fromValue<E extends LaneAddressed<E>>(this: LaneAddressedConstructor<E>,\n                                                        value: Value): E | null {\n    let node: Uri | undefined;\n    let lane: Uri | undefined;\n    const header = value.header(this.tag);\n    header.forEach(function (header: Item, index: number) {\n      const key = header.key.stringValue(void 0);\n      if (key !== void 0) {\n        if (key === \"node\") {\n          node = Uri.parse(header.toValue().stringValue(\"\"));\n        } else if (key === \"lane\") {\n          lane = Uri.parse(header.toValue().stringValue(\"\"));\n        }\n      } else if (header instanceof Value) {\n        if (index === 0) {\n          node = Uri.parse(header.stringValue(\"\"));\n        } else if (index === 1) {\n          lane = Uri.parse(header.stringValue(\"\"));\n        }\n      }\n    });\n    if (node !== void 0 && lane !== void 0) {\n      const body = value.body();\n      return new this(node, lane, body);\n    }\n    return null;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Murmur3, Numbers, Constructors} from \"@swim/util\";\nimport type {Output} from \"@swim/codec\";\nimport {Item, Attr, AnyValue, Value, Record} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {Envelope} from \"./Envelope\";\n\n/** @public */\nexport interface LinkAddressedConstructor<E extends LinkAddressed<E>> {\n  new(node: Uri, lane: Uri, prio: number, rate: number, body: Value): E;\n\n  readonly tag: string;\n}\n\n/** @public */\nexport abstract class LinkAddressed<E extends LinkAddressed<E>> extends Envelope {\n  constructor(node: Uri, lane: Uri, prio: number, rate: number, body: Value) {\n    super();\n    this.node = node;\n    this.lane = lane;\n    Object.defineProperty(this, \"prio\", {\n      value: prio,\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    });\n    Object.defineProperty(this, \"rate\", {\n      value: rate,\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    });\n    this.body = body;\n  }\n\n  override readonly node: Uri;\n\n  override withNode(node: AnyUri): E {\n    node = Uri.fromAny(node);\n    return this.copy(node as Uri, this.lane, this.prio, this.rate, this.body);\n  }\n\n  override readonly lane: Uri;\n\n  override withLane(lane: AnyUri): E {\n    lane = Uri.fromAny(lane);\n    return this.copy(this.node, lane as Uri, this.prio, this.rate, this.body);\n  }\n\n  override readonly prio!: number;\n\n  override withPrio(prio: number): E {\n    return this.copy(this.node, this.lane, prio, this.rate, this.body);\n  }\n\n  override readonly rate!: number;\n\n  override withRate(rate: number): E {\n    return this.copy(this.node, this.lane, this.prio, rate, this.body);\n  }\n\n  override readonly body: Value;\n\n  override withBody(body: AnyValue): E {\n    body = Value.fromAny(body);\n    return this.copy(this.node, this.lane, this.prio, this.rate, body);\n  }\n\n  protected abstract copy(node: Uri, lane: Uri, prio: number, rate: number, body: Value): E;\n\n  override equals(that: unknown): boolean {\n    if (this === that) {\n      return true;\n    } else if (that instanceof LinkAddressed) {\n      return this.constructor === that.constructor\n          && this.node.equals(that.node) && this.lane.equals(that.lane)\n          && this.prio === that.prio && this.rate === that.rate\n          && this.body.equals(that.body);\n    }\n    return false;\n  }\n\n  override hashCode(): number {\n    return Murmur3.mash(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(Murmur3.mix(\n        Constructors.hash(this.constructor), this.node.hashCode()), this.lane.hashCode()),\n        Numbers.hash(this.prio)), Numbers.hash(this.rate)), this.body.hashCode()));\n  }\n\n  override debug<T>(output: Output<T>): Output<T> {\n    output = output.write(this.constructor.name).write(46/*'.'*/)\n                   .write(\"create\").write(40/*'('*/)\n                   .debug(this.node.toString()).write(\", \").debug(this.lane.toString());\n    if (this.prio !== 0 || this.rate !== 0) {\n      output = output.write(\", \").debug(this.prio).write(\", \").debug(this.rate);\n    }\n    if (this.body.isDefined()) {\n      output = output.write(\", \").debug(this.body);\n    }\n    output = output.write(41/*')'*/);\n    return output;\n  }\n\n  override toValue(): Value {\n    const header = Record.create(4)\n        .slot(\"node\", this.node.toString())\n        .slot(\"lane\", this.lane.toString());\n    if (this.prio !== 0) {\n      header.slot(\"prio\", this.prio);\n    }\n    if (this.rate !== 0) {\n      header.slot(\"rate\", this.rate);\n    }\n    return Attr.of(this.tag, header).concat(this.body);\n  }\n\n  static override fromValue<E extends LinkAddressed<E>>(this: LinkAddressedConstructor<E>,\n                                                        value: Value): E | null {\n    let node: Uri | undefined;\n    let lane: Uri | undefined;\n    let prio = 0;\n    let rate = 0;\n    const header = value.header(this.tag);\n    header.forEach(function (header: Item, index: number) {\n      const key = header.key.stringValue(void 0);\n      if (key !== void 0) {\n        if (key === \"node\") {\n          node = Uri.parse(header.toValue().stringValue(\"\"));\n        } else if (key === \"lane\") {\n          lane = Uri.parse(header.toValue().stringValue(\"\"));\n        } else if (key === \"prio\") {\n          prio = header.numberValue(prio);\n        } else if (key === \"rate\") {\n          rate = header.numberValue(rate);\n        }\n      } else if (header instanceof Value) {\n        if (index === 0) {\n          node = Uri.parse(header.stringValue(\"\"));\n        } else if (index === 1) {\n          lane = Uri.parse(header.stringValue(\"\"));\n        }\n      }\n    });\n    if (node !== void 0 && lane !== void 0) {\n      const body = value.body();\n      return new this(node, lane, prio, rate, body);\n    }\n    return null;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LaneAddressed} from \"./LaneAddressed\";\n\n/** @public */\nexport class EventMessage extends LaneAddressed<EventMessage> {\n  constructor(node: Uri, lane: Uri, body: Value) {\n    super(node, lane, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, body: Value): EventMessage {\n    return new EventMessage(node, lane, body);\n  }\n\n  static get tag(): string {\n    return \"event\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, body: AnyValue = Value.absent()): EventMessage {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new EventMessage(node as Uri, lane as Uri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LaneAddressed} from \"./LaneAddressed\";\n\n/** @public */\nexport class CommandMessage extends LaneAddressed<CommandMessage> {\n  constructor(node: Uri, lane: Uri, body: Value) {\n    super(node, lane, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, body: Value): CommandMessage {\n    return new CommandMessage(node, lane, body);\n  }\n\n  static get tag(): string {\n    return \"command\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, body: AnyValue = Value.absent()): CommandMessage {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new CommandMessage(node as Uri, lane as Uri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LinkAddressed} from \"./LinkAddressed\";\n\n/** @public */\nexport class LinkRequest extends LinkAddressed<LinkRequest> {\n  constructor(node: Uri, lane: Uri, prio: number, rate: number, body: Value) {\n    super(node, lane, prio, rate, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, prio: number, rate: number, body: Value): LinkRequest {\n    return new LinkRequest(node, lane, prio, rate, body);\n  }\n\n  static get tag(): string {\n    return \"link\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, prio: number = 0, rate: number = 0,\n                body: AnyValue = Value.absent()): LinkRequest {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new LinkRequest(node as Uri, lane as Uri, prio, rate, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LinkAddressed} from \"./LinkAddressed\";\n\n/** @public */\nexport class LinkedResponse extends LinkAddressed<LinkedResponse> {\n  constructor(node: Uri, lane: Uri, prio: number, rate: number, body: Value) {\n    super(node, lane, prio, rate, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, prio: number, rate: number, body: Value): LinkedResponse {\n    return new LinkedResponse(node, lane, prio, rate, body);\n  }\n\n  static get tag(): string {\n    return \"linked\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, prio: number = 0, rate: number = 0,\n                body: AnyValue = Value.absent()): LinkedResponse {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new LinkedResponse(node as Uri, lane as Uri, prio, rate, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LinkAddressed} from \"./LinkAddressed\";\n\n/** @public */\nexport class SyncRequest extends LinkAddressed<SyncRequest> {\n  constructor(node: Uri, lane: Uri, prio: number, rate: number, body: Value) {\n    super(node, lane, prio, rate, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, prio: number, rate: number, body: Value): SyncRequest {\n    return new SyncRequest(node, lane, prio, rate, body);\n  }\n\n  static get tag(): string {\n    return \"sync\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, prio: number = 0, rate: number = 0,\n                body: AnyValue = Value.absent()): SyncRequest {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new SyncRequest(node as Uri, lane as Uri, prio, rate, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LaneAddressed} from \"./LaneAddressed\";\n\n/** @public */\nexport class SyncedResponse extends LaneAddressed<SyncedResponse> {\n  constructor(node: Uri, lane: Uri, body: Value) {\n    super(node, lane, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, body: Value): SyncedResponse {\n    return new SyncedResponse(node, lane, body);\n  }\n\n  static get tag(): string {\n    return \"synced\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, body: AnyValue = Value.absent()): SyncedResponse {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new SyncedResponse(node as Uri, lane as Uri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LaneAddressed} from \"./LaneAddressed\";\n\n/** @public */\nexport class UnlinkRequest extends LaneAddressed<UnlinkRequest> {\n  constructor(node: Uri, lane: Uri, body: Value) {\n    super(node, lane, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, body: Value): UnlinkRequest {\n    return new UnlinkRequest(node, lane, body);\n  }\n\n  static get tag(): string {\n    return \"unlink\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, body: AnyValue = Value.absent()): UnlinkRequest {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new UnlinkRequest(node as Uri, lane as Uri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {LaneAddressed} from \"./LaneAddressed\";\n\n/** @public */\nexport class UnlinkedResponse extends LaneAddressed<UnlinkedResponse> {\n  constructor(node: Uri, lane: Uri, body: Value) {\n    super(node, lane, body);\n  }\n\n  protected override copy(node: Uri, lane: Uri, body: Value): UnlinkedResponse {\n    return new UnlinkedResponse(node, lane, body);\n  }\n\n  static get tag(): string {\n    return \"unlinked\";\n  }\n\n  static create(node: AnyUri, lane: AnyUri, body: AnyValue = Value.absent()): UnlinkedResponse {\n    node = Uri.fromAny(node);\n    lane = Uri.fromAny(lane);\n    body = Value.fromAny(body);\n    return new UnlinkedResponse(node as Uri, lane as Uri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {HostAddressed} from \"./HostAddressed\";\n\n/** @public */\nexport class AuthRequest extends HostAddressed<AuthRequest> {\n  constructor(body: Value) {\n    super(body);\n  }\n\n  protected override copy(body: Value): AuthRequest {\n    return new AuthRequest(body);\n  }\n\n  static get tag(): string {\n    return \"auth\";\n  }\n\n  static create(body: AnyValue = Value.absent()): AuthRequest {\n    body = Value.fromAny(body);\n    return new AuthRequest(body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {HostAddressed} from \"./HostAddressed\";\n\n/** @public */\nexport class AuthedResponse extends HostAddressed<AuthedResponse> {\n  constructor(body: Value) {\n    super(body);\n  }\n\n  protected override copy(body: Value): AuthedResponse {\n    return new AuthedResponse(body);\n  }\n\n  static get tag(): string {\n    return \"authed\";\n  }\n\n  static create(body: AnyValue = Value.absent()): AuthedResponse {\n    body = Value.fromAny(body);\n    return new AuthedResponse(body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {HostAddressed} from \"./HostAddressed\";\n\n/** @public */\nexport class DeauthRequest extends HostAddressed<DeauthRequest> {\n  constructor(body: Value) {\n    super(body);\n  }\n\n  protected override copy(body: Value): DeauthRequest {\n    return new DeauthRequest(body);\n  }\n\n  static get tag(): string {\n    return \"deauth\";\n  }\n\n  static create(body: AnyValue = Value.absent()): DeauthRequest {\n    body = Value.fromAny(body);\n    return new DeauthRequest(body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {HostAddressed} from \"./HostAddressed\";\n\n/** @public */\nexport class DeauthedResponse extends HostAddressed<DeauthedResponse> {\n  constructor(body: Value) {\n    super(body);\n  }\n\n  protected override copy(body: Value): DeauthedResponse {\n    return new DeauthedResponse(body);\n  }\n\n  static get tag(): string {\n    return \"deauthed\";\n  }\n\n  static create(body: AnyValue = Value.absent()): DeauthedResponse {\n    body = Value.fromAny(body);\n    return new DeauthedResponse(body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport type {AnyValue, Value} from \"@swim/structure\";\nimport type {Envelope} from \"@swim/warp\";\nimport type {HostDownlink} from \"./HostDownlink\";\n\n/** @public */\nexport interface HostOptions {\n  credentials?: Value;\n  unlinkDelay?: number;\n  maxReconnectTimeout?: number;\n  idleTimeout?: number;\n  sendBufferSize?: number;\n}\n\n/** @public */\nexport abstract class Host {\n  abstract readonly hostUri: Uri;\n\n  /** @internal */\n  abstract readonly unlinkDelay: number;\n\n  abstract isConnected(): boolean;\n\n  abstract isAuthenticated(): boolean;\n\n  abstract readonly session: Value;\n\n  /** @internal */\n  abstract resolve(relative: AnyUri): Uri;\n\n  /** @internal */\n  abstract unresolve(absolute: AnyUri): Uri;\n\n  abstract authenticate(credentials: AnyValue): void;\n\n  /** @internal */\n  abstract openDownlink(downlink: HostDownlink): void;\n\n  /** @internal */\n  abstract unlinkDownlink(downlink: HostDownlink): void;\n\n  /** @internal */\n  abstract closeDownlink(downlink: HostDownlink): void;\n\n  abstract command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void;\n\n  /** @internal */\n  abstract open(): void;\n\n  /** @internal */\n  abstract close(): void;\n\n  /** @internal */\n  abstract closeUp(): void;\n\n  /** @internal */\n  abstract push(envelope: Envelope): void;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri, UriCache} from \"@swim/uri\";\nimport {\n  Envelope,\n  EventMessage,\n  CommandMessage,\n  LinkRequest,\n  LinkedResponse,\n  SyncRequest,\n  SyncedResponse,\n  UnlinkRequest,\n  UnlinkedResponse,\n  AuthRequest,\n  AuthedResponse,\n  DeauthRequest,\n  DeauthedResponse,\n} from \"@swim/warp\";\nimport type {HostDownlink} from \"./HostDownlink\";\nimport type {HostContext} from \"./HostContext\";\nimport {HostOptions, Host} from \"./Host\";\n\n/** @internal */\nexport abstract class RemoteHost extends Host {\n  constructor(context: HostContext, hostUri: Uri, options: HostOptions = {}) {\n    super();\n    this.context = context;\n    this.hostUri = hostUri;\n    this.options = options;\n    this.authenticated = false;\n    this.session = Value.absent();\n    this.sendBuffer = [];\n    this.downlinks = new BTree();\n    this.downlinkCount = 0;\n    this.uriCache = new UriCache(hostUri);\n    this.reconnectTimer = 0;\n    this.reconnectTimeout = 0;\n    this.idleTimer = 0;\n  }\n\n  /** @internal */\n  readonly context: HostContext;\n\n  override readonly hostUri: Uri;\n\n  readonly options: HostOptions;\n\n  get credentials(): Value {\n    return this.options.credentials ?? Value.absent();\n  }\n\n  override get unlinkDelay(): number {\n    return this.options.unlinkDelay ?? RemoteHost.UnlinkDelay;\n  }\n\n  get maxReconnectTimeout(): number {\n    return this.options.maxReconnectTimeout ?? RemoteHost.MaxReconnectTimeout;\n  }\n\n  get idleTimeout(): number {\n    return this.options.idleTimeout ?? RemoteHost.IdleTimeout;\n  }\n\n  get sendBufferSize(): number {\n    return this.options.sendBufferSize ?? RemoteHost.SendBufferSize;\n  }\n\n  abstract override isConnected(): boolean;\n\n  /** @internal */\n  readonly authenticated: boolean;\n\n  override isAuthenticated(): boolean {\n    return this.authenticated;\n  }\n\n  override readonly session: Value;\n\n  /** @internal */\n  readonly sendBuffer: Envelope[];\n\n  /** @internal */\n  readonly downlinks: BTree<Uri, BTree<Uri, HostDownlink>>;\n\n  /** @internal */\n  readonly downlinkCount: number;\n\n  isIdle(): boolean {\n    return this.sendBuffer.length === 0 && this.downlinkCount === 0;\n  }\n\n  /** @internal */\n  readonly uriCache: UriCache;\n\n  override resolve(relative: AnyUri): Uri {\n    return this.uriCache.resolve(relative);\n  }\n\n  override unresolve(absolute: AnyUri): Uri {\n    return this.uriCache.unresolve(absolute);\n  }\n\n  override authenticate(credentials: AnyValue): void {\n    credentials = Value.fromAny(credentials);\n    if (!credentials.equals(this.options.credentials)) {\n      this.options.credentials = credentials;\n      if (this.isConnected()) {\n        const request = new AuthRequest(credentials);\n        this.push(request);\n      } else {\n        this.open();\n      }\n    }\n  }\n\n  override openDownlink(downlink: HostDownlink): void {\n    this.clearIdle();\n    const nodeUri = this.resolve(downlink.nodeUri);\n    const laneUri = downlink.laneUri;\n    if (this.downlinkCount === 0) {\n      this.open();\n    }\n    let nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks === void 0) {\n      nodeDownlinks = new BTree();\n      this.downlinks.set(nodeUri, nodeDownlinks);\n    }\n    if (nodeDownlinks.get(laneUri) !== void 0) {\n      throw new Error(\"duplicate downlink\");\n    }\n    nodeDownlinks.set(laneUri, downlink);\n    (this as Mutable<this>).downlinkCount += 1;\n    downlink.openUp(this);\n    if (this.isConnected()) {\n      downlink.hostDidConnect(this);\n    }\n  }\n\n  override unlinkDownlink(downlink: HostDownlink): void {\n    const nodeUri = this.resolve(downlink.nodeUri);\n    const laneUri = downlink.laneUri;\n    const nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks !== void 0 && nodeDownlinks.get(laneUri) && this.isConnected()) {\n      const request = new UnlinkRequest(this.unresolve(nodeUri), laneUri, Value.absent());\n      downlink.onUnlinkRequest(request, this);\n      this.push(request);\n    }\n  }\n\n  override closeDownlink(downlink: HostDownlink): void {\n    const nodeUri = this.resolve(downlink.nodeUri);\n    const laneUri = downlink.laneUri;\n    const nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks !== void 0) {\n      if (nodeDownlinks.get(laneUri)) {\n        (this as Mutable<this>).downlinkCount -= 1;\n        nodeDownlinks.delete(laneUri);\n        if (nodeDownlinks.isEmpty()) {\n          this.downlinks.delete(nodeUri);\n        }\n        if (this.downlinkCount === 0) {\n          this.watchIdle();\n        }\n        downlink.closeUp(this);\n      }\n    }\n  }\n\n  override command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void {\n    nodeUri = Uri.fromAny(nodeUri);\n    nodeUri = this.resolve(nodeUri);\n    laneUri = Uri.fromAny(laneUri);\n    body = Value.fromAny(body);\n    const message = new CommandMessage(this.unresolve(nodeUri), laneUri as Uri, body);\n    this.push(message);\n  }\n\n  protected onEnvelope(envelope: Envelope): void {\n    if (envelope instanceof EventMessage) {\n      this.onEventMessage(envelope);\n    } else if (envelope instanceof CommandMessage) {\n      this.onCommandMessage(envelope);\n    } else if (envelope instanceof LinkRequest) {\n      this.onLinkRequest(envelope);\n    } else if (envelope instanceof LinkedResponse) {\n      this.onLinkedResponse(envelope);\n    } else if (envelope instanceof SyncRequest) {\n      this.onSyncRequest(envelope);\n    } else if (envelope instanceof SyncedResponse) {\n      this.onSyncedResponse(envelope);\n    } else if (envelope instanceof UnlinkRequest) {\n      this.onUnlinkRequest(envelope);\n    } else if (envelope instanceof UnlinkedResponse) {\n      this.onUnlinkedResponse(envelope);\n    } else if (envelope instanceof AuthRequest) {\n      this.onAuthRequest(envelope);\n    } else if (envelope instanceof AuthedResponse) {\n      this.onAuthedResponse(envelope);\n    } else if (envelope instanceof DeauthRequest) {\n      this.onDeauthRequest(envelope);\n    } else if (envelope instanceof DeauthedResponse) {\n      this.onDeauthedResponse(envelope);\n    } else {\n      this.onUnknownEnvelope(envelope);\n    }\n  }\n\n  protected onEventMessage(message: EventMessage): void {\n    const nodeUri = this.resolve(message.node);\n    const laneUri = message.lane;\n    const nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks !== void 0) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink !== void 0) {\n        const resolvedMessage = message.withNode(nodeUri);\n        downlink.onEventMessage(resolvedMessage, this);\n      }\n    }\n  }\n\n  protected onCommandMessage(message: CommandMessage): void {\n    // TODO: client agents\n  }\n\n  protected onLinkRequest(request: LinkRequest): void {\n    // TODO: client agents\n  }\n\n  protected onLinkedResponse(response: LinkedResponse): void {\n    const nodeUri = this.resolve(response.node);\n    const laneUri = response.lane;\n    const nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks !== void 0) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink !== void 0) {\n        const resolvedResponse = response.withNode(nodeUri);\n        downlink.onLinkedResponse(resolvedResponse, this);\n      }\n    }\n  }\n\n  protected onSyncRequest(request: SyncRequest): void {\n    // TODO: client agents\n  }\n\n  protected onSyncedResponse(response: SyncedResponse): void {\n    const nodeUri = this.resolve(response.node);\n    const laneUri = response.lane;\n    const nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks !== void 0) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink !== void 0) {\n        const resolvedResponse = response.withNode(nodeUri);\n        downlink.onSyncedResponse(resolvedResponse, this);\n      }\n    }\n  }\n\n  protected onUnlinkRequest(request: UnlinkRequest): void {\n    // TODO: client agents\n  }\n\n  protected onUnlinkedResponse(response: UnlinkedResponse): void {\n    const nodeUri = this.resolve(response.node);\n    const laneUri = response.lane;\n    const nodeDownlinks = this.downlinks.get(nodeUri);\n    if (nodeDownlinks !== void 0) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink !== void 0) {\n        const resolvedResponse = response.withNode(nodeUri);\n        downlink.onUnlinkedResponse(resolvedResponse, this);\n      }\n    }\n  }\n\n  protected onAuthRequest(request: AuthRequest): void {\n    // TODO: client agents\n  }\n\n  protected onAuthedResponse(response: AuthedResponse): void {\n    (this as Mutable<this>).authenticated = true;\n    (this as Mutable<this>).session = response.body;\n    this.context.hostDidAuthenticate(response.body, this);\n  }\n\n  protected onDeauthRequest(request: DeauthRequest): void {\n    // TODO: client agents\n  }\n\n  protected onDeauthedResponse(response: DeauthedResponse): void {\n    (this as Mutable<this>).authenticated = false;\n    (this as Mutable<this>).session = Value.absent();\n    this.context.hostDidDeauthenticate(response.body, this);\n  }\n\n  protected onUnknownEnvelope(envelope: Envelope | string): void {\n    // nop\n  }\n\n  /** @internal */\n  reconnectTimer: number;\n\n  /** @internal */\n  reconnectTimeout: number;\n\n  /** @internal */\n  idleTimer: number;\n\n  protected onConnect(): void {\n    this.reconnectTimeout = 0;\n    this.context.hostDidConnect(this);\n    this.downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.hostDidConnect(this);\n      }, this);\n    }, this);\n  }\n\n  protected onDisconnect(): void {\n    (this as Mutable<this>).authenticated = false;\n    (this as Mutable<this>).session = Value.absent();\n    this.context.hostDidDisconnect(this);\n    this.downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.hostDidDisconnect(this);\n      }, this);\n    }, this);\n  }\n\n  protected onError(error?: unknown): void {\n    this.context.hostDidFail(error, this);\n    this.downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.hostDidFail(error, this);\n      }, this);\n    }, this);\n  }\n\n  protected reconnect(): void {\n    if (this.reconnectTimer === 0) {\n      if (this.reconnectTimeout === 0) {\n        this.reconnectTimeout = Math.floor(500 + 1000 * Math.random());\n      } else {\n        this.reconnectTimeout = Math.min(Math.floor(1.8 * this.reconnectTimeout), this.maxReconnectTimeout);\n      }\n      this.reconnectTimer = setTimeout(this.open.bind(this), this.reconnectTimeout) as any;\n    }\n  }\n\n  protected clearReconnect(): void {\n    if (this.reconnectTimer !== 0) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = 0;\n    }\n  }\n\n  protected watchIdle(): void {\n    if (this.idleTimer === 0 && this.isConnected() && this.isIdle()) {\n      this.idleTimer = setTimeout(this.checkIdle.bind(this), this.idleTimeout) as any;\n    }\n  }\n\n  protected clearIdle(): void {\n    if (this.idleTimer !== 0) {\n      clearTimeout(this.idleTimer);\n      this.idleTimer = 0;\n    }\n  }\n\n  protected checkIdle(): void {\n    if (this.isConnected() && this.isIdle()) {\n      this.close();\n    }\n  }\n\n  abstract override open(): void;\n\n  override close(): void {\n    this.context.closeHost(this);\n  }\n\n  override closeUp(): void {\n    this.downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.closeUp(this);\n      }, this);\n    }, this);\n  }\n\n  abstract override push(envelope: Envelope): void;\n\n  static readonly UnlinkDelay: number = 0;\n  static readonly MaxReconnectTimeout: number = 30000;\n  static readonly IdleTimeout: number = 1000;\n  static readonly SendBufferSize: number = 1024;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {Uri} from \"@swim/uri\";\nimport {Envelope, CommandMessage, AuthRequest} from \"@swim/warp\";\nimport type {HostContext} from \"./HostContext\";\nimport type {HostOptions} from \"./Host\";\nimport {RemoteHost} from \"./RemoteHost\";\n\n/** @public */\nexport type WebSocketConstructor = {new(url: string, protocols?: string | string[]): WebSocket};\n\n/** @public */\nexport interface WebSocketHostOptions extends HostOptions {\n  protocols?: string | string[];\n  WebSocket?: WebSocketConstructor;\n}\n\n/** @internal */\nexport class WebSocketHost extends RemoteHost {\n  constructor(context: HostContext, hostUri: Uri, options: WebSocketHostOptions = {}) {\n    super(context, hostUri, options);\n    this.socket = null;\n  }\n\n  override readonly options!: WebSocketHostOptions;\n\n  /** @internal */\n  readonly socket: WebSocket | null;\n\n  override isConnected(): boolean {\n    return this.socket !== null && this.socket.readyState === this.socket.OPEN;\n  }\n\n  override open(): void {\n    this.clearReconnect();\n    let socket = this.socket;\n    if (socket === null) {\n      //const WebSocket = this.WebSocket;\n      let WebSocketConstructor: WebSocketConstructor;\n      if (this.options.WebSocket !== void 0) {\n        WebSocketConstructor = this.options.WebSocket;\n      } else if (typeof WebSocket !== \"undefined\") {\n        WebSocketConstructor = WebSocket;\n      } else if (WebSocketHost.WebSocket !== null) {\n        WebSocketConstructor = WebSocketHost.WebSocket;\n      } else {\n        throw new Error(\"Missing WebSocket implementation\");\n      }\n      let hostUri = this.hostUri;\n      const schemeName = hostUri.schemeName;\n      if (schemeName === \"warp\" || schemeName === \"swim\") {\n        hostUri = hostUri.withSchemeName(\"ws\");\n      } else if (schemeName === \"warps\" || schemeName === \"swims\") {\n        hostUri = hostUri.withSchemeName(\"wss\");\n      }\n      if (this.options.protocols !== void 0) {\n        socket = new WebSocketConstructor(hostUri.toString(), this.options.protocols);\n      } else {\n        socket = new WebSocketConstructor(hostUri.toString());\n      }\n      (this as Mutable<this>).socket = socket;\n      socket.onopen = this.onWebSocketOpen.bind(this);\n      socket.onmessage = this.onWebSocketMessage.bind(this);\n      socket.onclose = this.onWebSocketClose.bind(this);\n      socket.onerror = this.onWebSocketError.bind(this);\n    }\n  }\n\n  override close(): void {\n    this.clearReconnect();\n    this.clearIdle();\n    if (this.socket !== null) {\n      this.socket.close();\n      if (!this.context.isOnline()) {\n        this.onWebSocketClose(); // force close event\n      }\n    } else {\n      super.close();\n    }\n  }\n\n  override push(envelope: Envelope): void {\n    if (this.isConnected()) {\n      this.clearIdle();\n      const text = envelope.toRecon();\n      this.socket!.send(text);\n      this.watchIdle();\n    } else if (envelope instanceof CommandMessage) {\n      if (this.sendBuffer.length < this.sendBufferSize) {\n        this.sendBuffer.push(envelope);\n      } else {\n        throw new Error(\"send buffer overflow\");\n      }\n      this.open();\n    }\n  }\n\n  protected onWebSocketOpen(): void {\n    if (this.isConnected()) {\n      const credentials = this.credentials;\n      if (credentials.isDefined()) {\n        const request = new AuthRequest(credentials);\n        this.push(request);\n      }\n      this.onConnect();\n      let envelope;\n      while ((envelope = this.sendBuffer.shift()) && this.isConnected()) {\n        this.push(envelope);\n      }\n      this.watchIdle();\n    } else {\n      this.close();\n    }\n  }\n\n  protected onWebSocketMessage(message: MessageEvent): void {\n    const data = message.data;\n    if (typeof data === \"string\") {\n      const envelope = Envelope.parseRecon(data);\n      if (envelope !== null) {\n        this.onEnvelope(envelope);\n      } else {\n        this.onUnknownEnvelope(data);\n      }\n    }\n  }\n\n  protected onWebSocketClose(): void {\n    const socket = this.socket;\n    if (socket !== null) {\n      socket.onopen = null;\n      socket.onmessage = null;\n      socket.onclose = null;\n      socket.onerror = null;\n      (this as Mutable<this>).socket = null;\n    }\n    this.onDisconnect();\n    this.clearIdle();\n    if (!this.isIdle()) {\n      if (this.context.isOnline()) {\n        this.reconnect();\n      }\n    } else {\n      this.close();\n    }\n  }\n\n  protected onWebSocketError(): void {\n    if (this.socket !== null) {\n      this.socket.close();\n      if (!this.context.isOnline()) {\n        this.onWebSocketClose(); // force close event\n      } else {\n        this.onError();\n      }\n    }\n  }\n\n  /** @internal */\n  static WebSocket: WebSocketConstructor | null = null;\n}\nimport(\"ws\").then((ws: typeof import(\"ws\")): void => {\n  WebSocketHost.WebSocket = ws.WebSocket as unknown as WebSocketConstructor;\n}, (reason: unknown): void => {\n  // nop\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays} from \"@swim/util\";\nimport type {Uri} from \"@swim/uri\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {\n  EventMessage,\n  LinkRequest,\n  LinkedResponse,\n  SyncRequest,\n  SyncedResponse,\n  UnlinkRequest,\n  UnlinkedResponse,\n} from \"@swim/warp\";\nimport type {HostDownlink} from \"../host/HostDownlink\";\nimport type {Host} from \"../host/Host\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport type {DownlinkType, Downlink} from \"./Downlink\";\n\n/** @internal */\nexport abstract class DownlinkModel implements HostDownlink {\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio: number = 0, rate: number = 0, body: Value = Value.absent()) {\n    this.context = context;\n    this.hostUri = hostUri;\n    this.nodeUri = nodeUri;\n    this.laneUri = laneUri;\n    this.prio = prio;\n    this.rate = rate;\n    this.body = body;\n    this.views = Arrays.empty;\n    this.host = null;\n    this.status = 0;\n  }\n\n  readonly context: DownlinkContext;\n\n  readonly hostUri: Uri;\n\n  readonly nodeUri: Uri;\n\n  readonly laneUri: Uri;\n\n  readonly prio: number;\n\n  readonly rate: number;\n\n  readonly body: Value;\n\n  readonly views: ReadonlyArray<Downlink>;\n\n  readonly host: Host | null;\n\n  /** @internal */\n  readonly status: number;\n\n  abstract readonly type: DownlinkType;\n\n  keepLinked(): boolean {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      if (views[i]!.keepLinked()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  keepSynced(): boolean {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      if (this.views[i]!.keepSynced()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  get unlinkDelay(): number {\n    const host = this.host;\n    return host !== null ? host.unlinkDelay : 0;\n  }\n\n  isConnected(): boolean {\n    const host = this.host;\n    return host !== null ? host.isConnected() : false;\n  }\n\n  isAuthenticated(): boolean {\n    const host = this.host;\n    return host !== null ? host.isAuthenticated() : false;\n  }\n\n  isLinked(): boolean {\n    return (this.status & DownlinkModel.Linked) !== 0;\n  }\n\n  isSynced(): boolean {\n    return (this.status & DownlinkModel.Synced) !== 0;\n  }\n\n  get session(): Value {\n    const host = this.host;\n    return host !== null ? host.session : Value.absent();\n  }\n\n  addDownlink(view: Downlink): void {\n    (this as Mutable<this>).views = Arrays.inserted(view, this.views);\n  }\n\n  removeDownlink(view: Downlink): void {\n    const oldViews = this.views;\n    const newViews = Arrays.removed(view, oldViews);\n    if (oldViews !== newViews) {\n      (this as Mutable<this>).views = newViews;\n      view.closeUp();\n      if (newViews.length === 0) {\n        const unlinkDelay = this.unlinkDelay;\n        if (unlinkDelay < 0) {\n          this.unlink();\n        } else {\n          setTimeout(this.doUnlink.bind(this), unlinkDelay);\n        }\n      }\n    }\n  }\n\n  onEventMessage(message: EventMessage, host: Host): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onEventMessage(message);\n    }\n  }\n\n  onCommandMessage(body: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onCommandMessage(body);\n    }\n  }\n\n  onLinkRequest(request: LinkRequest): void {\n    (this as Mutable<this>).status |= DownlinkModel.Linking;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onLinkRequest(request);\n    }\n  }\n\n  onLinkedResponse(response: LinkedResponse, host: Host): void {\n    (this as Mutable<this>).status = this.status & ~DownlinkModel.Linking | DownlinkModel.Linked;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onLinkedResponse(response);\n    }\n  }\n\n  onSyncRequest(request: SyncRequest): void {\n    (this as Mutable<this>).status |= DownlinkModel.Syncing;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onSyncRequest(request);\n    }\n  }\n\n  onSyncedResponse(response: SyncedResponse, host: Host): void {\n    (this as Mutable<this>).status = this.status & ~DownlinkModel.Syncing | DownlinkModel.Synced;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onSyncedResponse(response);\n    }\n  }\n\n  onUnlinkRequest(request: UnlinkRequest, host: Host): void {\n    (this as Mutable<this>).status = this.status & ~(DownlinkModel.Linking | DownlinkModel.Syncing) | DownlinkModel.Unlinking;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.onUnlinkRequest(request);\n    }\n  }\n\n  onUnlinkedResponse(response: UnlinkedResponse, host: Host): void {\n    (this as Mutable<this>).status &= ~DownlinkModel.Unlinking;\n    const views = this.views;\n    if (views.length === 0 || this.status !== 0) {\n      for (let i = 0, n = views.length; i < n; i += 1) {\n        views[i]!.onUnlinkedResponse(response);\n      }\n      this.close();\n    } else { // concurrently relinked\n      if (this.keepSynced()) {\n        this.sync();\n      } else {\n        this.link();\n      }\n    }\n  }\n\n  hostDidConnect(host: Host): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.hostDidConnect();\n    }\n    if (this.keepSynced()) {\n      this.sync();\n    } else {\n      this.link();\n    }\n  }\n\n  hostDidDisconnect(host: Host): void {\n    (this as Mutable<this>).status = 0;\n    let keepLinked = false;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      const view = views[i]!;\n      view.hostDidDisconnect();\n      keepLinked = keepLinked || view.keepLinked();\n    }\n    if (!keepLinked) {\n      this.close();\n    }\n  }\n\n  hostDidFail(error: unknown, host: Host): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.hostDidFail(error);\n    }\n  }\n\n  command(body: AnyValue): void {\n    body = Value.fromAny(body);\n    this.onCommandMessage(body);\n    this.host!.command(this.nodeUri, this.laneUri, body);\n  }\n\n  sync(): void {\n    const nodeUri = this.host!.unresolve(this.nodeUri);\n    const request = new SyncRequest(nodeUri, this.laneUri, this.prio, this.rate, this.body);\n    this.onSyncRequest(request);\n    this.host!.push(request);\n  }\n\n  link(): void {\n    const nodeUri = this.host!.unresolve(this.nodeUri);\n    const request = new LinkRequest(nodeUri, this.laneUri, this.prio, this.rate, this.body);\n    this.onLinkRequest(request);\n    this.host!.push(request);\n  }\n\n  unlink(): void {\n    (this as Mutable<this>).status = DownlinkModel.Unlinking;\n    this.context.unlinkDownlink(this);\n  }\n\n  protected doUnlink(): void {\n    if (this.views.length === 0) {\n      this.unlink();\n    }\n  }\n\n  close(): void {\n    this.context.closeDownlink(this);\n  }\n\n  openUp(host: Host): void {\n    (this as Mutable<this>).host = host;\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      this.views[i]!.openUp(host);\n    }\n  }\n\n  closeUp(): void {\n    const views = this.views;\n    (this as Mutable<this>).views = Arrays.empty;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.closeUp();\n    }\n  }\n\n  static readonly Linking: number = 1 << 0;\n  static readonly Linked: number = 1 << 1;\n  static readonly Syncing: number = 1 << 2;\n  static readonly Synced: number = 1 << 3;\n  static readonly Unlinking: number = 1 << 4;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Lazy, Mutable, Arrays} from \"@swim/util\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {Item, Attr, AnyValue, Value, Record, Form} from \"@swim/structure\";\nimport type {\n  EventMessage,\n  LinkRequest,\n  LinkedResponse,\n  SyncRequest,\n  SyncedResponse,\n  UnlinkRequest,\n  UnlinkedResponse,\n} from \"@swim/warp\";\nimport type {Host} from \"../host/Host\";\nimport type {DownlinkOwner} from \"./DownlinkOwner\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport type {DownlinkModel} from \"./DownlinkModel\";\n\n/** @public */\nexport type DownlinkType = \"event\" | \"list\" | \"map\" | \"value\";\n\n/** @public */\nexport type DownlinkOnEvent = (body: Value, downlink: Downlink) => void;\n/** @public */\nexport type DownlinkOnCommand = (body: Value, downlink: Downlink) => void;\n/** @public */\nexport type DownlinkWillLink = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidLink = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkWillSync = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidSync = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkWillUnlink = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidUnlink = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidConnect = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidDisconnect = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidClose = (downlink: Downlink) => void;\n/** @public */\nexport type DownlinkDidFail = (error: unknown, downlink: Downlink) => void;\n\n/** @public */\nexport interface DownlinkObserver {\n  onEvent?: DownlinkOnEvent;\n  onCommand?: DownlinkOnCommand;\n  willLink?: DownlinkWillLink;\n  didLink?: DownlinkDidLink;\n  willSync?: DownlinkWillSync;\n  didSync?: DownlinkDidSync;\n  willUnlink?: DownlinkWillUnlink;\n  didUnlink?: DownlinkDidUnlink;\n  didConnect?: DownlinkDidConnect;\n  didDisconnect?: DownlinkDidDisconnect;\n  didClose?: DownlinkDidClose;\n  didFail?: DownlinkDidFail;\n}\n\n/** @public */\nexport interface DownlinkInit extends DownlinkObserver {\n  hostUri?: AnyUri;\n  nodeUri?: AnyUri;\n  laneUri?: AnyUri;\n  prio?: number;\n  rate?: number;\n  body?: AnyValue;\n  type?: DownlinkType;\n}\n\n/** @internal */\nexport const enum DownlinkFlags {\n  KeepLinked = 1,\n  KeepSynced = 2,\n  KeepLinkedSynced = KeepLinked | KeepSynced,\n}\n\n/** @public */\nexport abstract class Downlink {\n  /** @internal */\n  constructor(context: DownlinkContext, owner: DownlinkOwner | null, init?: DownlinkInit,\n              hostUri: Uri = Uri.empty(), nodeUri: Uri = Uri.empty(), laneUri: Uri = Uri.empty(),\n              prio: number = 0, rate: number = 0, body: Value = Value.absent(),\n              flags: number = 0, observers?: ReadonlyArray<DownlinkObserver> | DownlinkObserver) {\n    let observer: DownlinkObserver | undefined;\n    if (observers === void 0) {\n      observers = Arrays.empty\n    } else if (!Array.isArray(observers)) {\n      observer = observers as DownlinkObserver;\n      observers = [observer] as ReadonlyArray<DownlinkObserver>;\n    }\n    if (init !== void 0) {\n      hostUri = init.hostUri !== void 0 ? Uri.fromAny(init.hostUri) : hostUri;\n      nodeUri = init.nodeUri !== void 0 ? Uri.fromAny(init.nodeUri) : nodeUri;\n      laneUri = init.laneUri !== void 0 ? Uri.fromAny(init.laneUri) : laneUri;\n      prio = init.prio !== void 0 ? init.prio : prio;\n      rate = init.rate !== void 0 ? init.rate : rate;\n      body = init.body !== void 0 ? Value.fromAny(init.body) : body;\n      observer = observer ?? {};\n      observers = Arrays.inserted(observer, observers);\n      observer.onEvent = init.onEvent ?? observer.onEvent;\n      observer.onCommand = init.onCommand ?? observer.onCommand;\n      observer.willLink = init.willLink ?? observer.willLink;\n      observer.didLink = init.didLink ?? observer.didLink;\n      observer.willSync = init.willSync ?? observer.willSync;\n      observer.didSync = init.didSync ?? observer.didSync;\n      observer.willUnlink = init.willUnlink ?? observer.willUnlink;\n      observer.didUnlink = init.didUnlink ?? observer.didUnlink;\n      observer.didConnect = init.didConnect ?? observer.didConnect;\n      observer.didDisconnect = init.didDisconnect ?? observer.didDisconnect;\n      observer.didClose = init.didClose ?? observer.didClose;\n      observer.didFail = init.didFail ?? observer.didFail;\n    }\n    this.context = context;\n    this.owner = owner;\n    this.ownHostUri = hostUri;\n    this.ownNodeUri = nodeUri;\n    this.ownLaneUri = laneUri;\n    this.ownPrio = prio;\n    this.ownRate = rate;\n    this.ownBody = body;\n    this.flags = flags;\n    this.model = null;\n    this.observers = observers;\n  }\n\n  /** @internal */\n  readonly context: DownlinkContext;\n\n  /** @internal */\n  readonly owner: DownlinkOwner | null;\n  \n  /** @internal */\n  readonly ownHostUri: Uri;\n  \n  /** @internal */\n  readonly ownNodeUri: Uri;\n  \n  /** @internal */\n  readonly ownLaneUri: Uri;\n  \n  /** @internal */\n  readonly ownPrio: number;\n  \n  /** @internal */\n  readonly ownRate: number;\n  \n  /** @internal */\n  readonly ownBody: Value;\n\n  /** @internal */\n  readonly flags: number;\n\n  /** @internal */\n  readonly model: DownlinkModel | null;\n\n  /** @internal */\n  readonly observers: ReadonlyArray<DownlinkObserver>;\n\n  abstract readonly type: DownlinkType;\n\n  /** @internal */\n  protected abstract copy(context: DownlinkContext, owner: DownlinkOwner | null,\n                          hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                          body: Value, flags: number, observers: ReadonlyArray<DownlinkObserver>): Downlink;\n\n  hostUri(): Uri;\n  hostUri(hostUri: AnyUri): Downlink;\n  hostUri(hostUri?: AnyUri): Uri | Downlink {\n    if (hostUri === void 0) {\n      return this.ownHostUri;\n    } else {\n      hostUri = Uri.fromAny(hostUri);\n      return this.copy(this.context, this.owner, hostUri as Uri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers);\n    }\n  }\n\n  nodeUri(): Uri;\n  nodeUri(nodeUri: AnyUri): Downlink;\n  nodeUri(nodeUri?: AnyUri): Uri | Downlink {\n    if (nodeUri === void 0) {\n      return this.ownNodeUri;\n    } else {\n      nodeUri = Uri.fromAny(nodeUri);\n      return this.copy(this.context, this.owner, this.ownHostUri, nodeUri as Uri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers);\n    }\n  }\n\n  laneUri(): Uri;\n  laneUri(laneUri: AnyUri): Downlink;\n  laneUri(laneUri?: AnyUri): Uri | Downlink {\n    if (laneUri === void 0) {\n      return this.ownLaneUri;\n    } else {\n      laneUri = Uri.fromAny(laneUri);\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, laneUri as Uri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers);\n    }\n  }\n\n  prio(): number;\n  prio(prio: number): Downlink;\n  prio(prio?: number): number | Downlink {\n    if (prio === void 0) {\n      return this.ownPrio;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       prio, this.ownRate, this.ownBody, this.flags, this.observers);\n    }\n  }\n\n  rate(): number;\n  rate(rate: number): Downlink;\n  rate(rate?: number): number | Downlink {\n    if (rate === void 0) {\n      return this.ownRate;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, rate, this.ownBody, this.flags, this.observers);\n    }\n  }\n\n  body(): Value;\n  body(body: AnyValue): Downlink;\n  body(body?: AnyValue): Value | Downlink {\n    if (body === void 0) {\n      return this.ownBody;\n    } else {\n      body = Value.fromAny(body);\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, body, this.flags, this.observers);\n    }\n  }\n\n  keepLinked(): boolean;\n  keepLinked(keepLinked: boolean): Downlink;\n  keepLinked(keepLinked?: boolean): boolean | Downlink {\n    if (keepLinked === void 0) {\n      return (this.flags & DownlinkFlags.KeepLinked) !== 0;\n    } else {\n      const flags = keepLinked ? this.flags | DownlinkFlags.KeepLinked : this.flags & ~DownlinkFlags.KeepLinked;\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, flags, this.observers);\n    }\n  }\n\n  keepSynced(): boolean;\n  keepSynced(keepSynced: boolean): Downlink;\n  keepSynced(keepSynced?: boolean): boolean | Downlink {\n    if (keepSynced === void 0) {\n      return (this.flags & DownlinkFlags.KeepSynced) !== 0;\n    } else {\n      const flags = keepSynced ? this.flags | DownlinkFlags.KeepSynced : this.flags & ~DownlinkFlags.KeepSynced;\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, flags, this.observers);\n    }\n  }\n\n  observe(observer: DownlinkObserver): this {\n    (this as Mutable<this>).observers = Arrays.inserted(observer, this.observers);\n    return this;\n  }\n\n  unobserve(observer: unknown): this {\n    const oldObservers = this.observers;\n    const n = oldObservers.length;\n    for (let i = 0; i < n; i += 1) {\n      const oldObserver = oldObservers[i]! as {[key: string]: unknown};\n      let found = oldObserver === observer; // check object identity\n      if (!found) {\n        for (const key in oldObserver) { // check property identity\n          if (oldObserver[key] === observer) {\n            found = true;\n            break;\n          }\n        }\n      }\n      if (found) {\n        if (n > 1) {\n          const newObservers = new Array<DownlinkObserver>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newObservers[j] = oldObservers[j]!;\n          }\n          for (let j = i + 1; j < n; j += 1) {\n            newObservers[j - 1] = oldObservers[j]!;\n          }\n          (this as Mutable<this>).observers = newObservers;\n        } else {\n          (this as Mutable<this>).observers = Arrays.empty;\n        }\n        break;\n      }\n    }\n    return this;\n  }\n\n  onEvent(onEvent: DownlinkOnEvent): this {\n    return this.observe({onEvent});\n  }\n\n  onCommand(onCommand: DownlinkOnCommand): this {\n    return this.observe({onCommand});\n  }\n\n  willLink(willLink: DownlinkWillLink): this {\n    return this.observe({willLink});\n  }\n\n  didLink(didLink: DownlinkDidLink): this {\n    return this.observe({didLink});\n  }\n\n  willSync(willSync: DownlinkWillSync): this {\n    return this.observe({willSync});\n  }\n\n  didSync(didSync: DownlinkDidSync): this {\n    return this.observe({didSync});\n  }\n\n  willUnlink(willUnlink: DownlinkWillUnlink): this {\n    return this.observe({willUnlink});\n  }\n\n  didUnlink(didUnlink: DownlinkDidUnlink): this {\n    return this.observe({didUnlink});\n  }\n\n  didConnect(didConnect: DownlinkDidConnect): this {\n    return this.observe({didConnect});\n  }\n\n  didDisconnect(didDisconnect: DownlinkDidDisconnect): this {\n    return this.observe({didDisconnect});\n  }\n\n  didClose(didClose: DownlinkDidClose): this {\n    return this.observe({didClose});\n  }\n\n  didFail(didFail: DownlinkDidFail): this {\n    return this.observe({didFail});\n  }\n\n  isConnected(): boolean {\n    const model = this.model;\n    return model !== null && model.isConnected();\n  }\n\n  isAuthenticated(): boolean {\n    const model = this.model;\n    return model !== null && model.isAuthenticated();\n  }\n\n  isLinked(): boolean {\n    const model = this.model;\n    return model !== null && model.isLinked();\n  }\n\n  isSynced(): boolean {\n    const model = this.model;\n    return model !== null && model.isSynced();\n  }\n\n  get session(): Value {\n    const model = this.model;\n    return model !== null ? model.session : Value.absent();\n  }\n\n  /** @internal */\n  onEventMessage(message: EventMessage): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.onEvent !== void 0) {\n        observer.onEvent(message.body, this);\n      }\n    }\n  }\n\n  /** @internal */\n  onCommandMessage(body: Value): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.onCommand !== void 0) {\n        observer.onCommand(body, this);\n      }\n    }\n  }\n\n  /** @internal */\n  onLinkRequest(request?: LinkRequest): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willLink !== void 0) {\n        observer.willLink(this);\n      }\n    }\n  }\n\n  /** @internal */\n  onLinkedResponse(response?: LinkedResponse): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didLink !== void 0) {\n        observer.didLink(this);\n      }\n    }\n  }\n\n  /** @internal */\n  onSyncRequest(request?: SyncRequest): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willSync !== void 0) {\n        observer.willSync(this);\n      }\n    }\n  }\n\n  /** @internal */\n  onSyncedResponse(response?: SyncedResponse): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didSync !== void 0) {\n        observer.didSync(this);\n      }\n    }\n  }\n\n  /** @internal */\n  onUnlinkRequest(request?: UnlinkRequest): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willUnlink !== void 0) {\n        observer.willUnlink(this);\n      }\n    }\n  }\n\n  /** @internal */\n  onUnlinkedResponse(response?: UnlinkedResponse): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didUnlink !== void 0) {\n        observer.didUnlink(this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidConnect(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didConnect !== void 0) {\n        observer.didConnect(this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidDisconnect(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDisconnect !== void 0) {\n        observer.didDisconnect(this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidFail(error: unknown): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didFail !== void 0) {\n        observer.didFail(error, this);\n      }\n    }\n  }\n\n  command(body: AnyValue): void {\n    this.model!.command(body);\n  }\n\n  abstract open(): this;\n\n  close(): void {\n    const owner = this.owner;\n    if (owner !== null) {\n      owner.removeDownlink(this);\n    }\n    const model = this.model;\n    if (model !== null) {\n      model.removeDownlink(this);\n    }\n  }\n\n  /** @internal */\n  openUp(host: Host): void {\n    // nop\n  }\n\n  /** @internal */\n  closeUp(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didClose !== void 0) {\n        observer.didClose(this);\n      }\n    }\n  }\n\n  @Lazy\n  static initForm(): Form<DownlinkInit | undefined> {\n    return new DownlinkInitForm();\n  }\n}\n\n/** @internal */\nclass DownlinkInitForm extends Form<DownlinkInit | undefined> {\n  declare readonly tag: string | undefined; // getter defined below to work around useDefineForClassFields lunacy\n\n  override mold(init: DownlinkInit | undefined): Item {\n    if (init !== void 0) {\n      const header = Record.create();\n      if (init.hostUri !== void 0) {\n        header.slot(\"host\", Uri.fromAny(init.hostUri).toString());\n      }\n      if (init.nodeUri !== void 0) {\n        header.slot(\"node\", Uri.fromAny(init.nodeUri).toString());\n      }\n      if (init.laneUri !== void 0) {\n        header.slot(\"lane\", Uri.fromAny(init.laneUri).toString());\n      }\n      if (init.prio !== void 0) {\n        header.slot(\"prio\", init.prio);\n      }\n      if (init.rate !== void 0) {\n        header.slot(\"rate\", init.rate);\n      }\n      if (init.body !== void 0) {\n        header.slot(\"body\", init.body);\n      }\n      if (init.type !== void 0) {\n        header.slot(\"type\", init.type);\n      }\n      return Record.of(Attr.of(\"link\", header));\n    } else {\n      return Item.extant();\n    }\n  }\n\n  override cast(item: Item): DownlinkInit | undefined {\n    const value = item.toValue();\n    const header = value.get(\"link\");\n    if (header.isDefined()) {\n      const init = {} as DownlinkInit;\n      const host = header.get(\"host\");\n      if (host.isDefined()) {\n        init.hostUri = host.cast(Uri.form());\n      }\n      const node = header.get(\"node\");\n      if (node.isDefined()) {\n        init.nodeUri = node.cast(Uri.form());\n      }\n      const lane = header.get(\"lane\");\n      if (lane.isDefined()) {\n        init.laneUri = lane.cast(Uri.form());\n      }\n      const prio = header.get(\"prio\");\n      if (prio.isDefined()) {\n        init.prio = prio.numberValue();\n      }\n      const rate = header.get(\"rate\");\n      if (rate.isDefined()) {\n        init.rate = rate.numberValue();\n      }\n      const body = header.get(\"body\");\n      if (body.isDefined()) {\n        init.body = body;\n      }\n      const type = header.get(\"type\");\n      if (type.isDefined()) {\n        init.type = type.stringValue() as DownlinkType;\n      }\n      return init;\n    }\n    return void 0;\n  }\n}\nObject.defineProperty(DownlinkInitForm.prototype, \"tag\", {\n  get(this: DownlinkInitForm): string | undefined {\n    return \"link\";\n  },\n  configurable: true,\n});\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Value} from \"@swim/structure\";\nimport type {Uri} from \"@swim/uri\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport type {DownlinkType} from \"./Downlink\";\nimport type {EventDownlink} from \"./EventDownlink\";\n\n/** @internal */\nexport class EventDownlinkModel extends DownlinkModel {\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n  }\n\n  override views!: ReadonlyArray<EventDownlink>;\n\n  override get type(): DownlinkType {\n    return \"event\";\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {AnyValue, Value} from \"@swim/structure\";\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport type {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {EventDownlinkModel} from \"./EventDownlinkModel\";\n\n/** @public */\nexport interface EventDownlinkObserver extends DownlinkObserver {\n}\n\n/** @public */\nexport interface EventDownlinkInit extends EventDownlinkObserver, DownlinkInit {\n}\n\n/** @public */\nexport class EventDownlink extends Downlink {\n  /** @internal */\n  constructor(context: DownlinkContext, owner: DownlinkOwner | null, init?: EventDownlinkInit,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number,\n              rate?: number, body?: Value, flags: number = DownlinkFlags.KeepLinked,\n              observers?: ReadonlyArray<EventDownlinkObserver> | EventDownlinkObserver) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n  }\n\n  /** @internal */\n  override readonly model!: EventDownlinkModel | null;\n\n  /** @internal */\n  override readonly observers!: ReadonlyArray<EventDownlinkObserver>;\n\n  override get type(): DownlinkType {\n    return \"event\";\n  }\n\n  /** @internal */\n  protected override copy(context: DownlinkContext, owner: DownlinkOwner | null,\n                          hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                          body: Value, flags: number, observers: ReadonlyArray<EventDownlinkObserver>): EventDownlink {\n    return new EventDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                             prio, rate, body, flags, observers);\n  }\n\n  override observe(observer: EventDownlinkObserver): this {\n    return super.observe(observer);\n  }\n\n  override open(): this {\n    const laneUri = this.ownLaneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this.ownNodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this.ownHostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this.context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model !== void 0) {\n      if (!(model instanceof EventDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n    } else {\n      model = new EventDownlinkModel(this.context, hostUri, nodeUri, laneUri,\n                                     this.ownPrio, this.ownRate, this.ownBody);\n      model.addDownlink(this);\n      this.context.openDownlink(model);\n    }\n    (this as Mutable<this>).model = model as EventDownlinkModel;\n    if (this.owner !== null) {\n      this.owner.addDownlink(this);\n    }\n    return this;\n  }\n}\n/** @public */\nexport interface EventDownlink {\n  hostUri(): Uri;\n  hostUri(hostUri: AnyUri): EventDownlink;\n\n  nodeUri(): Uri;\n  nodeUri(nodeUri: AnyUri): EventDownlink;\n\n  laneUri(): Uri;\n  laneUri(laneUri: AnyUri): EventDownlink;\n\n  prio(): number;\n  prio(prio: number): EventDownlink;\n\n  rate(): number;\n  rate(rate: number): EventDownlink;\n\n  body(): Value;\n  body(body: AnyValue): EventDownlink;\n\n  keepLinked(): boolean;\n  keepLinked(keepLinked: boolean): EventDownlink;\n\n  keepSynced(): boolean;\n  keepSynced(keepSynced: boolean): EventDownlink;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Cursor} from \"@swim/util\";\nimport {STree} from \"@swim/collections\";\nimport {Attr, Value, Record} from \"@swim/structure\";\nimport type {Uri} from \"@swim/uri\";\nimport type {EventMessage} from \"@swim/warp\";\nimport type {Host} from \"../host/Host\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport type {DownlinkType} from \"./Downlink\";\nimport type {ListDownlink} from \"./ListDownlink\";\n\n/** @internal */\nexport class ListDownlinkModel extends DownlinkModel {\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value, state: STree<Value, Value> = new STree()) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n    this.state = state;\n  }\n\n  override readonly views!: ReadonlyArray<ListDownlink<unknown>>;\n\n  /** @internal */\n  readonly state: STree<Value, Value>;\n\n  override get type(): DownlinkType {\n    return \"list\";\n  }\n\n  get length(): number {\n    return this.state.length;\n  }\n\n  isEmpty(): boolean {\n    return this.state.isEmpty();\n  }\n\n  get(index: number, key?: Value): Value {\n    return this.state.get(index, key) || Value.absent();\n  }\n\n  getEntry(index: number, key?: Value): [Value, Value] | undefined {\n    return this.state.getEntry(index, key);\n  }\n\n  set(index: number, newValue: Value, key?: Value): this {\n    if (key !== void 0) {\n      index = this.state.lookup(key, index);\n      if (index < 0) {\n        throw new RangeError(\"\" + key);\n      }\n    }\n    if (index < 0 || index >= this.state.length) {\n      throw new RangeError(\"\" + index);\n    }\n    newValue = this.listWillUpdate(index, newValue);\n    const oldEntry = this.state.getEntry(index)!;\n    this.state.set(index, newValue);\n    this.listDidUpdate(index, newValue, oldEntry[1]);\n    const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", index);\n    this.command(Attr.of(\"update\", header).concat(newValue));\n    return this;\n  }\n\n  insert(index: number, newValue: Value, key?: Value): this {\n    if (index < 0 || index > this.state.length) {\n      throw new RangeError(\"\" + index);\n    }\n    newValue = this.listWillUpdate(index, newValue);\n    this.state.insert(index, newValue, key);\n    const newEntry = this.state.getEntry(index)!;\n    this.listDidUpdate(index, newValue, Value.absent());\n    const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", index);\n    this.command(Attr.of(\"update\", header).concat(newValue));\n    return this;\n  }\n\n  remove(index: number, key?: Value): this {\n    if (key !== void 0) {\n      index = this.state.lookup(key, index);\n      if (index < 0) {\n        throw new RangeError(\"\" + key);\n      }\n    }\n    if (index < 0 || index > this.state.length) {\n      throw new RangeError(\"\" + index);\n    }\n    this.listWillRemove(index);\n    const oldEntry = this.state.getEntry(index)!;\n    this.state.remove(index);\n    this.listDidRemove(index, oldEntry[1]);\n    const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", index);\n    this.command(Record.create(1).attr(\"remove\", header));\n    return this;\n  }\n\n  push(...newValues: Value[]): number {\n    for (let i = 0; i < newValues.length; i += 1) {\n      const index = this.state.length + i;\n      const newValue = this.listWillUpdate(index, newValues[i]!);\n      this.state.insert(index, newValue);\n      const newEntry = this.state.getEntry(index)!;\n      this.listDidUpdate(index, newValue, Value.absent());\n      const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", index);\n      this.command(Attr.of(\"update\", header).concat(newValue));\n    }\n    return this.state.length;\n  }\n\n  pop(): Value {\n    const index = this.state.length - 1;\n    if (index >= 0) {\n      this.listWillRemove(index);\n      const oldEntry = this.state.getEntry(index)!;\n      this.state.remove(index);\n      this.listDidRemove(index, oldEntry[1]);\n      const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", index);\n      this.command(Record.create(1).attr(\"remove\", header));\n      return oldEntry[1];\n    } else {\n      return Value.absent();\n    }\n  }\n\n  unshift(...newValues: Value[]): number {\n    for (let i = newValues.length - 1; i >= 0; i -= 1) {\n      const newValue = this.listWillUpdate(0, newValues[i]!);\n      this.state.insert(0, newValue);\n      const newEntry = this.state.getEntry(0)!;\n      this.listDidUpdate(0, newValue, Value.absent());\n      const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", 0);\n      this.command(Attr.of(\"update\", header).concat(newValue));\n    }\n    return this.state.length;\n  }\n\n  shift(): Value {\n    if (this.state.length > 0) {\n      this.listWillRemove(0);\n      const oldEntry = this.state.getEntry(0)!;\n      this.state.remove(0);\n      this.listDidRemove(0, oldEntry[1]);\n      const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", 0);\n      this.command(Record.create(1).attr(\"remove\", header));\n      return oldEntry[1];\n    } else {\n      return Value.absent();\n    }\n  }\n\n  move(fromIndex: number, toIndex: number, key?: Value): this {\n    if (key !== void 0) {\n      fromIndex = this.state.lookup(key, fromIndex);\n      if (fromIndex < 0) {\n        throw new RangeError(\"\" + key);\n      }\n    }\n    if (fromIndex < 0 || fromIndex >= this.state.length) {\n      throw new RangeError(\"\" + fromIndex);\n    }\n    if (toIndex < 0 || toIndex >= this.state.length) {\n      throw new RangeError(\"\" + toIndex);\n    }\n    if (fromIndex !== toIndex) {\n      const entry = this.state.getEntry(fromIndex)!;\n      this.listWillMove(fromIndex, toIndex, entry[1]);\n      this.state.remove(fromIndex).insert(toIndex, entry[1], entry[0]);\n      this.listDidMove(fromIndex, toIndex, entry[1]);\n      const header = Record.create(2).slot(\"key\", entry[0]).slot(\"from\", fromIndex).slot(\"to\", toIndex);\n      this.command(Record.create(1).attr(\"move\", header));\n    }\n    return this;\n  }\n\n  splice(start: number, deleteCount?: number, ...newValues: Value[]): Value[] {\n    if (start < 0) {\n      start = this.state.length + start;\n    }\n    start = Math.min(Math.max(0, start), this.state.length);\n    if (deleteCount === void 0) {\n      deleteCount = this.state.length - start;\n    }\n    const deleted = [] as Value[];\n    for (let i = start, n = start + deleteCount; i < n; i += 1) {\n      this.listWillRemove(start);\n      const oldEntry = this.state.getEntry(start)!;\n      deleted.push(oldEntry[1]);\n      this.state.remove(start);\n      this.listDidRemove(start, oldEntry[1]);\n      const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", start);\n      this.command(Record.create(1).attr(\"remove\", header));\n    }\n    for (let i = 0; i < newValues.length; i += 1) {\n      const index = start + i;\n      const newValue = this.listWillUpdate(index, newValues[i]!);\n      this.state.insert(index, newValue);\n      const newEntry = this.state.getEntry(index)!;\n      this.listDidUpdate(index, newValue, Value.absent());\n      const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", index);\n      this.command(Attr.of(\"update\", header).concat(newValue));\n    }\n    return deleted;\n  }\n\n  clear(): void {\n    this.listWillClear();\n    this.state.clear();\n    this.listDidClear();\n    this.command(Record.create(1).attr(\"clear\"));\n  }\n\n  forEach<T>(callback: (value: Value, index: number, key: Value) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, value: Value, index: number, key: Value) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, value: Value, index: number, key: Value) => T | void,\n                thisArg?: S): T | undefined {\n    return this.state.forEach(callback, thisArg);\n  }\n\n  values(): Cursor<Value> {\n    return this.state.values();\n  }\n\n  keys(): Cursor<Value> {\n    return this.state.keys();\n  }\n\n  entries(): Cursor<[Value, Value]> {\n    return this.state.entries();\n  }\n\n  snapshot(): STree<Value, Value> {\n    return this.state.clone();\n  }\n\n  setState(state: STree<Value, Value>): void {\n    (this as Mutable<this>).state = state;\n  }\n\n  override onEventMessage(message: EventMessage, host: Host): void {\n    super.onEventMessage(message, host);\n    const event = message.body;\n    const tag = event.tag;\n    if (tag === \"update\") {\n      const header = event.head().toValue();\n      const index = this.state.lookup(header.get(\"key\"), header.get(\"index\").numberValue());\n      if (index >= 0) {\n        this.onUpdateEvent(index, event.body(), header.get(\"key\"));\n      } else {\n        this.onInsertEvent(header.get(\"index\").numberValue(0), event.body(), header.get(\"key\"));\n      }\n    } else if (tag === \"move\") {\n      const header = event.head().toValue();\n      const index = this.state.lookup(header.get(\"key\"), header.get(\"from\").numberValue());\n      if (index >= 0) {\n        this.onMoveEvent(index, header.get(\"to\").numberValue(0), header.get(\"key\"));\n      }\n    } else if (tag === \"remove\") {\n      const header = event.head().toValue();\n      const index = this.state.lookup(header.get(\"key\"), header.get(\"index\").numberValue());\n      if (index >= 0) {\n        this.onRemoveEvent(index, header.get(\"key\"));\n      }\n    } else if (tag === \"drop\") {\n      const header = event.head();\n      this.onDropEvent(header.numberValue(0));\n    } else if (tag === \"take\") {\n      const header = event.head();\n      this.onTakeEvent(header.numberValue(0));\n    } else if (tag === \"clear\") {\n      this.onClearEvent();\n    }\n  }\n\n  protected onInsertEvent(index: number, newValue: Value, key: Value): void {\n    newValue = this.listWillUpdate(index, newValue);\n    this.state.insert(index, newValue, key);\n    this.listDidUpdate(index, newValue, Value.absent());\n  }\n\n  protected onUpdateEvent(index: number, newValue: Value, key: Value): void {\n    newValue = this.listWillUpdate(index, newValue);\n    const oldValue = this.state.get(index) || Value.absent();\n    this.state.set(index, newValue);\n    this.listDidUpdate(index, newValue, oldValue);\n  }\n\n  protected onMoveEvent(fromIndex: number, toIndex: number, key: Value): void {\n    toIndex = Math.min(Math.max(0, toIndex), this.state.length);\n    if (fromIndex !== toIndex) {\n      const value = this.state.get(fromIndex) || Value.absent();\n      this.listWillMove(fromIndex, toIndex, value);\n      this.state.remove(fromIndex).insert(toIndex, value, key);\n      this.listDidMove(fromIndex, toIndex, value);\n    }\n  }\n\n  protected onRemoveEvent(index: number, key: Value): void {\n    this.listWillRemove(index);\n    const oldValue = this.state.get(index) || Value.absent();\n    this.state.remove(index);\n    this.listDidRemove(index, oldValue);\n  }\n\n  protected onDropEvent(lower: number): void {\n    this.listWillDrop(lower);\n    this.state.drop(lower);\n    this.listDidDrop(lower);\n  }\n\n  protected onTakeEvent(upper: number): void {\n    this.listWillTake(upper);\n    this.state.take(upper);\n    this.listDidTake(upper);\n  }\n\n  protected onClearEvent(): void {\n    this.listWillClear();\n    this.state.clear();\n    this.listDidClear();\n  }\n\n  protected listWillUpdate(index: number, newValue: Value): Value {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      newValue = views[i]!.listWillUpdate(index, newValue);\n    }\n    return newValue;\n  }\n\n  protected listDidUpdate(index: number, newValue: Value, oldValue: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listDidUpdate(index, newValue, oldValue);\n    }\n  }\n\n  protected listWillMove(fromIndex: number, toIndex: number, value: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listWillMove(fromIndex, toIndex, value);\n    }\n  }\n\n  protected listDidMove(fromIndex: number, toIndex: number, value: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listDidMove(fromIndex, toIndex, value);\n    }\n  }\n\n  protected listWillRemove(index: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listWillRemove(index);\n    }\n  }\n\n  protected listDidRemove(index: number, oldValue: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listDidRemove(index, oldValue);\n    }\n  }\n\n  protected listWillDrop(lower: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listWillDrop(lower);\n    }\n  }\n\n  protected listDidDrop(lower: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listDidDrop(lower);\n    }\n  }\n\n  protected listWillTake(upper: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listWillTake(upper);\n    }\n  }\n\n  protected listDidTake(upper: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listDidTake(upper);\n    }\n  }\n\n  protected listWillClear(): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listWillClear();\n    }\n  }\n\n  protected listDidClear(): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.listDidClear();\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Cursor} from \"@swim/util\";\nimport type {STree} from \"@swim/collections\";\nimport {AnyValue, Value, Form, ValueCursor, ValueEntryCursor} from \"@swim/structure\";\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport type {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {ListDownlinkModel} from \"./ListDownlinkModel\";\n\n/** @public */\nexport type ListDownlinkWillUpdate<V, VU = never> = (index: number, newValue: V, downlink: ListDownlink<V, VU>) => V | void;\n/** @public */\nexport type ListDownlinkDidUpdate<V, VU = never> = (index: number, newValue: V, oldValue: V, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkWillMove<V, VU = never> = (fromIndex: number, toIndex: number, value: V, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkDidMove<V, VU = never> = (fromIndex: number, toIndex: number, value: V, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkWillRemove<V, VU = never> = (index: number, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkDidRemove<V, VU = never> = (index: number, oldValue: V, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkWillDrop<V, VU = never> = (lower: number, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkDidDrop<V, VU = never> = (lower: number, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkWillTake<V, VU = never> = (upper: number, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkDidTake<V, VU = never> = (upper: number, downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkWillClear<V, VU = never> = (downlink: ListDownlink<V, VU>) => void;\n/** @public */\nexport type ListDownlinkDidClear<V, VU = never> = (downlink: ListDownlink<V, VU>) => void;\n\n/** @public */\nexport interface ListDownlinkObserver<V, VU = never> extends DownlinkObserver {\n  willUpdate?: ListDownlinkWillUpdate<V, VU>;\n  didUpdate?: ListDownlinkDidUpdate<V, VU>;\n  willMove?: ListDownlinkWillMove<V, VU>;\n  didMove?: ListDownlinkDidMove<V, VU>;\n  willRemove?: ListDownlinkWillRemove<V, VU>;\n  didRemove?: ListDownlinkDidRemove<V, VU>;\n  willDrop?: ListDownlinkWillDrop<V, VU>;\n  didDrop?: ListDownlinkDidDrop<V, VU>;\n  willTake?: ListDownlinkWillTake<V, VU>;\n  didTake?: ListDownlinkDidTake<V, VU>;\n  willClear?: ListDownlinkWillClear<V, VU>;\n  didClear?: ListDownlinkDidClear<V, VU>;\n}\n\n/** @public */\nexport interface ListDownlinkInit<V, VU = never> extends ListDownlinkObserver<V, VU>, DownlinkInit {\n  valueForm?: Form<V, VU>;\n}\n\n/** @public */\nexport class ListDownlink<V, VU = never> extends Downlink {\n  /** @internal */\n  constructor(context: DownlinkContext, owner: DownlinkOwner | null, init?: ListDownlinkInit<V, VU>,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number, rate?: number,\n              body?: Value, flags: number = DownlinkFlags.KeepLinkedSynced,\n              observers?: ReadonlyArray<ListDownlinkObserver<V, VU>> | ListDownlinkObserver<V, VU>,\n              valueForm?: Form<V, VU>, state0: STree<Value, Value> | null = null) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n    if (init !== void 0) {\n      const observer = this.observers[this.observers.length - 1]!;\n      observer.willUpdate = init.willUpdate ?? observer.willUpdate;\n      observer.didUpdate = init.didUpdate ?? observer.didUpdate;\n      observer.willMove = init.willMove ?? observer.willMove;\n      observer.didMove = init.didMove ?? observer.didMove;\n      observer.willRemove = init.willRemove ?? observer.willRemove;\n      observer.didRemove = init.didRemove ?? observer.didRemove;\n      observer.willDrop = init.willDrop ?? observer.willDrop;\n      observer.didDrop = init.didDrop ?? observer.didDrop;\n      observer.willTake = init.willTake ?? observer.willTake;\n      observer.didTake = init.didTake ?? observer.didTake;\n      observer.willClear = init.willClear ?? observer.willClear;\n      observer.didClear = init.didClear ?? observer.didClear;\n      valueForm = init.valueForm !== void 0 ? init.valueForm : valueForm;\n    }\n    this.ownValueForm = valueForm !== void 0 ? valueForm : Form.forValue() as unknown as Form<V, VU>;\n    this.state0 = state0;\n  }\n\n  /** @internal */\n  override readonly model!: ListDownlinkModel | null;\n\n  /** @internal */\n  override readonly observers!: ReadonlyArray<ListDownlinkObserver<V, VU>>;\n\n  /** @internal */\n  readonly ownValueForm: Form<V, VU>;\n\n  /** @internal */\n  readonly state0: STree<Value, Value> | null;\n\n  override get type(): DownlinkType {\n    return \"list\";\n  }\n\n  /** @internal */\n  protected override copy<V, VU>(context: DownlinkContext, owner: DownlinkOwner | null,\n                                 hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                                 body: Value, flags: number, observers: ReadonlyArray<ListDownlinkObserver<V, VU>>,\n                                 valueForm?: Form<V, VU>, state0?: STree<Value, Value> | null): ListDownlink<V, VU> {\n    if (arguments.length === 10) {\n      valueForm = this.ownValueForm as unknown as Form<V, VU>;\n      state0 = this.state0;\n    }\n    return new ListDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                            prio, rate, body, flags, observers, valueForm, state0);\n  }\n\n  valueForm(): Form<V, VU>;\n  valueForm<V2, V2U = never>(valueForm: Form<V2, V2U>): ListDownlink<V2, V2U>;\n  valueForm<V2, V2U = never>(valueForm?: Form<V2, V2U>): Form<V, VU> | ListDownlink<V2, V2U> {\n    if (valueForm === void 0) {\n      return this.ownValueForm;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers as any,\n                       valueForm, this.state0);\n    }\n  }\n\n  get length(): number {\n    return this.model!.length;\n  }\n\n  isEmpty(): boolean {\n    return this.model!.isEmpty();\n  }\n\n  get(index: number, id?: Value): V {\n    const value = this.model!.get(index, id);\n    return value.coerce(this.ownValueForm);\n  }\n\n  getEntry(index: number, id?: Value): [V, Value] | undefined {\n    const entry = this.model!.getEntry(index, id);\n    if (entry !== void 0) {\n      return [entry[0].coerce(this.ownValueForm), entry[1]];\n    }\n    return void 0;\n  }\n\n  set(index: number, newObject: V | VU, id?: Value): this {\n    const newValue = this.ownValueForm.mold(newObject);\n    this.model!.set(index, newValue, id);\n    return this;\n  }\n\n  insert(index: number, newObject: V | VU, id?: Value): this {\n    const newValue = this.ownValueForm.mold(newObject);\n    this.model!.insert(index, newValue, id);\n    return this;\n  }\n\n  remove(index: number, id?: Value): this {\n    this.model!.remove(index, id);\n    return this;\n  }\n\n  push(...newObjects: (V | VU)[]): number {\n    const newValues = new Array(newObjects.length);\n    for (let i = 0; i < newObjects.length; i += 1) {\n      newValues[i] = this.ownValueForm.mold(newObjects[i]!);\n    }\n    return this.model!.push.apply(this.model, newValues);\n  }\n\n  pop(): V {\n    const value = this.model!.pop();\n    return value.coerce(this.ownValueForm);\n  }\n\n  unshift(...newObjects: (V | VU)[]): number {\n    const newValues = new Array(newObjects.length);\n    for (let i = 0; i < newObjects.length; i += 1) {\n      newValues[i] = this.ownValueForm.mold(newObjects[i]!);\n    }\n    return this.model!.unshift.apply(this.model, newValues);\n  }\n\n  shift(): V {\n    const value = this.model!.shift();\n    return value.coerce(this.ownValueForm);\n  }\n\n  move(fromIndex: number, toIndex: number, id?: Value): this {\n    this.model!.move(fromIndex, toIndex, id);\n    return this;\n  }\n\n  splice(start: number, deleteCount?: number, ...newObjects: (V | VU)[]): V[] {\n    const newValues = new Array(newObjects.length);\n    for (let i = 0; i < newObjects.length; i += 1) {\n      newValues[i] = this.ownValueForm.mold(newObjects[i]!);\n    }\n    const oldValues = this.model!.splice(start, deleteCount, ...newValues);\n    const oldObjects = new Array(oldValues.length);\n    for (let i = 0; i < oldValues.length; i += 1) {\n      oldObjects[i] = oldValues[i]!.coerce(this.ownValueForm);\n    }\n    return oldObjects;\n  }\n\n  clear(): void {\n    this.model!.clear();\n  }\n\n  forEach<T, S>(callback: (value: V, index: number, id: Value) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, value: V, index: number, id: Value) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, value: V, index: number, id: Value) => T | void,\n                thisArg?: S): T | undefined {\n    if (this.ownValueForm as unknown === Form.forValue()) {\n      return this.model!.state.forEach(callback as any, thisArg);\n    } else {\n      return this.model!.state.forEach(function (value: Value, index: number, id: Value): T | void {\n        const object = value.coerce(this.ownValueForm);\n        return callback.call(thisArg, object, index, id);\n      }, this);\n    }\n  }\n\n  values(): Cursor<V> {\n    const cursor = this.model!.values();\n    if (this.ownValueForm as unknown === Form.forValue()) {\n      return cursor as unknown as Cursor<V>;\n    } else {\n      return new ValueCursor(cursor, this.ownValueForm);\n    }\n  }\n\n  keys(): Cursor<Value> {\n    return this.model!.keys();\n  }\n\n  entries(): Cursor<[Value, V]> {\n    const cursor = this.model!.entries();\n    if (this.ownValueForm as unknown === Form.forValue()) {\n      return cursor as unknown as Cursor<[Value, V]>;\n    } else {\n      return new ValueEntryCursor(cursor, Form.forValue(), this.ownValueForm);\n    }\n  }\n\n  snapshot(): STree<Value, Value> {\n    return this.model!.snapshot();\n  }\n\n  setState(state: STree<Value, Value>): void {\n    this.model!.setState(state);\n  }\n\n  override observe(observer: ListDownlinkObserver<V, VU>): this {\n    return super.observe(observer);\n  }\n\n  willUpdate(willUpdate: ListDownlinkWillUpdate<V, VU>): this {\n    return this.observe({willUpdate});\n  }\n\n  didUpdate(didUpdate: ListDownlinkDidUpdate<V, VU>): this {\n    return this.observe({didUpdate});\n  }\n\n  willMove(willMove: ListDownlinkWillMove<V, VU>): this {\n    return this.observe({willMove});\n  }\n\n  didMove(didMove: ListDownlinkDidMove<V, VU>): this {\n    return this.observe({didMove});\n  }\n\n  willRemove(willRemove: ListDownlinkWillRemove<V, VU>): this {\n    return this.observe({willRemove});\n  }\n\n  didRemove(didRemove: ListDownlinkDidRemove<V, VU>): this {\n    return this.observe({didRemove});\n  }\n\n  willDrop(willDrop: ListDownlinkWillDrop<V, VU>): this {\n    return this.observe({willDrop});\n  }\n\n  didDrop(didDrop: ListDownlinkDidDrop<V, VU>): this {\n    return this.observe({didDrop});\n  }\n\n  willTake(willTake: ListDownlinkWillTake<V, VU>): this {\n    return this.observe({willTake});\n  }\n\n  didTake(didTake: ListDownlinkDidTake<V, VU>): this {\n    return this.observe({didTake});\n  }\n\n  willClear(willClear: ListDownlinkWillClear<V, VU>): this {\n    return this.observe({willClear});\n  }\n\n  didClear(didClear: ListDownlinkDidClear<V, VU>): this {\n    return this.observe({didClear});\n  }\n\n  /** @internal */\n  listWillUpdate(index: number, newValue: Value): Value {\n    let newObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willUpdate !== void 0) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this.ownValueForm);\n        }\n        const newResult = observer.willUpdate(index, newObject, this);\n        if (newResult !== void 0) {\n          newObject = newResult;\n          newValue = this.ownValueForm.mold(newObject);\n        }\n      }\n    }\n    return newValue;\n  }\n\n  /** @internal */\n  listDidUpdate(index: number, newValue: Value, oldValue: Value): void {\n    let newObject: V | undefined;\n    let oldObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didUpdate !== void 0) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this.ownValueForm);\n        }\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this.ownValueForm);\n        }\n        observer.didUpdate(index, newObject, oldObject, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listWillMove(fromIndex: number, toIndex: number, value: Value): void {\n    let object: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willMove !== void 0) {\n        if (object === void 0) {\n          object = value.coerce(this.ownValueForm);\n        }\n        observer.willMove(fromIndex, toIndex, object, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listDidMove(fromIndex: number, toIndex: number, value: Value): void {\n    let object: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didMove !== void 0) {\n        if (object === void 0) {\n          object = value.coerce(this.ownValueForm);\n        }\n        observer.didMove(fromIndex, toIndex, object, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listWillRemove(index: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willRemove !== void 0) {\n        observer.willRemove(index, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listDidRemove(index: number, oldValue: Value): void {\n    let oldObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didRemove !== void 0) {\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this.ownValueForm);\n        }\n        observer.didRemove(index, oldObject, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listWillDrop(lower: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willDrop !== void 0) {\n        observer.willDrop(lower, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listDidDrop(lower: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDrop !== void 0) {\n        observer.didDrop(lower, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listWillTake(upper: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willTake !== void 0) {\n        observer.willTake(upper, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listDidTake(upper: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didTake !== void 0) {\n        observer.didTake(upper, this);\n      }\n    }\n  }\n\n  /** @internal */\n  listWillClear(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willClear !== void 0) {\n        observer.willClear(this);\n      }\n    }\n  }\n\n  /** @internal */\n  listDidClear(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didClear !== void 0) {\n        observer.didClear(this);\n      }\n    }\n  }\n\n  initialState(): STree<Value, Value> | null;\n  initialState(state0: STree<Value, Value> | null): ListDownlink<V, VU>;\n  initialState(state0?: STree<Value, Value> | null): STree<Value, Value> | null | ListDownlink<V, VU> {\n    if (state0 === void 0) {\n      return this.state0;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers,\n                       this.ownValueForm, state0);\n    }\n  }\n\n  /** @internal */\n  protected didAliasModel(): void {\n    this.onLinkedResponse();\n    this.model!.state.forEach(function (value: Value, index: number) {\n      this.listDidUpdate(index, value, Value.absent());\n    }, this);\n    this.onSyncedResponse();\n  }\n\n  override open(): this {\n    const laneUri = this.ownLaneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this.ownNodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this.ownHostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this.context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model !== void 0) {\n      if (!(model instanceof ListDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n      (this as Mutable<this>).model = model as ListDownlinkModel;\n      setTimeout(this.didAliasModel.bind(this));\n    } else {\n      model = new ListDownlinkModel(this.context, hostUri, nodeUri, laneUri, this.ownPrio,\n                                    this.ownRate, this.ownBody, this.state0 ?? void 0);\n      model.addDownlink(this);\n      this.context.openDownlink(model);\n      (this as Mutable<this>).model = model as ListDownlinkModel;\n    }\n    if (this.owner !== null) {\n      this.owner.addDownlink(this);\n    }\n    return this;\n  }\n}\n/** @public */\nexport interface ListDownlink<V, VU> {\n  hostUri(): Uri;\n  hostUri(hostUri: AnyUri): ListDownlink<V, VU>;\n\n  nodeUri(): Uri;\n  nodeUri(nodeUri: AnyUri): ListDownlink<V, VU>;\n\n  laneUri(): Uri;\n  laneUri(laneUri: AnyUri): ListDownlink<V, VU>;\n\n  prio(): number;\n  prio(prio: number): ListDownlink<V, VU>;\n\n  rate(): number;\n  rate(rate: number): ListDownlink<V, VU>;\n\n  body(): Value;\n  body(body: AnyValue): ListDownlink<V, VU>;\n\n  keepLinked(): boolean;\n  keepLinked(keepLinked: boolean): ListDownlink<V, VU>;\n\n  keepSynced(): boolean;\n  keepSynced(keepSynced: boolean): ListDownlink<V, VU>;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {Attr, Value, Record} from \"@swim/structure\";\nimport type {Uri} from \"@swim/uri\";\nimport type {EventMessage} from \"@swim/warp\";\nimport type {Host} from \"../host/Host\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport type {DownlinkType} from \"./Downlink\";\nimport type {MapDownlink} from \"./MapDownlink\";\n\n/** @internal */\nexport class MapDownlinkModel extends DownlinkModel {\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value, state: BTree<Value, Value> = new BTree()) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n    this.state = state;\n  }\n\n  override readonly views!: ReadonlyArray<MapDownlink<unknown, unknown>>;\n\n  /** @internal */\n  readonly state: BTree<Value, Value>;\n\n  override get type(): DownlinkType {\n    return \"map\";\n  }\n\n  get size(): number {\n    return this.state.size;\n  }\n\n  isEmpty(): boolean {\n    return this.state.isEmpty();\n  }\n\n  has(key: Value): boolean {\n    return this.state.has(key);\n  }\n\n  get(key: Value): Value {\n    return this.state.get(key) ?? Value.absent();\n  }\n\n  getEntry(index: number): [Value, Value] | undefined {\n    return this.state.getEntry(index);\n  }\n\n  set(key: Value, newValue: Value): this {\n    newValue = this.mapWillUpdate(key, newValue);\n    const oldValue = this.state.get(key) ?? Value.absent();\n    this.state.set(key, newValue);\n    this.mapDidUpdate(key, newValue, oldValue);\n    const header = Record.create(1).slot(\"key\", key);\n    this.command(Attr.of(\"update\", header).concat(newValue));\n    return this;\n  }\n\n  delete(key: Value): boolean {\n    if (this.state.has(key)) {\n      this.mapWillRemove(key);\n      const oldValue = this.state.get(key) ?? Value.absent();\n      this.state.delete(key);\n      this.mapDidRemove(key, oldValue);\n      const header = Record.create(1).slot(\"key\", key);\n      this.command(Record.create(1).attr(\"remove\", header));\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  drop(lower: number): this {\n    this.mapWillDrop(lower);\n    this.state.drop(lower);\n    this.mapDidDrop(lower);\n    this.command(Record.create(1).attr(\"drop\", lower));\n    return this;\n  }\n\n  take(upper: number): this {\n    this.mapWillTake(upper);\n    this.state.take(upper);\n    this.mapDidTake(upper);\n    this.command(Record.create(1).attr(\"take\", upper));\n    return this;\n  }\n\n  clear(): void {\n    this.mapWillClear();\n    this.state.clear();\n    this.mapDidClear();\n    this.command(Record.create(1).attr(\"clear\"));\n  }\n\n  forEach<T>(callback: (key: Value, value: Value) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, key: Value, value: Value) => T | void,\n                          thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, key: Value, value: Value) => T | void,\n                          thisArg?: S): T | undefined {\n    return this.state.forEach(callback, thisArg);\n  }\n\n  keys(): Cursor<Value> {\n    return this.state.keys();\n  }\n\n  values(): Cursor<Value> {\n    return this.state.values();\n  }\n\n  entries(): Cursor<[Value, Value]> {\n    return this.state.entries();\n  }\n\n  snapshot(): BTree<Value, Value> {\n    return this.state.clone();\n  }\n\n  setState(state: BTree<Value, Value>): void {\n    (this as Mutable<this>).state = state;\n  }\n\n  override onEventMessage(message: EventMessage, host: Host): void {\n    super.onEventMessage(message, host);\n    const event = message.body;\n    const tag = event.tag;\n    if (tag === \"update\") {\n      const header = event.head().toValue();\n      this.onUpdateEvent(header.get(\"key\"), event.body());\n    } else if (tag === \"remove\") {\n      const header = event.head().toValue();\n      this.onRemoveEvent(header.get(\"key\"));\n    } else if (tag === \"drop\") {\n      const header = event.head().toValue();\n      this.onDropEvent(header.numberValue(0));\n    } else if (tag === \"take\") {\n      const header = event.head().toValue();\n      this.onTakeEvent(header.numberValue(0));\n    } else if (tag === \"clear\") {\n      this.onClearEvent();\n    }\n  }\n\n  protected onUpdateEvent(key: Value, newValue: Value): void {\n    newValue = this.mapWillUpdate(key, newValue);\n    const oldValue = this.state.get(key) ?? Value.absent();\n    this.state.set(key, newValue);\n    this.mapDidUpdate(key, newValue, oldValue);\n  }\n\n  protected onRemoveEvent(key: Value): void {\n    this.mapWillRemove(key);\n    const oldValue = this.state.get(key) ?? Value.absent();\n    this.state.delete(key);\n    this.mapDidRemove(key, oldValue);\n  }\n\n  protected onDropEvent(lower: number): void {\n    this.mapWillDrop(lower);\n    this.state.drop(lower);\n    this.mapDidDrop(lower);\n  }\n\n  protected onTakeEvent(upper: number): void {\n    this.mapWillTake(upper);\n    this.state.take(upper);\n    this.mapDidTake(upper);\n  }\n\n  protected onClearEvent(): void {\n    this.mapWillClear();\n    this.state.clear();\n    this.mapDidClear();\n  }\n\n  protected mapWillUpdate(key: Value, newValue: Value): Value {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      newValue = views[i]!.mapWillUpdate(key, newValue);\n    }\n    return newValue;\n  }\n\n  protected mapDidUpdate(key: Value, newValue: Value, oldValue: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapDidUpdate(key, newValue, oldValue);\n    }\n  }\n\n  protected mapWillRemove(key: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapWillRemove(key);\n    }\n  }\n\n  protected mapDidRemove(key: Value, oldValue: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapDidRemove(key, oldValue);\n    }\n  }\n\n  protected mapWillDrop(lower: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapWillDrop(lower);\n    }\n  }\n\n  protected mapDidDrop(lower: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapDidDrop(lower);\n    }\n  }\n\n  protected mapWillTake(upper: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapWillTake(upper);\n    }\n  }\n\n  protected mapDidTake(upper: number): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapDidTake(upper);\n    }\n  }\n\n  protected mapWillClear(): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapWillClear();\n    }\n  }\n\n  protected mapDidClear(): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.mapDidClear();\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Cursor, Map, OrderedMap} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {AnyValue, Value, Form, ValueCursor, ValueEntryCursor} from \"@swim/structure\";\nimport {Inlet, Outlet, KeyEffect, MapInlet, MapOutlet, MapOutletCombinators, KeyOutlet} from \"@swim/streamlet\";\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport type {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {MapDownlinkModel} from \"./MapDownlinkModel\";\n\n/** @public */\nexport type MapDownlinkWillUpdate<K, V, KU = never, VU = never> = (key: K, newValue: V, downlink: MapDownlink<K, V, KU, VU>) => V | void;\n/** @public */\nexport type MapDownlinkDidUpdate<K, V, KU = never, VU = never> = (key: K, newValue: V, oldValue: V, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkWillRemove<K, V, KU = never, VU = never> = (key: K, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkDidRemove<K, V, KU = never, VU = never> = (key: K, oldValue: V, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkWillDrop<K, V, KU = never, VU = never> = (lower: number, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkDidDrop<K, V, KU = never, VU = never> = (lower: number, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkWillTake<K, V, KU = never, VU = never> = (upper: number, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkDidTake<K, V, KU = never, VU = never> = (upper: number, downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkWillClear<K, V, KU = never, VU = never> = (downlink: MapDownlink<K, V, KU, VU>) => void;\n/** @public */\nexport type MapDownlinkDidClear<K, V, KU = never, VU = never> = (downlink: MapDownlink<K, V, KU, VU>) => void;\n\n/** @public */\nexport interface MapDownlinkObserver<K, V, KU = never, VU = never> extends DownlinkObserver {\n  willUpdate?: MapDownlinkWillUpdate<K, V, KU, VU>;\n  didUpdate?: MapDownlinkDidUpdate<K, V, KU, VU>;\n  willRemove?: MapDownlinkWillRemove<K, V, KU, VU>;\n  didRemove?: MapDownlinkDidRemove<K, V, KU, VU>;\n  willDrop?: MapDownlinkWillDrop<K, V, KU, VU>;\n  didDrop?: MapDownlinkDidDrop<K, V, KU, VU>;\n  willTake?: MapDownlinkWillTake<K, V, KU, VU>;\n  didTake?: MapDownlinkDidTake<K, V, KU, VU>;\n  willClear?: MapDownlinkWillClear<K, V, KU, VU>;\n  didClear?: MapDownlinkDidClear<K, V, KU, VU>;\n}\n\n/** @public */\nexport interface MapDownlinkInit<K, V, KU = never, VU = never> extends MapDownlinkObserver<K, V, KU, VU>, DownlinkInit {\n  keyForm?: Form<K, KU>;\n  valueForm?: Form<V, VU>;\n}\n\n/** @public */\nexport class MapDownlink<K, V, KU = never, VU = never> extends Downlink implements OrderedMap<K, V>, MapInlet<K, V, Map<K, V>>, MapOutlet<K, V, MapDownlink<K, V, KU, VU>> {\n  /** @internal */\n  constructor(context: DownlinkContext, owner: DownlinkOwner | null, init?: MapDownlinkInit<K, V, KU, VU>,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number, rate?: number,\n              body?: Value, flags: number = DownlinkFlags.KeepLinkedSynced,\n              observers?: ReadonlyArray<MapDownlinkObserver<K, V, KU, VU>> | MapDownlinkObserver<K, V, KU, VU>,\n              keyForm?: Form<K, KU>, valueForm?: Form<V, VU>, state0: BTree<Value, Value> | null = null) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n    if (init !== void 0) {\n      const observer = this.observers[this.observers.length - 1]!;\n      observer.willUpdate = init.willUpdate ?? observer.willUpdate;\n      observer.didUpdate = init.didUpdate ?? observer.didUpdate;\n      observer.willRemove = init.willRemove ?? observer.willRemove;\n      observer.didRemove = init.didRemove ?? observer.didRemove;\n      observer.willDrop = init.willDrop ?? observer.willDrop;\n      observer.didDrop = init.didDrop ?? observer.didDrop;\n      observer.willTake = init.willTake ?? observer.willTake;\n      observer.didTake = init.didTake ?? observer.didTake;\n      observer.willClear = init.willClear ?? observer.willClear;\n      observer.didClear = init.didClear ?? observer.didClear;\n      keyForm = init.keyForm !== void 0 ? init.keyForm : keyForm;\n      valueForm = init.valueForm !== void 0 ? init.valueForm : valueForm;\n    }\n    this.ownKeyForm = keyForm !== void 0 ? keyForm : Form.forValue() as unknown as Form<K, KU>;\n    this.ownValueForm = valueForm !== void 0 ? valueForm : Form.forValue() as unknown as Form<V, VU>;\n    this.state0 = state0;\n    this.input = null;\n    this.effects = new BTree();\n    this.outlets = new BTree();\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  /** @internal */\n  override readonly model!: MapDownlinkModel | null;\n\n  /** @internal */\n  override readonly observers!: ReadonlyArray<MapDownlinkObserver<K, V, KU, VU>>;\n\n  /** @internal */\n  readonly ownKeyForm: Form<K, KU>;\n\n  /** @internal */\n  readonly ownValueForm: Form<V, VU>;\n\n  /** @internal */\n  readonly state0: BTree<Value, Value> | null;\n\n  override get type(): DownlinkType {\n    return \"map\";\n  }\n\n  /** @internal */\n  protected override copy<K, V, KU, VU>(context: DownlinkContext, owner: DownlinkOwner | null,\n                                        hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                                        body: Value, flags: number, observers: ReadonlyArray<MapDownlinkObserver<K, V, KU, VU>>,\n                                        keyForm?: Form<K, KU>, valueForm?: Form<V, VU>, state0?: BTree<Value, Value> | null): MapDownlink<K, V, KU, VU> {\n    if (arguments.length === 10) {\n      state0 = this.state0;\n      keyForm = this.ownKeyForm as unknown as Form<K, KU>;\n      valueForm = this.ownValueForm as unknown as Form<V, VU>;\n    }\n    return new MapDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                           prio, rate, body, flags, observers, keyForm, valueForm, state0);\n  }\n\n  keyForm(): Form<K, KU>;\n  keyForm<K2, K2U = never>(keyForm: Form<K2, K2U>): MapDownlink<K2, V, K2U, VU>;\n  keyForm<K2, K2U = never>(keyForm?: Form<K2, K2U>): Form<K, KU> | MapDownlink<K2, V, K2U, VU> {\n    if (keyForm === void 0) {\n      return this.ownKeyForm;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers as any,\n                       keyForm, this.ownValueForm, this.state0);\n    }\n  }\n\n  valueForm(): Form<V, VU>;\n  valueForm<V2, V2U = never>(valueForm: Form<V2, V2U>): MapDownlink<K, V2, KU, V2U>;\n  valueForm<V2, V2U = never>(valueForm?: Form<V2, V2U>): Form<V, VU> | MapDownlink<K, V2, KU, V2U> {\n    if (valueForm === void 0) {\n      return this.ownValueForm;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers as any,\n                       this.ownKeyForm, valueForm, this.state0);\n    }\n  }\n\n  get size(): number {\n    return this.model!.size;\n  }\n\n  isEmpty(): boolean {\n    return this.model!.isEmpty();\n  }\n\n  has(key: K | KU): boolean {\n    const keyObject = this.ownKeyForm.mold(key);\n    return this.model!.has(keyObject);\n  }\n\n  get(): MapDownlink<K, V, KU, VU>;\n  get(key: K | KU): V;\n  get(key?: K | KU): MapDownlink<K, V, KU, VU> | V {\n    if (key === void 0) {\n      return this;\n    } else {\n      const keyObject = this.ownKeyForm.mold(key);\n      const value = this.model!.get(keyObject);\n      return value.coerce(this.ownValueForm);\n    }\n  }\n\n  getEntry(index: number): [K, V] | undefined {\n    const entry = this.model!.getEntry(index);\n    if (entry !== void 0) {\n      return [entry[0].coerce(this.ownKeyForm), entry[1].coerce(this.ownValueForm)];\n    }\n    return void 0;\n  }\n\n  firstKey(): K | undefined {\n    const key = this.model!.state.firstKey();\n    if (key !== void 0) {\n      const keyObject = this.ownKeyForm.cast(key);\n      if (keyObject !== void 0) {\n        return keyObject;\n      }\n    }\n    return this.ownKeyForm.unit;\n  }\n\n  firstValue(): V | undefined {\n    const value = this.model!.state.firstValue();\n    if (value !== void 0) {\n      const object = this.ownValueForm.cast(value);\n      if (object !== void 0) {\n        return object;\n      }\n    }\n    return this.ownValueForm.unit;\n  }\n\n  firstEntry(): [K, V] | undefined {\n    const entry = this.model!.state.firstEntry();\n    if (entry !== void 0) {\n      const keyObject: K = this.ownKeyForm.cast(entry[0])!;\n      const object: V = this.ownValueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  lastKey(): K | undefined {\n    const key = this.model!.state.lastKey();\n    if (key !== void 0) {\n      const keyObject = this.ownKeyForm.cast(key);\n      if (keyObject !== void 0) {\n        return keyObject;\n      }\n    }\n    return this.ownKeyForm.unit;\n  }\n\n  lastValue(): V | undefined {\n    const value = this.model!.state.lastValue();\n    if (value !== void 0) {\n      const object = this.ownValueForm.cast(value);\n      if (object !== void 0) {\n        return object;\n      }\n    }\n    return this.ownValueForm.unit;\n  }\n\n  lastEntry(): [K, V] | undefined {\n    const entry = this.model!.state.lastEntry();\n    if (entry !== void 0) {\n      const keyObject: K = this.ownKeyForm.cast(entry[0])!;\n      const object: V = this.ownValueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  nextKey(keyObject: K): K | undefined {\n    const key = this.ownKeyForm.mold(keyObject);\n    const nextKey = this.model!.state.nextKey(key);\n    if (nextKey !== void 0) {\n      const nextKeyObject = this.ownKeyForm.cast(nextKey);\n      if (nextKeyObject !== void 0) {\n        return nextKeyObject;\n      }\n    }\n    return this.ownKeyForm.unit;\n  }\n\n  nextValue(keyObject: K): V | undefined {\n    const key = this.ownKeyForm.mold(keyObject);\n    const nextValue = this.model!.state.nextValue(key);\n    if (nextValue !== void 0) {\n      const nextObject = this.ownValueForm.cast(nextValue);\n      if (nextObject !== void 0) {\n        return nextObject;\n      }\n    }\n    return this.ownValueForm.unit;\n  }\n\n  nextEntry(keyObject: K): [K, V] | undefined {\n    const key = this.ownKeyForm.mold(keyObject);\n    const entry = this.model!.state.nextEntry(key);\n    if (entry !== void 0) {\n      const keyObject: K = this.ownKeyForm.cast(entry[0])!;\n      const object: V = this.ownValueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  previousKey(keyObject: K): K | undefined {\n    const key = this.ownKeyForm.mold(keyObject);\n    const previousKey = this.model!.state.previousKey(key);\n    if (previousKey !== void 0) {\n      const previousKeyObject = this.ownKeyForm.cast(previousKey);\n      if (previousKeyObject !== void 0) {\n        return previousKeyObject;\n      }\n    }\n    return this.ownKeyForm.unit;\n  }\n\n  previousValue(keyObject: K): V | undefined {\n    const key = this.ownKeyForm.mold(keyObject);\n    const previousValue = this.model!.state.previousValue(key);\n    if (previousValue !== void 0) {\n      const previousObject = this.ownValueForm.cast(previousValue);\n      if (previousObject !== void 0) {\n        return previousObject;\n      }\n    }\n    return this.ownValueForm.unit;\n  }\n\n  previousEntry(keyObject: K): [K, V] | undefined {\n    const key = this.ownKeyForm.mold(keyObject);\n    const entry = this.model!.state.previousEntry(key);\n    if (entry !== void 0) {\n      const keyObject: K = this.ownKeyForm.cast(entry[0])!;\n      const object: V = this.ownValueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  set(key: K | KU, newValue: V | VU): this {\n    const keyObject = this.ownKeyForm.mold(key);\n    const newObject = this.ownValueForm.mold(newValue);\n    this.model!.set(keyObject, newObject);\n    return this;\n  }\n\n  delete(key: K | KU): boolean {\n    const keyObject = this.ownKeyForm.mold(key);\n    return this.model!.delete(keyObject);\n  }\n\n  drop(lower: number): this {\n    this.model!.drop(lower);\n    return this;\n  }\n\n  take(upper: number): this {\n    this.model!.take(upper);\n    return this;\n  }\n\n  clear(): void {\n    this.model!.clear();\n  }\n\n  forEach<T>(callback: (key: K, value: V) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, key: K, value: V) => T | void,\n                thisArg: S): T | undefined;\n  forEach<T, S>(callback: (this: S | undefined, key: K, value: V) => T | void,\n                thisArg?: S): T | undefined {\n    if (this.ownKeyForm as unknown === Form.forValue() && this.ownValueForm as unknown === Form.forValue()) {\n      return this.model!.state.forEach(callback as any, thisArg);\n    } else {\n      return this.model!.state.forEach(function (key: Value, value: Value): T | void {\n        const keyObject = key.coerce(this.ownKeyForm);\n        const object = value.coerce(this.ownValueForm);\n        return callback.call(thisArg, keyObject, object);\n      }, this);\n    }\n  }\n\n  keys(): Cursor<K> {\n    const cursor = this.model!.keys();\n    if (this.ownKeyForm as unknown === Form.forValue()) {\n      return cursor as unknown as Cursor<K>;\n    } else {\n      return new ValueCursor(cursor, this.ownKeyForm);\n    }\n  }\n\n  values(): Cursor<V> {\n    const cursor = this.model!.values();\n    if (this.ownValueForm as unknown === Form.forValue()) {\n      return cursor as unknown as Cursor<V>;\n    } else {\n      return new ValueCursor(cursor, this.ownValueForm);\n    }\n  }\n\n  entries(): Cursor<[K, V]> {\n    const cursor = this.model!.entries();\n    if (this.ownKeyForm as unknown === Form.forValue() && this.ownValueForm as unknown === Form.forValue()) {\n      return cursor as unknown as Cursor<[K, V]>;\n    } else {\n      return new ValueEntryCursor(cursor, this.ownKeyForm, this.ownValueForm);\n    }\n  }\n\n  snapshot(): BTree<Value, Value> {\n    return this.model!.snapshot();\n  }\n\n  setState(state: BTree<Value, Value>): void {\n    this.model!.setState(state);\n  }\n\n  override observe(observer: MapDownlinkObserver<K, V, KU, VU>): this {\n    return super.observe(observer);\n  }\n\n  willUpdate(willUpdate: MapDownlinkWillUpdate<K, V, KU, VU>): this {\n    return this.observe({willUpdate});\n  }\n\n  didUpdate(didUpdate: MapDownlinkDidUpdate<K, V, KU, VU>): this {\n    return this.observe({didUpdate});\n  }\n\n  willRemove(willRemove: MapDownlinkWillRemove<K, V, KU, VU>): this {\n    return this.observe({willRemove});\n  }\n\n  didRemove(didRemove: MapDownlinkDidRemove<K, V, KU, VU>): this {\n    return this.observe({didRemove});\n  }\n\n  willDrop(willDrop: MapDownlinkWillDrop<K, V, KU, VU>): this {\n    return this.observe({willDrop});\n  }\n\n  didDrop(didDrop: MapDownlinkDidDrop<K, V, KU, VU>): this {\n    return this.observe({didDrop});\n  }\n\n  willTake(willTake: MapDownlinkWillTake<K, V, KU, VU>): this {\n    return this.observe({willTake});\n  }\n\n  didTake(didTake: MapDownlinkDidTake<K, V, KU, VU>): this {\n    return this.observe({didTake});\n  }\n\n  willClear(willClear: MapDownlinkWillClear<K, V, KU, VU>): this {\n    return this.observe({willClear});\n  }\n\n  didClear(didClear: MapDownlinkDidClear<K, V, KU, VU>): this {\n    return this.observe({didClear});\n  }\n\n  /** @internal */\n  mapWillUpdate(key: Value, newValue: Value): Value {\n    let keyObject: K | undefined;\n    let newObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willUpdate !== void 0) {\n        if (keyObject === void 0) {\n          keyObject = key.coerce(this.ownKeyForm);\n        }\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this.ownValueForm);\n        }\n        const newResult = observer.willUpdate(keyObject, newObject, this);\n        if (newResult !== void 0) {\n          newObject = newResult;\n          newValue = this.ownValueForm.mold(newObject);\n        }\n      }\n    }\n    return newValue;\n  }\n\n  /** @internal */\n  mapDidUpdate(key: Value, newValue: Value, oldValue: Value): void {\n    const keyObject = key.coerce(this.ownKeyForm);\n    let newObject: V | undefined;\n    let oldObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didUpdate !== void 0) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this.ownValueForm);\n        }\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this.ownValueForm);\n        }\n        observer.didUpdate(keyObject, newObject, oldObject, this);\n      }\n    }\n    this.decohereInputKey(keyObject, KeyEffect.Update);\n    this.recohereInput(0); // TODO: debounce and track version\n  }\n\n  /** @internal */\n  mapWillRemove(key: Value): void {\n    let keyObject: K | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willRemove !== void 0) {\n        if (keyObject === void 0) {\n          keyObject = key.coerce(this.ownKeyForm);\n        }\n        observer.willRemove(keyObject, this);\n      }\n    }\n  }\n\n  /** @internal */\n  mapDidRemove(key: Value, oldValue: Value): void {\n    const keyObject = key.coerce(this.ownKeyForm);\n    let oldObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didRemove !== void 0) {\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this.ownValueForm);\n        }\n        observer.didRemove(keyObject, oldObject, this);\n      }\n    }\n    this.decohereInputKey(keyObject, KeyEffect.Remove);\n    this.recohereInput(0); // TODO: debounce and track version\n  }\n\n  /** @internal */\n  mapWillDrop(lower: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willDrop !== void 0) {\n        observer.willDrop(lower, this);\n      }\n    }\n  }\n\n  /** @internal */\n  mapDidDrop(lower: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDrop !== void 0) {\n        observer.didDrop(lower, this);\n      }\n    }\n  }\n\n  /** @internal */\n  mapWillTake(upper: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willTake !== void 0) {\n        observer.willTake(upper, this);\n      }\n    }\n  }\n\n  /** @internal */\n  mapDidTake(upper: number): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didTake !== void 0) {\n        observer.didTake(upper, this);\n      }\n    }\n  }\n\n  /** @internal */\n  mapWillClear(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willClear !== void 0) {\n        observer.willClear(this);\n      }\n    }\n  }\n\n  /** @internal */\n  mapDidClear(): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didClear !== void 0) {\n        observer.didClear(this);\n      }\n    }\n  }\n\n  initialState(): BTree<Value, Value> | null;\n  initialState(state0: BTree<Value, Value> | null): MapDownlink<K, V, KU, VU>;\n  initialState(state0?: BTree<Value, Value> | null): BTree | null | MapDownlink<K, V, KU, VU> {\n    if (state0 === void 0) {\n      return this.state0;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers,\n                       this.ownKeyForm, this.ownValueForm, state0);\n    }\n  }\n\n  /** @internal */\n  protected didAliasModel(): void {\n    this.onLinkedResponse();\n    this.model!.state.forEach(function (key: Value, value: Value): void {\n      this.mapDidUpdate(key, value, Value.absent());\n    }, this);\n    this.onSyncedResponse();\n  }\n\n  override open(): this {\n    const laneUri = this.ownLaneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this.ownNodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this.ownHostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this.context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model !== void 0) {\n      if (!(model instanceof MapDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n      (this as Mutable<this>).model = model as MapDownlinkModel;\n      setTimeout(this.didAliasModel.bind(this));\n    } else {\n      model = new MapDownlinkModel(this.context, hostUri, nodeUri, laneUri, this.ownPrio,\n                                   this.ownRate, this.ownBody, this.state0 ?? void 0);\n      model.addDownlink(this);\n      this.context.openDownlink(model);\n      (this as Mutable<this>).model = model as MapDownlinkModel;\n    }\n    if (this.owner !== null) {\n      this.owner.addDownlink(this);\n    }\n    return this;\n  }\n\n  keyIterator(): Cursor<K> {\n    return this.keys();\n  }\n\n  readonly input: MapOutlet<K, V, Map<K, V>> | null;\n\n  /** @internal */\n  readonly effects: BTree<K, KeyEffect>;\n\n  /** @internal */\n  readonly outlets: BTree<K, KeyOutlet<K, V>>;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<MapDownlink<K, V, KU, VU>>>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: MapOutlet<K, V, Map<K, V>>): void {\n    if (!MapOutlet.is(newInput)) {\n      throw new TypeError(\"\" + newInput);\n    }\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  outlet(key: K): Outlet<V> {\n    const oldOutlets = this.outlets;\n    let outlet = oldOutlets.get(key);\n    if (outlet === void 0) {\n      outlet = new KeyOutlet<K, V>(this, key);\n      (this as Mutable<this>).outlets = oldOutlets.updated(key, outlet);\n    }\n    return outlet;\n  }\n\n  outputIterator(): Cursor<Inlet<MapDownlink<K, V, KU, VU>>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<MapDownlink<K, V, KU, VU>>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<MapDownlink<K, V, KU, VU>>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, V>) {\n        keyOutlet.unbindOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutlets = this.outlets;\n    if (oldOutlets.isEmpty()) {\n      (this as Mutable<this>).outlets = new BTree();\n      oldOutlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, V>) {\n        keyOutlet.disconnectOutputs();\n      }, this);\n    }\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  decohereOutputKey(key: K, effect: KeyEffect): void {\n    this.decohereKey(key, effect);\n  }\n\n  decohereInputKey(key: K, effect: KeyEffect): void {\n    this.decohereKey(key, effect);\n  }\n\n  decohereKey(key: K, effect: KeyEffect): void {\n    const oldEffects = this.effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willDecohereKey(key, effect);\n      (this as Mutable<this>).effects = oldEffects.updated(key, effect);\n      (this as Mutable<this>).version = -1;\n      this.onDecohereKey(key, effect);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        if (MapInlet.is(output)) {\n          output.decohereOutputKey(key, effect);\n        } else {\n          output.decohereOutput();\n        }\n      }\n      const outlet = this.outlets.get(key);\n      if (outlet !== void 0) {\n        outlet.decohereInput();\n      }\n      this.didDecohereKey(key, effect);\n    }\n  }\n\n  decohereOutput(): void {\n    this.decohere();\n  }\n\n  decohereInput(): void {\n    this.decohere();\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.decohereOutput();\n      }\n      this.outlets.forEach(function (key: K, outlet: KeyOutlet<K, V>): void {\n        outlet.decohereInput();\n      }, this);\n      this.didDecohere();\n    }\n  }\n\n  recohereOutputKey(key: K, version: number): void {\n    this.recohereKey(key, version);\n  }\n\n  recohereInputKey(key: K, version: number): void {\n    this.recohereKey(key, version);\n  }\n\n  recohereKey(key: K, version: number): void {\n    if (this.version < 0) {\n      const oldEffects = this.effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willRecohereKey(key, effect, version);\n        (this as Mutable<this>).effects = oldEffects.removed(key);\n        if (this.input !== null) {\n          this.input.recohereInputKey(key, version);\n        }\n        this.onRecohereKey(key, effect, version);\n        const outputs = this.outputs;\n        for (let i = 0, n = outputs.length; i < n; i += 1) {\n          const output = outputs[i];\n          if (MapInlet.is(output)) {\n            output.recohereOutputKey(key, version);\n          }\n        }\n        const outlet = this.outlets.get(key);\n        if (outlet !== void 0) {\n          outlet.recohereInput(version);\n        }\n        this.didRecohereKey(key, effect, version);\n      }\n    }\n  }\n\n  recohereOutput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohereInput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      this.effects.forEach(function (key: K): void {\n        this.recohereKey(key, version);\n      }, this);\n      (this as Mutable<this>).version = version;\n      this.onRecohere(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i]!;\n        output.recohereOutput(version);\n      }\n      this.didRecohere(version);\n    }\n  }\n\n  protected willDecohereKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected onDecohereKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected didDecohereKey(key: K, effect: KeyEffect): void {\n    // hook\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected willRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected onRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    if (effect === KeyEffect.Update) {\n      const input = this.input;\n      if (input !== null) {\n        const value = input.get(key);\n        if (value !== void 0) {\n          this.set(key, value);\n        } else {\n          this.delete(key);\n        }\n      }\n    } else if (effect === KeyEffect.Remove) {\n      this.delete(key);\n    }\n  }\n\n  protected didRecohereKey(key: K, effect: KeyEffect, version: number): void {\n    // hook\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohere(version: number): void {\n    // hook\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface MapDownlink<K, V, KU, VU> {\n  hostUri(): Uri;\n  hostUri(hostUri: AnyUri): MapDownlink<K, V, KU, VU>;\n\n  nodeUri(): Uri;\n  nodeUri(nodeUri: AnyUri): MapDownlink<K, V, KU, VU>;\n\n  laneUri(): Uri;\n  laneUri(laneUri: AnyUri): MapDownlink<K, V, KU, VU>;\n\n  prio(): number;\n  prio(prio: number): MapDownlink<K, V, KU, VU>;\n\n  rate(): number;\n  rate(rate: number): MapDownlink<K, V, KU, VU>;\n\n  body(): Value;\n  body(body: AnyValue): MapDownlink<K, V, KU, VU>;\n\n  keepLinked(): boolean;\n  keepLinked(keepLinked: boolean): MapDownlink<K, V, KU, VU>;\n\n  keepSynced(): boolean;\n  keepSynced(keepSynced: boolean): MapDownlink<K, V, KU, VU>;\n}\n/** @public */\nexport interface MapDownlink<K, V, KU, VU> extends MapOutletCombinators<K, V, MapDownlink<K, V, KU, VU>> {\n}\nMapOutletCombinators.define(MapDownlink.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {Value} from \"@swim/structure\";\nimport type {Uri} from \"@swim/uri\";\nimport type {EventMessage} from \"@swim/warp\";\nimport type {Host} from \"../host/Host\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport type {DownlinkType} from \"./Downlink\";\nimport type {ValueDownlink} from \"./ValueDownlink\";\n\n/** @internal */\nexport class ValueDownlinkModel extends DownlinkModel {\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value, state: Value = Value.absent()) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n    this.state = state;\n  }\n\n  override readonly views!: ReadonlyArray<ValueDownlink<unknown>>;\n\n  /** @internal */\n  readonly state: Value;\n\n  override get type(): DownlinkType {\n    return \"value\";\n  }\n\n  get(): Value {\n    return this.state;\n  }\n\n  set(newValue: Value): void {\n    newValue = this.valueWillSet(newValue);\n    const oldValue = this.state;\n    this.setState(newValue);\n    this.valueDidSet(newValue, oldValue);\n    this.command(newValue);\n  }\n\n  setState(state: Value): void {\n    (this as Mutable<this>).state = state;\n  }\n\n  override onEventMessage(message: EventMessage, host: Host): void {\n    super.onEventMessage(message, host);\n    this.onSetEvent(message.body);\n  }\n\n  protected onSetEvent(newValue: Value): void {\n    newValue = this.valueWillSet(newValue);\n    const oldValue = this.state;\n    this.setState(newValue);\n    this.valueDidSet(newValue, oldValue);\n  }\n\n  protected valueWillSet(newValue: Value): Value {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      newValue = views[i]!.valueWillSet(newValue);\n    }\n    return newValue;\n  }\n\n  protected valueDidSet(newValue: Value, oldValue: Value): void {\n    const views = this.views;\n    for (let i = 0, n = views.length; i < n; i += 1) {\n      views[i]!.valueDidSet(newValue, oldValue);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays, Cursor} from \"@swim/util\";\nimport {AnyValue, Value, Form} from \"@swim/structure\";\nimport {Inlet, Outlet, OutletCombinators} from \"@swim/streamlet\";\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport type {DownlinkContext} from \"./DownlinkContext\";\nimport type {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {ValueDownlinkModel} from \"./ValueDownlinkModel\";\n\n/** @public */\nexport type ValueDownlinkWillSet<V, VU = never> = (newValue: V, downlink: ValueDownlink<V, VU>) => V | void;\n/** @public */\nexport type VaueDownlinkDidSet<V, VU = never> = (newValue: V, oldValue: V, downlink: ValueDownlink<V, VU>) => void;\n\n/** @public */\nexport interface ValueDownlinkObserver<V, VU = never> extends DownlinkObserver {\n  willSet?: ValueDownlinkWillSet<V, VU>;\n  didSet?: VaueDownlinkDidSet<V, VU>;\n}\n\n/** @public */\nexport interface ValueDownlinkInit<V, VU = never> extends ValueDownlinkObserver<V, VU>, DownlinkInit {\n  valueForm?: Form<V, VU>;\n}\n\n/** @public */\nexport class ValueDownlink<V, VU = never> extends Downlink implements Inlet<V>, Outlet<V> {\n  /** @internal */\n  constructor(context: DownlinkContext, owner: DownlinkOwner | null, init?: ValueDownlinkInit<V, VU>,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number, rate?: number,\n              body?: Value, flags: number = DownlinkFlags.KeepLinkedSynced,\n              observers?: ReadonlyArray<ValueDownlinkObserver<V, VU>> | ValueDownlinkObserver<V, VU>,\n              valueForm?: Form<V, VU>, state0: Value = Value.absent()) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n    if (init !== void 0) {\n      const observer = this.observers[this.observers.length - 1]!;\n      observer.willSet = init.willSet ?? observer.willSet;\n      observer.didSet = init.didSet ?? observer.didSet;\n      valueForm = init.valueForm !== void 0 ? init.valueForm : valueForm;\n    }\n    this.ownValueForm = valueForm !== void 0 ? valueForm : Form.forValue() as unknown as Form<V, VU>;\n    this.state0 = state0;\n    this.input = null;\n    this.outputs = Arrays.empty;\n    this.version = -1;\n  }\n\n  /** @internal */\n  override readonly model!: ValueDownlinkModel | null;\n\n  /** @internal */\n  override observers!: ReadonlyArray<ValueDownlinkObserver<V, VU>>;\n\n  /** @internal */\n  readonly ownValueForm: Form<V, VU>;\n\n  /** @internal */\n  readonly state0: Value;\n\n  override get type(): DownlinkType {\n    return \"value\";\n  }\n\n  /** @internal */\n  protected override copy<V, VU>(context: DownlinkContext, owner: DownlinkOwner | null,\n                                 hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                                 body: Value, flags: number, observers: ReadonlyArray<ValueDownlinkObserver<V, VU>>,\n                                 valueForm?: Form<V, VU>, state0?: Value): ValueDownlink<V, VU> {\n    if (arguments.length === 10) {\n      state0 = this.state0;\n      valueForm = this.ownValueForm as unknown as Form<V, VU>;\n    }\n    return new ValueDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                             prio, rate, body, flags, observers, valueForm, state0);\n  }\n\n  valueForm(): Form<V, VU>;\n  valueForm<V2, V2U = never>(valueForm: Form<V2, V2U>): ValueDownlink<V2, V2U>;\n  valueForm<V2, V2U = never>(valueForm?: Form<V2, V2U>): Form<V, VU> | ValueDownlink<V2, V2U> {\n    if (valueForm === void 0) {\n      return this.ownValueForm;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers as any,\n                       valueForm, this.state0);\n    }\n  }\n\n  get(): V {\n    const value = this.model!.get();\n    const object = value.coerce(this.ownValueForm);\n    return object;\n  }\n\n  set(newObject: V | VU): void {\n    const newValue = this.ownValueForm.mold(newObject);\n    this.model!.set(newValue);\n  }\n\n  setState(state: Value): void {\n    this.model!.setState(state);\n  }\n\n  override observe(observer: ValueDownlinkObserver<V, VU>): this {\n    return super.observe(observer);\n  }\n\n  willSet(willSet: ValueDownlinkWillSet<V, VU>): this {\n    return this.observe({willSet});\n  }\n\n  didSet(didSet: VaueDownlinkDidSet<V, VU>): this {\n    return this.observe({didSet});\n  }\n\n  /** @internal */\n  valueWillSet(newValue: Value): Value {\n    let newObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.willSet !== void 0) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this.ownValueForm);\n        }\n        const newResult = observer.willSet(newObject, this);\n        if (newResult !== void 0) {\n          newObject = newResult;\n          newValue = this.ownValueForm.mold(newObject);\n        }\n      }\n    }\n    return newValue;\n  }\n\n  /** @internal */\n  valueDidSet(newValue: Value, oldValue: Value): void {\n    let newObject: V | undefined;\n    let oldObject: V | undefined;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didSet !== void 0) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this.ownValueForm);\n        }\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this.ownValueForm);\n        }\n        observer.didSet(newObject, oldObject, this);\n      }\n    }\n    this.decohere();\n    this.recohere(0); // TODO: debounce update; track version\n  }\n\n  initialState(): Value;\n  initialState(state0: Value): ValueDownlink<V, VU>;\n  initialState(state0?: Value): Value | ValueDownlink<V, VU> {\n    if (state0 === void 0) {\n      return this.state0;\n    } else {\n      return this.copy(this.context, this.owner, this.ownHostUri, this.ownNodeUri, this.ownLaneUri,\n                       this.ownPrio, this.ownRate, this.ownBody, this.flags, this.observers,\n                       this.ownValueForm, state0);\n    }\n  }\n\n  /** @internal */\n  protected didAliasModel(): void {\n    this.onLinkedResponse();\n    this.valueDidSet(this.model!.get(), Value.absent());\n    this.onSyncedResponse();\n  }\n\n  override open(): this {\n    const laneUri = this.ownLaneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this.ownNodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this.ownHostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this.context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model !== void 0) {\n      if (!(model instanceof ValueDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n      (this as Mutable<this>).model = model as ValueDownlinkModel;\n      setTimeout(this.didAliasModel.bind(this));\n    } else {\n      model = new ValueDownlinkModel(this.context, hostUri, nodeUri, laneUri, this.ownPrio,\n                                     this.ownRate, this.ownBody, this.state0);\n      model.addDownlink(this);\n      this.context.openDownlink(model);\n      (this as Mutable<this>).model = model as ValueDownlinkModel;\n    }\n    if (this.owner !== null) {\n      this.owner.addDownlink(this);\n    }\n    return this;\n  }\n\n  readonly input: Outlet<V> | null;\n\n  /** @internal */\n  readonly outputs: ReadonlyArray<Inlet<V>>;\n\n  /** @internal */\n  readonly version: number;\n\n  bindInput(newInput: Outlet<V> | null): void {\n    const oldInput = this.input;\n    if (oldInput !== newInput) {\n      if (oldInput !== null) {\n        oldInput.unbindOutput(this);\n      }\n      (this as Mutable<this>).input = newInput;\n      if (newInput !== null) {\n        newInput.bindOutput(this);\n      }\n    }\n  }\n\n  unbindInput(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n    }\n  }\n\n  disconnectInputs(): void {\n    const oldInput = this.input;\n    if (oldInput !== null) {\n      oldInput.unbindOutput(this);\n      (this as Mutable<this>).input = null;\n      oldInput.disconnectInputs();\n    }\n  }\n\n  outputIterator(): Cursor<Inlet<V>> {\n    return Cursor.array(this.outputs);\n  }\n\n  bindOutput(output: Inlet<V>): void {\n    (this as Mutable<this>).outputs = Arrays.inserted(output, this.outputs);\n  }\n\n  unbindOutput(output: Inlet<V>): void {\n    (this as Mutable<this>).outputs = Arrays.removed(output, this.outputs);\n  }\n\n  unbindOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n    }\n  }\n\n  disconnectOutputs(): void {\n    const oldOutputs = this.outputs;\n    (this as Mutable<this>).outputs = Arrays.empty;\n    for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n      const output = oldOutputs[i]!;\n      output.unbindInput();\n      output.disconnectOutputs();\n    }\n  }\n\n  decohereOutput(): void {\n    this.decohere();\n  }\n\n  decohereInput(): void {\n    this.decohere();\n  }\n\n  decohere(): void {\n    if (this.version >= 0) {\n      this.willDecohere();\n      (this as Mutable<this>).version = -1;\n      this.onDecohere();\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        outputs[i]!.decohereOutput();\n      }\n      this.didDecohere();\n    }\n  }\n\n  recohereOutput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohereInput(version: number): void {\n    this.recohere(version);\n  }\n\n  recohere(version: number): void {\n    if (this.version < 0) {\n      this.willRecohere(version);\n      (this as Mutable<this>).version = version;\n      if (this.input !== null) {\n        this.input.recohereInput(version);\n      }\n      this.onRecohere(version);\n      const outputs = this.outputs;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        outputs[i]!.recohereOutput(version);\n      }\n      this.didRecohere(version);\n    }\n  }\n\n  protected willDecohere(): void {\n    // hook\n  }\n\n  protected onDecohere(): void {\n    // hook\n  }\n\n  protected didDecohere(): void {\n    // hook\n  }\n\n  protected willRecohere(version: number): void {\n    // hook\n  }\n\n  protected onRecohere(version: number): void {\n    const input = this.input;\n    if (input !== null) {\n      const value = input.get();\n      if (value !== void 0) {\n        this.set(value);\n      }\n    }\n  }\n\n  protected didRecohere(version: number): void {\n    // hook\n  }\n}\n/** @public */\nexport interface ValueDownlink<V, VU> {\n  hostUri(): Uri;\n  hostUri(hostUri: AnyUri): ValueDownlink<V, VU>;\n\n  nodeUri(): Uri;\n  nodeUri(nodeUri: AnyUri): ValueDownlink<V, VU>;\n\n  laneUri(): Uri;\n  laneUri(laneUri: AnyUri): ValueDownlink<V, VU>;\n\n  prio(): number;\n  prio(prio: number): ValueDownlink<V, VU>;\n\n  rate(): number;\n  rate(rate: number): ValueDownlink<V, VU>;\n\n  body(): Value;\n  body(body: AnyValue): ValueDownlink<V, VU>;\n\n  keepLinked(): boolean;\n  keepLinked(keepLinked: boolean): ValueDownlink<V, VU>;\n\n  keepSynced(): boolean;\n  keepSynced(keepSynced: boolean): ValueDownlink<V, VU>;\n}\n/** @public */\nexport interface ValueDownlink<V, VU> extends OutletCombinators<V> {\n}\nOutletCombinators.define(ValueDownlink.prototype);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AbstractRecordOutlet} from \"@swim/dataflow\";\nimport type {Downlink} from \"./Downlink\";\n\n/** @public */\nexport abstract class DownlinkRecord extends AbstractRecordOutlet {\n  abstract readonly downlink: Downlink;\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Cursor} from \"@swim/util\";\nimport {AnyItem, Item, Slot, AnyValue, Value, Record, AnyText, AnyNum, Num} from \"@swim/structure\";\nimport {KeyEffect} from \"@swim/streamlet\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport type {MapDownlinkObserver, MapDownlink} from \"./MapDownlink\";\n\n/** @public */\nexport class MapDownlinkRecord extends DownlinkRecord implements MapDownlinkObserver<Value, Value, AnyValue, AnyValue> {\n  constructor(downlink: MapDownlink<Value, Value, AnyValue, AnyValue>) {\n    super();\n    this.downlink = downlink;\n    downlink.observe(this);\n  }\n\n  override readonly downlink: MapDownlink<Value, Value, AnyValue, AnyValue>;\n\n  override isEmpty(): boolean {\n    return this.downlink.isEmpty();\n  }\n\n  override isArray(): boolean {\n    return this.downlink.isEmpty();\n  }\n\n  override isObject(): boolean {\n    return true;\n  }\n\n  override get length(): number {\n    return this.downlink.size;\n  }\n\n  override has(key: AnyValue): boolean {\n    return this.downlink.has(key);\n  }\n\n  override get(): Record;\n  override get(key: AnyValue): Value;\n  override get(key?: AnyValue): Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      return this.downlink.get(key);\n    }\n  }\n\n  override getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  override getSlot(key: AnyValue): Value {\n    return this.get(key);\n  }\n\n  override getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this.downlink.size;\n    if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(Math.max(0, index), n - 1);\n    if (index >= 0) {\n      const entry = this.downlink.getEntry(index)!;\n      return Slot.of(entry[0], entry[1]);\n    }\n    return Item.absent();\n  }\n\n  override set(key: AnyValue, newValue: AnyValue): this {\n    this.downlink.set(key, newValue);\n    return this;\n  }\n\n  override setAttr(key: AnyText, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setSlot(key: AnyValue, newValue: AnyValue): this {\n    return this.set(key, newValue);\n  }\n\n  override setItem(index: number, newItem: AnyItem): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override push(...newItems: AnyItem[]): number {\n    throw new Error(\"unsupported\");\n  }\n\n  override splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    throw new Error(\"unsupported\");\n  }\n\n  override delete(key: AnyValue): Item {\n    key = Value.fromAny(key);\n    const oldValue = this.downlink.get(key);\n    if (this.downlink.delete(key)) {\n      return Slot.of(key, oldValue);\n    }\n    return Item.absent();\n  }\n\n  override clear(): void {\n    this.downlink.clear();\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    let index = 0;\n    return this.downlink.forEach(function (key: Value, value: Value): T | void {\n      const result = callback.call(thisArg, Slot.of(key, value), index);\n      index += 1;\n      return result;\n    });\n  }\n\n  override keyIterator(): Cursor<Value> {\n    return this.downlink.keys();\n  }\n\n  didUpdate(key: Value, newValue: Value, oldValue: Value): void {\n    this.decohereInputKey(key, KeyEffect.Update);\n    this.recohereInput(0); // TODO: debounce\n  }\n\n  didRemove(key: Value, oldValue: Value): void {\n    this.decohereInputKey(key, KeyEffect.Remove);\n    this.recohereInput(0); // TODO: debounce\n  }\n\n  didDrop(lower: number): void {\n    // TODO\n  }\n\n  didTake(upper: number): void {\n    // TODO\n  }\n\n  didClear(): void {\n    // TODO\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Item, Field, Value, Record} from \"@swim/structure\";\nimport {RecordModel, Reifier} from \"@swim/dataflow\";\nimport {DownlinkStreamlet} from \"./DownlinkStreamlet\";\nimport type {WarpRef} from \"../ref/WarpRef\";\n\n/** @internal */\nexport class DownlinkReifier extends Reifier {\n  constructor(warp: WarpRef | null = null) {\n    super();\n    this.warp = warp;\n  }\n\n  warp: WarpRef | null;\n\n  override reify(item: Item): Item {\n    if (item instanceof Field) {\n      return this.reifyField(item);\n    } else {\n      return this.reifyValue(item);\n    }\n  }\n\n  /** @internal */\n  reifyField(field: Field): Field {\n    const oldValue = field.value;\n    const newValue = this.reifyValue(oldValue);\n    if (oldValue !== newValue) {\n      return field.updatedValue(newValue);\n    } else {\n      return field;\n    }\n  }\n\n  /** @internal */\n  reifyValue(value: Value): Value {\n    if (value instanceof RecordModel) {\n      return this.reifyModel(value);\n    } else {\n      return value;\n    }\n  }\n\n  /** @internal */\n  reifyModel(model: RecordModel): Record {\n    if (model.tag === \"link\") {\n      const streamlet = new DownlinkStreamlet(this.warp, model);\n      streamlet.compile();\n      return streamlet;\n    }\n    return model;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Map} from \"@swim/util\";\nimport {Value, Form} from \"@swim/structure\";\nimport {Outlet, Inoutlet, StreamletScope, Out, Inout} from \"@swim/streamlet\";\nimport {AbstractRecordStreamlet, Reifier} from \"@swim/dataflow\";\nimport type {DownlinkType, Downlink} from \"./Downlink\";\nimport {ValueDownlink} from \"./ValueDownlink\";\nimport type {DownlinkRecord} from \"./DownlinkRecord\";\nimport {MapDownlinkRecord} from \"./MapDownlinkRecord\";\nimport {DownlinkReifier} from \"./DownlinkReifier\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport {client} from \"../\"; // forward import\n\n/** @public */\nexport class DownlinkStreamlet extends AbstractRecordStreamlet {\n  constructor(warp: WarpRef | null = null, scope?: StreamletScope<Value> | null) {\n    super(scope);\n    this.warp = warp;\n    this.downlink = null;\n    this.downlinkRecord = null;\n\n    this.inputHostUri = void 0;\n    this.inputNodeUri = void 0;\n    this.inputLaneUri = void 0;\n    this.inputPrio = void 0;\n    this.inputRate = void 0;\n    this.inputBody = void 0;\n    this.inputType = void 0;\n  }\n\n  warp: WarpRef | null;\n\n  downlink: Downlink | null;\n\n  /** @internal */\n  downlinkRecord: DownlinkRecord | null;\n\n  /** @internal */\n  inputHostUri: string | undefined;\n  /** @internal */\n  inputNodeUri: string | undefined;\n  /** @internal */\n  inputLaneUri: string | undefined;\n  /** @internal */\n  inputPrio: number | undefined;\n  /** @internal */\n  inputRate: number | undefined;\n  /** @internal */\n  inputBody: Value | undefined;\n  /** @internal */\n  inputType: DownlinkType | undefined;\n\n  @Inout\n  hostUri: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  nodeUri: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  laneUri: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  prio: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  rate: Inoutlet<Value> = this.inoutlet();\n\n  @Inout(\"body\")\n  bodyValue: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  type: Inoutlet<Value> = this.inoutlet();\n\n  @Out\n  state: Outlet<Value | Map<Value, Value>> = this.outlet();\n\n  override getOutput(outlet: Outlet<Value> | string): Value | undefined {\n    outlet = this.outlet(outlet)!;\n    if (outlet === this.state) {\n      if (this.downlink instanceof ValueDownlink) {\n        return this.downlink.get();\n      } else if (this.downlinkRecord !== null) {\n        return this.downlinkRecord;\n      }\n    }\n    return void 0;\n  }\n\n  protected override onRecohere(version: number): void {\n    const hostUri = this.castInput(this.hostUri, Form.forString());\n    const nodeUri = this.castInput(this.nodeUri, Form.forString());\n    const laneUri = this.castInput(this.laneUri, Form.forString());\n    const prio = this.castInput(this.prio, Form.forNumber(), 0);\n    const rate = this.castInput(this.rate, Form.forNumber(), 0);\n    const body = this.getInput(this.bodyValue);\n    const type = this.castInput(this.type, Form.forString(), void 0) as DownlinkType | undefined;\n    if (hostUri !== this.inputHostUri || nodeUri !== this.inputNodeUri || laneUri !== this.inputLaneUri\n        || prio !== this.inputPrio || rate !== this.inputRate\n        || (body === void 0 ? this.inputBody !== void 0 : !body.equals(this.inputBody))\n        || type !== this.inputType) {\n      if (this.downlink !== null) {\n        this.downlink.close();\n        this.downlink = null;\n        this.downlinkRecord = null;\n      }\n      this.inputHostUri = hostUri;\n      this.inputNodeUri = nodeUri;\n      this.inputLaneUri = laneUri;\n      this.inputPrio = prio;\n      this.inputRate = rate;\n      this.inputBody = body;\n      this.inputType = type;\n      const warp = this.warp ?? client;\n      if (type === \"map\") {\n        let downlink = warp.downlinkMap();\n        if (hostUri !== void 0) {\n          downlink = downlink.hostUri(hostUri);\n        }\n        if (nodeUri !== void 0) {\n          downlink = downlink.nodeUri(nodeUri);\n        }\n        if (laneUri !== void 0) {\n          downlink = downlink.laneUri(laneUri);\n        }\n        if (prio !== 0) {\n          downlink = downlink.prio(prio);\n        }\n        if (rate !== 0) {\n          downlink = downlink.rate(rate);\n        }\n        if (body !== void 0) {\n          downlink = downlink.body(body);\n        }\n        downlink = downlink.open();\n        this.state = downlink;\n        this.downlink = downlink;\n        this.downlinkRecord = new MapDownlinkRecord(downlink);\n      } else if (type === \"value\") {\n        let downlink = warp.downlinkValue();\n        if (hostUri !== void 0) {\n          downlink = downlink.hostUri(hostUri);\n        }\n        if (nodeUri !== void 0) {\n          downlink = downlink.nodeUri(nodeUri);\n        }\n        if (laneUri !== void 0) {\n          downlink = downlink.laneUri(laneUri);\n        }\n        if (prio !== void 0) {\n          downlink = downlink.prio(prio);\n        }\n        if (rate !== void 0) {\n          downlink = downlink.rate(rate);\n        }\n        if (body !== void 0) {\n          downlink = downlink.body(body);\n        }\n        downlink = downlink.open();\n        this.state = downlink;\n        this.downlink = downlink;\n      }\n    }\n  }\n\n  private static _reifier?: DownlinkReifier;\n  /** @beta */\n  static reifier(warp?: WarpRef): Reifier {\n    if (warp === void 0) {\n      if (DownlinkStreamlet._reifier === void 0) {\n        DownlinkStreamlet._reifier = new DownlinkReifier();\n      }\n      return DownlinkStreamlet._reifier;\n    } else {\n      return new DownlinkReifier(warp);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays} from \"@swim/util\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport type {AnyUri, Uri} from \"@swim/uri\";\nimport type {Host} from \"../host/Host\";\nimport type {DownlinkOwner} from \"../downlink/DownlinkOwner\";\nimport type {Downlink} from \"../downlink/Downlink\";\nimport type {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport type {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport type {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport type {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport type {RefContext} from \"./RefContext\";\nimport type {HostRef} from \"./HostRef\";\nimport type {NodeRef} from \"./NodeRef\";\nimport type {LaneRef} from \"./LaneRef\";\nimport type {WarpRef} from \"./WarpRef\";\nimport type {\n  WarpDidConnect,\n  WarpDidAuthenticate,\n  WarpDidDeauthenticate,\n  WarpDidDisconnect,\n  WarpDidFail,\n  WarpObserver,\n} from \"./WarpObserver\";\n\n/** @public */\nexport abstract class BaseRef implements DownlinkOwner, WarpRef {\n  constructor(context: RefContext) {\n    this.context = context;\n    this.host = null;\n    this.downlinks = [];\n    this.observers = Arrays.empty;\n  }\n\n  /** @internal */\n  readonly context: RefContext;\n\n  /** @internal */\n  readonly host: Host | null;\n\n  /** @internal */\n  readonly downlinks: Downlink[];\n\n  /** @internal */\n  readonly observers: ReadonlyArray<WarpObserver>;\n\n  abstract readonly hostUri: Uri;\n\n  isConnected(): boolean {\n    const host = this.host;\n    return host !== null && host.isConnected();\n  }\n\n  isAuthenticated(): boolean {\n    const host = this.host;\n    return host !== null && host.isAuthenticated();\n  }\n\n  get session(): Value {\n    const host = this.host;\n    return host !== null ? host.session : Value.absent();\n  }\n\n  authenticate(credentials: AnyValue): void {\n    this.context.authenticate(this.hostUri, credentials);\n  }\n\n  abstract downlink(init?: EventDownlinkInit): EventDownlink;\n\n  abstract downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  abstract downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n\n  abstract downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  abstract downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n\n  abstract downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  abstract downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n\n  abstract hostRef(hostUri: AnyUri): HostRef;\n\n  abstract nodeRef(hostUri: AnyUri, nodeUri: AnyUri): NodeRef;\n  abstract nodeRef(nodeUri: AnyUri): NodeRef;\n\n  abstract laneRef(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri): LaneRef;\n  abstract laneRef(nodeUri: AnyUri, laneUri: AnyUri): LaneRef;\n\n  /** @internal */\n  addDownlink(downlink: Downlink): void {\n    const downlinks = this.downlinks;\n    if (downlinks.length === 0) {\n      this.open();\n    }\n    downlinks.push(downlink);\n  }\n\n  /** @internal */\n  removeDownlink(downlink: Downlink): void {\n    const downlinks = this.downlinks;\n    const i = downlinks.indexOf(downlink);\n    if (i >= 0) {\n      downlinks.splice(i, 1);\n      if (downlinks.length === 0) {\n        this.close();\n      }\n    }\n  }\n\n  open(): void {\n    this.context.openRef(this);\n  }\n\n  close(): void {\n    this.context.closeRef(this);\n  }\n\n  /** @internal */\n  closeUp(): void {\n    const downlinks = this.downlinks;\n    (this as Mutable<this>).downlinks = [];\n    for (let i = 0, n = downlinks.length; i < n; i += 1) {\n      downlinks[i]!.close();\n    }\n  }\n\n  observe(observer: WarpObserver): this {\n    (this as Mutable<this>).observers = Arrays.inserted(observer, this.observers);\n    return this;\n  }\n\n  unobserve(observer: unknown): this {\n    const oldObservers = this.observers;\n    const n = oldObservers.length;\n    for (let i = 0; i < n; i += 1) {\n      const oldObserver = oldObservers[i]! as {[key: string]: unknown};\n      let found = oldObserver === observer; // check object identity\n      if (!found) {\n        for (const key in oldObserver) { // check property identity\n          if (oldObserver[key] === observer) {\n            found = true;\n            break;\n          }\n        }\n      }\n      if (found) {\n        if (n > 1) {\n          const newObservers = new Array<WarpObserver>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newObservers[j] = oldObservers[j]!;\n          }\n          for (let j = i + 1; j < n; j += 1) {\n            newObservers[j - 1] = oldObservers[j]!;\n          }\n          (this as Mutable<this>).observers = newObservers;\n        } else {\n          (this as Mutable<this>).observers = Arrays.empty;\n        }\n        break;\n      }\n    }\n    return this;\n  }\n\n  didConnect(didConnect: WarpDidConnect): this {\n    return this.observe({didConnect});\n  }\n\n  didAuthenticate(didAuthenticate: WarpDidAuthenticate): this {\n    return this.observe({didAuthenticate});\n  }\n\n  didDeauthenticate(didDeauthenticate: WarpDidDeauthenticate): this {\n    return this.observe({didDeauthenticate});\n  }\n\n  didDisconnect(didDisconnect: WarpDidDisconnect): this {\n    return this.observe({didDisconnect});\n  }\n\n  didFail(didFail: WarpDidFail): this {\n    return this.observe({didFail});\n  }\n\n  /** @internal */\n  hostDidConnect(host: Host): void {\n    (this as Mutable<this>).host = host;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didConnect !== void 0) {\n        observer.didConnect(host, this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidAuthenticate(body: Value, host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didAuthenticate !== void 0) {\n        observer.didAuthenticate(body, host, this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidDeauthenticate(body: Value, host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDeauthenticate !== void 0) {\n        observer.didDeauthenticate(body, host, this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidDisconnect(host: Host): void {\n    (this as Mutable<this>).host = null;\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDisconnect !== void 0) {\n        observer.didDisconnect(host, this);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidFail(error: unknown, host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didFail !== void 0) {\n        observer.didFail(error, host, this);\n      }\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Value, AnyValue} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport type {RefContext} from \"./RefContext\";\nimport {BaseRef} from \"./BaseRef\";\nimport {HostRef} from \"./HostRef\";\nimport {NodeRef} from \"./NodeRef\";\n\n/** @public */\nexport class LaneRef extends BaseRef {\n  constructor(context: RefContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri) {\n    super(context);\n    this.hostUri = hostUri;\n    this.nodeUri = nodeUri;\n    this.laneUri = laneUri;\n  }\n\n  override readonly hostUri: Uri;\n\n  readonly nodeUri: Uri;\n\n  readonly laneUri: Uri;\n\n  override hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this.context, hostUri as Uri);\n  }\n\n  override nodeRef(nodeUri: AnyUri): NodeRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    return new NodeRef(this.context, this.hostUri, nodeUri as Uri);\n  }\n\n  override laneRef(laneUri: AnyUri): LaneRef {\n    laneUri = Uri.fromAny(laneUri);\n    return new LaneRef(this.context, this.hostUri, this.nodeUri, laneUri as Uri);\n  }\n\n  override downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this.context, this, init, this.hostUri, this.nodeUri, this.laneUri);\n  }\n\n  override downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  override downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  override downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this.context, this, init, this.hostUri, this.nodeUri, this.laneUri);\n  }\n\n  override downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  override downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  override downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this.context, this, init, this.hostUri, this.nodeUri, this.laneUri);\n  }\n\n  override downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  override downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  override downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this.context, this, init, this.hostUri, this.nodeUri, this.laneUri);\n  }\n\n  command(body: AnyValue): void {\n    this.context.command(this.hostUri, this.nodeUri, this.laneUri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Value, AnyValue} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport type {RefContext} from \"./RefContext\";\nimport {BaseRef} from \"./BaseRef\";\nimport {HostRef} from \"./HostRef\";\nimport {LaneRef} from \"./LaneRef\";\n\n/** @public */\nexport class NodeRef extends BaseRef {\n  constructor(context: RefContext, hostUri: Uri, nodeUri: Uri) {\n    super(context);\n    this.hostUri = hostUri;\n    this.nodeUri = nodeUri;\n  }\n\n  override readonly hostUri: Uri;\n\n  readonly nodeUri: Uri;\n\n  override hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this.context, hostUri as Uri);\n  }\n\n  override nodeRef(nodeUri: AnyUri): NodeRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    return new NodeRef(this.context, this.hostUri, nodeUri as Uri);\n  }\n\n  override laneRef(laneUri: AnyUri): LaneRef {\n    laneUri = Uri.fromAny(laneUri);\n    return new LaneRef(this.context, this.hostUri, this.nodeUri, laneUri as Uri);\n  }\n\n  override downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this.context, this, init, this.hostUri, this.nodeUri);\n  }\n\n  override downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  override downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  override downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this.context, this, init, this.hostUri, this.nodeUri);\n  }\n\n  override downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  override downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  override downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this.context, this, init, this.hostUri, this.nodeUri);\n  }\n\n  override downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  override downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  override downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this.context, this, init, this.hostUri, this.nodeUri);\n  }\n\n  command(laneUri: AnyUri, body: AnyValue): void {\n    this.context.command(this.hostUri, this.nodeUri, laneUri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Value, AnyValue} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport type {RefContext} from \"./RefContext\";\nimport {BaseRef} from \"./BaseRef\";\nimport {NodeRef} from \"./NodeRef\";\nimport {LaneRef} from \"./LaneRef\";\n\n/** @public */\nexport class HostRef extends BaseRef {\n  constructor(context: RefContext, hostUri: Uri) {\n    super(context);\n    this.hostUri = hostUri;\n  }\n\n  override readonly hostUri: Uri;\n\n  override hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this.context, hostUri as Uri);\n  }\n\n  override nodeRef(nodeUri: AnyUri): NodeRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    return new NodeRef(this.context, this.hostUri, nodeUri as Uri);\n  }\n\n  override laneRef(nodeUri: AnyUri, laneUri: AnyUri): LaneRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    laneUri = Uri.fromAny(laneUri);\n    return new LaneRef(this.context, this.hostUri, nodeUri as Uri, laneUri as Uri);\n  }\n\n  override downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this.context, this, init, this.hostUri);\n  }\n\n  override downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  override downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  override downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this.context, this, init, this.hostUri);\n  }\n\n  override downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  override downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  override downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this.context, this, init, this.hostUri);\n  }\n\n  override downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  override downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  override downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this.context, this, init, this.hostUri);\n  }\n\n  command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void {\n    this.context.command(this.hostUri, nodeUri, laneUri, body);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Arrays} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport type {HostContext} from \"../host/HostContext\";\nimport type {HostOptions, Host} from \"../host/Host\";\nimport {WebSocketHost} from \"../host/WebSocketHost\";\nimport type {DownlinkModel} from \"../downlink/DownlinkModel\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport type {RefContext} from \"../ref/RefContext\";\nimport type {BaseRef} from \"../ref/BaseRef\";\nimport {HostRef} from \"../ref/HostRef\";\nimport {NodeRef} from \"../ref/NodeRef\";\nimport {LaneRef} from \"../ref/LaneRef\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport type {\n  WarpDidConnect,\n  WarpDidAuthenticate,\n  WarpDidDeauthenticate,\n  WarpDidDisconnect,\n  WarpDidFail,\n  WarpObserver,\n} from \"../ref/WarpObserver\";\n\n/** @public */\nexport interface WarpClientOptions extends HostOptions {\n  keepOnline?: boolean;\n}\n\n/** @public */\nexport class WarpClient implements HostContext, RefContext, WarpRef {\n  constructor(options: WarpClientOptions = {}) {\n    if (options.keepOnline === void 0) {\n      options.keepOnline = true;\n    }\n\n    this.options = options;\n    this.hosts = new BTree();\n    this.downlinks = new BTree();\n    this.downlinkCount = 0;\n    this.refs = [];\n    this.online = true;\n    this.observers = Arrays.empty;\n\n    this.onOnline = this.onOnline.bind(this);\n    this.onOffline = this.onOffline.bind(this);\n    this.watchOnline(!!options.keepOnline);\n  }\n\n  /** @internal */\n  readonly options: WarpClientOptions;\n\n  /** @internal */\n  readonly hosts: BTree<Uri, Host>;\n\n  /** @internal */\n  readonly downlinks: BTree<Uri, BTree<Uri, BTree<Uri, DownlinkModel>>>;\n\n  /** @internal */\n  readonly downlinkCount: number;\n\n  /** @internal */\n  readonly refs: BaseRef[];\n\n  /** @internal */\n  readonly online: boolean;\n\n  /** @internal */\n  readonly observers: ReadonlyArray<WarpObserver>;\n\n  isOnline(): boolean;\n  isOnline(online: boolean): this;\n  isOnline(online?: boolean): boolean | this {\n    if (online === void 0) {\n      return this.online;\n    } else {\n      if (this.online !== online) {\n        (this as Mutable<this>).online = online;\n        if (online) {\n          this.hosts.forEach(function (hostUri: Uri, host: Host): void {\n            host.open();\n          }, this);\n        }\n      }\n      return this;\n    }\n  }\n\n  keepOnline(): boolean;\n  keepOnline(keepOnline: boolean): this;\n  keepOnline(keepOnline?: boolean): boolean | this {\n    if (keepOnline === void 0) {\n      return !!this.options.keepOnline;\n    } else {\n      if (this.options.keepOnline !== keepOnline) {\n        this.options.keepOnline = keepOnline;\n        this.watchOnline(keepOnline);\n      }\n      return this;\n    }\n  }\n\n  protected watchOnline(keepOnline: boolean): void {\n    if (typeof window === \"object\") {\n      if (keepOnline) {\n        window.addEventListener(\"online\", this.onOnline);\n        window.addEventListener(\"offline\", this.onOffline);\n      } else {\n        window.removeEventListener(\"online\", this.onOnline);\n        window.removeEventListener(\"offline\", this.onOffline);\n      }\n    }\n  }\n\n  protected onOnline(event: Event): void {\n    this.isOnline(true);\n  }\n\n  protected onOffline(event: Event): void {\n    this.isOnline(false);\n  }\n\n  /** @internal */\n  getHost(hostUri: AnyUri): Host | undefined {\n    hostUri = Uri.fromAny(hostUri);\n    return this.hosts.get(hostUri as Uri);\n  }\n\n  /** @internal */\n  openHost(hostUri: AnyUri): Host {\n    hostUri = Uri.fromAny(hostUri);\n    let host = this.hosts.get(hostUri as Uri);\n    if (host === void 0) {\n      host = new WebSocketHost(this, hostUri as Uri, this.options);\n      this.hosts.set(hostUri as Uri, host);\n    }\n    return host;\n  }\n\n  /** @internal */\n  closeHost(host: Host): void {\n    if (this.hosts.get(host.hostUri) !== void 0) {\n      this.hosts.delete(host.hostUri);\n      host.closeUp();\n    }\n  }\n\n  /** @internal */\n  getDownlink(hostUri: Uri, nodeUri: Uri, laneUri: Uri): DownlinkModel | undefined {\n    const hostDownlinks = this.downlinks.get(hostUri);\n    if (hostDownlinks !== void 0) {\n      const nodeDownlinks = hostDownlinks.get(nodeUri);\n      if (nodeDownlinks !== void 0) {\n        return nodeDownlinks.get(laneUri);\n      }\n    }\n    return void 0;\n  }\n\n  /** @internal */\n  openDownlink(downlink: DownlinkModel): void {\n    const hostUri = downlink.hostUri;\n    const nodeUri = downlink.nodeUri;\n    const laneUri = downlink.laneUri;\n    let hostDownlinks = this.downlinks.get(hostUri);\n    if (hostDownlinks === void 0) {\n      hostDownlinks = new BTree();\n      this.downlinks.set(hostUri, hostDownlinks);\n    }\n    let nodeDownlinks = hostDownlinks.get(nodeUri);\n    if (nodeDownlinks === void 0) {\n      nodeDownlinks = new BTree();\n      hostDownlinks.set(nodeUri, nodeDownlinks);\n    }\n    if (nodeDownlinks.has(laneUri)) {\n      throw new Error(\"duplicate downlink\");\n    }\n    nodeDownlinks.set(laneUri, downlink);\n    (this as Mutable<this>).downlinkCount += 1;\n    const host = this.openHost(hostUri);\n    host.openDownlink(downlink);\n  }\n\n  /** @internal */\n  unlinkDownlink(downlink: DownlinkModel): void {\n    const hostUri = downlink.hostUri;\n    const host = this.getHost(hostUri);\n    if (host !== void 0) {\n      host.unlinkDownlink(downlink);\n    }\n  }\n\n  /** @internal */\n  closeDownlink(downlink: DownlinkModel): void {\n    const hostUri = downlink.hostUri;\n    const nodeUri = downlink.nodeUri;\n    const laneUri = downlink.laneUri;\n    const hostDownlinks = this.downlinks.get(hostUri);\n    if (hostDownlinks !== void 0) {\n      const nodeDownlinks = hostDownlinks.get(nodeUri);\n      if (nodeDownlinks !== void 0) {\n        if (nodeDownlinks.get(laneUri)) {\n          (this as Mutable<this>).downlinkCount -= 1;\n          nodeDownlinks.delete(laneUri);\n          if (nodeDownlinks.isEmpty()) {\n            hostDownlinks.delete(nodeUri);\n            if (hostDownlinks.isEmpty()) {\n              this.downlinks.delete(hostUri);\n            }\n          }\n          const host = this.getHost(hostUri);\n          if (host !== void 0) {\n            host.closeDownlink(downlink);\n          }\n        }\n      }\n    }\n  }\n\n  downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this, null, init);\n  }\n\n  downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  downlinkList<V extends VU, VU = never>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this, null, init);\n  }\n\n  downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  downlinkMap<K extends KU, V extends VU, KU = never, VU = never>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this, null, init);\n  }\n\n  downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  downlinkValue<V extends VU, VU = never>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this, null, init);\n  }\n\n  /** @internal */\n  openRef(ref: BaseRef): void {\n    this.refs.push(ref);\n  }\n\n  /** @internal */\n  closeRef(ref: BaseRef): void {\n    const refs = this.refs;\n    const index = refs.indexOf(ref);\n    if (index >= 0) {\n      refs.splice(index, 1);\n      ref.closeUp();\n    }\n  }\n\n  hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this, hostUri as Uri);\n  }\n\n  nodeRef(hostUri: AnyUri, nodeUri: AnyUri): NodeRef;\n  nodeRef(nodeUri: AnyUri): NodeRef;\n  nodeRef(hostUri: AnyUri, nodeUri?: AnyUri): NodeRef {\n    hostUri = Uri.fromAny(hostUri);\n    if (nodeUri === void 0) {\n      nodeUri = hostUri;\n      hostUri = (nodeUri as Uri).endpoint();\n      nodeUri = (hostUri as Uri).unresolve(nodeUri);\n    } else {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    return new NodeRef(this, hostUri as Uri, nodeUri as Uri);\n  }\n\n  laneRef(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri): LaneRef;\n  laneRef(nodeUri: AnyUri, laneUri: AnyUri): LaneRef;\n  laneRef(hostUri: AnyUri, nodeUri: AnyUri, laneUri?: AnyUri): LaneRef {\n    hostUri = Uri.fromAny(hostUri);\n    nodeUri = Uri.fromAny(nodeUri);\n    if (laneUri === void 0) {\n      laneUri = nodeUri;\n      nodeUri = hostUri;\n      hostUri = (nodeUri as Uri).endpoint();\n      nodeUri = (hostUri as Uri).unresolve(nodeUri);\n    } else {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    return new LaneRef(this, hostUri as Uri, nodeUri as Uri, laneUri as Uri);\n  }\n\n  authenticate(hostUri: AnyUri, credentials: AnyValue): void {\n    hostUri = Uri.fromAny(hostUri);\n    credentials = Value.fromAny(credentials);\n    const host = this.openHost(hostUri);\n    host.authenticate(credentials);\n  }\n\n  command(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void;\n  command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void;\n  command(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri | AnyValue, body?: AnyValue): void {\n    hostUri = Uri.fromAny(hostUri);\n    nodeUri = Uri.fromAny(nodeUri);\n    if (arguments.length === 3) {\n      body = laneUri as Value;\n      laneUri = nodeUri;\n      nodeUri = hostUri;\n      hostUri = (nodeUri as Uri).endpoint();\n      nodeUri = (hostUri as Uri).unresolve(nodeUri);\n    } else {\n      laneUri = Uri.fromAny(laneUri as AnyUri);\n    }\n    body = Value.fromAny(body);\n    const host = this.openHost(hostUri);\n    host.command(nodeUri, laneUri, body);\n  }\n\n  close(): void {\n    const refs = this.refs;\n    (this as Mutable<this>).refs = [];\n    for (let i = 0; i < refs.length; i += 1) {\n      refs[i]!.closeUp();\n    }\n    const downlinks = this.downlinks.clone();\n    this.downlinks.clear();\n    (this as Mutable<this>).downlinkCount = 0;\n    downlinks.forEach(function (hostUri: Uri, hostDownlinks: BTree<Uri, BTree<Uri, DownlinkModel>>): void {\n      hostDownlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, DownlinkModel>): void {\n        nodeDownlinks.forEach(function (laneUri: Uri, downlink: DownlinkModel): void {\n          downlink.closeUp();\n          const host = this.getHost(hostUri);\n          if (host !== void 0) {\n            host.closeDownlink(downlink);\n          }\n        }, this);\n      }, this);\n    }, this);\n    const hosts = this.hosts.clone();\n    this.hosts.clear();\n    hosts.forEach(function (hostUri: Uri, host: Host): void {\n      host.closeUp();\n    }, this);\n  }\n\n  observe(observer: WarpObserver): this {\n    (this as Mutable<this>).observers = Arrays.inserted(observer, this.observers);\n    return this;\n  }\n\n  unobserve(observer: unknown): this {\n    const oldObservers = this.observers;\n    const n = oldObservers.length;\n    for (let i = 0; i < n; i += 1) {\n      const oldObserver = oldObservers[i]! as {[key: string]: unknown};\n      let found = oldObserver === observer; // check object identity\n      if (!found) {\n        for (const key in oldObserver) { // check property identity\n          if (oldObserver[key] === observer) {\n            found = true;\n            break;\n          }\n        }\n      }\n      if (found) {\n        if (n > 1) {\n          const newObservers = new Array<WarpObserver>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newObservers[j] = oldObservers[j]!;\n          }\n          for (let j = i + 1; j < n; j += 1) {\n            newObservers[j - 1] = oldObservers[j]!;\n          }\n          (this as Mutable<this>).observers = newObservers;\n        } else {\n          (this as Mutable<this>).observers = Arrays.empty;\n        }\n        break;\n      }\n    }\n    return this;\n  }\n\n  didConnect(didConnect: WarpDidConnect): this {\n    return this.observe({didConnect});\n  }\n\n  didAuthenticate(didAuthenticate: WarpDidAuthenticate): this {\n    return this.observe({didAuthenticate});\n  }\n\n  didDeauthenticate(didDeauthenticate: WarpDidDeauthenticate): this {\n    return this.observe({didDeauthenticate});\n  }\n\n  didDisconnect(didDisconnect: WarpDidDisconnect): this {\n    return this.observe({didDisconnect});\n  }\n\n  didFail(didFail: WarpDidFail): this {\n    return this.observe({didFail});\n  }\n\n  /** @internal */\n  hostDidConnect(host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didConnect !== void 0) {\n        observer.didConnect(host, this);\n      }\n    }\n    const refs = this.refs;\n    for (let i = 0, n = refs.length; i < n; i += 1) {\n      const ref = refs[i]!;\n      if (ref.hostUri.equals(host.hostUri)) {\n        ref.hostDidConnect(host);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidAuthenticate(body: Value, host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didAuthenticate !== void 0) {\n        observer.didAuthenticate(body, host, this);\n      }\n    }\n    const refs = this.refs;\n    for (let i = 0, n = refs.length; i < n; i += 1) {\n      const ref = refs[i]!;\n      if (ref.hostUri.equals(host.hostUri)) {\n        ref.hostDidAuthenticate(body, host);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidDeauthenticate(body: Value, host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDeauthenticate !== void 0) {\n        observer.didDeauthenticate(body, host, this);\n      }\n    }\n    const refs = this.refs;\n    for (let i = 0, n = refs.length; i < n; i += 1) {\n      const ref = refs[i]!;\n      if (ref.hostUri.equals(host.hostUri)) {\n        ref.hostDidDeauthenticate(body, host);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidDisconnect(host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didDisconnect !== void 0) {\n        observer.didDisconnect(host, this);\n      }\n    }\n    const refs = this.refs;\n    for (let i = 0, n = refs.length; i < n; i += 1) {\n      const ref = refs[i]!;\n      if (ref.hostUri.equals(host.hostUri)) {\n        ref.hostDidDisconnect(host);\n      }\n    }\n  }\n\n  /** @internal */\n  hostDidFail(error: unknown, host: Host): void {\n    const observers = this.observers;\n    for (let i = 0, n = observers.length; i < n; i += 1) {\n      const observer = observers[i]!;\n      if (observer.didFail !== void 0) {\n        observer.didFail(error, host, this);\n      }\n    }\n    const refs = this.refs;\n    for (let i = 0, n = refs.length; i < n; i += 1) {\n      const ref = refs[i]!;\n      if (ref.hostUri.equals(host.hostUri)) {\n        ref.hostDidFail(error, host);\n      }\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {WarpClient} from \"./WarpClient\";\n\n/** @public */\nexport const client: WarpClient = new WarpClient();\n/** @public */\nexport const isOnline: typeof client.isOnline = client.isOnline.bind(client);\n/** @public */\nexport const keepOnline: typeof client.keepOnline = client.keepOnline.bind(client);\n/** @public */\nexport const downlink: typeof client.downlink = client.downlink.bind(client);\n/** @public */\nexport const downlinkList: typeof client.downlinkList = client.downlinkList.bind(client);\n/** @public */\nexport const downlinkMap: typeof client.downlinkMap = client.downlinkMap.bind(client);\n/** @public */\nexport const downlinkValue: typeof client.downlinkValue = client.downlinkValue.bind(client);\n/** @public */\nexport const hostRef: typeof client.hostRef = client.hostRef.bind(client);\n/** @public */\nexport const nodeRef: typeof client.nodeRef = client.nodeRef.bind(client);\n/** @public */\nexport const laneRef: typeof client.laneRef = client.laneRef.bind(client);\n/** @public */\nexport const authenticate: typeof client.authenticate = client.authenticate.bind(client);\n/** @public */\nexport const command: typeof client.command = client.command.bind(client);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Class, Lazy, Service} from \"@swim/util\";\nimport type {WarpClient} from \"../client/WarpClient\";\nimport {client} from \"../client/global\";\nimport type {WarpServiceObserver} from \"./WarpServiceObserver\";\n\n/** @public */\nexport class WarpService<O> extends Service<O> {\n  constructor(client: WarpClient) {\n    super();\n    this.client = client;\n  }\n\n  override readonly observerType?: Class<WarpServiceObserver<O>>;\n\n  readonly client: WarpClient;\n\n  @Lazy\n  static global<O>(): WarpService<O> {\n    return new WarpService(client);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {ProviderClass, Provider} from \"@swim/fastener\";\nimport type {WarpClient} from \"../client/WarpClient\";\nimport {WarpService} from \"./WarpService\";\n\n/** @public */\nexport interface WarpProvider<O, S extends WarpService<O> | null | undefined = WarpService<O>> extends Provider<O, S> {\n  get client(): WarpClient\n\n  createService(): S;\n}\n\n/** @public */\nexport const WarpProvider = (function (_super: typeof Provider) {\n  const WarpProvider = _super.extend(\"WarpProvider\") as ProviderClass<WarpProvider<any, any>>;\n\n  Object.defineProperty(WarpProvider.prototype, \"client\", {\n    get<O, S extends WarpService<O> | null | undefined>(this: WarpProvider<O, S>): WarpClient {\n      let service: WarpService<O> | null | undefined = this.service;\n      if (service === void 0 || service === null) {\n        service = WarpService.global();\n      }\n      return service.client;\n    },\n    configurable: true,\n  });\n\n  WarpProvider.prototype.createService = function <O, S extends WarpService<O> | null | undefined>(this: WarpProvider<O, S>): S {\n    return WarpService.global() as S;\n  };\n\n  return WarpProvider;\n})(Provider);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Class, Equals, Arrays, ConsumerType, Consumable, Consumer} from \"@swim/util\";\nimport {FastenerOwner, FastenerFlags, FastenerInit, FastenerClass, Fastener} from \"@swim/fastener\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport type {DownlinkObserver, Downlink} from \"../downlink/Downlink\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport type {DownlinkFastenerContext} from \"./DownlinkFastenerContext\";\n\n/** @beta */\nexport interface DownlinkFastenerInit extends FastenerInit, DownlinkObserver {\n  extends?: {prototype: DownlinkFastener<any>} | string | boolean | null;\n  consumed?: boolean;\n\n  hostUri?: AnyUri | (() => AnyUri | null);\n  nodeUri?: AnyUri | (() => AnyUri | null);\n  laneUri?: AnyUri | (() => AnyUri | null);\n  prio?: number | (() => number | undefined);\n  rate?: number | (() => number | undefined);\n  body?: AnyValue | (() => AnyValue | null);\n\n  willConsume?(conssumer: unknown): void;\n  didConsume?(conssumer: unknown): void;\n  willUnconsume?(conssumer: unknown): void;\n  didUnconsume?(conssumer: unknown): void;\n  willStartConsuming?(): void;\n  didStartConsuming?(): void;\n  willStopConsuming?(): void;\n  didStopConsuming?(): void;\n\n  initDownlink?(downlink: Downlink): Downlink;\n}\n\n/** @beta */\nexport type DownlinkFastenerDescriptor<O = unknown, I = {}> = ThisType<DownlinkFastener<O> & I> & DownlinkFastenerInit & Partial<I>;\n\n/** @beta */\nexport interface DownlinkFastenerClass<F extends DownlinkFastener<any> = DownlinkFastener<any>> extends FastenerClass<F> {\n  /** @internal */\n  readonly ConsumingFlag: FastenerFlags;\n  /** @internal */\n  readonly PendingFlag: FastenerFlags;\n  /** @internal */\n  readonly RelinkMask: FastenerFlags;\n\n  /** @internal @override */\n  readonly FlagShift: number;\n  /** @internal @override */\n  readonly FlagMask: FastenerFlags;\n}\n\n/** @beta */\nexport interface DownlinkFastenerFactory<F extends DownlinkFastener<any> = DownlinkFastener<any>> extends DownlinkFastenerClass<F> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): DownlinkFastenerFactory<F> & I;\n\n  define<O>(className: string, descriptor: DownlinkFastenerDescriptor<O>): DownlinkFastenerFactory<DownlinkFastener<any>>;\n  define<O, I = {}>(className: string, descriptor: DownlinkFastenerDescriptor<O, I>): DownlinkFastenerFactory<DownlinkFastener<any> & I>;\n\n  <O>(descriptor: DownlinkFastenerDescriptor<O>): PropertyDecorator;\n  <O, I = {}>(descriptor: DownlinkFastenerDescriptor<O, I>): PropertyDecorator;\n}\n\n/** @beta */\nexport interface DownlinkFastener<O = unknown> extends Fastener<O>, Consumable {\n  /** @override */\n  get familyType(): Class<DownlinkFastener<any>> | null;\n\n  /** @override */\n  readonly consumerType?: Class<Consumer>;\n\n  /** @protected @override */\n  onInherit(superFastener: Fastener): void;\n\n  /** @internal */\n  readonly ownHostUri: Uri | null;\n\n  hostUri(): Uri | null;\n  hostUri(hostUri: AnyUri | null): this;\n\n  /** @internal */\n  readonly ownNodeUri: Uri | null;\n\n  nodeUri(): Uri | null;\n  nodeUri(nodeUri: AnyUri | null): this;\n\n  /** @internal */\n  readonly ownLaneUri: Uri | null;\n\n  laneUri(): Uri | null;\n  laneUri(laneUri: AnyUri | null): this;\n\n  /** @internal */\n  readonly ownPrio: number | undefined;\n\n  prio(): number | undefined;\n  prio(prio: number | undefined): this;\n\n  /** @internal */\n  readonly ownRate: number | undefined;\n\n  rate(): number | undefined;\n  rate(rate: number | undefined): this;\n\n  /** @internal */\n  readonly ownBody: Value | null;\n\n  body(): Value | null;\n  body(body: AnyValue | null): this;\n\n  /** @internal */\n  readonly ownWarp: WarpRef | null;\n\n  warp(): WarpRef | null;\n  warp(warp: WarpRef | null): this;\n\n  readonly downlink: Downlink | null;\n\n  /** @internal */\n  link(): void;\n\n  /** @internal */\n  unlink(): void;\n\n  /** @internal */\n  relink(): void;\n\n  /** @internal @abstract */\n  createDownlink(warp: WarpRef): Downlink;\n\n  /** @internal */\n  bindDownlink(downlink: Downlink): Downlink;\n\n  /** @override */\n  recohere(t: number): void;\n\n  /** @internal */\n  readonly consumers: ReadonlyArray<ConsumerType<this>>;\n\n  /** @override */\n  consume(consumer: ConsumerType<this>): void\n\n  /** @protected */\n  willConsume(consumer: ConsumerType<this>): void;\n\n  /** @protected */\n  onConsume(consumer: ConsumerType<this>): void;\n\n  /** @protected */\n  didConsume(consumer: ConsumerType<this>): void;\n\n  /** @override */\n  unconsume(consumer: ConsumerType<this>): void\n\n  /** @protected */\n  willUnconsume(consumer: ConsumerType<this>): void;\n\n  /** @protected */\n  onUnconsume(consumer: ConsumerType<this>): void;\n\n  /** @protected */\n  didUnconsume(consumer: ConsumerType<this>): void;\n\n  get consuming(): boolean;\n\n  /** @internal */\n  startConsuming(): void;\n\n  /** @protected */\n  willStartConsuming(): void;\n\n  /** @protected */\n  onStartConsuming(): void;\n\n  /** @protected */\n  didStartConsuming(): void;\n\n  /** @internal */\n  stopConsuming(): void;\n\n  /** @protected */\n  willStopConsuming(): void;\n\n  /** @protected */\n  onStopConsuming(): void;\n\n  /** @protected */\n  didStopConsuming(): void;\n\n  /** @protected @override */\n  onMount(): void;\n\n  /** @protected @override */\n  onUnmount(): void;\n\n  /** @internal */\n  initDownlink?(downlink: Downlink): Downlink;\n\n  /** @internal */\n  initHostUri?(): AnyUri | null;\n\n  /** @internal */\n  initNodeUri?(): AnyUri | null;\n\n  /** @internal */\n  initLaneUri?(): AnyUri | null;\n\n  /** @internal */\n  initPrio?(): number | undefined;\n\n  /** @internal */\n  initRate?(): number | undefined;\n\n  /** @internal */\n  initBody?(): AnyValue | null;\n\n  /** @internal @protected */\n  get consumed(): boolean | undefined; // optional prototype property\n\n  /** @internal @override */\n  get lazy(): boolean; // prototype property\n\n  /** @internal @override */\n  get static(): string | boolean; // prototype property\n}\n\n/** @beta */\nexport const DownlinkFastener = (function (_super: typeof Fastener) {\n  const DownlinkFastener: DownlinkFastenerFactory = _super.extend(\"DownlinkFastener\");\n\n  Object.defineProperty(DownlinkFastener.prototype, \"familyType\", {\n    get: function (this: DownlinkFastener): Class<DownlinkFastener<any>> | null {\n      return DownlinkFastener;\n    },\n    configurable: true,\n  });\n\n  DownlinkFastener.prototype.onInherit = function (this: DownlinkFastener, superFastener: DownlinkFastener): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.hostUri = function (this: DownlinkFastener<unknown>, hostUri?: AnyUri | null): Uri | null | typeof this {\n    if (hostUri === void 0) {\n      if (this.ownHostUri !== null) {\n        return this.ownHostUri;\n      } else {\n        hostUri = this.initHostUri !== void 0 ? this.initHostUri() : null;\n        if (hostUri !== null) {\n          hostUri = Uri.fromAny(hostUri);\n          (this as Mutable<typeof this>).ownHostUri = hostUri as Uri;\n        }\n        return hostUri as Uri | null;\n      }\n    } else {\n      if (hostUri !== null) {\n        hostUri = Uri.fromAny(hostUri);\n      }\n      if (!Equals(this.ownHostUri, hostUri)) {\n        (this as Mutable<typeof this>).ownHostUri = hostUri as Uri | null;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.hostUri;\n\n  DownlinkFastener.prototype.nodeUri = function (this: DownlinkFastener<unknown>, nodeUri?: AnyUri | null): Uri | null | typeof this {\n    if (nodeUri === void 0) {\n      if (this.ownNodeUri !== null) {\n        return this.ownNodeUri;\n      } else {\n        nodeUri = this.initNodeUri !== void 0 ? this.initNodeUri() : null;\n        if (nodeUri !== null) {\n          nodeUri = Uri.fromAny(nodeUri);\n          (this as Mutable<typeof this>).ownNodeUri = nodeUri as Uri;\n        }\n        return nodeUri as Uri | null;\n      }\n    } else {\n      if (nodeUri !== null) {\n        nodeUri = Uri.fromAny(nodeUri);\n      }\n      if (!Equals(this.ownNodeUri, nodeUri)) {\n        (this as Mutable<typeof this>).ownNodeUri = nodeUri as Uri | null;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.nodeUri;\n\n  DownlinkFastener.prototype.laneUri = function (this: DownlinkFastener<unknown>, laneUri?: AnyUri | null): Uri | null | typeof this {\n    if (laneUri === void 0) {\n      if (this.ownLaneUri !== null) {\n        return this.ownLaneUri;\n      } else {\n        laneUri = this.initLaneUri !== void 0 ? this.initLaneUri() : null;\n        if (laneUri !== null) {\n          laneUri = Uri.fromAny(laneUri);\n          (this as Mutable<typeof this>).ownLaneUri = laneUri as Uri;\n        }\n        return laneUri as Uri | null;\n      }\n    } else {\n      if (laneUri !== null) {\n        laneUri = Uri.fromAny(laneUri);\n      }\n      if (!Equals(this.ownLaneUri, laneUri)) {\n        (this as Mutable<typeof this>).ownLaneUri = laneUri as Uri | null;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.laneUri;\n\n  DownlinkFastener.prototype.prio = function (this: DownlinkFastener<unknown>, prio?: number | undefined): number | undefined | typeof this {\n    if (arguments.length === 0) {\n      if (this.ownPrio !== void 0) {\n        return this.ownPrio;\n      } else {\n        prio = this.initPrio !== void 0 ? this.initPrio() : void 0;\n        if (prio !== void 0) {\n          (this as Mutable<typeof this>).ownPrio = prio;\n        }\n        return prio;\n      }\n    } else {\n      if (this.ownPrio !== prio) {\n        (this as Mutable<typeof this>).ownPrio = prio;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.prio;\n\n  DownlinkFastener.prototype.rate = function (this: DownlinkFastener<unknown>, rate?: number | undefined): number | undefined | typeof this {\n    if (arguments.length === 0) {\n      if (this.ownRate !== void 0) {\n        return this.ownRate;\n      } else {\n        rate = this.initRate !== void 0 ? this.initRate() : void 0;\n        if (rate !== void 0) {\n          (this as Mutable<typeof this>).ownRate = rate;\n        }\n        return rate;\n      }\n    } else {\n      if (this.ownRate !== rate) {\n        (this as Mutable<typeof this>).ownRate = rate;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.rate;\n\n  DownlinkFastener.prototype.body = function (this: DownlinkFastener<unknown>, body?: AnyValue | null): Value | null | typeof this {\n    if (body === void 0) {\n      if (this.ownBody !== null) {\n        return this.ownBody;\n      } else {\n        body = this.initBody !== void 0 ? this.initBody() : null;\n        if (body !== null) {\n          body = Value.fromAny(body);\n          (this as Mutable<typeof this>).ownBody = body;\n        }\n        return body;\n      }\n    } else {\n      if (body !== null) {\n        body = Value.fromAny(body);\n      }\n      if (!Equals(this.ownBody, body)) {\n        (this as Mutable<typeof this>).ownBody = body;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.body;\n\n  DownlinkFastener.prototype.warp = function (this: DownlinkFastener<unknown>, warp?: WarpRef | null): WarpRef | null | typeof this {\n    if (warp === void 0) {\n      return this.ownWarp;\n    } else {\n      if (this.ownWarp !== warp) {\n        (this as Mutable<typeof this>).ownWarp = warp;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof DownlinkFastener.prototype.warp;\n\n  DownlinkFastener.prototype.link = function (this: DownlinkFastener<DownlinkFastenerContext>): void {\n    if (this.downlink === null) {\n      let warp = this.ownWarp;\n      if (warp === null) {\n        warp = this.owner.warpRef.state;\n      }\n      if (warp === null) {\n        warp = this.owner.warpProvider.service.client;\n      }\n      let downlink = this.createDownlink(warp);\n      downlink = this.bindDownlink(downlink);\n      if (this.initDownlink !== void 0) {\n        downlink = this.initDownlink(downlink);\n      }\n      downlink = downlink.observe(this as DownlinkObserver);\n      (this as Mutable<typeof this>).downlink = downlink.open();\n      this.setFlags(this.flags & ~DownlinkFastener.PendingFlag);\n    }\n  };\n\n  DownlinkFastener.prototype.unlink = function (this: DownlinkFastener<unknown>): void {\n    const downlink = this.downlink;\n    if (downlink !== null) {\n      downlink.close();\n      (this as Mutable<typeof this>).downlink = null;\n      this.setFlags(this.flags | DownlinkFastener.PendingFlag);\n    }\n  };\n\n  DownlinkFastener.prototype.relink = function (this: DownlinkFastener<unknown>): void {\n    this.setFlags(this.flags | DownlinkFastener.PendingFlag);\n    if ((this.flags & DownlinkFastener.ConsumingFlag) !== 0) {\n      this.setCoherent(false);\n      this.decohere();\n    }\n  };\n\n  DownlinkFastener.prototype.bindDownlink = function (this: DownlinkFastener<unknown>, downlink: Downlink): Downlink {\n    const hostUri = this.hostUri();\n    if (hostUri !== null) {\n      downlink = downlink.hostUri(hostUri);\n    }\n    const nodeUri = this.nodeUri();\n    if (nodeUri !== null) {\n      downlink = downlink.nodeUri(nodeUri);\n    }\n    const laneUri = this.laneUri();\n    if (laneUri !== null) {\n      downlink = downlink.laneUri(laneUri);\n    }\n    const prio = this.prio();\n    if (prio !== void 0) {\n      downlink = downlink.prio(prio);\n    }\n    const rate = this.rate();\n    if (rate !== void 0) {\n      downlink = downlink.rate(rate);\n    }\n    const body = this.body();\n    if (body !== null) {\n      downlink = downlink.body(body);\n    }\n    return downlink;\n  };\n\n  DownlinkFastener.prototype.recohere = function (this: DownlinkFastener<unknown>, t: number): void {\n    this.setCoherent(true);\n    if (this.downlink !== null && (this.flags & DownlinkFastener.RelinkMask) === DownlinkFastener.RelinkMask) {\n      this.unlink();\n      this.link();\n    } else if (this.downlink === null && (this.flags & DownlinkFastener.ConsumingFlag) !== 0) {\n      this.link();\n    } else if (this.downlink !== null && (this.flags & DownlinkFastener.ConsumingFlag) === 0) {\n      this.unlink();\n    }\n  };\n\n  DownlinkFastener.prototype.consume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    const oldConsumers = this.consumers;\n    const newConsumerrss = Arrays.inserted(downlinkConsumer, oldConsumers);\n    if (oldConsumers !== newConsumerrss) {\n      this.willConsume(downlinkConsumer);\n      (this as Mutable<typeof this>).consumers = newConsumerrss;\n      this.onConsume(downlinkConsumer);\n      this.didConsume(downlinkConsumer);\n      if (oldConsumers.length === 0) {\n        this.startConsuming();\n      }\n    }\n  };\n\n  DownlinkFastener.prototype.willConsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    // hook\n  }\n\n  DownlinkFastener.prototype.onConsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.didConsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.unconsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    const oldConsumers = this.consumers;\n    const newConsumerrss = Arrays.removed(downlinkConsumer, oldConsumers);\n    if (oldConsumers !== newConsumerrss) {\n      this.willUnconsume(downlinkConsumer);\n      (this as Mutable<typeof this>).consumers = newConsumerrss;\n      this.onUnconsume(downlinkConsumer);\n      this.didUnconsume(downlinkConsumer);\n      if (newConsumerrss.length === 0) {\n        this.stopConsuming();\n      }\n    }\n  };\n\n  DownlinkFastener.prototype.willUnconsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.onUnconsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.didUnconsume = function (this: DownlinkFastener<unknown>, downlinkConsumer: ConsumerType<typeof this>): void {\n    // hook\n  };\n\n  Object.defineProperty(DownlinkFastener.prototype, \"consuming\", {\n    get(this: DownlinkFastener<unknown>): boolean {\n      return (this.flags & DownlinkFastener.ConsumingFlag) !== 0;\n    },\n    configurable: true,\n  })\n\n  DownlinkFastener.prototype.startConsuming = function (this: DownlinkFastener<unknown>): void {\n    if ((this.flags & DownlinkFastener.ConsumingFlag) === 0) {\n      this.willStartConsuming();\n      this.setFlags(this.flags | DownlinkFastener.ConsumingFlag);\n      this.onStartConsuming();\n      this.didStartConsuming();\n    }\n  };\n\n  DownlinkFastener.prototype.willStartConsuming = function (this: DownlinkFastener<unknown>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.onStartConsuming = function (this: DownlinkFastener<unknown>): void {\n    this.setCoherent(false);\n    this.decohere();\n  };\n\n  DownlinkFastener.prototype.didStartConsuming = function (this: DownlinkFastener<unknown>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.stopConsuming = function (this: DownlinkFastener<unknown>): void {\n    if ((this.flags & DownlinkFastener.ConsumingFlag) !== 0) {\n      this.willStopConsuming();\n      this.setFlags(this.flags & ~DownlinkFastener.ConsumingFlag);\n      this.onStopConsuming();\n      this.didStopConsuming();\n    }\n  };\n\n  DownlinkFastener.prototype.willStopConsuming = function (this: DownlinkFastener<unknown>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.onStopConsuming = function (this: DownlinkFastener<unknown>): void {\n    this.setCoherent(false);\n    this.decohere();\n  };\n\n  DownlinkFastener.prototype.didStopConsuming = function (this: DownlinkFastener<unknown>): void {\n    // hook\n  };\n\n  DownlinkFastener.prototype.onMount = function (this: DownlinkFastener<unknown>): void {\n    _super.prototype.onMount.call(this);\n    if ((this.flags & DownlinkFastener.ConsumingFlag) !== 0) {\n      this.setCoherent(false);\n      this.decohere();\n    }\n  };\n\n  DownlinkFastener.prototype.onUnmount = function (this: DownlinkFastener<unknown>): void {\n    _super.prototype.onUnmount.call(this);\n    this.unlink();\n  };\n\n  Object.defineProperty(DownlinkFastener.prototype, \"lazy\", {\n    get: function (this: DownlinkFastener): boolean {\n      return false;\n    },\n    configurable: true,\n  });\n\n  Object.defineProperty(DownlinkFastener.prototype, \"static\", {\n    get: function (this: DownlinkFastener): string | boolean {\n      return true;\n    },\n    configurable: true,\n  });\n\n  DownlinkFastener.construct = function <F extends DownlinkFastener<any>>(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F {\n    fastener = _super.construct(fastenerClass, fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).ownHostUri = null;\n    (fastener as Mutable<typeof fastener>).ownNodeUri = null;\n    (fastener as Mutable<typeof fastener>).ownLaneUri = null;\n    (fastener as Mutable<typeof fastener>).ownPrio = void 0;\n    (fastener as Mutable<typeof fastener>).ownRate = void 0;\n    (fastener as Mutable<typeof fastener>).ownBody = null;\n    (fastener as Mutable<typeof fastener>).ownWarp = null;\n    (fastener as Mutable<typeof fastener>).downlink = null;\n    (fastener as Mutable<typeof fastener>).consumers = Arrays.empty;\n    return fastener;\n  };\n\n  DownlinkFastener.define = function <O>(className: string, descriptor: DownlinkFastenerDescriptor<O>): DownlinkFastenerFactory<DownlinkFastener<any>> {\n    let superClass = descriptor.extends as DownlinkFastenerFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    let hostUri = descriptor.hostUri;\n    let nodeUri = descriptor.nodeUri;\n    let laneUri = descriptor.laneUri;\n    let prio = descriptor.prio;\n    let rate = descriptor.rate;\n    let body = descriptor.body;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.hostUri;\n    delete descriptor.nodeUri;\n    delete descriptor.laneUri;\n    delete descriptor.prio;\n    delete descriptor.rate;\n    delete descriptor.body;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const fastenerClass = superClass.extend(className, descriptor);\n\n    fastenerClass.construct = function (fastenerClass: {prototype: DownlinkFastener<any>}, fastener: DownlinkFastener<O> | null, owner: O): DownlinkFastener<O> {\n      fastener = superClass!.construct(fastenerClass, fastener, owner);\n      if (affinity !== void 0) {\n        fastener.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        fastener.initInherits(inherits);\n      }\n      if (hostUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownHostUri = hostUri as Uri;\n      }\n      if (nodeUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownNodeUri = nodeUri as Uri;\n      }\n      if (laneUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownLaneUri = laneUri as Uri;\n      }\n      if (prio !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownPrio = prio as number;\n      }\n      if (rate !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownRate = rate as number;\n      }\n      if (body !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownBody = body as Value;\n      }\n      return fastener;\n    };\n\n    if (typeof hostUri === \"function\") {\n      fastenerClass.prototype.initHostUri = hostUri;\n      hostUri = void 0;\n    } else if (hostUri !== void 0) {\n      hostUri = Uri.fromAny(hostUri);\n    }\n    if (typeof nodeUri === \"function\") {\n      fastenerClass.prototype.initNodeUri = nodeUri;\n      nodeUri = void 0;\n    } else if (nodeUri !== void 0) {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    if (typeof laneUri === \"function\") {\n      fastenerClass.prototype.initLaneUri = laneUri;\n      laneUri = void 0;\n    } else if (laneUri !== void 0) {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    if (typeof prio === \"function\") {\n      fastenerClass.prototype.initPrio = prio;\n      prio = void 0;\n    }\n    if (typeof rate === \"function\") {\n      fastenerClass.prototype.initRate = rate;\n      rate = void 0;\n    }\n    if (typeof body === \"function\") {\n      fastenerClass.prototype.initBody = body;\n      body = void 0;\n    } else if (body !== void 0) {\n      body = Value.fromAny(body);\n    }\n\n    return fastenerClass;\n  };\n\n  (DownlinkFastener as Mutable<typeof DownlinkFastener>).ConsumingFlag = 1 << (_super.FlagShift + 0);\n  (DownlinkFastener as Mutable<typeof DownlinkFastener>).PendingFlag = 1 << (_super.FlagShift + 1);\n  (DownlinkFastener as Mutable<typeof DownlinkFastener>).RelinkMask = DownlinkFastener.ConsumingFlag | DownlinkFastener.PendingFlag;\n\n  (DownlinkFastener as Mutable<typeof DownlinkFastener>).FlagShift = _super.FlagShift + 2;\n  (DownlinkFastener as Mutable<typeof DownlinkFastener>).FlagMask = (1 << DownlinkFastener.FlagShift) - 1;\n\n  return DownlinkFastener;\n})(Fastener);\n\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {FastenerOwner} from \"@swim/fastener\";\nimport {Value} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport type {DownlinkObserver} from \"../downlink/Downlink\";\nimport type {EventDownlink} from \"../downlink/EventDownlink\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport {DownlinkFastenerInit, DownlinkFastenerClass, DownlinkFastener} from \"./DownlinkFastener\";\n\n/** @beta */\nexport interface EventDownlinkFastenerInit extends DownlinkFastenerInit, DownlinkObserver {\n  extends?: {prototype: EventDownlinkFastener<any>} | string | boolean | null;\n\n  initDownlink?(downlink: EventDownlink): EventDownlink;\n}\n\n/** @beta */\nexport type EventDownlinkFastenerDescriptor<O = unknown, I = {}> = ThisType<EventDownlinkFastener<O> & I> & EventDownlinkFastenerInit & Partial<I>;\n\n/** @beta */\nexport interface EventDownlinkFastenerClass<F extends EventDownlinkFastener<any> = EventDownlinkFastener<any>> extends DownlinkFastenerClass<F> {\n}\n\n/** @beta */\nexport interface EventDownlinkFastenerFactory<F extends EventDownlinkFastener<any> = EventDownlinkFastener<any>> extends EventDownlinkFastenerClass<F> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): EventDownlinkFastenerFactory<F> & I;\n\n  define<O>(className: string, descriptor: EventDownlinkFastenerDescriptor<O>): EventDownlinkFastenerFactory<EventDownlinkFastener<any>>;\n  define<O, I = {}>(className: string, descriptor: EventDownlinkFastenerDescriptor<O, I>): EventDownlinkFastenerFactory<EventDownlinkFastener<any> & I>;\n\n  <O>(descriptor: EventDownlinkFastenerDescriptor<O>): PropertyDecorator;\n  <O, I = {}>(descriptor: EventDownlinkFastenerDescriptor<O, I>): PropertyDecorator;\n}\n\n/** @beta */\nexport interface EventDownlinkFastener<O = unknown> extends DownlinkFastener<O> {\n  /** @override */\n  readonly downlink: EventDownlink | null;\n\n  /** @internal @override */\n  createDownlink(warp: WarpRef): EventDownlink;\n\n  /** @internal @override */\n  bindDownlink(downlink: EventDownlink): EventDownlink;\n\n  /** @internal */\n  initDownlink?(downlink: EventDownlink): EventDownlink;\n}\n\n/** @beta */\nexport const EventDownlinkFastener = (function (_super: typeof DownlinkFastener) {\n  const EventDownlinkFastener: EventDownlinkFastenerFactory = _super.extend(\"EventDownlinkFastener\");\n\n  EventDownlinkFastener.prototype.createDownlink = function <V, VU>(this: EventDownlinkFastener<unknown>, warp: WarpRef): EventDownlink {\n    return warp.downlink();\n  };\n\n  EventDownlinkFastener.construct = function <F extends EventDownlinkFastener<any>>(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F {\n    fastener = _super.construct(fastenerClass, fastener, owner) as F;\n    return fastener;\n  };\n\n  EventDownlinkFastener.define = function <O>(className: string, descriptor: EventDownlinkFastenerDescriptor<O>): EventDownlinkFastenerFactory<EventDownlinkFastener<any>> {\n    let superClass = descriptor.extends as EventDownlinkFastenerFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    let hostUri = descriptor.hostUri;\n    let nodeUri = descriptor.nodeUri;\n    let laneUri = descriptor.laneUri;\n    let prio = descriptor.prio;\n    let rate = descriptor.rate;\n    let body = descriptor.body;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.hostUri;\n    delete descriptor.nodeUri;\n    delete descriptor.laneUri;\n    delete descriptor.prio;\n    delete descriptor.rate;\n    delete descriptor.body;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const fastenerClass = superClass.extend(className, descriptor);\n\n    fastenerClass.construct = function (fastenerClass: {prototype: EventDownlinkFastener<any>}, fastener: EventDownlinkFastener<O> | null, owner: O): EventDownlinkFastener<O> {\n      fastener = superClass!.construct(fastenerClass, fastener, owner);\n      if (affinity !== void 0) {\n        fastener.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        fastener.initInherits(inherits);\n      }\n      if (hostUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownHostUri = hostUri as Uri;\n      }\n      if (nodeUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownNodeUri = nodeUri as Uri;\n      }\n      if (laneUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownLaneUri = laneUri as Uri;\n      }\n      if (prio !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownPrio = prio as number;\n      }\n      if (rate !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownRate = rate as number;\n      }\n      if (body !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownBody = body as Value;\n      }\n      return fastener;\n    };\n\n    if (typeof hostUri === \"function\") {\n      fastenerClass.prototype.initHostUri = hostUri;\n      hostUri = void 0;\n    } else if (hostUri !== void 0) {\n      hostUri = Uri.fromAny(hostUri);\n    }\n    if (typeof nodeUri === \"function\") {\n      fastenerClass.prototype.initNodeUri = nodeUri;\n      nodeUri = void 0;\n    } else if (nodeUri !== void 0) {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    if (typeof laneUri === \"function\") {\n      fastenerClass.prototype.initLaneUri = laneUri;\n      laneUri = void 0;\n    } else if (laneUri !== void 0) {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    if (typeof prio === \"function\") {\n      fastenerClass.prototype.initPrio = prio;\n      prio = void 0;\n    }\n    if (typeof rate === \"function\") {\n      fastenerClass.prototype.initRate = rate;\n      rate = void 0;\n    }\n    if (typeof body === \"function\") {\n      fastenerClass.prototype.initBody = body;\n      body = void 0;\n    } else if (body !== void 0) {\n      body = Value.fromAny(body);\n    }\n\n    return fastenerClass;\n  };\n\n  return EventDownlinkFastener;\n})(DownlinkFastener);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Cursor} from \"@swim/util\";\nimport type {FastenerOwner} from \"@swim/fastener\";\nimport {AnyValue, Value, Form} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport type {ListDownlinkObserver, ListDownlink} from \"../downlink/ListDownlink\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport {DownlinkFastenerInit, DownlinkFastenerClass, DownlinkFastener} from \"./DownlinkFastener\";\n\n/** @internal */\nexport type ListDownlinkFastenerType<F extends ListDownlinkFastener<any, any>> =\n  F extends ListDownlinkFastener<any, infer V, any> ? V : never;\n\n/** @internal */\nexport type ListDownlinkFastenerInitType<F extends ListDownlinkFastener<any, any>> =\n  F extends ListDownlinkFastener<any, infer V, infer VU> ? V | VU : never;\n\n/** @beta */\nexport interface ListDownlinkFastenerInit<V = unknown, VU = V> extends DownlinkFastenerInit, ListDownlinkObserver<V, VU> {\n  extends?: {prototype: ListDownlinkFastener<any, any>} | string | boolean | null;\n  valueForm?: Form<V, VU>;\n\n  initDownlink?(downlink: ListDownlink<V, VU>): ListDownlink<V, VU>;\n}\n\n/** @beta */\nexport type ListDownlinkFastenerDescriptor<O = unknown, V = unknown, VU = V, I = {}> = ThisType<ListDownlinkFastener<O, V, VU> & I> & ListDownlinkFastenerInit<V, VU> & Partial<I>;\n\n/** @beta */\nexport interface ListDownlinkFastenerClass<F extends ListDownlinkFastener<any, any> = ListDownlinkFastener<any, any>> extends DownlinkFastenerClass<F> {\n}\n\n/** @beta */\nexport interface ListDownlinkFastenerFactory<F extends ListDownlinkFastener<any, any> = ListDownlinkFastener<any, any>> extends ListDownlinkFastenerClass<F> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): ListDownlinkFastenerFactory<F> & I;\n\n  define<O, V extends Value = Value, VU extends AnyValue = AnyValue>(className: string, descriptor: ListDownlinkFastenerDescriptor<O, V, VU>): ListDownlinkFastenerFactory<ListDownlinkFastener<any, V, VU>>;\n  define<O, V, VU = V>(className: string, descriptor: {valueForm: Form<V, VU>} & ListDownlinkFastenerDescriptor<O, V, VU>): ListDownlinkFastenerFactory<ListDownlinkFastener<any, V, VU>>;\n  define<O, V extends Value, VU extends AnyValue = AnyValue, I = {}>(className: string, descriptor: ListDownlinkFastenerDescriptor<O, V, VU, I>): ListDownlinkFastenerFactory<ListDownlinkFastener<any, V, VU> & I>;\n  define<O, V, VU = V, I = {}>(className: string, descriptor: {valueForm: Form<V, VU>} & ListDownlinkFastenerDescriptor<O, V, VU, I>): ListDownlinkFastenerFactory<ListDownlinkFastener<any, V, VU> & I>;\n\n  <O, V extends Value = Value, VU extends AnyValue = AnyValue>(descriptor: ListDownlinkFastenerDescriptor<O, V, VU>): PropertyDecorator;\n  <O, V, VU = V>(descriptor: {valueForm: Form<V, VU>} & ListDownlinkFastenerDescriptor<O, V, VU>): PropertyDecorator;\n  <O, V extends Value, VU extends AnyValue = AnyValue, I = {}>(descriptor: ListDownlinkFastenerDescriptor<O, V, VU, I>): PropertyDecorator;\n  <O, V, VU = V, I = {}>(descriptor: {valueForm: Form<V, VU>} & ListDownlinkFastenerDescriptor<O, V, VU, I>): PropertyDecorator;\n}\n\n/** @beta */\nexport interface ListDownlinkFastener<O = unknown, V = unknown, VU = V> extends DownlinkFastener<O> {\n  (index: number): V | undefined;\n  (index: number, newObject: V | VU): O;\n\n  /** @internal */\n  readonly ownValueForm: Form<V, VU> | null;\n\n  get length(): number;\n\n  valueForm(): Form<V, VU> | null;\n  valueForm(valueForm: Form<V, VU> | null): this;\n\n  isEmpty(): boolean;\n\n  get(index: number, id?: Value): V | undefined;\n\n  getEntry(index: number, id?: Value): [V, Value] | undefined;\n\n  set(index: number, newObject: V | VU, id?: Value): this;\n\n  insert(index: number, newObject: V | VU, id?: Value): this;\n\n  remove(index: number, id?: Value): this;\n\n  push(...newObjects: (V | VU)[]): number;\n\n  pop(): V | undefined;\n\n  unshift(...newObjects: (V | VU)[]): number;\n\n  shift(): V | undefined;\n\n  move(fromIndex: number, toIndex: number, id?: Value): this;\n\n  splice(start: number, deleteCount?: number, ...newObjects: (V | VU)[]): V[];\n\n  clear(): void;\n\n  forEach<T>(callback: (value: V, index: number, id: Value) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, value: V, index: number, id: Value) => T | void, thisArg: S): T | undefined;\n\n  values(): Cursor<V>;\n\n  keys(): Cursor<Value>;\n\n  entries(): Cursor<[Value, V]>;\n\n  /** @override */\n  readonly downlink: ListDownlink<V, VU> | null;\n\n  /** @internal @override */\n  createDownlink(warp: WarpRef): ListDownlink<V, VU>;\n\n  /** @internal @override */\n  bindDownlink(downlink: ListDownlink<V, VU>): ListDownlink<V, VU>;\n\n  /** @internal */\n  initDownlink?(downlink: ListDownlink<V, VU>): ListDownlink<V, VU>;\n}\n\n/** @beta */\nexport const ListDownlinkFastener = (function (_super: typeof DownlinkFastener) {\n  const ListDownlinkFastener: ListDownlinkFastenerFactory = _super.extend(\"ListDownlinkFastener\");\n\n  ListDownlinkFastener.prototype.valueForm = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, valueForm?: Form<V, VU> | null): Form<V, VU> | null | typeof this {\n    if (valueForm === void 0) {\n      return this.ownValueForm;\n    } else {\n      if (this.ownValueForm !== valueForm) {\n        (this as Mutable<typeof this>).ownValueForm = valueForm;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof ListDownlinkFastener.prototype.valueForm;\n\n  Object.defineProperty(ListDownlinkFastener.prototype, \"length\", {\n    get: function (this: ListDownlinkFastener<unknown>): number {\n      const downlink = this.downlink;\n      return downlink !== null ? downlink.length : 0;\n    },\n    configurable: true,\n  });\n\n  ListDownlinkFastener.prototype.isEmpty = function (this: ListDownlinkFastener<unknown>): boolean {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.isEmpty() : true;\n  };\n\n  ListDownlinkFastener.prototype.get = function <V>(this: ListDownlinkFastener<unknown, V>, index: number, id?: Value): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.get(index, id) : void 0;\n  };\n\n  ListDownlinkFastener.prototype.getEntry = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, index: number, id?: Value): [V, Value] | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.getEntry(index, id) : void 0;\n  };\n\n  ListDownlinkFastener.prototype.set = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, index: number, newObject: V | VU, id?: Value): ListDownlinkFastener<unknown, V, VU> {\n    const downlink = this.downlink;\n    if (downlink != null) {\n      downlink.set(index, newObject, id);\n    }\n    return this;\n  };\n\n  ListDownlinkFastener.prototype.insert = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, index: number, newObject: V | VU, id?: Value): ListDownlinkFastener<unknown, V, VU> {\n    const downlink = this.downlink;\n    if (downlink != null) {\n      downlink.insert(index, newObject, id);\n    }\n    return this;\n  };\n\n  ListDownlinkFastener.prototype.remove = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, index: number, id?: Value): ListDownlinkFastener<unknown, V, VU> {\n    const downlink = this.downlink;\n    if (downlink != null) {\n      downlink.remove(index, id);\n    }\n    return this;\n  };\n\n  ListDownlinkFastener.prototype.push = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, ...newObjects: (V | VU)[]): number {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.push(...newObjects) : 0;\n  };\n\n  ListDownlinkFastener.prototype.pop = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.pop() : void 0;\n  };\n\n  ListDownlinkFastener.prototype.unshift = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, ...newObjects: (V | VU)[]): number {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.unshift(...newObjects) : 0;\n  };\n\n  ListDownlinkFastener.prototype.shift = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.shift() : void 0;\n  };\n\n  ListDownlinkFastener.prototype.move = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, fromIndex: number, toIndex: number, id?: Value): ListDownlinkFastener<unknown, V, VU> {\n    const downlink = this.downlink;\n    if (downlink != null) {\n      downlink.move(fromIndex, toIndex, id);\n    }\n    return this;\n  };\n\n  ListDownlinkFastener.prototype.splice = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, start: number, deleteCount?: number, ...newObjects: (V | VU)[]): V[] {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.splice(start, deleteCount, ...newObjects) : [];\n  };\n\n  ListDownlinkFastener.prototype.clear = function (this: ListDownlinkFastener<unknown>): void {\n    const downlink = this.downlink;\n    if (downlink != null) {\n      downlink.clear();\n    }\n  };\n\n  ListDownlinkFastener.prototype.forEach = function <V, VU, T, S>(this: ListDownlinkFastener<unknown, V, VU>, callback: (this: S | undefined, value: V, index: number, id: Value) => T | void, thisArg?: S): T | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.forEach(callback, thisArg) : void 0;\n  };\n\n  ListDownlinkFastener.prototype.values = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>): Cursor<V> {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.values() : Cursor.empty();\n  };\n\n  ListDownlinkFastener.prototype.keys = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>): Cursor<Value> {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.keys() : Cursor.empty();\n  };\n\n  ListDownlinkFastener.prototype.entries = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>): Cursor<[Value, V]> {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.entries() : Cursor.empty();\n  };\n\n  ListDownlinkFastener.prototype.createDownlink = function <V, VU>(this: ListDownlinkFastener<unknown, V, VU>, warp: WarpRef): ListDownlink<V, VU> {\n    let downlink = warp.downlinkList() as unknown as ListDownlink<V, VU>;\n    if (this.ownValueForm !== null) {\n      downlink = downlink.valueForm(this.ownValueForm);\n    }\n    return downlink;\n  };\n\n  ListDownlinkFastener.construct = function <F extends ListDownlinkFastener<any, any>>(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F {\n    if (fastener === null) {\n      fastener = function (index: number, value?: ListDownlinkFastenerType<F> | ListDownlinkFastenerInitType<F>): ListDownlinkFastenerType<F> | undefined | FastenerOwner<F> {\n        if (arguments.length === 0) {\n          return fastener!.get(index);\n        } else {\n          fastener!.set(index, value!);\n          return fastener!.owner;\n        }\n      } as F;\n      delete (fastener as Partial<Mutable<F>>).name; // don't clobber prototype name\n      Object.setPrototypeOf(fastener, fastenerClass.prototype);\n    }\n    fastener = _super.construct(fastenerClass, fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).ownValueForm = null;\n    return fastener;\n  };\n\n  ListDownlinkFastener.define = function <O, V, VU>(className: string, descriptor: ListDownlinkFastenerDescriptor<O, V, VU>): ListDownlinkFastenerFactory<ListDownlinkFastener<any, V, VU>> {\n    let superClass = descriptor.extends as ListDownlinkFastenerFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const valueForm = descriptor.valueForm;\n    let hostUri = descriptor.hostUri;\n    let nodeUri = descriptor.nodeUri;\n    let laneUri = descriptor.laneUri;\n    let prio = descriptor.prio;\n    let rate = descriptor.rate;\n    let body = descriptor.body;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.valueForm;\n    delete descriptor.hostUri;\n    delete descriptor.nodeUri;\n    delete descriptor.laneUri;\n    delete descriptor.prio;\n    delete descriptor.rate;\n    delete descriptor.body;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const fastenerClass = superClass.extend(className, descriptor);\n\n    fastenerClass.construct = function (fastenerClass: {prototype: ListDownlinkFastener<any, any>}, fastener: ListDownlinkFastener<O, V, VU> | null, owner: O): ListDownlinkFastener<O, V, VU> {\n      fastener = superClass!.construct(fastenerClass, fastener, owner);\n      if (affinity !== void 0) {\n        fastener.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        fastener.initInherits(inherits);\n      }\n      if (hostUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownHostUri = hostUri as Uri;\n      }\n      if (nodeUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownNodeUri = nodeUri as Uri;\n      }\n      if (laneUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownLaneUri = laneUri as Uri;\n      }\n      if (prio !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownPrio = prio as number;\n      }\n      if (rate !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownRate = rate as number;\n      }\n      if (body !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownBody = body as Value;\n      }\n      if (valueForm !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownValueForm = valueForm;\n      }\n      return fastener;\n    };\n\n    if (typeof hostUri === \"function\") {\n      fastenerClass.prototype.initHostUri = hostUri;\n      hostUri = void 0;\n    } else if (hostUri !== void 0) {\n      hostUri = Uri.fromAny(hostUri);\n    }\n    if (typeof nodeUri === \"function\") {\n      fastenerClass.prototype.initNodeUri = nodeUri;\n      nodeUri = void 0;\n    } else if (nodeUri !== void 0) {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    if (typeof laneUri === \"function\") {\n      fastenerClass.prototype.initLaneUri = laneUri;\n      laneUri = void 0;\n    } else if (laneUri !== void 0) {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    if (typeof prio === \"function\") {\n      fastenerClass.prototype.initPrio = prio;\n      prio = void 0;\n    }\n    if (typeof rate === \"function\") {\n      fastenerClass.prototype.initRate = rate;\n      rate = void 0;\n    }\n    if (typeof body === \"function\") {\n      fastenerClass.prototype.initBody = body;\n      body = void 0;\n    } else if (body !== void 0) {\n      body = Value.fromAny(body);\n    }\n\n    return fastenerClass;\n  };\n\n  return ListDownlinkFastener;\n})(DownlinkFastener);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Mutable, Cursor} from \"@swim/util\";\nimport type {FastenerOwner} from \"@swim/fastener\";\nimport {AnyValue, Value, Form} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport type {MapDownlinkObserver, MapDownlink} from \"../downlink/MapDownlink\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport {DownlinkFastenerInit, DownlinkFastenerClass, DownlinkFastener} from \"./DownlinkFastener\";\n\n/** @internal */\nexport type MapDownlinkFastenerKeyType<F extends MapDownlinkFastener<any, any, any>> =\n  F extends MapDownlinkFastener<any, infer K, any, any, any> ? K : never;\n\n/** @internal */\nexport type MapDownlinkFastenerKeyInitType<F extends MapDownlinkFastener<any, any, any>> =\n  F extends MapDownlinkFastener<any, infer K, infer KU, any, any> ? K | KU : never;\n\n/** @internal */\nexport type MapDownlinkFastenerValueType<F extends MapDownlinkFastener<any, any, any>> =\n  F extends MapDownlinkFastener<any, any, any, infer V, any> ? V : never;\n\n/** @internal */\nexport type MapDownlinkFastenerValueInitType<F extends MapDownlinkFastener<any, any, any>> =\n  F extends MapDownlinkFastener<any, any, any, infer V, infer VU> ? V | VU : never;\n\n/** @beta */\nexport interface MapDownlinkFastenerInit<K = unknown, V = unknown, KU = K, VU = V> extends DownlinkFastenerInit, MapDownlinkObserver<K, V, KU, VU> {\n  extends?: {prototype: MapDownlinkFastener<any, any, any>} | string | boolean | null;\n  keyForm?: Form<K, KU>;\n  valueForm?: Form<V, VU>;\n\n  initDownlink?(downlink: MapDownlink<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n}\n\n/** @beta */\nexport type MapDownlinkFastenerDescriptor<O = unknown, K = unknown, V = unknown, KU = K, VU = V, I = {}> = ThisType<MapDownlinkFastener<O, K, V, KU, VU> & I> & MapDownlinkFastenerInit<K, V, KU, VU> & Partial<I>;\n\n/** @beta */\nexport interface MapDownlinkFastenerClass<F extends MapDownlinkFastener<any, any, any> = MapDownlinkFastener<any, any, any>> extends DownlinkFastenerClass<F> {\n}\n\n/** @beta */\nexport interface MapDownlinkFastenerFactory<F extends MapDownlinkFastener<any, any, any> = MapDownlinkFastener<any, any, any>> extends MapDownlinkFastenerClass<F> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): MapDownlinkFastenerFactory<F> & I;\n\n  define<O, K extends Value = Value, V extends Value = Value, KU extends AnyValue = AnyValue, VU extends AnyValue = AnyValue>(className: string, descriptor: MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU>>;\n  define<O, K = unknown, V extends Value = Value, KU = K, VU extends AnyValue = AnyValue>(className: string, descriptor: {keyForm: Form<K, KU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU>>;\n  define<O, K extends Value = Value, V = unknown, KU extends AnyValue = AnyValue, VU = V>(className: string, descriptor: {valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU>>;\n  define<O, K, V, KU = K, VU = V>(className: string, escriptor: {keyForm: Form<K, KU>, valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU>>;\n  define<O, K extends Value = Value, V extends Value = Value, KU extends AnyValue = AnyValue, VU extends AnyValue = AnyValue, I = {}>(className: string, descriptor: MapDownlinkFastenerDescriptor<O, V, VU, I>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU> & I>;\n  define<O, K = unknown, V extends Value = Value, KU = K, VU extends AnyValue = AnyValue, I = {}>(className: string, descriptor: {keyForm: Form<K, KU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU> & I>;\n  define<O, K extends Value = Value, V = unknown, KU extends AnyValue = AnyValue, VU = V, I = {}>(className: string, descriptor: {valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU> & I>;\n  define<O, K, V, KU = K, VU = V, I = {}>(className: string, descriptor: {keyForm: Form<K, KU>, valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU> & I>;\n\n  <O, K extends Value = Value, V extends Value = Value, KU extends AnyValue = AnyValue, VU extends AnyValue = AnyValue>(descriptor: MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): PropertyDecorator;\n  <O, K = unknown, V extends Value = Value, KU = K, VU extends AnyValue = AnyValue>(descriptor: {keyForm: Form<K, KU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): PropertyDecorator;\n  <O, K extends Value = Value, V = unknown, KU extends AnyValue = AnyValue, VU = V>(descriptor: {valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): PropertyDecorator;\n  <O, K, V, KU = K, VU = V>(descriptor: {keyForm: Form<K, KU>, valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): PropertyDecorator;\n  <O, K extends Value = Value, V extends Value = Value, KU extends AnyValue = AnyValue, VU extends AnyValue = AnyValue, I = {}>(descriptor: MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): PropertyDecorator;\n  <O, K = unknown, V extends Value = Value, KU = K, VU extends AnyValue = AnyValue, I = {}>(descriptor: {keyForm: Form<K, KU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): PropertyDecorator;\n  <O, K extends Value = Value, V = unknown, KU extends AnyValue = AnyValue, VU = V, I = {}>(descriptor: {valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): PropertyDecorator;\n  <O, K, V, KU = K, VU = V, I = {}>(descriptor: {keyForm: Form<K, KU>, valueForm: Form<V, VU>} & MapDownlinkFastenerDescriptor<O, K, V, KU, VU, I>): PropertyDecorator;\n}\n\n/** @beta */\nexport interface MapDownlinkFastener<O = unknown, K = unknown, V = unknown, KU = K, VU = V> extends DownlinkFastener<O> {\n  (key: K | KU): V | undefined;\n  (key: K | KU, value: V | VU): O;\n\n  /** @internal */\n  ownKeyForm: Form<K, KU> | null;\n\n  keyForm(): Form<K, KU> | null;\n  keyForm(keyForm: Form<K, KU> | null): this;\n\n  /** @internal */\n  readonly ownValueForm: Form<V, VU> | null;\n\n  valueForm(): Form<V, VU> | null;\n  valueForm(valueForm: Form<V, VU> | null): this;\n\n  get size(): number;\n\n  isEmpty(): boolean;\n\n  has(key: K | KU): boolean;\n\n  get(key: K | KU): V | undefined;\n\n  getEntry(index: number): [K, V] | undefined;\n\n  firstKey(): K | undefined;\n\n  firstValue(): V | undefined;\n\n  firstEntry(): [K, V] | undefined;\n\n  lastKey(): K | undefined;\n\n  lastValue(): V | undefined;\n\n  lastEntry(): [K, V] | undefined;\n\n  nextKey(keyObject: K): K | undefined;\n\n  nextValue(keyObject: K): V | undefined;\n\n  nextEntry(keyObject: K): [K, V] | undefined;\n\n  previousKey(keyObject: K): K | undefined;\n\n  previousValue(keyObject: K): V | undefined;\n\n  previousEntry(keyObject: K): [K, V] | undefined;\n\n  set(key: K | KU, newValue: V | VU): this;\n\n  delete(key: K | KU): boolean;\n\n  drop(lower: number): this;\n\n  take(upper: number): this;\n\n  clear(): void;\n\n  forEach<T>(callback: (key: K, value: V) => T | void): T | undefined;\n  forEach<T, S>(callback: (this: S, key: K, value: V) => T | void, thisArg: S): T | undefined;\n\n  keys(): Cursor<K>;\n\n  values(): Cursor<V>;\n\n  entries(): Cursor<[K, V]>;\n\n  /** @override */\n  readonly downlink: MapDownlink<K, V, KU, VU> | null;\n\n  /** @internal @override */\n  createDownlink(warp: WarpRef): MapDownlink<K, V, KU, VU>;\n\n  /** @internal @override */\n  bindDownlink(downlink: MapDownlink<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n\n  /** @internal */\n  initDownlink?(downlink: MapDownlink<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n}\n\n/** @beta */\nexport const MapDownlinkFastener = (function (_super: typeof DownlinkFastener) {\n  const MapDownlinkFastener: MapDownlinkFastenerFactory = _super.extend(\"MapDownlinkFastener\");\n\n  MapDownlinkFastener.prototype.keyForm = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyForm?: Form<K, KU> | null): Form<K, KU> | null | typeof this {\n    if (keyForm === void 0) {\n      return this.ownKeyForm;\n    } else {\n      if (this.ownKeyForm !== keyForm) {\n        (this as Mutable<typeof this>).ownKeyForm = keyForm;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof MapDownlinkFastener.prototype.keyForm;\n\n  MapDownlinkFastener.prototype.valueForm = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, valueForm?: Form<V, VU> | null): Form<V, VU> | null | typeof this {\n    if (valueForm === void 0) {\n      return this.ownValueForm;\n    } else {\n      if (this.ownValueForm !== valueForm) {\n        (this as Mutable<typeof this>).ownValueForm = valueForm;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof MapDownlinkFastener.prototype.valueForm;\n\n  Object.defineProperty(MapDownlinkFastener.prototype, \"size\", {\n    get: function (this: MapDownlinkFastener<unknown>): number {\n      const downlink = this.downlink;\n      return downlink !== null ? downlink.size : 0;\n    },\n    configurable: true,\n  });\n\n  MapDownlinkFastener.prototype.isEmpty = function (this: MapDownlinkFastener<unknown>): boolean {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.isEmpty() : true;\n  };\n\n  MapDownlinkFastener.prototype.has = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, key: K | KU): boolean {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.has(key) : false;\n  };\n\n  MapDownlinkFastener.prototype.get = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, key: K | KU): V | undefined {\n    const downlink = this.downlink;\n    let value: V | undefined;\n    if (downlink !== null) {\n      value = downlink.get(key);\n    }\n    if (value === void 0 && this.ownValueForm !== null) {\n      value = this.ownValueForm.unit;\n    }\n    return value;\n  };\n\n  MapDownlinkFastener.prototype.getEntry = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, index: number): [K, V] | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.getEntry(index) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.firstKey = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): K | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.firstKey() : void 0;\n  };\n\n  MapDownlinkFastener.prototype.firstValue = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.firstValue() : void 0;\n  };\n\n  MapDownlinkFastener.prototype.firstEntry = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): [K, V] | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.firstEntry() : void 0;\n  };\n\n  MapDownlinkFastener.prototype.lastKey = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): K | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.lastKey() : void 0;\n  };\n\n  MapDownlinkFastener.prototype.lastValue = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.lastValue() : void 0;\n  };\n\n  MapDownlinkFastener.prototype.lastEntry = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): [K, V] | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.lastEntry() : void 0;\n  };\n\n  MapDownlinkFastener.prototype.nextKey = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyObject: K): K | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.nextKey(keyObject) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.nextValue = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyObject: K): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.nextValue(keyObject) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.nextEntry = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyObject: K): [K, V] | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.nextEntry(keyObject) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.previousKey = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyObject: K): K | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.previousKey(keyObject) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.previousValue = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyObject: K): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.previousValue(keyObject) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.previousEntry = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, keyObject: K): [K, V] | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.previousEntry(keyObject) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.set = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, key: K | KU, newValue: V | VU): typeof this {\n    const downlink = this.downlink;\n    if (downlink !== null) {\n      downlink.set(key, newValue);\n    }\n    return this;\n  };\n\n  MapDownlinkFastener.prototype.delete = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, key: K | KU): boolean {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.delete(key) : false;\n  };\n\n  MapDownlinkFastener.prototype.drop = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, lower: number): typeof this {\n    const downlink = this.downlink;\n    if (downlink !== null) {\n      downlink.drop(lower);\n    }\n    return this;\n  };\n\n  MapDownlinkFastener.prototype.take = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, upper: number): typeof this {\n    const downlink = this.downlink;\n    if (downlink !== null) {\n      downlink.take(upper);\n    }\n    return this;\n  };\n\n  MapDownlinkFastener.prototype.clear = function (this: MapDownlinkFastener<unknown>): void {\n    const downlink = this.downlink;\n    if (downlink !== null) {\n      downlink.clear();\n    }\n  };\n\n  MapDownlinkFastener.prototype.forEach = function <K, V, KU, VU, T, S>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, callback: (this: S | undefined, key: K, value: V) => T | void, thisArg?: S): T | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.forEach(callback, thisArg) : void 0;\n  };\n\n  MapDownlinkFastener.prototype.keys = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): Cursor<K> {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.keys() : Cursor.empty();\n  };\n\n  MapDownlinkFastener.prototype.values = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): Cursor<V> {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.values() : Cursor.empty();\n  };\n\n  MapDownlinkFastener.prototype.entries = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>): Cursor<[K, V]> {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.entries() : Cursor.empty();\n  };\n\n  MapDownlinkFastener.prototype.createDownlink = function <K, V, KU, VU>(this: MapDownlinkFastener<unknown, K, V, KU, VU>, warp: WarpRef): MapDownlink<K, V, KU, VU> {\n    let downlink = warp.downlinkMap() as unknown as MapDownlink<K, V, KU, VU>;\n    if (this.ownKeyForm !== null) {\n      downlink = downlink.keyForm(this.ownKeyForm);\n    }\n    if (this.ownValueForm !== null) {\n      downlink = downlink.valueForm(this.ownValueForm);\n    }\n    return downlink;\n  };\n\n  MapDownlinkFastener.construct = function <F extends MapDownlinkFastener<any, any, any>>(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F {\n    if (fastener === null) {\n      fastener = function (key: MapDownlinkFastenerKeyType<F> | MapDownlinkFastenerKeyInitType<F>, value?: MapDownlinkFastenerValueType<F> | MapDownlinkFastenerValueInitType<F>): MapDownlinkFastenerValueType<F> | undefined | FastenerOwner<F> {\n        if (arguments.length === 1) {\n          return fastener!.get(key);\n        } else {\n          fastener!.set(key, value!);\n          return fastener!.owner;\n        }\n      } as F;\n      delete (fastener as Partial<Mutable<F>>).name; // don't clobber prototype name\n      Object.setPrototypeOf(fastener, fastenerClass.prototype);\n    }\n    fastener = _super.construct(fastenerClass, fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).ownKeyForm = null;\n    (fastener as Mutable<typeof fastener>).ownValueForm = null;\n    return fastener;\n  };\n\n  MapDownlinkFastener.define = function <O, K, V, KU, VU>(className: string, descriptor: MapDownlinkFastenerDescriptor<O, K, V, KU, VU>): MapDownlinkFastenerFactory<MapDownlinkFastener<any, K, V, KU, VU>> {\n    let superClass = descriptor.extends as MapDownlinkFastenerFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const keyForm = descriptor.keyForm;\n    const valueForm = descriptor.valueForm;\n    let hostUri = descriptor.hostUri;\n    let nodeUri = descriptor.nodeUri;\n    let laneUri = descriptor.laneUri;\n    let prio = descriptor.prio;\n    let rate = descriptor.rate;\n    let body = descriptor.body;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.keyForm;\n    delete descriptor.valueForm;\n    delete descriptor.hostUri;\n    delete descriptor.nodeUri;\n    delete descriptor.laneUri;\n    delete descriptor.prio;\n    delete descriptor.rate;\n    delete descriptor.body;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const fastenerClass = superClass.extend(className, descriptor);\n\n    fastenerClass.construct = function (fastenerClass: {prototype: MapDownlinkFastener<any, any, any>}, fastener: MapDownlinkFastener<O, K, V, KU, VU> | null, owner: O): MapDownlinkFastener<O, K, V, KU, VU> {\n      fastener = superClass!.construct(fastenerClass, fastener, owner);\n      if (affinity !== void 0) {\n        fastener.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        fastener.initInherits(inherits);\n      }\n      if (hostUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownHostUri = hostUri as Uri;\n      }\n      if (nodeUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownNodeUri = nodeUri as Uri;\n      }\n      if (laneUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownLaneUri = laneUri as Uri;\n      }\n      if (prio !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownPrio = prio as number;\n      }\n      if (rate !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownRate = rate as number;\n      }\n      if (body !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownBody = body as Value;\n      }\n      if (keyForm !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownKeyForm = keyForm;\n      }\n      if (valueForm !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownValueForm = valueForm;\n      }\n      return fastener;\n    };\n\n    if (typeof hostUri === \"function\") {\n      fastenerClass.prototype.initHostUri = hostUri;\n      hostUri = void 0;\n    } else if (hostUri !== void 0) {\n      hostUri = Uri.fromAny(hostUri);\n    }\n    if (typeof nodeUri === \"function\") {\n      fastenerClass.prototype.initNodeUri = nodeUri;\n      nodeUri = void 0;\n    } else if (nodeUri !== void 0) {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    if (typeof laneUri === \"function\") {\n      fastenerClass.prototype.initLaneUri = laneUri;\n      laneUri = void 0;\n    } else if (laneUri !== void 0) {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    if (typeof prio === \"function\") {\n      fastenerClass.prototype.initPrio = prio;\n      prio = void 0;\n    }\n    if (typeof rate === \"function\") {\n      fastenerClass.prototype.initRate = rate;\n      rate = void 0;\n    }\n    if (typeof body === \"function\") {\n      fastenerClass.prototype.initBody = body;\n      body = void 0;\n    } else if (body !== void 0) {\n      body = Value.fromAny(body);\n    }\n\n    return fastenerClass;\n  };\n\n  return MapDownlinkFastener;\n})(DownlinkFastener);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport type {FastenerOwner} from \"@swim/fastener\";\nimport {AnyValue, Value, Form} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport type {ValueDownlinkObserver, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport type {WarpRef} from \"../ref/WarpRef\";\nimport {DownlinkFastenerInit, DownlinkFastenerClass, DownlinkFastener} from \"./DownlinkFastener\";\n\n/** @internal */\nexport type ValueDownlinkFastenerType<F extends ValueDownlinkFastener<any, any>> =\n  F extends ValueDownlinkFastener<any, infer V, any> ? V : never;\n\n/** @internal */\nexport type ValueDownlinkFastenerInitType<F extends ValueDownlinkFastener<any, any>> =\n  F extends ValueDownlinkFastener<any, infer V, infer VU> ? V | VU : never;\n\n/** @beta */\nexport interface ValueDownlinkFastenerInit<V = unknown, VU = V> extends DownlinkFastenerInit, ValueDownlinkObserver<V, VU> {\n  extends?: {prototype: ValueDownlinkFastener<any, any>} | string | boolean | null;\n  valueForm?: Form<V, VU>;\n\n  initDownlink?(downlink: ValueDownlink<V, VU>): ValueDownlink<V, VU>;\n}\n\n/** @beta */\nexport type ValueDownlinkFastenerDescriptor<O = unknown, V = unknown, VU = V, I = {}> = ThisType<ValueDownlinkFastener<O, V, VU> & I> & ValueDownlinkFastenerInit<V, VU> & Partial<I>;\n\n/** @beta */\nexport interface ValueDownlinkFastenerClass<F extends ValueDownlinkFastener<any, any> = ValueDownlinkFastener<any, any>> extends DownlinkFastenerClass<F> {\n}\n\n/** @beta */\nexport interface ValueDownlinkFastenerFactory<F extends ValueDownlinkFastener<any, any> = ValueDownlinkFastener<any, any>> extends ValueDownlinkFastenerClass<F> {\n  extend<I = {}>(className: string, classMembers?: Partial<I> | null): ValueDownlinkFastenerFactory<F> & I;\n\n  define<O, V extends Value = Value, VU extends AnyValue = AnyValue>(className: string, descriptor: ValueDownlinkFastenerDescriptor<O, V, VU>): ValueDownlinkFastenerFactory<ValueDownlinkFastener<any, V, VU>>;\n  define<O, V, VU = V>(className: string, descriptor: {valueForm: Form<V, VU>} & ValueDownlinkFastenerDescriptor<O, V, VU>): ValueDownlinkFastenerFactory<ValueDownlinkFastener<any, V, VU>>;\n  define<O, V extends Value = Value, VU extends AnyValue = AnyValue, I = {}>(className: string, descriptor: ValueDownlinkFastenerDescriptor<O, V, VU, I>): ValueDownlinkFastenerFactory<ValueDownlinkFastener<any, V, VU> & I>;\n  define<O, V, VU = V, I = {}>(className: string, descriptor: {valueForm: Form<V, VU>} & ValueDownlinkFastenerDescriptor<O, V, VU, I>): ValueDownlinkFastenerFactory<ValueDownlinkFastener<any, V, VU> & I>;\n\n  <O, V extends Value = Value, VU extends AnyValue = AnyValue>(descriptor: ValueDownlinkFastenerDescriptor<O, V, VU>): PropertyDecorator;\n  <O, V, VU = V>(descriptor: {valueForm: Form<V, VU>} & ValueDownlinkFastenerDescriptor<O, V, VU>): PropertyDecorator;\n  <O, V extends Value = Value, VU extends AnyValue = AnyValue, I = {}>(descriptor: ValueDownlinkFastenerDescriptor<O, V, VU, I>): PropertyDecorator;\n  <O, V, VU = V, I = {}>(descriptor: {valueForm: Form<V, VU>} & ValueDownlinkFastenerDescriptor<O, V, VU, I>): PropertyDecorator;\n}\n\n/** @beta */\nexport interface ValueDownlinkFastener<O = unknown, V = unknown, VU = V> extends DownlinkFastener<O> {\n  (): V | undefined;\n  (value: V | VU): O;\n\n  /** @internal */\n  readonly ownValueForm: Form<V, VU> | null;\n\n  valueForm(): Form<V, VU> | null;\n  valueForm(valueForm: Form<V, VU> | null): this;\n\n  get(): V | undefined;\n\n  set(value: V | VU): void;\n\n  /** @override */\n  readonly downlink: ValueDownlink<V, VU> | null;\n\n  /** @internal @override */\n  createDownlink(warp: WarpRef): ValueDownlink<V, VU>;\n\n  /** @internal @override */\n  bindDownlink(downlink: ValueDownlink<V, VU>): ValueDownlink<V, VU>;\n\n  /** @internal */\n  initDownlink?(downlink: ValueDownlink<V, VU>): ValueDownlink<V, VU>;\n}\n\n/** @beta */\nexport const ValueDownlinkFastener = (function (_super: typeof DownlinkFastener) {\n  const ValueDownlinkFastener: ValueDownlinkFastenerFactory = _super.extend(\"ValueDownlinkFastener\");\n\n  ValueDownlinkFastener.prototype.valueForm = function <V, VU>(this: ValueDownlinkFastener<unknown, V, VU>, valueForm?: Form<V, VU> | null): Form<V, VU> | null | typeof this {\n    if (valueForm === void 0) {\n      return this.ownValueForm;\n    } else {\n      if (this.ownValueForm !== valueForm) {\n        (this as Mutable<typeof this>).ownValueForm = valueForm;\n        this.relink();\n      }\n      return this;\n    }\n  } as typeof ValueDownlinkFastener.prototype.valueForm;\n\n  ValueDownlinkFastener.prototype.get = function <V>(this: ValueDownlinkFastener<unknown, V>): V | undefined {\n    const downlink = this.downlink;\n    return downlink !== null ? downlink.get() : void 0;\n  };\n\n  ValueDownlinkFastener.prototype.set = function <V, VU>(this: ValueDownlinkFastener<unknown, V, VU>, value: V | VU): void {\n    const downlink = this.downlink;\n    if (downlink !== null) {\n      downlink.set(value);\n    }\n  };\n\n  ValueDownlinkFastener.prototype.createDownlink = function <V, VU>(this: ValueDownlinkFastener<unknown, V, VU>, warp: WarpRef): ValueDownlink<V, VU> {\n    let downlink = warp.downlinkValue() as unknown as ValueDownlink<V, VU>;\n    if (this.ownValueForm !== null) {\n      downlink = downlink.valueForm(this.ownValueForm);\n    }\n    return downlink;\n  };\n\n  ValueDownlinkFastener.construct = function <F extends ValueDownlinkFastener<any, any>>(fastenerClass: {prototype: F}, fastener: F | null, owner: FastenerOwner<F>): F {\n    if (fastener === null) {\n      fastener = function (value?: ValueDownlinkFastenerType<F> | ValueDownlinkFastenerInitType<F>): ValueDownlinkFastenerType<F> | undefined | FastenerOwner<F> {\n        if (arguments.length === 0) {\n          return fastener!.get();\n        } else {\n          fastener!.set(value!);\n          return fastener!.owner;\n        }\n      } as F;\n      delete (fastener as Partial<Mutable<F>>).name; // don't clobber prototype name\n      Object.setPrototypeOf(fastener, fastenerClass.prototype);\n    }\n    fastener = _super.construct(fastenerClass, fastener, owner) as F;\n    (fastener as Mutable<typeof fastener>).ownValueForm = null;\n    return fastener;\n  };\n\n  ValueDownlinkFastener.define = function <O, V, VU>(className: string, descriptor: ValueDownlinkFastenerDescriptor<O, V, VU>): ValueDownlinkFastenerFactory<ValueDownlinkFastener<any, V, VU>> {\n    let superClass = descriptor.extends as ValueDownlinkFastenerFactory | null | undefined;\n    const affinity = descriptor.affinity;\n    const inherits = descriptor.inherits;\n    const valueForm = descriptor.valueForm;\n    let hostUri = descriptor.hostUri;\n    let nodeUri = descriptor.nodeUri;\n    let laneUri = descriptor.laneUri;\n    let prio = descriptor.prio;\n    let rate = descriptor.rate;\n    let body = descriptor.body;\n    delete descriptor.extends;\n    delete descriptor.affinity;\n    delete descriptor.inherits;\n    delete descriptor.valueForm;\n    delete descriptor.hostUri;\n    delete descriptor.nodeUri;\n    delete descriptor.laneUri;\n    delete descriptor.prio;\n    delete descriptor.rate;\n    delete descriptor.body;\n\n    if (superClass === void 0 || superClass === null) {\n      superClass = this;\n    }\n\n    const fastenerClass = superClass.extend(className, descriptor);\n\n    fastenerClass.construct = function (fastenerClass: {prototype: ValueDownlinkFastener<any, any>}, fastener: ValueDownlinkFastener<O, V, VU> | null, owner: O): ValueDownlinkFastener<O, V, VU> {\n      fastener = superClass!.construct(fastenerClass, fastener, owner);\n      if (affinity !== void 0) {\n        fastener.initAffinity(affinity);\n      }\n      if (inherits !== void 0) {\n        fastener.initInherits(inherits);\n      }\n      if (hostUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownHostUri = hostUri as Uri;\n      }\n      if (nodeUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownNodeUri = nodeUri as Uri;\n      }\n      if (laneUri !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownLaneUri = laneUri as Uri;\n      }\n      if (prio !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownPrio = prio as number;\n      }\n      if (rate !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownRate = rate as number;\n      }\n      if (body !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownBody = body as Value;\n      }\n      if (valueForm !== void 0) {\n        (fastener as Mutable<typeof fastener>).ownValueForm = valueForm;\n      }\n      return fastener;\n    };\n\n    if (typeof hostUri === \"function\") {\n      fastenerClass.prototype.initHostUri = hostUri;\n      hostUri = void 0;\n    } else if (hostUri !== void 0) {\n      hostUri = Uri.fromAny(hostUri);\n    }\n    if (typeof nodeUri === \"function\") {\n      fastenerClass.prototype.initNodeUri = nodeUri;\n      nodeUri = void 0;\n    } else if (nodeUri !== void 0) {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    if (typeof laneUri === \"function\") {\n      fastenerClass.prototype.initLaneUri = laneUri;\n      laneUri = void 0;\n    } else if (laneUri !== void 0) {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    if (typeof prio === \"function\") {\n      fastenerClass.prototype.initPrio = prio;\n      prio = void 0;\n    }\n    if (typeof rate === \"function\") {\n      fastenerClass.prototype.initRate = rate;\n      rate = void 0;\n    }\n    if (typeof body === \"function\") {\n      fastenerClass.prototype.initBody = body;\n      body = void 0;\n    } else if (body !== void 0) {\n      body = Value.fromAny(body);\n    }\n\n    return fastenerClass;\n  };\n\n  return ValueDownlinkFastener;\n})(DownlinkFastener);\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintRelation} from \"./ConstraintRelation\";\nimport {AnyConstraintStrength, ConstraintStrength} from \"./ConstraintStrength\";\nimport {Constraint} from \"./Constraint\";\nimport type {ConstraintScope} from \"./ConstraintScope\";\n\n/** @beta */\nexport class ConstraintGroup {\n  constructor(scope: ConstraintScope) {\n    this.scope = scope;\n    this.constraints = [];\n    this.constrained = false;\n  }\n\n  readonly scope: ConstraintScope;\n\n  constraint(lhs: AnyConstraintExpression, relation: ConstraintRelation,\n             rhs?: AnyConstraintExpression, strength?: AnyConstraintStrength): Constraint {\n    lhs = ConstraintExpression.fromAny(lhs);\n    if (rhs !== void 0) {\n      rhs = ConstraintExpression.fromAny(rhs);\n    }\n    const expression = rhs !== void 0 ? lhs.minus(rhs) : lhs;\n    if (strength === void 0) {\n      strength = ConstraintStrength.Required;\n    } else {\n      strength = ConstraintStrength.fromAny(strength);\n    }\n    const constraint = new Constraint(this.scope, expression, relation, strength);\n    this.addConstraint(constraint);\n    return constraint;\n  }\n\n  readonly constraints: ReadonlyArray<Constraint>;\n\n  hasConstraint(constraint: Constraint): boolean {\n    const constraints = this.constraints;\n    return constraints.indexOf(constraint) >= 0;\n  }\n\n  addConstraint(constraint: Constraint): void {\n    const constraints = this.constraints as Constraint[];\n    if (constraints.indexOf(constraint) < 0) {\n      constraints.push(constraint);\n      constraint.constrain(this.constrained);\n    }\n  }\n\n  removeConstraint(constraint: Constraint): void {\n    const constraints = this.constraints as Constraint[];\n    if (constraints !== void 0) {\n      const index = constraints.indexOf(constraint);\n      if (index >= 0) {\n        constraints.splice(index, 1);\n        constraint.constrain(false);\n      }\n    }\n  }\n\n  /** @internal */\n  enableConstraints(): void {\n    const constraints = this.constraints;\n    for (let i = 0, n = constraints.length ; i < n; i += 1) {\n      constraints[i]!.constrain(true);\n    }\n  }\n\n  /** @internal */\n  disableConstraints(): void {\n    const constraints = this.constraints;\n    for (let i = 0, n = constraints.length ; i < n; i += 1) {\n      constraints[i]!.constrain(false);\n    }\n  }\n\n  /** @internal */\n  readonly constrained: boolean;\n\n  isConstrained(): boolean {\n    return this.constrained;\n  }\n\n  constrain(constrained: boolean = true): this {\n    if (constrained && !this.constrained) {\n      (this as Mutable<this>).constrained = true;\n      this.enableConstraints();\n    } else if (!constrained && this.constrained) {\n      (this as Mutable<this>).constrained = false;\n      this.disableConstraints();\n    }\n    return this;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Equivalent, Mutable} from \"@swim/util\";\nimport {ConstraintMap} from \"./ConstraintMap\";\nimport {ConstraintSymbol, ConstraintSlack, ConstraintError, ConstraintDummy} from \"./ConstraintSymbol\";\nimport {AnyConstraintExpression, ConstraintExpression} from \"./ConstraintExpression\";\nimport type {ConstraintVariable} from \"./ConstraintVariable\";\nimport {ConstraintProperty} from \"./ConstraintProperty\";\nimport type {ConstraintRelation} from \"./ConstraintRelation\";\nimport {AnyConstraintStrength, ConstraintStrength} from \"./ConstraintStrength\";\nimport {Constraint} from \"./Constraint\";\nimport type {ConstraintScope} from \"./ConstraintScope\";\nimport {ConstraintRow} from \"./ConstraintRow\";\n\n/** @internal */\nexport interface ConstraintTag {\n  readonly marker: ConstraintSymbol;\n  readonly other: ConstraintSymbol;\n}\n\n/** @internal */\nexport interface ConstraintVariableBinding {\n  readonly constraint: Constraint;\n  readonly tag: ConstraintTag;\n  state: number;\n}\n\n/** @public */\nexport class ConstraintSolver implements ConstraintScope {\n  constructor() {\n    this.constraints = new ConstraintMap();\n    this.constraintVariables = new ConstraintMap();\n    this.rows = new ConstraintMap();\n    this.infeasible = [];\n    this.objective = new ConstraintRow(this, null, new ConstraintMap(), 0);\n    this.artificial = null;\n    this.invalidated = new ConstraintMap();\n  }\n\n  /** @internal */\n  readonly constraints: ConstraintMap<Constraint, ConstraintTag>;\n\n  /** @internal */\n  readonly constraintVariables: ConstraintMap<ConstraintVariable, ConstraintVariableBinding>;\n\n  /** @internal */\n  readonly rows: ConstraintMap<ConstraintSymbol, ConstraintRow>;\n\n  /** @internal */\n  readonly infeasible: ConstraintSymbol[];\n\n  /** @internal */\n  readonly objective: ConstraintRow;\n\n  /** @internal */\n  readonly artificial: ConstraintRow | null;\n\n  /** @internal */\n  readonly invalidated: ConstraintMap<ConstraintSymbol, ConstraintRow | null>;\n\n  constraint(lhs: AnyConstraintExpression, relation: ConstraintRelation,\n             rhs?: AnyConstraintExpression, strength?: AnyConstraintStrength): Constraint {\n    lhs = ConstraintExpression.fromAny(lhs);\n    if (rhs !== void 0) {\n      rhs = ConstraintExpression.fromAny(rhs);\n    }\n    const expression = rhs !== void 0 ? lhs.minus(rhs) : lhs;\n    if (strength === void 0) {\n      strength = ConstraintStrength.Required;\n    } else {\n      strength = ConstraintStrength.fromAny(strength);\n    }\n    const constraint = new Constraint(this, expression, relation, strength);\n    this.addConstraint(constraint);\n    return constraint;\n  }\n\n  hasConstraint(constraint: Constraint): boolean {\n    return this.constraints.has(constraint);\n  }\n\n  addConstraint(constraint: Constraint): void {\n    if (this.constraints.has(constraint)) {\n      return;\n    }\n\n    const terms = constraint.expression.terms;\n    for (let i = 0, n = terms.size; i < n; i += 1) {\n      const variable = terms.getEntry(i)![0];\n      variable.addConstraintCondition(constraint, this);\n    }\n\n    // Creating a row causes symbols to be reserved for the variables in the constraint.\n    const {row, tag} = this.createRow(constraint);\n\n    this.addConstraintRow(constraint, row, tag);\n  }\n\n  /** @internal */\n  protected addConstraintRow(constraint: Constraint, row: ConstraintRow, tag: ConstraintTag): void {\n    this.willAddConstraint(constraint);\n\n    let subject = this.chooseSubject(row, tag);\n\n    // If chooseSubject couldn't find a valid entering symbol, one last option\n    // is available if the entire row is composed of dummy variables. If the\n    // constant of the row is zero, then this represents redundant constraints\n    // and the new dummy marker can enter the basis. If the constant is\n    // non-zero, then it represents an unsatisfiable constraint.\n    if (subject.isInvalid() && row.isDummy()) {\n      if (Math.abs(row.constant) < Equivalent.Epsilon) {\n        subject = tag.marker;\n      } else {\n        throw new Error(\"unsatisfiable constraint\");\n      }\n    }\n\n    // If an entering symbol still isn't found, then the row must be added\n    // using an artificial variable. If that fails, then the row represents\n    // an unsatisfiable constraint.\n    if (subject.isInvalid()) {\n      if (!this.addWithArtificialVariable(row)) {\n        throw new Error(\"unsatisfiable constraint\");\n      }\n    } else {\n      row.setSymbol(subject);\n      row.solveFor(subject);\n      this.substitute(subject, row);\n      this.rows.set(subject, row);\n    }\n\n    this.constraints.set(constraint, tag);\n\n    // Optimizing after each constraint is added performs less aggregate work\n    // due to a smaller average system size. It also ensures the solver remains\n    // in a consistent state.\n    this.optimize(this.objective);\n\n    this.didAddConstraint(constraint);\n\n    this.updateSolution();\n  }\n\n  protected willAddConstraint(constraint: Constraint): void {\n    // hook\n  }\n\n  protected didAddConstraint(constraint: Constraint): void {\n    // hook\n  }\n\n  removeConstraint(constraint: Constraint): void {\n    const tag = this.constraints.get(constraint);\n    if (tag === void 0) {\n      return;\n    }\n\n    this.removeConstraintRow(constraint);\n\n    const terms = constraint.expression.terms;\n    for (let i = 0, n = terms.size; i < n; i += 1) {\n      const variable = terms.getEntry(i)![0];\n      variable.removeConstraintCondition(constraint, this);\n    }\n  }\n\n  /** @internal */\n  protected removeConstraintRow(constraint: Constraint): void {\n    const tag = this.constraints.get(constraint);\n    if (tag === void 0) {\n      return;\n    }\n\n    this.willRemoveConstraint(constraint);\n\n    this.constraints.remove(constraint);\n\n    // Remove the error effects from the objective function *before* pivoting,\n    // or substitutions into the objective will lead to incorrect solver results.\n    this.removeConstraintEffects(constraint, tag);\n\n    // If the marker is basic, simply drop the row. Otherwise pivot the marker\n    // into the basis and then drop the row.\n    const marker = tag.marker;\n    if (this.rows.remove(marker) === void 0) {\n      const leaving = this.getMarkerLeavingSymbol(marker);\n      if (leaving.isInvalid()) {\n        throw new Error(\"failed to find leaving row\");\n      }\n      const row = this.rows.remove(leaving)!;\n      row.solveForEx(leaving, marker);\n      this.substitute(marker, row);\n    }\n\n    // Optimizing after each constraint is removed ensures that the solver\n    // remains consistent. It makes the solver API easier to use at a small\n    // tradeoff for speed.\n    this.optimize(this.objective);\n\n    this.didRemoveConstraint(constraint);\n\n    this.updateSolution();\n  }\n\n  protected willRemoveConstraint(constraint: Constraint): void {\n    // hook\n  }\n\n  protected didRemoveConstraint(constraint: Constraint): void {\n    // hook\n  }\n\n  constraintVariable(name: string, value?: number, strength?: AnyConstraintStrength): ConstraintProperty<unknown, number> {\n    if (value === void 0) {\n      value = 0;\n    }\n    if (strength !== void 0) {\n      strength = ConstraintStrength.fromAny(strength);\n    } else {\n      strength = ConstraintStrength.Strong;\n    }\n    const property = ConstraintProperty.create(this) as ConstraintProperty<unknown, number>;\n    Object.defineProperty(property, \"name\", {\n      value: name,\n      configurable: true,\n    });\n    if (value !== void 0) {\n      property.setState(value);\n    }\n    property.setStrength(strength);\n    property.mount();\n    return property;\n  }\n\n  hasConstraintVariable(variable: ConstraintVariable): boolean {\n    return this.constraintVariables.has(variable);\n  }\n\n  addConstraintVariable(variable: ConstraintVariable): void {\n    if (this.constraintVariables.has(variable)) {\n      return;\n    }\n\n    const strength = ConstraintStrength.clip(variable.strength);\n    if (strength === ConstraintStrength.Required) {\n      throw new Error(\"invalid variable strength\");\n    }\n\n    this.willAddConstraintVariable(variable);\n\n    const constraint = new Constraint(this, variable, \"eq\", strength);\n    const {row, tag} = this.createRow(constraint);\n    this.constraintVariables.set(variable, {constraint, tag, state: 0});\n\n    this.addConstraintRow(constraint, row, tag);\n\n    this.didAddConstraintVariable(variable);\n  }\n\n  protected willAddConstraintVariable(variable: ConstraintVariable): void {\n    // hook\n  }\n\n  protected didAddConstraintVariable(variable: ConstraintVariable): void {\n    // hook\n  }\n\n  removeConstraintVariable(variable: ConstraintVariable): void {\n    const binding = this.constraintVariables.get(variable);\n    if (binding === void 0) {\n      return;\n    }\n\n    this.willRemoveConstraintVariable(variable);\n\n    this.constraintVariables.remove(variable);\n    this.removeConstraintRow(binding.constraint);\n\n    this.didRemoveConstraintVariable(variable);\n  }\n\n  protected willRemoveConstraintVariable(variable: ConstraintVariable): void {\n    // hook\n  }\n\n  protected didRemoveConstraintVariable(variable: ConstraintVariable): void {\n    // hook\n  }\n\n  setConstraintVariable(variable: ConstraintVariable, newState: number): void {\n    const binding = this.constraintVariables.get(variable);\n    if (binding === void 0) {\n      throw new Error(\"unbound variable\");\n    }\n\n    const oldState = binding.state;\n    if (oldState !== newState) {\n      binding.state = newState;\n      const delta = newState - oldState;\n\n      this.willSetConstraintVariable(variable, newState, oldState);\n\n      // Check first if the positive error variable is basic.\n      const marker = binding.tag.marker;\n      let row = this.rows.get(marker);\n      if (row !== void 0) {\n        if (row.add(-delta) < 0) {\n          this.infeasible.push(marker);\n        }\n        this.dualOptimize();\n        return;\n      }\n\n      // Check next if the negative error variable is basic.\n      const other = binding.tag.other;\n      row = this.rows.get(other);\n      if (row !== void 0) {\n        if (row.add(delta) < 0) {\n          this.infeasible.push(other);\n        }\n        this.dualOptimize();\n        return;\n      }\n\n      // Otherwise update each row where the error variables exist.\n      for (let i = 0, n = this.rows.size; i < n; i += 1) {\n        const [symbol, row] = this.rows.getEntry(i)!;\n        const coefficient = row.coefficientFor(marker);\n        if (coefficient !== 0 && row.add(delta * coefficient) < 0 && !symbol.isExternal()) {\n          this.infeasible.push(symbol);\n        }\n      }\n      this.dualOptimize();\n\n      this.didSetConstraintVariable(variable, newState, oldState);\n\n      this.updateSolution();\n    }\n  }\n\n  protected willSetConstraintVariable(variable: ConstraintVariable, newState: number, oldState: number): void {\n    // hook\n  }\n\n  protected didSetConstraintVariable(variable: ConstraintVariable, newState: number, oldState: number): void {\n    // hook\n  }\n\n  /** @internal */\n  invalidate(symbol: ConstraintSymbol, row: ConstraintRow | null = null): void {\n    if (symbol.isExternal()) {\n      this.invalidated.set(symbol, row);\n    }\n  }\n\n  /** @internal */\n  updateSolution(): void {\n    const invalidated = this.invalidated;\n    if (!invalidated.isEmpty()) {\n      (this as Mutable<this>).invalidated = new ConstraintMap();\n      for (let i = 0, n = invalidated.size; i < n; i += 1) {\n        const symbol = invalidated.getEntry(i)![0];\n        const row = this.rows.get(symbol);\n        if (row !== void 0) {\n          symbol.updateConstraintSolution(row.constant);\n        }\n      }\n    }\n  }\n\n  // Returns a new row for the given constraint.\n  //\n  // The terms in the constraint will be converted to cells in the row.\n  // Any term in the constraint with a coefficient of zero is ignored.\n  // If the symbol for a given cell variable is basic, the cell variable\n  // will be substituted with the basic row.\n  //\n  // The necessary slack and error variables will be added to the row.\n  // If the constant for the row is negative, the sign for the row will\n  // be inverted so the constant becomes positive.\n  private createRow(constraint: Constraint): {row: ConstraintRow, tag: ConstraintTag} {\n    const expression = constraint.expression;\n    const row = new ConstraintRow(this, null, new ConstraintMap(), expression.constant);\n\n    // Substitute the current basic variables into the row.\n    const terms = expression.terms;\n    for (let i = 0, n = terms.size; i < n; i += 1) {\n      const [variable, coefficient] = terms.getEntry(i)!;\n      if (Math.abs(coefficient) >= Equivalent.Epsilon) {\n        const basic = this.rows.get(variable);\n        if (basic !== void 0) {\n          row.insertRow(basic, coefficient);\n        } else {\n          row.insertSymbol(variable, coefficient);\n        }\n      }\n    }\n\n    // Add the necessary slack, error, and dummy variables.\n    const objective = this.objective;\n    const relation = constraint.relation;\n    const strength = constraint.strength;\n    const tag = {marker: ConstraintSymbol.invalid, other: ConstraintSymbol.invalid};\n    if (relation === \"le\" || relation === \"ge\") {\n      const coefficient = relation === \"le\" ? 1 : -1;\n      const slack = new ConstraintSlack();\n      tag.marker = slack;\n      row.insertSymbol(slack, coefficient);\n      if (strength < ConstraintStrength.Required) {\n        const error = new ConstraintError();\n        tag.other = error;\n        row.insertSymbol(error, -coefficient);\n        objective.insertSymbol(error, strength);\n      }\n    } else {\n      if (strength < ConstraintStrength.Required) {\n        const eplus = new ConstraintError();\n        const eminus = new ConstraintError();\n        tag.marker = eplus;\n        tag.other = eminus;\n        row.insertSymbol(eplus, -1); // v = eplus - eminus\n        row.insertSymbol(eminus, 1); // v - eplus + eminus = 0\n        objective.insertSymbol(eplus, strength);\n        objective.insertSymbol(eminus, strength);\n      } else {\n        const dummy = new ConstraintDummy();\n        tag.marker = dummy;\n        row.insertSymbol(dummy);\n      }\n    }\n\n    // Ensure the row has a positive constant.\n    if (row.constant < 0) {\n      row.negate();\n    }\n\n    return {row, tag};\n  }\n\n  // Returns the symbol to use for solving for the row.\n  //\n  // This method will choose the best subject to use as the solve target for\n  // the row. An invalid symbol will be returned if there is no valid target.\n  //\n  // The symbols are chosen according to the following precedence:\n  //\n  // 1) The first symbol representing an external variable.\n  // 2) A negative slack or error tag variable.\n  //\n  // If a subject cannot be found, an invalid symbol will be returned.\n  private chooseSubject(row: ConstraintRow, tag: ConstraintTag): ConstraintSymbol {\n    for (let i = 0, n = row.cells.size; i < n; i += 1) {\n      const symbol = row.cells.getEntry(i)![0];\n      if (symbol.isExternal()) {\n        return symbol;\n      }\n    }\n    if (tag.marker instanceof ConstraintSlack || tag.marker instanceof ConstraintError) {\n      if (row.coefficientFor(tag.marker) < 0) {\n        return tag.marker;\n      }\n    }\n    if (tag.other instanceof ConstraintSlack || tag.other instanceof ConstraintError) {\n      if (row.coefficientFor(tag.other) < 0) {\n        return tag.other;\n      }\n    }\n    return ConstraintSymbol.invalid;\n  }\n\n  // Adds the row to the tableau using an artificial variable; returns `false`\n  // if the constraint cannot be satisfied.\n  private addWithArtificialVariable(row: ConstraintRow): boolean {\n    // Create and add the artificial variable to the tableau.\n    const artificial = new ConstraintSlack();\n    this.rows.set(artificial, row.clone());\n    (this as Mutable<this>).artificial = row.clone();\n\n    // Optimize the artificial objective. This is successful\n    // only if the artificial objective is optimized to zero.\n    this.optimize(this.artificial!);\n    const success = Math.abs(this.artificial!.constant) < Equivalent.Epsilon;\n    (this as Mutable<this>).artificial = null;\n\n    // If the artificial variable is basic, pivot the row so that\n    // it becomes non-basic. If the row is constant, exit early.\n    const basic = this.rows.remove(artificial);\n    if (basic !== void 0) {\n      if (basic.isConstant()) {\n        return success;\n      }\n      const entering = this.anyPivotableSymbol(basic);\n      if (entering.isInvalid()) {\n        return false; // unsatisfiable (will this ever happen?)\n      }\n      basic.setSymbol(entering);\n      basic.solveForEx(artificial, entering);\n      this.substitute(entering, basic);\n      this.rows.set(entering, basic);\n    }\n\n    // Remove the artificial variable from the tableau.\n    for (let i = 0, n = this.rows.size; i < n; i += 1) {\n      this.rows.getEntry(i)![1].removeSymbol(artificial);\n    }\n    this.objective.removeSymbol(artificial);\n    return success;\n  }\n\n  // Substitutues all instances of the parametric symbol in the tableau\n  // and the objective function with the given row.\n  private substitute(symbol: ConstraintSymbol, row: ConstraintRow): void {\n    for (let i = 0, n = this.rows.size; i < n; i += 1) {\n      const [key, value] = this.rows.getEntry(i)!;\n      value.substitute(symbol, row);\n      if (value.constant < 0 && !key.isExternal()) {\n        this.infeasible.push(key);\n      }\n    }\n    this.objective.substitute(symbol, row);\n    if (this.artificial !== null) {\n      this.artificial.substitute(symbol, row);\n    }\n  }\n\n  // Optimizes the system for the given objective function.\n  //\n  // Performs iterations of Phase 2 of the simplex method until the objective\n  // function reaches a minimum.\n  private optimize(objective: ConstraintRow): void {\n    do {\n      const entering = this.getEnteringSymbol(objective);\n      if (entering.isInvalid()) {\n        return;\n      }\n      const leaving = this.getLeavingSymbol(entering);\n      if (leaving.isInvalid()) {\n        throw new Error(\"objective is unbounded\");\n      }\n      // Pivot the entering symbol into the basis.\n      const row = this.rows.remove(leaving)!;\n      row.setSymbol(entering);\n      row.solveForEx(leaving, entering);\n      this.substitute(entering, row);\n      this.rows.set(entering, row);\n    } while (true);\n  }\n\n  // Optimizes the system using the dual of the simplex method.\n  //\n  // The current state of the system should be such that the objective\n  // function is optimal, but not feasible. This method will perform\n  // an iteration of the dual simplex method to make the solution both\n  // optimal and feasible.\n  private dualOptimize(): void {\n    let leaving: ConstraintSymbol | undefined;\n    while ((leaving = this.infeasible.pop(), leaving !== void 0)) {\n      const row = this.rows.get(leaving);\n      if (row !== void 0 && row.constant < 0) {\n        const entering = this.getDualEnteringSymbol(row);\n        if (entering.isInvalid()) {\n          throw new Error(\"dual optimize failed\");\n        }\n        // Pivot the entering symbol into the basis.\n        this.rows.remove(leaving);\n        row.setSymbol(entering);\n        row.solveForEx(leaving, entering);\n        this.substitute(entering, row);\n        this.rows.set(entering, row);\n      }\n    }\n  }\n\n  // Returns the entering variable for a pivot operation.\n  //\n  // Returns the first symbol in the objective function which is non-dummy and\n  // has a coefficient less than zero. If no symbol meets the criteria then the\n  // objective function is at a minimum, and an invalid symbol is returned.\n  private getEnteringSymbol(objective: ConstraintRow): ConstraintSymbol {\n    for (let i = 0, n = objective.cells.size; i < n; i += 1) {\n      const [symbol, value] = objective.cells.getEntry(i)!;\n      if (value < 0 && !symbol.isDummy()) {\n        return symbol;\n      }\n    }\n    return ConstraintSymbol.invalid;\n  }\n\n  // Returns the entering symbol for the dual optimize operation.\n  //\n  // Returns the symbol in the row which has a positive coefficient and yields\n  // the minimum ratio for its respective symbol in the objective function.\n  // The provided row *must* be infeasible. If no symbol is found which meets\n  // the criteria, an invalid symbol is returned.\n  private getDualEnteringSymbol(row: ConstraintRow): ConstraintSymbol {\n    let ratio = Number.MAX_VALUE;\n    let entering = ConstraintSymbol.invalid;\n    for (let i = 0, n = row.cells.size; i < n; i += 1) {\n      const [symbol, value] = row.cells.getEntry(i)!;\n      if (value > 0 && !symbol.isDummy()) {\n        const coefficient = this.objective.coefficientFor(symbol);\n        const coratio = coefficient / value;\n        if (coratio < ratio) {\n          ratio = coratio;\n          entering = symbol;\n        }\n      }\n    }\n    return entering;\n  }\n\n  // Returns the symbol for the pivot exit row. If no appropriate exit symbol\n  // is found, an invalid symbol will be returned, indicating that the\n  // objective function is unbounded.\n  private getLeavingSymbol(entering: ConstraintSymbol): ConstraintSymbol {\n    let ratio = Number.MAX_VALUE;\n    let found = ConstraintSymbol.invalid;\n    for (let i = 0, n = this.rows.size; i < n; i += 1) {\n      const [symbol, row] = this.rows.getEntry(i)!;\n      if (!symbol.isExternal()) {\n        const coefficient = row.coefficientFor(entering);\n        if (coefficient < 0) {\n          const coratio = -row.constant / coefficient;\n          if (coratio < ratio) {\n            ratio = coratio;\n            found = symbol;\n          }\n        }\n      }\n    }\n    return found;\n  }\n\n  // Returns a symbol corresponding to a basic row which holds the given marker\n  // variable. The row will be chosen according to the following precedence:\n  //\n  // 1) The row with a restricted basic varible and a negative coefficient\n  //    for the marker with the smallest ratio of `-constant / coefficient`.\n  // 2) The row with a restricted basic variable and the smallest ratio of\n  //    `constant / coefficient`.\n  // 3) The last unrestricted row which contains the marker.\n  //\n  // If the marker does not exist in any row, an invalid symbol will be\n  // returned, indicating an internal solver error since the marker *should*\n  // exist somewhere in the tableau.\n  private getMarkerLeavingSymbol(marker: ConstraintSymbol): ConstraintSymbol {\n    let r1 = Number.MAX_VALUE;\n    let r2 = Number.MAX_VALUE;\n    let first = ConstraintSymbol.invalid;\n    let second = ConstraintSymbol.invalid;\n    let third = ConstraintSymbol.invalid;\n    for (let i = 0, n = this.rows.size; i < n; i += 1) {\n      const [symbol, row] = this.rows.getEntry(i)!;\n      const coefficient = row.coefficientFor(marker);\n      if (coefficient === 0) {\n        continue;\n      }\n      if (symbol.isExternal()) {\n        third = symbol;\n      } else if (coefficient < 0) {\n        const ratio = -row.constant / coefficient;\n        if (ratio < r1) {\n          r1 = ratio;\n          first = symbol;\n        }\n      } else {\n        const ratio = row.constant / coefficient;\n        if (ratio < r2) {\n          r2 = ratio;\n          second = symbol;\n        }\n      }\n    }\n    if (!first.isInvalid()) {\n      return first;\n    } else if (!second.isInvalid()) {\n      return second;\n    } else {\n      return third;\n    }\n  }\n\n  // Removes the effects of a constraint on the objective function.\n  private removeConstraintEffects(constraint: Constraint, tag: ConstraintTag): void {\n    if (tag.marker instanceof ConstraintError) {\n      this.removeMarkerEffects(tag.marker, constraint.strength);\n    }\n    if (tag.other instanceof ConstraintError) {\n      this.removeMarkerEffects(tag.other, constraint.strength);\n    }\n  }\n\n  // Removes the effects of an error marker on the objective function.\n  private removeMarkerEffects(marker: ConstraintSymbol, strength: ConstraintStrength): void {\n    const row = this.rows.get(marker);\n    if (row !== void 0) {\n      this.objective.insertRow(row, -strength);\n    } else {\n      this.objective.insertSymbol(marker, -strength);\n    }\n  }\n\n  // Returns the first Slack or Error symbol in the row. If no such symbol\n  // is present, an invalid symbol will be returned.\n  private anyPivotableSymbol(row: ConstraintRow): ConstraintSymbol {\n    for (let i = 0, n = row.cells.size; i < n; i += 1) {\n      const symbol = row.cells.getEntry(i)![0];\n      if (symbol instanceof ConstraintSlack || symbol instanceof ConstraintError) {\n        return symbol;\n      }\n    }\n    return ConstraintSymbol.invalid;\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Dictionary, MutableDictionary} from \"@swim/util\";\nimport {Hierarchy} from \"./Hierarchy\";\n\n/** @beta */\nexport class GenericHierarchy extends Hierarchy {\n  constructor() {\n    super();\n    this.parent = null;\n    this.children = [];\n    this.childMap = null;\n  }\n\n  readonly parent: Hierarchy | null;\n\n  /** @internal */\n  override attachParent(parent: Hierarchy): void {\n    this.willAttachParent(parent);\n    (this as Mutable<this>).parent = parent;\n    if (parent.mounted) {\n      this.cascadeMount();\n    }\n    this.onAttachParent(parent);\n    this.didAttachParent(parent);\n  }\n\n  /** @internal */\n  override detachParent(parent: Hierarchy): void {\n    this.willDetachParent(parent);\n    if (this.mounted) {\n      this.cascadeUnmount();\n    }\n    this.onDetachParent(parent);\n    (this as Mutable<this>).parent = null;\n    this.didDetachParent(parent);\n  }\n\n  get childCount(): number {\n    return this.children.length;\n  }\n\n  override readonly children: ReadonlyArray<Hierarchy>;\n\n  override firstChild(): Hierarchy | null {\n    const children = this.children;\n    if (children.length !== 0) {\n      return children[0]!;\n    }\n    return null;\n  }\n\n  override lastChild(): Hierarchy | null {\n    const children = this.children;\n    const childCount = children.length;\n    if (childCount !== 0) {\n      return children[childCount - 1]!;\n    }\n    return null;\n  }\n\n  override nextChild(target: Hierarchy): Hierarchy | null {\n    const children = this.children;\n    const targetIndex = children.indexOf(target);\n    if (targetIndex >= 0 && targetIndex + 1 < children.length) {\n      return children[targetIndex + 1]!;\n    }\n    return null;\n  }\n\n  override previousChild(target: Hierarchy): Hierarchy | null {\n    const children = this.children;\n    const targetIndex = children.indexOf(target);\n    if (targetIndex - 1 >= 0) {\n      return children[targetIndex - 1]!;\n    }\n    return null;\n  }\n\n  override forEachChild<T>(callback: (child: Hierarchy) => T | void): T | undefined;\n  override forEachChild<T, S>(callback: (this: S, child: Hierarchy) => T | void, thisArg: S): T | undefined;\n  override forEachChild<T, S>(callback: (this: S | undefined, child: Hierarchy) => T | void, thisArg?: S): T | undefined {\n    let result: T | undefined;\n    const children = this.children;\n    let i = 0;\n    while (i < children.length) {\n      const child = children[i]!;\n      result = callback.call(thisArg, child) as T | undefined;\n      if (result !== void 0) {\n        break;\n      }\n      if (children[i] === child) {\n        i += 1;\n      }\n    }\n    return result;\n  }\n\n  /** @internal */\n  readonly childMap: Dictionary<Hierarchy> | null;\n\n  /** @internal */\n  protected insertChildMap(child: Hierarchy): void {\n    const key = child.key;\n    if (key !== void 0) {\n      let childMap = this.childMap as MutableDictionary<Hierarchy>;\n      if (childMap === null) {\n        childMap = {};\n        (this as Mutable<this>).childMap = childMap;\n      }\n      childMap[key] = child;\n    }\n  }\n\n  /** @internal */\n  protected removeChildMap(child: Hierarchy): void {\n    const key = child.key;\n    if (key !== void 0) {\n      const childMap = this.childMap as MutableDictionary<Hierarchy>;\n      if (childMap !== null) {\n        delete childMap[key];\n      }\n    }\n  }\n\n  /** @internal */\n  protected replaceChildMap(newChild: Hierarchy, oldChild: Hierarchy): void {\n    const key = oldChild.key;\n    if (key !== void 0) {\n      let childMap = this.childMap as MutableDictionary<Hierarchy>;\n      if (childMap === null) {\n        childMap = {};\n        (this as Mutable<this>).childMap = childMap;\n      }\n      childMap[key] = newChild;\n    }\n  }\n\n  override getChild<F extends abstract new (...args: any[]) => Hierarchy>(key: string, childBound: F): InstanceType<F> | null;\n  override getChild(key: string, childBound?: abstract new (...args: any[]) => Hierarchy): Hierarchy | null;\n  override getChild(key: string, childBound?: abstract new (...args: any[]) => Hierarchy): Hierarchy | null {\n    const childMap = this.childMap;\n    if (childMap !== null) {\n      const child = childMap[key];\n      if (child !== void 0 && (childBound === void 0 || child instanceof childBound)) {\n        return child;\n      }\n    }\n    return null;\n  }\n\n  override setChild(key: string, newChild: Hierarchy | null): Hierarchy | null {\n    const oldChild = this.getChild(key);\n    const children = this.children as Hierarchy[];\n    let index = -1;\n    let target: Hierarchy | null = null;\n\n    if (oldChild !== null && newChild !== null && oldChild !== newChild) { // replace\n      newChild.remove();\n      index = children.indexOf(oldChild);\n      // assert(index >= 0);\n      target = index + 1 < children.length ? children[index + 1]! : null;\n      newChild.setKey(oldChild.key);\n      this.willRemoveChild(oldChild);\n      this.willInsertChild(newChild, target);\n      oldChild.detachParent(this);\n      children[index] = newChild;\n      this.replaceChildMap(newChild, oldChild);\n      newChild.attachParent(this);\n      this.onRemoveChild(oldChild);\n      this.onInsertChild(newChild, target);\n      this.didRemoveChild(oldChild);\n      this.didInsertChild(newChild, target);\n      oldChild.setKey(void 0);\n      newChild.cascadeInsert();\n    } else if (newChild !== oldChild || newChild !== null && newChild.key !== key) {\n      if (oldChild !== null) { // remove\n        this.willRemoveChild(oldChild);\n        oldChild.detachParent(this);\n        this.removeChildMap(oldChild);\n        index = children.indexOf(oldChild);\n        // assert(index >= 0);\n        children.splice(index, 1);\n        this.onRemoveChild(oldChild);\n        this.didRemoveChild(oldChild);\n        oldChild.setKey(void 0);\n        if (index < children.length) {\n          target = children[index]!;\n        }\n      }\n      if (newChild !== null) { // insert\n        newChild.remove();\n        newChild.setKey(key);\n        this.willInsertChild(newChild, target);\n        if (index >= 0) {\n          children.splice(index, 0, newChild);\n        } else {\n          children.push(newChild);\n        }\n        this.insertChildMap(newChild);\n        newChild.attachParent(this);\n        this.onInsertChild(newChild, target);\n        this.didInsertChild(newChild, target);\n        newChild.cascadeInsert();\n      }\n    }\n\n    return oldChild;\n  }\n\n  override appendChild<H extends Hierarchy>(child: H, key?: string): H {\n    child.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n      child.setKey(key);\n    }\n\n    this.willInsertChild(child, null);\n    (this.children as Hierarchy[]).push(child);\n    this.insertChildMap(child);\n    child.attachParent(this);\n    this.onInsertChild(child, null);\n    this.didInsertChild(child, null);\n    child.cascadeInsert();\n\n    return child;\n  }\n\n  override prependChild<H extends Hierarchy>(child: H, key?: string): H {\n    child.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n      child.setKey(key);\n    }\n\n    const children = this.children as Hierarchy[];\n    const target = children.length !== 0 ? children[0]! : null;\n    this.willInsertChild(child, target);\n    children.unshift(child);\n    this.insertChildMap(child);\n    child.attachParent(this);\n    this.onInsertChild(child, target);\n    this.didInsertChild(child, target);\n    child.cascadeInsert();\n\n    return child;\n  }\n\n  override insertChild<H extends Hierarchy>(child: H, target: Hierarchy | null, key?: string): H {\n    if (target !== null && target.parent !== this) {\n      throw new TypeError(\"\" + target);\n    }\n\n    child.remove();\n    if (key !== void 0) {\n      this.removeChild(key);\n      child.setKey(key);\n    }\n\n    this.willInsertChild(child, target);\n    const children = this.children as Hierarchy[];\n    const index = target !== null ? children.indexOf(target) : -1;\n    if (index >= 0) {\n      children.splice(index, 0, child);\n    } else {\n      children.push(child);\n    }\n    this.insertChildMap(child);\n    child.attachParent(this);\n    this.onInsertChild(child, target);\n    this.didInsertChild(child, target);\n    child.cascadeInsert();\n\n    return child;\n  }\n\n  override replaceChild<H extends Hierarchy>(newChild: Hierarchy, oldChild: H): H {\n    const children = this.children as Hierarchy[];\n    if (oldChild.parent !== this) {\n      throw new TypeError(\"\" + oldChild);\n    }\n\n    if (newChild !== oldChild) {\n      newChild.remove();\n      const index = children.indexOf(oldChild);\n      // assert(index >= 0);\n      const target = index + 1 < children.length ? children[index + 1]! : null;\n      newChild.setKey(oldChild.key);\n      this.willRemoveChild(oldChild);\n      this.willInsertChild(newChild, target);\n      oldChild.detachParent(this);\n      children[index] = newChild;\n      this.replaceChildMap(newChild, oldChild);\n      newChild.attachParent(this);\n      this.onRemoveChild(oldChild);\n      this.onInsertChild(newChild, target);\n      this.didRemoveChild(oldChild);\n      this.didInsertChild(newChild, target);\n      oldChild.setKey(void 0);\n      newChild.cascadeInsert();\n    }\n\n    return oldChild;\n  }\n\n  override removeChild(key: string): Hierarchy | null;\n  override removeChild<H extends Hierarchy>(child: H): H;\n  override removeChild(key: string | Hierarchy): Hierarchy | null {\n    let child: Hierarchy | null;\n    if (typeof key === \"string\") {\n      child = this.getChild(key);\n      if (child === null) {\n        return null;\n      }\n    } else {\n      child = key;\n      if (child.parent !== this) {\n        throw new Error(\"not a child\");\n      }\n    }\n\n    this.willRemoveChild(child);\n    child.detachParent(this);\n    this.removeChildMap(child);\n    const children = this.children as Hierarchy[];\n    const index = children.indexOf(child);\n    // assert(index >= 0);\n    children.splice(index, 1);\n    this.onRemoveChild(child);\n    this.didRemoveChild(child);\n    child.setKey(void 0);\n\n    return child;\n  }\n\n  override removeChildren(): void {\n    const children = this.children as Hierarchy[];\n    let childCount: number;\n    while (childCount = children.length, childCount !== 0) {\n      const child = children[childCount - 1]!;\n      this.willRemoveChild(child);\n      child.detachParent(this);\n      this.removeChildMap(child);\n      children.pop();\n      this.onRemoveChild(child);\n      this.didRemoveChild(child);\n      child.setKey(void 0);\n    }\n  }\n\n  mount(): void {\n    if (!this.mounted && this.parent === null) {\n      this.cascadeMount();\n      this.cascadeInsert();\n    }\n  }\n\n  /** @internal */\n  protected override mountChildren(): void {\n    const children = this.children;\n    let i = 0;\n    while (i < children.length) {\n      const child = children[i]!;\n      child.cascadeMount();\n      if ((child.flags & Hierarchy.RemovingFlag) !== 0) {\n        child.setFlags(child.flags & ~Hierarchy.RemovingFlag);\n        this.removeChild(child);\n        continue;\n      }\n      i += 1;\n    }\n  }\n\n  unmount(): void {\n    if (this.mounted && this.parent === null) {\n      this.cascadeUnmount();\n    }\n  }\n\n  /** @internal */\n  protected override unmountChildren(): void {\n    const children = this.children;\n    let i = 0;\n    while (i < children.length) {\n      const child = children[i]!;\n      child.cascadeUnmount();\n      if ((child.flags & Hierarchy.RemovingFlag) !== 0) {\n        child.setFlags(child.flags & ~Hierarchy.RemovingFlag);\n        this.removeChild(child);\n        continue;\n      }\n      i += 1;\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {InletOptions} from \"./Inlet\";\nimport {StreamletPrototype, AbstractStreamlet} from \"./AbstractStreamlet\";\n\n/** @public */\nexport function In(name: string): PropertyDecorator;\n/** @public */\nexport function In(options: InletOptions): PropertyDecorator;\n/** @public */\nexport function In(target: unknown, key: string): void;\nexport function In(target: unknown, key?: string): PropertyDecorator | void {\n  if (arguments.length === 1) {\n    if (typeof target === \"string\") {\n      target = {name: target} as InletOptions;\n    }\n    return AbstractStreamlet.decorateInlet.bind(void 0, target as InletOptions);\n  } else {\n    AbstractStreamlet.decorateInlet({}, target as StreamletPrototype, key!);\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {AnyItem, Item, AnyValue, Value, Record, AnyText, AnyNum, Num} from \"@swim/structure\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport type {ListDownlink} from \"./ListDownlink\";\n\n/** @public */\nexport class ListDownlinkRecord extends DownlinkRecord {\n  constructor(downlink: ListDownlink<Value, AnyValue>) {\n    super();\n    this.downlink = downlink;\n  }\n\n  override readonly downlink: ListDownlink<Value, AnyValue>;\n\n  override isEmpty(): boolean {\n    return this.downlink.isEmpty();\n  }\n\n  override isArray(): boolean {\n    return true;\n  }\n\n  override isObject(): boolean {\n    return this.downlink.isEmpty();\n  }\n\n  override get length(): number {\n    return this.downlink.length;\n  }\n\n  override has(key: AnyValue): boolean {\n    return false;\n  }\n\n  override get(): Record;\n  override get(key: AnyValue): Value;\n  override get(key?: AnyValue): Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      return Value.absent();\n    }\n  }\n\n  override getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  override getSlot(key: AnyValue): Value {\n    return Value.absent();\n  }\n\n  override getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this.downlink.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(Math.max(0, index), n - 1);\n    if (index >= 0) {\n      return this.downlink.get(index);\n    }\n    return Item.absent();\n  }\n\n  override set(key: AnyValue, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setAttr(key: AnyText, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setSlot(key: AnyValue, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  override setItem(index: AnyNum, newItem: AnyItem): this {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this.downlink.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(Math.max(0, index), n - 1);\n    if (index >= 0) {\n      this.downlink.set(index, Value.fromAny(newItem));\n    }\n    return this;\n  }\n\n  override push(...newItems: AnyItem[]): number {\n    return this.downlink.push(...newItems);\n  }\n\n  override splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    return this.downlink.splice(start, deleteCount, ...newItems);\n  }\n\n  override delete(key: AnyValue): Item {\n    return Item.absent();\n  }\n\n  override clear(): void {\n    this.downlink.clear();\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    return this.downlink.forEach(callback, thisArg);\n  }\n\n  override keyIterator(): Cursor<Value> {\n    return Cursor.empty();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Cursor, Map} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {KeyEffect} from \"./KeyEffect\";\nimport {AbstractMapOutlet} from \"./AbstractMapOutlet\";\n\n/** @public */\nexport class MapInput<K, V> extends AbstractMapOutlet<K, V, Map<K, V>> {\n  constructor(state?: BTree<K, V>) {\n    super();\n    if (state === void 0) {\n      state = new BTree();\n    }\n    this.state = state;\n    let effects = this.effects;\n    state.forEach(function (key: K): void {\n      effects = effects.updated(key, KeyEffect.Update);\n    }, this);\n    (this as Mutable<this>).effects = effects;\n  }\n\n  /** @internal */\n  readonly state: BTree<K, V>;\n\n  override has(key: K): boolean {\n    return this.state.has(key);\n  }\n\n  override get(): Map<K, V> | undefined;\n  override get(key: K): V | undefined;\n  override get(key?: K): Map<K, V> | V | undefined {\n    if (key === void 0) {\n      return this.state;\n    } else {\n      return this.state.get(key);\n    }\n  }\n\n  set(key: K, newValue: V): V | undefined {\n    const oldState = this.state;\n    const oldValue = oldState.get(key);\n    if (oldValue !== newValue) {\n      (this as Mutable<this>).state = oldState.updated(key, newValue);\n      this.decohereInputKey(key, KeyEffect.Update);\n    }\n    return oldValue;\n  }\n\n  delete(key: K): this {\n    const oldState = this.state;\n    const newState = oldState.removed(key);\n    if (oldState !== newState) {\n      (this as Mutable<this>).state = newState;\n      this.decohereInputKey(key, KeyEffect.Remove);\n    }\n    return this;\n  }\n\n  keyIterator(): Cursor<K> {\n    return this.state.keys();\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable, Map} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {KeyEffect} from \"./KeyEffect\";\nimport {AbstractMapInlet} from \"./AbstractMapInlet\";\n\n/** @public */\nexport class MapOutput<K, V> extends AbstractMapInlet<K, V, Map<K, V>> {\n  constructor() {\n    super();\n    this.state = new BTree();\n  }\n\n  /** @internal */\n  readonly state: BTree<K, V>;\n\n  get(): Map<K, V> {\n    return this.state;\n  }\n\n  protected override onRecohereOutputKey(key: K, effect: KeyEffect, version: number): void {\n    if (effect === KeyEffect.Update) {\n      const input = this.input;\n      if (input !== null) {\n        const value = input.get(key);\n        if (value !== void 0) {\n          (this as Mutable<this>).state = this.state.updated(key, value);\n        } else {\n          (this as Mutable<this>).state = this.state.removed(key);\n        }\n      }\n    } else if (effect === KeyEffect.Remove) {\n      (this as Mutable<this>).state = this.state.removed(key);\n    }\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {AnyItem, Item, Field, AnyValue, Value, Record, AnyText, AnyNum} from \"@swim/structure\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport type {ValueDownlinkObserver, ValueDownlink} from \"./ValueDownlink\";\n\n/** @public */\nexport class ValueDownlinkRecord extends DownlinkRecord implements ValueDownlinkObserver<Value, AnyValue> {\n  constructor(downlink: ValueDownlink<Value, AnyValue>) {\n    super();\n    this.downlink = downlink;\n    downlink.observe(this);\n  }\n\n  override readonly downlink: ValueDownlink<Value, AnyValue>;\n\n  override isEmpty(): boolean {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.isEmpty();\n    } else {\n      return !value.isDefined();\n    }\n  }\n\n  override isArray(): boolean {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.isArray();\n    } else {\n      return true;\n    }\n  }\n\n  override isObject(): boolean {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.isObject();\n    } else {\n      return !value.isDefined();\n    }\n  }\n\n  override get length(): number {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.length;\n    } else if (value.isDefined()) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n  override has(key: AnyValue): boolean {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.has(key);\n    } else {\n      return false;\n    }\n  }\n\n  override get(): Record;\n  override get(key: AnyValue): Value;\n  override get(key?: AnyValue): Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      const value = this.downlink.get();\n      if (value instanceof Record) {\n        return value.get(key);\n      } else {\n        return Value.absent();\n      }\n    }\n  }\n\n  override getAttr(key: AnyText): Value {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.getAttr(key);\n    } else {\n      return Value.absent();\n    }\n  }\n\n  override getSlot(key: AnyValue): Value {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.getSlot(key);\n    } else {\n      return Value.absent();\n    }\n  }\n\n  override getField(key: AnyValue): Field | undefined {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.getField(key);\n    } else {\n      return void 0;\n    }\n  }\n\n  override getItem(index: AnyNum): Item {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.getItem(index);\n    } else {\n      return value;\n    }\n  }\n\n  override set(key: AnyValue, newValue: AnyValue): this {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      value.set(key, newValue);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n    return this;\n  }\n\n  override setAttr(key: AnyText, newValue: AnyValue): this {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      value.setAttr(key, newValue);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n    return this;\n  }\n\n  override setSlot(key: AnyValue, newValue: AnyValue): this {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      value.setSlot(key, newValue);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n    return this;\n  }\n\n  override setItem(index: number, newItem: AnyItem): this {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      value.setItem(index, newItem);\n    } else {\n      this.downlink.set(Item.fromAny(newItem).toValue());\n    }\n    return this;\n  }\n\n  override push(...newItems: AnyItem[]): number {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.push(...newItems);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n  }\n\n  override splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.splice(start, deleteCount, ...newItems);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n  }\n\n  override delete(key: AnyValue): Item {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      return value.delete(key);\n    } else {\n      return Value.absent();\n    }\n  }\n\n  override clear(): void {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      value.clear();\n    } else {\n      throw new Error(\"unsupported\");\n    }\n  }\n\n  override forEach<T>(callback: (item: Item, index: number) => T | void): T | undefined;\n  override forEach<T, S>(callback: (this: S, item: Item, index: number) => T | void,\n                         thisArg: S): T | undefined;\n  override forEach<T, S>(callback: (this: S | undefined, item: Item, index: number) => T | void,\n                         thisArg?: S): T | undefined {\n    const value = this.downlink.get();\n    return value.forEach(callback, thisArg);\n  }\n\n  override keyIterator(): Cursor<Value> {\n    const value = this.downlink.get();\n    if (value instanceof Record) {\n      throw new Error(); // TODO\n    } else {\n      return Cursor.empty();\n    }\n  }\n\n  didSet(newValue: Value, oldValue: Value): void {\n    this.decohereInput();\n    this.recohereInput(0); // TODO: debounce\n  }\n}\n","// Copyright 2015-2021 Swim Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport type {Mutable} from \"@swim/util\";\nimport {AbstractInlet} from \"./AbstractInlet\";\n\n/** @public */\nexport class ValueOutput<I> extends AbstractInlet<I> {\n  constructor(state?: I) {\n    super();\n    this.state = state;\n  }\n\n  /** @internal */\n  readonly state: I | undefined;\n\n  get(): I | undefined {\n    return this.state;\n  }\n\n  protected override onRecohereOutput(version: number): void {\n    const input = this.input;\n    if (input !== null) {\n      (this as Mutable<this>).state = input.get();\n    }\n  }\n}\n"]}